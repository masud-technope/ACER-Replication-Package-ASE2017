copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse pde internal core text org eclipse jface text position java string reader stringreader java util array list arraylist java util stack org eclipse jface text org eclipse pde internal core util pde xml helper pdexmlhelper org xml sax org xml sax helpers default handler defaulthandler document handler documenthandler default handler defaulthandler stack i document element node idocumentelementnode f document node stack fdocumentnodestack stack i document element node idocumentelementnode f highest offset fhighestoffset locator f locator flocator i document element node idocumentelementnode f last error flasterror f reconciling freconciling document handler documenthandler reconciling f reconciling freconciling reconciling override start document startdocument sax exception saxexception f document node stack fdocumentnodestack clear f highest offset fhighestoffset f last error flasterror i document element node idocumentelementnode get last parse d document node getlastparseddocumentnode f document node stack fdocumentnodestack is empty isempty f document node stack fdocumentnodestack peek override start element startelement string uri string local name localname string q name qname attributes attributes sax exception saxexception i document element node idocumentelementnode parent get last parse d document node getlastparseddocumentnode i document element node idocumentelementnode node get document node getdocumentnode q name qname parent node offset nodeoffset get start offset getstartoffset q name qname node set offset setoffset node offset nodeoffset i document idocument doc get document getdocument doc get line of offset getlineofoffset node offset nodeoffset node set line indent setlineindent node get offset getoffset doc get line offset getlineoffset create attributes attributes get length getlength string att name attname attributes getqname string att value attvalue attributes get value getvalue i document attribute node idocumentattributenode attribute get document attribute getdocumentattribute att name attname att value attvalue node attribute i region iregion region get attribute region getattributeregion att name attname att value attvalue node offset nodeoffset region att value attvalue pde xml helper pdexmlhelper get writable string getwritablestring att value attvalue region get attribute region getattributeregion att name attname att value attvalue node offset nodeoffset region attribute set name offset setnameoffset region get offset getoffset attribute set name length setnamelength att name attname length attribute set value offset setvalueoffset region get offset getoffset region get length getlength att value attvalue length attribute set value length setvaluelength att value attvalue length node setxmlattribute attribute remove orphan attributes removeorphanattributes node bad location exception badlocationexception parent node node get parent node getparentnode f reconciling freconciling find place child save model xml element tag overwrite element tag position i document element node idocumentelementnode children parent get child nodes getchildnodes position children length position children position get offset getoffset parent add child node addchildnode node position parent add child node addchildnode node f document node stack fdocumentnodestack push node i document element node idocumentelementnode get document node getdocumentnode string i document element node idocumentelementnode parent i document attribute node idocumentattributenode get document attribute getdocumentattribute string string i document element node idocumentelementnode parent i document text node idocumenttextnode get document text node getdocumenttextnode string content i document element node idocumentelementnode parent get start offset getstartoffset string element name elementname bad location exception badlocationexception f locator flocator get line number getlinenumber col f locator flocator get column number getcolumnnumber i document idocument doc get document getdocument col col doc get line length getlinelength end offset endoffset doc get number of lines getnumberoflines end offset endoffset doc get line offset getlineoffset doc get number of lines getnumberoflines i region iregion line info lineinfo doc get line information getlineinformation end offset endoffset line info lineinfo get offset getoffset line info lineinfo get length getlength string text doc f highest offset fhighestoffset end offset endoffset f highest offset fhighestoffset array list arraylist position comment positions commentpositions array list arraylist position idx idx text length nls idx text index of indexof idx idx nls text index of indexof idx comment positions commentpositions add position idx idx idx idx idx text length idx nls idx text index of indexof element name elementname idx idx valid comment positions commentpositions size position pos comment positions commentpositions pos includes idx valid valid idx f highest offset fhighestoffset idx f highest offset fhighestoffset get element length getelementlength i document element node idocumentelementnode node column bad location exception badlocationexception end index endindex node get offset getoffset i document idocument doc get document getdocument start math max doc get line offset getlineoffset node get offset getoffset column doc get line length getlinelength string line text linetext doc start column start doc get line offset getlineoffset nls nls line text linetext index of indexof node getxmltagname nls line text linetext index of indexof end index endindex column end index endindex end index endindex node getxmltagname length start end index endindex node get offset getoffset i region iregion get attribute region getattributeregion string string offset bad location exception badlocationexception find replace document adapter findreplacedocumentadapter f find replace adapter ffindreplaceadapter find replace document adapter findreplacedocumentadapter get document getdocument nls nls i region iregion name region nameregion f find replace adapter ffindreplaceadapter find offset name region nameregion name region nameregion region name region nameregion get offset getoffset name region nameregion get length getlength get document getdocument name region nameregion get offset getoffset name region nameregion get length getlength length equals region name region nameregion get offset getoffset name region nameregion get length getlength length override end element endelement string uri string local name localname string q name qname sax exception saxexception f document node stack fdocumentnodestack is empty isempty i document element node idocumentelementnode node f document node stack fdocumentnodestack pop node set length setlength get element length getelementlength node f locator flocator get line number getlinenumber f locator flocator get column number getcolumnnumber set text node offset settextnodeoffset node bad location exception badlocationexception remove orphan elements removeorphanelements node set text node offset settextnodeoffset i document element node idocumentelementnode node bad location exception badlocationexception i document text node idocumenttextnode text node textnode node get text node gettextnode text node textnode text node textnode get text gettext text node textnode get text gettext trim length node remove text node removetextnode i document idocument doc get document getdocument string text doc node get offset getoffset node get length getlength text node relative start offset relativestartoffset text index of indexof text node relative end offset relativeendoffset text last index of lastindexof relative start offset relativestartoffset relative start offset relativestartoffset text length relative end offset relativeendoffset relative end offset relativeendoffset text length trim whitespace character is whitespace iswhitespace text char at charat relative start offset relativestartoffset relative start offset relativestartoffset character is whitespace iswhitespace text char at charat relative end offset relativeendoffset relative end offset relativeendoffset text node textnode set offset setoffset node get offset getoffset relative start offset relativestartoffset text node textnode set length setlength relative end offset relativeendoffset relative start offset relativestartoffset text node textnode set text settext text node textnode get text gettext trim override fatal error fatalerror sax parse exception saxparseexception sax exception saxexception generate error element hierarchy generateerrorelementhierarchy generate error element hierarchy generateerrorelementhierarchy f document node stack fdocumentnodestack is empty isempty i document element node idocumentelementnode node f document node stack fdocumentnodestack pop node set is error node setiserrornode remove orphan attributes removeorphanattributes node remove orphan elements removeorphanelements node f last error flasterror f last error flasterror node override error sax parse exception saxparseexception sax exception saxexception generate error element hierarchy generateerrorelementhierarchy override set document locator setdocumentlocator locator locator f locator flocator locator i document idocument get document getdocument override input source inputsource resolve entity resolveentity string public id publicid string system id systemid sax exception saxexception nls input source inputsource string reader stringreader i document element node idocumentelementnode get last error node getlasterrornode f last error flasterror override characters start length sax exception saxexception f reconciling freconciling f document node stack fdocumentnodestack is empty isempty i document element node idocumentelementnode parent f document node stack fdocumentnodestack peek string buffer stringbuffer buffer string buffer stringbuffer buffer append start length get document text node getdocumenttextnode buffer to string tostring parent remove orphan attributes removeorphanattributes i document element node idocumentelementnode node remove attributes previous element f reconciling freconciling i document attribute node idocumentattributenode attrs node get node attributes getnodeattributes attrs length attrs get name offset getnameoffset node remove document attribute removedocumentattribute attrs remove orphan elements removeorphanelements i document element node idocumentelementnode node remove excess children elements f reconciling freconciling i document element node idocumentelementnode children node get child nodes getchildnodes children length children get offset getoffset node remove child node removechildnode children is reconciling isreconciling f reconciling freconciling
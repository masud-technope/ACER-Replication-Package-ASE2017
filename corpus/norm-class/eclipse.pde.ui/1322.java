copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse pde internal editor context java util org eclipse core file buf fers filebuffers i document setup participant idocumentsetupparticipant org eclipse jface text org eclipse pde core i model changed event imodelchangedevent org eclipse pde internal core text org eclipse pde internal core util pde xml helper pdexmlhelper org eclipse pde internal editor pde form editor pdeformeditor org eclipse text edits org eclipse i editor input ieditorinput xml input context xmlinputcontext utf input context inputcontext hash map hashmap object text edit textedit f operation table foperationtable hash map hashmap hash map hashmap i document element node idocumentelementnode move source edit movesourceedit f move operations fmoveoperations hash map hashmap param editor param input xml input context xmlinputcontext pde form editor pdeformeditor editor i editor input ieditorinput input primary editor input primary override i document setup participant idocumentsetupparticipant get document setup participant getdocumentsetupparticipant xml document setup part icpant xmldocumentsetupparticpant override add text edit operation addtexteditoperation array list arraylist text edit textedit ops i model changed event imodelchangedevent event object objects event get changed objects getchangedobjects objects objects length object object objects event get change type getchangetype i model changed event imodelchangedevent remove object i document element node idocumentelementnode remove node removenode i document element node idocumentelementnode object ops i model changed event imodelchangedevent insert object i document element node idocumentelementnode insert node insertnode i document element node idocumentelementnode object ops i model changed event imodelchangedevent change object i document element node idocumentelementnode i document element node idocumentelementnode node i document element node idocumentelementnode object i document attribute node idocumentattributenode attr node get document attribute getdocumentattribute event get changed property getchangedproperty attr add attribute operation addattributeoperation attr ops event event get old value getoldvalue i document element node idocumentelementnode event get new value getnewvalue i document element node idocumentelementnode swap ping swapping nodes modify node modifynode node ops event object i document text node idocumenttextnode add element content operation addelementcontentoperation i document text node idocumenttextnode object ops remove node removenode i document element node idocumentelementnode node array list arraylist text edit textedit ops delete previous node text edit textedit f operation table foperationtable node ops remove f operation table foperationtable remove node text edit textedit old move oldmove f move operations fmoveoperations node old move oldmove ops remove old move oldmove f move operations fmoveoperations remove node node offset delete node get offset getoffset create delete node text edit textedit get delete node operation getdeletenodeoperation node ops add f operation table foperationtable node old move oldmove previous offset node rewrite highest ancestor offset insert node insertnode node ops insert node insertnode i document element node idocumentelementnode node array list arraylist text edit textedit ops text edit textedit node get highest node to be written gethighestnodetobewritten node node get parent node getparentnode https bugs eclipse org bugs bug cgi node is root isroot insert edit insertedit node write node get offset getoffset element form element broken element element note node correct stored length previous written write call bug replace edit replaceedit node get offset getoffset node get length getlength node write insert sibling offset insert after sibling insertaftersibling node insert child parent insert as first child insertasfirstchild node text edit textedit f operation table foperationtable node ops remove ops add f operation table foperationtable node insert edit insertedit insert after sibling insertaftersibling i document element node idocumentelementnode node i document element node idocumentelementnode sibling node get previous sibling getprevioussibling sibling sibling get offset getoffset node set line indent setlineindent sibling get line indent getlineindent string sep text utilities textutilities get default line delimiter getdefaultlinedelimiter get document provider getdocumentprovider get document getdocument get input getinput insert edit insertedit sibling get offset getoffset sibling get length getlength sep node write sibling sibling get previous sibling getprevioussibling insert edit insertedit insert as first child insertasfirstchild i document element node idocumentelementnode node offset node get parent node getparentnode get offset getoffset length get next position getnextposition get document provider getdocumentprovider get document getdocument get input getinput offset node set line indent setlineindent node get parent node getparentnode get line indent getlineindent string sep text utilities textutilities get default line delimiter getdefaultlinedelimiter get document provider getdocumentprovider get document getdocument get input getinput insert edit insertedit offset length sep node write modify node modifynode i document element node idocumentelementnode node array list arraylist text edit textedit ops i model changed event imodelchangedevent event i document element node idocumentelementnode old node oldnode i document element node idocumentelementnode event get old value getoldvalue i document element node idocumentelementnode new node newnode i document element node idocumentelementnode event get new value getnewvalue i document element node idocumentelementnode node old node oldnode get previous sibling getprevioussibling old node oldnode equals new node newnode get previous sibling getprevioussibling old node oldnode new node newnode i document element node idocumentelementnode node node equals old node oldnode new node newnode old node oldnode node get offset getoffset node get offset getoffset text edit textedit f operation table foperationtable node node rule node rule rewrite parent ancestor insert node insertnode node ops swap order insert operations text edit textedit f operation table foperationtable node ops ops index of indexof ops ops index of indexof node get offset getoffset node get offset getoffset nodes offsets create move target source combo operation i region iregion region get move region getmoveregion node move source edit movesourceedit source move source edit movesourceedit region get offset getoffset region get length getlength region get move region getmoveregion node source set target edit settargetedit move target edit movetargetedit region get offset getoffset move source edit movesourceedit f move operations fmoveoperations node ops ops index of indexof source f move operations fmoveoperations node get target edit gettargetedit get offset getoffset source get offset getoffset f move operations fmoveoperations remove node ops remove ops add source f move operations fmoveoperations node source node offset offset delete reinsert offset insert node insertnode node get offset getoffset node node ops i region iregion get move region getmoveregion i document element node idocumentelementnode node offset node get offset getoffset length node get length getlength i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput doc offset to char array tochararray character is whitespace iswhitespace bad location exception badlocationexception region offset length add attribute operation addattributeoperation i document attribute node idocumentattributenode attr array list arraylist text edit textedit ops i model changed event imodelchangedevent event offset attr get value offset getvalueoffset object new value newvalue event get new value getnewvalue object changed object changedobject attr text edit textedit old op oldop f operation table foperationtable changed object changedobject text edit textedit offset attribute exists replace new value newvalue new value newvalue to string tostring length length attr get value offset getvalueoffset attr get value length getvaluelength attr get name offset getnameoffset get attribute delete edit operation getattributedeleteeditoperation attr get name offset getnameoffset length old length oldlength old op oldop replace edit replaceedit old length oldlength old op oldop get length getlength old op oldop delete edit deleteedit old length oldlength old op oldop get offset getoffset old op oldop get length getlength offset old length oldlength get writable attribute node value getwritableattributenodevalue string event get old value getoldvalue length replace edit replaceedit offset old length oldlength get writable attribute node value getwritableattributenodevalue event get new value getnewvalue to string tostring attribute doesn exist check parent exists add attribute i document element node idocumentelementnode node attr get enclosing element getenclosingelement i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput node get offset getoffset changed object changedobject node len get next position getnextposition doc node get offset getoffset replace edit replaceedit node get offset getoffset len node write shallow writeshallow should terminate element shouldterminateelement doc node get offset getoffset len parent doesn exist doc write parent doc insert node insertnode node ops old op oldop ops remove old op oldop ops add f operation table foperationtable changed object changedobject add element content operation addelementcontentoperation i document text node idocumenttextnode text node textnode array list arraylist text edit textedit ops text edit textedit object changed object changedobject text node textnode text node textnode get offset getoffset string new text newtext get writable text node string getwritabletextnodestring text node textnode replace edit replaceedit text node textnode get offset getoffset text node textnode get length getlength new text newtext i document element node idocumentelementnode parent text node textnode get enclosing element getenclosingelement parent get offset getoffset i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput string end chars endchars doc parent get offset getoffset parent get length getlength nls equals nls end chars endchars parent element form element rewrite insert node insertnode parent ops bad location exception badlocationexception add text child changed object changedobject parent string sep text utilities textutilities get default line delimiter getdefaultlinedelimiter get document provider getdocumentprovider get document getdocument get input getinput string buffer stringbuffer buffer string buffer stringbuffer sep parent get line indent getlineindent nls buffer append nls nls buffer append nls get writable text node string getwritabletextnodestring text node textnode offset parent get offset getoffset length get next position getnextposition doc offset insert edit insertedit offset length buffer to string tostring insert node insertnode parent ops text edit textedit old op oldop f operation table foperationtable changed object changedobject old op oldop ops remove old op oldop ops add f operation table foperationtable changed object changedobject should terminate element shouldterminateelement i document idocument doc offset doc offset to char array tochararray bad location exception badlocationexception get next position getnextposition i document idocument doc offset offset doc get length getlength doc get char getchar offset bad location exception badlocationexception delete edit deleteedit get attribute delete edit operation getattributedeleteeditoperation offset length i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput deletion operation offset character document character doc get char getchar operation character is whitespace iswhitespace character grow length length length decrement offset offset offset deletion bad location exception badlocationexception delete edit deleteedit offset length delete edit deleteedit get delete node operation getdeletenodeoperation i document element node idocumentelementnode node offset node get offset getoffset length node get length getlength i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput node starts start line startline doc get line of offset getlineofoffset offset start line startline offset start line offset startlineoffset doc get line offset getlineoffset start line startline hunt whitespace start start offset startoffset start offset startoffset loop find whitespace start offset startoffset offset start offset startoffset start line offset startlineoffset start offset startoffset character is whitespace iswhitespace doc get char getchar start offset startoffset move loop stopped reaching start offset startoffset node ends end line endline doc get line of offset getlineofoffset offset length length delimiter end line delim length endlinedelimlength doc get line delimiter getlinedelimiter end line endline length hunt whitespace extra length extralength extra length extralength length extra length extralength character is whitespace iswhitespace doc get char getchar offset extra length extralength white space move extra length extralength doc get line of offset getlineofoffset offset extra length extralength end line endline don touch line delim eters linedelimeters extra length extralength end line delim length endlinedelimlength reached start remove new line newline start offset startoffset start line offset startlineoffset start offset startoffset doc get line delimiter getlinedelimiter start line startline length add difference offset length extra length extralength offset start offset startoffset offset start offset startoffset print deletion range printdeletionrange offset length bad location exception badlocationexception delete edit deleteedit offset length print deletion range printdeletionrange offset length new lines newlines printed carriage returns printed tabs printed spaces printed string string get document provider getdocumentprovider get document getdocument get input getinput offset length string buffer stringbuffer buffer string buffer stringbuffer string length string char at charat nls buffer append nls nls buffer append nls nls buffer append nls buffer append buffer append system println buffer to string tostring bad location exception badlocationexception i document element node idocumentelementnode get highest node to be written gethighestnodetobewritten i document element node idocumentelementnode node i document element node idocumentelementnode parent node get parent node getparentnode parent node parent get offset getoffset i document idocument doc get document provider getdocumentprovider get document getdocument get input getinput string end chars endchars doc parent get offset getoffset parent get length getlength nls equals end chars endchars nls parent nls node bad location exception badlocationexception node get highest node to be written gethighestnodetobewritten parent override flush model flushmodel i document idocument doc remove unnecessary operations removeunnecessaryoperations f operation table foperationtable size object object f operation table foperationtable key set keyset iterator object i document element node idocumentelementnode f edit operations feditoperations insert edit insertedit i document element node idocumentelementnode object get parent node getparentnode doc i document element node idocumentelementnode object write f operation table foperationtable clear f edit operations feditoperations clear reorder insert edits reorderinsertedits f edit operations feditoperations f operation table foperationtable clear f move operations fmoveoperations clear flush model flushmodel doc reorder insert edits reorderinsertedits array list arraylist text edit textedit ops remove unnecessary operations removeunnecessaryoperations iterator text edit textedit iter f operation table foperationtable values iterator iter has next hasnext object object iter object i document element node idocumentelementnode i document element node idocumentelementnode node i document element node idocumentelementnode object node get offset getoffset i document attribute node idocumentattributenode attrs node get node attributes getnodeattributes attrs length object f operation table foperationtable remove attrs f edit operations feditoperations remove i document text node idocumenttextnode text node textnode node get text node gettextnode text node textnode object f operation table foperationtable remove text node textnode f edit operations feditoperations remove string get writable attribute node value getwritableattributenodevalue string source todo teo should n shouldn get writable attribute string getwritableattributestring pde xml helper pdexmlhelper get writable string getwritablestring source string get writable text node string getwritabletextnodestring i document text node idocumenttextnode text node textnode text node textnode write hash map hashmap object text edit textedit get operation table getoperationtable f operation table foperationtable
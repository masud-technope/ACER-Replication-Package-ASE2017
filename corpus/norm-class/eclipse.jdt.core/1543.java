copyright ibm corporation rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors ibm corporation initial api implementation org eclipse jdt internal compiler parser org eclipse jdt internal compiler ast abstract method declaration abstractmethoddeclaration org eclipse jdt internal compiler ast ast node astnode org eclipse jdt internal compiler ast block org eclipse jdt internal compiler ast field declaration fielddeclaration org eclipse jdt internal compiler ast initializer org eclipse jdt internal compiler ast statement org eclipse jdt internal compiler ast type declaration typedeclaration org eclipse jdt internal compiler ast type parameter typeparameter org eclipse jdt internal compiler ast type reference typereference org eclipse jdt internal compiler lookup compiler modifiers compilermodifiers recovered type recoveredtype recovered statement recoveredstatement terminal tokens terminaltokens compiler modifiers compilermodifiers type declaration typedeclaration type declaration typedeclaration recovered type recoveredtype member types membertypes member type count membertypecount recovered field recoveredfield fields field count fieldcount recovered method recoveredmethod methods method count methodcount anonymous types preserve content preservecontent body end bodyend recovered type recoveredtype type declaration typedeclaration type declaration typedeclaration recovered element recoveredelement parent bracket balance bracketbalance type declaration typedeclaration parent bracket balance bracketbalance type declaration typedeclaration type declaration typedeclaration found opening brace foundopeningbrace body starts at header end bodystartsatheaderend found opening brace foundopeningbrace bracket balance bracketbalance recovered element recoveredelement add abstract method declaration abstractmethoddeclaration method declaration methoddeclaration bracket balance value bracketbalancevalue method starting passed type belonging enclosing type type declaration typedeclaration declaration source end declarationsourceend method declaration methoddeclaration declaration source start declarationsourcestart type declaration typedeclaration declaration source end declarationsourceend parent add method declaration methoddeclaration bracket balance value bracketbalancevalue methods methods recovered method recoveredmethod method count methodcount method count methodcount methods length system arraycopy methods methods recovered method recoveredmethod method count methodcount method count methodcount recovered method recoveredmethod element recovered method recoveredmethod method declaration methoddeclaration bracket balance value bracketbalancevalue recovering parser recoveringparser methods method count methodcount element opening brace found opening brace foundopeningbrace found opening brace foundopeningbrace bracket balance bracketbalance method finished method current method declaration methoddeclaration declaration source end declarationsourceend element recovered element recoveredelement add block nested block declaration nestedblockdeclaration bracket balance value bracketbalancevalue modifiers acc default accdefault parser recovered static initializer start recoveredstaticinitializerstart modifiers acc static accstatic add initializer nested block declaration nestedblockdeclaration modifiers bracket balance value bracketbalancevalue recovered element recoveredelement add field declaration fielddeclaration field declaration fielddeclaration bracket balance value bracketbalancevalue field starting passed type belonging enclosing type type declaration typedeclaration declaration source end declarationsourceend field declaration fielddeclaration declaration source start declarationsourcestart type declaration typedeclaration declaration source end declarationsourceend parent add field declaration fielddeclaration bracket balance value bracketbalancevalue fields fields recovered field recoveredfield field count fieldcount field count fieldcount fields length system arraycopy fields fields recovered field recoveredfield field count fieldcount field count fieldcount recovered field recoveredfield element field declaration fielddeclaration is field isfield recovered field recoveredfield field declaration fielddeclaration bracket balance value bracketbalancevalue recovered initializer recoveredinitializer field declaration fielddeclaration bracket balance value bracketbalancevalue fields field count fieldcount element opening brace found opening brace foundopeningbrace found opening brace foundopeningbrace bracket balance bracketbalance field finished field current field declaration fielddeclaration declaration source end declarationsourceend element recovered element recoveredelement add type declaration typedeclaration member type declaration membertypedeclaration bracket balance value bracketbalancevalue type starting passed type belonging enclosing type type declaration typedeclaration declaration source end declarationsourceend member type declaration membertypedeclaration declaration source start declarationsourcestart type declaration typedeclaration declaration source end declarationsourceend parent add member type declaration membertypedeclaration bracket balance value bracketbalancevalue member type declaration membertypedeclaration bits ast node astnode isanonymoustypemask method count methodcount add method body recovered method recoveredmethod last method lastmethod methods method count methodcount reopen method last method lastmethod method declaration methoddeclaration body end bodyend reopen method last method lastmethod method declaration methoddeclaration declaration source end declarationsourceend expect closing brace last method lastmethod bracket balance bracketbalance last method lastmethod add member type declaration membertypedeclaration bracket balance value bracketbalancevalue ignore member types membertypes member types membertypes recovered type recoveredtype member type count membertypecount member type count membertypecount member types membertypes length system arraycopy member types membertypes member types membertypes recovered type recoveredtype member type count membertypecount member type count membertypecount recovered type recoveredtype element recovered type recoveredtype member type declaration membertypedeclaration bracket balance value bracketbalancevalue member types membertypes member type count membertypecount element opening brace found opening brace foundopeningbrace found opening brace foundopeningbrace bracket balance bracketbalance member type finished member type current member type declaration membertypedeclaration declaration source end declarationsourceend element answer body parse node body end bodyend body end bodyend type declaration typedeclaration declaration source end declarationsourceend body end bodyend body starts at header end bodystartsatheaderend type declaration typedeclaration super interfaces superinterfaces type declaration typedeclaration superclass type declaration typedeclaration type parameters typeparameters type declaration typedeclaration body start bodystart type declaration typedeclaration source end sourceend type declaration typedeclaration body start bodystart type declaration typedeclaration type parameters typeparameters type declaration typedeclaration type parameters typeparameters length source end sourceend type declaration typedeclaration body start bodystart type declaration typedeclaration superclass source end sourceend type declaration typedeclaration body start bodystart type declaration typedeclaration super interfaces superinterfaces type declaration typedeclaration super interfaces superinterfaces length source end sourceend answer enclosing type node recovered type recoveredtype enclosing type enclosingtype recovered element recoveredelement current parent current current recovered type recoveredtype recovered type recoveredtype current current current parent type declaration typedeclaration answer parsed structure ast node astnode parse tree parsetree type declaration typedeclaration answer source parse node source end sourceend type declaration typedeclaration declaration source end declarationsourceend string to string tostring tab string buffer stringbuffer result string buffer stringbuffer tab string tabstring tab nls result append recovered type type declaration typedeclaration bits ast node astnode isanonymoustypemask result append tab string tabstring tab nls result append type declaration typedeclaration print tab result member types membertypes member type count membertypecount nls result append result append member types membertypes to string tostring tab fields field count fieldcount nls result append result append fields to string tostring tab methods method count methodcount nls result append result append methods to string tostring tab result to string tostring update body start bodystart parse node update body start updatebodystart body start bodystart found opening brace foundopeningbrace type declaration typedeclaration body start bodystart body start bodystart statement updated statement updatedstatement ignore closed anonymous type type declaration typedeclaration bits ast node astnode isanonymoustypemask preserve content preservecontent type declaration typedeclaration updated type updatedtype updated type declaration updatedtypedeclaration updated type updatedtype bits ast node astnode isanonymoustypemask presence anonymous type full allocation expression updated type updatedtype allocation updated type updatedtype type declaration typedeclaration updated type declaration updatedtypedeclaration update member types member type count membertypecount existing count existingcount type declaration typedeclaration member types membertypes type declaration typedeclaration member types membertypes length type declaration typedeclaration member type declarations membertypedeclarations type declaration typedeclaration existing count existingcount member type count membertypecount existing count existingcount system arraycopy type declaration typedeclaration member types membertypes member type declarations membertypedeclarations existing count existingcount update declaration source end declarationsourceend type member types membertypes member type count membertypecount type declaration typedeclaration declaration source end declarationsourceend body end value bodyendvalue body end bodyend member types membertypes member type count membertypecount type declaration typedeclaration declaration source end declarationsourceend body end value bodyendvalue member types membertypes member type count membertypecount type declaration typedeclaration body end bodyend body end value bodyendvalue member type count membertypecount member type declarations membertypedeclarations existing count existingcount member types membertypes updated type declaration updatedtypedeclaration type declaration typedeclaration member types membertypes member type declarations membertypedeclarations update fields field count fieldcount existing count existingcount type declaration typedeclaration fields type declaration typedeclaration fields length field declaration fielddeclaration field declarations fielddeclarations field declaration fielddeclaration existing count existingcount field count fieldcount existing count existingcount system arraycopy type declaration typedeclaration fields field declarations fielddeclarations existing count existingcount update declaration source end declarationsourceend field fields field count fieldcount field declaration fielddeclaration declaration source end declarationsourceend temp body end bodyend fields field count fieldcount field declaration fielddeclaration declaration source end declarationsourceend temp fields field count fieldcount field declaration fielddeclaration declaration end declarationend temp field count fieldcount field declarations fielddeclarations existing count existingcount fields updated field declaration updatedfielddeclaration type declaration typedeclaration fields field declarations fielddeclarations update methods existing count existingcount type declaration typedeclaration methods type declaration typedeclaration methods length has constructor hasconstructor has recovered constructor hasrecoveredconstructor default constructor index defaultconstructorindex method count methodcount abstract method declaration abstractmethoddeclaration method declarations methoddeclarations abstract method declaration abstractmethoddeclaration existing count existingcount method count methodcount existing count existingcount abstract method declaration abstractmethoddeclaration type declaration typedeclaration methods is default constructor isdefaultconstructor default constructor index defaultconstructorindex method declarations methoddeclarations update declaration source end declarationsourceend method methods method count methodcount method declaration methoddeclaration declaration source end declarationsourceend body end value bodyendvalue body end bodyend methods method count methodcount method declaration methoddeclaration declaration source end declarationsourceend body end value bodyendvalue methods method count methodcount method declaration methoddeclaration body end bodyend body end value bodyendvalue method count methodcount abstract method declaration abstractmethoddeclaration updated method updatedmethod methods updated method declaration updatedmethoddeclaration updated method updatedmethod is constructor isconstructor has recovered constructor hasrecoveredconstructor method declarations methoddeclarations existing count existingcount updated method updatedmethod type declaration typedeclaration methods method declarations methoddeclarations has constructor hasconstructor type declaration typedeclaration check constructors checkconstructors parser existing count existingcount type declaration typedeclaration methods is constructor isconstructor has constructor hasconstructor add clinit type declaration typedeclaration need class init method needclassinitmethod already has clinit alreadyhasclinit existing count existingcount type declaration typedeclaration methods is clinit isclinit already has clinit alreadyhasclinit already has clinit alreadyhasclinit type declaration typedeclaration add clinit addclinit add constructor default constructor index defaultconstructorindex has recovered constructor hasrecoveredconstructor discard previous constr utor construtor abstract method declaration abstractmethoddeclaration method declarations methoddeclarations abstract method declaration abstractmethoddeclaration type declaration typedeclaration methods length default constructor index defaultconstructorindex system arraycopy type declaration typedeclaration methods method declarations methoddeclarations default constructor index defaultconstructorindex default constructor index defaultconstructorindex type declaration typedeclaration methods length system arraycopy type declaration typedeclaration methods default constructor index defaultconstructorindex method declarations methoddeclarations default constructor index defaultconstructorindex type declaration typedeclaration methods length default constructor index defaultconstructorindex type declaration typedeclaration methods method declarations methoddeclarations reduced constructor has constructor hasconstructor type declaration typedeclaration is interface isinterface inside field initializer insidefieldinitializer recovered element recoveredelement parent element parentelement parent parent element parentelement parent element parentelement recovered field recoveredfield inside field initializer insidefieldinitializer parent element parentelement parent element parentelement parent type declaration typedeclaration creates internal constructor createsinternalconstructor parser diet inside field initializer insidefieldinitializer parent recovered type recoveredtype type declaration typedeclaration bits ast node astnode ismembertypemask parent recovered method recoveredmethod type declaration typedeclaration bits ast node astnode islocaltypemask type declaration typedeclaration update parse node parser disappear rest arting restarting recovery update from parser state updatefromparserstate body starts at header end bodystartsatheaderend parser parser parser protection bugs awaiting type references parser list length listlength parser ast length ptr astlengthptr length parser ast length stack astlengthstack parser ast length ptr astlengthptr ast ptr astptr parser ast ptr astptr length can consume canconsume ast ptr astptr can consume canconsume parser ast stack aststack ast ptr astptr type declaration typedeclaration can consume canconsume max length max parser ast stack aststack ast ptr astptr type reference typereference can consume canconsume can consume canconsume parser consume class header implements consumeclassheaderimplements reset type list length typelistlength check performed error check errorcheck parser list type parameter length listtypeparameterlength length parser list type parameter length listtypeparameterlength generics ptr genericsptr parser generics ptr genericsptr can consume canconsume generics ptr genericsptr length parser ast ptr astptr can consume canconsume parser ast stack aststack parser ast ptr astptr type declaration typedeclaration can consume canconsume generics ptr genericsptr length parser generics stack genericsstack generics ptr genericsptr type parameter typeparameter generics ptr genericsptr length parser generics stack genericsstack generics ptr genericsptr type parameter typeparameter can consume canconsume can consume canconsume type declaration typedeclaration type decl typedecl type declaration typedeclaration parser ast stack aststack parser ast ptr astptr system arraycopy parser generics stack genericsstack generics ptr genericsptr length type decl typedecl type parameters typeparameters type parameter typeparameter length length type decl typedecl body start bodystart type decl typedecl type parameters typeparameters length declaration source end declarationsourceend parser list type parameter length listtypeparameterlength parser last check point lastcheckpoint type decl typedecl body start bodystart closing brace consumed closed current element current element currentelement exited recovered element recoveredelement update on closing brace updateonclosingbrace brace start bracestart brace end braceend bracket balance bracketbalance parent update source end if necessary updatesourceendifnecessary brace start bracestart brace end braceend body end bodyend brace start bracestart parent opening brace consumed expected opening current element body start bodystart updated recovered element recoveredelement update on opening brace updateonopeningbrace brace start bracestart brace end braceend opening brace close signature ignore bracket balance bracketbalance parser scanner search line number searchlinenumber type declaration typedeclaration source end sourceend parser scanner search line number searchlinenumber brace end braceend parser parser parser parser last ignored token lastignoredtoken token name extends tokennameextends token name implements tokennameimplements tokennamegreater tokennameright shift tokennameunsigned shift parser recovered static initializer start recoveredstaticinitializerstart found opening brace foundopeningbrace pretend brace bracket balance bracketbalance initializer bracket balance bracketbalance block block block parser parser parser block source start sourcestart parser scanner start position startposition initializer init parser recovered static initializer start recoveredstaticinitializerstart init initializer block acc default accdefault init initializer block acc static accstatic init declaration source start declarationsourcestart parser recovered static initializer start recoveredstaticinitializerstart init body start bodystart parser scanner current position currentposition add init update on opening brace updateonopeningbrace brace start bracestart brace end braceend update parse tree updateparsetree updated type declaration updatedtypedeclaration update declaration source end declarationsourceend parse node update source end if necessary updatesourceendifnecessary start type declaration typedeclaration declaration source end declarationsourceend body end bodyend type declaration typedeclaration declaration source end declarationsourceend type declaration typedeclaration body end bodyend
copyright mateusz matela rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors mateusz matela mateusz matela gmail formatter formatter format java code correctly max width https bugs eclipse org mateusz matela mateusz matela gmail formatter index out of bounds exception indexoutofboundsexception token manager tokenmanager https bugs eclipse org mateusz matela mateusz matela gmail formatter bad breaking eclipse javadoc comments https bugs eclipse org lars vogel lars vogel vogella contributions bug org eclipse jdt internal formatter org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment block org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment javadoc org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment org eclipse jdt internal compiler parser terminal tokens terminaltokens token name not token tokennamenotatoken org eclipse jdt internal compiler parser terminal tokens terminaltokens token name string literal tokennamestringliteral org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamewhitespace org eclipse jdt internal compiler parser terminal tokens terminaltokens token name package tokennamepackage java util array list arraylist java util arrays java util collections java util hash map hashmap java util list java util map java util regex matcher java util regex pattern org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom block comment blockcomment org eclipse jdt core dom javadoc org eclipse jdt core dom line comment linecomment org eclipse jdt core dom member ref memberref org eclipse jdt core dom method ref methodref org eclipse jdt core dom qualified name qualifiedname org eclipse jdt core dom tag element tagelement org eclipse jdt core formatter code formatter codeformatter org eclipse jdt core formatter default code formatter constants defaultcodeformatterconstants org eclipse jdt internal compiler impl compiler options compileroptions org eclipse jdt internal compiler parser scanner helper scannerhelper org eclipse jdt internal formatter token wrap mode wrapmode org eclipse jdt internal formatter token wrap policy wrappolicy comments preparator commentspreparator ast visitor astvisitor comment separator length nls pattern nls tag pattern pattern compile nls nls pattern string literal pattern pattern compile pattern html tag pattern pattern html attribute pattern nls string format code tags formatcodetags pre nls string separate line tags separatelinetags table nls string break before tags breakbeforetags nls string break after tags breakaftertags nls string no format tags noformattags code nls string other tags othertags whitespace optional ast erisk asterisk nls string nls string attribute value attributevalue nls nls nls nls nls string attribute attribute value attributevalue html tag pattern pattern compile nls format code tags formatcodetags separate line tags separatelinetags break before tags breakbeforetags break after tags breakaftertags no format tags noformattags other tags othertags attribute nls nls nls pattern insensitive html attribute pattern pattern compile attribute pattern html entity pattern pattern compile nls nbsp amp circ tilde quot nls string html entity replace param tags list copied i java doc tag constants ijavadoctagconstants legacy formatter compatibility comments todo frederic param tags todo frederic investigate list created list string param tags arrays as list aslist tag element tagelement tag param tag element tagelement tag exception tag element tagelement tag serial field serialfield tag element tagelement tag list string immutable tags arrays as list aslist tag element tagelement tag code tag element tagelement tag literal token manager tokenmanager default code formatter options defaultcodeformatteroptions options string source level sourcelevel string format disable tag formatdisabletag string format enable tag formatenabletag token last line comment lastlinecomment last line comment position lastlinecommentposition token last format off comment lastformatoffcomment token manager tokenmanager ctm list token comment structure commentstructure comment indent commentindent position current comment wrapping special characters allowed allow substitute wrapping allowsubstitutewrapping no format tag open start noformattagopenstart format code tag open end formatcodetagopenend last format code closing tag index lastformatcodeclosingtagindex token first tag token firsttagtoken default code formatter defaultcodeformatter comment code formatter commentcodeformatter comments preparator commentspreparator token manager tokenmanager default code formatter options defaultcodeformatteroptions options string source level sourcelevel options options source level sourcelevel source level sourcelevel format disable tag formatdisabletag options disabling tag string options disabling tag format enable tag formatenabletag options enabling tag string options enabling tag override pre visit previsit ast node astnode node is malformed ismalformed node get flags getflags ast node astnode malformed is malformed ismalformed override visit line comment linecomment node comment index commentindex first index in firstindexin node tokennamecomment handle line comment handlelinecomment comment index commentindex handle line comment handlelinecomment comment index commentindex token comment token commenttoken comment index commentindex is on first column isonfirstcolumn handle whitespace around handlewhitespacearound comment index commentindex handle format on off tags handleformatonofftags comment token commenttoken is on first column isonfirstcolumn options comment format comment options comment format comment starting column last line comment lastlinecomment comment token commenttoken set indent setindent comment token commenttoken set wrap policy setwrappolicy options indent comments column comment token commenttoken set indent setindent comment token commenttoken set wrap policy setwrappolicy handlenlstags comment token commenttoken comment index commentindex position in line positioninline find source position in line findsourcepositioninline comment token commenttoken original start originalstart is continuation iscontinuation comment index commentindex comment index commentindex last line comment lastlinecomment position in line positioninline last line comment position lastlinecommentposition options indentation size count line breaks between countlinebreaksbetween last line comment lastlinecomment comment token commenttoken is header isheader is in header isinheader comment index commentindex for matting enabled formattingenabled options comment format comment is header isheader options comment format header is header isheader for matting enabled formattingenabled preserve whitespace preservewhitespace comment token commenttoken comment index commentindex is continuation iscontinuation wrap policy wrappolicy policy last line comment lastlinecomment get wrap policy getwrappolicy policy line start linestart get position in line getpositioninline find first token in line findfirsttokeninline comment index commentindex comment start commentstart get position in line getpositioninline comment index commentindex policy wrap policy wrappolicy wrap mode wrapmode comment index commentindex comment start commentstart line start linestart comment token commenttoken set wrap policy setwrappolicy policy last line comment lastlinecomment comment token commenttoken comment token commenttoken get line breaks before getlinebreaksbefore last line comment lastlinecomment comment token commenttoken last line comment position lastlinecommentposition position in line positioninline list token structure tokenize line comment tokenizelinecomment comment token commenttoken is continuation iscontinuation token structure break before breakbefore set wrap policy setwrappolicy wrap policy wrappolicy wrap mode wrapmode comment index commentindex last line comment position lastlinecommentposition merge previous current comment token previous last line comment lastlinecomment token merged token previous previous original start originalstart comment token commenttoken original end originalend previous token type tokentype remove comment index commentindex insert comment index commentindex merged remove comment index commentindex list token last structure laststructure last line comment lastlinecomment get internal structure getinternalstructure last structure laststructure add all addall structure merged set internal structure setinternalstructure last structure laststructure last line comment lastlinecomment merged comment token commenttoken set internal structure setinternalstructure structure handle compiler tags handlecompilertags comment token commenttoken comment index commentindex preserve whitespace preservewhitespace comment token commenttoken comment index commentindex last line comment lastlinecomment comment token commenttoken last line comment position lastlinecommentposition position in line positioninline preserve whitespace preservewhitespace token comment token commenttoken comment index commentindex options comment preserve white space code comments comment token commenttoken get line breaks before getlinebreaksbefore comment index commentindex comment token commenttoken clear space before clearspacebefore list token structure comment token commenttoken get internal structure getinternalstructure structure structure is empty isempty structure clear space before clearspacebefore token previous comment index commentindex previous clear space after clearspaceafter previous original end originalend comment token commenttoken original start originalstart structure structure is empty isempty structure array list arraylist structure add token previous original end originalend comment token commenttoken original end originalend tokennamecomment comment token commenttoken set internal structure setinternalstructure structure structure add token previous original end originalend comment token commenttoken original start originalstart tokennamewhitespace comment tag for matted formatted handle format on off tags handleformatonofftags token comment token commenttoken options tags string comment string commentstring to string tostring comment token commenttoken off index offindex format disable tag formatdisabletag comment string commentstring last index of lastindexof format disable tag formatdisabletag on index onindex format enable tag formatenabletag comment string commentstring last index of lastindexof format enable tag formatenabletag last format off comment lastformatoffcomment off index offindex on index onindex last format off comment lastformatoffcomment comment token commenttoken on index onindex off index offindex add disable format token pair adddisableformattokenpair last format off comment lastformatoffcomment comment token commenttoken last format off comment lastformatoffcomment off index offindex on index onindex handlenlstags token comment comment index commentindex list token string literals stringliterals find string literals in line findstringliteralsinline comment index commentindex string literals stringliterals is empty isempty list token comment fragments commentfragments array list arraylist matcher matcher nls tag pattern matcher to string tostring comment previous matcher end previousmatcherend nls found nlsfound matcher find nls number nlsnumber integer parse int parseint matcher group nls number nlsnumber nls number nlsnumber string literals stringliterals size matcher start previous matcher end previousmatcherend token fragment token comment original start originalstart previous matcher end previousmatcherend comment original start originalstart matcher start tokennamecomment comment fragments commentfragments add fragment token nls tag nlstag token comment original start originalstart matcher start comment original start originalstart matcher tokennamecomment string literals stringliterals nls number nlsnumber setnlstag nls tag nlstag nls tag nlstag setnlstag string literals stringliterals nls number nlsnumber comment fragments commentfragments add nls tag nlstag nls found nlsfound previous matcher end previousmatcherend matcher nls found nlsfound comment set internal structure setinternalstructure comment fragments commentfragments comment original start originalstart previous matcher end previousmatcherend comment original end originalend token fragment token comment original start originalstart previous matcher end previousmatcherend comment original end originalend tokennamecomment comment fragments commentfragments add fragment handle compiler tags handlecompilertags token comment token commenttoken comment index commentindex string comment text commenttext to string tostring comment token commenttoken list token structure comment token commenttoken get internal structure getinternalstructure nls comment text commenttext starts with startswith fall nls comment text commenttext starts with startswith identity comparison structure clear space before clearspacebefore nls comment text commenttext identity comparison broken token token comment token commenttoken comment index commentindex token left count line breaks between countlinebreaksbetween left token token clear line breaks before clearlinebreaksbefore left clear line breaks after clearlinebreaksafter token set wrap policy setwrappolicy wrap policy wrappolicy disable wrap token left list token find string literals in line findstringliteralsinline last token index lasttokenindex list token string literals stringliterals array list arraylist token previous last token index lasttokenindex last token index lasttokenindex token token count line breaks between countlinebreaksbetween token previous token token type tokentype token name string literal tokennamestringliteral string literals stringliterals add token previous token collections reverse string literals stringliterals string literals stringliterals list token tokenize line comment tokenizelinecomment token comment token commenttoken list token fragments comment token commenttoken get internal structure getinternalstructure fragments fragments arrays as list aslist comment token commenttoken array list arraylist token result array list arraylist fragments size token token fragments token hasnlstag scanner helper scannerhelper is whitespace iswhitespace char at charat token original start originalstart token space before spacebefore result add token source position sourceposition token original start originalstart source position sourceposition comment token commenttoken original start originalstart separate starting slashes source position sourceposition token original end originalend char at charat source position sourceposition source position sourceposition result add token comment token commenttoken original start originalstart source position sourceposition tokennamecomment token start tokenstart source position sourceposition source position sourceposition token original end originalend source position sourceposition token original end originalend scanner helper scannerhelper is whitespace iswhitespace char at charat source position sourceposition token start tokenstart source position sourceposition token output token outputtoken token token start tokenstart source position sourceposition tokennamecomment output token outputtoken space before spacebefore result add output token outputtoken token start tokenstart source position sourceposition source position sourceposition result override visit block comment blockcomment node comment index commentindex first index in firstindexin node tokennamecomment block handle block comment handleblockcomment comment index commentindex handle block comment handleblockcomment comment index commentindex token comment token commenttoken comment index commentindex is first column isfirstcolumn handle whitespace around handlewhitespacearound comment index commentindex handle format on off tags handleformatonofftags comment token commenttoken is header isheader is in header isinheader comment index commentindex for matting enabled formattingenabled options comment format block comment is header isheader options comment format header is header isheader for matting enabled formattingenabled for matting enabled formattingenabled char at charat comment token commenttoken original start originalstart for matting enabled formattingenabled tokenize multiline comment tokenizemultilinecomment comment token commenttoken comment structure commentstructure comment token commenttoken get internal structure getinternalstructure ctm token manager tokenmanager comment structure commentstructure handle string literals handlestringliterals to string tostring comment token commenttoken comment token commenttoken original start originalstart add substitute wraps addsubstitutewraps comment token commenttoken set internal structure setinternalstructure comment to lines commenttolines comment token commenttoken options indent block comments column is first column isfirstcolumn comment token commenttoken set indent setindent comment token commenttoken set wrap policy setwrappolicy handle whitespace around handlewhitespacearound comment index commentindex token comment token commenttoken comment index commentindex char before charbefore comment token commenttoken original start originalstart char at charat comment token commenttoken original start originalstart char before charbefore char before charbefore comment token commenttoken space before spacebefore comment token commenttoken original end originalend get source length getsourcelength char after charafter char at charat comment token commenttoken original end originalend char after charafter char after charafter comment token commenttoken space after spaceafter token previous existing breaks before existingbreaksbefore existing breaks after existingbreaksafter comment index commentindex previous comment index commentindex existing breaks before existingbreaksbefore count line breaks between countlinebreaksbetween previous comment token commenttoken existing breaks before existingbreaksbefore comment token commenttoken break before breakbefore comment token commenttoken clear space before clearspacebefore comment index commentindex size comment index commentindex existing breaks after existingbreaksafter count line breaks between countlinebreaksbetween comment token commenttoken existing breaks after existingbreaksafter comment token commenttoken break after breakafter existing breaks before existingbreaksbefore previous token type tokentype tokennamecomment previous token type tokentype tokennamecomment block comment token commenttoken set wrap policy setwrappolicy previous get wrap policy getwrappolicy comment index commentindex existing breaks after existingbreaksafter size token type tokentype tokennamecomment token type tokentype tokennamecomment block token existing breaks after existingbreaksafter count line breaks between countlinebreaksbetween existing breaks before existingbreaksbefore existing breaks after existingbreaksafter previous comment token commenttoken put line breaks after putlinebreaksafter previous get line breaks after getlinebreaksafter previous clear line breaks after clearlinebreaksafter existing breaks after existingbreaksafter existing breaks before existingbreaksbefore token type tokentype token name package tokennamepackage doesn apply comment declaration comment token commenttoken put line breaks before putlinebreaksbefore get line breaks before getlinebreaksbefore clear line breaks before clearlinebreaksbefore is first column isfirstcolumn char before charbefore char before charbefore comment token commenttoken original start originalstart is first column isfirstcolumn list token comment to lines commenttolines token comment token commenttoken comment start position in line commentstartpositioninline list token lines array list arraylist tab options tab size string comment text commenttext to string tostring comment token commenttoken comment start position commentstartposition comment start position in line commentstartpositioninline comment start position commentstartposition comment start position commentstartposition find source position in line findsourcepositioninline comment token commenttoken original start originalstart position in line positioninline comment start position commentstartposition line start linestart breaks before first line breaksbeforefirstline lines notatoken disable ast erisk asterisk adding first line firstline empty line emptyline comment text commenttext length comment text commenttext char at charat line start linestart position in line positioninline comment start position commentstartposition empty line emptyline position in line positioninline comment token commenttoken get indent getindent line start linestart position in line positioninline line start linestart position in line positioninline comment start position commentstartposition empty line emptyline position in line positioninline comment token commenttoken get indent getindent line start linestart tab position in line positioninline tab position in line positioninline tab line start linestart token token comment token commenttoken original start originalstart line start linestart comment token commenttoken original start originalstart first line firstline comment token commenttoken token type tokentype token name not token tokennamenotatoken break after breakafter lines is empty isempty put line breaks before putlinebreaksbefore breaks before first line breaksbeforefirstline lines add lines is empty isempty token previous line previousline lines lines size previous line previousline put line breaks after putlinebreaksafter previous line previousline get line breaks after getlinebreaksafter breaks before first line breaksbeforefirstline comment text commenttext length comment text commenttext char at charat line start linestart position in line positioninline first line firstline empty line emptyline position in line positioninline empty line emptyline line start linestart comment text commenttext length token token comment token commenttoken original start originalstart line start linestart comment token commenttoken original end originalend first line firstline comment token commenttoken token type tokentype token name not token tokennamenotatoken set wrap policy setwrappolicy wrap policy wrappolicy disable wrap lines add lines override visit javadoc node no format tag open start noformattagopenstart format code tag open end formatcodetagopenend last format code closing tag index lastformatcodeclosingtagindex first tag token firsttagtoken ctm comment index commentindex first index in firstindexin node tokennamecomment javadoc token comment token commenttoken comment index commentindex node get parent getparent proper javadoc treat block comment handle whitespace around handlewhitespacearound comment index commentindex comment index commentindex size comment token commenttoken break after breakafter handle format on off tags handleformatonofftags comment token commenttoken is header isheader is in header isinheader comment index commentindex for matting enabled formattingenabled options comment format javadoc comment is header isheader options comment format header is header isheader for matting enabled formattingenabled tokenize multiline comment tokenizemultilinecomment comment token commenttoken comment token commenttoken set internal structure setinternalstructure comment to lines commenttolines comment token commenttoken comment structure commentstructure comment token commenttoken get internal structure getinternalstructure comment indent commentindent to indent toindent comment token commenttoken get indent getindent ctm token manager tokenmanager comment token commenttoken get internal structure getinternalstructure override end visit endvisit javadoc node ctm options comment insert empty root tags first tag token firsttagtoken ctm index of indexof first tag token firsttagtoken first tag token firsttagtoken put line breaks before putlinebreaksbefore add substitute wraps addsubstitutewraps override visit tag element tagelement node string tag name tagname node get tag name gettagname tag name tagname tag name tagname length start index startindex token starting at tokenstartingat node get start position getstartposition node end nodeend node get start position getstartposition node get length getlength scanner helper scannerhelper is whitespace iswhitespace ctm char at charat node end nodeend node end nodeend end index endindex token ending at tokenendingat node end nodeend ctm start index startindex set wrap policy setwrappolicy wrap policy wrappolicy disable wrap node get parent getparent javadoc ctm to string tostring start index startindex starts with startswith tag name tagname is param tag isparamtag param tags tag name tagname is param tag isparamtag options comment insert parameter start index startindex end index endindex token token ctm start index startindex token break before breakbefore options comment indent root tags indent ctm get length getlength ctm start index startindex is param tag isparamtag options comment indent parameter description indent options indentation size start index startindex end index endindex token token ctm token set indent setindent indent indent temp orarily temporarily tokens changed align indent reserved code pre tags token start to keen starttokeen ctm start index startindex start index startindex start to keen starttokeen break before breakbefore first tag index firsttagindex first tag token firsttagtoken first tag index firsttagindex ctm index of indexof first tag token firsttagtoken start index startindex first tag index firsttagindex first tag token firsttagtoken start to keen starttokeen handle html handlehtml node node is nested isnested immutable tags tag name tagname start index startindex end index endindex disable formatting disableformatting start index startindex end index endindex override end visit endvisit tag element tagelement node string tag name tagname node get tag name gettagname tag name tagname tag name tagname length handle html handlehtml node tag element tagelement tag equals tag name tagname handle string literals handlestringliterals to string tostring node node get start position getstartposition handle html handlehtml tag element tagelement node options comment format html options comment format source string text to string tostring node matcher matcher html tag pattern matcher text matcher find start pos startpos matcher start node get start position getstartposition end pos endpos matcher node get start position getstartposition is opening tag isopeningtag matcher start matcher options comment format html tokens tag wrapped substitute first token index firsttokenindex token starting at tokenstartingat start pos startpos last token index lasttokenindex token ending at tokenendingat end pos endpos first token index firsttokenindex last token index lasttokenindex token token ctm token get wrap policy getwrappolicy token set wrap policy setwrappolicy wrap policy wrappolicy substitute wraps equals sign attributes string attributes text attributestext matcher group matcher attr matcher attrmatcher html attribute pattern matcher attributes text attributestext comment start commentstart ctm original start originalstart attr matcher attrmatcher find equal pos equalpos node get start position getstartposition matcher start attr matcher attrmatcher start char at charat equal pos equalpos allow substitute wrapping allowsubstitutewrapping equal pos equalpos comment start commentstart matched groups matchedgroups matcher start matcher matched groups matchedgroups matched groups matchedgroups matcher start matcher handle format code tag handleformatcodetag start pos startpos end pos endpos is opening tag isopeningtag options comment format html tag element tagelement tag param equals node get tag name gettagname ctm find index findindex start pos startpos ctm first index in firstindexin node parameter html tag matcher start matcher handle separate line tag handleseparatelinetag start pos startpos end pos endpos matcher start matcher handle break before tag handlebreakbeforetag start pos startpos end pos endpos is opening tag isopeningtag matcher start matcher handle break after tag handlebreakaftertag start pos startpos end pos endpos matcher start matcher handle no format tag handlenoformattag start pos startpos end pos endpos is opening tag isopeningtag override visit method ref methodref node handle reference handlereference node override visit member ref memberref node handle reference handlereference node override visit qualified name qualifiedname node handle reference handlereference node handle reference handlereference ast node astnode node ast node astnode parent node get parent getparent parent tag element tagelement tag element tagelement parent is nested isnested first index firstindex token starting at tokenstartingat node get start position getstartposition last index lastindex token ending at tokenendingat node get start position getstartposition node get length getlength ctm char at charat ctm last index lastindex original start originalstart last index lastindex first index firstindex last index lastindex token token ctm token set wrap policy setwrappolicy wrap policy wrappolicy disable wrap handle string literals handlestringliterals string text text start position textstartposition matcher matcher string literal pattern matcher text matcher find start position startposition text start position textstartposition matcher start start index startindex ctm find index findindex start position startposition end position endposition text start position textstartposition matcher end index endindex ctm find index findindex end position endposition start index startindex end index endindex start index startindex token starting at tokenstartingat start position startposition end index endindex token ending at tokenendingat end position endposition disable formatting disableformatting start index startindex end index endindex no substitute wrapping nosubstitutewrapping start position startposition end position endposition handle separate line tag handleseparatelinetag start pos startpos end pos endpos opening tag index openingtagindex token starting at tokenstartingat start pos startpos opening tag index openingtagindex last format code closing tag index lastformatcodeclosingtagindex opening tag index openingtagindex token token ctm opening tag index openingtagindex token get line breaks after getlinebreaksafter token clear line breaks after clearlinebreaksafter token break after breakafter handle break before tag handlebreakbeforetag start pos startpos end pos endpos handle break after tag handlebreakaftertag start pos startpos end pos endpos handle break before tag handlebreakbeforetag start is opening tag isopeningtag first part index firstpartindex token starting at tokenstartingat start last part index lastpartindex token ending at tokenendingat token first part token firstparttoken ctm first part index firstpartindex first part token firstparttoken set wrap policy setwrappolicy is opening tag isopeningtag first part token firstparttoken break before breakbefore ctm last part index lastpartindex clear space before clearspacebefore first part token firstparttoken clear space before clearspacebefore handle break after tag handlebreakaftertag start token index tokenindex token ending at tokenendingat ctm token index tokenindex break after breakafter handle no format tag handlenoformattag start is opening tag isopeningtag is opening tag isopeningtag no format tag open start noformattagopenstart no format tag open start noformattagopenstart start no format tag open start noformattagopenstart opening tag index openingtagindex token starting at tokenstartingat no format tag open start noformattagopenstart closing tag index closingtagindex token ending at tokenendingat opening tag index openingtagindex closing tag index closingtagindex disable formatting disableformatting opening tag index openingtagindex closing tag index closingtagindex closing tag index closingtagindex token ending at tokenendingat cleanuphtmlelement opening tag index openingtagindex closing tag index closingtagindex no format tag open start noformattagopenstart handle format code tag handleformatcodetag start pos startpos end pos endpos is opening tag isopeningtag options comment format source handle no format tag handlenoformattag start pos startpos end pos endpos is opening tag isopeningtag add empty lines opening closing token handle separate line tag handleseparatelinetag start pos startpos end pos endpos is opening tag isopeningtag start index startindex token starting at tokenstartingat start pos startpos start index startindex ctm start index startindex put line breaks before putlinebreaksbefore format code tag open end formatcodetagopenend format code tag open end formatcodetagopenend end pos endpos format code tag open end formatcodetagopenend end tag index endtagindex token ending at tokenendingat end pos endpos end tag index endtagindex ctm size ctm end tag index endtagindex put line breaks after putlinebreaksafter format code formatcode start pos startpos end pos endpos format code tag open end formatcodetagopenend last format code closing tag index lastformatcodeclosingtagindex ctm find index findindex start pos startpos cleanuphtmlelement opening tag index openingtagindex closing tag index closingtagindex for matted code formattedcode token previous ctm opening tag index openingtagindex indent previous get indent getindent opening tag index openingtagindex closing tag index closingtagindex token token ctm token set to escape settoescape for matted code formattedcode token get line breaks before getlinebreaksbefore previous get line breaks after getlinebreaksafter token set align setalign indent previous token closing tag index closingtagindex ctm size token token ctm token get indent getindent token set indent setindent indent previous token disable formatting disableformatting start index startindex end index endindex token start token starttoken ctm start index startindex end token endtoken ctm end index endindex token no format token noformattoken token start token starttoken original start originalstart end token endtoken original end originalend tokennamecomment javadoc list token tokens to replace tokenstoreplace comment structure commentstructure sub list sublist start index startindex end index endindex ctm count line breaks between countlinebreaksbetween start token starttoken end token endtoken tokens to replace tokenstoreplace clear tokens to replace tokenstoreplace add no format token noformattoken comment start commentstart find comment line indent findcommentlineindent start index startindex tokens to replace tokenstoreplace clear tokens to replace tokenstoreplace add all addall comment to lines commenttolines no format token noformattoken comment start commentstart token tokens to replace tokenstoreplace tokens to replace tokenstoreplace tokens to replace tokenstoreplace size start token starttoken is space before isspacebefore space before spacebefore put line breaks before putlinebreaksbefore start token starttoken get line breaks before getlinebreaksbefore set wrap policy setwrappolicy start token starttoken get wrap policy getwrappolicy end token endtoken is space after isspaceafter space after spaceafter put line breaks after putlinebreaksafter end token endtoken get line breaks after getlinebreaksafter token token tokens to replace tokenstoreplace token token type tokentype tokennamecomment javadoc token set indent setindent start token starttoken get indent getindent disable formatting exc lusively disableformattingexclusively opening tag index openingtagindex closing tag index closingtagindex token opening tag openingtag ctm opening tag index openingtagindex no format start noformatstart opening tag openingtag original end originalend no format end noformatend ctm closing tag index closingtagindex original end originalend no format start noformatstart no format end noformatend token no format token noformattoken token no format start noformatstart no format end noformatend tokennamecomment javadoc comment start commentstart find comment line indent findcommentlineindent opening tag index openingtagindex list token lines comment to lines commenttolines no format token noformattoken comment start commentstart list token tokens to replace tokenstoreplace comment structure commentstructure sub list sublist opening tag index openingtagindex closing tag index closingtagindex tokens to replace tokenstoreplace clear tokens to replace tokenstoreplace add all addall lines comment structure commentstructure sub list sublist opening tag index openingtagindex closing tag index closingtagindex clear token closing tag closingtag ctm closing tag index closingtagindex ctm count line breaks between countlinebreaksbetween opening tag openingtag closing tag closingtag opening tag openingtag clear line breaks after clearlinebreaksafter closing tag closingtag clear line breaks before clearlinebreaksbefore find comment line indent findcommentlineindent comment fragment index commentfragmentindex position ctm comment fragment index commentfragmentindex original start originalstart last non whitespace lastnonwhitespace position position ctm char at charat position scanner helper scannerhelper is whitespace iswhitespace last non whitespace lastnonwhitespace position last non whitespace lastnonwhitespace ctm char at charat last non whitespace lastnonwhitespace last non whitespace lastnonwhitespace ctm get length getlength position last non whitespace lastnonwhitespace token starting at tokenstartingat start token index tokenindex ctm find index findindex start token token ctm token index tokenindex token original start originalstart start token index tokenindex start token original start originalstart start token original end originalend split token splittoken token token index tokenindex start token index tokenindex token ending at tokenendingat token index tokenindex ctm find index findindex token token ctm token index tokenindex token original end originalend token index tokenindex token original end originalend token original start originalstart split token splittoken token token index tokenindex token index tokenindex split token splittoken token token token index tokenindex split position splitposition split position splitposition token original start originalstart split position splitposition token original end originalend token token token original start originalstart split position splitposition token token type tokentype token token split position splitposition token original end originalend token token type tokentype token is space before isspacebefore space before spacebefore put line breaks before putlinebreaksbefore token get line breaks before getlinebreaksbefore token is space after isspaceafter space after spaceafter put line breaks after putlinebreaksafter token get line breaks after getlinebreaksafter set indent setindent token get indent getindent set indent setindent token get indent getindent set wrap policy setwrappolicy token get wrap policy getwrappolicy comment structure commentstructure token index tokenindex comment structure commentstructure add token index tokenindex tokenize multiline comment tokenizemultilinecomment token comment token commenttoken allow substitute wrapping allowsubstitutewrapping allow substitute wrapping allowsubstitutewrapping length comment token commenttoken count chars countchars allow substitute wrapping allowsubstitutewrapping comment token commenttoken count chars countchars is javadoc isjavadoc comment token commenttoken token type tokentype tokennamecomment javadoc arrays fill allow substitute wrapping allowsubstitutewrapping comment token commenttoken count chars countchars is javadoc isjavadoc clean blank lines cleanblanklines is javadoc isjavadoc options comment clear blank lines javadoc comment options comment clear blank lines block comment list token structure array list arraylist first token end firsttokenend comment token commenttoken original start originalstart first token end firsttokenend comment token commenttoken original end originalend char at charat first token end firsttokenend first token end firsttokenend token token comment token commenttoken original start originalstart first token end firsttokenend comment token commenttoken token type tokentype space after spaceafter structure add last token start lasttokenstart comment token commenttoken original end originalend last token start lasttokenstart first token end firsttokenend char at charat last token start lasttokenstart last token start lasttokenstart position first token end firsttokenend line breaks linebreaks position comment token commenttoken original end originalend find start position last token start lasttokenstart char at charat line breaks linebreaks char at charat position scanner helper scannerhelper is whitespace iswhitespace char at charat line breaks linebreaks position token start tokenstart position position comment token commenttoken original end originalend position comment token commenttoken original end originalend position last token start lasttokenstart scanner helper scannerhelper is whitespace iswhitespace char at charat position token start tokenstart position token output token outputtoken token token start tokenstart position comment token commenttoken token type tokentype output token outputtoken space before spacebefore line breaks linebreaks clean blank lines cleanblanklines line breaks linebreaks line breaks linebreaks options join lines comments output token outputtoken put line breaks before putlinebreaksbefore line breaks linebreaks char at charat token start tokenstart output token outputtoken set wrap policy setwrappolicy wrap policy wrappolicy disable wrap comment token commenttoken token type tokentype tokennamecomment block line breaks linebreaks structure size output token outputtoken put line breaks before putlinebreaksbefore clean blank lines cleanblanklines char at charat token start tokenstart line breaks linebreaks first tag token firsttagtoken commons attributes annotation bug first tag token firsttagtoken output token outputtoken structure add output token outputtoken line breaks linebreaks token start tokenstart position last token start lasttokenstart position position position token structure structure size new lines at bound ries newlinesatboundries comment token commenttoken token type tokentype tokennamecomment javadoc options comment lines javadoc bound aries boundaries options comment lines block bound aries boundaries new lines at bound ries newlinesatboundries count line breaks between countlinebreaksbetween break after breakafter break before breakbefore set align setalign structure size comment token commenttoken set internal structure setinternalstructure structure no substitute wrapping nosubstitutewrapping comment start commentstart ctm original start originalstart comment start commentstart ctm ctm size original end originalend arrays fill allow substitute wrapping allowsubstitutewrapping comment start commentstart comment start commentstart add substitute wraps addsubstitutewraps comment start commentstart ctm original start originalstart ctm size token token ctm to uches previous touchesprevious token original start originalstart ctm original end originalend to uches previous touchesprevious token get wrap policy getwrappolicy token get line breaks before getlinebreaksbefore allow wrap allowwrap allow substitute wrapping allowsubstitutewrapping token original start originalstart comment start commentstart token set wrap policy setwrappolicy allow wrap allowwrap wrap policy wrappolicy substitute wrap policy wrappolicy disable wrap pos token original start originalstart pos token original end originalend pos allow substitute wrapping allowsubstitutewrapping pos comment start commentstart ctm char at charat pos scanner helper scannerhelper is java identifier part isjavaidentifierpart ctm token starting at tokenstartingat pos set wrap policy setwrappolicy wrap policy wrappolicy substitute ctm token starting at tokenstartingat pos set wrap policy setwrappolicy wrap policy wrappolicy substitute format code formatcode javadoc no format close start javadocnoformatclosestart javadoc no format close end javadocnoformatcloseend opening tag last index openingtaglastindex token ending at tokenendingat format code tag open end formatcodetagopenend closing tag first index closingtagfirstindex token starting at tokenstartingat javadoc no format close start javadocnoformatclosestart code start position codestartposition format code tag open end formatcodetagopenend code end position codeendposition javadoc no format close start javadocnoformatclosestart string builder stringbuilder code builder codebuilder string builder stringbuilder code end position codeendposition code start position codestartposition position mapping positionmapping code end position codeendposition code start position codestartposition original source position start position startposition position code string get code to format getcodetoformat code start position codestartposition code end position codeendposition code builder codebuilder position mapping positionmapping list token for matted tokens formattedtokens get comment code formatter getcommentcodeformatter prepare for matted code prepareformattedcode code builder codebuilder to string tostring code formatter codeformatter unknown for matted tokens formattedtokens disable formatting exc lusively disableformattingexclusively opening tag last index openingtaglastindex closing tag first index closingtagfirstindex closing tag first index closingtagfirstindex token starting at tokenstartingat javadoc no format close start javadocnoformatclosestart cleanuphtmlelement opening tag last index openingtaglastindex closing tag first index closingtagfirstindex for matted tokens formattedtokens translate for matted tokens translateformattedtokens code start position codestartposition for matted tokens formattedtokens position mapping positionmapping line breaks linebreaks start token start for matted tokens formattedtokens start put line breaks before putlinebreaksbefore start get line breaks before getlinebreaksbefore token for matted tokens formattedtokens for matted tokens formattedtokens size put line breaks after putlinebreaksafter get line breaks after getlinebreaksafter breaks closing tag ctm closing tag first index closingtagfirstindex clear line breaks before clearlinebreaksbefore list token tokens to replace tokenstoreplace comment structure commentstructure sub list sublist opening tag last index openingtaglastindex closing tag first index closingtagfirstindex tokens to replace tokenstoreplace clear tokens to replace tokenstoreplace add all addall for matted tokens formattedtokens cleanuphtmlelement opening tag last index openingtaglastindex opening tag last index openingtaglastindex for matted tokens formattedtokens size default code formatter defaultcodeformatter get comment code formatter getcommentcodeformatter comment code formatter commentcodeformatter map string string options options get map getmap options default code formatter constants defaultcodeformatterconstants formatter comment length string value of valueof options comment length comment indent commentindent comment separator length options default code formatter constants defaultcodeformatterconstants formatter split string value of valueof options width comment indent commentindent comment separator length options compiler options compileroptions option source source level sourcelevel comment code formatter commentcodeformatter default code formatter defaultcodeformatter options comment code formatter commentcodeformatter get code to format getcodetoformat start pos startpos end pos endpos string builder stringbuilder pos mapping posmapping original source position start pos startpos position skip exc essive excessive ctm char at charat position start pos startpos pos mapping posmapping position length ctm char at charat position start pos startpos pos mapping posmapping position length position start pos startpos end pos endpos line start linestart position start pos startpos line start linestart ctm char at charat append line start linestart scanner helper scannerhelper is whitespace iswhitespace line start linestart ctm char at charat line end lineend end pos endpos line start linestart end pos endpos ctm char at charat line end lineend position start pos startpos line start linestart pos mapping posmapping position length html entity start htmlentitystart line start linestart line end lineend ctm char at charat append pos mapping posmapping position length html entity start htmlentitystart html entity start htmlentitystart replacement char replacementchar get html entity char gethtmlentitychar ctm get source getsource substring html entity start htmlentitystart replacement char replacementchar set length setlength length html entity start htmlentitystart append replacement char replacementchar position html entity start htmlentitystart position pos mapping posmapping length html entity start htmlentitystart remove empty length char at charat length delete char at deletecharat length length char at charat length delete char at deletecharat length length char at charat length delete char at deletecharat length get html entity char gethtmlentitychar string entity matcher matcher html entity pattern matcher entity matcher find replace char replacechar html entity replace length start matcher start matcher start group matched replace char replacechar group matched replace char replacechar integer parse int parseint entity substring start replace char replacechar integer parse int parseint entity substring start replace char replacechar html entity replace char at charat replace char replacechar list token translate for matted tokens translateformattedtokens start position startposition list token for matted tokens formattedtokens position mapping positionmapping hash map hashmap token token translation map translationmap previous line breaks previouslinebreaks list token result array list arraylist token token for matted tokens formattedtokens new start newstart arrays binary search binarysearch position mapping positionmapping token original start originalstart new start newstart position mapping positionmapping new start newstart token original start originalstart new start newstart new end newend arrays binary search binarysearch position mapping positionmapping token original end originalend new end newend position mapping positionmapping length position mapping positionmapping new end newend token original end originalend new end newend token translated token token new start newstart start position startposition new end newend start position startposition token token type tokentype translated get wrap policy getwrappolicy translated set wrap policy setwrappolicy wrap policy wrappolicy disable wrap token hasnlstag translation map translationmap token translated line breaks linebreaks math max previous line breaks previouslinebreaks token get line breaks before getlinebreaksbefore list token structure token get internal structure getinternalstructure structure structure is empty isempty translation map translationmap translation map translationmap hash map hashmap translated set internal structure setinternalstructure translate for matted tokens translateformattedtokens start position startposition structure position mapping positionmapping translation map translationmap translated put line breaks before putlinebreaksbefore line breaks linebreaks result add translated previous line breaks previouslinebreaks token get line breaks after getlinebreaksafter result result size put line breaks after putlinebreaksafter previous line breaks previouslinebreaks token translated result translated getnlstag token nls tag token nlstagtoken translation map translationmap translated getnlstag translated setnlstag nls tag token nlstagtoken nls tag token nlstagtoken setnlstag translated translated getnlstag result finish up finishup last format off comment lastformatoffcomment add disable format token pair adddisableformattokenpair last format off comment lastformatoffcomment size
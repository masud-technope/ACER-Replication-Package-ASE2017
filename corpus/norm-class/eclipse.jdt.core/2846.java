copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt core tests model java util hash map hashmap org eclipse core resources i workspace runnable iworkspacerunnable org eclipse core resources resources plugin resourcesplugin org eclipse core runtime org eclipse jdt core org eclipse jdt internal core java model manager javamodelmanager org eclipse jdt internal core java project javaproject junit framework release reg res sion regression test failing testing hang suppress warnings suppresswarnings rawtypes thread safety tests threadsafetytests modifying resource tests modifyingresourcetests thread safety tests threadsafetytests string test suite build model test suite buildmodeltestsuite thread safety tests threadsafetytests dead locked deadlocked act ivating activating initializer concurrent action pop ulating populating java model javamodel test deadlock testdeadlock core exception coreexception system println test deadlock scenario i java project ijavaproject project create java project createjavaproject string string org eclipse jdt core tests model test container simulate startup flush containers discard previous values wait until indexes ready waituntilindexesready project get java model getjavamodel close java model manager javamodelmanager manager java model manager javamodelmanager get java model manager getjavamodelmanager manager previous session containers previoussessioncontainers hash map hashmap manager containers hash map hashmap manager remove per project info removeperprojectinfo java project javaproject project remove external jar files indexes times tamps timestamps thread hold lock recreate potential deadlock situation acquisition wait semaphore step semaphore permission populate java model javamodel ind ucing inducing containers inits acquisition wait semaphore step semaphore permission perform resource modification semaphore has completed hascompleted semaphore container initializer containerinitializer set initializer setinitializer default container initializer defaultcontainerinitializer string initialize i path ipath container path containerpath i java project ijavaproject java project javaproject core exception coreexception step release system println thread current thread currentthread initializer started attempting acquire workspace lock initialize container path containerpath java project javaproject system println thread current thread currentthread initializer finished trigger delta notification thread thread perform java operation inside workspace lock performjavaoperationinsideworkspacelock thread runnable resources plugin resourcesplugin get workspace getworkspace i workspace runnable iworkspacerunnable i progress monitor iprogressmonitor monitor core exception coreexception system println thread current thread currentthread workspace lock step release ensure java model lock step acquire thread safety tests threadsafetytests create file createfile java system println thread current thread currentthread created file java core exception coreexception has completed hascompleted release system println thread current thread currentthread resource modification resourcemodification modify resource modifyresource perform java operation inside workspace lock performjavaoperationinsideworkspacelock set daemon setdaemon perform java operation inside workspace lock performjavaoperationinsideworkspacelock start thread attempt populate the java model attemptpopulatethejavamodel thread runnable ensure workspace lock step acquire system println thread current thread currentthread populate java model java model javamodel lock populate project trigger classpath initializer activation requires workspace lock project get children getchildren system println thread current thread currentthread pop ulating populating model java model exception javamodelexception has completed hascompleted release system println thread current thread currentthread populate java model javamodel populate model populatemodel attempt populate the java model attemptpopulatethejavamodel set daemon setdaemon attempt populate the java model attemptpopulatethejavamodel start ensure actions complete has completed hascompleted acquire has completed hascompleted acquire system println success deadlock encountered cleanup delete project deleteproject
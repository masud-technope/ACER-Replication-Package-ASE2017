copyright bea systems rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors mkaufman bea initial api implementation wharley bea ref actored refactored reinstated reconcile time type gen org eclipse jdt apt core internal generated file generatedfile java buffered input stream bufferedinputstream java byte array input stream bytearrayinputstream java io exception ioexception java input stream inputstream java util array list arraylist java util collection java util hash map hashmap java util hash set hashset java util iterator java util list java util map java util java util regex pattern org eclipse core resources i container icontainer org eclipse core resources i file ifile org eclipse core resources i folder ifolder org eclipse core resources i marker imarker org eclipse core resources i resource iresource org eclipse core runtime core exception coreexception org eclipse core runtime i path ipath org eclipse core runtime i progress monitor iprogressmonitor org eclipse jdt apt core internal apt plugin aptplugin org eclipse jdt apt core internal apt project aptproject org eclipse jdt apt core internal messages org eclipse jdt apt core internal util file system util filesystemutil org eclipse jdt apt core internal util many to many manytomany org eclipse jdt core element changed event elementchangedevent org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java model status constants ijavamodelstatusconstants org eclipse jdt core i java project ijavaproject org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core i package fragment root ipackagefragmentroot org eclipse jdt core java core javacore org eclipse jdt core java model exception javamodelexception org eclipse jdt core working copy owner workingcopyowner managing generated files keeping track dependencies longer generated files deleted managing lifecycle working copies memory build generated file type sense generated java source file generated file arbitrary resource xml file reconcile generate java source files reconcile write disk delete files disk operations place memory working copies java model data structures code build deps builddeps code map tracks parent files responsible generated files entries map created files created builds map serialized dependencies reloaded project opened full build types generated reconcile laid disk commit working copy file handles maps code reconcile deps reconciledeps code reconcile time analogue code build deps builddeps code map serialized working copy easy determine i file ifile models calling code i compilation unit icompilationunit get resource getresource code store maps i file ifile i compilation unit icompilationunit working copies represent generated types stored code reconcile gen types reconcilegentypes code working copies represent deleted types stored code hidden built types hiddenbuilttypes code list invariants maps entry correspond reverse entry managed verified many to many manytomany map code entry code reconcile gen types reconcilegentypes code list correspond entry code reconcile deps reconciledeps code map over lap overlap entries code hidden built types hiddenbuilttypes code map working copy collection code become working copy becomeworkingcopy code called removed code discard working copy discardworkingcopy code called sync hronization synchronization notes synchronization generated file manager generatedfilemanager maps generated file map generatedfilemap instance monitor acquiring monitor per form perform operations loc ks locks java model operations file system operations creating deleting file folder code subject deadlock situations resource changed listener resource lock call generated file manager generatedfilemanager clean code reverse order locks bad careful reconcile build reconciles based memory type working copies builds based files disk moment build thread number reconcile threads executing share generated file manager generatedfilemanager object thread separate build environment buildenvironment multiple files built loop files generated compiled gen erating generating files file time reconciled file generated reconcile invoke recursive call reconcile unique reconcile build environment reconcilebuildenvironment rel ationship relationship reconcile time dependency build time dependency general dependency maps build time separate reconcile time shared reconcile threads reconciles write build time write disk builds int eract interact reconcile time info tricky bit change file java for eground foreground editor window affect background file java generates a gen agen java editing java making java dirty eclipse build system knowing reconciled nearest eclipse analogy refactoring ref actor refactor operation for eground foreground editor modify background files eclipse solves problem req uiring requiring files saved refactoring operation solution practical simple making edits file happen annotation processing dependency jsr api works problem let ting letting processors band dependencies explicitly sun mirror apt mechanism app roach approach build performed discard working copies files open editors dirty meaning file disk version editor file dirty a gen agen updated edited making breaking change making change supposed work generated file manager generatedfilemanager access fragment root generated types encapsulate d encapsulated synchronization guaranteed generated package fragment root generatedpackagefragmentroot root returned single object ensure synchronization name and root nameandroot string i package fragment root ipackagefragmentroot root name and root nameandroot string i package fragment root ipackagefragmentroot root root root i package fragment root ipackagefragmentroot root string folder name foldername fragment root folder corresponds folder classpath root name and root nameandroot name and root nameandroot folder name foldername root force fragment root folder rec alculated recalculated check folder classpath root i folder ifolder gen folder genfolder gsfm get folder getfolder root j project jproject is on classpath isonclasspath gen folder genfolder root j project jproject get package fragment root getpackagefragmentroot gen folder genfolder folder name foldername gen folder genfolder get project relative path getprojectrelativepath to string tostring buffer contents updated reconcile reconcile called contents update open editor generated file parent file recursive type generation recursive reconcile disable type generation reconcile reconcile time type generation caused dead locks deadlocks bea internal radar bug eclipse work generate type reconcile int egrity integrity internal data str uctures structures verified operations performed enable int egrity integrity checks singleton instance compilation unit helper compilationunithelper encapsulates operations working copies compilation unit helper compilationunithelper cuhelper compilation unit helper compilationunithelper regex delimiter parse names nls pattern delimiter pattern compile register element changed listener clean working copies mask element changed event elementchangedevent post change java core javacore add element changed listener addelementchangedlistener working copy clean up listener workingcopycleanuplistener mask map parent files files generated build files exist disk map track dependencies build read reconcile map serialized generated file map generatedfilemap build deps builddeps files generated build processors support reconcile time type generation files expected generated reconcile deleted reconcile generated reconcile deps reconciledeps contents generated build i file ifile clear during reconcile clearduringreconcile map parent files files generated reconcile values correspond files exist disk memory map track dependencies created reconcile accessed build map serialized many to many manytomany i file ifile i file ifile reconcile deps reconciledeps map parent files files generated build reconcile parents reconciled meaning generated children disk valid parents edited longer generate children meaning generated children removed types ystem typesystem map serialized many to many manytomany i file ifile i file ifile reconcile non deps reconcilenondeps map types generated build hidden removed reconcile time types ystem typesystem blank working copies workingcopies tracked sep arately separately regular working copies sake cla rity clarity correspond files exist disk didn reason entry map file working copy file strong strong map parents generated children map sub set subset values link reconcile non deps reconcilenondeps map exists file find working copy represents working copy exists map link hidden built types hiddenbuilttypes maps exist track lifecycle working copy working copy created link i compilation unit icompilationunit become working copy becomeworkingcopy called entry removed map link i compilation unit icompilationunit discard working copy discardworkingcopy called reconcile gen types reconcilegentypes map i file ifile i compilation unit icompilationunit hidden built types hiddenbuilttypes cache working copies memory types created modified reconcile includes working copies represent types generated build exist disk working copies types newly generated reconcile exist disk map file working copy file strong strong map parents generated children correspondence map values link reconcile deps reconciledeps map exists file find working copy represents working copy exists map link hidden built types hiddenbuilttypes maps exist track lifecycle working copy working copy created link i compilation unit icompilationunit become working copy becomeworkingcopy called entry removed map link i compilation unit icompilationunit discard working copy discardworkingcopy called hidden built types hiddenbuilttypes map i file ifile i compilation unit icompilationunit reconcile gen types reconcilegentypes access fragment root generated types encapsulate d encapsulated helper order ensure synchronization generated package fragment root generatedpackagefragmentroot generated package fragment root generatedpackagefragmentroot i java project ijavaproject j project jproject generated source folder manager generatedsourcefoldermanager gsfm initialized build starts accessed type generation lifecycle generated package fragment root generatedpackagefragmentroot configuration problem code code generation type prevent types generated skip type generation skiptypegeneration clients instantiate created link apt project aptproject generated file manager generatedfilemanager apt project aptproject apt project aptproject generated source folder manager generatedsourcefoldermanager gsfm j project jproject apt project aptproject get java project getjavaproject gsfm gsfm build deps builddeps generated file map generatedfilemap j project jproject get project getproject clear during reconcile clearduringreconcile hash set hashset reconcile deps reconciledeps many to many manytomany reconcile non deps reconcilenondeps many to many manytomany hidden built types hiddenbuilttypes hash map hashmap reconcile gen types reconcilegentypes hash map hashmap generated package fragment root generatedpackagefragmentroot generated package fragment root generatedpackagefragmentroot add java source entry build time dependency maps java source files maps generated link generate file during build generatefileduringbuild files types explicitly code creates file method called build reconcile add java source files reconcile add generated file dependency addgeneratedfiledependency collection i file ifile parent files parentfiles i file ifile generated file generatedfile add built file to maps addbuiltfiletomaps parent files parentfiles generated file generatedfile called start build order cache fragment root compilation started compilationstarted clear generated source folder config markers i marker imarker markers j project jproject get project getproject find markers findmarkers apt plugin aptplugin apt config problem marker i resource iresource depth infinite markers i marker imarker marker markers marker delete core exception coreexception apt plugin aptplugin log unable delete configuration marker skip type generation skiptypegeneration gsfm ensure folder exists ensurefolderexists generated package fragment root generatedpackagefragmentroot method testing purposes ensure maps entries expect contains working copy map entries for parent containsworkingcopymapentriesforparent i file ifile reconcile deps reconciledeps contains key containskey invoked build delete files longer parented code parent file parentfile code files multiply parented deleted association parent generated file removed parent ceases generate file deleted time param newly generated files newlygeneratedfiles files generated code parent file parentfile code compilation files spared deletion source files deleted empty returned include source text xml files i file ifile delete obsolete files after build deleteobsoletefilesafterbuild i file ifile parent file parentfile i file ifile newly generated files newlygeneratedfiles i file ifile deleted list i compilation unit icompilationunit to discard todiscard array list arraylist i file ifile to report toreport hash set hashset deleted compute obsolete files computeobsoletefiles parent file parentfile newly generated files newlygeneratedfiles to discard todiscard to report toreport i file ifile to delete todelete deleted apt plugin aptplugin debug gfm apt plugin aptplugin trace nls deleted obsolete file build nls to delete todelete delete physical file deletephysicalfile to delete todelete don type visible reconcile thread i compilation unit icompilationunit wc to discard wctodiscard to discard todiscard cuhelper discard working copy discardworkingcopy wc to discard wctodiscard to report toreport invoked reconcile rid files longer generated file existed disk delete create blank working copy workingcopy hide remove java source files arbitrary files file generated reconcile exists memory remove alt ogether altogether processors link org eclipse jdt apt core util apt preference constants aptpreferenceconstants rttg enabled option support type generation reconcile remove obsolete files generated processors preserve files generated processors param parentwc working copy workingcopy reconciled param newly generated files newlygeneratedfiles complete list files generated reconcile including files exist disk files exist memory delete obsolete types after reconcile deleteobsoletetypesafterreconcile i compilation unit icompilationunit parentwc i file ifile newly generated files newlygeneratedfiles i file ifile parent file parentfile i file ifile parentwc get resource getresource list i compilation unit icompilationunit to set blank tosetblank array list arraylist list i compilation unit icompilationunit to discard todiscard array list arraylist compute obsolete reconcile types computeobsoletereconciletypes parent file parentfile newly generated files newlygeneratedfiles cuhelper to set blank tosetblank to discard todiscard i compilation unit icompilationunit wc to discard wctodiscard to discard todiscard apt plugin aptplugin debug gfm apt plugin aptplugin trace discarded obsolete working copy reconcile nls wc to discard wctodiscard get element name getelementname cuhelper discard working copy discardworkingcopy wc to discard wctodiscard working copy owner workingcopyowner working copy owner workingcopyowner parentwc get owner getowner i compilation unit icompilationunit wc to set blank wctosetblank to set blank tosetblank apt plugin aptplugin debug gfm apt plugin aptplugin trace hiding file blank working copy reconcile nls wc to set blank wctosetblank get element name getelementname nls cuhelper update working copy contents updateworkingcopycontents wc to set blank wctosetblank working copy owner workingcopyowner recursive reconcile check int egrity checkintegrity called resource change listener file deleted user removes files parented file removes file dependency maps generated remove working copies parented file happen working copy parent file discarded param file deleted filedeleted i file ifile list i file ifile to delete todelete remove file from build maps removefilefrombuildmaps i file ifile file to delete filetodelete to delete todelete delete physical file deletephysicalfile file to delete filetodelete invoked file generated build generated file int ermediate intermediate directories created don exist method takes file system locks assumes calling method point acquired workspace level resource lock param parent files parentfiles parent parents type generated empty entries param type name typename dot separated java type type generated param contents java code contents type param clear during reconcile clearduringreconcile file removed reconcile reg enerated regenerated typically file generated processor supports link plain linkplain org eclipse jdt apt core util apt preference constants aptpreferenceconstants rttg enabled option reconcile time type generation param progress monitor progressmonitor progress monitor newly created i file ifile modified core exception coreexception file generation result filegenerationresult generate file during build generatefileduringbuild collection i file ifile parent files parentfiles string type name typename string contents clear during reconcile clearduringreconcile i progress monitor iprogressmonitor progress monitor progressmonitor core exception coreexception skip type generation skiptypegeneration generated package fragment root generatedpackagefragmentroot name and root nameandroot gpfr generated package fragment root generatedpackagefragmentroot i package fragment root ipackagefragmentroot root gpfr root root generated fragment root was n wasn classpath incorrect add marker method generate types doesn matter classpath wrong string message messages bind messages generated file manager generatedfilemanager missing classpath entry string gpfr i marker imarker marker j project jproject get project getproject create marker createmarker apt plugin aptplugin apt config problem marker marker set attributes setattributes string i marker imarker message i marker imarker severity i marker imarker source object message i marker imarker severity error apt plugin aptplugin apt marker source disable type generation skip type generation skiptypegeneration contents differ disk caller modification i file ifile file get file for type name getifilefortypename type name typename contents differ contentsdiffer compare file contents comparefilecontents contents file contents differ contentsdiffer string names parse type name parsetypename type name typename string pkg name pkgname names string cu name cuname names list folders created exist i folder ifolder gen src folder gensrcfolder i folder ifolder root get resource getresource i folder ifolder new folders newfolders compute new package folders computenewpackagefolders pkg name pkgname gen src folder gensrcfolder create fragment java model creates needed parent folders i package fragment ipackagefragment pkg frag pkgfrag cuhelper create package fragment createpackagefragment pkg name pkgname root progress monitor progressmonitor mark newly created folders pre existing derived i container icontainer folder new folders newfolders folder set derived setderived progress monitor progressmonitor core exception coreexception apt plugin aptplugin log warning logwarning unable mark generated type folder derived folder get name getname save compilation unit savecompilationunit pkg frag pkgfrag cu name cuname contents progress monitor progressmonitor batch build parent file parentfile track ownership iterative builds add built file to maps addbuiltfiletomaps parent files parentfiles file clear during reconcile clearduringreconcile clear during reconcile clearduringreconcile add file exist marking derived resource exception resourceexception file exists file set derived setderived progress monitor progressmonitor check int egrity checkintegrity file generation result filegenerationresult file contents differ contentsdiffer core exception coreexception apt plugin aptplugin log unable generate type type name typename function generates type memory creating updating working copy contents generated source folder configured correctly work method takes locks safe call holding fine grained resource locks reconcile paths works memory working copy type i file ifile generated type exist disk directories type exist disk todo figure create working copy client character param parent compilation unit parentcompilationunit parent compilation unit param type name typename dot separated java type type param contents contents type file generation result filegenerationresult generated source folder configured error type generation file generation result filegenerationresult generate file during reconcile generatefileduringreconcile i compilation unit icompilationunit parent compilation unit parentcompilationunit string type name typename string contents core exception coreexception generate type reconcile i file ifile parent file parentfile i file ifile parent compilation unit parentcompilationunit get resource getresource i compilation unit icompilationunit working copy workingcopy get working copy for reconcile getworkingcopyforreconcile parent file parentfile type name typename cuhelper update contents recursively reconcile modified cuhelper update working copy contents updateworkingcopycontents contents working copy workingcopy parent compilation unit parentcompilationunit get owner getowner recursive reconcile apt plugin aptplugin debug gfm modified nls apt plugin aptplugin trace nls working copy modified reconcile type name typename nls apt plugin aptplugin trace nls working copy unmodified reconcile type name typename i file ifile generated file generatedfile i file ifile working copy workingcopy get resource getresource file generation result filegenerationresult generated file generatedfile modified param parent parent file generated files i file ifile instances files generated parent empty collection is parent file isparentfile i file ifile is generated file isgeneratedfile i file ifile i file ifile get generated files for parent getgeneratedfilesforparent i file ifile parent build deps builddeps get values getvalues parent returns file generated file parent files param file question is generated file isgeneratedfile i file ifile build deps builddeps contains value containsvalue returns file parent file generated files param file question file parent get generated files for parent getgeneratedfilesforparent i file ifile is generated file isgeneratedfile i file ifile is parent file isparentfile i file ifile build deps builddeps contains key containskey perform actions resp ond respond clean project c leaned projectcleaned iterable i compilation unit icompilationunit to discard todiscard compute clean computeclean i compilation unit icompilationunit to discard todiscard cuhelper discard working copy discardworkingcopy apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls cleared build file dependencies perform actions resp ond respond project closed reconcile time working copies build time dependency leave serialized version disk project opened project closed projectclosed nls apt plugin aptplugin debug gfm apt plugin aptplugin trace discarding working copy list i compilation unit icompilationunit to discard todiscard to discard todiscard compute project closed computeprojectclosed i compilation unit icompilationunit to discard todiscard cuhelper discard working copy discardworkingcopy perform actions resp ond respond project deleted project including serialized build dependencies project deleted projectdeleted nls apt plugin aptplugin debug gfm apt plugin aptplugin trace discarding list i compilation unit icompilationunit to discard todiscard to discard todiscard compute project closed computeprojectclosed i compilation unit icompilationunit to discard todiscard cuhelper discard working copy discardworkingcopy called start reconcile order cache fragment root reconcile started reconcilestarted generated package fragment root generatedpackagefragmentroot invoked working copy released editor closed includes ide shutdown param parent core exception coreexception working copy discarded workingcopydiscarded i compilation unit icompilationunit core exception coreexception list i compilation unit icompilationunit to discard todiscard remove file from reconcile maps removefilefromreconcilemaps i file ifile get resource getresource apt plugin aptplugin debug gfm apt plugin aptplugin trace nls working copy discarded get element name getelementname removing to discard todiscard size nls nls children i compilation unit icompilationunit obsoletewc to discard todiscard cuhelper discard working copy discardworkingcopy obsoletewc serialize generated file dependency data builds workspace reopened incremental builds work correctly write state writestate build deps builddeps write state writestate add file dependency build time updates build dependency map affect reconcile time dependencies method maps touch disk modify working copies param is source issource source files compiled source text xml add built file to maps addbuiltfiletomaps collection i file ifile parent files parentfiles i file ifile generated file generatedfile is source issource track ownership iterative builds i file ifile parent file parentfile parent files parentfiles parent file parentfile build deps builddeps parent file parentfile generated file generatedfile is source issource apt plugin aptplugin debug gfm maps nls nls apt plugin aptplugin trace build file dependency parent file parentfile generated file generatedfile nls nls apt plugin aptplugin trace build file dependency exists parent file parentfile generated file generatedfile check int egrity integrity data str uctures structures called turn runtime check int egrity checkintegrity illegal state exception illegalstateexception enable int egrity integrity checks apt plugin aptplugin debug gfm maps correspondence values reconcile deps reconciledeps reconcile gen types reconcilegentypes copy safe modify i file ifile dep children depchildren reconcile deps reconciledeps get value set getvalueset copy i file ifile gen types gentypes reconcile gen types reconcilegentypes key set keyset list i file ifile extra files extrafiles array list arraylist i file ifile gen types gentypes dep children depchildren remove extra files extrafiles add extra files extrafiles is empty isempty log extra files logextrafiles nls file reconcile generated list reconcile dependency map extra files extrafiles dep children depchildren is empty isempty log extra files logextrafiles nls file reconcile dependency map reconcile generated list dep children depchildren file clear during reconcile clearduringreconcile build deps builddeps list i file ifile extra clear during reconcile files extraclearduringreconcilefiles array list arraylist i file ifile clear during reconcile clearduringreconcile clear during reconcile clearduringreconcile build deps builddeps contains value containsvalue clear during reconcile clearduringreconcile extra clear during reconcile files extraclearduringreconcilefiles add clear during reconcile clearduringreconcile extra clear during reconcile files extraclearduringreconcilefiles is empty isempty log extra files logextrafiles nls file list clear reconcile build dependency map extra clear during reconcile files extraclearduringreconcilefiles key hidden built types hiddenbuilttypes reconcile non deps reconcilenondeps list i file ifile extra hidden types extrahiddentypes array list arraylist i file ifile hidden hidden built types hiddenbuilttypes key set keyset reconcile non deps reconcilenondeps contains value containsvalue hidden extra hidden types extrahiddentypes add hidden extra hidden types extrahiddentypes is empty isempty log extra files logextrafiles nls file hidden types list reconcile obsoleted list extra hidden types extrahiddentypes parent child pairs exist reconcile deps reconciledeps reconcile non deps reconcilenondeps map i file ifile i file ifile reconcile over laps reconcileoverlaps hash map hashmap i file ifile parent reconcile non deps reconcilenondeps get key set getkeyset i file ifile child reconcile non deps reconcilenondeps get values getvalues parent reconcile deps reconciledeps contains key value pair containskeyvaluepair parent child reconcile over laps reconcileoverlaps parent child reconcile over laps reconcileoverlaps is empty isempty log extra file pairs logextrafilepairs nls entries exist reconcile map reconcile obsoleted maps reconcile over laps reconcileoverlaps parent child pair reconcile non deps reconcilenondeps matching parent child pair build deps builddeps map i file ifile i file ifile extra non deps extranondeps hash map hashmap i file ifile parent reconcile non deps reconcilenondeps get key set getkeyset i file ifile child reconcile non deps reconcilenondeps get values getvalues parent build deps builddeps contains key value pair containskeyvaluepair parent child extra non deps extranondeps parent child extra non deps extranondeps is empty isempty log extra file pairs logextrafilepairs nls entries exist reconcile obsoleted map build map extra non deps extranondeps values hidden built types hiddenbuilttypes list i file ifile null hidden types nullhiddentypes array list arraylist map entry i file ifile i compilation unit icompilationunit entry hidden built types hiddenbuilttypes entry set entryset entry get value getvalue null hidden types nullhiddentypes add entry get key getkey null hidden types nullhiddentypes is empty isempty nls log extra files logextrafiles entries hidden type list null hidden types nullhiddentypes values reconcile gen types reconcilegentypes list i file ifile null reconcile types nullreconciletypes array list arraylist map entry i file ifile i compilation unit icompilationunit entry reconcile gen types reconcilegentypes entry set entryset entry get value getvalue null reconcile types nullreconciletypes add entry get key getkey null reconcile types nullreconciletypes is empty isempty nls log extra files logextrafiles entries reconcile type list null reconcile types nullreconciletypes clear working copy maps reconcile time dependency returns list working copies longer referenced discarded typically called project closed deleted obvious ide discards parent working copies generated file manager generatedfilemanager discarded left clear time method maps touch disk create modify discard working copies method atomic res pect respect data structure int egrity integrity param delete state deletestate delete serialized build dependencies list working copies discarded caller list i compilation unit icompilationunit compute project closed computeprojectclosed delete state deletestate size hidden built types hiddenbuilttypes size reconcile gen types reconcilegentypes size list i compilation unit icompilationunit to discard todiscard array list arraylist size to discard todiscard add all addall hidden built types hiddenbuilttypes values to discard todiscard add all addall reconcile gen types reconcilegentypes values reconcile gen types reconcilegentypes clear hidden built types hiddenbuilttypes clear reconcile deps reconciledeps clear reconcile non deps reconcilenondeps clear delete state deletestate build deps builddeps clear state clearstate build deps builddeps clear clear during reconcile clearduringreconcile clear check int egrity checkintegrity to discard todiscard compare code contents code contents code file code param contents text compare file contents disk param file exist file disk read contents differ compare file contents comparefilecontents string contents i file ifile file contents differ contentsdiffer file exists input stream inputstream old data olddata input stream inputstream byte array input stream bytearrayinputstream contents get bytes getbytes old data olddata buffered input stream bufferedinputstream file get contents getcontents contents differ contentsdiffer file system util filesystemutil compare streams comparestreams old data olddata core exception coreexception old data olddata old data olddata close io exception ioexception ioe close io exception ioexception ioe contents differ contentsdiffer map updates discard build typically called processing clean add ition addition throwing build dependencies blank working copies hide existing generated files premise deleted clean don hide leave reconcile time dependency info method atomic regard data structure int egrity integrity method touch disk create discard modify compilation units list working copies caller discard calling link compilation unit helper compilationunithelper discard working copy discardworkingcopy i compilation unit icompilationunit list i compilation unit icompilationunit compute clean computeclean build deps builddeps clear state clearstate clear during reconcile clearduringreconcile clear reconcile non deps reconcilenondeps clear list i compilation unit icompilationunit to discard todiscard array list arraylist hidden built types hiddenbuilttypes values hidden built types hiddenbuilttypes clear check int egrity checkintegrity to discard todiscard i folder ifolder handles additional folders needed type code pkg name pkgname code root code parent code create folders disk resource handles newly created folders i folder ifolder compute new package folders computenewpackagefolders string pkg name pkgname i folder ifolder parent i folder ifolder new folders newfolders hash set hashset string folders delimiter split pkg name pkgname string folder name foldername folders i folder ifolder folder parent get folder getfolder folder name foldername folder exists new folders newfolders add folder parent folder new folders newfolders calculate list generated files longer generated deleted method touch disk create update discard working copies method atomic regard int egrity integrity data str uctures structures param parent file parentfile files solely parented file list deleted param newly generated files newlygeneratedfiles files list spared param to discard todiscard caller pass empty list list working copies caller responsible discarding param to report toreport caller pass empty i files ifiles representing source files source files text xml files deleted removed compilation list files caller delete calling link delete physical file deletephysicalfile i file ifile i file ifile compute obsolete files computeobsoletefiles i file ifile parent file parentfile i file ifile newly generated files newlygeneratedfiles list i compilation unit icompilationunit to discard todiscard i file ifile to report toreport i file ifile deleted hash set hashset i file ifile obsolete files obsoletefiles build deps builddeps get values getvalues parent file parentfile spare newly generated files obsolete files obsoletefiles remove all removeall newly generated files newlygeneratedfiles i file ifile generated file generatedfile obsolete files obsoletefiles is source issource build deps builddeps is source issource generated file generatedfile build deps builddeps remove parent file parentfile generated file generatedfile apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls nls removed build file dependency parent file parentfile generated file generatedfile file parented parent spare build deps builddeps contains value containsvalue generated file generatedfile deleted add generated file generatedfile is source issource to report toreport add generated file generatedfile clear during reconcile clearduringreconcile remove all removeall deleted to discard todiscard add all addall compute obsolete hidden types computeobsoletehiddentypes parent file parentfile deleted check int egrity checkintegrity deleted calculate happen working copies reconcile order rid longer generated files existing generated file hide blank working copy existing file rid generated working copy min d mind user imports project existing generated files serialized build dependency map edit parent file causing generated type disappear discover hide generated file disk build time dependency map param parent file parentfile parent type reconciled exist disk param newly generated files newlygeneratedfiles files generated reconcile param to set blank tosetblank list add files caller blank link compilation unit helper compilationunithelper update working copy contents updateworkingcopycontents string i compilation unit icompilationunit working copy owner workingcopyowner param to discard todiscard list add files caller discard link compilation unit helper compilationunithelper discard working copy discardworkingcopy i compilation unit icompilationunit compute obsolete reconcile types computeobsoletereconciletypes i file ifile parent file parentfile i file ifile newly generated files newlygeneratedfiles compilation unit helper compilationunithelper cuh list i compilation unit icompilationunit to set blank tosetblank list i compilation unit icompilationunit to discard todiscard types longer generated reconcile i file ifile obsolete files obsoletefiles reconcile deps reconciledeps get values getvalues parent file parentfile map i file ifile i compilation unit icompilationunit types to discard typestodiscard hash map hashmap obsolete files obsoletefiles remove all removeall newly generated files newlygeneratedfiles i file ifile obsolete file obsoletefile obsolete files obsoletefiles reconcile deps reconciledeps remove parent file parentfile obsolete file obsoletefile reconcile deps reconciledeps get keys getkeys obsolete file obsoletefile is empty isempty i compilation unit icompilationunit reconcile gen types reconcilegentypes remove obsolete file obsoletefile nls reconcile deps missing reconcile type list nls obsolete file obsoletefile types to discard typestodiscard obsolete file obsoletefile i file ifile built children builtchildren build deps builddeps get values getvalues parent file parentfile built children builtchildren retain all retainall clear during reconcile clearduringreconcile built children builtchildren remove all removeall newly generated files newlygeneratedfiles i file ifile built child builtchild built children builtchildren reconcile non deps reconcilenondeps parent file parentfile built child builtchild types to discard typestodiscard reconcile time parents parents masked non dep nondep entry found other parent foundotherparent i file ifile parents build deps builddeps get keys getkeys built child builtchild parents remove parent file parentfile i file ifile other parent otherparent parents reconcile non deps reconcilenondeps contains key value pair containskeyvaluepair other parent otherparent built child builtchild found other parent foundotherparent found other parent foundotherparent i compilation unit icompilationunit types to discard typestodiscard remove built child builtchild i package fragment root ipackagefragmentroot root generated package fragment root generatedpackagefragmentroot root string type name typename get type name for derived file gettypenameforderivedfile built child builtchild cuh get working copy getworkingcopy type name typename root hidden built types hiddenbuilttypes built child builtchild to set blank tosetblank add discard working copies setting blank to discard todiscard add all addall types to discard typestodiscard values check int egrity checkintegrity calculate list blank working copies longer needed files hide deleted build remove working copies hidden built types hiddenbuilttypes list list caller discard contents list block calling compilation unit helper compilationunithelper discard working copy discardworkingcopy method touch disk create update discard working copies method atomic regard data structure int egrity integrity param parent file parentfile parent longer param deleted files deletedfiles list files deleted hidden blank working copies list working copies caller discard list i compilation unit icompilationunit compute obsolete hidden types computeobsoletehiddentypes i file ifile parent file parentfile i file ifile deleted files deletedfiles list i compilation unit icompilationunit to discard todiscard array list arraylist i file ifile deleted file deletedfile deleted files deletedfiles reconcile non deps reconcilenondeps remove parent file parentfile deleted file deletedfile i compilation unit icompilationunit hidden built types hiddenbuilttypes remove deleted file deletedfile to discard todiscard add check int egrity checkintegrity to discard todiscard delete generated file disk deletes parent folder hierarchy including root generated source folder folders empty marked derived affect refer dependency maps param file assumed generated source folder delete physical file deletephysicalfile i file ifile file i folder ifolder gen folder genfolder gsfm get folder getfolder nls gen folder genfolder generated folder parent folder sense i container icontainer parent file get parent getparent typegen sense apt plugin aptplugin debug gfm apt plugin aptplugin trace nls delete physical file nls file file delete progress monitor progressmonitor core exception coreexception apt plugin aptplugin log warning logwarning unable delete generated file file delete parent folders gen folder genfolder equals parent parent parent is derived isderived i resource iresource members members parent members core exception coreexception apt plugin aptplugin log warning logwarning unable read contents generated file folder parent i container icontainer grand parent grandparent parent get parent getparent turns light members members length parent delete progress monitor progressmonitor core exception coreexception apt plugin aptplugin log warning logwarning unable delete generated file folder parent parent grand parent grandparent typename i file ifile type i file ifile generated source folder affect refer dependency maps i file ifile get file for type name getifilefortypename string type name typename split type parts string parts delimiter split type name typename i folder ifolder folder gsfm get folder getfolder parts length folder folder get folder getfolder parts type file nls string file name filename parts parts length java i file ifile file folder get file getfile file name filename file file typename file assumes derived files java naming rules type file java string get type name for derived file gettypenameforderivedfile i file ifile i path ipath get full path getfullpath i folder ifolder folder gsfm get folder getfolder i path ipath generated source path generatedsourcepath folder get full path getfullpath count matching first segments matchingfirstsegments generated source path generatedsourcepath remove first segments removefirstsegments count string to portable string toportablestring idx last index of lastindexof to portable string toportablestring replace substring idx working copy generated type cached create update reconcile time dependency maps method touch disk update discard working copies call compilation unit helper compilationunithelper working copy method atomic res pect respect data str uctures structures param parent file parentfile i file ifile processing causing type generated param type name typename type generated param cuh compilation unit helper compilationunithelper utility object working copy ready updated type contents i compilation unit icompilationunit get working copy for reconcile getworkingcopyforreconcile i file ifile parent file parentfile string type name typename compilation unit helper compilationunithelper cuh i package fragment root ipackagefragmentroot root generated package fragment root generatedpackagefragmentroot root i file ifile generated file generatedfile get file for type name getifilefortypename type name typename i compilation unit icompilationunit working copy workingcopy working copy workingcopy hidden built types hiddenbuilttypes remove generated file generatedfile working copy workingcopy file hidden blank move regular list reconcile non deps reconcilenondeps remove parent file parentfile generated file generatedfile reconcile gen types reconcilegentypes generated file generatedfile working copy workingcopy reconcile deps reconciledeps parent file parentfile generated file generatedfile apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls moved working copy hidden regular list nls generated file generatedfile working copy workingcopy reconcile gen types reconcilegentypes generated file generatedfile working copy workingcopy apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls existing working copy regular list nls generated file generatedfile created working copy file working copy workingcopy cuh get working copy getworkingcopy type name typename root reconcile deps reconciledeps parent file parentfile generated file generatedfile reconcile gen types reconcilegentypes generated file generatedfile working copy workingcopy apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls working copy regular list nls generated file generatedfile check int egrity checkintegrity working copy workingcopy check child file parents apply reconcile code child code parents link reconcile deps reconciledeps parents link build deps builddeps masked entry link reconcile non deps reconcilenondeps has no other reconcile parents hasnootherreconcileparents i file ifile child i file ifile parent reconcile deps reconciledeps value has other keys valuehasotherkeys child parent i file ifile build parents buildparents build deps builddeps get keys getkeys child build parents buildparents remove parent build parents buildparents remove all removeall reconcile non deps reconcilenondeps get keys getkeys child build parents buildparents is empty isempty log extra file pairs message message assumes pairs entry log extra file pairs logextrafilepairs string message map i file ifile i file ifile pairs string builder stringbuilder string builder stringbuilder append message iterator map entry i file ifile i file ifile iter pairs entry set entryset iterator map entry i file ifile i file ifile entry iter append entry get key getkey get name getname nls append append entry get value getvalue get name getname iter has next hasnext nls append string to string tostring apt plugin aptplugin log illegal state exception illegalstateexception log extra files message message file file file assumes files entry log extra files logextrafiles string message iterable i file ifile files string builder stringbuilder string builder stringbuilder append message iterator i file ifile iter files iterator append iter get name getname iter has next hasnext nls append string to string tostring apt plugin aptplugin log illegal state exception illegalstateexception fully qualified type generate local filename including extension instance type code foo bar baz code turned code foo bar code filename code baz java code todo identical code compilation unit helper compilationunithelper difference int entional intentional param qualified name qualifiedname fully qualified type string array filename string parse type name parsetypename string qualified name qualifiedname todo code compilation unit helper compilationunithelper doesn perform check qualified name qualifiedname index of indexof qualified name qualifiedname qualified name qualifiedname replace string names string string pkg name pkgname string fname idx qualified name qualifiedname last index of lastindexof idx pkg name pkgname qualified name qualifiedname substring idx fname nls qualified name qualifiedname substring idx qualified name qualifiedname length nls java nls pkg name pkgname nls fname qualified name qualifiedname java names pkg name pkgname names fname names remove file build time dependency maps calculate consequences removal called response file deleted environment operation maps operation atomic res pect respect map int egrity integrity operation touch disk create update discard working copies param parent generated list generated files longer relevant deleted operation caller holding locks list empty list i file ifile remove file from build maps removefilefrombuildmaps i file ifile list i file ifile to delete todelete array list arraylist file sole parent files generated build add deletion list remove file build dependency list i file ifile child files childfiles build deps builddeps get values getvalues i file ifile child file childfile child files childfiles i file ifile parent files parentfiles build deps builddeps get keys getkeys child file childfile parent files parentfiles size parent files parentfiles to delete todelete add child file childfile removed build deps builddeps remove key removekey removed apt plugin aptplugin debug gfm maps apt plugin aptplugin trace nls removed parent file build dependencies nls check int egrity checkintegrity to delete todelete remove generated children working copy reconcile dependency maps typically invoked working copy parent file discarded editor remove generated working copies parented method touch disk create modify discard working copies method atomic regard data structure int egrity integrity param file file representing working copy parent generated file list generated working copies longer referenced discarded calling link compilation unit helper compilationunithelper discard working copy discardworkingcopy i compilation unit icompilationunit list i compilation unit icompilationunit remove file from reconcile maps removefilefromreconcilemaps i file ifile file list i compilation unit icompilationunit to discard todiscard array list arraylist remove orphaned children i file ifile gen files genfiles reconcile deps reconciledeps get values getvalues file i file ifile child gen files genfiles has no other reconcile parents hasnootherreconcileparents child file i compilation unit icompilationunit childwc reconcile gen types reconcilegentypes remove child childwc reconcile deps reconciledeps key reconcile gen types reconcilegentypes to discard todiscard add childwc reconcile deps reconciledeps remove key removekey file remove obsolete entries generated list i file ifile non gen files nongenfiles reconcile non deps reconcilenondeps get values getvalues file i file ifile child non gen files nongenfiles i compilation unit icompilationunit hidingwc hidden built types hiddenbuilttypes remove child hidingwc to discard todiscard add hidingwc reconcile non deps reconcilenondeps remove key removekey file check int egrity checkintegrity to discard todiscard write code contents code disk form compilation unit named code code fragment code pkg frag pkgfrag code write depends compilation unit working copy working copy reconcile pri nciple principle changing contents build problem java builder based file contents current java model annotation processors type info java model build general difference build reconcile bugs build performed unsaved content editors change routine fixed w harley wharley method to uches touches disk mod ifies modifies working copies called build reconcile called holding locks workspace rules held build param pkg frag pkgfrag fragment type created fragment folders exist disk param cu name cuname simple type extension obj java param contents text compilation unit param progress monitor progressmonitor save compilation unit savecompilationunit i package fragment ipackagefragment pkg frag pkgfrag string cu name cuname string contents i progress monitor iprogressmonitor progress monitor progressmonitor i compilation unit icompilationunit unit pkg frag pkgfrag get compilation unit getcompilationunit cu name cuname is working copy isworkingcopy unit is working copy isworkingcopy is working copy isworkingcopy working copy update contents commit cuhelper commit new contents commitnewcontents unit contents progress monitor progressmonitor apt plugin aptplugin debug gfm apt plugin aptplugin trace committed existing working copy build nls unit get element name getelementname java model exception javamodelexception get java model status getjavamodelstatus get code getcode i java model status constants ijavamodelstatusconstants invalid resource cuhelper discard working copy discardworkingcopy unit is working copy isworkingcopy apt plugin aptplugin debug gfm apt plugin aptplugin trace discarded invalid existing working copy order unit get element name getelementname apt plugin aptplugin log unable commit working copy disk unit get element name getelementname is working copy isworkingcopy unit pkg frag pkgfrag create compilation unit createcompilationunit cu name cuname contents progress monitor progressmonitor apt plugin aptplugin debug gfm apt plugin aptplugin trace created compilation unit build nls unit get element name getelementname java model exception javamodelexception apt plugin aptplugin log unable create compilation unit disk cu name cuname pkg fragment pkg frag pkgfrag get element name getelementname
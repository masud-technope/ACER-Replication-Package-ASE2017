copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal core dom rewrite java util org eclipse jdt core signature org eclipse jdt core dom ast node astnode org eclipse jdt core dom block org eclipse jdt core dom structural property descriptor structuralpropertydescriptor org eclipse jdt core dom rewrite ast rewrite astrewrite org eclipse jdt core dom rewrite list rewrite listrewrite org eclipse jdt core dom rewrite target source range computer targetsourcerangecomputer org eclipse text edits text edit group texteditgroup stores rewrite events descriptions events nodes copy move sources tracked suppress warnings suppresswarnings rawtypes unchecked rewrite event store rewriteeventstore debug ast rewrite events enabled link ast rewrite astrewrite link list rewrite listrewrite link illegal argument exception illegalargumentexception rewrite operation insert ast node place nodes type allowed node type subtype structural property type disabled has n hasn enforced clients jdt ref actorings refactorings rely bit leeway qualifier qualified name qualifiedname method invocation methodinvocation expression simple type simpletype easiest solution change ast rewrite astrewrite problems debug property location propertylocation ast node astnode parent structural property descriptor structuralpropertydescriptor property property location propertylocation ast node astnode parent structural property descriptor structuralpropertydescriptor property parent parent property property ast node astnode get parent getparent parent structural property descriptor structuralpropertydescriptor get property getproperty property equals object obj obj obj get class getclass equals get class getclass property location propertylocation property location propertylocation obj get parent getparent equals get parent getparent get property getproperty equals get property getproperty hash code hashcode get parent getparent hash code hashcode get property getproperty hash code hashcode override children accessed parent rewriter modified ast ast rewrite astrewrite infrastructure i node property mapper inodepropertymapper returns node attribute property param parent parent node param child property childproperty child property access child node property location object get original value getoriginalvalue ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty store element associate event node position event holder eventholder ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty rewrite event rewriteevent event event holder eventholder ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty rewrite event rewriteevent change parent parent child property childproperty child property childproperty event change string to string tostring string buffer stringbuffer buf string buffer stringbuffer nls buf append parent append nls buf append child property childproperty get id getid append buf append event append buf to string tostring copy source info copysourceinfo comparable mark removed move property location propertylocation location ast node astnode node is move ismove copy source info copysourceinfo property location propertylocation location ast node astnode node is move ismove location location node node is move ismove is move ismove ast node astnode get node getnode node compare to compareto object copy source info copysourceinfo copy source info copysourceinfo start diff startdiff get node getnode get start position getstartposition get node getnode get start position getstartposition start diff startdiff insert start node start diff startdiff is move ismove is move ismove move copy is move ismove string to string tostring string buffer stringbuffer buf string buffer stringbuffer is move ismove nls buf append nls move source nls buf append nls copy source buf append node buf to string tostring node range info noderangeinfo comparable ast node astnode ast node astnode internal placeholder is move ismove flag copy source info copysourceinfo copy info copyinfo ast node astnode replacing node replacingnode text edit group texteditgroup edit group editgroup node range info noderangeinfo ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty ast node astnode ast node astnode copy source info copysourceinfo copy info copyinfo ast node astnode replacing node replacingnode text edit group texteditgroup edit group editgroup copy info copyinfo copy info copyinfo replacing node replacingnode replacing node replacingnode edit group editgroup edit group editgroup ast node astnode get start node getstartnode ast node astnode get end node getendnode is move ismove copy info copyinfo is move ismove block get internal placeholder getinternalplaceholder block copy info copyinfo get node getnode compare to compareto object node range info noderangeinfo node range info noderangeinfo start diff startdiff get start node getstartnode get start position getstartposition get start node getstartnode get start position getstartposition start diff startdiff insert start node start diff startdiff end diff enddiff get end node getendnode get start position getstartposition get end node getendnode get start position getstartposition end diff enddiff insert length longer end diff enddiff is move ismove is move ismove move copy is move ismove update placeholder source ranges updateplaceholdersourceranges target source range computer targetsourcerangecomputer source range computer sourcerangecomputer target source range computer targetsourcerangecomputer source range sourcerange start range startrange source range computer sourcerangecomputer compute source range computesourcerange get start node getstartnode target source range computer targetsourcerangecomputer source range sourcerange end range endrange source range computer sourcerangecomputer compute source range computesourcerange get end node getendnode start pos startpos start range startrange get start position getstartposition end pos endpos end range endrange get start position getstartposition end range endrange get length getlength block internal placeholder internalplaceholder get internal placeholder getinternalplaceholder internal placeholder internalplaceholder set source range setsourcerange start pos startpos end pos endpos start pos startpos string to string tostring string buffer stringbuffer buf string buffer stringbuffer nls buf append range is move ismove nls buf append nls move source nls buf append nls copy source buf append nls buf append buf append buf to string tostring iter ates iterates event parent nodes tracked nodes copy move sources parent iterator parentiterator iterator iterator event iter eventiter iterator source node iter sourcenodeiter iterator range node iter rangenodeiter iterator tracked node iter trackednodeiter parent iterator parentiterator event iter eventiter rewrite event store rewriteeventstore event lookup eventlookup key set keyset iterator rewrite event store rewriteeventstore node copy sources nodecopysources source node iter sourcenodeiter rewrite event store rewriteeventstore node copy sources nodecopysources iterator source node iter sourcenodeiter collections empty list iterator rewrite event store rewriteeventstore node range infos noderangeinfos range node iter rangenodeiter rewrite event store rewriteeventstore node range infos noderangeinfos key set keyset iterator range node iter rangenodeiter collections empty list iterator rewrite event store rewriteeventstore tracked nodes trackednodes tracked node iter trackednodeiter rewrite event store rewriteeventstore tracked nodes trackednodes key set keyset iterator tracked node iter trackednodeiter collections empty list iterator javadoc java util iterator has next hasnext has next hasnext event iter eventiter has next hasnext source node iter sourcenodeiter has next hasnext range node iter rangenodeiter has next hasnext tracked node iter trackednodeiter has next hasnext javadoc java util iterator object event iter eventiter has next hasnext event iter eventiter source node iter sourcenodeiter has next hasnext copy source info copysourceinfo source node iter sourcenodeiter get node getnode range node iter rangenodeiter has next hasnext property location propertylocation range node iter rangenodeiter get parent getparent tracked node iter trackednodeiter javadoc java util iterator remove remove unsupported operation exception unsupportedoperationexception original original events parent map event lookup eventlookup cache accessed event event holder eventholder last event lastevent maps events group descriptions map edit groups editgroups stores nodes source copy move list copy source info copysourceinfo list node copy sources nodecopysources stores node ranges copy move map property location propertylocation copy range info copyrangeinfo map node range infos noderangeinfos stores nodes tracked edit group map tracked nodes trackednodes stores inserted nodes bound previous node node bound node insert bound to previous insertboundtoprevious optional mapper modified ast trees i node property mapper inodepropertymapper node property mapper nodepropertymapper nls string internal placeholder property rewrite internal placeholder rewrite event store rewriteeventstore event lookup eventlookup hash map hashmap last event lastevent lazy initialization edit groups editgroups tracked nodes trackednodes insert bound to previous insertboundtoprevious node property mapper nodepropertymapper node copy sources nodecopysources node range infos noderangeinfos override access children parent node param node property mapper nodepropertymapper code i node property mapper inodepropertymapper code code code set node property mapper setnodepropertymapper i node property mapper inodepropertymapper node property mapper nodepropertymapper node property mapper nodepropertymapper node property mapper nodepropertymapper clear event lookup eventlookup clear last event lastevent tracked nodes trackednodes lazy initialization edit groups editgroups insert bound to previous insertboundtoprevious node copy sources nodecopysources add event addevent ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty rewrite event rewriteevent event validate has child property validatehaschildproperty parent child property childproperty event is list rewrite islistrewrite validate is list property validateislistproperty child property childproperty event holder eventholder holder event holder eventholder parent child property childproperty event list entries list entrieslist list event lookup eventlookup parent entries list entrieslist entries list entrieslist size event holder eventholder curr event holder eventholder entries list entrieslist curr child property childproperty child property childproperty entries list entrieslist holder last event lastevent entries list entrieslist array list arraylist event lookup eventlookup parent entries list entrieslist entries list entrieslist add holder rewrite event rewriteevent get event getevent ast node astnode parent structural property descriptor structuralpropertydescriptor property validate has child property validatehaschildproperty parent property last event lastevent last event lastevent parent parent last event lastevent child property childproperty property last event lastevent event list entries list entrieslist list event lookup eventlookup parent entries list entrieslist entries list entrieslist size event holder eventholder holder event holder eventholder entries list entrieslist holder child property childproperty property last event lastevent holder holder event node rewrite event noderewriteevent get node event getnodeevent ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty force creation forcecreation validate is node property validateisnodeproperty child property childproperty node rewrite event noderewriteevent event node rewrite event noderewriteevent get event getevent parent child property childproperty event force creation forcecreation object original value originalvalue access original value accessoriginalvalue parent child property childproperty event node rewrite event noderewriteevent original value originalvalue original value originalvalue add event addevent parent child property childproperty event event list rewrite event listrewriteevent get list event getlistevent ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty force creation forcecreation validate is list property validateislistproperty child property childproperty list rewrite event listrewriteevent event list rewrite event listrewriteevent get event getevent parent child property childproperty event force creation forcecreation list original value originalvalue list access original value accessoriginalvalue parent child property childproperty event list rewrite event listrewriteevent original value originalvalue add event addevent parent child property childproperty event event iterator get change root iterator getchangerootiterator parent iterator parentiterator has changed properties haschangedproperties ast node astnode parent list entries list entrieslist list event lookup eventlookup parent entries list entrieslist entries list entrieslist size event holder eventholder holder event holder eventholder entries list entrieslist holder event get change kind getchangekind rewrite event rewriteevent unchanged property location propertylocation get property location getpropertylocation object kind iterator iter event lookup eventlookup values iterator iter has next hasnext list events list iter events size event holder eventholder holder event holder eventholder events rewrite event rewriteevent event holder event is node in event isnodeinevent event kind property location propertylocation holder parent holder child property childproperty event is list rewrite islistrewrite rewrite event rewriteevent children event get children getchildren children length is node in event isnodeinevent children kind property location propertylocation holder parent holder child property childproperty ast node astnode ast node astnode node ast node astnode property location propertylocation node get parent getparent node get location in parent getlocationinparent kind original param param kind returns event code code rewrite event rewriteevent find event findevent object kind iterator iter event lookup eventlookup values iterator iter has next hasnext list events list iter events size rewrite event rewriteevent event event holder eventholder events event is node in event isnodeinevent event kind event event is list rewrite islistrewrite rewrite event rewriteevent children event get children getchildren children length is node in event isnodeinevent children kind children is node in event isnodeinevent rewrite event rewriteevent event object kind kind event get new value getnewvalue kind original event get original value getoriginalvalue object get original value getoriginalvalue ast node astnode parent structural property descriptor structuralpropertydescriptor property rewrite event rewriteevent event get event getevent parent property event event get original value getoriginalvalue access original value accessoriginalvalue parent property object get new value getnewvalue ast node astnode parent structural property descriptor structuralpropertydescriptor property rewrite event rewriteevent event get event getevent parent property event event get new value getnewvalue access original value accessoriginalvalue parent property list get changed proper tie events getchangedpropertieevents ast node astnode parent list changed properties event changedpropertiesevent array list arraylist list entries list entrieslist list event lookup eventlookup parent entries list entrieslist entries list entrieslist size event holder eventholder holder event holder eventholder entries list entrieslist holder event get change kind getchangekind rewrite event rewriteevent unchanged changed properties event changedpropertiesevent add holder event changed properties event changedpropertiesevent get change kind getchangekind ast node astnode node rewrite event rewriteevent event find event findevent node original event event get change kind getchangekind rewrite event rewriteevent unchanged original child ast temp orarily temporarily overridden port rewriter infrastructure object access original value accessoriginalvalue ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty node property mapper nodepropertymapper node property mapper nodepropertymapper get original value getoriginalvalue parent child property childproperty parent get structural property getstructuralproperty child property childproperty text edit group texteditgroup get event edit group geteventeditgroup rewrite event rewriteevent event edit groups editgroups text edit group texteditgroup edit groups editgroups event set event edit group seteventeditgroup rewrite event rewriteevent event text edit group texteditgroup edit group editgroup edit groups editgroups edit groups editgroups identity hash map identityhashmap edit groups editgroups event edit group editgroup text edit group texteditgroup get tracked node data gettrackednodedata ast node astnode node tracked nodes trackednodes text edit group texteditgroup tracked nodes trackednodes node set tracked node data settrackednodedata ast node astnode node text edit group texteditgroup edit group editgroup tracked nodes trackednodes tracked nodes trackednodes identity hash map identityhashmap tracked nodes trackednodes node edit group editgroup marks node tracked edits group edit group editgroup position node rewrite operation param node node track param edit group editgroup collects range markers describing node position mark as tracked markastracked ast node astnode node text edit group texteditgroup edit group editgroup get tracked node data gettrackednodedata node nls illegal argument exception illegalargumentexception node marked tracked set tracked node data settrackednodedata node edit group editgroup copy source info copysourceinfo create copy source info createcopysourceinfo property location propertylocation location ast node astnode node is move ismove copy source info copysourceinfo copy source copysource copy source info copysourceinfo location node is move ismove node copy sources nodecopysources node copy sources nodecopysources array list arraylist node copy sources nodecopysources add copy source copysource copy source copysource copy source info copysourceinfo mark as copy source markascopysource ast node astnode parent structural property descriptor structuralpropertydescriptor property ast node astnode node is move ismove create copy source info createcopysourceinfo property location propertylocation parent property node is move ismove is range copy placeholder israngecopyplaceholder ast node astnode node node get property getproperty internal placeholder property copy source info copysourceinfo create range copy createrangecopy ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty ast node astnode ast node astnode is move ismove ast node astnode internal placeholder internalplaceholder ast node astnode replacing node replacingnode text edit group texteditgroup edit group editgroup copy source info copysourceinfo copy info copyinfo create copy source info createcopysourceinfo internal placeholder internalplaceholder is move ismove internal placeholder internalplaceholder set property setproperty internal placeholder property internal placeholder internalplaceholder node range info noderangeinfo copy range info copyrangeinfo node range info noderangeinfo parent child property childproperty copy info copyinfo replacing node replacingnode edit group editgroup list rewrite event listrewriteevent list event listevent get list event getlistevent parent child property childproperty index first indexfirst list event listevent get index getindex list rewrite event listrewriteevent index first indexfirst nls illegal argument exception illegalargumentexception start node original child list index last indexlast list event listevent get index getindex list rewrite event listrewriteevent index last indexlast nls illegal argument exception illegalargumentexception node original child list index first indexfirst index last indexlast nls illegal argument exception illegalargumentexception start node node node range infos noderangeinfos node range infos noderangeinfos hash map hashmap property location propertylocation loc property location propertylocation parent child property childproperty list inner list innerlist list node range infos noderangeinfos loc inner list innerlist inner list innerlist array list arraylist node range infos noderangeinfos loc inner list innerlist assert no over lap assertnooverlap list event listevent index first indexfirst index last indexlast inner list innerlist inner list innerlist add copy range info copyrangeinfo copy info copyinfo copy source info copysourceinfo get node copy sources getnodecopysources ast node astnode node node copy sources nodecopysources internal get copy sources internalgetcopysources node copy sources nodecopysources node copy source info copysourceinfo internal get copy sources internalgetcopysources list copy sources copysources ast node astnode node array list arraylist res array list arraylist copy sources copysources size copy source info copysourceinfo curr copy source info copysourceinfo copy sources copysources curr get node getnode node res add curr res is empty isempty copy source info copysourceinfo arr copy source info copysourceinfo res to array toarray copy source info copysourceinfo res size arrays sort arr arr assert no over lap assertnooverlap list rewrite event listrewriteevent list event listevent index first indexfirst index last indexlast list inner list innerlist iterator iter inner list innerlist iterator iter has next hasnext node range info noderangeinfo curr node range info noderangeinfo iter curr start currstart list event listevent get index getindex curr get start node getstartnode list rewrite event listrewriteevent curr end currend list event listevent get index getindex curr get end node getendnode list rewrite event listrewriteevent curr start currstart index first indexfirst curr end currend index last indexlast curr end currend index first indexfirst curr start currstart index first indexfirst curr start currstart curr end currend curr end currend index last indexlast nls illegal argument exception illegalargumentexception nls range overlap ps overlapps existing copy move range prepare moved nodes preparemovednodes target source range computer targetsourcerangecomputer source range computer sourcerangecomputer node copy sources nodecopysources prepare single node copies preparesinglenodecopies node range infos noderangeinfos prepare node range copies preparenoderangecopies source range computer sourcerangecomputer revert moved nodes revertmovednodes node range infos noderangeinfos remove move range placeholders removemoverangeplaceholders remove move range placeholders removemoverangeplaceholders iterator iter node range infos noderangeinfos entry set entryset iterator iter has next hasnext map entry entry map entry iter collect placeholders placeholders hash set hashset list copy source range copysourcerange list range infos rangeinfos list entry get value getvalue range infos rangeinfos size placeholders add node range info noderangeinfo range infos rangeinfos get internal placeholder getinternalplaceholder property location propertylocation loc property location propertylocation entry get key getkey rewrite event rewriteevent children get list event getlistevent loc get parent getparent loc get property getproperty get children getchildren list reverted children revertedchildren array list arraylist revert list with ranges revertlistwithranges children placeholders reverted children revertedchildren rewrite event rewriteevent reverted children arr revertedchildrenarr rewrite event rewriteevent reverted children revertedchildren to array toarray rewrite event rewriteevent reverted children revertedchildren size replace current edits add event addevent loc get parent getparent loc get property getproperty list rewrite event listrewriteevent reverted children arr revertedchildrenarr revert list with ranges revertlistwithranges rewrite event rewriteevent child events childevents placeholders list reverted children revertedchildren child events childevents length rewrite event rewriteevent event child events childevents ast node astnode node ast node astnode event get original value getoriginalvalue placeholders node rewrite event rewriteevent placeholder children placeholderchildren get list event getlistevent node block statements property get children getchildren revert list with ranges revertlistwithranges placeholder children placeholderchildren placeholders reverted children revertedchildren reverted children revertedchildren add event prepare node range copies preparenoderangecopies target source range computer targetsourcerangecomputer source range computer sourcerangecomputer iterator iter node range infos noderangeinfos entry set entryset iterator iter has next hasnext map entry entry map entry iter list copy source range copysourcerange list range infos rangeinfos list entry get value getvalue sort start length move copy collections sort range infos rangeinfos property location propertylocation loc property location propertylocation entry get key getkey rewrite event rewriteevent children get list event getlistevent loc get parent getparent loc get property getproperty get children getchildren rewrite event rewriteevent new children newchildren process list with ranges processlistwithranges range infos rangeinfos children source range computer sourcerangecomputer replace current edits add event addevent loc get parent getparent loc get property getproperty list rewrite event listrewriteevent new children newchildren rewrite event rewriteevent process list with ranges processlistwithranges list range infos rangeinfos rewrite event rewriteevent child events childevents target source range computer targetsourcerangecomputer source range computer sourcerangecomputer list new child events newchildevents array list arraylist child events childevents length node range info noderangeinfo top info topinfo stack new children stack newchildrenstack stack stack top info stack topinfostack stack iterator range info iterator rangeinfoiterator range infos rangeinfos iterator node range info noderangeinfo next info nextinfo node range info noderangeinfo range info iterator rangeinfoiterator child events childevents length rewrite event rewriteevent event child events childevents ast node astnode node ast node astnode event get original value getoriginalvalue check ranges add placeholder child range next info nextinfo node next info nextinfo get start node getstartnode next info nextinfo update placeholder source ranges updateplaceholdersourceranges source range computer sourcerangecomputer block internal placeholder internalplaceholder next info nextinfo get internal placeholder getinternalplaceholder rewrite event rewriteevent new event newevent next info nextinfo is move ismove remove replace new event newevent node rewrite event noderewriteevent internal placeholder internalplaceholder next info nextinfo replacing node replacingnode new event newevent node rewrite event noderewriteevent internal placeholder internalplaceholder internal placeholder internalplaceholder unchanged new child events newchildevents add new event newevent next info nextinfo edit group editgroup set event edit group seteventeditgroup new event newevent next info nextinfo edit group editgroup new children stack newchildrenstack push new child events newchildevents top info stack topinfostack push top info topinfo new child events newchildevents array list arraylist child events childevents length top info topinfo next info nextinfo next info nextinfo range info iterator rangeinfoiterator has next hasnext node range info noderangeinfo range info iterator rangeinfoiterator new child events newchildevents add event top info topinfo node top info topinfo get end node getendnode rewrite event rewriteevent placeholder child events placeholderchildevents rewrite event rewriteevent new child events newchildevents to array toarray rewrite event rewriteevent new child events newchildevents size block internal placeholder internalplaceholder top info topinfo get internal placeholder getinternalplaceholder add event addevent internal placeholder internalplaceholder block statements property list rewrite event listrewriteevent placeholder child events placeholderchildevents new child events newchildevents list new children stack newchildrenstack pop top info topinfo node range info noderangeinfo top info stack topinfostack pop rewrite event rewriteevent new child events newchildevents to array toarray rewrite event rewriteevent new child events newchildevents size moved nodes marked removed replaced prepare single node copies preparesinglenodecopies node copy sources nodecopysources size copy source info copysourceinfo curr copy source info copysourceinfo node copy sources nodecopysources curr is move ismove curr location do mark moved as removed domarkmovedasremoved curr curr location get parent getparent curr location get property getproperty do mark moved as removed domarkmovedasremoved copy source info copysourceinfo curr ast node astnode parent structural property descriptor structuralpropertydescriptor child property childproperty child property childproperty is child list property ischildlistproperty list rewrite event listrewriteevent event get list event getlistevent parent child property childproperty event get index getindex curr get node getnode list rewrite event listrewriteevent event get change kind getchangekind rewrite event rewriteevent unchanged event set new value setnewvalue node rewrite event noderewriteevent event get node event getnodeevent parent child property childproperty event get change kind getchangekind rewrite event rewriteevent unchanged event set new value setnewvalue is insert bound to previous isinsertboundtoprevious ast node astnode node insert bound to previous insertboundtoprevious insert bound to previous insertboundtoprevious node set insert bound to previous setinsertboundtoprevious ast node astnode node insert bound to previous insertboundtoprevious insert bound to previous insertboundtoprevious hash set hashset insert bound to previous insertboundtoprevious add node validate is list property validateislistproperty structural property descriptor structuralpropertydescriptor property property is child list property ischildlistproperty nls string message property get id getid list property illegal argument exception illegalargumentexception message validate has child property validatehaschildproperty ast node astnode parent structural property descriptor structuralpropertydescriptor property parent structural properties for type structuralpropertiesfortype property nls string message signature get simple name getsimplename parent get class getclass get name getname property property get id getid illegal argument exception illegalargumentexception message validate is node property validateisnodeproperty structural property descriptor structuralpropertydescriptor property property is child list property ischildlistproperty nls string message property get id getid node property illegal argument exception illegalargumentexception message string to string tostring string buffer stringbuffer buf string buffer stringbuffer iterator iter event lookup eventlookup values iterator iter has next hasnext list events list iter events size buf append events to string tostring append buf to string tostring is new node isnewnode ast node astnode node node get flags getflags ast node astnode original
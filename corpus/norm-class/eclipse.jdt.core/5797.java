copyright mateusz matela rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors mateusz matela mateusz matela gmail formatter formatter format java code correctly max width https bugs eclipse org org eclipse jdt internal formatter org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment block org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamecomment javadoc org eclipse jdt internal compiler parser terminal tokens terminaltokens token name not token tokennamenotatoken org eclipse jdt internal compiler parser terminal tokens terminaltokens token name string literal tokennamestringliteral org eclipse jdt internal compiler parser terminal tokens terminaltokens tokennamewhitespace java util array list arraylist java util arrays java util list org eclipse jdt internal compiler parser scanner helper scannerhelper org eclipse jdt internal formatter token wrap mode wrapmode org eclipse jdt internal formatter token wrap policy wrappolicy org eclipse jface text i region iregion org eclipse jface text region org eclipse text edits replace edit replaceedit org eclipse text edits text edit textedit creates formatter result text edit textedit scanning tokens comparing original source text edits builder texteditsbuilder token traverser tokentraverser string source list i region iregion regions token manager tokenmanager default code formatter options defaultcodeformatteroptions options string builder stringbuilder buffer list token string literals in line stringliteralsinline array list arraylist token list text edit textedit edits array list arraylist text edit textedit current region currentregion text edits builder texteditsbuilder child builder childbuilder text edits builder texteditsbuilder parent align char alignchar source limit sourcelimit parent token index parenttokenindex text edits builder texteditsbuilder string source i region iregion regions token manager tokenmanager token manager tokenmanager default code formatter options defaultcodeformatteroptions options source source token manager tokenmanager options options regions adapt regions adaptregions regions align char alignchar options tab source limit sourcelimit source length parent buffer string builder stringbuilder text edits builder texteditsbuilder text edits builder texteditsbuilder parent buffer parent buffer parent parent source parent source options parent options regions parent regions align char alignchar default code formatter options defaultcodeformatteroptions space list i region iregion adapt regions adaptregions i region iregion given regions givenregions given regions givenregions regions don multiline comments array list arraylist i region iregion result array list arraylist i region iregion i region iregion previous i region iregion region given regions givenregions start region get offset getoffset start region get length getlength source start sourcestart original start originalstart start source start sourcestart token token find index findindex start token token type tokentype tokennamecomment block token token type tokentype tokennamecomment javadoc start token original end originalend start token original start originalstart start source start sourcestart token token find index findindex token token type tokentype tokennamecomment block token token type tokentype tokennamecomment javadoc token original end originalend token original end originalend previous previous get offset getoffset previous get length getlength start result remove result size start previous get offset getoffset source length i region iregion adapted region start start result add adapted previous adapted result override token token token buffer whitespace before bufferwhitespacebefore token list token structure token get internal structure getinternalstructure token token type tokentype tokennamecomment handle single line comment handlesinglelinecomment token structure structure is empty isempty handle multi line comment handlemultilinecomment token flush buffer flushbuffer token original start originalstart token is to escape istoescape buffer append to string tostring token flush buffer flushbuffer token original end originalend counter token original end originalend token token type tokentype token name string literal tokennamestringliteral string literals in line stringliteralsinline add token get next getnext token get line breaks after getlinebreaksafter buffer line separator bufferlineseparator token get line breaks after getlinebreaksafter last char lastchar source char at charat source limit sourcelimit token get line breaks after getlinebreaksafter last char lastchar last char lastchar buffer line separator bufferlineseparator flush buffer flushbuffer source limit sourcelimit buffer whitespace before bufferwhitespacebefore token token get line breaks before getlinebreaksbefore string literals in line stringliteralsinline clear get line breaks before getlinebreaksbefore token indent token indenttoken options indent empty lines token token type tokentype token name not token tokennamenotatoken indent token indenttoken token is for ced isforced token get wrap policy getwrappolicy token get wrap policy getwrappolicy wrap mode wrapmode wrap mode wrapmode force d forced token previous find first token in line findfirsttokeninline is for ced isforced indent token indenttoken token get indent getindent previous get indent getindent token previous get line breaks before getlinebreaksbefore buffer line separator bufferlineseparator token indent token indenttoken buffer indent bufferindent indent token indenttoken buffer line separator bufferlineseparator token buffer align bufferalign token buffer indent bufferindent token parent buffer indent bufferindent token buffer align bufferalign token is space before isspacebefore token get align getalign buffer append buffer line separator bufferlineseparator token token empty line emptyline parent buffer append options separator parent counter counter parent buffer line separator bufferlineseparator parent buffer indent bufferindent parent parent token index parenttokenindex parent token index parenttokenindex counter parent counter token token token type tokentype token name not token tokennamenotatoken unformatted block comment don force ast erisk asterisk get next getnext empty line emptyline token block comment ast erisk asterisk included ast erisk found asteriskfound search limit searchlimit token token original start originalstart source limit sourcelimit counter search limit searchlimit source char at charat buffer append flush buffer flushbuffer source limit sourcelimit source char at charat counter source char at charat empty line emptyline buffer append ast erisk found asteriskfound scanner helper scannerhelper is whitespace iswhitespace ast erisk found asteriskfound nls buffer append buffer indent bufferindent token token indent token get indent getindent get current getcurrent get current getcurrent token indent get current getcurrent get empty line indent adjustment getemptylineindentadjustment spaces options tabs leading indent ations indentations options tab default code formatter options defaultcodeformatteroptions space wrap policy wrappolicy wrap policy wrappolicy token get wrap policy getwrappolicy is wrapped block comment iswrappedblockcomment child builder childbuilder child builder childbuilder parent token index parenttokenindex is wrapped block comment iswrappedblockcomment token line start linestart find first token in line findfirsttokeninline spaces token get indent getindent line start linestart get indent getindent token line start linestart wrap policy wrappolicy token get wrap policy getwrappolicy wrap policy wrappolicy token parent line start parentlinestart find first token in line findfirsttokeninline wrap policy wrappolicy wrap parent index wrapparentindex wrap policy wrappolicy wrap mode wrapmode wrap mode wrapmode force d forced spaces token get indent getindent parent line start parentlinestart get indent getindent token parent line start parentlinestart wrap policy wrappolicy token get wrap policy getwrappolicy append indentation string appendindentationstring buffer options tab options tab size indent spaces spaces append indentation string appendindentationstring string builder stringbuilder target tab char tabchar tab size tabsize indent additional spaces additionalspaces spaces count spacescount additional spaces additionalspaces tabs count tabscount tab char tabchar default code formatter options defaultcodeformatteroptions space spaces count spacescount indent default code formatter options defaultcodeformatteroptions tab tab size tabsize tabs count tabscount indent tab size tabsize indent tab size tabsize tabs count tabscount default code formatter options defaultcodeformatteroptions mixed tab size tabsize tabs count tabscount indent tab size tabsize spaces count spacescount indent tab size tabsize spaces count spacescount indent nls illegal state exception illegalstateexception nls unrecognized tab tab char tabchar indent chars indentchars tabs count tabscount spaces count spacescount arrays fill indent chars indentchars tabs count tabscount arrays fill indent chars indentchars tabs count tabscount indent chars indentchars length target append indent chars indentchars buffer align bufferalign token token align token get align getalign align current position in line currentpositioninline get line breaks before getlinebreaksbefore parent current position in line currentpositioninline to indent toindent token get indent getindent token get wrap policy getwrappolicy current position in line currentpositioninline get position in line getpositioninline current position in line currentpositioninline get length getlength current position in line currentpositioninline is space before isspacebefore align math max align current position in line currentpositioninline tab size tabsize options tab size align char alignchar default code formatter options defaultcodeformatteroptions space current position in line currentpositioninline align buffer append default code formatter options defaultcodeformatteroptions tab current position in line currentpositioninline align tab size tabsize buffer append current position in line currentpositioninline tab size tabsize current position in line currentpositioninline tab size tabsize default code formatter options defaultcodeformatteroptions mixed tab size tabsize current position in line currentpositioninline tab size tabsize current position in line currentpositioninline tab size tabsize align buffer append current position in line currentpositioninline tab size tabsize current position in line currentpositioninline tab size tabsize current position in line currentpositioninline align buffer append nls illegal state exception illegalstateexception nls unrecognized align align char alignchar flush buffer flushbuffer current position currentposition string buf fered buffered buffer to string tostring source match sourcematch source starts with startswith buf fered buffered counter counter buf fered buffered length current position currentposition source match sourcematch current region currentregion regions size i region iregion region regions current region currentregion current position currentposition region get offset getoffset region end regionend region get offset getoffset region get length getlength counter region end regionend current region currentregion current region currentregion regions size regions current region currentregion get offset getoffset current position currentposition edits add get replace edit getreplaceedit counter current position currentposition buf fered buffered region edit span region split i region iregion next region nextregion regions current region currentregion best split bestsplit best split score bestsplitscore integer max buf fered buffered length replace edit replaceedit edit get replace edit getreplaceedit counter region end regionend buf fered buffered substring region replace edit replaceedit edit get replace edit getreplaceedit region end regionend current position currentposition buf fered buffered substring next region nextregion score edit get length getlength edit get text gettext length edit get length getlength edit get text gettext length score best split score bestsplitscore best split bestsplit best split score bestsplitscore score edits add get replace edit getreplaceedit counter region end regionend buf fered buffered substring best split bestsplit region buf fered buffered buf fered buffered substring best split bestsplit counter region end regionend buffer set length setlength counter current position currentposition replace edit replaceedit get replace edit getreplaceedit edit start editstart edit end editend string text i region iregion region region end regionend region get offset getoffset region get length getlength edit start editstart region get offset getoffset region end regionend edit end editend breaks in replacement breaksinreplacement count line breaks between countlinebreaksbetween text text length breaks before region breaksbeforeregion count line breaks between countlinebreaksbetween source edit start editstart region get offset getoffset breaks after region breaksafterregion count line breaks between countlinebreaksbetween source region end regionend edit end editend breaks before region breaksbeforeregion breaks after region breaksafterregion breaks in replacement breaksinreplacement nls text edit start editstart region get offset getoffset edit end editend region end regionend region get offset getoffset edit start editstart is only whitespace isonlywhitespace text breaks in replacement breaksinreplacement count line breaks between countlinebreaksbetween text text length breaks outside region breaksoutsideregion count line breaks between countlinebreaksbetween source edit start editstart region get offset getoffset breaks to preserve breakstopreserve breaks in replacement breaksinreplacement breaks outside region breaksoutsideregion text adapt replace text adaptreplacetext text breaks to preserve breakstopreserve region get offset getoffset edit start editstart region get offset getoffset region end regionend edit end editend is only whitespace isonlywhitespace text breaks in replacement breaksinreplacement count line breaks between countlinebreaksbetween text text length breaks outside region breaksoutsideregion count line breaks between countlinebreaksbetween source region end regionend edit end editend breaks to preserve breakstopreserve breaks in replacement breaksinreplacement breaks outside region breaksoutsideregion text adapt replace text adaptreplacetext text breaks to preserve breakstopreserve region end regionend edit end editend region end regionend replace edit replaceedit edit start editstart edit end editend edit start editstart text is only whitespace isonlywhitespace string text text length scanner helper scannerhelper is whitespace iswhitespace text char at charat string adapt replace text adaptreplacetext string text breaks to preserve breakstopreserve is region end isregionend region edge regionedge is region end isregionend text length direction is region end isregionend preserved breaks preservedbreaks text length direction scanner helper scannerhelper is whitespace iswhitespace text char at charat text char at charat preserved breaks preservedbreaks breaks to preserve breakstopreserve preserved breaks preservedbreaks direction text length text char at charat text is region end isregionend text substring text substring cut text source region matching whitespace text pos textpos is region end isregionend text length source pos sourcepos region edge regionedge the loop theloop text pos textpos text pos textpos text length source pos sourcepos source pos sourcepos source length text char at charat text pos textpos source char at charat source pos sourcepos text pos textpos direction source pos sourcepos direction options tab size source pos sourcepos direction options tab size source pos sourcepos source pos sourcepos source length source char at charat source pos sourcepos the loop theloop text pos textpos direction options tab size text pos textpos direction options tab size text pos textpos text pos textpos text length text char at charat text pos textpos the loop theloop source pos sourcepos direction is region end isregionend text text substring text pos textpos text text substring text pos textpos text handle single line comment handlesinglelinecomment token line comment linecomment list token structure line comment linecomment get internal structure getinternalstructure structure flush buffer flushbuffer line comment linecomment original start originalstart counter line comment linecomment original end originalend structure token type tokentype tokennamewhitespace flush buffer flushbuffer structure original start originalstart flush buffer flushbuffer line comment linecomment original start originalstart structure size token fragment structure fragment get line breaks before getlinebreaksbefore buffer line separator bufferlineseparator fragment buffer indent bufferindent fragment fragment is space before isspacebefore buffer append fragment hasnlstag tag number tagnumber string literals in line stringliteralsinline index of indexof fragment getnlstag tag number tagnumber nls nls buffer append nls append tag number tagnumber append fragment original start originalstart counter comment prefix copy earlier code buffer append to string tostring fragment flush buffer flushbuffer fragment original start originalstart counter fragment original end originalend for ged forged comment line comment linecomment original end originalend line comment linecomment original start originalstart flush buffer flushbuffer line comment linecomment original end originalend handle multi line comment handlemultilinecomment token comment flush buffer flushbuffer comment original start originalstart child builder childbuilder child builder childbuilder text edits builder texteditsbuilder child builder childbuilder traverse internal structure traverseinternalstructure comment edits add all addall child builder childbuilder edits child builder childbuilder edits clear counter child builder childbuilder source limit sourcelimit traverse internal structure traverseinternalstructure token token list token structure token get internal structure getinternalstructure token manager tokenmanager structure parent counter token original start originalstart source limit sourcelimit token original end originalend parent token index parenttokenindex traverse structure process comment processcomment token comment token commenttoken comment token commenttoken is comment iscomment comment token commenttoken token type tokentype tokennamecomment handle single line comment handlesinglelinecomment comment token commenttoken index of indexof comment token commenttoken handle multi line comment handlemultilinecomment comment token commenttoken index of indexof comment token commenttoken list text edit textedit get edits getedits edits set align char setalignchar align char alignchar align char alignchar align char alignchar
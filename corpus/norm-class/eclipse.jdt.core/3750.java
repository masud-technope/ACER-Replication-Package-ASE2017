copyright walter harley rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors eclipse cafewalter initial api implementation org eclipse jdt apt pluggable tests java file junit framework test junit framework test suite testsuite org eclipse core resources i folder ifolder org eclipse core resources i project iproject org eclipse core resources i resource iresource org eclipse core resources resources plugin resourcesplugin org eclipse core runtime i path ipath org eclipse jdt apt core util apt config aptconfig org eclipse jdt core i java project ijavaproject performance tests pro filing profiling apt performance tests performancetests test base testbase verbose wait indexer creating files pause milliseconds wait indexer pause time include apt disabled string cmd profiler prefix java jar opt your kit yourkit lib yjp control ler controller api redist jar localhost string cmd start cpu profiling cmd profiler prefix start cpu sam pling sampling noj string cmd cpu profiling cmd profiler prefix cpu pro filing profiling string cmd perf snapshot cmd profiler prefix capture performance snapshot string cmd heap snapshot cmd profiler prefix capture memory snapshot performance tests performancetests string test suite test suite testsuite performance tests performancetests set up setup exception set up setup create files annotations won processed create boring files createboringfiles num files numfiles i java project ijavaproject jproj string src template srctemplate java util list suppress warnings suppresswarnings unchecked test b testb list list get l getl string name template nametemplate test b testb create files createfiles num files numfiles name template nametemplate src template srctemplate jproj create files annotations processed java processor create int eresting files with j createinterestingfileswithj num files numfiles i java project ijavaproject jproj string src template srctemplate org eclipse jdt apt pluggable tests annotations model test trigger modeltesttrigger org eclipse jdt apt pluggable tests annotations look at lookat java util list model test trigger modeltesttrigger test test field type testfieldtype suppress warnings suppresswarnings unused test i testi look at lookat f int fint look at lookat string f string fstring look at lookat list string f foo ffoo string name template nametemplate test i testi create files createfiles num files numfiles name template nametemplate src template srctemplate jproj create files annotations files generated create generating files creategeneratingfiles num files numfiles i java project ijavaproject jproj string src template srctemplate org eclipse jdt apt pluggable tests annotations gen class genclass gen class genclass pkg generated test g testg string name template nametemplate test g testg create files createfiles num files numfiles name template nametemplate src template srctemplate jproj create files createfiles num files numfiles string name template nametemplate string src template srctemplate i java project ijavaproject jproj i project iproject project jproj get project getproject i folder ifolder src folder srcfolder project get folder getfolder src i path ipath src root srcroot src folder srcfolder get full path getfullpath num files numfiles string string format name template nametemplate string contents string format src template srctemplate nls nls env add class addclass src root srcroot contents pause indexer pause verbose system println created files pausing indexer thread sleep pause time interrupted exception interruptedexception runtime exception runtimeexception verbose system println creating source files performance files annotations won processed test boring files testboringfiles exception total number files create files generate project unique i java project ijavaproject jproj create java project createjavaproject project name projectname i project iproject project jproj get project getproject create boring files createboringfiles files generate jproj runtime runtime get runtime getruntime start include apt disabled apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println apt disabled full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis full build fullbuild project get full path getfullpath verbose system println full build system current time millis currenttimemillis start system println heap snapshot exec cmd heap snapshot wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis verbose system println apt enabled starting full build full build fullbuild project get full path getfullpath verbose system println full build system current time millis currenttimemillis start system println heap snapshot exec cmd heap snapshot wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis verbose system println apt enabled starting full build exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis verbose system println apt enabled starting full build exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems delete project verbose system println deleting workspace resources plugin resourcesplugin get workspace getworkspace delete i resource iresource project performance files annotations processed java processor file generation test int eresting files with j testinterestingfileswithj exception total number files create files generate project unique i java project ijavaproject jproj create java project createjavaproject project name projectname i project iproject project jproj get project getproject create int eresting files with j createinterestingfileswithj files generate jproj runtime runtime get runtime getruntime start include apt disabled apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println apt disabled full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println apt disabled full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems system thread sleep apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis verbose system println apt enabled starting full build exec cmd start cpu profiling wait for waitfor full build fullbuild project get full path getfullpath verbose system println full build system current time millis currenttimemillis start exec cmd perf snapshot wait for waitfor exec cmd cpu profiling wait for waitfor expecting no problems expectingnoproblems delete project verbose system println deleting workspace resources plugin resourcesplugin get workspace getworkspace delete i resource iresource project verbose system println test complete test files meaningful processing generation additional types disabled test generating lots of files testgeneratinglotsoffiles exception total number files create files generate project unique i java project ijavaproject jproj create java project createjavaproject project name projectname i project iproject project jproj get project getproject create generating files creategeneratingfiles files generate jproj project preferences apt config aptconfig set enabled setenabled jproj start system current time millis currenttimemillis full build fullbuild project get full path getfullpath verbose system println build system current time millis currenttimemillis start expecting no problems expectingnoproblems i path ipath proj path projpath jproj get project getproject get location getlocation files generate check file generated string gen file name genfilename string format apt generated generated java file gen file genfile file proj path projpath append gen file name genfilename toosstring assert true asserttrue expected generated source file gen file name genfilename gen file genfile gen file genfile exists check generated file compiled string gen class name genclassname string format bin generated file gen class genclass file proj path projpath append gen class name genclassname toosstring assert true asserttrue compiled file gen class name genclassname gen class genclass gen class genclass exists verbose system println checking output delete project resources plugin resourcesplugin get workspace getworkspace delete i resource iresource project
copyright ibm corporation rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors ibm corporation initial api implementation org eclipse jdt internal compiler parser internal field structure parsing recovery org eclipse jdt internal compiler ast abstract method declaration abstractmethoddeclaration org eclipse jdt internal compiler ast ast node astnode org eclipse jdt internal compiler ast block org eclipse jdt internal compiler ast compilation unit declaration compilationunitdeclaration org eclipse jdt internal compiler ast field declaration fielddeclaration org eclipse jdt internal compiler ast import reference importreference org eclipse jdt internal compiler ast initializer org eclipse jdt internal compiler ast type declaration typedeclaration recovered unit recoveredunit recovered element recoveredelement compilation unit declaration compilationunitdeclaration unit declaration unitdeclaration recovered import recoveredimport imports import count importcount recovered type recoveredtype types type count typecount recovered unit recoveredunit compilation unit declaration compilationunitdeclaration unit declaration unitdeclaration bracket balance bracketbalance parser parser bracket balance bracketbalance parser unit declaration unitdeclaration unit declaration unitdeclaration record method declaration attached type recovered element recoveredelement add abstract method declaration abstractmethoddeclaration method declaration methoddeclaration bracket balance value bracketbalancevalue attach type type count typecount recovered type recoveredtype type types type count typecount start type body end bodyend type type declaration typedeclaration body end bodyend reset position type body end bodyend reset position type type declaration typedeclaration declaration source end declarationsourceend type type declaration typedeclaration body end bodyend start initializer initializer initializer block initializer body start bodystart initializer body end bodyend initializer declaration source start declarationsourcestart initializer declaration source end declarationsourceend start type add initializer bracket balance value bracketbalancevalue type add method declaration methoddeclaration bracket balance value bracketbalancevalue ignore record field declaration attached type recovered element recoveredelement add field declaration fielddeclaration field declaration fielddeclaration bracket balance value bracketbalancevalue attach type type count typecount recovered type recoveredtype type types type count typecount reset position type body end bodyend reset position type type declaration typedeclaration declaration source end declarationsourceend type type declaration typedeclaration body end bodyend type add field declaration fielddeclaration bracket balance value bracketbalancevalue ignore recovered element recoveredelement add import reference importreference import reference importreference bracket balance value bracketbalancevalue imports imports recovered import recoveredimport import count importcount import count importcount imports length system arraycopy imports imports recovered import recoveredimport import count importcount import count importcount recovered import recoveredimport element recovered import recoveredimport import reference importreference bracket balance value bracketbalancevalue imports import count importcount element finished current import reference importreference declaration source end declarationsourceend element recovered element recoveredelement add type declaration typedeclaration type declaration typedeclaration bracket balance value bracketbalancevalue type declaration typedeclaration bits ast node astnode isanonymoustypemask type count typecount add type recovered type recoveredtype last type lasttype types type count typecount reopen type last type lasttype body end bodyend reopen type last type lasttype type declaration typedeclaration body end bodyend reopen type last type lasttype type declaration typedeclaration declaration source end declarationsourceend expect closing brace last type lasttype bracket balance bracketbalance last type lasttype add type declaration typedeclaration bracket balance value bracketbalancevalue types types recovered type recoveredtype type count typecount type count typecount types length system arraycopy types types recovered type recoveredtype type count typecount type count typecount recovered type recoveredtype element recovered type recoveredtype type declaration typedeclaration bracket balance value bracketbalancevalue types type count typecount element type finished type current type declaration typedeclaration declaration source end declarationsourceend element answer parsed structure ast node astnode parse tree parsetree unit declaration unitdeclaration answer source parse node source end sourceend unit declaration unitdeclaration source end sourceend string to string tostring tab string buffer stringbuffer result string buffer stringbuffer tab string tabstring tab nls result append recovered unit unit declaration unitdeclaration print tab result result append tab string tabstring tab nls result append imports import count importcount nls result append result append imports to string tostring tab types type count typecount nls result append result append types to string tostring tab result to string tostring compilation unit declaration compilationunitdeclaration updated compilation unit declaration updatedcompilationunitdeclaration update imports import count importcount import reference importreference import ref ences importrefences import reference importreference import count importcount import count importcount import ref ences importrefences imports updated import reference updatedimportreference unit declaration unitdeclaration imports import ref ences importrefences update types type count typecount existing count existingcount unit declaration unitdeclaration types unit declaration unitdeclaration types length type declaration typedeclaration type declarations typedeclarations type declaration typedeclaration existing count existingcount type count typecount existing count existingcount system arraycopy unit declaration unitdeclaration types type declarations typedeclarations existing count existingcount update declaration source end declarationsourceend type types type count typecount type declaration typedeclaration declaration source end declarationsourceend types type count typecount type declaration typedeclaration declaration source end declarationsourceend unit declaration unitdeclaration source end sourceend types type count typecount type declaration typedeclaration body end bodyend unit declaration unitdeclaration source end sourceend actual count actualcount existing count existingcount type count typecount type declaration typedeclaration type decl typedecl types updated type declaration updatedtypedeclaration filter local types type decl typedecl bits ast node astnode islocaltypemask type declarations typedeclarations actual count actualcount type decl typedecl actual count actualcount type count typecount system arraycopy type declarations typedeclarations type declarations typedeclarations type declaration typedeclaration existing count existingcount actual count actualcount existing count existingcount actual count actualcount unit declaration unitdeclaration types type declarations typedeclarations unit declaration unitdeclaration update parse tree updateparsetree updated compilation unit declaration updatedcompilationunitdeclaration update source end sourceend parse node update source end if necessary updatesourceendifnecessary body start bodystart body end bodyend unit declaration unitdeclaration source end sourceend unit declaration unitdeclaration source end sourceend body end bodyend
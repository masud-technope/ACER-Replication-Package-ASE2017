copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt core dom java util abstract list abstractlist java util array list arraylist java util collections java util hash map hashmap java util iterator java util list java util map org eclipse jdt internal core dom naiveastflattener superclass syntax tree ast node types ast node represents java source code construct type expression statement declaration ast node belongs unique ast instance called owning ast children ast node owner parent node node ast ast subtree clone d cloned ensure nodes correct owning ast ast node ast unique parent node clients navigate child parent parent child newly created nodes unparented unparented node child node code child code method parent link automatically parent link child code code nodes properties include list children code block code code statements code property list statements adding removing element list property automatically updates parent links lists support code list code method constraint node method swap elements removing node ast s asts cycles operations create cycle detect pos sibility possibility fail ast s asts holes missing subtrees node required property syntactically plausible initial supplied hierarchy ast node types convenient group ings groupings marked super classes superclasses expressions code expression code names code code kind expression statements code statement code types code type code type body declarations code body declaration bodydeclaration code syntax trees hand constructed clients code type code factory methods code ast code create nodes code child code methods connect link ast parser astparser parses string java source code returns syntax tree nodes carry source ranges rel ating relating node original source characters source range covers construct ast node carries bit flags convey additional node instance parser flag syntax error newly created nodes flags ast node capable carrying open ended collection client defined properties newly created nodes code get property getproperty code code set property setproperty code access properties ast nodes thread safe read ers readers active write rs writers thread modifying ast including creating nodes cloning existing safe thread read visit write create clone nodes ast synchronization required common ast object owns node code synchronize node getast code ast s asts support visitor pattern code ast visitor astvisitor code details code node finder nodefinder code find specific node tree compilation units created code ast parser astparser code source document serialized arbitrary modifications minimal loss original for matting formatting link compilation unit compilationunit record modifications recordmodifications details link org eclipse jdt core dom rewrite ast rewrite astrewrite alternative describe serialize read ast ast parser astparser ast visitor astvisitor node finder nodefinder noextend intended subclassed clients suppress warnings suppresswarnings rawtypes unchecked ast node astnode att ention attention ast node astnode hierarchy reinvent wheel precedents structural property type child node properties option ality optionality lazy initialization blurbs impl declaring node type kind super type supertype concrete type history jls x jlsx api jls x jlsx replaced link copy code javadoc created code generator subclasses ast node astnode order properties order occurrence source general classes list ast node types order alphabetically instructions adding concrete ast node types changed concrete ast node type call foo bar foobar create foo bar foobar ast node type effective copy existing concrete node template includes framework methods implemented add node type constant ast node astnode foo bar node constants num bered numbered cons ecutively consecutively add constant existing add entry ast node astnode node class for type nodeclassfortype add ast new foo bar newfoobar factory method add ast visitor astvisitor visit foo bar foobar end visit endvisit foo bar foobar methods defaultastvisitor add ast matcher astmatcher match foo bar foobar object method ensure simple name simplename is declaration isdeclaration covers foo bar foobar nodes required add naiveastflattener visit foo bar foobar method illustrate nodes serialized update ast test suites ast visitor test astvisitortest steps update ast parse start gen erating generating type nodes ast rewrite astrewrite serialize instructions adding property ast node type concrete node types properties simple name simplename class instance creation classinstancecreation templates copy paste field property descriptor get ter getter set ter setter adjust property type field javadoc properly document initialization applicable api levels add remove tags search references members template add references places property node types abstract type declaration abstracttypedeclaration template steps extra care copy adjust internal methods search references members template add references places property property descriptor leaf type instructions replacing deprecating property ast node replace simple property child list property single variable declaration singlevariabledeclaration replaced modifiers property modifiers property reuse property deprecate references property get ter getter compute property api levels completely replace property class instance creation classinstancecreation replaced property type property node type constant indicating node type code anonymous class declaration anonymousclassdeclaration code anonymous class declaration anonymousclassdeclaration anonymous declaration node type constant indicating node type code array access arrayaccess code array access arrayaccess array access node type constant indicating node type code array creation arraycreation code array creation arraycreation array creation node type constant indicating node type code array initializer arrayinitializer code array initializer arrayinitializer array initializer node type constant indicating node type code array type arraytype code array type arraytype array type node type constant indicating node type code assert statement assertstatement code assert statement assertstatement statement node type constant indicating node type code assignment code assignment assignment node type constant indicating node type code block code block block node type constant indicating node type code boolean literal booleanliteral code boolean literal booleanliteral literal node type constant indicating node type code break statement breakstatement code break statement breakstatement statement node type constant indicating node type code cast expression castexpression code cast expression castexpression expression node type constant indicating node type code catch clause catchclause code catch clause catchclause clause node type constant indicating node type code character literal characterliteral code character literal characterliteral character literal node type constant indicating node type code class instance creation classinstancecreation code class instance creation classinstancecreation instance creation node type constant indicating node type code compilation unit compilationunit code compilation unit compilationunit compilation unit node type constant indicating node type code conditional expression conditionalexpression code conditional expression conditionalexpression conditional expression node type constant indicating node type code constructor invocation constructorinvocation code constructor invocation constructorinvocation constructor invocation node type constant indicating node type code continue statement continuestatement code continue statement continuestatement statement node type constant indicating node type code do statement dostatement code do statement dostatement statement node type constant indicating node type code empty statement emptystatement code empty statement emptystatement empty statement node type constant indicating node type code expression statement expressionstatement code expression statement expressionstatement expression statement node type constant indicating node type code field access fieldaccess code field access fieldaccess field access node type constant indicating node type code field declaration fielddeclaration code field declaration fielddeclaration field declaration node type constant indicating node type code for statement forstatement code for statement forstatement statement node type constant indicating node type code if statement ifstatement code if statement ifstatement statement node type constant indicating node type code import declaration importdeclaration code import declaration importdeclaration declaration node type constant indicating node type code infix expression infixexpression code infix expression infixexpression infix expression node type constant indicating node type code initializer code initializer initializer node type constant indicating node type code javadoc code javadoc javadoc node type constant indicating node type code labeled statement labeledstatement code labeled statement labeledstatement labeled statement node type constant indicating node type code method declaration methoddeclaration code method declaration methoddeclaration method declaration node type constant indicating node type code method invocation methodinvocation code method invocation methodinvocation method invocation node type constant indicating node type code null literal nullliteral code null literal nullliteral literal node type constant indicating node type code number literal numberliteral code number literal numberliteral number literal node type constant indicating node type code package declaration packagedeclaration code package declaration packagedeclaration declaration node type constant indicating node type code parenthesized expression parenthesizedexpression code parenthesized expression parenthesizedexpression parenthesized expression node type constant indicating node type code postfix expression postfixexpression code postfix expression postfixexpression postfix expression node type constant indicating node type code prefix expression prefixexpression code prefix expression prefixexpression prefix expression node type constant indicating node type code primitive type primitivetype code primitive type primitivetype primitive type node type constant indicating node type code qualified name qualifiedname code qualified name qualifiedname qualified node type constant indicating node type code return statement returnstatement code return statement returnstatement statement node type constant indicating node type code simple name simplename code simple name simplename simple node type constant indicating node type code simple type simpletype code simple type simpletype simple type node type constant indicating node type code single variable declaration singlevariabledeclaration code single variable declaration singlevariabledeclaration single variable declaration node type constant indicating node type code string literal stringliteral code string literal stringliteral string literal node type constant indicating node type code super constructor invocation superconstructorinvocation code super constructor invocation superconstructorinvocation constructor invocation node type constant indicating node type code super field access superfieldaccess code super field access superfieldaccess field access node type constant indicating node type code super method invocation supermethodinvocation code super method invocation supermethodinvocation method invocation node type constant indicating node type code switch case switchcase code switch case switchcase node type constant indicating node type code switch statement switchstatement code switch statement switchstatement statement node type constant indicating node type code synchronized statement synchronizedstatement code synchronized statement synchronizedstatement statement node type constant indicating node type code this expression thisexpression code this expression thisexpression expression node type constant indicating node type code throw statement throwstatement code throw statement throwstatement statement node type constant indicating node type code try statement trystatement code try statement trystatement statement node type constant indicating node type code type declaration typedeclaration code type declaration typedeclaration type declaration node type constant indicating node type code type declaration statement typedeclarationstatement code type declaration statement typedeclarationstatement type declaration statement node type constant indicating node type code type literal typeliteral code type literal typeliteral type literal node type constant indicating node type code variable declaration expression variabledeclarationexpression code variable declaration expression variabledeclarationexpression variable declaration expression node type constant indicating node type code variable declaration fragment variabledeclarationfragment code variable declaration fragment variabledeclarationfragment variable declaration fragment node type constant indicating node type code variable declaration statement variabledeclarationstatement code variable declaration statement variabledeclarationstatement variable declaration statement node type constant indicating node type code while statement whilestatement code while statement whilestatement statement node type constant indicating node type code instanceof expression instanceofexpression code instanceof expression instanceofexpression expression node type constant indicating node type code line comment linecomment code line comment linecomment comment node type constant indicating node type code block comment blockcomment code block comment blockcomment block comment node type constant indicating node type code tag element tagelement code tag element tagelement tag element node type constant indicating node type code text element textelement code text element textelement text element node type constant indicating node type code member ref memberref code member ref memberref member node type constant indicating node type code method ref methodref code method ref methodref method node type constant indicating node type code method ref parameter methodrefparameter code method ref parameter methodrefparameter method parameter node type constant indicating node type code enhanced for statement enhancedforstatement code enhanced for statement enhancedforstatement enhanced statement node type constant indicating node type code enum declaration enumdeclaration code enum declaration enumdeclaration enum declaration node type constant indicating node type code enum constant declaration enumconstantdeclaration code enum constant declaration enumconstantdeclaration enum constant declaration node type constant indicating node type code type parameter typeparameter code type parameter typeparameter type parameter node type constant indicating node type code parameterized type parameterizedtype code parameterized type parameterizedtype parameterized type node type constant indicating node type code qualified type qualifiedtype code qualified type qualifiedtype qualified type node type constant indicating node type code wildcard type wildcardtype code wildcard type wildcardtype wildcard type node type constant indicating node type code normal annotation normalannotation code normal annotation normalannotation normal annotation node type constant indicating node type code marker annotation markerannotation code marker annotation markerannotation marker annotation node type constant indicating node type code single member annotation singlememberannotation code single member annotation singlememberannotation single member annotation node type constant indicating node type code member value pair membervaluepair code member value pair membervaluepair member pair node type constant indicating node type code annotation type declaration annotationtypedeclaration code annotation type declaration annotationtypedeclaration annotation type declaration node type constant indicating node type code annotation type member declaration annotationtypememberdeclaration code annotation type member declaration annotationtypememberdeclaration annotation type member declaration node type constant indicating node type code modifier code modifier modifier node type constant indicating node type code union type uniontype code union type uniontype union type node type constant indicating node type code dimension code dimension dimension node type constant indicating node type code lambda expression lambdaexpression code lambda expression lambdaexpression lambda expression node type constant indicating node type code int ersection type intersectiontype code int ersection type intersectiontype intersection type node type constant indicating node type code name qualified type namequalifiedtype code name qualified type namequalifiedtype qualified type node type constant indicating node type code creation reference creationreference code creation reference creationreference creation reference node type constant indicating node type code expression method reference expressionmethodreference code expression method reference expressionmethodreference expression method reference node type constant indicating node type code super meth hod reference supermethhodreference code super method reference supermethodreference method reference node type constant indicating node type code type method reference typemethodreference code type method reference typemethodreference type method reference returns node node type param node type nodetype ast node type code ast node astnode code subclass exception illegal argument exception illegalargumentexception code node type nodetype code legal ast node type get node type getnodetype node class for type nodeclassfortype node type nodetype node type nodetype annotation type declaration annotation type declaration annotationtypedeclaration annotation type member declaration annotation type member declaration annotationtypememberdeclaration anonymous declaration anonymous class declaration anonymousclassdeclaration array access array access arrayaccess array creation array creation arraycreation array initializer array initializer arrayinitializer array type array type arraytype statement assert statement assertstatement assignment assignment block block block comment block comment blockcomment literal boolean literal booleanliteral statement break statement breakstatement expression cast expression castexpression clause catch clause catchclause character literal character literal characterliteral instance creation class instance creation classinstancecreation compilation unit compilation unit compilationunit conditional expression conditional expression conditionalexpression constructor invocation constructor invocation constructorinvocation statement continue statement continuestatement creation reference creation reference creationreference dimension dimension statement do statement dostatement empty statement empty statement emptystatement enhanced statement enhanced for statement enhancedforstatement enum constant declaration enum constant declaration enumconstantdeclaration enum declaration enum declaration enumdeclaration expression method reference expression method reference expressionmethodreference expression statement expression statement expressionstatement field access field access fieldaccess field declaration field declaration fielddeclaration statement for statement forstatement statement if statement ifstatement declaration import declaration importdeclaration infix expression infix expression infixexpression initializer initializer expression instanceof expression instanceofexpression intersection type int ersection type intersectiontype javadoc javadoc labeled statement labeled statement labeledstatement lambda expression lambda expression lambdaexpression comment line comment linecomment marker annotation marker annotation markerannotation member member ref memberref member pair member value pair membervaluepair method declaration method declaration methoddeclaration method invocation method invocation methodinvocation method method ref methodref method parameter method ref parameter methodrefparameter modifier modifier qualified type name qualified type namequalifiedtype normal annotation normal annotation normalannotation literal null literal nullliteral number literal number literal numberliteral declaration package declaration packagedeclaration parameterized type parameterized type parameterizedtype parenthesized expression parenthesized expression parenthesizedexpression postfix expression postfix expression postfixexpression prefix expression prefix expression prefixexpression primitive type primitive type primitivetype qualified qualified name qualifiedname qualified type qualified type qualifiedtype statement return statement returnstatement simple simple name simplename simple type simple type simpletype single member annotation single member annotation singlememberannotation single variable declaration single variable declaration singlevariabledeclaration string literal string literal stringliteral constructor invocation super constructor invocation superconstructorinvocation field access super field access superfieldaccess method invocation super method invocation supermethodinvocation method reference super method reference supermethodreference switch case switchcase statement switch statement switchstatement statement synchronized statement synchronizedstatement tag element tag element tagelement text element text element textelement expression this expression thisexpression statement throw statement throwstatement statement try statement trystatement type declaration type declaration typedeclaration type declaration statement type declaration statement typedeclarationstatement type method reference type method reference typemethodreference type literal type literal typeliteral type parameter type parameter typeparameter union type union type uniontype variable declaration expression variable declaration expression variabledeclarationexpression variable declaration fragment variable declaration fragment variabledeclarationfragment variable declaration statement variable declaration statement variabledeclarationstatement statement while statement whilestatement wildcard type wildcard type wildcardtype illegal argument exception illegalargumentexception owning ast field declared visible efficient access classes ast ast parent ast node code code node root init ially initially code code ast node astnode parent unmodifiable empty map implement code properties code map unmodifiable empty map collections unmodifiable map unmodifiablemap hash map hashmap primary field representing node properties efficiently code code node properties link string node sole property code property code link map table property mappings code property code unmodifiable equivalent init ially initially code code property object property auxiliary field representing node properties efficiently property object property character original source string code code source position node code code start position startposition character length code code source position recorded node code code length flag constant bit mask indicating ast node standard parser code ast parser astparser code sets flag node syntax error detected vicinity malformed flag constant bit mask indicating node created parser opposed created party standard parser code ast parser astparser code sets flag nodes creates original flag constant bit mask indicating node unmodifiable node marked unmodifiable operations result runtime exception change simple property node add remove child node node parent rep aren t reparent node standard parser code ast parser astparser code flag nodes creates clients flag node prevent modification structural properties protect flag constant bit mask indicating node node recovered source syntax error detected vicinity standard parser code ast parser astparser code sets flag node recovered node recovered node type top bits flags bottom bits field declared visible efficient access classes malformed type and flags typeandflags property parent node child code code node root init ially initially code code get location in parent getlocationinparent structural property descriptor structuralpropertydescriptor location internal convenience constant indicating definite risk cycles child property descriptor childpropertydescriptor cycle risk cyclerisk child list property descriptor childlistpropertydescriptor cycle risk cyclerisk cycle risk internal convenience constant indicating risk cycles child property descriptor childpropertydescriptor cycle risk cyclerisk child list property descriptor childlistpropertydescriptor cycle risk cyclerisk cycle risk internal convenience constant indicating structural property mandatory mandatory internal convenience constant indicating structural property optional optional special ized specialized implementation list ast nodes astnodes implementation based array list arraylist node list nodelist abstract list abstractlist underlying list nodes list stored element type link ast node astnode stingy storage assume list empty field declared visibility accesses code node list nodelist cursor code require synthetic accessor method array list arraylist store array list arraylist property descriptor list child list property descriptor childlistpropertydescriptor property descriptor propertydescriptor cursor iter ating iterating elements list lose position list changed iteration cursor iterator position cursor elements cursor sits element positions init ially initially element list position javadoc method declared code iterator code has next hasnext position node list nodelist store size javadoc method declared code iterator code object object result node list nodelist store position position result javadoc method declared code iterator code remove unsupported operation exception unsupportedoperationexception adjusts cursor accommodate add remove param position element removed param delta add remove update delta position cursor passed removed element position delta list active cursors element type link cursor code code active cursors storage consider ations considerations main tain maintain empty invariant node list nodelist instance was te waste lot space cursor needed duration visit child nodes normal circumstances single cursor needed multiple cursors required multiple visits time list cursors creates empty list nodes owned node node common parent nodes list param property property descriptor node list nodelist child list property descriptor childlistpropertydescriptor property property descriptor propertydescriptor property javadoc java util abstract collection abstractcollection size size store size javadoc abstract list abstractlist object store javadoc list java lang object object object element element illegal argument exception illegalargumentexception ast node astnode type and flags typeandflags protect node gain lose children nls illegal argument exception illegalargumentexception nls ast node modified delink child parent link child parent ast node astnode new child newchild ast node astnode element ast node astnode old child oldchild ast node astnode store old child oldchild new child newchild old child oldchild old child oldchild type and flags typeandflags protect child unparented nls illegal argument exception illegalargumentexception nls ast node modified ast node astnode check new child checknewchild ast node astnode new child newchild property descriptor propertydescriptor cycle risk cyclerisk property descriptor propertydescriptor element type elementtype ast node astnode ast pre replace child event prereplacechildevent ast node astnode old child oldchild new child newchild property descriptor propertydescriptor object result store new child newchild set parent setparent call ast modifying old child oldchild set parent setparent new child newchild set parent setparent ast node astnode property descriptor propertydescriptor ast node astnode ast post replace child event postreplacechildevent ast node astnode old child oldchild new child newchild property descriptor propertydescriptor result javadoc list add java lang object add object element element illegal argument exception illegalargumentexception ast node astnode type and flags typeandflags protect node gain lose children nls illegal argument exception illegalargumentexception nls ast node modified link child parent ast node astnode new child newchild ast node astnode element ast node astnode check new child checknewchild ast node astnode new child newchild property descriptor propertydescriptor cycle risk cyclerisk property descriptor propertydescriptor element type elementtype ast node astnode ast pre add child event preaddchildevent ast node astnode new child newchild property descriptor propertydescriptor store add element update cursors updatecursors set parent setparent call ast modifying new child newchild set parent setparent ast node astnode property descriptor propertydescriptor ast node astnode ast post add child event postaddchildevent ast node astnode new child newchild property descriptor propertydescriptor javadoc list remove object remove ast node astnode type and flags typeandflags protect node gain lose children nls illegal argument exception illegalargumentexception nls ast node modified delink child parent ast node astnode old child oldchild ast node astnode store old child oldchild type and flags typeandflags protect child unparented nls illegal argument exception illegalargumentexception nls ast node modified ast node astnode ast pre remove child event preremovechildevent ast node astnode old child oldchild property descriptor propertydescriptor set parent setparent call ast modifying old child oldchild set parent setparent object result store remove update cursors updatecursors ast node astnode ast post remove child event postremovechildevent ast node astnode old child oldchild property descriptor propertydescriptor result all ocate allocate cursor visit client call code release cursor releasecursor code method int ernally internally node list nodelist thread safe create cursor cursor pos itioned positioned element list cursor new cursor newcursor serialize cursor management node list nodelist cursors convert empty list cursors array list arraylist cursor result cursor cursors add result result releases cursor visit method int ernally internally node list nodelist thread safe release cursor param cursor cursor release cursor releasecursor cursor cursor serialize cursor management node list nodelist cursors remove cursor cursors is empty isempty convert empty list node hang need less needless junk cursors adjusts cursors accommodate add remove method list modified ast thread safe clients modifying param position element removed param delta add remove update cursors updatecursors delta cursors cursors worry iterator cursors iterator has next hasnext cursor cursor update delta returns estimate memory foo tprint footprint node list instance bytes object header node list nodelist instance fields node list nodelist instance cursors walk progress object header array list arraylist instance fields array list arraylist instance object header object instance bytes array element size node list bytes mem size memsize result headers result headers result headers size result returns estimate memory foo tprint footprint bytes node list subtrees size list subtrees bytes list size listsize result mem size memsize iterator iterator has next hasnext ast node astnode child ast node astnode result child tree size treesize result creates ast node owned ast established relationship ast node owning ast change lifetime node node parent node properties constructor subclasses declared clients unable declare additional subclasses param ast ast node ast node astnode ast ast ast illegal argument exception illegalargumentexception ast ast set node type setnodetype get node type getnodetype set flags setflags ast get default node flag getdefaultnodeflag set flags setflags calls modifying returns node ast note relationship ast node ast change lifetime node ast owns node ast getast ast returns node parent node code code root node note relationship ast node parent node change lifetime node parent node code code ast node astnode get parent getparent parent returns location node parent code code root node pre ast node astnode node ast node astnode parent node get parent getparent structural property descriptor structuralpropertydescriptor location node get location in parent getlocationinparent parent location location location is child property ischildproperty parent get structural property getstructuralproperty location node location location is child list property ischildlistproperty list parent get structural property getstructuralproperty location node pre note relationship ast node parent node change lifetime node location node parent code code node parent structural property descriptor structuralpropertydescriptor get location in parent getlocationinparent location returns root node node returns node root root node node ast node astnode get root getroot ast node astnode candidate ast node astnode candidate get parent getparent candidate parent guy candidate candidate returns structural property node returned depends kind property link simple property descriptor simplepropertydescriptor simple property code code primitive values boxed link child property descriptor childpropertydescriptor child node type code ast node astnode code code code link child list property descriptor childlistpropertydescriptor list element type link ast node astnode param property property code code exception runtime exception runtimeexception node property object get structural property getstructuralproperty structural property descriptor structuralpropertydescriptor property property simple property descriptor simplepropertydescriptor simple property descriptor simplepropertydescriptor simple property descriptor simplepropertydescriptor property get value type getvaluetype result internal get set int property internalgetsetintproperty integer value of valueof result get value type getvaluetype result internal get set boolean property internalgetsetbooleanproperty value of valueof result internal get set object property internalgetsetobjectproperty property child property descriptor childpropertydescriptor internal get set child property internalgetsetchildproperty child property descriptor childpropertydescriptor property property child list property descriptor childlistpropertydescriptor internal get child list property internalgetchildlistproperty child list property descriptor childlistpropertydescriptor property illegal argument exception illegalargumentexception sets structural property node passed depends kind property link simple property descriptor simplepropertydescriptor simple property code code primitive values boxed link child property descriptor childpropertydescriptor child node type code ast node astnode code code code link child list property descriptor childlistpropertydescriptor allowed param property property param property exception runtime exception runtimeexception node property property set structural property setstructuralproperty structural property descriptor structuralpropertydescriptor property object property simple property descriptor simplepropertydescriptor simple property descriptor simplepropertydescriptor simple property descriptor simplepropertydescriptor property get value type getvaluetype arg integer int value intvalue internal get set int property internalgetsetintproperty arg get value type getvaluetype arg boolean value booleanvalue internal get set boolean property internalgetsetbooleanproperty arg is mandatory ismandatory illegal argument exception illegalargumentexception internal get set object property internalgetsetobjectproperty property child property descriptor childpropertydescriptor child property descriptor childpropertydescriptor child property descriptor childpropertydescriptor property ast node astnode child ast node astnode child is mandatory ismandatory illegal argument exception illegalargumentexception internal get set child property internalgetsetchildproperty child property child list property descriptor childlistpropertydescriptor nls illegal argument exception illegalargumentexception list child list property sets value d valued property node implementation method exception explaining node property method extended subclasses simple property type param property property param code code operation code code operation param property operations returns code code operations exception runtime exception runtimeexception node property internal get set int property internalgetsetintproperty simple property descriptor simplepropertydescriptor property nls runtime exception runtimeexception node property sets value d valued property node implementation method exception explaining node property method extended subclasses simple property type param property property param code code operation code code operation param property operations returns code code operations exception runtime exception runtimeexception node property internal get set boolean property internalgetsetbooleanproperty simple property descriptor simplepropertydescriptor property nls runtime exception runtimeexception node property sets property node implementation method exception explaining node property method extended subclasses simple property type reference type param property property param code code operation code code operation param property code code operations code code returns code code operations exception runtime exception runtimeexception node property object internal get set object property internalgetsetobjectproperty simple property descriptor simplepropertydescriptor property object nls runtime exception runtimeexception node property sets child property node implementation method exception explaining node property method extended subclasses child property param property property param code code operation code code operation param child child code code code code operations child code code returns code code operations exception runtime exception runtimeexception node property child ast node astnode internal get set child property internalgetsetchildproperty child property descriptor childpropertydescriptor property ast node astnode child nls runtime exception runtimeexception node property returns list property node implementation method exception explaining node property method extended subclasses child list property param property property list element type link ast node astnode exception runtime exception runtimeexception node property list internal get child list property internalgetchildlistproperty child list property descriptor childlistpropertydescriptor property nls runtime exception runtimeexception node property returns list structural property descriptors nodes type node clients modify result note property descriptors meta level mechanism manipulating ast nodes astnodes unrelated code set property setproperty code list property descriptors element type link structural property descriptor structuralpropertydescriptor list structural properties for type structuralpropertiesfortype internal structural properties for type internalstructuralpropertiesfortype ast api level apilevel returns list property descriptors node type clients modify result method implemented concrete ast node type method implementations method concrete ast node types clutter api doc param api level apilevel api level code ast jls code constants list property descriptors element type link structural property descriptor structuralpropertydescriptor list internal structural properties for type internalstructuralpropertiesfortype api level apilevel internal helper method starts building list property descriptors node type param node class nodeclass concrete node type properties param property list propertylist empty list capacity elements create property list createpropertylist node class nodeclass list property list propertylist stuff node class nodeclass head list property list propertylist add node class nodeclass internal helper method adding property descriptor param property structural property descriptor param property list propertylist list ast node accumulated structural property descriptors add property addproperty structural property descriptor structuralpropertydescriptor property list property list propertylist node class nodeclass property list propertylist property get node class getnodeclass node class nodeclass nls runtime exception runtimeexception structural property descriptor wrong node property list propertylist add property internal helper method comp letes completes building node type structural property descriptor list param property list propertylist list ast node accumulated structural property descriptors unmodifiable list structural property descriptors element type link structural property descriptor structuralpropertydescriptor list reap property list reappropertylist list property list propertylist remove node class nodeclass property list propertylist remove compact array list arraylist array list arraylist property list propertylist size add all addall property list propertylist collections unmodifiable list unmodifiablelist checks ast operation building jls level ast s asts method prevent access properties jls exception unsupported operation exception unsupportedoperationexception operation jls ast unsupported in unsupportedin ast api level apilevel ast jls internal nls unsupported operation exception unsupportedoperationexception operation supported jls ast checks ast operation building jls jls level ast s asts method prevent access properties jls exception unsupported operation exception unsupportedoperationexception operation jls jls ast unsupported in unsupportedin ast api level apilevel ast jls internal nls unsupported operation exception unsupportedoperationexception operation supported jls ast checks ast operation building jls jls jls level ast s asts method prevent access properties jls exception unsupported operation exception unsupportedoperationexception operation jls unsupported in unsupportedin ast api level apilevel ast jls nls unsupported operation exception unsupportedoperationexception operation supported jls ast checks ast operation building jls level ast s asts method prevent access deprecated properties deprecated jls exception unsupported operation exception unsupportedoperationexception operation ast jls api java docs javadocs add deprecated jls api method replaced link replacement supported only in supportedonlyin ast api level apilevel ast jls internal nls unsupported operation exception unsupportedoperationexception operation supported jls ast checks ast operation building jls jls jls level ast s asts method prevent access deprecated properties deprecated jls exception unsupported operation exception unsupportedoperationexception operation ast jls api java docs javadocs add deprecated jls api method replaced link replacement supported only in supportedonlyin ast api level apilevel ast jls nls unsupported operation exception unsupportedoperationexception operation supported jls jls jls ast s asts sets clears node parent node location note method pointer node parent impl icitly implicitly side inserting removing node child node method calls code ast modifying code param parent parent node code code param property location node parent code code code parent code code code get location in parent getlocationinparent get parent getparent set parent setparent ast node astnode parent structural property descriptor structuralpropertydescriptor property ast modifying parent parent location property removes node parent node unparented node appears element child list property parent node removed list code list remove code node appears child property parent node detached parent passing code code set ter setter method operation fails node mandatory property delete structural property descriptor structuralpropertydescriptor get location in parent getlocationinparent node unparented is child property ischildproperty get parent getparent set structural property setstructuralproperty location is child list property ischildlistproperty list list get parent getparent get structural property getstructuralproperty location remove checks child node node ast parent parent adding parent create cycle child type parent enclosing instance param node parent node param new child newchild child parent param cycle check cyclecheck code code cycles checked code code cycles impossible checked param node type nodetype type constraint child nodes code code special check required exception illegal argument exception illegalargumentexception child node belongs ast child incorrect node type node parent cycle created check new child checknewchild ast node astnode node ast node astnode new child newchild cycle check cyclecheck node type nodetype new child newchild ast node ast child ast illegal argument exception illegalargumentexception new child newchild get parent getparent child parent illegal argument exception illegalargumentexception cycle check cyclecheck new child newchild node get root getroot inserting child create cycle illegal argument exception illegalargumentexception child class childclass new child newchild get class getclass node type nodetype node type nodetype is assignable from isassignablefrom child class childclass child type class cast exception classcastexception new child newchild type and flags typeandflags protect nls illegal argument exception illegalargumentexception ast node modified prelude portion step program replacing child node node code pattern ast node subclasses pre ast node astnode old child oldchild foo pre replace child prereplacechild old child oldchild new foo newfoo foo property foo new foo newfoo post replace child postreplacechild old child oldchild new foo newfoo foo property pre pre replace child prereplacechild precondition checks reports pre delete events parent links child del inked delinked parent making root node child node linked parent child node root node ast parent ancestor node nodes modifiable replace operation fail atomically crucial precondition checks linking del inking delinking post replace child postreplacechild reports post add events method calls code ast modifying code nodes param old child oldchild child node code code child replace param new child newchild child node code code replacement child param property property descriptor node describing relationship node child exception runtime exception runtimeexception node belongs ast node parent cycle created nodes involved unmodifiable pre replace child prereplacechild ast node astnode old child oldchild ast node astnode new child newchild child property descriptor childpropertydescriptor property type and flags typeandflags protect nls illegal argument exception illegalargumentexception ast node modified new child newchild check new child checknewchild new child newchild property cycle risk cyclerisk delink child parent old child oldchild old child oldchild type and flags typeandflags protect child node unparented nls illegal argument exception illegalargumentexception nls ast node modified new child newchild ast pre replace child event prereplacechildevent old child oldchild new child newchild property ast pre remove child event preremovechildevent old child oldchild property old child oldchild set parent setparent new child newchild ast pre add child event preaddchildevent new child newchild property link child parent new child newchild new child newchild set parent setparent property notify post add child event postaddchildevent parent linked child post lude postlude portion step program replacing child node node link pre replace child prereplacechild ast node astnode ast node astnode child property descriptor childpropertydescriptor details post replace child postreplacechild ast node astnode old child oldchild ast node astnode new child newchild child property descriptor childpropertydescriptor property link child parent new child newchild old child oldchild ast post replace child event postreplacechildevent old child oldchild new child newchild property ast post add child event postaddchildevent new child newchild property ast post remove child event postremovechildevent old child oldchild property prelude portion step program changing simple property node code pattern ast node subclasses pre pre value change prevaluechange foo property foo new foo newfoo post value change postvaluechange foo property pre pre value change prevaluechange precondition check node modifiable change operation fail atomically crucial precondition checks field hammered post value change postvaluechange reports post change events method calls code ast modifying code node param property property descriptor node exception runtime exception runtimeexception node unmodifiable pre value change prevaluechange simple property descriptor simplepropertydescriptor property type and flags typeandflags protect nls illegal argument exception illegalargumentexception ast node modified ast pre value change event prevaluechangeevent property ast modifying post lude postlude portion step program replacing child node node link pre value change prevaluechange simple property descriptor simplepropertydescriptor details post value change postvaluechange simple property descriptor simplepropertydescriptor property ast post value change event postvaluechangeevent property ensures node modifiable marked successful calls ast modifying exception runtime exception runtimeexception modifiable check modifiable checkmodifiable type and flags typeandflags protect nls illegal argument exception illegalargumentexception ast node modified ast modifying lazy initialization node code pattern ast node subclasses pre foo lazy init thread safe read ers readers foo pre lazy init prelazyinit foo code create node post lazy init postlazyinit foo foo property pre pre lazy init prelazyinit method called read ers readers ast node astnode locked point ast disable events disableevents turn events post lasy init postlasyinit lazy initialization node param new child newchild child node code code replacement child param property property descriptor node describing relationship node child post lazy init postlazyinit ast node astnode new child newchild child property descriptor childpropertydescriptor property method called read ers readers ast node astnode locked point new child newchild brand chance concurrent access new child newchild set parent setparent property turn events turned pre lazy init prelazyinit ast reenable events reenableevents returns named property node code code param property name propertyname property property code code set property setproperty string object object get property getproperty string property name propertyname property name propertyname illegal argument exception illegalargumentexception property node properties property string node single property property name propertyname equals property property node table properties map map property property name propertyname sets named property node code code clear clients employ property names unique avoid inadvertent conflicts clients setting properties node note modifying property considered modification ast clients decorate existing nodes properties jeopardizing val idity validity bindings rely underlying tree remaining param property name propertyname property param data property code code get property getproperty string illegal argument exception illegalargumentexception property code code set property setproperty string property name propertyname object data property name propertyname illegal argument exception illegalargumentexception property node properties data node fis t fist property property property name propertyname property data property string node single property property name propertyname equals property luck data deleted property property property property data data node property convert flexible representation map hash map hashmap property property property name propertyname data property property node properties map map property data remove property name propertyname check property left size convert efficient representation map entry entries map entry entry set entryset to array toarray map entry property entries get key getkey property entries get value getvalue property name propertyname data properties returns unmodifiable table properties node code code values table property values keyed property key type code string code type code object code map properties property node properties unmodifiable empty map property string node single property collections singleton map singletonmap property property node properties property property collections unmodifiable map unmodifiablemap map property property unmodifiable wrapper map property map property returns flags node flags newly created nodes flags bitwise individual flags flags defined link malformed node syntactically malformed link original original node created ast parser astparser link protect node modification link recovered node node recovered source syntax error bit positions reserved bitwise individual flags set flags setflags get flags getflags type and flags typeandflags xffff sets flags node flags bitwise individual flags flags defined link malformed node syntactically malformed link original original node created ast parser astparser link protect node modification link recovered node node recovered source syntax error bit positions reserved note flags considered structural property node changed node marked param flags bitwise individual flags get flags getflags set flags setflags flags ast modifying type and flags typeandflags xffff type and flags typeandflags flags xffff returns int eger integer identifying type concrete ast node values small positive int egers integers suitable statements concrete node type unique node type constant unique node type constant concrete node type code cast expression castexpression code code ast node astnode expression code node type constants get node type getnodetype type and flags typeandflags sets int eger integer identifying type concrete ast node values small positive int egers integers suitable statements param node type nodetype node type constants set node type setnodetype node type nodetype type and flags typeandflags xffff type and flags typeandflags node type nodetype returns int eger integer identifying type concrete ast node internal method implemented concrete node subclasses node type constants get node type getnodetype code ast node astnode code implementation code object code method object identity code subtree match subtreematch code compare subtrees equality param obj inherit doc inheritdoc inherit doc inheritdoc subtree match subtreematch ast matcher astmatcher matcher object equals object obj equivalent object equals obj javadoc consistent fact equals methods java lang object hash code hashcode hash code hashcode hash code hashcode returns subtree rooted node matches object decided matcher param matcher matcher param object code code code code subtree matches code code match subtree match subtreematch ast matcher astmatcher matcher object subtree match subtreematch matcher returns subtree rooted node matches object decided matcher internal method implemented concrete node subclasses param matcher matcher param object code code code code subtree matches code code match subtree match subtreematch ast matcher astmatcher matcher object returns deep copy subtree ast nodes rooted node nodes owned ast ast s asts node node parent result node unparented source range original nodes automatically copied nodes client properties code properties code carried node code ast code target code ast code support api level param target ast nodes result param node node copy code code copied node code code code node code code code ast node astnode copy subtree copysubtree ast target ast node astnode node node target illegal argument exception illegalargumentexception target api level apilevel node getast api level apilevel unsupported operation exception unsupportedoperationexception ast node astnode new node newnode node clone target new node newnode returns deep copy subtrees ast nodes rooted list nodes nodes owned ast ast s asts nodes list nodes list parents nodes result unparented source range original nodes automatically copied nodes client properties code properties code carried param target ast nodes result param nodes list nodes copy element type link ast node astnode list copied subtrees element type link ast node astnode list copy sub trees copysubtrees ast target list nodes list result array list arraylist nodes size iterator nodes iterator has next hasnext ast node astnode old node oldnode ast node astnode ast node astnode new node newnode old node oldnode clone target result add new node newnode result returns deep copy subtree ast nodes rooted node nodes owned ast ast node node parent result node unparented method reports pre post clone events dispatches code clone ast code reimplemented node subclasses param target ast nodes result root node copies subtree ast node astnode clone ast target ast pre clone node event preclonenodeevent ast node astnode clone target ast post clone node event postclonenodeevent returns deep copy subtree ast nodes rooted node nodes owned ast ast node node parent result node unparented method implemented subclasses general template implementation concrete ast node astnode pre code concrete node type concretenodetype result concrete node type concretenodetype target result set source range setsourcerange get start position getstartposition get length getlength result set child property setchildproperty child property type childpropertytype ast node astnode copy subtree copysubtree target get child property getchildproperty result set simple property setsimpleproperty is simple property issimpleproperty result children property childrenproperty add all addall ast node astnode copy sub trees copysubtrees target children property childrenproperty result code pre method report pre post clone events call ers callers call code clone ast code ensure pre post clone events reported method implementations method concrete ast node types clutter api doc param target ast nodes result root node copies subtree ast node astnode clone ast target acc epts accepts visitor visit current node param visitor visitor object exception illegal argument exception illegalargumentexception visitor accept ast visitor astvisitor visitor visitor illegal argument exception illegalargumentexception pre visit visitor pre visit previsit dynamic dispatch internal method type specific visit end visit endvisit accept visitor post visit visitor post visit postvisit acc epts accepts visitor type specific visit current node method implemented concrete ast node types general template implementation concrete ast node astnode pre code visit children visitchildren visitor visit visit children visitchildren visit children normal left reading order accept child acceptchild visitor get property getproperty accept children acceptchildren visitor raw list property rawlistproperty accept child acceptchild visitor get property getproperty visitor end visit endvisit code pre note caller code accept code cares invoking code visitor pre visit previsit code code visitor post visit postvisit code param visitor visitor object accept ast visitor astvisitor visitor acc epts accepts visitor visit current node method concrete implementations code accept code traverse optional properties equivalent code child accept visitor code code child code code code param visitor visitor object param child child ast node dispatch code code accept child acceptchild ast visitor astvisitor visitor ast node astnode child child child accept visitor acc epts accepts visitor visit live list child nodes method concrete implementations code accept code traverse list values properties encapsulates proper handling fly list param visitor visitor object param children child ast node dispatch code code accept children acceptchildren ast visitor astvisitor visitor ast node astnode node list nodelist children cursor track list changing foo t foot node list nodelist cursor cursor children new cursor newcursor cursor has next hasnext ast node astnode child ast node astnode cursor child accept visitor children release cursor releasecursor cursor returns character original source file indicating source fragment node parser supplies defined source ranges nodes creates link ast parser astparser set kind setkind details precisely source ranges based character code code source position recorded node get length getlength ast parser astparser get start position getstartposition start position startposition returns length characters original source file indicating source fragment node ends parser supplies defined source ranges nodes creates link ast parser astparser set kind setkind methods details precisely source ranges length code code source position recorded node get start position getstartposition ast parser astparser get length getlength length sets source range original source file source fragment node link ast parser astparser set kind setkind details precisely source ranges supposed param start position startposition based character code code source position node param length length code code source position recorded node get start position getstartposition get length getlength ast parser astparser set source range setsourcerange start position startposition length start position startposition length illegal argument exception illegalargumentexception start position startposition length illegal argument exception illegalargumentexception source positions considered structural property protect check modifiable checkmodifiable start position startposition start position startposition length length returns string representation node suitable debug ging debugging purposes debug string string to string tostring string buffer stringbuffer buffer string buffer stringbuffer buffer length append debug string appenddebugstring buffer runtime exception runtimeexception buffer set length setlength buffer append buffer append standard to string standardtostring buffer to string tostring returns string representation node produced standard code object to string tostring code method debug string string standard to string standardtostring to string tostring appends debug representation node string buffer code ast node astnode code implementation method prints entire subtree subclasses override provide succinct representation param buffer string buffer append append debug string appenddebugstring string buffer stringbuffer buffer print subtree append print string appendprintstring buffer appends standard java source code representation subtree string buffer param buffer string buffer append append print string appendprintstring string buffer stringbuffer buffer naiveastflattener printer naiveastflattener accept printer buffer append printer get result getresult estimate size object header bytes headers app roximate approximate base size ast node instance bytes including object header instance fields headers instance vars ast node astnode base node size headers returns estimate memory foo tprint footprint bytes string param string string measure code code size string object bytes string code code string size stringsize string string size string strings instance fields size headers bytes character size headers string length size returns estimate memory foo tprint footprint bytes entire subtree rooted node size subtree bytes subtree bytes subtreebytes tree size treesize returns estimate memory foo tprint footprint bytes entire subtree rooted node method implementations method concrete ast node types clutter api doc size subtree bytes tree size treesize returns estimate memory foo tprint footprint node bytes estimate include space occupied child nodes size node bytes mem size memsize
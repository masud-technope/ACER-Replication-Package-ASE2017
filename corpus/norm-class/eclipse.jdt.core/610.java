copyright bea systems rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors sbandow bea initial api implementation ibm corporation test https bugs eclipse org bugs bug cgi org eclipse jdt apt tests java util collection java util map junit framework test junit framework test suite testsuite org eclipse core resources i project iproject org eclipse core runtime i path ipath org eclipse jdt apt core env environment factory environmentfactory org eclipse jdt apt tests annotations processor test status processorteststatus org eclipse jdt apt tests annotations abstract generic processor abstractgenericprocessor org eclipse jdt apt tests annotations generic factory genericfactory org eclipse jdt apt tests annotations mirror test mirrortest mirror declaration code example mirrordeclarationcodeexample org eclipse jdt apt tests annotations mirror test mirrortest source mirror code example sourcemirrorcodeexample org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java project ijavaproject org eclipse jdt core java core javacore org eclipse jdt core java model exception javamodelexception sun mirror apt annotation processor environment annotationprocessorenvironment sun mirror declaration annotation mirror annotationmirror sun mirror declaration annotation type declaration annotationtypedeclaration sun mirror declaration annotation type element declaration annotationtypeelementdeclaration sun mirror declaration annotation value annotationvalue sun mirror declaration declaration sun mirror declaration type declaration typedeclaration sun mirror util source position sourceposition mirror declaration tests mirrordeclarationtests apt test base apttestbase mirror declaration tests mirrordeclarationtests string test suite test suite testsuite mirror declaration tests mirrordeclarationtests set up setup exception set up setup i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string code mirror declaration code example mirrordeclarationcodeexample code env add class addclass src root srcroot mirror declaration code example mirrordeclarationcodeexample code mirror declaration code example mirrordeclarationcodeexample code code full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems test mirror declaration testmirrordeclaration exception assert equals assertequals processor test status processorteststatus errors processor test status processorteststatus get errors geterrors test field constant testfieldconstant exception i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string code trigger codetrigger test trigger env add class addclass src root srcroot test trigger code trigger codetrigger string code entry point codeentrypoint test trigger entry point entrypoint class with nested annotation classwithnestedannotation nested anno nestedanno env add class addclass src root srcroot test entry point entrypoint code entry point codeentrypoint string code class with nested annotation codeclasswithnestedannotation test class with nested annotation classwithnestedannotation env add class addclass src root srcroot test class with nested annotation classwithnestedannotation code class with nested annotation codeclasswithnestedannotation full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems todo disabled bug zilla bugzilla the odora theodora https bugs eclipse org bugs bug cgi disabled test default testdefault exception i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string code trigger codetrigger test trigger env add class addclass src root srcroot test trigger code trigger codetrigger string code entry point codeentrypoint test trigger entry point entrypoint class with nested annotation classwithnestedannotation nested anno nestedanno env add class addclass src root srcroot test entry point entrypoint code entry point codeentrypoint string code class with nested annotation codeclasswithnestedannotation test class with nested annotation classwithnestedannotation nested annotation nestedannotation enum character win nie winnie tiger piglet eore character character eore env add class addclass src root srcroot test class with nested annotation classwithnestedannotation code class with nested annotation codeclasswithnestedannotation full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems test ast based mirror implementation binding based mirror implementation method declaration unresolvable type constructor declaration unresolvable parameter iii field declaration unresolvable type test focus declarations file context exception test unresolvable declarations testunresolvabledeclarations exception i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string decl anno declanno test declaration anno declarationanno env add class addclass src root srcroot test declaration anno declarationanno decl anno declanno string code foo codefoo test declaration anno declarationanno foo field unknown type unknowntype field foo unknown type unknowntype type void method voidmethod unknown type unknowntype get type gettype i path ipath foo path foopath env add class addclass src root srcroot test foo code foo codefoo full build fullbuild project get full path getfullpath expecting only specific problems for expectingonlyspecificproblemsfor foo path foopath expected problem expectedproblem expected problem expectedproblem unknown type unknowntype resolved type foo path foopath expected problem expectedproblem unknown type unknowntype resolved type foo path foopath expected problem expectedproblem unknown type unknowntype resolved type foo path foopath test ast based mirror implementation binding based mirror implementation method declaration unresolvable type constructor declaration unresolvable parameter iii field declaration unresolvable type test focus declarations file processor environment context exception test unresolvable declarations testunresolvabledeclarations exception i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string decl anno declanno test declaration anno declarationanno env add class addclass src root srcroot test declaration anno declarationanno decl anno declanno string code bar codebar test declaration anno declarationanno bar env add class addclass src root srcroot test bar code bar codebar string code foo codefoo test declaration anno declarationanno foo field unknown type unknowntype field foo unknown type unknowntype type void method voidmethod unknown type unknowntype get type gettype i path ipath foo path foopath env add class addclass src root srcroot test foo code foo codefoo full build fullbuild project get full path getfullpath expecting only specific problems for expectingonlyspecificproblemsfor foo path foopath expected problem expectedproblem expected problem expectedproblem unknown type unknowntype resolved type foo path foopath expected problem expectedproblem unknown type unknowntype resolved type foo path foopath expected problem expectedproblem unknown type unknowntype resolved type foo path foopath test location testlocation test location proc testlocationproc test location proc testlocationproc generic factory genericfactory set processor setprocessor i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string test org eclipse jdt apt tests annotations generic annotation genericannotation env add class addclass src root srcroot test full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems assert true asserttrue processor invoked called test source mirror testsourcemirror test source mirror proc testsourcemirrorproc test source mirror proc testsourcemirrorproc generic factory genericfactory set processor setprocessor i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath env add class addclass src root srcroot source mirror code example sourcemirrorcodeexample code source mirror code example sourcemirrorcodeexample anno code source mirror code example sourcemirrorcodeexample anno code env add class addclass src root srcroot source mirror code example sourcemirrorcodeexample code source mirror code example sourcemirrorcodeexample code source mirror code example sourcemirrorcodeexample code full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems assert true asserttrue processor invoked called test package info testpackageinfo package info proc packageinfoproc package info proc packageinfoproc generic factory genericfactory set processor setprocessor i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath i path ipath pkg env add package addpackage src root srcroot pkg string contents pkg annotation pkgannotation generic annotation genericannotation pkg org eclipse jdt apt tests annotations env add file addfile pkg info java contents string ann contents anncontents pkg pkg annotation pkgannotation string def env add class addclass src root srcroot pkg pkg annotation pkgannotation ann contents anncontents full build fullbuild project get full path getfullpath expecting no problems expectingnoproblems assert true asserttrue processor invoked called test location proc testlocationproc abstract generic processor abstractgenericprocessor called process called assert true asserttrue decls size declaration decls iterator source position sourceposition get position getposition assert true asserttrue column assert true asserttrue test source mirror proc testsourcemirrorproc abstract generic processor abstractgenericprocessor called process called type declaration typedeclaration td code tdcode env get type declaration gettypedeclaration source mirror code example sourcemirrorcodeexample code source mirror code example sourcemirrorcodeexample code annotation mirror annotationmirror td code tdcode get annotation mirrors getannotationmirrors generic annotation genericannotation equals get annotation type getannotationtype get declaration getdeclaration get simple name getsimplename assert true asserttrue get position getposition annotation type declaration annotationtypedeclaration atd get annotation type getannotationtype get declaration getdeclaration assert true asserttrue atd get position getposition map entry annotation type element declaration annotationtypeelementdeclaration annotation value annotationvalue entry get element values getelementvalues entry set entryset assert not null assertnotnull entry get key getkey get position getposition assert not null assertnotnull entry get key getkey get default value getdefaultvalue get position getposition package info proc packageinfoproc abstract generic processor abstractgenericprocessor called process called annotation type declaration annotationtypedeclaration anno decl annodecl annotation type declaration annotationtypedeclaration env get type declaration gettypedeclaration pkg pkg annotation pkgannotation assert true asserttrue anno decl annodecl annotated declarations collection declaration annotated decls annotateddecls env get declarations annotated with getdeclarationsannotatedwith anno decl annodecl don declaration apt assert true asserttrue annotated decls annotateddecls annotated decls annotateddecls size todo test support annotation package declaration packagedeclaration pd code pdcode env get package getpackage pkg annotation mirror annotationmirror pd code pdcode get annotation mirrors getannotationmirrors generic annotation genericannotation equals get annotation type getannotationtype get declaration getdeclaration get simple name getsimplename assert true asserttrue get position getposition annotation type declaration annotationtypedeclaration atd get annotation type getannotationtype get declaration getdeclaration assert true asserttrue atd get position getposition map entry annotation type element declaration annotationtypeelementdeclaration annotation value annotationvalue entry get element values getelementvalues entry set entryset assert not null assertnotnull entry get key getkey get position getposition assert not null assertnotnull entry get key getkey get default value getdefaultvalue get position getposition test env factory testenvfactory java model exception javamodelexception i project iproject project env get project getproject get project name getprojectname i path ipath src root srcroot get source path getsourcepath string test org eclipse jdt apt tests annotations generic annotation genericannotation i path ipath path env add class addclass src root srcroot test i path ipath tail path remove first segments removefirstsegments i java project ijavaproject java core javacore create project i compilation unit icompilationunit i compilation unit icompilationunit find element findelement tail assert true asserttrue find annotation processor environment annotationprocessorenvironment env environment factory environmentfactory get environment getenvironment type declaration typedeclaration env get type declaration gettypedeclaration test source position sourceposition pos get position getposition assert true asserttrue pos column assert true asserttrue pos bad type gracefully type declaration typedeclaration t bad tbad env get type declaration gettypedeclaration test xyz assert true asserttrue t bad tbad
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation stephan herrmann contributions bug compiler annotations checking bug edit orial editorial cleanup bug bug bug compiler resource avoid remaining pos itives positives compiling eclipse sdk bug compiler distinguish warnings based flow analysis annotations bug non null nonnull fails loop bound aries boundaries bug compiler resource incorrect potential resource leak bug compiler fup bug consolidate int eraction interaction unboxing npe deferred checking bug compiler loop improve analysis loops bug nonnull argument correctly inferred loop jesper moller contributions bug compiler analysis effectively variables fails loops org eclipse jdt internal compiler flow org eclipse jdt internal compiler ast ast node astnode org eclipse jdt internal compiler ast expression org eclipse jdt internal compiler ast reference org eclipse jdt internal compiler lookup block scope blockscope org eclipse jdt internal compiler lookup field binding fieldbinding org eclipse jdt internal compiler lookup local variable binding localvariablebinding org eclipse jdt internal compiler lookup scope org eclipse jdt internal compiler lookup tag bits tagbits org eclipse jdt internal compiler lookup type binding typebinding org eclipse jdt internal compiler lookup type ids typeids org eclipse jdt internal compiler lookup variable binding variablebinding ref lects reflects context code analysis keeping track enclosing statements exception handlers finally flow context finallyflowcontext try flow context tryflowcontext reference final assignments finalassignments variable binding variablebinding final variables finalvariables assign count assigncount arrays sync indices slots check type checktype unboxing local variable binding localvariablebinding null locals nulllocals expressions checking statements resource analysis ast node astnode null references nullreferences expression safe null check type nullchecktype exit resource null check types nullchecktypes null count nullcount field flow context flowcontext expected types expectedtypes reference flow context statement flow context flowcontext try context trycontext finally flow context finallyflowcontext flow context flowcontext parent ast node astnode associated node associatednode exception handling flow context exceptionhandlingflowcontext try context trycontext parent associated node associatednode try context trycontext try context trycontext context ual contextual initialization info derived block block code check sub routine subroutine context initialize variable redundantly complain on deferred checks complainondeferredchecks flow info flowinfo flow info flowinfo block scope blockscope scope check redundant assignments assign count assigncount variable binding variablebinding variable final variables finalvariables variable remember complained assignment complained variable field binding fieldbinding field flow info flowinfo is potentially assigned ispotentiallyassigned field binding fieldbinding variable complained scope problem reporter problemreporter duplicate initialization of blank final field duplicateinitializationofblankfinalfield field binding fieldbinding variable final assignments finalassignments local variable flow info flowinfo is potentially assigned ispotentiallyassigned local variable binding localvariablebinding variable variable tag bits tagbits tag bits tagbits is effectively final iseffectivelyfinal variable is final isfinal complained scope problem reporter problemreporter duplicate initialization of final local duplicateinitializationoffinallocal local variable binding localvariablebinding variable final assignments finalassignments reported complained flow context flowcontext current context currentcontext get local parent getlocalparent current context currentcontext current context currentcontext is sub routine issubroutine current context currentcontext remove final assignment if any removefinalassignmentifany final assignments finalassignments current context currentcontext current context currentcontext get local parent getlocalparent check inconsistent checks enclosing loop conservative tag bits tagbits flow context flowcontext defer diagnostic null count nullcount ast node astnode location null references nullreferences null check types nullchecktypes hide comparison warning mask assign non null nonnull null status nullstatus flow info flowinfo null status nullstatus null locals nulllocals null status nullstatus flow info flowinfo parent record nullity mismatch recordnullitymismatch scope expression location provided expected types providedexpectedtypes provided expected types providedexpectedtypes flow info flowinfo null status nullstatus unboxing check unboxing checkunboxing scope expression location flow info flowinfo parent record using null reference recordusingnullreference scope null locals nulllocals null references nullreferences null check types nullchecktypes flow info flowinfo enclosing loop precise null count nullcount ast node astnode location null references nullreferences local variable local variable binding localvariablebinding local null locals nulllocals null check types nullchecktypes hide comparison warning mask comparison comparison flow info flowinfo is definitely non null isdefinitelynonnull local null check types nullchecktypes hide comparison warning mask comparison null check types nullchecktypes hide comparison warning scope problem reporter problemreporter local variable redundant check on non null localvariableredundantcheckonnonnull local location scope problem reporter problemreporter local variable non null compared to null localvariablenonnullcomparedtonull local location fall comparison comparison assignment expression expression expression location flow info flowinfo is definitely null isdefinitelynull local null check types nullchecktypes context mask flow context flowcontext comparison check auto unboxing report warning null check types nullchecktypes check mask hide comparison warning mask expression implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local expression null check types nullchecktypes hide comparison warning scope problem reporter problemreporter local variable redundant check on null localvariableredundantcheckonnull local expression flow context flowcontext comparison check auto unboxing report warning null check types nullchecktypes check mask hide comparison warning mask expression implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local expression scope problem reporter problemreporter local variable null compared to non null localvariablenullcomparedtononnull local expression flow context flowcontext assignment scope problem reporter problemreporter local variable redundant null assignment localvariableredundantnullassignment local expression flow context flowcontext scope problem reporter problemreporter local variable null instanceof localvariablenullinstanceof local expression flow info flowinfo is potentially null ispotentiallynull local null check types nullchecktypes context mask flow context flowcontext comparison null references nullreferences check auto unboxing report warning null check types nullchecktypes check mask hide comparison warning mask expression implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local expression flow context flowcontext comparison null references nullreferences check auto unboxing report warning null check types nullchecktypes check mask hide comparison warning mask expression implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local expression flow info flowinfo is definitely null isdefinitelynull local scope problem reporter problemreporter local variable null reference localvariablenullreference local location flow info flowinfo is potentially null ispotentiallynull local scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local location assign non null nonnull null status nullstatus flow info flowinfo null status nullstatus local null status nullstatus flow info flowinfo annotation name annotationname scope environment get non null annotation name getnonnullannotationname scope problem reporter problemreporter nullity mismatch nullitymismatch expression location provided expected types providedexpectedtypes provided expected types providedexpectedtypes null status nullstatus annotation name annotationname unboxing check unboxing checkunboxing scope expression location flow info flowinfo string individual to string individualtostring nls string buffer stringbuffer buffer string buffer stringbuffer flow context nls buffer append final assignments finalassignments count append assign count assigncount append nls buffer append null references nullreferences count append null count nullcount append buffer to string tostring is sub routine issubroutine record final assignment recordfinalassignment variable binding variablebinding binding reference final assignment finalassignment assign count assigncount final assignments finalassignments reference final variables finalvariables variable binding variablebinding assign count assigncount final assignments finalassignments length system arraycopy final assignments finalassignments final assignments finalassignments reference assign count assigncount assign count assigncount system arraycopy final variables finalvariables final variables finalvariables variable binding variablebinding assign count assigncount assign count assigncount final assignments finalassignments assign count assigncount final assignment finalassignment final variables finalvariables assign count assigncount binding record using null reference recordusingnullreference scope scope local variable binding localvariablebinding local ast node astnode location check type checktype flow info flowinfo flow info flowinfo flow info flowinfo tag bits tagbits flow info flowinfo unreachable flow info flowinfo is definitely unknown isdefinitelyunknown local reference recorded raise redundant check warnings check type checktype tag bits tagbits flow context flowcontext hide comparison warning check type without hide null warning checktypewithouthidenullwarning check type checktype flow context flowcontext hide comparison warning mask enclosing loop conservative tag bits tagbits flow context flowcontext defer diagnostic check type without hide null warning checktypewithouthidenullwarning comparison comparison comparison comparison assignment expression reference expression location flow info flowinfo cannot be null cannotbenull local check type without hide null warning checktypewithouthidenullwarning comparison check type checktype hide comparison warning scope problem reporter problemreporter local variable redundant check on non null localvariableredundantcheckonnonnull local reference flow info flowinfo inits when false initswhenfalse set reach mode setreachmode flow info flowinfo unreachable nullanalysis check type without hide null warning checktypewithouthidenullwarning comparison scope problem reporter problemreporter local variable non null compared to null localvariablenonnullcomparedtonull local reference flow info flowinfo inits when true initswhentrue set reach mode setreachmode flow info flowinfo unreachable nullanalysis flow info flowinfo can only be null canonlybenull local check type without hide null warning checktypewithouthidenullwarning context mask flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local reference check type checktype hide comparison warning scope problem reporter problemreporter local variable redundant check on null localvariableredundantcheckonnull local reference flow info flowinfo inits when false initswhenfalse set reach mode setreachmode flow info flowinfo unreachable nullanalysis flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local reference scope problem reporter problemreporter local variable null compared to non null localvariablenullcomparedtononnull local reference flow info flowinfo inits when true initswhentrue set reach mode setreachmode flow info flowinfo unreachable nullanalysis flow context flowcontext assignment scope problem reporter problemreporter local variable redundant null assignment localvariableredundantnullassignment local reference flow context flowcontext scope problem reporter problemreporter local variable null instanceof localvariablenullinstanceof local reference flow info flowinfo is potentially null ispotentiallynull local check type without hide null warning checktypewithouthidenullwarning context mask flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local reference flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local reference flow info flowinfo cannot be null cannotbenull local flow info flowinfo can only be null canonlybenull local scope problem reporter problemreporter local variable null reference localvariablenullreference local location enclosing loop precise check type without hide null warning checktypewithouthidenullwarning comparison comparison flow info flowinfo is definitely non null isdefinitelynonnull local check type without hide null warning checktypewithouthidenullwarning comparison check type checktype hide comparison warning scope problem reporter problemreporter local variable redundant check on non null localvariableredundantcheckonnonnull local location flow info flowinfo inits when false initswhenfalse set reach mode setreachmode flow info flowinfo unreachable nullanalysis scope problem reporter problemreporter local variable non null compared to null localvariablenonnullcomparedtonull local location flow info flowinfo inits when true initswhentrue set reach mode setreachmode flow info flowinfo unreachable nullanalysis fall comparison comparison assignment expression reference expression location flow info flowinfo is definitely null isdefinitelynull local check type without hide null warning checktypewithouthidenullwarning context mask flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local reference check type checktype hide comparison warning scope problem reporter problemreporter local variable redundant check on null localvariableredundantcheckonnull local reference flow info flowinfo inits when false initswhenfalse set reach mode setreachmode flow info flowinfo unreachable nullanalysis flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable null reference localvariablenullreference local reference scope problem reporter problemreporter local variable null compared to non null localvariablenullcomparedtononnull local reference flow info flowinfo inits when true initswhentrue set reach mode setreachmode flow info flowinfo unreachable nullanalysis flow context flowcontext assignment scope problem reporter problemreporter local variable redundant null assignment localvariableredundantnullassignment local reference flow context flowcontext scope problem reporter problemreporter local variable null instanceof localvariablenullinstanceof local reference flow info flowinfo is potentially null ispotentiallynull local check type without hide null warning checktypewithouthidenullwarning context mask flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local reference flow context flowcontext comparison check auto unboxing report warning check type without hide null warning checktypewithouthidenullwarning check mask reference implicit conversion implicitconversion type ids typeids unboxing scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local reference flow info flowinfo is definitely null isdefinitelynull local scope problem reporter problemreporter local variable null reference localvariablenullreference local location flow info flowinfo is potentially null ispotentiallynull local scope problem reporter problemreporter local variable potential null reference localvariablepotentialnullreference local location flow info flowinfo is definitely non null isdefinitelynonnull local short cut shortcut record null reference recordnullreference local location check type checktype flow info flowinfo prepare check flow info remove final assignment if any removefinalassignmentifany reference reference assign count assigncount final assignments finalassignments reference final assignments finalassignments final variables finalvariables record null reference recordnullreference local variable binding localvariablebinding local ast node astnode expression check type checktype flow info flowinfo null info nullinfo null count nullcount null locals nulllocals local variable binding localvariablebinding null references nullreferences ast node astnode null check types nullchecktypes null count nullcount null locals nulllocals length new length newlength null count nullcount system arraycopy null locals nulllocals null locals nulllocals local variable binding localvariablebinding new length newlength null count nullcount system arraycopy null references nullreferences null references nullreferences ast node astnode new length newlength null count nullcount system arraycopy null check types nullchecktypes null check types nullchecktypes new length newlength null count nullcount null locals nulllocals null count nullcount local null references nullreferences null count nullcount expression null check types nullchecktypes null count nullcount check type checktype record unboxing recordunboxing scope scope expression expression null status nullstatus flow info flowinfo flow info flowinfo null status nullstatus flow info flowinfo record unboxing recordunboxing scope expression null status nullstatus flow info flowinfo defer checking record null reference recordnullreference expression unboxing flow info flowinfo internal record nullity mismatch internalrecordnullitymismatch expression expression type binding typebinding provided type providedtype flow info flowinfo flow info flowinfo null status nullstatus type binding typebinding expected type expectedtype check type checktype decision structure finally flow context finallyflowcontext record using null reference recordusingnullreference null status nullstatus flow info flowinfo unknown tag bits tagbits flow context flowcontext defer diagnostic null status nullstatus flow info flowinfo record provided expected types recordprovidedexpectedtypes provided type providedtype expected type expectedtype null count nullcount record null reference recordnullreference expression local variable binding localvariablebinding expression check type checktype flow info flowinfo
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt core dom rewrite java util hash map hashmap java util iterator java util list java util map org eclipse jdt core i class file iclassfile org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i type root ityperoot org eclipse jdt core java core javacore org eclipse jdt core java model exception javamodelexception org eclipse jdt core dom ast org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast parser astparser org eclipse jdt core dom block org eclipse jdt core dom child list property descriptor childlistpropertydescriptor org eclipse jdt core dom child property descriptor childpropertydescriptor org eclipse jdt core dom compilation unit compilationunit org eclipse jdt core dom simple property descriptor simplepropertydescriptor org eclipse jdt core dom structural property descriptor structuralpropertydescriptor org eclipse jdt internal compiler parser recovery scanner data recoveryscannerdata org eclipse jdt internal core dom rewrite ast rewrite analyzer astrewriteanalyzer org eclipse jdt internal core dom rewrite line information lineinformation org eclipse jdt internal core dom rewrite node info store nodeinfostore org eclipse jdt internal core dom rewrite node rewrite event noderewriteevent org eclipse jdt internal core dom rewrite rewrite event store rewriteeventstore org eclipse jdt internal core dom rewrite tracked node position trackednodeposition org eclipse jdt internal core dom rewrite rewrite event store rewriteeventstore copy source info copysourceinfo org eclipse jdt internal core dom rewrite rewrite event store rewriteeventstore property location propertylocation org eclipse jface text i document idocument org eclipse jface text text utilities textutilities org eclipse text edits multi text edit multitextedit org eclipse text edits text edit textedit org eclipse text edits text edit group texteditgroup infrastructure modifying code describing ast nodes ast rewriter collects descriptions modifications nodes translates descriptions text edits applied original source key modifying original ast virtue allowing enter tai n entertain alternate sets ast calculating multiple quick proposals rewrite infrastructure generate minimal text preserve existing comments indentation follow code formatter settings code snippet illustrated usage pre document document document java util list nclass ast parser astparser parser ast parser astparser new parser newparser ast jls parser set source setsource document to char array tochararray compilation unit compilationunit compilation unit compilationunit parser createast ast ast getast import declaration importdeclaration ast new import declaration newimportdeclaration set name setname ast new name newname string java util ast rewrite astrewrite rewriter ast rewrite astrewrite create ast type declaration typedeclaration type declaration typedeclaration types i tracked node position itrackednodeposition td location tdlocation rewriter track list rewrite listrewrite lrw rewriter get list rewrite getlistrewrite compilation unit compilationunit imports property lrw insert last insertlast text edit textedit edits rewriter rewriteast document undo edit undoedit undo undo edits apply document malformed tree exception malformedtreeexception print stack trace printstacktrace bad location exception badlocationexception print stack trace printstacktrace java util list nimport java util nclass equals document td location tdlocation get start position getstartposition td location tdlocation get length getlength source range document pre exp lore explore multiple alternate create link create copy target createcopytarget ast node astnode copies link create string placeholder createstringplaceholder string string place hold ers placeholders link compilation unit compilationunit record modifications recordmodifications code ast rewrite astrewrite code rewrite javadoc comments link compilation unit compilationunit get comment list getcommentlist comment nodes normal node hierarchy intended subclassed noinstantiate intended instantiated clients noextend intended subclassed clients suppress warnings suppresswarnings rawtypes unchecked ast rewrite astrewrite root node rewrite nodes root accepted ast ast rewrite event store rewriteeventstore event store eventstore node info store nodeinfostore node store nodestore target source range computer uninitialized lazy initialized code target source range computer targetsourcerangecomputer code target source range computer targetsourcerangecomputer target source range computer targetsourcerangecomputer primary field representing rewrite properties efficiently code code rewrite properties link string rewrite sole property code property code link map table property mappings init ially initially code code property object property auxiliary field representing rewrite properties efficiently property object property creates instance describing manipulations ast param ast ast nodes rewritten rewriter instance ast rewrite astrewrite create ast ast ast rewrite astrewrite ast internal constructor creates instance ast clients link create ast create instances param ast ast rewritten ast rewrite astrewrite ast ast ast ast event store eventstore rewrite event store rewriteeventstore node store nodestore node info store nodeinfostore ast returns ast rewrite ast rewrite ast getast ast internal method returns internal event store clients returns internal event store clients rewrite event store rewriteeventstore get rewrite event store getrewriteeventstore event store eventstore internal method returns internal node info store clients returns internal info store clients node info store nodeinfostore get node store getnodestore node store nodestore converts modifications recorded rewriter object representing text edits document original source code document modified nodes original replaced deleted rewriter comp utes computes adjusted source ranges calling link target source range computer targetsourcerangecomputer compute source range computesourcerange ast node astnode get extended source range computer getextendedsourcerangecomputer compute source range computesourcerange node calling methods discard modifications record sub sequence subsequence modifications record method called text edit object accurately reflect net cumulative param document original document source code param options table formatter options key type code string code type code string code code code standard global options link java core javacore get options getoptions java core javacore get options getoptions text edit object describing document recorded rewriter illegal argument exception illegalargumentexception code illegal argument exception illegalargumentexception code thrown document passed correspond ast rewritten text edit textedit rewriteast i document idocument document map options illegal argument exception illegalargumentexception document illegal argument exception illegalargumentexception ast node astnode root node rootnode get root node getrootnode root node rootnode multi text edit multitextedit content document to char array tochararray line information lineinformation line info lineinfo line information lineinformation create document string line delim linedelim text utilities textutilities get default line delimiter getdefaultlinedelimiter document ast node astnode ast root astroot root node rootnode get root getroot list comment nodes commentnodes ast root astroot compilation unit compilationunit compilation unit compilationunit ast root astroot get comment list getcommentlist map current options currentoptions options java core javacore get options getoptions options internalrewriteast content line info lineinfo line delim linedelim comment nodes commentnodes current options currentoptions root node rootnode recovery scanner data recoveryscannerdata compilation unit compilationunit ast root astroot get statements recovery data getstatementsrecoverydata converts modifications recorded rewriter object representing text edits source link i type root ityperoot ast created type root source modified method call api modified ast created link i type root ityperoot source link ast parser astparser set source setsource i compilation unit icompilationunit link ast parser astparser set source setsource i class file iclassfile link ast parser astparser set source setsource i type root ityperoot initial izing initializing link ast parser astparser link illegal argument exception illegalargumentexception thrown link illegal argument exception illegalargumentexception thrown type roots buffer correspond ast link rewriteast i document idocument map ast s asts created content nodes original replaced deleted rewriter comp utes computes adjusted source ranges calling link target source range computer targetsourcerangecomputer compute source range computesourcerange ast node astnode get extended source range computer getextendedsourcerangecomputer compute source range computesourcerange node calling methods discard modifications record sub sequence subsequence modifications record method called text edit object accurately reflect net cumulative text edit object describing document recorded rewriter java model exception javamodelexception link java model exception javamodelexception thrown underlying compilation units buffer accessed illegal argument exception illegalargumentexception link illegal argument exception illegalargumentexception thrown document passed correspond ast rewritten text edit textedit rewriteast java model exception javamodelexception illegal argument exception illegalargumentexception ast node astnode root node rootnode get root node getrootnode root node rootnode multi text edit multitextedit ast node astnode root root node rootnode get root getroot root compilation unit compilationunit nls illegal argument exception illegalargumentexception api ast created compilation unit file compilation unit compilationunit ast root astroot compilation unit compilationunit root i type root ityperoot type root typeroot ast root astroot get type root gettyperoot type root typeroot type root typeroot get buffer getbuffer nls illegal argument exception illegalargumentexception api ast created compilation unit file content type root typeroot get buffer getbuffer get char acters getcharacters line information lineinformation line info lineinfo line information lineinformation create ast root astroot string line delim linedelim type root typeroot find recommended line separator findrecommendedlineseparator map options type root typeroot get java project getjavaproject get options getoptions internalrewriteast content line info lineinfo line delim linedelim ast root astroot get comment list getcommentlist options root node rootnode recovery scanner data recoveryscannerdata ast root astroot get statements recovery data getstatementsrecoverydata text edit textedit internalrewriteast content line information lineinformation line info lineinfo string line delim linedelim list comment nodes commentnodes map options ast node astnode root node rootnode recovery scanner data recoveryscannerdata recovery scanner data recoveryscannerdata text edit textedit result multi text edit multitextedit validateastnotmodified root node rootnode target source range computer targetsourcerangecomputer source range computer sourcerangecomputer get extended source range computer getextendedsourcerangecomputer event store eventstore prepare moved nodes preparemovednodes source range computer sourcerangecomputer ast rewrite analyzer astrewriteanalyzer visitor ast rewrite analyzer astrewriteanalyzer content line info lineinfo line delim linedelim result event store eventstore node store nodestore comment nodes commentnodes options source range computer sourcerangecomputer recovery scanner data recoveryscannerdata illegal argument exception illegalargumentexception root node rootnode accept visitor event store eventstore revert moved nodes revertmovednodes result ast node astnode get root node getrootnode ast node astnode node start iterator iter get rewrite event store getrewriteeventstore get change root iterator getchangerootiterator iter has next hasnext ast node astnode curr ast node astnode iter rewrite event store rewriteeventstore is new node isnewnode curr curr start currstart curr get start position getstartposition curr end currend curr start currstart curr get length getlength node curr start currstart start curr end currend start curr start currstart curr end currend node curr curr start currstart start start curr start currstart curr end currend curr end currend node curr start currstart node get start position getstartposition curr end currend curr start currstart node get length getlength node covers start curr start currstart curr end currend node node get parent getparent curr start currstart node get start position getstartposition curr end currend curr start currstart node get length getlength parent range ast node astnode parent node get parent getparent parent parent get start position getstartposition node get start position getstartposition parent get length getlength node get length getlength node parent parent node get parent getparent node validateastnotmodified ast node astnode root illegal argument exception illegalargumentexception generic visitor genericvisitor is modified visitor ismodifiedvisitor generic visitor genericvisitor visit node visitnode ast node astnode node node get flags getflags ast node astnode original illegal argument exception illegalargumentexception ast rewritten modified nls root accept is modified visitor ismodifiedvisitor removes node parent rewriter ast modified rewriter records not e note node param node node removed node original node ast node inserted replacement ast rewriter param edit group editgroup edit group collect text edits code code ungrouped illegal argument exception illegalargumentexception node node rewriter ast modification invalid removing required node remove ast node astnode node text edit group texteditgroup edit group editgroup node illegal argument exception illegalargumentexception structural property descriptor structuralpropertydescriptor property ast node astnode parent remove node bug rewrite event store rewriteeventstore is new node isnewnode node property location propertylocation location event store eventstore get property location getpropertylocation node rewrite event store rewriteeventstore location property location get property getproperty parent location get parent getparent nls illegal argument exception illegalargumentexception nls node rewriter ast property node get location in parent getlocationinparent parent node get parent getparent property is child list property ischildlistproperty get list rewrite getlistrewrite parent child list property descriptor childlistpropertydescriptor property remove node edit group editgroup parent property edit group editgroup replaces node rewriter replacement node brand original ast placeholder node created link create copy target createcopytarget ast node astnode link create string placeholder createstringplaceholder string ast modified rewriter records not e note node replaced param node node replaced node original node ast node inserted replacement ast rewriter param replacement replacement node code code replacement param edit group editgroup edit group collect text edits code code ungrouped illegal argument exception illegalargumentexception node node rewriter ast replacement node node placeholder modification invalid replace ast node astnode node ast node astnode replacement text edit group texteditgroup edit group editgroup node illegal argument exception illegalargumentexception structural property descriptor structuralpropertydescriptor property ast node astnode parent replace node bug rewrite event store rewriteeventstore is new node isnewnode node property location propertylocation location event store eventstore get property location getpropertylocation node rewrite event store rewriteeventstore location property location get property getproperty parent location get parent getparent nls illegal argument exception illegalargumentexception nls node rewriter ast property node get location in parent getlocationinparent parent node get parent getparent property is child list property ischildlistproperty get list rewrite getlistrewrite parent child list property descriptor childlistpropertydescriptor property replace node replacement edit group editgroup parent property replacement edit group editgroup sets property node property child property replacement node brand original ast placeholder node created link create copy target createcopytarget ast node astnode link create string placeholder createstringplaceholder string code code indicating child deleted property simple property primitive types boxed code code ast modified rewriter records not e note node changed param node node param property node property simple property child property param replacement child code code param edit group editgroup edit group collect text edits code code ungrouped illegal argument exception illegalargumentexception node property node rewriter ast property node property modification invalid ast node astnode node structural property descriptor structuralpropertydescriptor property object text edit group texteditgroup edit group editgroup node property illegal argument exception illegalargumentexception validate is correct t validateiscorrectast node validate property type validatepropertytype property validate is property of node validateispropertyofnode property node node rewrite event noderewriteevent node event nodeevent event store eventstore get node event getnodeevent node property node event nodeevent set new value setnewvalue edit group editgroup event store eventstore set event edit group seteventeditgroup node event nodeevent edit group editgroup returns property managed rewriter property removed code code returned replaced replacing returned property changed original returned child list properties link list rewrite listrewrite get rewritten list getrewrittenlist access rewritten nodes list param node node param property node property property managed rewriter object ast node astnode node structural property descriptor structuralpropertydescriptor property node property illegal argument exception illegalargumentexception property is child list property ischildlistproperty nls illegal argument exception illegalargumentexception list rewriter access nodes list event store eventstore get new value getnewvalue node property creates returns rewriter describing modifications list property node param node node param property node property child list property list rewriter object illegal argument exception illegalargumentexception node property node rewriter ast property node property modification invalid list rewrite listrewrite get list rewrite getlistrewrite ast node astnode node child list property descriptor childlistpropertydescriptor property node property illegal argument exception illegalargumentexception validate is correct t validateiscorrectast node validate is list property validateislistproperty property validate is property of node validateispropertyofnode property node list rewrite listrewrite node property returns named property rewrite code code param property name propertyname property property code code set property setproperty string object illegal argument exception illegalargumentexception property code code object get property getproperty string property name propertyname property name propertyname illegal argument exception illegalargumentexception property rewrite properties property string rewrite single property property name propertyname equals property property rewrite table properties map map property property name propertyname returns object tracks source range node rewrite ast result object ref lects reflects node current source range ast code rewrite code called result object updated reflect node source range rewritten ast param node node track object tracks source range code node code illegal argument exception illegalargumentexception node node rewriter ast node tracked i tracked node position itrackednodeposition track ast node astnode node node illegal argument exception illegalargumentexception text edit group texteditgroup group event store eventstore get tracked node data gettrackednodedata node group nls group text edit group texteditgroup internal event store eventstore set tracked node data settrackednodedata node group tracked node position trackednodeposition group node validate is existing node validateisexistingnode ast node astnode node node get start position getstartposition nls illegal argument exception illegalargumentexception node existing node validate is correct t validateiscorrectast ast node astnode node node getast getast nls illegal argument exception illegalargumentexception node ast validate is list property validateislistproperty structural property descriptor structuralpropertydescriptor property property is child list property ischildlistproperty nls string message property get id getid list property illegal argument exception illegalargumentexception message validate is property of node validateispropertyofnode structural property descriptor structuralpropertydescriptor property ast node astnode node property get node class getnodeclass is instance isinstance node nls string message property get id getid property type node get class getclass get name getname illegal argument exception illegalargumentexception message validate property type validatepropertytype structural property descriptor structuralpropertydescriptor prop object prop is child list property ischildlistproperty nls string message modify list property get list rewrite getlistrewrite illegal argument exception illegalargumentexception message rewrite event store rewriteeventstore debug prop is simple property issimpleproperty simple property descriptor simplepropertydescriptor prop is mandatory ismandatory prop is child property ischildproperty child property descriptor childpropertydescriptor prop is mandatory ismandatory string message nls remove property nls prop get id getid illegal argument exception illegalargumentexception message value type valuetype prop is simple property issimpleproperty simple property descriptor simplepropertydescriptor simple property descriptor simplepropertydescriptor prop value type valuetype get value type getvaluetype value type valuetype value type valuetype integer value type valuetype value type valuetype child property descriptor childpropertydescriptor child property descriptor childpropertydescriptor prop value type valuetype get child type getchildtype value type valuetype is assignable from isassignablefrom get class getclass string message get class getclass get name getname valid type nls prop get node class getnodeclass get name getname nls property nls prop get id getid illegal argument exception illegalargumentexception message creates returns placeholder node source string inserted output document position placeholder string inserted ref ormatted reformatted correcting indentation level placeholder node inserted replace existing node param code string inserted lines extra indentation param node type nodetype ast node astnode type corresponds passed code placeholder node illegal argument exception illegalargumentexception code node type invalid ast node astnode create string placeholder createstringplaceholder string code node type nodetype code illegal argument exception illegalargumentexception ast node astnode placeholder get node store getnodestore new placeholder node newplaceholdernode node type nodetype placeholder nls illegal argument exception illegalargumentexception string placeholder supported type node type nodetype get node store getnodestore mark as string placeholder markasstringplaceholder placeholder code placeholder creates returns node represents sequence nodes nodes brand original ast placeholder node created link create copy target createcopytarget ast node astnode link create string placeholder createstringplaceholder string group node type returned node unspecified returned node replace existing node element group node document rewritten source code nodes inserted order output document position group indentation adjusted param target nodes targetnodes nodes group group node illegal argument exception illegalargumentexception target nodes targetnodes code code empty ast node astnode create group node creategroupnode ast node astnode target nodes targetnodes target nodes targetnodes target nodes targetnodes length illegal argument exception illegalargumentexception block res get node store getnodestore create collapse placeholder createcollapseplaceholder list rewrite listrewrite list rewrite listrewrite get list rewrite getlistrewrite res block statements property target nodes targetnodes length list rewrite listrewrite insert last insertlast target nodes targetnodes res ast node astnode create target node createtargetnode ast node astnode node is move ismove node illegal argument exception illegalargumentexception validate is existing node validateisexistingnode node validate is correct t validateiscorrectast node copy source info copysourceinfo info get rewrite event store getrewriteeventstore mark as copy source markascopysource node get parent getparent node get location in parent getlocationinparent node is move ismove ast node astnode placeholder get node store getnodestore new placeholder node newplaceholdernode node get node type getnodetype placeholder nls illegal argument exception illegalargumentexception creating target node supported nodes type node get class getclass get name getname get node store getnodestore mark as copy target markascopytarget placeholder info placeholder creates returns placeholder node copy node placeholder node inserted replace existing node document rewritten copy source code node inserted output document position placeholder indentation adjusted param node node create copy placeholder placeholder node illegal argument exception illegalargumentexception node node rewriter ast ast node astnode create copy target createcopytarget ast node astnode node create target node createtargetnode node creates returns placeholder node locations node obtaining placeholder node removed replaced placeholder node inserted replace existing node placeholder ast dropped subsequent modifications document rewritten source code node inserted output document position placeholder indentation adjusted param node node create move placeholder placeholder node illegal argument exception illegalargumentexception node node rewriter ast ast node astnode create move target createmovetarget ast node astnode node create target node createtargetnode node returns extended source range computer ast rewriter code target source range computer targetsourcerangecomputer code extended source range computer set target source range computer settargetsourcerangecomputer target source range computer targetsourcerangecomputer target source range computer targetsourcerangecomputer get extended source range computer getextendedsourcerangecomputer target source range computer targetsourcerangecomputer lazy initialize target source range computer targetsourcerangecomputer target source range computer targetsourcerangecomputer target source range computer targetsourcerangecomputer sets named property rewrite code code clear clients employ property names unique avoid inadvertent conflicts clients setting properties rewrite note modifying property considered modification ast clients decorate existing rewrites properties jeopardizing val idity validity bindings rely underlying tree remaining param property name propertyname property param data property code code get property getproperty string illegal argument exception illegalargumentexception property code code set property setproperty string property name propertyname object data property name propertyname illegal argument exception illegalargumentexception property rewrite properties data rewrite rewrite fis t fist property property property name propertyname property data property string rewrite single property property name propertyname equals property luck data delete property property property property data data rewrite property convert flexible representation map hash map hashmap property property property name propertyname data property property rewrite properties map map property data remove property name propertyname check property left size convert efficient representation map entry entries map entry entry set entryset to array toarray map entry property entries get key getkey property entries get value getvalue property name propertyname data properties sets custom target source range computer ast rewriter advanced feature modify comments nodes special cases param computer target source range computer code code restore code target source range computer targetsourcerangecomputer code get extended source range computer getextendedsourcerangecomputer set target source range computer settargetsourcerangecomputer target source range computer targetsourcerangecomputer computer computer rely lazy init code get extended source range computer getextendedsourcerangecomputer target source range computer targetsourcerangecomputer computer returns string suitable debug ging debugging purposes debug string string to string tostring string buffer stringbuffer buf string buffer stringbuffer nls buf append events extra careful uninitialized mangled instances event store eventstore buf append event store eventstore to string tostring buf to string tostring
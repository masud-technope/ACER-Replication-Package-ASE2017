copyright bea systems rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors wharley bea initial api implementation ibm corporation het google bug annotation processing npe get elements annotated with getelementsannotatedwith org eclipse jdt compiler apt tests org eclipse core runtime file locator filelocator org eclipse core runtime platform java buffered reader bufferedreader java file java file output stream fileoutputstream java file reader filereader java io exception ioexception java print writer printwriter java reader java string writer stringwriter java net url java nio charset charset java util array list arraylist java util list java util locale java util service loader serviceloader javax tools diagnostic listener diagnosticlistener javax tools java compiler javacompiler javax tools java compiler javacompiler compilation task compilationtask javax tools java file object javafileobject javax tools standard java file manager standardjavafilemanager helper support compilation checking tests running batch mode batch test utils batchtestutils string resources dir resources relative plugin directory string processor jar lib apt test processors apttestprocessors jar string jls processor jar lib apt test processors apttestprocessors jar string processor jar path processorjarpath string jls processor jar path processorjarpath locations copy generate files string tmp folder tmpfolder java compiler javacompiler eclipse compiler eclipsecompiler string tmp src folder name tmpsrcfoldername file tmp src dir tmpsrcdir string tmp bin folder name tmpbinfoldername file tmp bin dir tmpbindir string tmp gen folder name tmpgenfoldername file tmp gen dir tmpgendir create annotation generates compile verify generation compilation succeeded compile one class compileoneclass java compiler javacompiler compiler list string options file input file inputfile compile one class compileoneclass compiler options input file inputfile compile one class compileoneclass java compiler javacompiler compiler list string options file input file inputfile usejls processors standard java file manager standardjavafilemanager manager compiler get standard file manager getstandardfilemanager locale get default getdefault charset default charset defaultcharset create list input file inputfile list file files array list arraylist file files add input file inputfile iterable java file object javafileobject units manager get java file objects from files getjavafileobjectsfromfiles files string writer stringwriter string writer stringwriter string writer stringwriter print writer printwriter print writer printwriter print writer printwriter string writer stringwriter options add options add tmp bin folder name tmpbinfoldername options add options add tmp gen folder name tmpgenfoldername add processor paths addprocessorpaths options usejls processors options add xprint rounds xprintrounds options add xprint processor info xprintprocessorinfo compilation task compilationtask task compiler get task gettask print writer printwriter manager options units result task call result boolean value booleanvalue string error output erroroutput string writer stringwriter get buffer getbuffer to string tostring system err println compilation failed error output erroroutput junit framework test case testcase assert true asserttrue compilation failed error output erroroutput compile tree compiletree java compiler javacompiler compiler list string options file target folder targetfolder compile tree compiletree compiler options target folder targetfolder compile tree compiletree java compiler javacompiler compiler list string options file target folder targetfolder diagnostic listener diagnosticlistener java file object javafileobject listener compile tree compiletree compiler options target folder targetfolder listener compile tree compiletree java compiler javacompiler compiler list string options file target folder targetfolder usejls processors compile tree compiletree compiler options target folder targetfolder usejls processors compile tree compiletree java compiler javacompiler compiler list string options file target folder targetfolder usejls processors diagnostic listener diagnosticlistener java file object javafileobject listener standard java file manager standardjavafilemanager manager compiler get standard file manager getstandardfilemanager locale get default getdefault charset default charset defaultcharset create list input file inputfile list file files array list arraylist file find files under findfilesunder target folder targetfolder files iterable java file object javafileobject units manager get java file objects from files getjavafileobjectsfromfiles files string writer stringwriter string writer stringwriter string writer stringwriter print writer printwriter print writer printwriter print writer printwriter string writer stringwriter options add options add tmp bin folder name tmpbinfoldername options add options add tmp gen folder name tmpgenfoldername add processor paths addprocessorpaths options usejls processors options add xprint rounds xprintrounds compilation task compilationtask task compiler get task gettask print writer printwriter manager listener options units result task call result boolean value booleanvalue string error output erroroutput string writer stringwriter get buffer getbuffer to string tostring system err println compilation failed error output erroroutput junit framework test case testcase assert true asserttrue compilation failed error output erroroutput compile contents directory tree collecting errors compared expected errors param compiler system compiler eclipse compiler param options passed compiler param target folder targetfolder folder compile param errors string writer stringwriter compiler output written compilation successful compile tree with errors compiletreewitherrors java compiler javacompiler compiler list string options file target folder targetfolder diagnostic listener diagnosticlistener java file object javafileobject diagnostic listener diagnosticlistener compile tree with errors compiletreewitherrors compiler options target folder targetfolder diagnostic listener diagnosticlistener compile tree with errors compiletreewitherrors java compiler javacompiler compiler list string options file target folder targetfolder diagnostic listener diagnosticlistener java file object javafileobject diagnostic listener diagnosticlistener add processors to classpath addprocessorstoclasspath compile tree with errors compiletreewitherrors compiler options target folder targetfolder diagnostic listener diagnosticlistener add processors to classpath addprocessorstoclasspath compile tree with errors compiletreewitherrors java compiler javacompiler compiler list string options file target folder targetfolder diagnostic listener diagnosticlistener java file object javafileobject diagnostic listener diagnosticlistener usejls processors add processors to classpath addprocessorstoclasspath standard java file manager standardjavafilemanager manager compiler get standard file manager getstandardfilemanager locale get default getdefault charset default charset defaultcharset create list input file inputfile list file files array list arraylist file find files under findfilesunder target folder targetfolder files iterable java file object javafileobject units manager get java file objects from files getjavafileobjectsfromfiles files options add options add tmp bin folder name tmpbinfoldername options add options add tmp gen folder name tmpgenfoldername add processor paths addprocessorpaths options usejls processors add processors to classpath addprocessorstoclasspath writer prevent system err poll uted polluted problems string writer stringwriter writer string writer stringwriter compilation task compilationtask task compiler get task gettask writer manager diagnostic listener diagnosticlistener options units result task call result boolean value booleanvalue recursively collect files root ignore directories named cvs compiling multiple source files param files list file files files root folder find files under findfilesunder file root folder rootfolder list file files file child root folder rootfolder list files listfiles cvs equals child get name getname child is directory isdirectory find files under findfilesunder child files files add child folder files saved string get bin folder name getbinfoldername tmp bin folder name tmpbinfoldername java compiler javacompiler get eclipse compiler geteclipsecompiler eclipse compiler eclipsecompiler folder generated files string get gen folder name getgenfoldername tmp gen folder name tmpgenfoldername folder source files compilation string get src folder name getsrcfoldername tmp src folder name tmpsrcfoldername string get resource folder name getresourcefoldername resources dir load eclipse compiler create temporary directories disk init tmp folder tmpfolder system get property getproperty java tmp dir tmpdir tmp folder tmpfolder ends with endswith file separator tmp folder tmpfolder eclipse temp tmp folder tmpfolder file separator eclipse temp tmp bin folder name tmpbinfoldername tmp folder tmpfolder file separator bin tmp bin dir tmpbindir file tmp bin folder name tmpbinfoldername remove existing contents batch test utils batchtestutils delete tree deletetree tmp bin dir tmpbindir tmp bin dir tmpbindir mkdirs tmp bin dir tmpbindir exists could n couldn mkdirs tmp bin folder name tmpbinfoldername tmp gen folder name tmpgenfoldername tmp folder tmpfolder file separator gen src tmp gen dir tmpgendir file tmp gen folder name tmpgenfoldername remove existing contents batch test utils batchtestutils delete tree deletetree tmp gen dir tmpgendir tmp gen dir tmpgendir mkdirs tmp gen dir tmpgendir exists could n couldn mkdirs tmp gen folder name tmpgenfoldername tmp src folder name tmpsrcfoldername tmp folder tmpfolder file separator src tmp src dir tmpsrcdir file tmp src folder name tmpsrcfoldername remove existing contents batch test utils batchtestutils delete tree deletetree tmp src dir tmpsrcdir tmp src dir tmpsrcdir mkdirs tmp src dir tmpsrcdir exists could n couldn mkdirs tmp src folder name tmpsrcfoldername processor jar path processorjarpath setup processor jar setupprocessorjar processor jar tmp folder tmpfolder jls processor jar path processorjarpath setup processor jar setupprocessorjar jls processor jar tmp folder tmpfolder io exception ioexception print stack trace printstacktrace junit framework test case testcase assert not null assertnotnull processor jar path processor jar path processorjarpath file processor jar processorjar file processor jar path processorjarpath junit framework test case testcase assert true asserttrue could n couldn find processor jar processor jar processorjar get absolute path getabsolutepath processor jar processorjar exists eclipse compiler eclipsecompiler get class loader getclassloader service loader serviceloader java compiler javacompiler java compiler loader javacompilerloader service loader serviceloader load java compiler javacompiler for name forname org eclipse jdt internal compiler tool eclipse compiler eclipsecompiler class not found exception classnotfoundexception junit framework test case testcase assert true asserttrue eclipse compiler compiler counter compilercounter java compiler javacompiler java compiler javacompiler java compiler loader javacompilerloader compiler counter compilercounter is instance isinstance java compiler javacompiler eclipse compiler eclipsecompiler java compiler javacompiler junit framework test case testcase assert equals assertequals compiler compiler counter compilercounter junit framework test case testcase assert not null assertnotnull eclipse compiler eclipse compiler eclipsecompiler add processor paths addprocessorpaths list string options usejls processors add to normal classpath addtonormalclasspath string path usejls processors jls processor jar path processorjarpath processor jar path processorjarpath add to normal classpath addtonormalclasspath options add options add tmp src folder name tmpsrcfoldername file path separator pathseparator tmp gen folder name tmpgenfoldername file path separator pathseparator path options add processor path processorpath options add path tear down teardown file processor jar path processorjarpath delete on exit deleteonexit file jls processor jar path processorjarpath delete on exit deleteonexit batch test utils batchtestutils delete tree deletetree file tmp folder tmpfolder string get plugin directory path getplugindirectorypath platform is running isrunning url platformurl platform get bundle getbundle org eclipse jdt compiler apt tests get entry getentry file file locator filelocator tofileurl platformurl get file getfile get absolute path getabsolutepath file system get property getproperty user dir get absolute path getabsolutepath io exception ioexception print stack trace printstacktrace read java file file java io exception ioexception file length filelength file bytes filebytes file length filelength file length java file input stream fileinputstream stream stream java file input stream fileinputstream file bytes read bytesread last read size lastreadsize last read size lastreadsize bytes read bytesread file length filelength last read size lastreadsize stream read file bytes filebytes bytes read bytesread file length filelength bytes read bytesread bytes read bytesread last read size lastreadsize stream stream close file bytes filebytes file delimiters replaced platform independent compilation should convert to independent line delimiter shouldconverttoindependentlinedelimiter file file file get name getname ends with endswith java copy file location destination file exists timestamp file size create destination location convert delimiters link should convert to independent line delimiter shouldconverttoindependentlinedelimiter file param src full path resource location param dest folder destfolder full path destination location io exception ioexception copy resource copyresource file src file dest io exception ioexception dest exists src last modified lastmodified dest last modified lastmodified src length dest length read source bytes src bytes srcbytes src bytes srcbytes read src should convert to independent line delimiter shouldconverttoindependentlinedelimiter src string contents string src bytes srcbytes contents test utils testutils convert to independent line delimiter converttoindependentlinedelimiter contents src bytes srcbytes contents get bytes getbytes file dest folder destfolder dest get parent file getparentfile dest folder destfolder exists dest folder destfolder mkdirs io exception ioexception unable create directory dest folder destfolder write bytes dest file output stream fileoutputstream file output stream fileoutputstream dest write src bytes srcbytes flush close copy resource located code resources code folder plugin location target folder convert delimiters link should convert to independent line delimiter shouldconverttoindependentlinedelimiter file param resource path resourcepath relative path code plugin root resources code resource copied param target folder targetfolder absolute path folder resource copied folder sub folders subfolders created file representing copied resource io exception ioexception file copy resource copyresource string resource path resourcepath file target folder targetfolder io exception ioexception file res dir resdir file get plugin directory path getplugindirectorypath resources dir file resource file resourcefile file res dir resdir resource path resourcepath file target file targetfile file target folder targetfolder resource path resourcepath copy resource copyresource resource file resourcefile target file targetfile target file targetfile copy files directory src directory dest src dest directories exist child directories dest created required existing files dest overwritten new lines newlines converted link should convert to independent line delimiter shouldconverttoindependentlinedelimiter file dir ectories directories named cvs param resource folder name resourcefoldername source folder relative code plugin root resources code param absolute path destination folder io exception ioexception copy resources copyresources string resource folder name resourcefoldername file dest folder destfolder io exception ioexception file res dir resdir file get plugin directory path getplugindirectorypath resources dir file resource folder resourcefolder file res dir resdir resource folder name resourcefoldername copy resources copyresources resource folder resourcefolder dest folder destfolder copy resources copyresources file resource folder resourcefolder file dest folder destfolder io exception ioexception resource folder resourcefolder copy resources folder string children resource folder resourcefolder list children children recursively copy string child children cvs equals child file child res childres file resource folder resourcefolder child file child dest childdest file dest folder destfolder child child res childres is directory isdirectory copy resources copyresources child res childres child dest childdest copy resource copyresource child res childres child dest childdest string setup processor jar setupprocessorjar string processor jar processorjar string tmp dir tmpdir io exception ioexception file lib dir libdir file get plugin directory path getplugindirectorypath file lib file libfile file lib dir libdir processor jar processorjar file destination dir destinationdir file tmp dir tmpdir file destination file destinationfile file destination dir destinationdir processor jar processorjar copy resource copyresource lib file libfile destination file destinationfile destination file destinationfile get canonical path getcanonicalpath recursively delete contents directory including sub directories subdirectories optimized handle large deep directory trees efficiently param normal file deleted directory emptied deleted delete tree deletetree file file children list files listfiles children children recursively delete file child children delete tree deletetree child point normal file empty directory delete check contents file contents code gen text file gentextfile code match code string code file contents equal text filecontentsequaltext file gen text file gentextfile string input length gen text file gentextfile length length input length contents reader buffered reader bufferedreader file reader filereader gen text file gentextfile ofs length read read contents string match input substring ofs ofs read match content equals contentequals string contents read ofs read length read io exception ioexception print stack trace printstacktrace close io exception ioexception print stack trace printstacktrace
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation stephan herrmann contributions bug compiler minimal hook annotation support bug warning missing resources bug compiler annotations checking bug compiler aioob annotation analysis varargs bug compiler resource avoid remaining pos itives positives compiling eclipse sdk bug non null nonnull annotation considered enhanced loops bug compiler distinguish warnings based flow analysis annotations bug compiler evaluate annotations array types bug compiler annotations fields bug compiler syntactic analysis field references bug compiler apply annotation types analysis bug follow type annotations bug bug different iate differentiate type inc ompatibilities incompatibilities annotations bug compiler detect semantically invalid type annotations bug compiler subclass type parameter substitution confuses checking bug safety comp romise compromise array creation bug compiler inference infrastructure evolve meet jls jsr spec bug compiler event ual eventual resolution reference expression referenceexpression happening bug type annotation analysis poly conditional expressions bug compiler resolution errors don surface bug lambdas method reference infer wrong exception type generics runtime exception runtimeexception io exception ioexception bug compiler java compiler recognize declaration style annotations bug compiler loop improve analysis loops bug nonnull argument correctly inferred loop andy clement contributions bug compiler revive code generation support type annotations olivier work bug compiler loose ends code generation org eclipse jdt internal compiler ast org eclipse jdt core compiler char operation charoperation org eclipse jdt internal compiler ast visitor astvisitor org eclipse jdt internal compiler ast null annotation matching nullannotationmatching check mode checkmode org eclipse jdt internal compiler class fmt classfmt class file constants classfileconstants org eclipse jdt internal compiler codegen org eclipse jdt internal compiler flow org eclipse jdt internal compiler impl compiler options compileroptions org eclipse jdt internal compiler impl constant org eclipse jdt internal compiler lookup statement ast node astnode answers identified coding pattern tolerated dead code analysis debug print comp laint complaint invoked condition optimize able optimizeable is k now dead code pattern isknowdeadcodepattern expression expression debug print tolerated expression unary expression unaryexpression expression unary expression unaryexpression expression expression debug print tolerated expression reference flow info flowinfo analyse code analysecode block scope blockscope current scope currentscope flow context flowcontext flow context flowcontext flow info flowinfo flow info flowinfo lambda shape analysis assuming reachable analyze completes control flow reach text ually textually statement blocks don perform int ra intra reach ability reachability analysis assume lambda body free int rinsic intrinsic control flow errors errors exist flagged analysis guaranteed surface block does not complete normally doesnotcompletenormally does not complete normally doesnotcompletenormally lambda shape analysis assuming reachable analyze completes continuing control flow reach text ually textually statement necessitated fact cla ims claims complete discriminate completes exception complete completes by continue completesbycontinue complained complained fake reachable complained unreachable analysing arguments message send messagesend explicit constructor call explicitconstructorcall allocation expression allocationexpression analyse arguments analysearguments block scope blockscope current scope currentscope flow context flowcontext flow context flowcontext flow info flowinfo flow info flowinfo method binding methodbinding method binding methodbinding expression arguments compare actual status parameter annotations called method arguments compiler options compileroptions compiler options compileroptions current scope currentscope compiler options compileroptions compiler options compileroptions source level sourcelevel class file constants classfileconstants jdk method binding methodbinding is polymorphic ispolymorphic consider type annotations considertypeannotations current scope currentscope environment uses null type annotations usesnulltypeannotations hasjdk null annotations nullannotations method binding methodbinding parameter non nullness parameternonnullness num params to check numparamstocheck method binding methodbinding parameters length var arg pos varargpos type binding typebinding var args type varargstype pass through passthrough consider type annotations considertypeannotations hasjdk null annotations nullannotations check varargs special treatment method binding methodbinding is varargs isvarargs var arg pos varargpos num params to check numparamstocheck block essentially copied generate arguments generatearguments num params to check numparamstocheck arguments length var args type varargstype method binding methodbinding parameters var arg pos varargpos type binding typebinding last type lasttype arguments var arg pos varargpos resolved type resolvedtype last type lasttype type binding typebinding var args type varargstype dimensions last type lasttype dimensions last type lasttype is compatible with iscompatiblewith var args type varargstype pass pass through passthrough pass through passthrough pass through passthrough varargs param fed individual args don check num params to check numparamstocheck consider type annotations considertypeannotations num params to check numparamstocheck type binding typebinding expected type expectedtype method binding methodbinding parameters special case non nullness specialcasenonnullness hasjdk null annotations nullannotations method binding methodbinding parameter non nullness parameternonnullness analyse one argument analyseoneargument current scope currentscope flow context flowcontext flow info flowinfo expected type expectedtype arguments special case non nullness specialcasenonnullness method binding methodbinding original parameters pass through passthrough var args type varargstype array binding arraybinding type binding typebinding expected type expectedtype array binding arraybinding var args type varargstype elements type elementstype special case non nullness specialcasenonnullness hasjdk null annotations nullannotations method binding methodbinding parameter non nullness parameternonnullness var arg pos varargpos num params to check numparamstocheck arguments length analyse one argument analyseoneargument current scope currentscope flow context flowcontext flow info flowinfo expected type expectedtype arguments special case non nullness specialcasenonnullness method binding methodbinding original parameters var arg pos varargpos hasjdk null annotations nullannotations num params to check numparamstocheck method binding methodbinding parameter non nullness parameternonnullness type binding typebinding expected type expectedtype method binding methodbinding parameters expression argument arguments slight loss precision info receiver null status nullstatus argument null status nullstatus flow info flowinfo flow context flowcontext required null status nullstatus flow info flowinfo flow context flowcontext record nullity mismatch recordnullitymismatch current scope currentscope argument argument resolved type resolvedtype expected type expectedtype flow info flowinfo null status nullstatus analyse one argument analyseoneargument block scope blockscope current scope currentscope flow context flowcontext flow context flowcontext flow info flowinfo flow info flowinfo type binding typebinding expected type expectedtype expression argument expected non nullness expectednonnullness type binding typebinding original expected originalexpected argument conditional expression conditionalexpression argument is poly expression ispolyexpression drill branches existing null status nullstatus branch conditional expression conditionalexpression conditional expression conditionalexpression argument internal analyse one argument internalanalyseoneargument current scope currentscope flow context flowcontext expected type expectedtype value if true valueiftrue flow info flowinfo if true null status iftruenullstatus expected non nullness expectednonnullness original expected originalexpected internal analyse one argument internalanalyseoneargument current scope currentscope flow context flowcontext expected type expectedtype value if false valueiffalse flow info flowinfo if false null status iffalsenullstatus expected non nullness expectednonnullness original expected originalexpected null status nullstatus argument null status nullstatus flow info flowinfo flow context flowcontext internal analyse one argument internalanalyseoneargument current scope currentscope flow context flowcontext expected type expectedtype argument flow info flowinfo null status nullstatus expected non nullness expectednonnullness original expected originalexpected internal analyse one argument internalanalyseoneargument block scope blockscope current scope currentscope flow context flowcontext flow context flowcontext type binding typebinding expected type expectedtype expression argument flow info flowinfo flow info flowinfo null status nullstatus expected non nullness expectednonnullness type binding typebinding original expected originalexpected consume special generated ctor parameterized generic method binding parameterizedgenericmethodbinding status from annotated null statusfromannotatednull expected non nullness expectednonnullness null status nullstatus null annotation matching nullannotationmatching annotation status annotationstatus null annotation matching nullannotationmatching analyse expected type expectedtype argument resolved type resolvedtype null status nullstatus annotation status annotationstatus is any mismatch isanymismatch status from annotated null statusfromannotatednull avoid reports mentioning non null nonnull expected type expectedtype original expected originalexpected status from annotated null statusfromannotatednull flow info flowinfo reporting current scope currentscope problem reporter problemreporter nullity mismatching type annotation nullitymismatchingtypeannotation argument argument resolved type resolvedtype expected type expectedtype annotation status annotationstatus annotation status annotationstatus is any mismatch isanymismatch status from annotated null statusfromannotatednull flow info flowinfo expected type expectedtype has null type annotations hasnulltypeannotations expected non nullness expectednonnullness improve problem rendering declaration annotation setting lookup environment lookupenvironment env current scope currentscope environment expected type expectedtype env create annotated type createannotatedtype expected type expectedtype annotation binding annotationbinding env get non null annotation getnonnullannotation flow context flowcontext record nullity mismatch recordnullitymismatch current scope currentscope argument argument resolved type resolvedtype expected type expectedtype flow info flowinfo null status nullstatus annotation status annotationstatus check against null type annotation checkagainstnulltypeannotation block scope blockscope scope type binding typebinding required type requiredtype expression expression flow context flowcontext flow context flowcontext flow info flowinfo flow info flowinfo expression conditional expression conditionalexpression expression is poly expression ispolyexpression drill branches existing null status nullstatus branch conditional expression conditionalexpression conditional expression conditionalexpression expression internal check against null type annotation internalcheckagainstnulltypeannotation scope required type requiredtype value if true valueiftrue if true null status iftruenullstatus flow context flowcontext flow info flowinfo internal check against null type annotation internalcheckagainstnulltypeannotation scope required type requiredtype value if false valueiffalse if false null status iffalsenullstatus flow context flowcontext flow info flowinfo null status nullstatus expression null status nullstatus flow info flowinfo flow context flowcontext internal check against null type annotation internalcheckagainstnulltypeannotation scope required type requiredtype expression null status nullstatus flow context flowcontext flow info flowinfo internal check against null type annotation internalcheckagainstnulltypeannotation block scope blockscope scope type binding typebinding required type requiredtype expression expression null status nullstatus flow context flowcontext flow context flowcontext flow info flowinfo flow info flowinfo null annotation matching nullannotationmatching annotation status annotationstatus null annotation matching nullannotationmatching analyse required type requiredtype expression resolved type resolvedtype null status nullstatus expression check mode checkmode compatible annotation status annotationstatus is def init e mismatch isdefinitemismatch scope problem reporter problemreporter nullity mismatching type annotation nullitymismatchingtypeannotation expression expression resolved type resolvedtype required type requiredtype annotation status annotationstatus annotation status annotationstatus want to report wanttoreport annotation status annotationstatus report scope annotation status annotationstatus is unchecked isunchecked flow context flowcontext record nullity mismatch recordnullitymismatch scope expression expression resolved type resolvedtype required type requiredtype flow info flowinfo null status nullstatus annotation status annotationstatus internal redirect inter statements jumps branch chain to branchchainto branch label branchlabel label inspect ast nodes statement desc ending descending nested control str uctures structures specific label breaks out breaksout label ast visitor astvisitor breaks out breaksout visit type declaration typedeclaration type block scope blockscope skope label visit type declaration typedeclaration type class scope classscope skope label visit lambda expression lambdaexpression lambda block scope blockscope skope label visit while statement whilestatement while statement whilestatement block scope blockscope skope label visit d o statement dostatement do statement dostatement block scope blockscope skope label visit for each statement foreachstatement for each statement foreachstatement block scope blockscope skope label visit for statement forstatement for statement forstatement block scope blockscope skope label visit switch statement switchstatement switch statement switchstatement block scope blockscope skope label visit break statement breakstatement break statement breakstatement block scope blockscope skope label char operation charoperation equals label break statement breakstatement label breaks out breaksout breaks out breaksout statement traverse breaks out breaksout breaks out breaksout inspect ast nodes statement label desc ending descending nested control str uctures structures label presumed attached condition lambda shape analysis analysis triggers situations labeled statement labeledstatement continues at outer label continuesatouterlabel continues at outer label continuesatouterlabel ast visitor astvisitor continues to label continuestolabel visit continue statement continuestatement continue statement continuestatement block scope blockscope skope continue statement continuestatement label continues to label continuestolabel continues at outer label continuesatouterlabel statement traverse continues to label continuestolabel continues at outer label continuesatouterlabel report error unreachable reported comp laint level complaintlevel reachable fake reachable dead code deadcode fatal unreachable error complain if unreachable complainifunreachable flow info flowinfo flow info flowinfo block scope blockscope scope previous comp laint level previouscomplaintlevel end of block endofblock flow info flowinfo reach mode reachmode flow info flowinfo unreachable flow info flowinfo reach mode reachmode flow info flowinfo unreachable dead bits ast node astnode is reachable isreachable flow info flowinfo flow info flowinfo dead previous comp laint level previouscomplaintlevel complained unreachable scope problem reporter problemreporter unreachable code unreachablecode end of block endofblock scope check unclosed close ables checkunclosedcloseables flow info flowinfo complained unreachable previous comp laint level previouscomplaintlevel complained fake reachable scope problem reporter problemreporter fake reachable fakereachable end of block endofblock scope check unclosed close ables checkunclosedcloseables flow info flowinfo complained fake reachable previous comp laint level previouscomplaintlevel generate invocation arguments varargs methods generate arguments generatearguments method binding methodbinding binding expression arguments block scope blockscope current scope currentscope code stream codestream code stream codestream binding is varargs isvarargs pos sibilities possibilities exist call var arg vararg method foo foo foo foo foo foo type binding typebinding params binding parameters param length paramlength params length var arg index varargindex param length paramlength var arg index varargindex arguments generate code generatecode current scope currentscope code stream codestream parameter type parametertype array type array binding arraybinding var args type varargstype array binding arraybinding params var arg index varargindex array binding arraybinding code gen var args type codegenvarargstype array binding arraybinding binding parameters var arg index varargindex erasure elements type d elementstypeid var args type varargstype elements type elementstype arg length arglength arguments arguments length arg length arglength param length paramlength number compatible arguments wrap extra array called arg length arglength last index lastindex elements foo foo gen elements array gen remaining element created array code stream codestream generate inlined value generateinlinedvalue arg length arglength var arg index varargindex create mono dimensional array code stream codestream new array newarray code gen var args type codegenvarargstype var arg index varargindex arg length arglength code stream codestream dup code stream codestream generate inlined value generateinlinedvalue var arg index varargindex arguments generate code generatecode current scope currentscope code stream codestream code stream codestream array at put arrayatput elements type d elementstypeid arg length arglength param length paramlength number arguments inexact pass argument type binding typebinding last type lasttype arguments var arg index varargindex resolved type resolvedtype last type lasttype type binding typebinding var args type varargstype dimensions last type lasttype dimensions last type lasttype is compatible with iscompatiblewith code gen var args type codegenvarargstype foo foo arg passed arguments var arg index varargindex generate code generatecode current scope currentscope code stream codestream number compatible arguments wrap extra array gen elements array gen remaining element created array code stream codestream generate inlined value generateinlinedvalue create mono dimensional array code stream codestream new array newarray code gen var args type codegenvarargstype code stream codestream dup code stream codestream generate inlined value generateinlinedvalue arguments var arg index varargindex generate code generatecode current scope currentscope code stream codestream code stream codestream array at put arrayatput elements type d elementstypeid arguments pass extra empty array scenario foo foo generate code empty array parameter type parametertype code stream codestream generate inlined value generateinlinedvalue create mono dimensional array code stream codestream new array newarray code gen var args type codegenvarargstype standard generation method arguments arguments max arguments length max arguments generate code generatecode current scope currentscope code stream codestream generate code generatecode block scope blockscope current scope currentscope code stream codestream code stream codestream is boxing compatible isboxingcompatible type binding typebinding expression type expressiontype type binding typebinding target type targettype expression expression scope scope scope is boxing compatible with isboxingcompatiblewith expression type expressiontype target type targettype narrowing boxing allowed target types expression type expressiontype is base type isbasetype target type targettype is base type isbasetype target type targettype is type variable istypevariable autoboxing scope compiler options compileroptions source level sourcelevel org eclipse jdt internal compiler class fmt classfmt class file constants classfileconstants jdk target type targettype type ids typeids java lang byte javalangbyte target type targettype type ids typeids java lang short javalangshort target type targettype type ids typeids java lang character javalangcharacter expression is constant value of type assignable to type isconstantvalueoftypeassignabletotype expression type expressiontype scope environment compute boxing type computeboxingtype target type targettype is empty block isemptyblock is valid java statement isvalidjavastatement string buffer stringbuffer print indent string buffer stringbuffer output print statement printstatement indent output string buffer stringbuffer print statement printstatement indent string buffer stringbuffer output resolve block scope blockscope scope returns constant statement notaconstant constant resolve case resolvecase block scope blockscope scope type binding typebinding test type testtype switch statement switchstatement switch statement switchstatement statement treated normal statement resolve scope constant notaconstant implementation link org eclipse jdt internal compiler lookup invocation site invocationsite invocation target type invocationtargettype suitable level subclasses override org eclipse jdt internal compiler lookup invocation site invocationsite invocation target type invocationtargettype type binding typebinding invocation target type invocationtargettype simple r simpler not ion notion expected type suitable code assist purposes type binding typebinding expected type expectedtype functional expressions functionalexpressions invocation target type invocationtargettype invocation target type invocationtargettype expression context expressioncontext get expression context getexpressioncontext expression context expressioncontext vanilla context constructor invocations find constructor binding site inners need update innersneedupdate perform post processing produce updates side effects argument types argumenttypes method binding methodbinding find constructor binding findconstructorbinding block scope blockscope scope invocation site reference binding referencebinding receiver type receivertype type binding typebinding argument types argumenttypes method binding methodbinding ctor binding ctorbinding scope get constructor getconstructor receiver type receivertype argument types argumenttypes site resolve poly expression arguments resolvepolyexpressionarguments site ctor binding ctorbinding argument types argumenttypes scope ctor binding ctorbinding
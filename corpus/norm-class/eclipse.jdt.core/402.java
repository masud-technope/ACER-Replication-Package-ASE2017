copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation stephan herrmann stephan berlin inconsistent initialization classpath container backed external folder https bugs eclipse org thirumala red dy reddy mutchukota thirumala google contribution bug https bugs eclipse org bugs bug cgi t erry terry parker tparker google performance hit rates java model javamodel caches https bugs eclipse org and rey andrey loskutov loskutov gmx external folders manager externalfoldersmanager refresh job refreshjob int err upts interrupts auto build job https bugs eclipse org org eclipse jdt internal core java file java file output stream fileoutputstream java io exception ioexception java util array list arraylist java util collection java util collections java util hash map hashmap java util hash set hashset java util iterator java util map java util java util vector org eclipse core resources i folder ifolder org eclipse core resources i project iproject org eclipse core resources i project description iprojectdescription org eclipse core resources i resource iresource org eclipse core resources i resource status iresourcestatus org eclipse core resources i workspace iworkspace org eclipse core resources resources plugin resourcesplugin org eclipse core runtime core exception coreexception org eclipse core runtime i path ipath org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime i status istatus org eclipse core runtime platform org eclipse core runtime status org eclipse core runtime jobs job org eclipse jdt core i classpath entry iclasspathentry org eclipse jdt core java core javacore org eclipse jdt core java model exception javamodelexception org eclipse jdt internal core util messages org eclipse jdt internal core util util suppress warnings suppresswarnings rawtypes unchecked external folders manager externalfoldersmanager nls string external project org eclipse jdt core external folders nls string linked folder link map folders sub set subset folders linked folders have n haven created pending folders pendingfolders counter singleton instance external folders manager externalfoldersmanager manager external folders manager externalfoldersmanager https bugs eclipse org bugs bug cgi platform is running isrunning get folders getfolders external folders manager externalfoldersmanager get external folders manager getexternalfoldersmanager manager manager external folders manager externalfoldersmanager manager returns external paths external folders ref erred referred classpath returns code code hash set hashset get external folders getexternalfolders i classpath entry iclasspathentry classpath classpath hash set hashset folders classpath length i classpath entry iclasspathentry entry classpath entry get entry kind getentrykind i classpath entry iclasspathentry cpe library i path ipath entry path entrypath entry get path getpath is external folder path isexternalfolderpath entry path entrypath folders folders hash set hashset folders add entry path entrypath i path ipath attachment path attachmentpath entry get source attachment path getsourceattachmentpath is external folder path isexternalfolderpath attachment path attachmentpath folders folders hash set hashset folders add attachment path attachmentpath folders returns code code path folder external project is external folder path isexternalfolderpath i path ipath external path externalpath external path externalpath string first segment firstsegment external path externalpath segment first segment firstsegment resources plugin resourcesplugin get workspace getworkspace get root getroot get project getproject first segment firstsegment exists java model manager javamodelmanager manager java model manager javamodelmanager get java model manager getjavamodelmanager manager is external file isexternalfile external path externalpath manager is assume d external file isassumedexternalfile external path externalpath file external folder externalfolder external path externalpath to file tofile external folder externalfolder is file isfile manager add external file addexternalfile external path externalpath external path externalpath get file extension getfileextension jar zip rar file external folder externalfolder exists manager add assume d external file addassumedexternalfile external path externalpath is internal path for external folder isinternalpathforexternalfolder i path ipath resource path resourcepath external project equals resource path resourcepath segment i folder ifolder add folder addfolder i path ipath external folder path externalfolderpath schedule for creation scheduleforcreation add folder addfolder external folder path externalfolderpath get external folders project getexternalfoldersproject schedule for creation scheduleforcreation i folder ifolder add folder addfolder i path ipath external folder path externalfolderpath i project iproject external folders project externalfoldersproject schedule for creation scheduleforcreation map known folders knownfolders get folders getfolders object existing known folders knownfolders external folder path externalfolderpath existing i folder ifolder existing i folder ifolder result result external folders project externalfoldersproject get folder getfolder linked folder counter result exists schedule for creation scheduleforcreation pending folders pendingfolders pending folders pendingfolders collections synchronized set synchronizedset hash set hashset pending folders pendingfolders add external folder path externalfolderpath known folders knownfolders external folder path externalfolderpath result result remove argument list folders pending creation param external path externalpath link argument list pending folders removed remove pending folder removependingfolder object external path externalpath pending folders pendingfolders pending folders pendingfolders remove external path externalpath i folder ifolder create link folder createlinkfolder i path ipath external folder path externalfolderpath refresh if exist already refreshifexistalready i progress monitor iprogressmonitor monitor core exception coreexception create resource i project iproject external folders project externalfoldersproject create external folders project createexternalfoldersproject monitor create link folder createlinkfolder external folder path externalfolderpath refresh if exist already refreshifexistalready external folders project externalfoldersproject monitor i folder ifolder create link folder createlinkfolder i path ipath external folder path externalfolderpath refresh if exist already refreshifexistalready i project iproject external folders project externalfoldersproject i progress monitor iprogressmonitor monitor core exception coreexception i folder ifolder result add folder addfolder external folder path externalfolderpath external folders project externalfoldersproject result exists result create link createlink external folder path externalfolderpath i resource iresource missing local monitor refresh if exist already refreshifexistalready result refresh local refreshlocal i resource iresource depth infinite monitor result create pending folders creatependingfolders i progress monitor iprogressmonitor monitor java model exception javamodelexception pending folders pendingfolders pending folders pendingfolders is empty isempty i project iproject external folders project externalfoldersproject external folders project externalfoldersproject create external folders project createexternalfoldersproject monitor core exception coreexception java model exception javamodelexception https bugs eclipse org bugs bug cgi avoid race condition add folder addfolder remove folder removefolder load map elements array clear map create link folder createlinkfolder block deadlock block object array of folders arrayoffolders pending folders pendingfolders array of folders arrayoffolders pending folders pendingfolders to array toarray pending folders pendingfolders clear array of folders arrayoffolders length create link folder createlinkfolder i path ipath array of folders arrayoffolders external folders project externalfoldersproject monitor core exception coreexception util log error creating link external folder array of folders arrayoffolders clean up cleanup i progress monitor iprogressmonitor monitor core exception coreexception array list arraylist to delete todelete get folders to clean up getfolderstocleanup monitor to delete todelete iterator iterator to delete todelete iterator iterator has next hasnext map entry entry map entry iterator i folder ifolder folder i folder ifolder entry get value getvalue folder delete monitor i path ipath key i path ipath entry get key getkey folders remove key i project iproject project get external folders project getexternalfoldersproject project is accessible isaccessible project members length remaining member project project delete monitor array list arraylist get folders to clean up getfolderstocleanup i progress monitor iprogressmonitor monitor core exception coreexception delta processing state deltaprocessingstate java model manager javamodelmanager get delta state getdeltastate hash map hashmap roots roots hash map hashmap source attachments sourceattachments source attachments sourceattachments roots source attachments sourceattachments map known folders knownfolders get folders getfolders array list arraylist result known folders knownfolders iterator iterator known folders knownfolders entry set entryset iterator iterator has next hasnext map entry entry map entry iterator i path ipath path i path ipath entry get key getkey roots roots contains key containskey path source attachments sourceattachments source attachments sourceattachments contains key containskey path entry get value getvalue result result array list arraylist result add entry result i project iproject get external folders project getexternalfoldersproject resources plugin resourcesplugin get workspace getworkspace get root getroot get project getproject external project i project iproject create external folders project createexternalfoldersproject i progress monitor iprogressmonitor monitor core exception coreexception i project iproject project get external folders project getexternalfoldersproject project is accessible isaccessible project exists create external folders project createexternalfoldersproject project monitor open external folders project openexternalfoldersproject project monitor project attempt open project assuming exists failing open attempts recreate missing pieces open external folders project openexternalfoldersproject i project iproject project i progress monitor iprogressmonitor monitor core exception coreexception project open monitor core exception coreexception get status getstatus get code getcode i resource status iresourcestatus failed read metadata project delete monitor create external folders project createexternalfoldersproject project monitor i path ipath state location statelocation java core javacore get plugin getplugin get state location getstatelocation i path ipath project path projectpath state location statelocation append external project project path projectpath to file tofile mkdirs file output stream fileoutputstream output file output stream fileoutputstream project path projectpath append project toosstring output write xml version encoding utf project description projectdescription external project comment comment projects projects build spec buildspec build spec buildspec natures natures project description projectdescription get bytes getbytes output close io exception ioexception project delete monitor create external folders project createexternalfoldersproject project monitor project open monitor create external folders project createexternalfoldersproject i project iproject project i progress monitor iprogressmonitor monitor core exception coreexception i project description iprojectdescription desc project get workspace getworkspace new project description newprojectdescription project get name getname i path ipath state location statelocation java core javacore get plugin getplugin get state location getstatelocation desc set location setlocation state location statelocation append external project project create desc i resource iresource hidden monitor i folder ifolder get folder getfolder i path ipath external folder path externalfolderpath i folder ifolder get folders getfolders external folder path externalfolderpath map get folders getfolders folders map temp folders tempfolders hash map hashmap i project iproject project get external folders project getexternalfoldersproject project is accessible isaccessible project exists workspace moved https bugs eclipse org bugs bug cgi open external folders project openexternalfoldersproject progress project project doesn exist open recreate external folders folders collections synchronized map synchronizedmap temp folders tempfolders i resource iresource members project members length members length length i resource iresource member members member get type gettype i resource iresource folder member is linked islinked member get name getname starts with startswith linked folder i path ipath external folder path externalfolderpath member get location getlocation temp folders tempfolders external folder path externalfolderpath member core exception coreexception util log exception initial izing initializing external folders folders collections synchronized map synchronizedmap temp folders tempfolders folders https bugs eclipse org bugs bug cgi refresh job refreshjob job run refresh job runrefreshjob collection paths job jobs job get job manager getjobmanager find resources plugin resourcesplugin family manual ref resh refresh refresh job refreshjob refresh job refreshjob jobs jobs length concerned external folder manager externalfoldermanager refresh job refreshjob jobs refresh job refreshjob refresh job refreshjob refresh job refreshjob jobs refresh job refreshjob add folders to refresh addfolderstorefresh paths refresh job refreshjob get state getstate job refresh job refreshjob schedule refresh job refreshjob refresh job refreshjob refresh job refreshjob vector paths refresh job refreshjob schedule ref res hes refreshes external folders referenced classpath source project refresh references refreshreferences i project iproject source projects sourceprojects i progress monitor iprogressmonitor monitor i project iproject external project externalproject get external folders project getexternalfoldersproject hash set hashset external folders externalfolders source projects sourceprojects length source projects sourceprojects equals external project externalproject java project javaproject has java nature hasjavanature source projects sourceprojects hash set hashset folders in project foldersinproject get external folders getexternalfolders java project javaproject java core javacore create source projects sourceprojects get resolved classpath getresolvedclasspath folders in project foldersinproject folders in project foldersinproject size external folders externalfolders external folders externalfolders hash set hashset external folders externalfolders add all addall folders in project foldersinproject external folders externalfolders run refresh job runrefreshjob external folders externalfolders core exception coreexception util log exception ref res hing refreshing external project refresh references refreshreferences i project iproject source i progress monitor iprogressmonitor monitor i project iproject external project externalproject get external folders project getexternalfoldersproject source equals external project externalproject java project javaproject has java nature hasjavanature source hash set hashset external folders externalfolders get external folders getexternalfolders java project javaproject java core javacore create source get resolved classpath getresolvedclasspath external folders externalfolders run refresh job runrefreshjob external folders externalfolders core exception coreexception util log exception ref res hing refreshing external project i folder ifolder remove folder removefolder i path ipath external folder path externalfolderpath i folder ifolder get folders getfolders remove external folder path externalfolderpath refresh job refreshjob job vector external folders externalfolders refresh job refreshjob vector external folders externalfolders messages ref res hing refreshing external folders external folders externalfolders external folders externalfolders bug don int errupt interrupt auto build autobuild rule system flag set system setsystem i workspace iworkspace workspace resources plugin resourcesplugin get workspace getworkspace set rule setrule workspace get rule factory getrulefactory refresh rule refreshrule workspace get root getroot belongs to belongsto object family family resources plugin resourcesplugin family manual ref resh refresh add collection paths ref res hed refreshed existing list paths add folders to refresh addfolderstorefresh collection paths paths is empty isempty external folders externalfolders external folders externalfolders vector iterator paths iterator has next hasnext object path external folders externalfolders path external folders externalfolders add path i status istatus i progress monitor iprogressmonitor external folders externalfolders status status i path ipath external path externalpath external folders externalfolders size external path externalpath i path ipath external folders externalfolders i folder ifolder folder get folder getfolder external path externalpath https bugs eclipse org bugs bug cgi folder folder refresh local refreshlocal i resource iresource depth infinite processed removing element alt ogether altogether considered duplicates avoid elements shifted left time element removed ris k risk collection size inc reased increased external folders externalfolders set element at setelementat core exception coreexception get status getstatus status status
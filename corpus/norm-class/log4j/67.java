licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache log java lang reference java lang reflect field junit framework test case testcase test mdc author maarten bosteels mdc test case mdctestcase test case testcase set up setup mdc clear tear down teardown mdc clear test put testput exception mdc key assert equals assertequals mdc key assert equals assertequals mdc get context getcontext size test remove last key testremovelastkey exception mdc key mdc remove key check thread locals for leaks checkthreadlocalsforleaks check thread locals for leaks checkthreadlocalsforleaks exception code heavily based code org apache catalina loader webapp class loader webappclassloader fields thread store thread locals threadlocals accessible field thread locals field threadlocalsfield thread get declared field getdeclaredfield thread locals threadlocals thread locals field threadlocalsfield set accessible setaccessible field inherit able thread locals field inheritablethreadlocalsfield thread get declared field getdeclaredfield inherit able thread locals inheritablethreadlocals inherit able thread locals field inheritablethreadlocalsfield set accessible setaccessible underlying array thread load threadload thread local map threadlocalmap entry objects accessible tlm class tlmclass for name forname java lang thread local threadlocal thread local map threadlocalmap field table field tablefield tlm class tlmclass get declared field getdeclaredfield table table field tablefield set accessible setaccessible thread thread thread current thread currentthread object thread local map threadlocalmap thread local map threadlocalmap thread locals field threadlocalsfield thread check map check thread local map for leaks checkthreadlocalmapforleaks thread local map threadlocalmap table field tablefield check map thread local map threadlocalmap inherit able thread locals field inheritablethreadlocalsfield thread check thread local map for leaks checkthreadlocalmapforleaks thread local map threadlocalmap table field tablefield check thread local map for leaks checkthreadlocalmapforleaks object map field internal table field internaltablefield illegal access exception illegalaccessexception no such field exception nosuchfieldexception map object table object internal table field internaltablefield map table table length table check key object key reference table string key class name keyclassname key get class getclass get name getname key get class getclass org apache log helpers thread local map threadlocalmap fail thread local threadlocal key type key class name keyclassname
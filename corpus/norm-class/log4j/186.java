licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache log util junit framework test case testcase java byte array input stream bytearrayinputstream java byte array output stream bytearrayoutputstream java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream utiities serialization tests author curt arnold serialization test helper serializationtesthelper constructor serialization test helper serializationtesthelper creates clone serial izing serializing object deserializing stream param obj object serialize deserialize clone io exception ioexception error class not found exception classnotfoundexception object serialize clone serializeclone object obj io exception ioexception class not found exception classnotfoundexception byte array output stream bytearrayoutputstream mem out memout byte array output stream bytearrayoutputstream object output stream objectoutputstream obj out objout object output stream objectoutputstream mem out memout obj out objout write object writeobject obj obj out objout close byte array input stream bytearrayinputstream src byte array input stream bytearrayinputstream mem out memout to byte array tobytearray object input stream objectinputstream obj is objis object input stream objectinputstream src obj is objis read object readobject deserializes file param witness serialization file deserialized object exception thrown deserialization exception object deserialize stream deserializestream string witness exception file input stream fileinputstream file is fileis file input stream fileinputstream witness object input stream objectinputstream obj is objis object input stream objectinputstream file is fileis obj is objis read object readobject checks serialization object file expected serialization param witness file expected serialization param obj object serialized param skip positions serialized stream compared param end compare endcompare position comparison exception thrown serialization exception assert serialization equals assertserializationequals string witness object obj skip end compare endcompare exception byte array output stream bytearrayoutputstream mem out memout byte array output stream bytearrayoutputstream object output stream objectoutputstream obj out objout object output stream objectoutputstream mem out memout obj out objout write object writeobject obj obj out objout close assert stream equals assertstreamequals witness mem out memout to byte array tobytearray skip end compare endcompare asserts serialized form object param witness file expected serialization param actual array actual serialization param skip positions skip comparison param end compare endcompare position comparison io exception ioexception thrown serialization exception assert stream equals assertstreamequals string witness actual skip end compare endcompare io exception ioexception file witness file witnessfile file witness witness file witnessfile exists skip index skipindex expected actual length file input stream fileinputstream file input stream fileinputstream witness file witnessfile bytes read bytesread read expected close bytes read bytesread end compare endcompare test case testcase assert equals assertequals bytes read bytesread actual length end scan endscan actual length end scan endscan end compare endcompare end scan endscan end compare endcompare end scan endscan skip index skipindex skip length skip skip index skipindex skip index skipindex expected actual test case testcase assert equals assertequals difference offset expected actual file doesn exist assume setting write file output stream fileoutputstream file output stream fileoutputstream witness file witnessfile write actual close test case testcase fail writing witness file witness
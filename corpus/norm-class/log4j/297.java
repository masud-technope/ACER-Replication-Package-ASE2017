licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license klopotek utils log java sql java util org apache log org apache log helpers org apache log spi encapsulate logic log table jdbc appender jdbcappender author href mailto fenner klopotek thomas fenner jdbc logger jdbclogger columns log table array list arraylist log cols logcols columns logging string column list number columns num status successful execution method configure isconfigured status ready logging method append ready message filled error string method ready failes calling get msg getmsg string error msg errormsg connection con statement stmt result set resultset string table variables sql statement logging string sql string sql string sql string sql string msg wildcard msg msg wildcard pos writes message database table exception database error occurs append string msg exception ready ready exception jdbc logger jdbclogger append ready append sql appendsql msg log column logcolumn logcol move to insert row movetoinsertrow num logcol log column logcolumn log cols logcols logcol logtype log type logtype msg update object updateobject logcol msg logcol logtype log type logtype update object updateobject logcol logcol idhandler getid logcol logtype log type logtype update object updateobject logcol logcol logcol logtype log type logtype timestamp update object updateobject logcol timestamp java util get time gettime insert row insertrow writes message database sql statement exception database error occurs appendsql string msg exception ready ready exception jdbc logger jdbclogger appendsql ready append sql exception jdbc logger jdbclogger appendsql sql statement configured msg wildcard pos sql sql msg sql sql sql stmt execute update executeupdate sql exception error msg errormsg sql config ures configures reading structure log table exception database error occurs configure table configuretable string table exception isconfigured fill log cols logcols meta info rmations informations table columns stmt con create statement createstatement result set resultset type scroll insensitive result set resultset concur updatable stmt execute query executequery select table log column logcolumn logcol result set meta data resultsetmetadata rsmd get meta data getmetadata num rsmd get column count getcolumncount log cols logcols array list arraylist num num logcol log column logcolumn logcol rsmd get column name getcolumnname to upper case touppercase logcol type rsmd get column type name getcolumntypename logcol null able nullable rsmd is nullable isnullable rsmd column nullable columnnullable logcol is writable iswritable rsmd is writable iswritable logcol is writable iswritable logcol ignore log cols logcols add logcol table table isconfigured config ures configures storing parsing sql statement exception some things somethings wrong configuresql string sql exception isconfigured is connected isconnected exception jdbc logger jdbclogger configuresql connected database sql sql trim equals exception jdbc logger jdbclogger configuresql invalid sql statement sql sql trim stmt con create statement createstatement msg wildcard pos sql index of indexof msg wildcard msg wildcard pos sql sql substring msg wildcard pos message sql sql substring msg wildcard pos msg wildcard length isconfigured sets connection exception connection open set connection setconnection connection con exception con con is connected isconnected exception jdbc logger jdbclogger set connection setconnection connection isn t isnt connected database sets columns logtype log types logtypes depends logtype exception arguments correct set log type setlogtype string logtype object exception isconfigured exception jdbc logger jdbclogger set log type setlogtype configured set log type setlogtype sense configuration configure table configuretable sql to upper case touppercase trim length exception jdbc logger jdbclogger set log type setlogtype missing argument log type logtype is log type islogtype logtype exception jdbc logger jdbclogger set log type setlogtype invalid logtype logtype logtype log type logtype msg logtype log type logtype empty exception jdbc logger jdbclogger set log type setlogtype missing argument log column logcolumn logcol num logcol log column logcolumn log cols logcols logcol equals logcol is writable iswritable exception jdbc logger jdbclogger set log type setlogtype column write able writeable column message logtype log type logtype msg logcol logtype logtype column jdbc id handler jdbcidhandler getid logtype log type logtype logcol logtype logtype object jdbc id handler jdbcidhandler logcol idhandler jdbc id handler jdbcidhandler exception logcol idhandler jdbc id handler jdbcidhandler for name forname string new instance newinstance exception exception jdbc logger jdbclogger set log type setlogtype get class getclass jdbc id handler jdbcidhandler column static ally statically defined object logtype log type logtype logcol logtype logtype logcol column timestamp logtype log type logtype timestamp logcol logtype logtype required logtype log type logtype empty logcol logtype logtype logcol ignore ready append ready reason string stored instance variable msg ready ready isconfigured error msg errormsg ready append call configure sql ready msg col msgcol defined log column logcolumn logcol num logcol log column logcolumn log cols logcols logcol ignore logcol is writable iswritable logcol null able nullable logcol logtype log type logtype empty error msg errormsg ready append column logcol null able nullable set log type setlogtype logcol logtype log type logtype logcol idhandler error msg errormsg ready append column logcol column jdbc id handler jdbcidhandler logcol logtype log type logtype logcol error msg errormsg ready append column logcol field logcol logtype log type logtype msg msg col msgcol defined msg col msgcol defined create column list num logcol log column logcolumn log cols logcols logcol ignore logcol is writable iswritable logcol logtype log type logtype empty column list column list logcol column list logcol stmt execute query executequery select column list table exception error msg errormsg ready append select columns column list table table ready configured is configured isconfigured isconfigured connection open is connected isconnected con con is closed isclosed exception internal error message stored instance variable msg string get error msg geterrormsg string string error msg errormsg error msg errormsg encapsulate jdbc logger jdbclogger needed data column log column logcolumn column string column type string type null ability nullability column mandatory null able nullable is writable iswritable column updated column readable is writable iswritable ignore column building sql statements ignore filled null able nullable columns optional logtype log type logtype empty storage type wrapper typewrapper classes string object jdbc id handler jdbcidhandler idhandler constants define columns log type log type logtype column type receive message msg column type unique identifier log ged logged row column type time defined column type filled actual timestamp depending time logging timestamp column type included logging insert statement column filled creation other where otherwhere empty is log type islogtype msg timestamp empty parse log type parselogtype string equals msg msg equals equals equals timestamp timestamp equals empty empty
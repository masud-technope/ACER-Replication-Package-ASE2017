licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache log xml org apache log layout org apache log layout test layouttest org apache log level org apache log logger org apache log ndc org apache log mdc org apache log spi logging event loggingevent org dom document org dom element org dom node org dom node list nodelist org xml sax input source inputsource java reader java string reader stringreader java util hashtable javax xml parsers document builder documentbuilder javax xml parsers document builder factory documentbuilderfactory test xml layout xmllayout author curt arnold xml layout test xmllayouttest layout test layouttest construct instance xml layout test xmllayouttest param test name testname test xml layout test xmllayouttest string test name testname test name testname text plain clear mdc ndc test set up setup ndc clear mdc get context getcontext mdc get context getcontext clear clear mdc ndc test tear down teardown set up setup inherit doc inheritdoc layout create layout createlayout xml layout xmllayout parses string body xml document returns document element param source source string document element exception parser constructed source valid xml document element parse string source exception document builder factory documentbuilderfactory factory document builder factory documentbuilderfactory new instance newinstance factory set name space aware setnamespaceaware factory set coalescing setcoalescing document builder documentbuilder builder factory new document builder newdocumentbuilder reader reader string reader stringreader source document doc builder parse input source inputsource reader doc get document element getdocumentelement checks log event element expectations param element element param event event check event element checkeventelement element element logging event loggingevent event assert equals assertequals log event element get tag name gettagname assert equals assertequals event get logger name getloggername element get attribute getattribute logger assert equals assertequals to string tostring event time stamp timestamp element get attribute getattribute timestamp assert equals assertequals event get level getlevel to string tostring element get attribute getattribute level assert equals assertequals event get thread name getthreadname element get attribute getattribute thread checks log message element expectations param element element param message expected message check message element checkmessageelement element element string message assert equals assertequals log message element get tag name gettagname node message node messagenode element get first child getfirstchild assert not null assertnotnull message node messagenode assert equals assertequals node text node message node messagenode get node type getnodetype assert equals assertequals message message node messagenode get node value getnodevalue assert null assertnull message node messagenode get next sibling getnextsibling checks log message element expectations param element element param message expected message checkndcelement element element string message assert equals assertequals log ndc element get tag name gettagname node message node messagenode element get first child getfirstchild assert not null assertnotnull message node messagenode assert equals assertequals node text node message node messagenode get node type getnodetype assert equals assertequals message message node messagenode get node value getnodevalue assert null assertnull message node messagenode get next sibling getnextsibling checks log throwable element expectations param element element param exception check throwable element checkthrowableelement element element exception assert equals assertequals log throwable element get tag name gettagname node message node messagenode element get first child getfirstchild assert not null assertnotnull message node messagenode assert equals assertequals node text node message node messagenode get node type getnodetype string msg to string tostring assert equals assertequals msg message node messagenode get node value getnodevalue substring msg length assert null assertnull message node messagenode get next sibling getnextsibling checks log properties element expectations param element element param key key param check properties element checkpropertieselement element element string key string assert equals assertequals log properties element get tag name gettagname child node count childnodecount node child element get first child getfirstchild child child child get next sibling getnextsibling child get node type getnodetype node element node assert equals assertequals log data child get node name getnodename element child element childelement element child assert equals assertequals key child element childelement get attribute getattribute assert equals assertequals child element childelement get attribute getattribute child node count childnodecount assert equals assertequals child node count childnodecount tests for matted formatted exception parser constructed source valid xml document test format testformat exception logger logger logger get logger getlogger org apache log xml xml layout test xmllayouttest logging event loggingevent event logging event loggingevent org apache log logger logger level info xml layout xmllayout layout xml layout xmllayout create layout createlayout string result layout format event element parsed result parsedresult parse result check event element checkeventelement parsed result parsedresult event child element count childelementcount node node parsed result parsedresult get first child getfirstchild node node node get next sibling getnextsibling node get node type getnodetype node element node child element count childelementcount check message element checkmessageelement element node node comment node node text node whitespace fail unexpected node type assert equals assertequals child element count childelementcount tests for matted formatted exception exception parser constructed source valid xml document test format with exception testformatwithexception exception logger logger logger get logger getlogger org apache log xml xml layout test xmllayouttest exception illegal argument exception illegalargumentexception foo valid logging event loggingevent event logging event loggingevent org apache log logger logger level info xml layout xmllayout layout xml layout xmllayout create layout createlayout string result layout format event element parsed result parsedresult parse result check event element checkeventelement parsed result parsedresult event child element count childelementcount node node parsed result parsedresult get first child getfirstchild node node node get next sibling getnextsibling node get node type getnodetype node element node child element count childelementcount child element count childelementcount check message element checkmessageelement element node check throwable element checkthrowableelement element node node comment node node text node whitespace fail unexpected node type assert equals assertequals child element count childelementcount tests for matted formatted exception exception parser constructed source valid xml document test format with c testformatwithndc exception logger logger logger get logger getlogger org apache log xml xml layout test xmllayouttest ndc push ndc logging event loggingevent event logging event loggingevent org apache log logger logger level info xml layout xmllayout layout xml layout xmllayout create layout createlayout string result layout format event ndc pop element parsed result parsedresult parse result check event element checkeventelement parsed result parsedresult event child element count childelementcount node node parsed result parsedresult get first child getfirstchild node node node get next sibling getnextsibling node get node type getnodetype node element node child element count childelementcount child element count childelementcount check message element checkmessageelement element node checkndcelement element node ndc node comment node node text node whitespace fail unexpected node type assert equals assertequals child element count childelementcount tests get location info getlocationinfo set location info setlocationinfo test get set location info testgetsetlocationinfo xml layout xmllayout layout xml layout xmllayout assert equals assertequals layout get location info getlocationinfo layout set location info setlocationinfo assert equals assertequals layout get location info getlocationinfo layout set location info setlocationinfo assert equals assertequals layout get location info getlocationinfo tests activate options activateoptions test activate options testactivateoptions xml layout xmllayout layout xml layout xmllayout layout activate options activateoptions level arbitrary to string tostring problem level problemlevel level serialversionuid construct instance param level name levelname level problem level problemlevel string level name levelname level name levelname tests problem atic problematic characters multiple fields exception parser constructed source valid xml document test problem char acters testproblemcharacters exception string problem name problemname bar logger logger logger get logger getlogger problem name problemname level level problem level problemlevel problem name problemname exception illegal argument exception illegalargumentexception problem name problemname string thread name threadname thread current thread currentthread get name getname thread current thread currentthread set name setname problem name problemname ndc push problem name problemname hashtable mdc map mdcmap mdc get context getcontext mdc map mdcmap mdc map mdcmap clear mdc problem name problemname problem name problemname logging event loggingevent event logging event loggingevent problem name problemname logger level problem name problemname xml layout xmllayout layout xml layout xmllayout create layout createlayout layout set properties setproperties string result layout format event mdc map mdcmap mdc get context getcontext mdc map mdcmap mdc map mdcmap clear thread current thread currentthread set name setname thread name threadname element parsed result parsedresult parse result check event element checkeventelement parsed result parsedresult event child element count childelementcount node node parsed result parsedresult get first child getfirstchild node node node get next sibling getnextsibling node get node type getnodetype node element node child element count childelementcount child element count childelementcount check message element checkmessageelement element node problem name problemname checkndcelement element node problem name problemname check throwable element checkthrowableelement element node check properties element checkpropertieselement element node problem name problemname problem name problemname fail unexpected element node comment node node text node whitespace fail unexpected node type tests cdata element ndc content bug testndcwithcdata exception logger logger logger get logger getlogger bar level level level info string ndc message ndcmessage env elope envelope faultstring cdata effective date effectivedate faultstring env elope envelope ndc push ndc message ndcmessage logging event loggingevent event logging event loggingevent bar logger level layout layout create layout createlayout string result layout format event ndc clear element parsed result parsedresult parse result node list nodelist ndcs parsed result parsedresult get elements by tag name getelementsbytagname log ndc assert equals assertequals ndcs get length getlength string buffer stringbuffer buf string buffer stringbuffer node child ndcs item get first child getfirstchild child child child get next sibling getnextsibling buf append child get node value getnodevalue assert equals assertequals ndc message ndcmessage buf to string tostring tests cdata element exception bug testexceptionwithcdata exception logger logger logger get logger getlogger bar level level level info string exception message exceptionmessage env elope envelope faultstring cdata effective date effectivedate faultstring env elope envelope logging event loggingevent event logging event loggingevent bar logger level exception exception message exceptionmessage layout layout create layout createlayout string result layout format event element parsed result parsedresult parse result node list nodelist throw ables throwables parsed result parsedresult get elements by tag name getelementsbytagname log throwable assert equals assertequals throw ables throwables get length getlength string buffer stringbuffer buf string buffer stringbuffer node child throw ables throwables item get first child getfirstchild child child child get next sibling getnextsibling buf append child get node value getnodevalue assert true asserttrue buf to string tostring index of indexof exception message exceptionmessage
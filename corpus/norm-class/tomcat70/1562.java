licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http file upload fileupload exception thrown invalid file file invalid nul character att ack ers attackers circumvent security checks malicious user upload file foo exe png file pass security checks checks extension png depending underlying library create file named foo exe nul character string terminator invalid file name exception invalidfilenameexception runtime exception runtimeexception serial version uid exception serialized serialversionuid file causing exception string creates instance param p name pname file causing exception param p message pmessage human readable error message invalid file name exception invalidfilenameexception string p name pname string p message pmessage p message pmessage p name pname returns invalid file invalid file string get name getname
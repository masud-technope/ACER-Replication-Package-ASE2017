licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina deploy java serializable java util collection java util hash set hashset java util iterator java util javax servlet http constraint element httpconstraintelement javax servlet http method constraint element httpmethodconstraintelement javax servlet servlet security element servletsecurityelement javax servlet annotation servlet security servletsecurity javax servlet annotation servlet security servletsecurity empty role semantic emptyrolesemantic representation security constraint element web application represented code security constraint code element deployment descriptor warning assumed instances created modified context single thread instance visible remainder application read access expected read write access author craig mc clanahan mcclanahan security constraint securityconstraint serializable serialversionuid construct security constraint instance values security constraint securityconstraint instance variables roles wildcard included authorization constraints security constraint all roles allroles authorization constraint included security constraint distinguish constraint roles sign ifying signifying direct access requested lack constraint impl ies implies access control checking auth constraint authconstraint roles permitted access resources security constraint string auth roles authroles string web resource collections security constraint security collection securitycollection collections security collection securitycollection display security constraint string display name displayname user data constraint security constraint int egral integral confidential string user constraint userconstraint properties roles wildcard included authentication constraint get all roles getallroles all roles allroles authorization constraint flag security constraint get auth constraint getauthconstraint auth constraint authconstraint authorization constraint flag security constraint set auth constraint setauthconstraint auth constraint authconstraint auth constraint authconstraint auth constraint authconstraint display security constraint string get display name getdisplayname display name displayname display security constraint set display name setdisplayname string display name displayname display name displayname display name displayname user data constraint security constraint string get user constraint getuserconstraint user constraint userconstraint user data constraint security constraint param user constraint userconstraint user data constraint set user constraint setuserconstraint string user constraint userconstraint user constraint userconstraint user constraint userconstraint user constraint userconstraint methods add authorization role role permitted access resources security constraint param auth role authrole role add auth role addauthrole string auth role authrole auth role authrole equals auth role authrole all roles allroles string string auth roles authroles length auth roles authroles length auth roles authroles auth roles authroles length auth role authrole auth roles authroles auth constraint authconstraint add web resource collection security constraint param collection web resource collection add collection addcollection security collection securitycollection collection collection security collection securitycollection security collection securitycollection collections length collections length collections collections length collection collections code code role permitted access resources security constraint param role role checked find auth role findauthrole string role role auth roles authroles length role equals auth roles authroles roles permitted access resources security constraint defined length array returned impl ies implies authenticated users permitted access string find auth roles findauthroles auth roles authroles web resource collection code code param web resource collection security collection securitycollection find collection findcollection string collections length equals collections get name getname collections web resource collections security constraint length array returned security collection securitycollection find collections findcollections collections code code context relative uri http method security constraint param uri context relative uri check param method request method included string uri string method match valid request method method check collections included constraint collections length collections find method findmethod method string patterns collections find patterns findpatterns patterns length match pattern matchpattern uri patterns collection included constraint matches request remove role roles permitted access resources security constraint param auth role authrole role removed remove auth role removeauthrole string auth role authrole auth role authrole auth roles authroles length auth roles authroles equals auth role authrole string string auth roles authroles length auth roles authroles length auth roles authroles auth roles authroles remove web resource collection security constraint param collection web resource collection removed remove collection removecollection security collection securitycollection collection collection collections length collections equals collection security collection securitycollection security collection securitycollection collections length collections length collections collections string representation security constraint override string to string tostring string builder stringbuilder string builder stringbuilder security constraint securityconstraint collections length append append collections get name getname append to string tostring methods request path match url pattern method rules order mapping requests servlets param path context relative request path checked start param pattern url pattern compared match pattern matchpattern string path string pattern normalize argument strings path path length path pattern pattern length pattern check exact match path equals pattern check path prefix matching pattern starts with startswith pattern ends with endswith pattern pattern substring pattern length pattern length path ends with endswith path path substring path length pattern equals path slash path last index of lastindexof slash path path substring slash check suffix matching pattern starts with startswith slash path last index of lastindexof period path last index of lastindexof slash period slash path ends with endswith pattern substring check universal mapping pattern equals convert link servlet security element servletsecurityelement array link security constraint securityconstraint param element element converted param url pattern urlpattern url pattern element applied length array constraints equivalent input security constraint securityconstraint create constraints createconstraints servlet security element servletsecurityelement element string url pattern urlpattern security constraint securityconstraint result hash set hashset security constraint securityconstraint add method constraints collection http method constraint element httpmethodconstraintelement methods element get http method constraints gethttpmethodconstraints iterator http method constraint element httpmethodconstraintelement method iter methoditer methods iterator method iter methoditer has next hasnext http method constraint element httpmethodconstraintelement method element methodelement method iter methoditer security constraint securityconstraint constraint create constraint createconstraint method element methodelement url pattern urlpattern single collection security collection securitycollection collection constraint find collections findcollections collection add method addmethod method element methodelement get method name getmethodname result add constraint add constraint methods security constraint securityconstraint constraint create constraint createconstraint element url pattern urlpattern constraint single collection security collection securitycollection collection constraint find collections findcollections iterator string ommitted method ommittedmethod element get method names getmethodnames iterator ommitted method ommittedmethod has next hasnext collection add omitted method addomittedmethod ommitted method ommittedmethod result add constraint result to array toarray security constraint securityconstraint result size security constraint securityconstraint create constraint createconstraint http constraint element httpconstraintelement element string url pattern urlpattern always create alwayscreate security constraint securityconstraint constraint security constraint securityconstraint security collection securitycollection collection security collection securitycollection create always create alwayscreate element get transport guarantee gettransportguarantee servlet security servletsecurity transport guarantee transportguarantee constraint set user constraint setuserconstraint element get transport guarantee gettransportguarantee create element get roles allowed getrolesallowed length string roles element get roles allowed getrolesallowed string role roles constraint add auth role addauthrole role create element get empty role semantic getemptyrolesemantic empty role semantic emptyrolesemantic per mit permit constraint set auth constraint setauthconstraint create create collection add pattern addpattern url pattern urlpattern constraint add collection addcollection collection constraint
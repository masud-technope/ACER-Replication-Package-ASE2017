licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java io exception ioexception java security principal java security privileged action exception privilegedactionexception javax servlet filter javax servlet filter chain filterchain javax servlet servlet javax servlet servlet exception servletexception javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina globals org apache catalina instance event instanceevent org apache catalina comet comet event cometevent org apache catalina comet comet filter cometfilter org apache catalina comet comet filter chain cometfilterchain org apache catalina comet comet processor cometprocessor org apache catalina security security util securityutil org apache catalina util instance support instancesupport org apache tomcat util exception utils exceptionutils org apache tomcat util res string manager stringmanager implementation code javax servlet filter chain filterchain code manage execution filters request defined filters executed call code do filter dofilter code execute servlet code service code method author craig mc clanahan mcclanahan application filter chain applicationfilterchain filter chain filterchain comet filter chain cometfilterchain enforce requirements srv srv thread local threadlocal servlet request servletrequest last service d request lastservicedrequest thread local threadlocal servlet response servletresponse last service d response lastservicedresponse application dispatcher applicationdispatcher wrap object last service d request lastservicedrequest thread local threadlocal servlet request servletrequest last service d response lastservicedresponse thread local threadlocal servlet response servletresponse last service d request lastservicedrequest last service d response lastservicedresponse constants increment construct chain instance defined filters application filter chain applicationfilterchain instance variables filters application filter config applicationfilterconfig filters application filter config applicationfilterconfig main tain maintain current position filter chain pos current number filters chain servlet instance executed chain servlet servlet string manager string manager stringmanager string manager stringmanager get manager getmanager constants instance support instancesupport instance wrapper send filter filter events instance support instancesupport support array security manager securitymanager turned code do filter dofilter code invoked class type classtype servlet request servletrequest servlet response servletresponse filter chain filterchain array security manager securitymanager turned code service code invoked class type used in service classtypeusedinservice servlet request servletrequest servlet response servletresponse array security manager securitymanager turned code do filter event dofilterevent code invoked comet class type cometclasstype comet event cometevent comet filter chain cometfilterchain array security manager securitymanager turned code event code invoked class type used in event classtypeusedinevent comet event cometevent filter chain filterchain methods invoke filter chain passing request response filters chain invoke code service code method servlet param request servlet request processing param response servlet response creating exception io exception ioexception input output error occurs exception servlet exception servletexception servlet exception occurs override do filter dofilter servlet request servletrequest request servlet response servletresponse response io exception ioexception servlet exception servletexception globals security enabled servlet request servletrequest req request servlet response servletresponse res response java security access controller accesscontroller do privileged doprivileged java security privileged exception action privilegedexceptionaction override servlet exception servletexception io exception ioexception internal do filter internaldofilter req res privileged action exception privilegedactionexception exception get exception getexception servlet exception servletexception servlet exception servletexception io exception ioexception io exception ioexception runtime exception runtimeexception runtime exception runtimeexception servlet exception servletexception get message getmessage internal do filter internaldofilter request response internal do filter internaldofilter servlet request servletrequest request servlet response servletresponse response io exception ioexception servlet exception servletexception call filter pos application filter config applicationfilterconfig filter config filterconfig filters pos filter filter filter filter config filterconfig get filter getfilter support fire instance event fireinstanceevent instance event instanceevent filter event filter request response request is async supported isasyncsupported equals ignore case equalsignorecase filter config filterconfig get filter def getfilterdef get async supported getasyncsupported request set attribute setattribute globals async supported attr globals security enabled servlet request servletrequest req request servlet response servletresponse res response principal principal http servlet request httpservletrequest req get user principal getuserprincipal object args object req res security util securityutil do as privilege doasprivilege do filter dofilter filter class type classtype args principal filter do filter dofilter request response support fire instance event fireinstanceevent instance event instanceevent filter event filter request response io exception ioexception filter support fire instance event fireinstanceevent instance event instanceevent filter event filter request response servlet exception servletexception filter support fire instance event fireinstanceevent instance event instanceevent filter event filter request response runtime exception runtimeexception filter support fire instance event fireinstanceevent instance event instanceevent filter event filter request response throwable exception utils exceptionutils unwrap invocation target exception unwrapinvocationtargetexception exception utils exceptionutils handle throwable handlethrowable filter support fire instance event fireinstanceevent instance event instanceevent filter event filter request response servlet exception servletexception get string getstring filter chain filterchain filter fell chain call servlet instance application dispatcher applicationdispatcher wrap object last service d request lastservicedrequest request last service d response lastservicedresponse response support fire instance event fireinstanceevent instance event instanceevent service event servlet request response request is async supported isasyncsupported support get wrapper getwrapper is async supported isasyncsupported request set attribute setattribute globals async supported attr wrapped request point request http servlet request httpservletrequest response http servlet response httpservletresponse globals security enabled servlet request servletrequest req request servlet response servletresponse res response principal principal http servlet request httpservletrequest req get user principal getuserprincipal object args object req res security util securityutil do as privilege doasprivilege service servlet class type used in service classtypeusedinservice args principal servlet service request response servlet service request response support fire instance event fireinstanceevent instance event instanceevent service event servlet request response io exception ioexception support fire instance event fireinstanceevent instance event instanceevent service event servlet request response servlet exception servletexception support fire instance event fireinstanceevent instance event instanceevent service event servlet request response runtime exception runtimeexception support fire instance event fireinstanceevent instance event instanceevent service event servlet request response throwable exception utils exceptionutils handle throwable handlethrowable support fire instance event fireinstanceevent instance event instanceevent service event servlet request response servlet exception servletexception get string getstring filter chain filterchain servlet application dispatcher applicationdispatcher wrap object last service d request lastservicedrequest last service d response lastservicedresponse process event security manager option enabled param event event process exception io exception ioexception input output error occurs exception servlet exception servletexception servlet exception occurs override do filter event dofilterevent comet event cometevent event io exception ioexception servlet exception servletexception globals security enabled comet event cometevent event java security access controller accesscontroller do privileged doprivileged java security privileged exception action privilegedexceptionaction override servlet exception servletexception io exception ioexception internal do filter event internaldofilterevent privileged action exception privilegedactionexception exception get exception getexception servlet exception servletexception servlet exception servletexception io exception ioexception io exception ioexception runtime exception runtimeexception runtime exception runtimeexception servlet exception servletexception get message getmessage internal do filter event internaldofilterevent event request passed servlet servicing current thread request service d serviced servlet request servletrequest get last service d request getlastservicedrequest last service d request lastservicedrequest response passed servlet servicing current thread response service d serviced servlet response servletresponse get last service d response getlastservicedresponse last service d response lastservicedresponse internal do filter event internaldofilterevent comet event cometevent event io exception ioexception servlet exception servletexception call filter pos application filter config applicationfilterconfig filter config filterconfig filters pos comet filter cometfilter filter filter comet filter cometfilter filter config filterconfig get filter getfilter globals security enabled comet event cometevent event principal principal get http servlet request gethttpservletrequest get user principal getuserprincipal object args object security util securityutil do as privilege doasprivilege do filter event dofilterevent filter comet class type cometclasstype args principal filter do filter event dofilterevent event support fire instance event fireinstanceevent instance event instanceevent filter event filter event io exception ioexception servlet exception servletexception runtime exception runtimeexception throwable exception utils exceptionutils unwrap invocation target exception unwrapinvocationtargetexception exception utils exceptionutils handle throwable handlethrowable servlet exception servletexception get string getstring filter chain filterchain filter fell chain call servlet instance support fire instance event fireinstanceevent instance event instanceevent service event servlet request response globals security enabled comet event cometevent event principal principal get http servlet request gethttpservletrequest get user principal getuserprincipal object args object security util securityutil do as privilege doasprivilege event servlet class type used in event classtypeusedinevent args principal comet processor cometprocessor servlet event event support fire instance event fireinstanceevent instance event instanceevent service event servlet request response io exception ioexception servlet exception servletexception runtime exception runtimeexception throwable exception utils exceptionutils handle throwable handlethrowable servlet exception servletexception get string getstring filter chain filterchain servlet methods add filter filters executed chain param filter config filterconfig filter config filterconfig servlet executed add filter addfilter application filter config applicationfilterconfig filter config filterconfig prevent filter multiple times application filter config applicationfilterconfig filter filters filter filter config filterconfig filters length application filter config applicationfilterconfig new filters newfilters application filter config applicationfilterconfig increment system arraycopy filters new filters newfilters filters new filters newfilters filters filter config filterconfig release references filters wrapper executed chain release filters pos servlet support prepare reuse filters wrapper executed chain reuse pos servlet executed chain param servlet wrapper servlet executed set servlet setservlet servlet servlet servlet servlet instance support instancesupport object event not ifications notifications filter chain param support instance support instancesupport object wrapper set support setsupport instance support instancesupport support support support
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina tcp java i o exception ioexception java util array list arraylist java util iterator java util list java util regex pattern java util regex pattern syntax exception patternsyntaxexception javax servlet servlet exception servletexception org apache catalina cluster org apache catalina context org apache catalina lifecycle exception lifecycleexception org apache catalina manager org apache catalina session org apache catalina connector request org apache catalina connector response org apache catalina core standard context standardcontext org apache catalina catalina cluster catalinacluster org apache catalina cluster manager clustermanager org apache catalina cluster message clustermessage org apache catalina cluster session clustersession org apache catalina cluster valve clustervalve org apache catalina session delta manager deltamanager org apache catalina session delta session deltasession org apache catalina valves valve base valvebase org apache tomcat util res string manager stringmanager implementation valve logs int eresting interesting contents request processing response processing debug ging debugging problems headers cookies valve attached container depending granularity logging perform primary indicator primaryindicator request attribute org apache catalina tcp is primary session isprimarysession request processing sessions primary node author craig mc clanahan mcclanahan author filip hanik author peter rossbach replication valve replicationvalve valve base valvebase cluster valve clustervalve org apache juli logging log log org apache juli logging log factory logfactory get log getlog replication valve replicationvalve instance variables descriptive implementation string info org apache catalina tcp replication valve replicationvalve string manager stringmanager string manager stringmanager string manager stringmanager get manager getmanager constants catalina cluster catalinacluster cluster filter expression pattern filter cross context crosscontext session container thread local threadlocal array list arraylist delta session deltasession cross context sessions crosscontextsessions thread local threadlocal array list arraylist delta session deltasession do processing stats doprocessingstats do processing stats doprocessingstats total request time totalrequesttime total send time totalsendtime nr of requests nrofrequests last send time lastsendtime nr of filter requests nroffilterrequests nr of send requests nrofsendrequests nr of cross context send requests nrofcrosscontextsendrequests primary change indicator primary indicator primaryindicator primary change indicator request attribute string primary indicator name primaryindicatorname org apache catalina tcp is primary session isprimarysession replication valve replicationvalve descriptive valve implementation override string get info getinfo info returns cluster override catalina cluster catalinacluster get cluster getcluster cluster param cluster cluster override set cluster setcluster catalina cluster catalinacluster cluster cluster cluster returns filter string get filter getfilter filter filter to string tostring compile filter string regular expression pattern compile java lang string param filter filter set filter setfilter string filter log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve filter loading filter filter filter length filter filter pattern compile filter pattern syntax exception patternsyntaxexception pse log error get string getstring replication valve replicationvalve filter failure filter pse returns primary indicator primaryindicator is primary indicator isprimaryindicator primary indicator primaryindicator param primary indicator primaryindicator primary indicator primaryindicator set primary indicator setprimaryindicator primary indicator primaryindicator primary indicator primaryindicator primary indicator primaryindicator returns primary indicator name primaryindicatorname string get primary indicator name getprimaryindicatorname primary indicator name primaryindicatorname param primary indicator name primaryindicatorname primary indicator name primaryindicatorname set primary indicator name setprimaryindicatorname string primary indicator name primaryindicatorname primary indicator name primaryindicatorname primary indicator name primaryindicatorname calc processing stats do statistics dostatistics do processing stats doprocessingstats calc processing stats reset statistics resetstatistics set statistics setstatistics do processing stats doprocessingstats do processing stats doprocessingstats do processing stats doprocessingstats returns last send time lastsendtime get last send time getlastsendtime last send time lastsendtime returns nr of requests nrofrequests get nr of requests getnrofrequests nr of requests nrofrequests returns nr of filter requests nroffilterrequests get nr of filter requests getnroffilterrequests nr of filter requests nroffilterrequests returns nr of cross context send requests nrofcrosscontextsendrequests get nr of cross context send requests getnrofcrosscontextsendrequests nr of cross context send requests nrofcrosscontextsendrequests returns nr of send requests nrofsendrequests get nr of send requests getnrofsendrequests nr of send requests nrofsendrequests returns total request time totalrequesttime get total request time gettotalrequesttime total request time totalrequesttime returns total send time totalsendtime get total send time gettotalsendtime total send time totalsendtime methods register cross context sessions end access endaccess list check port let portlet api include lot fragments applications session param session cross context session register replication session registerreplicationsession delta session deltasession session list delta session deltasession sessions cross context sessions crosscontextsessions sessions sessions session log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve cross context crosscontext register session registersession session get id internal getidinternal session get manager getmanager get container getcontainer get name getname sessions add session log int eresting interesting request parameters invoke valve sequence log int eresting interesting response parameters param request servlet request processed param response servlet response created exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs override invoke request request response response i o exception ioexception servlet exception servletexception totalstart request do statistics dostatistics totalstart system current time millis currenttimemillis primary indicator primaryindicator create primary indicator createprimaryindicator request context context request get context getcontext is cross context iscrosscontext context context standard context standardcontext standard context standardcontext context get cross context getcrosscontext is cross context iscrosscontext log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve cross context crosscontext add fixme add pool array lists arraylists cross context sessions crosscontextsessions array list arraylist delta session deltasession get next getnext invoke request response context cluster context get manager getmanager cluster manager clustermanager cluster manager clustermanager cluster manager clustermanager cluster manager clustermanager context get manager getmanager host level cluster get manager getmanager cluster manager clustermanager get name getname cluster has members hasmembers send replication message sendreplicationmessage request totalstart is cross context iscrosscontext cluster manager clustermanager cluster reset replication request resetreplicationrequest request is cross context iscrosscontext don register request session is cross context iscrosscontext log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve cross context crosscontext remove cross context sessions crosscontextsessions remove exist java register array list arraylist pool cross context sessions crosscontextsessions reset active statistics reset statistics resetstatistics total request time totalrequesttime total send time totalsendtime last send time lastsendtime nr of filter requests nroffilterrequests nr of requests nrofrequests nr of send requests nrofsendrequests nr of cross context send requests nrofcrosscontextsendrequests start component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception cluster cluster container cluster containercluster get container getcontainer get cluster getcluster container cluster containercluster catalina cluster catalinacluster set cluster setcluster catalina cluster catalinacluster container cluster containercluster log is warn enabled iswarnenabled log warn get string getstring replication valve replicationvalve nocluster start internal startinternal methods param request param totalstart param is cross context iscrosscontext param cluster manager clustermanager param container cluster containercluster send replication message sendreplicationmessage request request totalstart is cross context iscrosscontext cluster manager clustermanager cluster manager clustermanager catalina cluster catalinacluster container cluster containercluster request start do statistics dostatistics start system current time millis currenttimemillis delta manager deltamanager returns string cluster manager clustermanager delta manager deltamanager send invalid sessions sendinvalidsessions cluster manager clustermanager container cluster containercluster send replication send session replication message sendsessionreplicationmessage request cluster manager clustermanager container cluster containercluster is cross context iscrosscontext send cross context session sendcrosscontextsession container cluster containercluster exception log error get string getstring replication valve replicationvalve send failure fixme stats update cheap do statistics dostatistics update stats updatestats totalstart start send changed cross context sessions back ups backups param container cluster containercluster send cross context session sendcrosscontextsession catalina cluster catalinacluster container cluster containercluster list delta session deltasession sessions cross context sessions crosscontextsessions sessions sessions size iterator delta session deltasession iter sessions iterator iter has next hasnext session session iter log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve cross context crosscontext send delta senddelta session get manager getmanager get container getcontainer get name getname send message sendmessage session cluster manager clustermanager session get manager getmanager container cluster containercluster do statistics dostatistics nr of cross context send requests nrofcrosscontextsendrequests memory leak sessions backup member exists param request current request response generated param is cross context iscrosscontext check cross context crosscontext thread local threadlocal reset replication request resetreplicationrequest request request is cross context iscrosscontext session context session contextsession request get session internal getsessioninternal context session contextsession delta session deltasession reset delta request resetdeltarequest context session contextsession delta session deltasession context session contextsession set primary session setprimarysession is cross context iscrosscontext list delta session deltasession sessions cross context sessions crosscontextsessions sessions sessions size iterator delta session deltasession iter sessions iterator iter has next hasnext session session iter reset delta request resetdeltarequest session session delta session deltasession delta session deltasession context session contextsession set primary session setprimarysession reset delta request deltarequest session param session http session httpsession current request cross context session reset delta request resetdeltarequest session session log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve reset delta request resetdeltarequest session get manager getmanager get container getcontainer get name getname delta session deltasession session reset delta request resetdeltarequest send cluster replication request param request current request param manager session manager param cluster replication cluster send session replication message sendsessionreplicationmessage request request cluster manager clustermanager manager catalina cluster catalinacluster cluster session session request get session internal getsessioninternal session string uri request get decoded request i getdecodedrequesturi request session change is request without session change isrequestwithoutsessionchange uri log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve invoke uri uri send message sendmessage session manager cluster do statistics dostatistics nr of filter requests nroffilterrequests send message delta message request session param session current session param manager session manager param cluster replication cluster send message sendmessage session session cluster manager clustermanager manager catalina cluster catalinacluster cluster string session get id internal getidinternal send manager cluster send manager request completed requestcompleted message cluster param manager session manager sessionmanager param cluster replication cluster param session id sessionid session id sessionid manager delta manager deltamanager request completed requestcompleted string simple tcp cluster simpletcpcluster send cluster message clustermessage send cluster manager clustermanager manager catalina cluster catalinacluster cluster string session id sessionid cluster message clustermessage msg manager request completed requestcompleted session id sessionid msg cluster send msg do statistics dostatistics nr of send requests nrofsendrequests check session invalid ations invalidations param manager param cluster send invalid sessions sendinvalidsessions cluster manager clustermanager manager catalina cluster catalinacluster cluster string invalid ids invalidids manager get invalid ated sessions getinvalidatedsessions invalid ids invalidids length invalid ids invalidids length send manager cluster invalid ids invalidids exception log error get string getstring replication valve replicationvalve send invalid failure invalid ids invalidids request session change param uri request uri session change is request without session change isrequestwithoutsessionchange string uri pattern filter matcher uri matches protocol cluster rep lications replications stats param request time requesttime param cluster time clustertime update stats updatestats request time requesttime cluster time clustertime stats handle last send time lastsendtime system current time millis currenttimemillis total send time totalsendtime last send time lastsendtime cluster time clustertime total request time totalrequesttime last send time lastsendtime request time requesttime nr of requests nrofrequests log is info enabled isinfoenabled nr of requests nrofrequests log info get string getstring replication valve replicationvalve stats object value of valueof total request time totalrequesttime nr of requests nrofrequests value of valueof total send time totalsendtime nr of requests nrofrequests value of valueof nr of requests nrofrequests value of valueof nr of send requests nrofsendrequests value of valueof nr of cross context send requests nrofcrosscontextsendrequests value of valueof nr of filter requests nroffilterrequests value of valueof total request time totalrequesttime value of valueof total send time totalsendtime mark request processed primary node attribute primary indicator name primaryindicatorname param request i o exception ioexception create primary indicator createprimaryindicator request request i o exception ioexception string request get requested session id getrequestedsessionid length manager manager request get context getcontext get manager getmanager session session manager find session findsession session cluster session clustersession cluster session clustersession cses cluster session clustersession session log is debug enabled isdebugenabled log debug get string getstring replication valve replicationvalve session indicator request get context getcontext get name getname primary indicator name primaryindicatorname value of valueof cses is primary session isprimarysession request set attribute setattribute primary indicator name primaryindicatorname cses is primary session isprimarysession log is debug enabled isdebugenabled session log debug get string getstring replication valve replicationvalve session request get context getcontext get name getname log debug get string getstring replication valve replicationvalve session invalid request get context getcontext get name getname
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java lang reflect field java security message digest messagedigest java security principal javax naming naming enumeration namingenumeration javax naming naming exception namingexception javax naming directory basic attributes basicattributes javax naming directory dir context dircontext javax naming directory initial dir context initialdircontext javax naming directory search controls searchcontrols javax naming directory search result searchresult org junit org junit before class beforeclass org junit test org apache catalina context org apache catalina lifecycle exception lifecycleexception org apache naming name parser impl nameparserimpl org apache tomcat unit test unittest tester context testercontext org apache tomcat util security encoder org easymock easy mock easymock testjndirealm string algorithm string user test user string password test password string realm test realm string non ce nonce test non ce nonce string test string user password attr test pwd message digest messagedigest helper before class beforeclass setup class setupclass exception helper message digest messagedigest get instance getinstance algorithm test test authenticate without user password testauthenticatewithoutuserpassword exception jndi realm jndirealm realm build realm buildrealm password string expected response expectedresponse encoder encode helper digest non ce nonce get bytes getbytes principal principal realm authenticate user expected response expectedresponse non ce nonce realm assert null assertnull principal test test authenticate with user password testauthenticatewithuserpassword exception jndi realm jndirealm realm build realm buildrealm password realm set user password setuserpassword user password attr string expected response expectedresponse encoder encode helper digest non ce nonce get bytes getbytes principal principal realm authenticate user expected response expectedresponse non ce nonce realm assert true asserttrue principal generic principal genericprincipal assert equals assertequals password generic principal genericprincipal principal get password getpassword test test authenticate with user password and digest testauthenticatewithuserpasswordanddigest exception jndi realm jndirealm realm build realm buildrealm realm set user password setuserpassword user password attr string expected response expectedresponse encoder encode helper digest non ce nonce get bytes getbytes principal principal realm authenticate user expected response expectedresponse non ce nonce realm assert true asserttrue principal generic principal genericprincipal assert equals assertequals generic principal genericprincipal principal get password getpassword jndi realm jndirealm build realm buildrealm string password string digest javax naming naming exception namingexception no such field exception nosuchfieldexception illegal access exception illegalaccessexception lifecycle exception lifecycleexception context context tester context testercontext jndi realm jndirealm realm jndi realm jndirealm realm set container setcontainer context realm set user search setusersearch realm set digest setdigest digest field field jndi realm jndirealm get declared field getdeclaredfield context field set accessible setaccessible field realm mock dir context mockdircontext mock search results mocksearchresults password realm start realm naming enumeration namingenumeration search result searchresult mock search results mocksearchresults string password naming exception namingexception suppress warnings suppresswarnings unchecked naming enumeration namingenumeration search result searchresult search results searchresults easy mock easymock create nice mock createnicemock naming enumeration namingenumeration easy mock easymock expect value of valueof search results searchresults has more hasmore and return andreturn and return andreturn and return andreturn and return andreturn easy mock easymock expect search results searchresults and return andreturn search result searchresult result basic attributes basicattributes user password attr password times easy mock easymock replay search results searchresults search results searchresults dir context dircontext mock dir context mockdircontext naming enumeration namingenumeration search result searchresult naming enumeration namingenumeration naming exception namingexception dir context dircontext dir context dircontext easy mock easymock create nice mock createnicemock initial dir context initialdircontext easy mock easymock expect dir context dircontext search easy mock easymock any string anystring easy mock easymock any string anystring easy mock easymock any object anyobject search controls searchcontrols and return andreturn naming enumeration namingenumeration times easy mock easymock expect dir context dircontext get name parser getnameparser and return andreturn name parser impl nameparserimpl times easy mock easymock expect dir context dircontext get name in name space getnameinnamespace and return andreturn times easy mock easymock replay dir context dircontext dir context dircontext string string user realm password encoder encode helper digest get bytes getbytes
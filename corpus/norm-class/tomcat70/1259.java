licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java beans int rospector introspector java io exception ioexception java input stream inputstream java lang annotation annotation java lang reflect field java lang reflect invocation target exception invocationtargetexception java lang reflect method java security access controller accesscontroller java security privileged action privilegedaction java security privileged action exception privilegedactionexception java security privileged exception action privilegedexceptionaction java util array list arraylist java util collections java util hash map hashmap java util hash set hashset java util list java util map java util properties java util java util weak hash map weakhashmap javax annotation post construct postconstruct javax annotation pre destroy predestroy javax annotation resource javax ejb ejb javax naming context javax naming naming exception namingexception javax persistence persistence context persistencecontext javax persistence persistence unit persistenceunit javax xml web service ref webserviceref org apache catalina container servlet containerservlet org apache catalina globals org apache catalina security security util securityutil org apache catalina util int rospection introspection org apache juli logging log org apache tomcat instance manager instancemanager org apache tomcat util exception utils exceptionutils org apache tomcat util res string manager stringmanager default instance manager defaultinstancemanager instance manager instancemanager annotations annotation cache entry annotationcacheentry annotations empty annotation cache entry annotationcacheentry string manager string manager stringmanager string manager stringmanager get manager getmanager constants context context map string map string string injection map injectionmap class loader classloader class loader classloader class loader classloader container class loader containerclassloader privileged ignore annotations ignoreannotations string restricted classes restrictedclasses map annotation cache entry annotationcacheentry annotation cache annotationcache weak hash map weakhashmap annotation cache entry annotationcacheentry map string string post construct methods postconstructmethods map string string pre destroy methods predestroymethods default instance manager defaultinstancemanager context context map string map string string injection map injectionmap org apache catalina context catalina context catalinacontext class loader classloader container class loader containerclassloader class loader classloader catalina context catalinacontext get loader getloader get class loader getclassloader privileged catalina context catalinacontext get privileged getprivileged container class loader containerclassloader container class loader containerclassloader ignore annotations ignoreannotations catalina context catalinacontext get ignore annotations getignoreannotations log log catalina context catalinacontext get logger getlogger string class names classnames hash set hashset string load properties loadproperties class names classnames org apache catalina core restricted servlets restrictedservlets properties default instance manager defaultinstancemanager restricted servlets resource restrictedservletsresource log load properties loadproperties class names classnames org apache catalina core restricted listeners restrictedlisteners properties default instance manager defaultinstancemanager restricted listeners resource restrictedlistenersresource log load properties loadproperties class names classnames org apache catalina core restricted filters restrictedfilters properties default instance manager defaultinstancemanager restricted filters resource restrictedfiltersresource log restricted classes restrictedclasses collections unmodifiable set unmodifiableset class names classnames context context injection map injectionmap injection map injectionmap post construct methods postconstructmethods catalina context catalinacontext find post construct methods findpostconstructmethods pre destroy methods predestroymethods catalina context catalinacontext find pre destroy methods findpredestroymethods override object new instance newinstance clazz illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception instantiation exception instantiationexception new instance newinstance clazz new instance newinstance clazz override object new instance newinstance string class name classname illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception instantiation exception instantiationexception class not found exception classnotfoundexception clazz load class may be privileged loadclassmaybeprivileged class name classname class loader classloader new instance newinstance clazz new instance newinstance clazz override object new instance newinstance string class name classname class loader classloader class loader classloader illegal access exception illegalaccessexception naming exception namingexception invocation target exception invocationtargetexception instantiation exception instantiationexception class not found exception classnotfoundexception clazz class loader classloader load class loadclass class name classname new instance newinstance clazz new instance newinstance clazz override new instance newinstance object illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception new instance newinstance get class getclass object new instance newinstance object instance clazz illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception ignore annotations ignoreannotations map string string injections assemble inject ions from class hierarchy assembleinjectionsfromclasshierarchy clazz populate annotations cache populateannotationscache clazz injections process annotations processannotations instance injections post construct postconstruct instance clazz instance map string string assemble inject ions from class hierarchy assembleinjectionsfromclasshierarchy clazz map string string injections hash map hashmap string string map string string current inject ions currentinjections clazz current inject ions currentinjections injection map injectionmap clazz get name getname current inject ions currentinjections injections put all putall current inject ions currentinjections clazz clazz get superclass getsuperclass injections override destroy instance destroyinstance object instance illegal access exception illegalaccessexception invocation target exception invocationtargetexception ignore annotations ignoreannotations pre destroy predestroy instance instance get class getclass call post construct postconstruct method instance recursively deepest superclass actual param instance object call post construct postconstruct methods param clazz examine post construct postconstruct annotation illegal access exception illegalaccessexception post construct postconstruct method inaccessible java lang reflect invocation target exception invocationtargetexception call fails post construct postconstruct object instance clazz illegal access exception illegalaccessexception invocation target exception invocationtargetexception context resource injection super class superclass clazz get superclass getsuperclass super class superclass object post construct postconstruct instance super class superclass post construct postconstruct annotated method invoked annotation cache entry annotationcacheentry annotations annotation cache annotationcache annotations annotation cache annotationcache clazz annotation cache entry annotationcacheentry entry annotations entry get type gettype annotation cache entry type annotationcacheentrytype post construct method post construct postconstruct get method getmethod clazz entry post construct postconstruct accessibility post construct postconstruct is accessible isaccessible post construct postconstruct set accessible setaccessible post construct postconstruct invoke instance post construct postconstruct set accessible setaccessible accessibility call pre destroy predestroy method instance recursively deepest superclass actual param instance object call pre destroy predestroy methods param clazz examine pre destroy predestroy annotation illegal access exception illegalaccessexception pre destroy predestroy method inaccessible java lang reflect invocation target exception invocationtargetexception call fails pre destroy predestroy object instance clazz illegal access exception illegalaccessexception invocation target exception invocationtargetexception super class superclass clazz get superclass getsuperclass super class superclass object pre destroy predestroy instance super class superclass post construct postconstruct annotated method invoked annotation cache entry annotationcacheentry annotations annotation cache annotationcache annotations annotation cache annotationcache clazz annotations instance created instance manager annotation cache entry annotationcacheentry entry annotations entry get type gettype annotation cache entry type annotationcacheentrytype pre destroy method pre destroy predestroy get method getmethod clazz entry pre destroy predestroy accessibility pre destroy predestroy is accessible isaccessible pre destroy predestroy set accessible setaccessible pre destroy predestroy invoke instance pre destroy predestroy set accessible setaccessible accessibility annotations cache pop ulated populated param clazz clazz populate annotations param injections map injections xml deployment descriptor illegal access exception illegalaccessexception injection target inaccessible javax naming naming exception namingexception looked jndi java lang reflect invocation target exception invocationtargetexception injection fails populate annotations cache populateannotationscache clazz map string string injections illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception list annotation cache entry annotationcacheentry annotations clazz annotation cache entry annotationcacheentry annotations array annotationsarray annotation cache annotationcache annotations array annotationsarray annotation cache annotationcache clazz annotations array annotationsarray annotations annotations array list arraylist annotation cache entry annotationcacheentry annotations clear context initialize fields annotations resource injection jndi enabled field fields int rospection introspection get declared fields getdeclaredfields clazz field field fields resource resource annotation resourceannotation ejb ejb annotation ejbannotation web service ref webserviceref web service ref annotation webservicerefannotation persistence context persistencecontext persistence context annotation persistencecontextannotation persistence unit persistenceunit persistence unit annotation persistenceunitannotation injections injections contains key containskey field get name getname annotations add annotation cache entry annotationcacheentry field get name getname injections field get name getname annotation cache entry type annotationcacheentrytype field resource annotation resourceannotation field get annotation getannotation resource annotations add annotation cache entry annotationcacheentry field get name getname resource annotation resourceannotation annotation cache entry type annotationcacheentrytype field ejb annotation ejbannotation field get annotation getannotation ejb annotations add annotation cache entry annotationcacheentry field get name getname ejb annotation ejbannotation annotation cache entry type annotationcacheentrytype field web service ref annotation webservicerefannotation field get annotation getannotation web service ref webserviceref annotations add annotation cache entry annotationcacheentry field get name getname web service ref annotation webservicerefannotation annotation cache entry type annotationcacheentrytype field persistence context annotation persistencecontextannotation field get annotation getannotation persistence context persistencecontext annotations add annotation cache entry annotationcacheentry field get name getname persistence context annotation persistencecontextannotation annotation cache entry type annotationcacheentrytype field persistence unit annotation persistenceunitannotation field get annotation getannotation persistence unit persistenceunit annotations add annotation cache entry annotationcacheentry field get name getname persistence unit annotation persistenceunitannotation annotation cache entry type annotationcacheentrytype field initialize methods annotations method methods int rospection introspection get declared methods getdeclaredmethods clazz method post construct postconstruct string post construct from xml postconstructfromxml post construct methods postconstructmethods clazz get name getname method pre destroy predestroy string pre destroy from xml predestroyfromxml pre destroy methods predestroymethods clazz get name getname method method methods context resource injection jndi enabled injections int rospection introspection is valid setter isvalidsetter method string field name fieldname int rospection introspection get property name getpropertyname method injections contains key containskey field name fieldname annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes injections field name fieldname annotation cache entry type annotationcacheentrytype setter resource resource annotation resourceannotation ejb ejb annotation ejbannotation web service ref webserviceref web service ref annotation webservicerefannotation persistence context persistencecontext persistence context annotation persistencecontextannotation persistence unit persistenceunit persistence unit annotation persistenceunitannotation resource annotation resourceannotation method get annotation getannotation resource annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes resource annotation resourceannotation annotation cache entry type annotationcacheentrytype setter ejb annotation ejbannotation method get annotation getannotation ejb annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes ejb annotation ejbannotation annotation cache entry type annotationcacheentrytype setter web service ref annotation webservicerefannotation method get annotation getannotation web service ref webserviceref annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes web service ref annotation webservicerefannotation annotation cache entry type annotationcacheentrytype setter persistence context annotation persistencecontextannotation method get annotation getannotation persistence context persistencecontext annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes persistence context annotation persistencecontextannotation annotation cache entry type annotationcacheentrytype setter persistence unit annotation persistenceunitannotation method get annotation getannotation persistence unit persistenceunit annotations add annotation cache entry annotationcacheentry method get name getname method get parameter types getparametertypes persistence unit annotation persistenceunitannotation annotation cache entry type annotationcacheentrytype setter post construct postconstruct find post construct findpostconstruct post construct postconstruct post construct from xml postconstructfromxml method pre destroy predestroy find pre destroy findpredestroy pre destroy predestroy pre destroy from xml predestroyfromxml method post construct postconstruct annotations add annotation cache entry annotationcacheentry post construct postconstruct get name getname post construct postconstruct get parameter types getparametertypes annotation cache entry type annotationcacheentrytype post construct post construct from xml postconstructfromxml illegal argument exception illegalargumentexception post construct method post construct from xml postconstructfromxml clazz get name getname declared deployment descriptor pre destroy predestroy annotations add annotation cache entry annotationcacheentry pre destroy predestroy get name getname pre destroy predestroy get parameter types getparametertypes annotation cache entry type annotationcacheentrytype pre destroy pre destroy from xml predestroyfromxml illegal argument exception illegalargumentexception pre destroy method pre destroy from xml predestroyfromxml clazz get name getname declared deployment descriptor annotations is empty isempty common object save memory annotations array annotationsarray annotations empty annotations array annotationsarray annotations to array toarray annotation cache entry annotationcacheentry annotations size annotation cache annotationcache annotation cache annotationcache clazz annotations array annotationsarray clazz clazz get superclass getsuperclass inject resources instance param instance instance inject param injections map injections xml deployment descriptor illegal access exception illegalaccessexception injection target inaccessible javax naming naming exception namingexception looked jndi java lang reflect invocation target exception invocationtargetexception injection fails process annotations processannotations object instance map string string injections illegal access exception illegalaccessexception invocation target exception invocationtargetexception naming exception namingexception context resource injection clazz instance get class getclass clazz annotation cache entry annotationcacheentry annotations annotation cache annotationcache annotations annotation cache annotationcache clazz annotation cache entry annotationcacheentry entry annotations entry get type gettype annotation cache entry type annotationcacheentrytype setter lookup method resource lookupmethodresource context instance get method getmethod clazz entry entry get name getname clazz entry get type gettype annotation cache entry type annotationcacheentrytype field lookup field resource lookupfieldresource context instance get field getfield clazz entry entry get name getname clazz clazz clazz get superclass getsuperclass cache size unit tests get annotation cache size getannotationcachesize annotation cache annotationcache annotation cache annotationcache size load class may be privileged loadclassmaybeprivileged string class name classname class loader classloader class loader classloader class not found exception classnotfoundexception clazz security util securityutil is package protection enabled ispackageprotectionenabled clazz access controller accesscontroller do privileged doprivileged privileged exception action privilegedexceptionaction override exception load class loadclass class name classname class loader classloader privileged action exception privilegedactionexception throwable get cause getcause class not found exception classnotfoundexception class not found exception classnotfoundexception runtime exception runtimeexception clazz load class loadclass class name classname class loader classloader check access checkaccess clazz clazz load class loadclass string class name classname class loader classloader class loader classloader class not found exception classnotfoundexception class name classname starts with startswith org apache catalina container class loader containerclassloader load class loadclass class name classname clazz container class loader containerclassloader load class loadclass class name classname container servlet containerservlet is assignable from isassignablefrom clazz clazz throwable exception utils exceptionutils handle throwable handlethrowable class loader classloader load class loadclass class name classname check access checkaccess clazz privileged container servlet containerservlet is assignable from isassignablefrom clazz security exception securityexception get string getstring default instance manager defaultinstancemanager restricted container servlet restrictedcontainerservlet clazz clazz restricted classes restrictedclasses clazz get name getname security exception securityexception get string getstring default instance manager defaultinstancemanager restricted class restrictedclass clazz clazz clazz get superclass getsuperclass inject resources field param context jndi context extract param instance object inject param field field target injection param jndi bound param clazz annotation defined illegal access exception illegalaccessexception field inaccessible javax naming naming exception namingexception accessible naming context lookup field resource lookupfieldresource context context object instance field field string clazz naming exception namingexception illegal access exception illegalaccessexception object look edup resource lookedupresource accessibility string normalized name normalizedname normalize normalized name normalizedname normalized name normalizedname length look edup resource lookedupresource context lookup normalized name normalizedname look edup resource lookedupresource context lookup clazz get name getname field get name getname field accessibility field is accessible isaccessible field set accessible setaccessible field instance look edup resource lookedupresource field set accessible setaccessible accessibility inject resources method param context jndi context extract param instance object inject param method field target injection param jndi bound param clazz annotation defined illegal access exception illegalaccessexception method inaccessible javax naming naming exception namingexception accessible naming context java lang reflect invocation target exception invocationtargetexception set ter setter call fails lookup method resource lookupmethodresource context context object instance method method string clazz naming exception namingexception illegal access exception illegalaccessexception invocation target exception invocationtargetexception int rospection introspection is valid setter isvalidsetter method illegal argument exception illegalargumentexception get string getstring default instance manager defaultinstancemanager invalid injection invalidinjection object look edup resource lookedupresource accessibility string normalized name normalizedname normalize normalized name normalizedname normalized name normalizedname length look edup resource lookedupresource context lookup normalized name normalizedname look edup resource lookedupresource context lookup clazz get name getname int rospection introspection get property name getpropertyname method method accessibility method is accessible isaccessible method set accessible setaccessible method invoke instance look edup resource lookedupresource method set accessible setaccessible accessibility deprecated string get name getname method set ter setter method starts int rospector introspector decapitalize set ter setter get name getname substring load properties loadproperties string class names classnames string resource name resourcename string message key messagekey log log properties properties properties class loader classloader default instance manager defaultinstancemanager get class loader getclassloader input stream inputstream get resource as stream getresourceasstream resource name resourcename log error get string getstring message key messagekey resource name resourcename properties load io exception ioexception ioe log error get string getstring message key messagekey resource name resourcename ioe close io exception ioexception properties is empty isempty map entry object object properties entry set entryset restricted equals get value getvalue class names classnames add get key getkey to string tostring log warn get string getstring default instance manager defaultinstancemanager restricted wrong value restrictedwrongvalue resource name resourcename get key getkey get value getvalue string normalize string jndi name jndiname jndi name jndiname jndi name jndiname starts with startswith java comp env jndi name jndiname substring jndi name jndiname method get method getmethod clazz annotation cache entry annotationcacheentry entry method result globals security enabled result access controller accesscontroller do privileged doprivileged privileged action privilegedaction method override method method result result clazz get declared method getdeclaredmethod entry get accessible object name getaccessibleobjectname entry get param types getparamtypes no such method exception nosuchmethodexception result result clazz get declared method getdeclaredmethod entry get accessible object name getaccessibleobjectname entry get param types getparamtypes no such method exception nosuchmethodexception result field get field getfield clazz annotation cache entry annotationcacheentry entry field result globals security enabled result access controller accesscontroller do privileged doprivileged privileged action privilegedaction field override field field result result clazz get declared field getdeclaredfield entry get accessible object name getaccessibleobjectname no such field exception nosuchfieldexception result result clazz get declared field getdeclaredfield entry get accessible object name getaccessibleobjectname no such field exception nosuchfieldexception result method find post construct findpostconstruct method current post construct currentpostconstruct string post construct from xml postconstructfromxml method method find lifecycle callback findlifecyclecallback current post construct currentpostconstruct post construct from xml postconstructfromxml method post construct postconstruct method find pre destroy findpredestroy method current pre destroy currentpredestroy string pre destroy from xml predestroyfromxml method method find lifecycle callback findlifecyclecallback current pre destroy currentpredestroy pre destroy from xml predestroyfromxml method pre destroy predestroy method find lifecycle callback findlifecyclecallback method current method currentmethod string method name from xml methodnamefromxml method method annotation annotation method result current method currentmethod method name from xml methodnamefromxml method get name getname equals method name from xml methodnamefromxml int rospection introspection is valid lifecycle callback isvalidlifecyclecallback method illegal argument exception illegalargumentexception invalid annotation get name getname annotation result method method is annotation present isannotationpresent annotation current method currentmethod int rospection introspection is valid lifecycle callback isvalidlifecyclecallback method illegal argument exception illegalargumentexception invalid annotation get name getname annotation result method result annotation cache entry annotationcacheentry string accessible object name accessibleobjectname param types paramtypes string annotation cache entry type annotationcacheentrytype type annotation cache entry annotationcacheentry string accessible object name accessibleobjectname param types paramtypes string annotation cache entry type annotationcacheentrytype type accessible object name accessibleobjectname accessible object name accessibleobjectname param types paramtypes param types paramtypes type type string get accessible object name getaccessibleobjectname accessible object name accessibleobjectname get param types getparamtypes param types paramtypes string get name getname annotation cache entry type annotationcacheentrytype get type gettype type enum annotation cache entry type annotationcacheentrytype field setter post construct pre destroy
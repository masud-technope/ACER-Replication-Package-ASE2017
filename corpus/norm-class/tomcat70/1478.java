licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache jasper compiler java file java file input stream fileinputstream java i o exception ioexception java input stream inputstream java net jarurlconnection java net url java util hash set hashset java util hashtable java util iterator java util java util string tokenizer stringtokenizer javax servlet servlet context servletcontext org apache jasper constants org apache jasper jasper exception jasperexception org apache jasper runtime exception utils exceptionutils org apache jasper xml parser xmlparser parser utils parserutils org apache jasper xml parser xmlparser tree node treenode org apache juli logging log org apache juli logging log factory logfactory org apache tomcat jar scanner jarscanner org apache tomcat jar scanner callback jarscannercallback org apache tomcat util scan jar org apache tomcat util scan jar factory jarfactory tld locations cache tldlocationscache log log log factory logfactory get log getlog tld locations cache tldlocationscache string key tld locations cache tldlocationscache get name getname types uri tag library abs uri root rel uri noroot rel uri string web inf web inf string web inf lib web inf lib string jar ext jar string tld ext tld names jar s jars tld s tlds string no tld jars notldjars flag info level message jar s jars skipped show tld scan warning showtldscanwarning list jar s jars skip tld s tlds list jar s jars skip tld s tlds string builder stringbuilder jar list jarlist string builder stringbuilder system get property getproperty constants jar skip prop string tld jars tldjars system get property getproperty constants tld jar skip prop tld jars tldjars length jar list jarlist length jar list jarlist append jar list jarlist append tld jars tldjars jar list jarlist length set no tld jars setnotldjars jar list jarlist to string tostring sets list jar s jars tld s tlds param jar names jarnames list comma separated names jar files tld s tlds set no tld jars setnotldjars string jar names jarnames jar names jarnames no tld jars notldjars no tld jars notldjars no tld jars notldjars hash set hashset string no tld jars notldjars clear string tokenizer stringtokenizer tokenizer string tokenizer stringtokenizer jar names jarnames tokenizer has more elements hasmoreelements string token tokenizer next token nexttoken trim token length no tld jars notldjars add token mapping global tag library uri location resource path tld tag library location returned string array location location jar file location tld hashtable string tld location tldlocation mappings initialized servlet context servletcontext ctxt constructor param ctxt servlet context web application jasper running tld locations cache tldlocationscache servlet context servletcontext ctxt ctxt ctxt mappings hashtable string tld location tldlocation initialized obtains tld location cache link servlet context servletcontext creates exist tld locations cache tldlocationscache get instance getinstance servlet context servletcontext ctxt ctxt illegal argument exception illegalargumentexception servlet context servletcontext tld locations cache tldlocationscache cache tld locations cache tldlocationscache ctxt get attribute getattribute key cache cache tld locations cache tldlocationscache ctxt ctxt set attribute setattribute key cache cache location tld taglib uri returns uri tag library exposed web application tag library exposed explicitly web xml impl icitly implicitly uri tag tld taglib deployed jar file web inf lib param uri taglib uri array strings element denotes real path tld path tld points jar file element denotes tld entry jar file returns uri tag library exposed web application tld location tldlocation get location getlocation string uri jasper exception jasperexception initialized init mappings uri returns type uri abs uri root rel uri noroot rel uri uri type uritype string uri uri index of indexof abs uri uri starts with startswith root rel uri noroot rel uri processing order sync startup tld config tldconfig supports tomcat specific extension tld search order defined jsp spec tag libraries package d packaged jar files shared web applications simply drop ping dropping location web applications access catalina lib supports weird won derful wonderful arr angements arrangements tomcat embedded init jasper exception jasperexception initialized tld scan web xml tldscanwebxml tld scan resource paths tldscanresourcepaths web inf jar scanner jarscanner jar scanner jarscanner jar scanner factory jarscannerfactory get jar scanner getjarscanner ctxt jar scanner jarscanner scan ctxt thread current thread currentthread get context class loader getcontextclassloader tld jar scanner callback tldjarscannercallback no tld jars notldjars initialized exception jasper exception jasperexception localizer get message getmessage jsp error internal tld init tldinit get message getmessage tld jar scanner callback tldjarscannercallback jar scanner callback jarscannercallback override scan jarurlconnection url conn urlconn i o exception ioexception tld scan jar tldscanjar url conn urlconn override scan file file i o exception ioexception file meta inf metainf file file meta inf meta inf metainf is directory isdirectory tld scan dir tldscandir meta inf metainf pop ulates populates taglib map web xml sync startup tld config tldconfig jasper uri tld mappings scan web xml tld config tldconfig scan actual tld files tld scan web xml tldscanwebxml exception web xml webxml web xml webxml web xml webxml web xml webxml ctxt web xml webxml get input source getinputsource validate parse boolean parseboolean ctxt get init parameter getinitparameter constants xml validation init param string block external string blockexternalstring ctxt get init parameter getinitparameter constants xml block external init param block external blockexternal block external string blockexternalstring block external blockexternal block external blockexternal parse boolean parseboolean block external string blockexternalstring parse web application deployment descriptor parser utils parserutils parser utils parserutils validate block external blockexternal tree node treenode web tld webtld web tld webtld parsexmldocument web xml webxml get system id getsystemid web xml webxml get input source getinputsource taglib element root jsp config jsp tree node treenode jsp config jspconfig web tld webtld find child findchild jsp config jsp config jspconfig web tld webtld jsp config jspconfig iterator tree node treenode tag libs taglibs web tld webtld find children findchildren taglib tag libs taglibs has next hasnext parse taglib element tree node treenode taglib tag libs taglibs string tag uri taguri string tag loc tagloc tree node treenode child taglib find child findchild taglib uri child tag uri taguri child get body getbody child taglib find child findchild taglib location child tag loc tagloc child get body getbody save location tag loc tagloc uri type uritype tag loc tagloc noroot rel uri tag loc tagloc web inf tag loc tagloc tld location tldlocation location tag loc tagloc ends with endswith jar ext location tld location tldlocation meta inf taglib tld ctxt get resource getresource tag loc tagloc to string tostring location tld location tldlocation tag loc tagloc mappings tag uri taguri location web xml webxml web xml webxml close s cans scans web application directory identified start path startpath directories tld s tlds adds implicit map entry taglib map tld uri element init ially initially root path rootpath equals web inf web inf classes web inf lib directories excluded search jsp spec code sync startup tld config tldconfig tld scan resource paths tldscanresourcepaths string start path startpath exception string dir list dirlist ctxt get resource paths getresourcepaths start path startpath dir list dirlist iterator string dir list dirlist iterator has next hasnext string path path ends with endswith tld ext path starts with startswith web inf lib path starts with startswith web inf classes path ends with endswith tld ext path starts with startswith web inf tags path ends with endswith implicit tld input stream inputstream stream ctxt get resource as stream getresourceasstream path tld scan stream tldscanstream path stream stream stream close throwable exception utils exceptionutils handle throwable handlethrowable tld scan resource paths tldscanresourcepaths path s cans scans directory identified start path startpath directories tld s tlds sync startup tld config tldconfig tld scan dir tldscandir file start i o exception ioexception file file list filelist start list files listfiles file list filelist file list filelist length scan recursively file list filelist is directory isdirectory tld scan dir tldscandir file list filelist file list filelist get absolute path getabsolutepath ends with endswith tld ext input stream inputstream stream stream file input stream fileinputstream file list filelist tld scan stream tldscanstream file list filelist touri to string tostring stream stream stream close throwable exception utils exceptionutils handle throwable handlethrowable s cans scans jarurlconnection tld files located meta inf sub directory subdirectory adding implicit map entry taglib map tld uri element param jar conn jarconn jarurlconnection jar file scan sync startup tld config tldconfig tld scan jar tldscanjar jarurlconnection jar conn jarconn i o exception ioexception jar jar input stream inputstream found tld foundtld url resourceurl jar conn jarconn get jar file l getjarfileurl string resource path resourcepath resourceurl to string tostring jar jar factory jarfactory new instance newinstance jar conn jarconn geturl jar next entry nextentry string entry name entryname jar get entry name getentryname entry name entryname entry name entryname starts with startswith meta inf entry name entryname ends with endswith tld jar get entry input stream getentryinputstream found tld foundtld tld scan stream tldscanstream resource path resourcepath entry name entryname close i o exception ioexception ioe jar next entry nextentry entry name entryname jar get entry name getentryname jar jar close found tld foundtld log is debug enabled isdebugenabled log debug localizer get message getmessage jsp tld cache tldcache no tld in jar notldinjar resource path resourcepath show tld scan warning showtldscanwarning thread safe duplicate log messages huge issue show tld scan warning showtldscanwarning log info localizer get message getmessage jsp tld cache tldcache no tld summary notldsummary scan tld contents input stream add uri s uris map param resource path resourcepath path resource param entry name entryname resource jar file entry jar file param stream input stream resource i o exception ioexception tld scan stream tldscanstream string resource path resourcepath string entry name entryname input stream inputstream stream i o exception ioexception parse tag library descriptor resource path string uri validate parse boolean parseboolean ctxt get init parameter getinitparameter constants xml validation tld init param string block external string blockexternalstring ctxt get init parameter getinitparameter constants xml block external init param block external blockexternal block external string blockexternalstring block external blockexternal block external blockexternal parse boolean parseboolean block external string blockexternalstring parser utils parserutils parser utils parserutils validate block external blockexternal tree node treenode tld parsexmldocument resource path resourcepath stream tree node treenode uri node urinode tld find child findchild uri uri node urinode string body uri node urinode get body getbody body uri body map uri mappings uri tld location tldlocation location entry name entryname location tld location tldlocation resource path resourcepath location tld location tldlocation entry name entryname resource path resourcepath mappings uri location jasper exception jasperexception i o exception ioexception
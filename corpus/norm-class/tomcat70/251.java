licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license async java io exception ioexception java print writer printwriter java util array list arraylist java util iterator java util concurrent concurrent linked queue concurrentlinkedqueue java util concurrent atomic atomic integer atomicinteger javax servlet async context asynccontext javax servlet async event asyncevent javax servlet async listener asynclistener javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse async stockticker stock async stockticker tick listener ticklistener async stock servlet asyncstockservlet http servlet httpservlet tick listener ticklistener async listener asynclistener serialversionuid string poll poll string poll poll string stream stream array list arraylist stock ticks array list arraylist stock concurrent linked queue concurrentlinkedqueue async context asynccontext clients concurrent linked queue concurrentlinkedqueue async context asynccontext atomic integer atomicinteger client count clientcount atomic integer atomicinteger stockticker ticker stockticker async stock servlet asyncstockservlet system println async stock servlet asyncstockservlet created override service http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception req is async started isasyncstarted req get async context getasynccontext complete req is async supported isasyncsupported async context asynccontext actx req start async startasync actx add listener addlistener resp set content type setcontenttype text plain clients add actx client count clientcount increment and get incrementandget ticker add tick listener addticklistener exception async supported print stack trace printstacktrace resp send error senderror async supported override tick stock stock ticks add stock stock clone iterator async context asynccontext clients iterator has next hasnext async context asynccontext actx write stock writestock actx stock exception write stock writestock async context asynccontext actx stock stock http servlet response httpservletresponse response http servlet response httpservletresponse actx get response getresponse print writer printwriter writer response get writer getwriter client parsing easier writer write stock writer write stock get symbol getsymbol writer write writer write stock get value as string getvalueasstring writer write writer write stock get last change as string getlastchangeasstring writer write writer write string value of valueof stock get cnt getcnt writer write writer flush response flush buffer flushbuffer io exception ioexception actx complete exception ignore override on complete oncomplete async event asyncevent event io exception ioexception clients remove event get async context getasynccontext client count clientcount decrement and get decrementandget ticker remove tick listener removeticklistener override on error onerror async event asyncevent event io exception ioexception event get async context getasynccontext complete override on timeout ontimeout async event asyncevent event io exception ioexception event get async context getasynccontext complete override on start async onstartasync async event asyncevent event io exception ioexception noop
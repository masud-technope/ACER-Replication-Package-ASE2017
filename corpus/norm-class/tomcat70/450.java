licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util threads java util concurrent blocking queue blockingqueue java util concurrent rejected execution exception rejectedexecutionexception java util concurrent rejected execution handler rejectedexecutionhandler java util concurrent thread factory threadfactory java util concurrent time unit timeunit java util concurrent atomic atomic integer atomicinteger java util concurrent atomic atomic long atomiclong org apache tomcat util res string manager stringmanager java util concurrent thread pool executor threadpoolexecutor efficient link get sub mitted count getsubmittedcount method properly handle work queue rejected execution handler rejectedexecutionhandler configured rejected execution exception rejectedexecutionexception author fhanik thread pool executor threadpoolexecutor java util concurrent thread pool executor threadpoolexecutor string manager string manager stringmanager string manager stringmanager get manager getmanager org apache tomcat util threads res number tasks sub mitted submitted finished includes tasks queue tasks handed worker thread start executing task number greater equal link get active count getactivecount atomic integer atomicinteger sub mitted count submittedcount atomic integer atomicinteger atomic long atomiclong last context stopped time lastcontextstoppedtime atomic long atomiclong time thread decide d decided kill avoid potential memory leaks thr ottle throttle rate renewals threads atomic long atomiclong last time thread killed itself lasttimethreadkilleditself atomic long atomiclong delay threads renewed negative renew threads thread renewal delay threadrenewaldelay constants thread renewal delay thread pool executor threadpoolexecutor core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime time unit timeunit unit blocking queue blockingqueue runnable work queue workqueue rejected execution handler rejectedexecutionhandler handler core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime unit work queue workqueue handler thread pool executor threadpoolexecutor core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime time unit timeunit unit blocking queue blockingqueue runnable work queue workqueue thread factory threadfactory thread factory threadfactory rejected execution handler rejectedexecutionhandler handler core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime unit work queue workqueue thread factory threadfactory handler thread pool executor threadpoolexecutor core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime time unit timeunit unit blocking queue blockingqueue runnable work queue workqueue thread factory threadfactory thread factory threadfactory core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime unit work queue workqueue thread factory threadfactory reject handler rejecthandler thread pool executor threadpoolexecutor core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime time unit timeunit unit blocking queue blockingqueue runnable work queue workqueue core pool size corepoolsize maximum pool size maximumpoolsize keep alive time keepalivetime unit work queue workqueue reject handler rejecthandler get thread renewal delay getthreadrenewaldelay thread renewal delay threadrenewaldelay set thread renewal delay setthreadrenewaldelay thread renewal delay threadrenewaldelay thread renewal delay threadrenewaldelay thread renewal delay threadrenewaldelay override after execute afterexecute runnable throwable sub mitted count submittedcount decrement and get decrementandget stop current thread if needed stopcurrentthreadifneeded current thread started time context stopped exception thrown current thread stopped stop current thread if needed stopcurrentthreadifneeded current thread should be stopped currentthreadshouldbestopped last time lasttime last time thread killed itself lasttimethreadkilleditself long value longvalue last time lasttime thread renewal delay threadrenewaldelay system current time millis currenttimemillis last time thread killed itself lasttimethreadkilleditself compare and set compareandset last time lasttime system current time millis currenttimemillis time dispose thread string msg get string getstring thread pool executor threadpoolexecutor thread stopped to avoid potential leak threadstoppedtoavoidpotentialleak thread current thread currentthread get name getname stop pooled thread exception stoppooledthreadexception msg current thread should be stopped currentthreadshouldbestopped thread renewal delay threadrenewaldelay thread current thread currentthread task thread taskthread task thread taskthread current task thread currenttaskthread task thread taskthread thread current thread currentthread current task thread currenttaskthread get creation time getcreationtime last context stopped time lastcontextstoppedtime long value longvalue get sub mitted count getsubmittedcount sub mitted count submittedcount inherit doc inheritdoc override execute runnable command execute command time unit timeunit milliseconds executes command time command execute thread pooled thread calling thread discretion executor implementation threads work queue work queue full system wait time rejected execution exception rejectedexecutionexception queue full param command runnable task rejected execution exception rejectedexecutionexception task accepted execution queue full null pointer exception nullpointerexception command unit execute runnable command timeout time unit timeunit unit sub mitted count submittedcount increment and get incrementandget execute command rejected execution exception rejectedexecutionexception get queue getqueue task queue taskqueue task queue taskqueue queue task queue taskqueue get queue getqueue queue force command timeout unit sub mitted count submittedcount decrement and get decrementandget rejected execution exception rejectedexecutionexception queue capacity full interrupted exception interruptedexception sub mitted count submittedcount decrement and get decrementandget thread int errupted interrupted rejected execution exception rejectedexecutionexception sub mitted count submittedcount decrement and get decrementandget context stopping contextstopping last context stopped time lastcontextstoppedtime system current time millis currenttimemillis save current pool parameters restore saved core pool size savedcorepoolsize get core pool size getcorepoolsize task queue taskqueue task queue taskqueue get queue getqueue task queue taskqueue task queue taskqueue get queue getqueue task queue taskqueue not e note slaurent oddly thread pool executor threadpoolexecutor set core pool size setcorepoolsize checks queue remaining capacity remainingcapacity under stand understand intended waking idle threads temp orarily temporarily fake condition task queue taskqueue set for ced remaining capacity setforcedremainingcapacity integer value of valueof set core pool size setcorepoolsize wakes idle threads set core pool size setcorepoolsize task queue taskqueue restore queue pool task queue taskqueue set for ced remaining capacity setforcedremainingcapacity set core pool size setcorepoolsize saved core pool size savedcorepoolsize reject handler rejecthandler rejected execution handler rejectedexecutionhandler override rejected execution rejectedexecution runnable java util concurrent thread pool executor threadpoolexecutor executor rejected execution exception rejectedexecutionexception
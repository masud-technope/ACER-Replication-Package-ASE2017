licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina websocket java io exception ioexception java nio byte buffer bytebuffer java nio char buffer charbuffer java nio charset charset encoder charsetencoder java nio charset code r result coderresult org apache coyote http upgrade upgrade outbound upgradeoutbound org apache tomcat util buf c converter cconverter org apache tomcat util res string manager stringmanager write web socket websocket messages client methods write client update buffer written client prevent multiple threads write client time deprecated replaced jsr web socket websocket implementation removed tomcat deprecated ws outbound wsoutbound string manager stringmanager string manager stringmanager get manager getmanager constants buffer size lock methods error handling managed synchronization dead locks deadlocks occur https apache org bug zilla bugzilla bug cgi object state lock statelock object upgrade outbound upgradeoutbound upgrade outbound upgradeoutbound stream inbound streaminbound stream inbound streaminbound byte buffer bytebuffer char buffer charbuffer closed text first frame firstframe ws outbound wsoutbound upgrade outbound upgradeoutbound upgrade outbound upgradeoutbound stream inbound streaminbound stream inbound streaminbound upgrade outbound upgradeoutbound stream inbound streaminbound buffer size buffer size ws outbound wsoutbound upgrade outbound upgradeoutbound upgrade outbound upgradeoutbound stream inbound streaminbound stream inbound streaminbound byte buffer size bytebuffersize char buffer size charbuffersize upgrade outbound upgradeoutbound upgrade outbound upgradeoutbound stream inbound streaminbound stream inbound streaminbound byte buffer bytebuffer all ocate allocate byte buffer size bytebuffersize char buffer charbuffer all ocate allocate char buffer size charbuffersize adds data buffer binary data text ual textual message progress message completed binary message started buffer binary data full buffer flushed binary continuation fragment started param data send client io exception ioexception flush required error occurs writing web socket websocket frame client write binary data writebinarydata io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed position capacity do flush doflush text text equals text flush character data flush text xff io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe adds data buffer text ual textual data binary message progress message completed text ual textual message started buffer text ual textual data full buffer flushed text ual textual continuation fragment started param character send client io exception ioexception flush required error occurs writing web socket websocket frame client write text data writetextdata io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed position capacity do flush doflush text text equals text flush binary data flush text append io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe flush message binary text ual textual buf fered buffered send web socket websocket binary message single frame buffer payload message param msg bb msgbb buffer payload io exception ioexception error occurs writing client write binary message writebinarymessage byte buffer bytebuffer msg bb msgbb io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed text empty buffer flush text do write bytes dowritebytes msg bb msgbb io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe flush message binary text ual textual buf fered buffered send web socket websocket text message single frame buffer payload message param msg cb msgcb buffer payload io exception ioexception error occurs writing client write text message writetextmessage char buffer charbuffer msg cb msgcb io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed text empty buffer flush text do write text dowritetext msg cb msgcb io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe flush message binary text ual textual buf fered buffered io exception ioexception error occurs writing client flush io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed do flush doflush io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe do flush doflush final fragment finalfragment io exception ioexception text data text boolean value booleanvalue flip do write text dowritetext final fragment finalfragment flip do write bytes dowritebytes final fragment finalfragment res pond respond client close sending close echoes status code message param frame close frame received client io exception ioexception error occurs writing client close ws frame wsframe frame io exception ioexception frame get pay load length getpayloadlength status bytes optional message frame get pay load length getpayloadlength io exception ioexception status frame get pay load getpayload xff status frame get pay load getpayload xff validate close status validateclosestatus status echo status client close status frame get pay load getpayload invalid close code close constants status protocol error status close validate close status validateclosestatus status status constants status close normal status constants status shutdown status constants status protocol error status constants status unexpected data type status constants status bad data status constants status policy violation status constants status message large status constants status required extension status constants status unexpected condition status status xxx application defined undefined send close message client param status valid status code send code param data optional message message defined valid status code io exception ioexception error occurs writing client close status byte buffer bytebuffer data io exception ioexception state lock statelock closed send partial data do flush doflush closed upgrade outbound upgradeoutbound write status upgrade outbound upgradeoutbound write data data position data limit upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write status upgrade outbound upgradeoutbound write status upgrade outbound upgradeoutbound write data limit data position upgrade outbound upgradeoutbound write status upgrade outbound upgradeoutbound write status upgrade outbound upgradeoutbound write data array data position data limit data position upgrade outbound upgradeoutbound flush upgrade outbound upgradeoutbound io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe send pong message client param data optional message io exception ioexception error occurs writing client pong byte buffer bytebuffer data io exception ioexception send control message sendcontrolmessage data constants opc ode opcode pong send ping message client param data optional message io exception ioexception error occurs writing client ping byte buffer bytebuffer data io exception ioexception send control message sendcontrolmessage data constants opc ode opcode ping function send ping pong param data optional message param opcode include opcode io exception ioexception error occurs writing client send control message sendcontrolmessage byte buffer bytebuffer data opcode io exception ioexception state lock statelock closed io exception ioexception get string getstring out bound outbound closed do flush doflush upgrade outbound upgradeoutbound write opcode data upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write data limit data position upgrade outbound upgradeoutbound write data array data position data limit data position upgrade outbound upgradeoutbound flush io exception ioexception ioe stream inbound streaminbound do on close doonclose constants status closed unexpectedly ioe writes bytes payload web socket websocket frame param buffer bytes include payload param final fragment finalfragment bytes represent fragment web socket websocket message io exception ioexception do write bytes dowritebytes byte buffer bytebuffer buffer final fragment finalfragment io exception ioexception closed io exception ioexception get string getstring out bound outbound closed work final fragment finalfragment first frame firstframe text boolean value booleanvalue continuation frame op code opcode upgrade outbound upgradeoutbound write buffer limit upgrade outbound upgradeoutbound write buffer limit buffer limit upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write buffer limit upgrade outbound upgradeoutbound write buffer limit xff upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write upgrade outbound upgradeoutbound write buffer limit upgrade outbound upgradeoutbound write buffer limit upgrade outbound upgradeoutbound write buffer limit upgrade outbound upgradeoutbound write buffer limit xff write content upgrade outbound upgradeoutbound write buffer array buffer array offset arrayoffset buffer limit upgrade outbound upgradeoutbound flush reset final fragment finalfragment text first frame firstframe first frame firstframe clear convert text ual textual message bytes output do write text dowritetext char buffer charbuffer buffer final fragment finalfragment io exception ioexception charset encoder charsetencoder encoder c converter cconverter utf new encoder newencoder code r result coderresult encoder encode buffer is error iserror throw exception throwexception flip buffer has remaining hasremaining do write bytes dowritebytes do write bytes dowritebytes final fragment finalfragment buffer has remaining hasremaining reset cleared do write bytes dowritebytes clear
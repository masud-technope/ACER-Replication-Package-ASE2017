licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina back end backend java buffered reader bufferedreader java buffered writer bufferedwriter java io exception ioexception java input stream reader inputstreamreader java output stream writer outputstreamwriter java net inet address inetaddress java net inet socket address inetsocketaddress java net socket java util string tokenizer stringtokenizer org apache juli logging log org apache juli logging log factory logfactory sender proxies multicast socket tcp sender tcpsender sender log log log factory logfactory get log getlog heartbeat listener heartbeatlistener heartbeat listener heartbeatlistener config proxies proxy proxies active connections socket connections buffered reader bufferedreader connection read ers connectionreaders buffered writer bufferedwriter connection write rs connectionwriters override init heartbeat listener heartbeatlistener config exception config config string tokenizer stringtokenizer tok string tokenizer stringtokenizer config get proxy list getproxylist proxies proxy tok count tokens counttokens tok has more tokens hasmoretokens string token tok next token nexttoken trim pos token index of indexof pos exception bad proxy list proxylist proxies proxy proxies port integer parse int parseint token substring pos proxies address inet address inetaddress get by name getbyname token substring pos exception exception bad proxy list proxylist connections socket proxies length connection read ers connectionreaders buffered reader bufferedreader proxies length connection write rs connectionwriters buffered writer bufferedwriter proxies length override send string mess exception connections log error initialized string request line requestline post config getproxyurl http connections length connections config host connections socket inet address inetaddress add r addr inet address inetaddress get by name getbyname config host inet socket address inetsocketaddress add rs addrs inet socket address inetsocketaddress add r addr connections set reuse address setreuseaddress connections bind add rs addrs add rs addrs inet socket address inetsocketaddress proxies address proxies port connections connect add rs addrs connections socket proxies address proxies port connection read ers connectionreaders buffered reader bufferedreader input stream reader inputstreamreader connections get input stream getinputstream connection write rs connectionwriters buffered writer bufferedwriter output stream writer outputstreamwriter connections get output stream getoutputstream exception log error unable connect proxy close connections proxy list buffered writer bufferedwriter writer connection write rs connectionwriters writer write request line requestline writer write writer write content length mess length writer write user agent heartbeat listener heartbeatlistener writer write connection alive writer write writer write mess writer write writer flush exception log error unable send collected load proxy close connections proxy list read http d httpd answer string response status responsestatus connection read ers connectionreaders read line readline response status responsestatus log error unable read response proxy close response status responsestatus response status responsestatus substring response status responsestatus index of indexof response status responsestatus index of indexof response status responsestatus index of indexof status integer parse int parseint response status responsestatus status log error status status close read headers string header connection read ers connectionreaders read line readline content length contentlength equals header colon header index of indexof string header name headername header substring colon trim string header value headervalue header substring colon trim content length equals ignore case equalsignorecase header name headername content length contentlength integer parse int parseint header value headervalue header connection read ers connectionreaders read line readline content length contentlength buf content length contentlength this time thistime content length contentlength buf length buf length content length contentlength connection read ers connectionreaders read buf this time thistime log error read content failed close content length contentlength close connection close connection read ers connectionreaders connection read ers connectionreaders close io exception ioexception connection read ers connectionreaders connection write rs connectionwriters connection write rs connectionwriters close io exception ioexception connection write rs connectionwriters connections connections close io exception ioexception connections
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina session java buffered output stream bufferedoutputstream java file java file input stream fileinputstream java file not found exception filenotfoundexception java file output stream fileoutputstream java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream java util array list arraylist javax servlet servlet context servletcontext org apache catalina context org apache catalina loader org apache catalina session org apache juli logging log concrete implementation store util izes utilizes file saved session configured directory sessions saved subject expired based inactivity author craig mc clanahan mcclanahan file store filestore store base storebase constants extension serialized session file names filenames string file ext session instance variables path name pathname directory sessions stored absolute path name pathname relative path resolved temporary work directory application string directory file representing directory sessions stored file directory file directoryfile descriptive implementation string info file store filestore register store logging string store name storename file store filestore register background thread string thread name threadname file store filestore properties directory path store string get directory getdirectory directory directory path store param path directory path set directory setdirectory string path string old directory olddirectory directory directory path directory file directoryfile support fire property change firepropertychange directory old directory olddirectory directory override string get info getinfo info thread store string get thread name getthreadname thread name threadname store logging override string get store name getstorename store name storename number sessions store exception io exception ioexception input output error occurs override get size getsize io exception ioexception acquire list files storage directory file file directory file string files file list figure files sessions key count keycount files files length files ends with endswith file ext key count keycount key count keycount methods remove sessions store exception io exception ioexception input output error occurs override clear io exception ioexception string length remove array session identifiers sessions saved store sessions length array returned exception io exception ioexception input output error occurred override string io exception ioexception acquire list files storage directory file file directory file string string files file list bug zilla bugzilla files files length string build list session identifiers array list arraylist string list array list arraylist string file ext length files length files ends with endswith file ext list add files substring files length list to array toarray string list size load session session identifier store removing stored session code code param session identifier session load exception class not found exception classnotfoundexception deserialization error occurs exception io exception ioexception input output error occurs override session load string class not found exception classnotfoundexception io exception ioexception open input stream path name pathname file file file file file exists context context context get manager getmanager get container getcontainer log container log containerlog context get logger getlogger container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring get store name getstorename loading file get absolute path getabsolutepath file input stream fileinputstream fis object input stream objectinputstream ois loader loader class loader classloader class loader classloader class loader classloader old thread context l oldthreadcontextcl thread current thread currentthread get context class loader getcontextclassloader fis file input stream fileinputstream file get absolute path getabsolutepath loader context get loader getloader loader class loader classloader loader get class loader getclassloader class loader classloader thread current thread currentthread set context class loader setcontextclassloader class loader classloader ois get object input stream getobjectinputstream fis standard session standardsession session standard session standardsession manager create empty session createemptysession session read object data readobjectdata ois session set manager setmanager manager session file not found exception filenotfoundexception container log containerlog is debug enabled isdebugenabled container log containerlog debug persisted data file fis fis close io exception ioexception ois close input stream ois close io exception ioexception thread current thread currentthread set context class loader setcontextclassloader old thread context l oldthreadcontextcl remove session session identifier store session method takes action param session identifier session removed exception io exception ioexception input output error occurs override remove string io exception ioexception file file file file manager get container getcontainer get logger getlogger is debug enabled isdebugenabled manager get container getcontainer get logger getlogger debug get string getstring get store name getstorename removing file get absolute path getabsolutepath file delete save session store saved session identifier replaced param session session saved exception io exception ioexception input output error occurs override save session session io exception ioexception open output stream path name pathname file file file session get id internal getidinternal file manager get container getcontainer get logger getlogger is debug enabled isdebugenabled manager get container getcontainer get logger getlogger debug get string getstring get store name getstorename saving session get id internal getidinternal file get absolute path getabsolutepath file output stream fileoutputstream fos object output stream objectoutputstream oos fos file output stream fileoutputstream file get absolute path getabsolutepath oos object output stream objectoutputstream buffered output stream bufferedoutputstream fos io exception ioexception fos fos close io exception ioexception standard session standardsession session write object data writeobjectdata oos oos close methods file object representing path name pathname session persistence directory directory created exist file directory io exception ioexception directory directory file directoryfile note race condition harmless synchronize directory file directoryfile file file file directory file is absolute isabsolute context context context manager get container getcontainer servlet context servletcontext servlet context servletcontext context get servlet context getservletcontext file work file servlet context servletcontext get attribute getattribute servlet context servletcontext temp dir tempdir file file work directory file exists file is directory isdirectory file delete file exists io exception ioexception get string getstring file store filestore delete failed deletefailed file file mkdirs file is directory isdirectory io exception ioexception get string getstring file store filestore create failed createfailed file directory file directoryfile file file file object representing path name pathname session persistence file param session retrieved file naming file file string io exception ioexception directory string filename file ext file file file directory filename file
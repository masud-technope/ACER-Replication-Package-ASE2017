licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net java file java file input stream fileinputstream java i o exception ioexception java input stream inputstream java net inet address inetaddress java net socket java net uri syntax exception urisyntaxexception java net unknown host exception unknownhostexception java security key management exception keymanagementexception java security key store keystore java security no such algorithm exception nosuchalgorithmexception java security cert certificate java util array list arraylist java util arrays java util iterator java util list javax net ssl key manager keymanager javax net ssl key manager factory keymanagerfactory javax net ssl ssl context sslcontext javax net ssl ssl server socket factory sslserversocketfactory javax net ssl ssl socket sslsocket javax net ssl ssl socket factory sslsocketfactory javax net ssl trust manager trustmanager javax net ssl trust manager factory trustmanagerfactory javax net ssl trust manager trustmanager javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina context org apache catalina authenticator ssl authenticator sslauthenticator org apache catalina connector connector org apache catalina core apr lifecycle listener aprlifecyclelistener org apache catalina deploy login config loginconfig org apache catalina deploy security collection securitycollection org apache catalina deploy security constraint securityconstraint org apache catalina startup test tomcat testtomcat map realm maprealm org apache catalina startup tomcat org apache tomcat jni ssl tester support testersupport string role test role testrole rfc supported result ssl context sslcontext context context ssl context sslcontext get instance getinstance tls context init ssl server socket factory sslserversocketfactory ssf context get server socket factory getserversocketfactory string ciphers ssf get supported cipher suites getsupportedciphersuites string cipher ciphers tls empty renegotiation info scsv equals cipher result no such algorithm exception nosuchalgorithmexception key management exception keymanagementexception rfc supported result init ssl initssl tomcat tomcat init ssl initssl tomcat localhost jks init ssl initssl tomcat tomcat string key store keystore string key store pass keystorepass string key pass keypass class loader classloader tester support testersupport get class loader getclassloader string protocol tomcat get connector getconnector get protocol handler class name getprotocolhandlerclassname protocol index of indexof apr connector connector tomcat get connector getconnector connector set property setproperty ssl protocol sslprotocol tls java net url key store url keystoreurl get resource getresource org apache tomcat util net key store keystore file key store file keystorefile to file tofile key store url keystoreurl connector set attribute setattribute key store file keystorefile key store file keystorefile get absolute path getabsolutepath java net url truststore url truststoreurl get resource getresource org apache tomcat util net jks file truststore file truststorefile to file tofile truststore url truststoreurl connector set attribute setattribute truststore file truststorefile truststore file truststorefile get absolute path getabsolutepath key store pass keystorepass connector set attribute setattribute key store pass keystorepass key store pass keystorepass key pass keypass connector set attribute setattribute key pass keypass key pass keypass java net url key store url keystoreurl get resource getresource org apache tomcat util net localhost cert pem file key store file keystorefile to file tofile key store url keystoreurl tomcat get connector getconnector set attribute setattribute ssl certificate file sslcertificatefile key store file keystorefile get absolute path getabsolutepath java net url ssl certificate key url sslcertificatekeyurl get resource getresource org apache tomcat util net localhost key pem file ssl certificate key file sslcertificatekeyfile to file tofile ssl certificate key url sslcertificatekeyurl tomcat get connector getconnector set attribute setattribute ssl certificate key file sslcertificatekeyfile ssl certificate key file sslcertificatekeyfile get absolute path getabsolutepath tomcat get connector getconnector set secure setsecure tomcat get connector getconnector set property setproperty ssl enabled sslenabled openssl apr lifecycle listener aprlifecyclelistener is apr available isapravailable ssl version tomcat get connector getconnector set property setproperty ssl protocol sslprotocol constants ssl proto tls v tlsv constants ssl proto ss lv sslv file to file tofile java net url url file url touri uri syntax exception urisyntaxexception illegal argument exception illegalargumentexception key manager keymanager get user getuser key managers keymanagers exception key manager factory keymanagerfactory kmf key manager factory keymanagerfactory get instance getinstance key manager factory keymanagerfactory get default algorithm getdefaultalgorithm kmf init get key store getkeystore org apache tomcat util net user jks change it changeit to char array tochararray kmf get key managers getkeymanagers trust manager trustmanager get trust managers gettrustmanagers exception trust manager factory trustmanagerfactory tmf trust manager factory trustmanagerfactory get instance getinstance trust manager factory trustmanagerfactory get default algorithm getdefaultalgorithm tmf init get key store getkeystore org apache tomcat util net jks tmf get trust managers gettrustmanagers configure client ssl configureclientssl system set property setproperty https protocols tls v tlsv ssl context sslcontext ssl context sslcontext get instance getinstance tls init tester support testersupport get user getuser key managers keymanagers tester support testersupport get trust managers gettrustmanagers javax net ssl httpsurlconnection setdefaultsslsocketfactory nosslv socket factory socketfactory get socket factory getsocketfactory exception print stack trace printstacktrace key store keystore get key store getkeystore string key store keystore exception class loader classloader tester support testersupport get class loader getclassloader java net url key store url keystoreurl get resource getresource key store keystore file key store file keystorefile to file tofile key store url keystoreurl key store keystore key store keystore get instance getinstance jks input stream inputstream file input stream fileinputstream key store file keystorefile load change it changeit to char array tochararray close i o exception ioexception ioe is renegotiation supported isrenegotiationsupported tomcat tomcat string protocol tomcat get connector getconnector get protocol handler class name getprotocolhandlerclassname protocol apr disabled windows binary configure client cert context configureclientcertcontext tomcat tomcat tester support testersupport init ssl initssl tomcat web application unprotected url file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx simple simple servlet simpleservlet ctx add servlet mapping addservletmapping unprotected simple ctx add servlet mapping addservletmapping simple security constraints security collection securitycollection collection security collection securitycollection collection add pattern addpattern security constraint securityconstraint security constraint securityconstraint add auth role addauthrole role add collection addcollection collection ctx add constraint addconstraint configure realm map realm maprealm realm map realm maprealm realm add user adduser user realm add user role adduserrole user role ctx set realm setrealm realm configure authenticator login config loginconfig login config loginconfig set auth method setauthmethod client cert ctx set login config setloginconfig ctx get pipeline getpipeline add valve addvalve ssl authenticator sslauthenticator data simple servlet simpleservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception resp set content type setcontenttype text plain resp get writer getwriter print req is user in role isuserinrole role resp get writer getwriter print role override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception swallow request body read len buffer input stream inputstream req get input stream getinputstream contentok len len read buffer read read len len contentok contentok buffer data len iteration read report number bytes read resp set content type setcontenttype text plain contentok resp get writer getwriter print read resp get writer getwriter print content mismatch read trust all certs trustallcerts trust manager trustmanager override certificate get acc epted issue rs getacceptedissuers certificate override check client trusted checkclienttrusted certificate certs string auth type authtype noop trust override check server trusted checkservertrusted certificate certs string auth type authtype noop trust nosslv socket factory socketfactory ssl socket factory sslsocketfactory ssl socket factory sslsocketfactory factory nosslv socket factory socketfactory ssl socket factory sslsocketfactory factory factory factory override string get default cipher suites getdefaultciphersuites factory get default cipher suites getdefaultciphersuites override string get supported cipher suites getsupportedciphersuites factory get supported cipher suites getsupportedciphersuites override socket create socket createsocket socket string host port auto close autoclose i o exception ioexception filter protocols filterprotocols ssl socket sslsocket factory create socket createsocket host port auto close autoclose override socket create socket createsocket string host port i o exception ioexception unknown host exception unknownhostexception filter protocols filterprotocols ssl socket sslsocket factory create socket createsocket host port override socket create socket createsocket inet address inetaddress host port i o exception ioexception filter protocols filterprotocols ssl socket sslsocket factory create socket createsocket host port override socket create socket createsocket string host port inet address inetaddress local host localhost local port localport i o exception ioexception unknown host exception unknownhostexception filter protocols filterprotocols ssl socket sslsocket factory create socket createsocket host port local host localhost local port localport override socket create socket createsocket inet address inetaddress add ress address port inet address inetaddress local address localaddress local port localport i o exception ioexception filter protocols filterprotocols ssl socket sslsocket factory create socket createsocket add ress address port local address localaddress local port localport ssl socket sslsocket filter protocols filterprotocols ssl socket sslsocket socket list string protocols array list arraylist string protocols add all addall arrays as list aslist socket get supported protocols getsupportedprotocols iterator string protocols iter protocolsiter protocols iterator protocols iter protocolsiter has next hasnext string protocol protocols iter protocolsiter protocol ss lv sslv protocols iter protocolsiter remove socket set enabled protocols setenabledprotocols protocols to array toarray string protocols size socket
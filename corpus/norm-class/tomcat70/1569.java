licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat jdbc test java lang reflect proxy java sql connection java sql prepared statement preparedstatement org junit org junit org junit test org apache tomcat jdbc pool jdbc interceptor jdbcinterceptor org apache tomcat jdbc pool int erceptor interceptor statement cache statementcache org apache tomcat jdbc pool int erceptor interceptor statement counter interceptor statementcounterinterceptor test statement cache teststatementcache default test case defaulttestcase test statement cache interceptor teststatementcacheinterceptor int erceptor interceptor override tear down teardown exception int erceptor interceptor tear down teardown config cache prepared cacheprepared cache callable cachecallable max datasource get pool properties getpoolproperties set jdbc int erceptors setjdbcinterceptors test statement cache interceptor teststatementcacheinterceptor get name getname prepared cache prepared cacheprepared call able callable cache callable cachecallable max max test test is cache enabled testiscacheenabled exception config datasource get connection getconnection close assert not null assertnotnull interceptor created int erceptor interceptor test test cache properties testcacheproperties exception config datasource get connection getconnection close assert true asserttrue int erceptor interceptor is cache callable iscachecallable assert true asserttrue int erceptor interceptor is cache prepared iscacheprepared assert equals assertequals int erceptor interceptor get max cache size getmaxcachesize test test cache properties testcacheproperties exception config datasource get connection getconnection close assert false assertfalse int erceptor interceptor is cache callable iscachecallable assert false assertfalse int erceptor interceptor is cache prepared iscacheprepared assert equals assertequals int erceptor interceptor get max cache size getmaxcachesize test test prepared statement cache testpreparedstatementcache exception config connection con datasource get connection getconnection prepared statement preparedstatement con prepare statement preparestatement select prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals int erceptor interceptor get cache size getcachesize close assert true asserttrue is closed isclosed assert equals assertequals int erceptor interceptor get cache size getcachesize prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals int erceptor interceptor get cache size getcachesize close assert true asserttrue is closed isclosed close assert true asserttrue is closed isclosed assert equals assertequals int erceptor interceptor get cache size getcachesize test test prepared statement cache testpreparedstatementcache exception init config connection con datasource get connection getconnection prepared statement preparedstatement con prepare statement preparestatement select prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals int erceptor interceptor get cache size getcachesize close assert true asserttrue is closed isclosed assert equals assertequals int erceptor interceptor get cache size getcachesize prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals int erceptor interceptor get cache size getcachesize close assert true asserttrue is closed isclosed close assert true asserttrue is closed isclosed assert equals assertequals int erceptor interceptor get cache size getcachesize test test statement close teststatementclose exception init datasource set jdbc int erceptors setjdbcinterceptors test statement cache interceptor teststatementcacheinterceptor get name getname prepared call able callable max statement counter interceptor statementcounterinterceptor get name getname connection con datasource get connection getconnection statement counter interceptor statementcounterinterceptor counter find interceptor findinterceptor con statement counter interceptor statementcounterinterceptor prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals counter get active count getactivecount close assert equals assertequals statement cache closed counter get active count getactivecount con prepare statement preparestatement select assert equals assertequals reusing statement cache counter get active count getactivecount con prepare statement preparestatement select assert equals assertequals reusing statement cache counter get active count getactivecount close assert equals assertequals statement cache closed counter get active count getactivecount close cache max tests assert equals assertequals statement cache closed counter get active count getactivecount con close assert equals assertequals connection returned pool statement cache counter get active count getactivecount datasource close assert equals assertequals pool cleared statements cache closed counter get active count getactivecount test test statement close teststatementclose exception init datasource set jdbc int erceptors setjdbcinterceptors test statement cache interceptor teststatementcacheinterceptor get name getname prepared call able callable max statement counter interceptor statementcounterinterceptor get name getname connection con datasource get connection getconnection statement counter interceptor statementcounterinterceptor counter find interceptor findinterceptor con statement counter interceptor statementcounterinterceptor prepared statement preparedstatement con prepare statement preparestatement select assert equals assertequals counter get active count getactivecount close assert equals assertequals statement pooled closes counter get active count getactivecount test test max cache size testmaxcachesize exception init config connection con datasource get connection getconnection connection con datasource get connection getconnection connection con con con prepared statement preparedstatement con prepare statement preparestatement select close assert equals assertequals int erceptor interceptor get cache size getcachesize test statement cache interceptor teststatementcacheinterceptor statement cache statementcache test statement cache interceptor teststatementcacheinterceptor test statement cache teststatementcache int erceptor interceptor helper method finds int erceptor interceptor instance int erceptor interceptor chain pro xied proxied param proxy proxy param clazz interceptor instance code clazz code jdbc interceptor jdbcinterceptor find interceptor findinterceptor object proxy clazz jdbc interceptor jdbcinterceptor int erceptor interceptor jdbc interceptor jdbcinterceptor proxy get invocation handler getinvocationhandler proxy int erceptor interceptor clazz is instance isinstance int erceptor interceptor clazz int erceptor interceptor int erceptor interceptor int erceptor interceptor get next getnext
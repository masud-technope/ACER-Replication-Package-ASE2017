licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina tribes tipis java serializable java util array list arraylist java util arrays java util iterator java util map org apache catalina tribes channel org apache catalina tribes channel exception channelexception org apache catalina tribes channel exception channelexception faulty member faultymember org apache catalina tribes member org apache catalina tribes remote process exception remoteprocessexception org apache juli logging log org apache juli logging log factory logfactory replication hash map implementation node cluster carry identical copy map map implementation doesn background thread running replicate invoking remove invoke methods code replicate object code rep licates replicates object belongs key code replicate code s cans scans entire map rep licates replicates data code code code replicate code method decide replicate objects implement code replicated map entry replicatedmapentry code replicate objects object doesn implement code replicated map entry replicatedmapentry code time object replicated entire object serialized call code replicate code replicate objects map node primary remember call code break down breakdown code code finalize code map avoid memory leaks todo implement per iodic periodic sync transfer thread todo member disappeared memberdisappeared change map membership rel ocates relocates primary objects author filip hanik version replicated map replicatedmap abstract replicated map abstractreplicatedmap serialversionuid log log log factory logfactory get log getlog replicated map replicatedmap creates map param channel channel communication param timeout timeout rpc messags param map context name mapcontextname string unique map multiple maps channel param initial capacity initialcapacity size map hash map hashmap param load factor loadfactor load factor hash map hashmap replicated map replicatedmap map owner mapowner owner channel channel timeout string map context name mapcontextname initial capacity initialcapacity load factor loadfactor class loader classloader cls owner channel timeout map context name mapcontextname initial capacity initialcapacity load factor loadfactor channel send options cls creates map param channel channel communication param timeout timeout rpc messags param map context name mapcontextname string unique map multiple maps channel param initial capacity initialcapacity size map hash map hashmap replicated map replicatedmap map owner mapowner owner channel channel timeout string map context name mapcontextname initial capacity initialcapacity class loader classloader cls owner channel timeout map context name mapcontextname initial capacity initialcapacity abstract replicated map abstractreplicatedmap load factor channel send options cls creates map param channel channel communication param timeout timeout rpc messags param map context name mapcontextname string unique map multiple maps channel replicated map replicatedmap map owner mapowner owner channel channel timeout string map context name mapcontextname class loader classloader cls owner channel timeout map context name mapcontextname abstract replicated map abstractreplicatedmap initial capacity abstract replicated map abstractreplicatedmap load factor channel send options cls creates map param channel channel communication param timeout timeout rpc messags param map context name mapcontextname string unique map multiple maps channel param terminate flag terminate map failed start replicated map replicatedmap map owner mapowner owner channel channel timeout string map context name mapcontextname class loader classloader cls terminate owner channel timeout map context name mapcontextname abstract replicated map abstractreplicatedmap initial capacity abstract replicated map abstractreplicatedmap load factor channel send options cls terminate methods override override get state message type getstatemessagetype abstract replicated map abstractreplicatedmap map message mapmessage msg copy override get rep licate message type getreplicatemessagetype abstract replicated map abstractreplicatedmap map message mapmessage msg copy publish info map pair key nodes cluster param key object param object member backup node channel exception channelexception override member publish entry info publishentryinfo object key object channel exception channelexception key serializable serializable member select backup node member backup get map members getmapmembers backup backup length publish data nodes map message mapmessage msg map message mapmessage get map context name getmapcontextname map message mapmessage msg copy serializable key serializable channel get local member getlocalmember backup get channel getchannel send backup msg get channel send options getchannelsendoptions channel exception channelexception faulty member faultymember faulty members faultymembers get faulty members getfaultymembers faulty members faultymembers length array list arraylist member faulty array list arraylist member faulty member faultymember faulty member faultymember faulty members faultymembers faulty member faultymember get cause getcause remote process exception remoteprocessexception faulty add faulty member faultymember get member getmember member real faulty members realfaultymembers faulty to array toarray member faulty size real faulty members realfaultymembers length backup exclude from set excludefromset real faulty members realfaultymembers backup backup length log is warn enabled iswarnenabled log warn unable replicate backup key key success nodes arrays to string tostring backup failed nodes arrays to string tostring real faulty members realfaultymembers backup override member disappeared memberdisappeared member member removed map members mapmembers removed map members mapmembers remove member removed log is debug enabled isdebugenabled log debug member member disappeared map member map log is info enabled isinfoenabled log info member member disappeared map entries relocate d relocated node start system current time millis currenttimemillis iterator map entry map entry mapentry inner map innermap entry set entryset iterator has next hasnext map entry map entry mapentry map entry mapentry entry inner map innermap get key getkey entry entry is primary isprimary member backup get map members getmapmembers backup length map message mapmessage msg map message mapmessage get map context name getmapcontextname map message mapmessage msg notify map member mapmember serializable entry get key getkey channel get local member getlocalmember backup get channel getchannel send backup msg get channel send options getchannelsendoptions entry set backup nodes setbackupnodes backup entry set primary setprimary channel get local member getlocalmember channel exception channelexception log error unable relocate entry get key getkey backup node member equals entry get primary getprimary entry set primary setprimary entry get primary getprimary entry is copy iscopy entry get backup nodes getbackupnodes entry get backup nodes getbackupnodes length entry get backup nodes getbackupnodes equals channel get local member getlocalmember entry set primary setprimary channel get local member getlocalmember entry set backup setbackup entry set proxy setproxy entry set copy setcopy member backup get map members getmapmembers backup length map message mapmessage msg map message mapmessage get map context name getmapcontextname map message mapmessage msg notify map member mapmember serializable entry get key getkey channel get local member getlocalmember backup get channel getchannel send backup msg get channel send options getchannelsendoptions entry set backup nodes setbackupnodes backup map owner mapowner map owner mapowner object made primay objectmadeprimay entry get key getkey entry get value getvalue channel exception channelexception log error unable relocate entry get key getkey backup node complete system current time millis currenttimemillis start log is info enabled isinfoenabled log info relocation map entries complete complete override map member added mapmemberadded member member member equals get channel getchannel get local member getlocalmember member added memberadded map members mapmembers map members mapmembers contains key containskey member map members mapmembers member value of valueof system current time millis currenttimemillis member added memberadded member added memberadded state mutex statemutex member backup get map members getmapmembers iterator map entry map entry mapentry inner map innermap entry set entryset iterator has next hasnext map entry map entry mapentry map entry mapentry entry inner map innermap get key getkey entry entry is primary isprimary in set inset member entry get backup nodes getbackupnodes entry set backup nodes setbackupnodes backup
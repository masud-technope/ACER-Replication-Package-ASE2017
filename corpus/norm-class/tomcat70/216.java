licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http parser java io exception ioexception java string reader stringreader java util hash map hashmap java util linked hash map linkedhashmap java util locale java util map http header parser implementation parsing http headers rfc simple appears headers tokens simple app roach approach sufficient headers simple code meets cases edge cases comp licated complicated purpose parser parser worry edge cases tolerant safe parsing http header values assuming wrapped header lines unwrapped tomcat header processing code unwrap ping unwrapping parsing http header values rfc authorization digest authentication media type mediatype content type header support additional headers required http parser httpparser unused bug gy buggy client implementations suppress warnings suppresswarnings unused integer field type token integer value of valueof integer field type quoted string integer value of valueof integer field type token quoted string integer value of valueof integer field type lhex integer value of valueof integer field type quoted token integer value of valueof map string integer field types fieldtypes hash map hashmap string integer arrays is token istoken is hex ishex is token istoken is hex ishex digest field types note rel axed relaxed rfc adheres rec ommendation recommendation rfc servers tolerant bug gy buggy clients ambiguity field types fieldtypes username field type quoted string field types fieldtypes realm field type quoted string field types fieldtypes non ce nonce field type quoted string field types fieldtypes digest uri field type quoted string rfc response lhex lhex accepted field types fieldtypes response field type lhex rfc algorithm token token accepted field types fieldtypes algorithm field type quoted token field types fieldtypes cnonce field type quoted string field types fieldtypes opaque field type quoted string rfc qop token token accepted field types fieldtypes qop field type quoted token rfc lhex lhex accepted field types fieldtypes field type lhex setup flag arrays includes is token istoken is token istoken is token istoken is hex ishex is hex ishex map string string parse authorization digest parseauthorizationdigest string reader stringreader input illegal argument exception illegalargumentexception io exception ioexception map string string result hash map hashmap string string skip constant skipconstant input digest skip constant result skipconstantresult string field read token readtoken input field field equals skip constant skipconstant input skip constant result skipconstantresult string integer type field types fieldtypes field to lower case tolowercase locale english type type field type token quoted string type int value intvalue read token readtoken input read quoted string readquotedstring input read token or quoted string readtokenorquotedstring input read lhex readlhex input read quoted token readquotedtoken input illegal argument exception illegalargumentexception todo unsupported type result field skip constant skipconstant input skip constant result skipconstantresult field read token readtoken input field result media type mediatype parse media type parsemediatype string reader stringreader input io exception ioexception string type read token readtoken input type type length skip constant skipconstant input skip constant result skipconstantresult string subtype read token readtoken input subtype subtype length linked hash map linkedhashmap string string parameters linked hash map linkedhashmap string string skip constant result skipconstantresult look for semi colon lookforsemicolon skip constant skipconstant input look for semi colon lookforsemicolon skip constant result skipconstantresult look for semi colon lookforsemicolon skip constant result skipconstantresult string attribute read token readtoken input string skip constant skipconstant input skip constant result skipconstantresult read token or quoted string readtokenorquotedstring input attribute parameters attribute to lower case tolowercase locale english look for semi colon lookforsemicolon skip constant skipconstant input look for semi colon lookforsemicolon skip constant result skipconstantresult media type mediatype type subtype parameters string unquote string input input input length input start input char at charat start input length start input length string builder stringbuilder result string builder stringbuilder start input char at charat input char at charat result append input char at charat result append result to string tostring is token istoken is token istoken array index out of bounds exception arrayindexoutofboundsexception is hex ishex is hex ishex array index out of bounds exception arrayindexoutofboundsexception skip lws skiplws string reader stringreader input with reset withreset io exception ioexception with reset withreset input mark input read with reset withreset input mark input read with reset withreset input reset skip constant result skipconstantresult skip constant skipconstant string reader stringreader input string constant io exception ioexception len constant length skip lws skiplws input len skip constant result skipconstantresult eof constant char at charat input skip skip constant result skipconstantresult len input read skip constant result skipconstantresult string read token readtoken string reader stringreader input io exception ioexception string builder stringbuilder result string builder stringbuilder skip lws skiplws input is token istoken result append input read input skip result length result to string tostring string read quoted string readquotedstring string reader stringreader input return quoted returnquoted io exception ioexception skip lws skiplws input string builder stringbuilder result string builder stringbuilder return quoted returnquoted result append input read input read return quoted returnquoted result append result append result append input read return quoted returnquoted result append result to string tostring string read token or quoted string readtokenorquotedstring string reader stringreader input return quoted returnquoted io exception ioexception skip lws skiplws input read quoted string readquotedstring input return quoted returnquoted read token readtoken input string read quoted token readquotedtoken string reader stringreader input io exception ioexception string builder stringbuilder result string builder stringbuilder quoted skip lws skiplws input quoted is token istoken result append input read is token istoken result append input read quoted input skip result length result to string tostring string read lhex readlhex string reader stringreader input io exception ioexception string builder stringbuilder result string builder stringbuilder quoted skip lws skiplws input quoted is hex ishex result append input read is hex ishex result append input read quoted input skip result length result to string tostring enum skip constant result skipconstantresult eof
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina valves java io exception ioexception javax servlet async context asynccontext javax servlet request dispatcher requestdispatcher javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test org apache catalina context org apache catalina wrapper org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk test error report valve testerrorreportvalve tomcat base test tomcatbasetest test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx error servlet errorservlet error servlet errorservlet ctx add servlet mapping addservletmapping error servlet errorservlet tomcat start byte chunk bytechunk res get url geturl http localhost get port getport assert true asserttrue res to string tostring message error servlet errorservlet error text error servlet errorservlet http servlet httpservlet serialversionuid string error text wheels fell override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception req set attribute setattribute request dispatcher requestdispatcher error exception throwable error text resp send error senderror http servlet response httpservletresponse internal server error test test bug testbug d o not set not found donotsetnotfound exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx bug bug servlet ctx add servlet mapping addservletmapping bug tomcat start byte chunk bytechunk res byte chunk bytechunk get url geturl http localhost get port getport res assert null assertnull res to string tostring assert equals assertequals http servlet response httpservletresponse test test bug testbug set not found setnotfound exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx bug bug servlet ctx add servlet mapping addservletmapping bug tomcat start byte chunk bytechunk res byte chunk bytechunk get url geturl http localhost get port getport res assert null assertnull res to string tostring assert equals assertequals http servlet response httpservletresponse bug servlet http servlet httpservlet serialversionuid set not found setnotfound bug servlet set not found setnotfound set not found setnotfound set not found setnotfound override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception set not found setnotfound resp set status setstatus http servlet response httpservletresponse custom error status codes result blank response test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx bug bug servlet ctx add servlet mapping addservletmapping bug tomcat start byte chunk bytechunk res byte chunk bytechunk get url geturl http localhost get port getport res assert equals assertequals bug servlet error status string body res to string tostring assert not null assertnotnull body assert true asserttrue body body bug servlet error message bug servlet http servlet httpservlet serialversionuid error status string error message sky falling override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp send error senderror error status error message test test bug testbug exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext bug servlet bug servlet bug servlet wrapper wrapper tomcat add servlet addservlet ctx bug servlet bug servlet wrapper set async supported setasyncsupported ctx add servlet mapping addservletmapping bug servlet bug servlet tomcat start string builder stringbuilder url string builder stringbuilder url append http localhost url append get port getport url append bug servlet byte chunk bytechunk res byte chunk bytechunk get url geturl url to string tostring res assert equals assertequals http servlet response httpservletresponse bad request bug servlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception call servlet resp get status getstatus http servlet response httpservletresponse bad request resp set status setstatus http servlet response httpservletresponse bad request async context asynccontext req start async startasync dispatch
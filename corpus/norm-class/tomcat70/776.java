licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http file upload fileupload disk java file org apache tomcat util http file upload fileupload file item fileitem org apache tomcat util http file upload fileupload file item factory fileitemfactory link org apache tomcat util http file upload fileupload file item factory fileitemfactory implementation implementation creates link org apache tomcat util http file upload fileupload file item fileitem instances content memory smaller items temporary file disk larger items size threshold content stored disk config urable configurable directory temporary files created configured configuration values size threshold repository system temp directory returned code system get property getproperty java tmp dir tmpdir code note files created system temp directory predictable names local att acker attacker write access directory perform toutoc att ack attack replace uploaded file file att ack ers attackers choice impl ications implications depend uploaded file implementation environment local untrusted users link set repository setrepository file configure repository location pub licly publicly writable servlet container location identified servlet context servletcontext attribute code javax servlet context temp dir tempdir code temporary files created file items deleted file upload fileupload disk file item factory diskfileitemfactory file item factory fileitemfactory manifest constants threshold uploads stored disk size threshold instance variables directory uploaded files stored stored disk file repository threshold uploads stored disk size threshold sizethreshold size threshold constructs unconfigured instance factory configured calling set ter setter methods disk file item factory diskfileitemfactory size threshold constructs preconfigured instance param size threshold sizethreshold threshold bytes items retained memory stored file param repository data repository directory files created item size exc eed exceed threshold disk file item factory diskfileitemfactory size threshold sizethreshold file repository size threshold sizethreshold size threshold sizethreshold repository repository properties returns directory temp orarily temporarily store files larger configured size threshold directory temporary files located set repository setrepository java file file get repository getrepository repository sets directory temp orarily temporarily store files larger configured size threshold param repository directory temporary files located get repository getrepository set repository setrepository file repository repository repository returns size threshold files written disk bytes size threshold bytes set size threshold setsizethreshold get size threshold getsizethreshold size threshold sizethreshold sets size threshold files written disk param size threshold sizethreshold size threshold bytes get size threshold getsizethreshold set size threshold setsizethreshold size threshold sizethreshold size threshold sizethreshold size threshold sizethreshold methods create link disk file item diskfileitem instance supplied parameters local factory configuration param field name fieldname form field param content type contenttype content type form field param is form field isformfield code code plain form field code code param file name filename uploaded file supplied browser client newly created file item override file item fileitem create item createitem string field name fieldname string content type contenttype is form field isformfield string file name filename disk file item diskfileitem field name fieldname content type contenttype is form field isformfield file name filename size threshold sizethreshold repository
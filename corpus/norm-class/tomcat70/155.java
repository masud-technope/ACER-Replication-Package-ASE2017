licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java file java file input stream fileinputstream java i o exception ioexception java input stream inputstream java net jarurlconnection java util array list arraylist java util collection java util hash set hashset java util iterator java util java util string tokenizer stringtokenizer javax servlet servlet context servletcontext javax servlet descriptor taglib descriptor taglibdescriptor org apache catalina context org apache catalina lifecycle org apache catalina lifecycle event lifecycleevent org apache catalina lifecycle listener lifecyclelistener org apache catalina core standard context standardcontext org apache catalina deploy application listener applicationlistener org apache tomcat jar scanner jarscanner org apache tomcat jar scanner callback jarscannercallback org apache tomcat util exception utils exceptionutils org apache tomcat util descriptor digester factory digesterfactory org apache tomcat util descriptor xml error handler xmlerrorhandler org apache tomcat util digester digester org apache tomcat util res string manager stringmanager org apache tomcat util scan jar org apache tomcat util scan jar factory jarfactory org xml sax input source inputsource org xml sax sax exception saxexception startup event listener context config ures configures application listeners configured tld files author craig mc clanahan mcclanahan author jean francois arcand author costin manolache tld config tldconfig lifecycle listener lifecyclelistener string tld ext tld string web inf web inf string web inf lib web inf lib names jar s jars tl ds tlds string no tld jars notldjars org apache juli logging log log org apache juli logging log factory logfactory get log getlog tld config tldconfig string resources string manager stringmanager string manager stringmanager get manager getmanager constants code digester code process tld files digester tld digest ers tlddigesters digester create digester configured process tld digester create tld digester createtlddigester validation block external blockexternal digester digester cache index cacheindex validation cache index cacheindex block external blockexternal cache index cacheindex digester tld digest ers tlddigesters cache index cacheindex digester digester digester factory digesterfactory new digester newdigester validation tld rule set tldruleset block external blockexternal digester get parser getparser tld digest ers tlddigesters cache index cacheindex digester digester list jar s jars skip tl ds tlds string builder stringbuilder jar list jarlist string builder stringbuilder system get property getproperty constants jars skip string tld jars tldjars system get property getproperty constants tld jars skip tld jars tldjars length jar list jarlist length jar list jarlist append jar list jarlist append tld jars tldjars jar list jarlist length set no tld jars setnotldjars jar list jarlist to string tostring sets list jar s jars tl ds tlds param jar names jarnames list comma separated names jar files tl ds tlds set no tld jars setnotldjars string jar names jarnames jar names jarnames no tld jars notldjars no tld jars notldjars no tld jars notldjars hash set hashset string no tld jars notldjars clear string tokenizer stringtokenizer tokenizer string tokenizer stringtokenizer jar names jarnames tokenizer has more elements hasmoreelements string token tokenizer next token nexttoken trim token length no tld jars notldjars add token instance variables context context context code digester code process tag library descriptor files digester tld digester tlddigester uri s uris discovered context enforce correct processing priority tld instance uri processed string taglib uris tagliburis hash set hashset string string webxml taglib uris webxmltagliburis hash set hashset string array list arraylist string listeners array list arraylist string methods adds taglib uri list uri s uris add taglib uri addtagliburi string uri taglib uris tagliburis add uri determines uri taglib uri is known taglib uri isknowntagliburi string uri taglib uris tagliburis uri determines uri taglib uri is known web xml taglib uri isknownwebxmltagliburi string uri webxml taglib uris webxmltagliburis uri deprecated unused removed deprecated context get context getcontext context deprecated unused removed deprecated set context setcontext context context context context add application listener addapplicationlistener string log is debug enabled isdebugenabled log debug add tld listener listeners add string get tld listeners gettldlisteners string result string listeners size listeners to array toarray result result scan configure tag library descriptors web application supports tomcat specific extension tld search order defined jsp spec tag libraries package d packaged jar files shared web applications simply drop ping dropping location web applications access catalina lib supports weird won derful wonderful arr angements arrangements tomcat embedded shared jar s jars scanned tl ds tlds narrowed no tld jars notldjars variable names jar s jars tl ds tlds context add application listener addapplicationlistener application listener applicationlistener deprecated suppress warnings suppresswarnings deprecation execute system current time millis currenttimemillis priority order uri s uris required spec platform tag libs taglibs tomcat doesn provide web xml entries jars web inf lib tl ds tlds web inf equal priority additional entries container processing order sync compiler tld locations cache tldlocationscache s tag e stage web xml entries tld scan web xml tldscanwebxml s tag e stage tl ds tlds web inf lib classes tld scan resource paths tldscanresourcepaths web inf stages jar scanner jarscanner jar scanner jarscanner context get jar scanner getjarscanner tld jar scanner callback tldjarscannercallback tld call back tldcallback tld jar scanner callback tldjarscannercallback jar scanner jarscanner scan context get servlet context getservletcontext context get loader getloader get class loader getclassloader tld call back tldcallback no tld jars notldjars tld call back tldcallback scan found no ds scanfoundnotlds log info get string getstring tld config tldconfig no tld summary notldsummary add listeners listeners context string list get tld listeners gettldlisteners log is debug enabled isdebugenabled log debug get string getstring tld config tldconfig add listeners addlisteners integer value of valueof list length list length context add application listener addapplicationlistener application listener applicationlistener list system current time millis currenttimemillis context standard context standardcontext standard context standardcontext context set tld scan time settldscantime tld jar scanner callback tldjarscannercallback jar scanner callback jarscannercallback tld found tldfound override scan jarurlconnection url conn urlconn i o exception ioexception tld found tldfound tld scan jar tldscanjar url conn urlconn override scan file file file meta inf metainf file file meta inf meta inf metainf is directory isdirectory tld found tldfound tld scan dir tldscandir meta inf metainf scan found no ds scanfoundnotlds tld found tldfound methods taglib entries web xml add map sync compiler tld locations cache tldlocationscache code scan tl ds tlds listed web xml jasper uri tld mappings tld scan web xml tldscanwebxml log is trace enabled istraceenabled log trace get string getstring tld config tldconfig webxml start webxmlstart collection taglib descriptor taglibdescriptor descriptors context get jsp config descriptor getjspconfigdescriptor get tag libs gettaglibs taglib descriptor taglibdescriptor descriptor descriptors string resource path resourcepath descriptor get taglib location gettagliblocation handled resource path resourcepath starts with startswith resource path resourcepath web inf resource path resourcepath taglib uris tagliburis descriptor gettagliburi log warn get string getstring tld config tldconfig webxml skip webxmlskip resource path resourcepath descriptor gettagliburi log is trace enabled istraceenabled log trace get string getstring tld config tldconfig webxml add webxmladd resource path resourcepath descriptor gettagliburi input stream inputstream stream stream context get servlet context getservletcontext get resource as stream getresourceasstream resource path resourcepath stream xml error handler xmlerrorhandler handler tld scan stream tldscanstream stream handler log find ings logfindings log resource path resourcepath taglib uris tagliburis add descriptor gettagliburi webxml taglib uris webxmltagliburis add descriptor gettagliburi log warn get string getstring tld config tldconfig webxml fail path does not exist webxmlfailpathdoesnotexist resource path resourcepath descriptor gettagliburi i o exception ioexception ioe log warn get string getstring tld config tldconfig webxml fail webxmlfail resource path resourcepath descriptor gettagliburi ioe stream stream close throwable exception utils exceptionutils handle throwable handlethrowable s cans scans web application directory identified start path startpath directories tl ds tlds init ially initially root path rootpath equals web inf web inf classes web inf lib directories excluded search jsp spec sync comiler tld locations cache tldlocationscache tld scan resource paths tldscanresourcepaths string start path startpath log is trace enabled istraceenabled log trace get string getstring tld config tldconfig web inf scan webinfscan start path startpath servlet context servletcontext ctxt context get servlet context getservletcontext string dir list dirlist ctxt get resource paths getresourcepaths start path startpath dir list dirlist iterator string dir list dirlist iterator has next hasnext string path path ends with endswith tld ext path starts with startswith web inf lib path starts with startswith web inf classes path ends with endswith tld ext path starts with startswith web inf tags path ends with endswith implicit tld input stream inputstream stream ctxt get resource as stream getresourceasstream path xml error handler xmlerrorhandler handler tld scan stream tldscanstream stream handler log find ings logfindings log path i o exception ioexception ioe log warn get string getstring tld config tldconfig web inf fail webinffail path ioe stream stream close throwable exception utils exceptionutils handle throwable handlethrowable tld scan resource paths tldscanresourcepaths path s cans scans directory identified start path startpath directories tl ds tlds sync comiler tld locations cache tldlocationscache tld scan dir tldscandir file start is found isfound log is trace enabled istraceenabled log trace get string getstring tld config tldconfig dir scan dirscan start get absolute path getabsolutepath file file list filelist start list files listfiles file list filelist file list filelist length scan recursively file list filelist is directory isdirectory tld scan dir tldscandir file list filelist file list filelist get absolute path getabsolutepath ends with endswith tld ext input stream inputstream stream is found isfound stream file input stream fileinputstream file list filelist xml error handler xmlerrorhandler handler tld scan stream tldscanstream stream handler log find ings logfindings log file list filelist get absolute path getabsolutepath i o exception ioexception ioe log warn get string getstring tld config tldconfig dir fail dirfail file list filelist get absolute path getabsolutepath ioe stream stream close throwable exception utils exceptionutils handle throwable handlethrowable is found isfound log is debug enabled isdebugenabled log debug get string getstring tld config tldconfig no tld i n dir notldindir start get absolute path getabsolutepath is found isfound s cans scans jarurlconnection tld files located meta inf directory param jar conn jarconn jarurlconnection jar file scan sync comiler tld locations cache tldlocationscache tld scan jar tldscanjar jarurlconnection jar conn jarconn jar jar input stream inputstream is found isfound jar jar factory jarfactory new instance newinstance jar conn jarconn geturl jar next entry nextentry string entry name entryname jar get entry name getentryname entry name entryname entry name entryname starts with startswith meta inf entry name entryname ends with endswith tld is found isfound jar get entry input stream getentryinputstream xml error handler xmlerrorhandler handler tld scan stream tldscanstream handler log find ings logfindings log jar conn jarconn geturl entry name entryname close i o exception ioexception ioe jar next entry nextentry entry name entryname jar get entry name getentryname is found isfound log is debug enabled isdebugenabled log debug get string getstring tld config tldconfig no tld i n jar notldinjar jar conn jarconn geturl get file getfile i o exception ioexception ioe log warn get string getstring tld config tldconfig jar fail jarfail jar conn jarconn geturl ioe jar jar close is found isfound scan tld contents input stream register application event listeners note method ensure input stream inputstream correctly closed param resource stream resourcestream input stream inputstream tag library descriptor i o exception ioexception file read xml error handler xmlerrorhandler tld scan stream tldscanstream input stream inputstream resource stream resourcestream i o exception ioexception input source inputsource source input source inputsource resource stream resourcestream xml error handler xmlerrorhandler result xml error handler xmlerrorhandler tld digester tlddigester tld digester tlddigester set error handler seterrorhandler result tld digester tlddigester push tld digester tlddigester parse source sax exception saxexception i o exception ioexception tld digester tlddigester reset result override lifecycle event lifecycleevent lifecycle event lifecycleevent event identify context context context event get lifecycle getlifecycle class cast exception classcastexception log error get string getstring tld config tldconfig cce event get lifecycle getlifecycle event get type gettype equals lifecycle init event init event get type gettype equals lifecycle configure start event execute exception log error get string getstring tld config tldconfig execute context get name getname event get type gettype equals lifecycle event taglib uris tagliburis clear webxml taglib uris webxmltagliburis clear listeners clear init tld digester tlddigester tld digester tlddigester create tld digester createtlddigester context get tld validation gettldvalidation context get xml block external getxmlblockexternal
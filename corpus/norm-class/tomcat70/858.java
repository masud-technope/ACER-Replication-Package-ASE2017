licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java lang reflect constructor java lang reflect invocation target exception invocationtargetexception java net uri java net uri syntax exception urisyntaxexception java net url java security principal java util array list arraylist java util iterator java util list javax security subject javax security callback callback handler callbackhandler javax security login acc ount expired exception accountexpiredexception javax security login configuration javax security login credential expired exception credentialexpiredexception javax security login failed login exception failedloginexception javax security login login context logincontext javax security login login exception loginexception javax servlet http http servlet request httpservletrequest org apache catalina container org apache catalina lifecycle exception lifecycleexception org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils implementation realm auth enticates authenticates users java authentication authorization service jaas jaas support requires jdk includes standard platform jdk plug code jaas jar code file configured code app name appname code property passed code javax security login login context logincontext code constructor application select relevant code login modules loginmodules code required jaas specification describes result successful login code javax security subject code instance code java security principal code objects code subject get principals getprincipals code method guidance distinguish principals describe individual user request get user principal getuserprincipal web application principal describe author ized authorized roles user main tain maintain ind ependence independence underlying code login method loginmethod code implementation executed jaas policy implemented realm jaas code login module loginmodule code assumed code subject code code principal code instance representing user separate code principals code representing security roles author ized authorized user code principal code representing user principal servlet api method code http servlet request httpservletrequest get remote user getremoteuser code code principals code representing security roles author ized authorized security role realm configured lists fully qualified java names classes implement code java security principal code identifies representing user identifies representing security role realm iter ates iterates code principals code returned code subject get principals getprincipals code identify code principal code matches user classes list code principal code user realm iter ates iterates code principals code returned code subject get principals getprincipals code accumulate code principals code matching role classes list identifying security roles user configuration error jaas login method validated code subject code code principal code matches user classes list enclosing container serves application jaas login context logincontext catalina installation tomcat find application jaas configuration file hypothetical jaas configuration file entry database oriented login module tomcat managed jndi database resource blockquote pre catalina org foo bar foobar data base login module databaseloginmodule required jndi resource jdbc authdb user table users user column user column user credential column password role table roles role column principal factory org foo bar foobar impl simple principal factory simpleprincipalfactory pre blockquote jaas configuration file location code catalina opts code environment variable blockquote code catalina opts djava security login config catalina conf jaas config code blockquote login process jaas realm jaasrealm registers code callback handler callbackhandler code called unsurprisingly code jaas callback handler jaascallbackhandler code handler sup plies supplies http requests username credentials user supplied code login module loginmodule code code realm code implementations digested pass words passwords supported code realm code element code server xml code code digest code attribute code jaas callback handler jaascallbackhandler code digest password prior passing code login module loginmodule code author craig mc clanahan mcclanahan author yoav shapira jaas realm jaasrealm realm base realmbase log log log factory logfactory get log getlog jaas realm jaasrealm instance variables application passed jaas code login context logincontext code select relevant code login module loginmodule code string app name appname descriptive code realm code implementation string info org apache catalina realm jaas realm jaasrealm descriptive code realm code implementation string jaas realm jaasrealm list role names split easy processing list string role classes roleclasses array list arraylist string user names split easy processing list string user classes userclasses array list arraylist string context class loader classloader class loader classloader context class loader classloader use context class loader usecontextclassloader path find jaas configuration file global jvm jaas configuration string config file configfile configuration jaas configuration jaasconfiguration jaas configuration loaded jaasconfigurationloaded properties getter code config file configfile code member variable string get config file getconfigfile config file configfile setter code config file configfile code member variable set config file setconfigfile string config file configfile config file configfile config file configfile set ter setter code app name appname code member variable set app name setappname string app name appname get ter getter code app name appname code member variable string get app name getappname app name appname sets context class loader classloader context class loader classloader param use context usecontext context class loader classloader set use context class loader setusecontextclassloader use context usecontext use context class loader usecontextclassloader use context usecontext log info setting use context class loader usecontextclassloader use context usecontext returns context class loader classloader context class loader classloader use context class loader usecontextclassloader is use context class loader isusecontextclassloader use context class loader usecontextclassloader override set container setcontainer container container set container setcontainer container app name appname string container get name getname starts with startswith makelegalforjaas app name appname log info jaas app app name appname comma delimited list code java security principal code classes represent security roles string role class names roleclassnames string get role class names getroleclassnames role class names roleclassnames sets list comma delimited classes represent roles classes list implement code java security principal code supplied list classes parsed link start called set role class names setroleclassnames string role class names roleclassnames role class names roleclassnames role class names roleclassnames parses comma delimited list names store names list implement code java security principal code param class names string classnamesstring comma delimited list fully qualified names param class names list classnameslist list names stored list cleared pop ulated populated parse class names parseclassnames string class names string classnamesstring list string class names list classnameslist class names list classnameslist clear class names string classnamesstring class loader classloader loader get class getclass get class loader getclassloader is use context class loader isusecontextclassloader loader thread current thread currentthread get context class loader getcontextclassloader string class names classnames class names string classnamesstring split class names classnames length class names classnames length principal class principalclass for name forname class names classnames loader principal is assignable from isassignablefrom principal class principalclass class names list classnameslist add class names classnames log error class names classnames implementing java security principal class not found exception classnotfoundexception log error class names classnames comma delimited list code java security principal code classes represent individual users string user class names userclassnames string get user class names getuserclassnames user class names userclassnames sets list comma delimited classes represent individual users classes list implement code java security principal code supplied list classes parsed link start called set user class names setuserclassnames string user class names userclassnames user class names userclassnames user class names userclassnames descriptive realm implementation version number format code description version code override string get info getinfo info methods code principal code username credentials code code param username username code principal code param credentials password credentials auth enticating authenticating username override principal authenticate string username string credentials authenticate username jaas callback handler jaascallbackhandler username credentials code principal code username digest code code param username username code principal code param client digest clientdigest digest auth enticating authenticating username param non ce nonce server generated non ce nonce param non ce nonce count param cnonce client generated non ce nonce param qop quality protection applied message param realm name realmname realm param digest calculate digest method uri override principal authenticate string username string client digest clientdigest string non ce nonce string string cnonce string qop string realm name realmname string authenticate username jaas callback handler jaascallbackhandler username client digest clientdigest non ce nonce cnonce qop realm name realmname http servlet request httpservletrequest digest methods methods perform actual jaas authentication principal authenticate string username callback handler callbackhandler callback handler callbackhandler establish login context logincontext authentication login context logincontext login context logincontext app name appname app name appname tomcat log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm begin login beginlogin username app name appname login module loginmodule container loader class loader classloader ocl is use context class loader isusecontextclassloader ocl thread current thread currentthread get context class loader getcontextclassloader thread current thread currentthread set context class loader setcontextclassloader get class getclass get class loader getclassloader configuration config get config getconfig login context logincontext login context logincontext app name appname callback handler callbackhandler config throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring jaas realm jaasrealm unexpected error unexpectederror is use context class loader isusecontextclassloader thread current thread currentthread set context class loader setcontextclassloader ocl log is debug enabled isdebugenabled log debug login context created username negotiate login login context logincontext subject subject login context logincontext login subject login context logincontext get subject getsubject subject log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm failed login failedlogin username acc ount expired exception accountexpiredexception log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm account expired accountexpired username credential expired exception credentialexpiredexception log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm credential expired credentialexpired username failed login exception failedloginexception log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm failed login failedlogin username login exception loginexception log warn get string getstring jaas realm jaasrealm login exception loginexception username throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring jaas realm jaasrealm unexpected error unexpectederror log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm login context created logincontextcreated username principal authenticated subject principal principal create principal createprincipal username subject login context logincontext principal log debug get string getstring jaas realm jaasrealm authenticate failure authenticatefailure username log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm authenticate success authenticatesuccess username principal throwable log error error code realm code implementation override string get name getname password principal user returns jaas realm jaasrealm obtaining override string get password getpassword string username code principal code user override principal get principal getprincipal string username authenticate username jaas callback handler jaascallbackhandler username http servlet request httpservletrequest client cert identify code java security principal code instance representing authenticated user code subject code principal constructed scanning list principals returned jaas login module jaasloginmodule code principal code object matches names supplied user user principal object returned caller remaining principal objects returned login modules loginmodules mapped roles res pective respective classes match role classes user principal constructed code code param subject code subject code representing log ged logged user param login context logincontext principal link login context logincontext log out logout called principal create principal createprincipal string username subject subject login context logincontext login context logincontext prepare scan principals subject list string roles array list arraylist string principal user principal userprincipal scan principals subject iterator principal principals subject get principals getprincipals iterator principals has next hasnext principal principal principals string principal class principalclass principal get class getclass get name getname log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm check principal checkprincipal principal principal class principalclass user principal userprincipal user classes userclasses principal class principalclass user principal userprincipal principal log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm user principal success userprincipalsuccess principal get name getname role classes roleclasses principal class principalclass roles add principal get name getname log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm role principal add roleprincipaladd principal get name getname print failure message needed user principal userprincipal log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm user principal failure userprincipalfailure log debug get string getstring jaas realm jaasrealm role principal failure roleprincipalfailure roles size log is debug enabled isdebugenabled log debug get string getstring jaas realm jaasrealm role principal failure roleprincipalfailure principal authenticated user generic principal genericprincipal username roles user principal userprincipal login context logincontext ensure legal jaas configuration bug zilla bugzilla easy customization implementation ins ufficient insufficient param src validate string valid jaas realm string makelegalforjaas string src string result src jaas spec result result bar fs barfs bug zilla bugzilla bug report result starts with startswith result result substring result lifecycle methods prepare active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception called loading configuration use context class loader usecontextclassloader appears xml config parse class names parseclassnames user class names userclassnames user classes userclasses parse class names parseclassnames role class names roleclassnames role classes roleclasses start internal startinternal load custom jaas configuration configuration get config getconfig jaas configuration loaded jaasconfigurationloaded jaas configuration jaasconfiguration config file configfile jaas configuration loaded jaasconfigurationloaded url resource thread current thread currentthread get context class loader getcontextclassloader get resource getresource config file configfile uri uri resource touri suppress warnings suppresswarnings unchecked configuration sun config file sunconfigfile configuration for name forname sun security login config file configfile constructor configuration constructor sun config file sunconfigfile get constructor getconstructor uri configuration config constructor new instance newinstance uri jaas configuration jaasconfiguration config jaas configuration loaded jaasconfigurationloaded jaas configuration jaasconfiguration uri syntax exception urisyntaxexception runtime exception runtimeexception no such method exception nosuchmethodexception runtime exception runtimeexception security exception securityexception runtime exception runtimeexception instantiation exception instantiationexception runtime exception runtimeexception illegal access exception illegalaccessexception runtime exception runtimeexception illegal argument exception illegalargumentexception runtime exception runtimeexception invocation target exception invocationtargetexception runtime exception runtimeexception get cause getcause class not found exception classnotfoundexception runtime exception runtimeexception
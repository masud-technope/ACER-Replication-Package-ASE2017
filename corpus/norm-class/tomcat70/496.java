licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat jdbc test java util map org junit org junit test org apache tomcat jdbc pool connection pool connectionpool org apache tomcat jdbc pool data source datasource pool cleaner test poolcleanertest default test case defaulttestcase count pool cleaner threads countpoolcleanerthreads map thread stack trace element stacktraceelement thread map threadmap thread get all stack traces getallstacktraces result thread thread map threadmap key set keyset get name getname starts with startswith pool cleaner poolcleaner result result test test pool cleaner testpoolcleaner exception datasource get pool properties getpoolproperties set time between eviction runs millis settimebetweenevictionrunsmillis datasource get pool properties getpoolproperties set test while idle settestwhileidle assert equals assertequals pool cleaner started connection pool connectionpool get pool clean ers getpoolcleaners size assert null assertnull pool timer connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads count pool cleaner threads countpoolcleanerthreads datasource get connection getconnection close assert equals assertequals pool cleaner cleaner connection pool connectionpool get pool clean ers getpoolcleaners size assert not null assertnotnull pool timer connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads count pool cleaner threads countpoolcleanerthreads datasource close assert equals assertequals pool shutdown clean ers cleaners connection pool connectionpool get pool clean ers getpoolcleaners size assert null assertnull pool timer shutdown connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads close count pool cleaner threads countpoolcleanerthreads test test pool clean ers poolcleaners exception datasource get pool properties getpoolproperties set time between eviction runs millis settimebetweenevictionrunsmillis datasource get pool properties getpoolproperties set test while idle settestwhileidle data source datasource data source datasource datasource get pool properties getpoolproperties assert equals assertequals pool cleaner started connection pool connectionpool get pool clean ers getpoolcleaners size assert null assertnull pool timer connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads count pool cleaner threads countpoolcleanerthreads datasource get connection getconnection close get connection getconnection close assert equals assertequals pool cleaner cleaner connection pool connectionpool get pool clean ers getpoolcleaners size assert not null assertnotnull pool timer connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads count pool cleaner threads countpoolcleanerthreads datasource close assert equals assertequals pool cleaner cleaner connection pool connectionpool get pool clean ers getpoolcleaners size assert not null assertnotnull pool timer connection pool connectionpool get pool timer getpooltimer close assert equals assertequals pool shutdown clean ers cleaners connection pool connectionpool get pool clean ers getpoolcleaners size assert null assertnull pool timer shutdown connection pool connectionpool get pool timer getpooltimer assert equals assertequals pool cleaner threads close count pool cleaner threads countpoolcleanerthreads test test idle timeout testidletimeout exception datasource get pool properties getpoolproperties set time between eviction runs millis settimebetweenevictionrunsmillis datasource get pool properties getpoolproperties set test while idle settestwhileidle datasource get pool properties getpoolproperties set max idle setmaxidle datasource get pool properties getpoolproperties set initial size setinitialsize datasource get pool properties getpoolproperties set min idle setminidle datasource get pool properties getpoolproperties set min evictable idle time millis setminevictableidletimemillis datasource get connection getconnection close assert equals assertequals pool idle datasource get idle getidle thread sleep assert equals assertequals pool idle datasource get idle getidle
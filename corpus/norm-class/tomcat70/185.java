licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java file java io exception ioexception java util array list arraylist java util list javax servlet servlet exception servletexception javax servlet servlet request event servletrequestevent javax servlet servlet request listener servletrequestlistener javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test org apache catalina context org apache catalina connector response org apache catalina deploy error page errorpage org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk test standard host valve teststandardhostvalve tomcat base test tomcatbasetest test test error page handling testerrorpagehandling exception container tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext add error tomcat add servlet addservlet ctx error error servlet errorservlet ctx add servlet mapping addservletmapping error error add error handling tomcat add servlet addservlet ctx report report servlet reportservlet ctx add servlet mapping addservletmapping report report handling resp onses responses error page errorpage error page errorpage error page errorpage error page errorpage set error code seterrorcode response internal server error error page errorpage set location setlocation report ctx add error page adderrorpage error page errorpage error handling error page errorpage error page default errorpagedefault error page errorpage error page default errorpagedefault set location setlocation report ctx add error page adderrorpage error page default errorpagedefault tomcat start do test error page handling dotesterrorpagehandling do test error page handling dotesterrorpagehandling test expected illegal argument exception illegalargumentexception test invalid error page testinvaliderrorpage exception container tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext add broken error configuration error page errorpage error page errorpage error page errorpage error page errorpage set error code seterrorcode java lang exception error page errorpage set location setlocation report ctx add error page adderrorpage error page errorpage test testsrlaftererror exception container tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required file doc base docbase file system get property getproperty java tmp dir tmpdir context ctx tomcat add context addcontext doc base docbase get absolute path getabsolutepath add error tomcat add servlet addservlet ctx error error servlet errorservlet ctx add servlet mapping addservletmapping error error list string result array list arraylist string add request listener servlet request listener servletrequestlistener servlet request listener servletrequestlistener servlet request listener servletrequestlistener override request destroyed requestdestroyed servlet request event servletrequestevent sre result add visit request destroyed requestdestroyed override request initialized requestinitialized servlet request event servletrequestevent sre result add visit request initialized requestinitialized standard context standardcontext ctx add application event listener addapplicationeventlistener servlet request listener servletrequestlistener tomcat start request triggers error byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport error error code errorcode assert equals assertequals assert true asserttrue result visit request initialized requestinitialized assert true asserttrue result visit request destroyed requestdestroyed do test error page handling dotesterrorpagehandling error string report exception request triggers error byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport error error code errorcode error assert equals assertequals error assert equals assertequals report to string tostring error servlet errorservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception error integer parse int parseint req get parameter getparameter error code errorcode resp send error senderror error report servlet reportservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception string path info pathinfo req get path info getpathinfo resp set content type setcontenttype text plain resp get writer getwriter print path info pathinfo
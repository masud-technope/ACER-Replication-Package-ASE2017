licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina ssi java text parse exception parseexception java util linked list linkedlist java util list java util regex pattern java util regex pattern syntax exception patternsyntaxexception represents parsed expression author paul speed expression parse tree expressionparsetree current completed nodes workspace parser linked list linkedlist node node stack nodestack linked list linkedlist node nodes don values workspace parser linked list linkedlist opp node oppnode opp stack oppstack linked list linkedlist opp node oppnode root node expression parsed node root ssi mediator ssimediator eval uating evaluating expressions ssi mediator ssimediator ssi mediator ssimediator creates parse tree expression expression parse tree expressionparsetree string expr ssi mediator ssimediator ssi mediator ssimediator parse exception parseexception ssi mediator ssimediator ssi mediator ssimediator parse expression parseexpression expr eval uates evaluates tree returns ssi mediator ssimediator resolve variable references evaluate tree evaluatetree root evaluate pushes opp stack resolving existing opps needed push opp pushopp opp node oppnode node node group marker node opp stack oppstack add node opp stack oppstack size opp node oppnode top opp stack oppstack top stay top get precedence getprecedence node get precedence getprecedence remove top node opp stack oppstack remove fill branches top pop values popvalues node stack nodestack stick resolved node stack node stack nodestack add top add node opp stack opp stack oppstack add node resolves pending opp nodes stack group marker reached resolve group resolvegroup opp node oppnode top top opp stack oppstack remove fill branches top pop values popvalues node stack nodestack stick resolved node stack node stack nodestack add top parses expression tree parse nodes parse expression parseexpression string expr parse exception parseexception string node stringnode curr string node currstringnode cheat start artificial group fin ishing finishing easier push opp pushopp expression tokenizer expressiontokenizer expression tokenizer expressiontokenizer expr has more tokens hasmoretokens token next token nexttoken token expression tokenizer expressiontokenizer token string curr string node currstringnode token expression tokenizer expressiontokenizer token string curr string node currstringnode curr string node currstringnode string node stringnode get token value gettokenvalue node stack nodestack add curr string node currstringnode add existing curr string node currstringnode append curr string node currstringnode append get token value gettokenvalue expression tokenizer expressiontokenizer token push opp pushopp and node andnode expression tokenizer expressiontokenizer token push opp pushopp or node ornode expression tokenizer expressiontokenizer token push opp pushopp not node notnode expression tokenizer expressiontokenizer token push opp pushopp equal node equalnode expression tokenizer expressiontokenizer token push opp pushopp not node notnode sneak regular node resolved opp opp stack oppstack add equal node equalnode expression tokenizer expressiontokenizer token rbrace close out closeout current group resolve group resolvegroup expression tokenizer expressiontokenizer token lbrace push group marker push opp pushopp expression tokenizer expressiontokenizer token push opp pushopp not node notnode str ategy strategy opp stack oppstack add less than node lessthannode expression tokenizer expressiontokenizer token push opp pushopp not node notnode str ategy strategy greater opp stack oppstack add greater than node greaterthannode expression tokenizer expressiontokenizer token push opp pushopp greater than node greaterthannode expression tokenizer expressiontokenizer token push opp pushopp less than node lessthannode expression tokenizer expressiontokenizer token finish opps resolve group resolvegroup node stack nodestack size parse exception parseexception nodes created get index getindex node stack nodestack size parse exception parseexception extra nodes created get index getindex opp stack oppstack size parse exception parseexception unused opp nodes exist get index getindex root node stack nodestack node expression parse tree node node eval uates evaluates evaluate node represents string string node stringnode node string builder stringbuilder string resolved string node stringnode string string builder stringbuilder resolves variable references returns string string get value getvalue resolved resolved ssi mediator ssimediator substitute variables substitutevariables to string tostring resolved returns string empty override evaluate get value getvalue length override string to string tostring to string tostring precedence precedence compare precedence log ical logical node implementation represents operation opp node oppnode node left branch node left branch node returns preference level suitable comparison opp node oppnode preference levels get precedence getprecedence node pop branch nodes front list pulls pop values popvalues list node values values remove left values remove not node notnode opp node oppnode override evaluate left evaluate override get precedence getprecedence precedence overridden pop override pop values popvalues list node values left values remove override string to string tostring left and node andnode opp node oppnode override evaluate circuit left evaluate evaluate override get precedence getprecedence precedence log ical logical override string to string tostring left or node ornode opp node oppnode override evaluate circuit left evaluate evaluate override get precedence getprecedence precedence log ical logical override string to string tostring left compare node comparenode opp node oppnode compare branches comparebranches string val string node stringnode left get value getvalue string val string node stringnode get value getvalue val len val length val len val char at charat val char at charat val len treat regular expression string expr val substring val len pattern pattern pattern compile expr equal equal pattern matcher val find pattern syntax exception patternsyntaxexception pse ssi mediator ssimediator log invalid expression expr pse val compare to compareto val equal node equalnode compare node comparenode override evaluate compare branches comparebranches override get precedence getprecedence precedence compare override string to string tostring left greater than node greaterthannode compare node comparenode override evaluate compare branches comparebranches override get precedence getprecedence precedence compare override string to string tostring left less than node lessthannode compare node comparenode override evaluate compare branches comparebranches override get precedence getprecedence precedence compare override string to string tostring left
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache coyote ajp java byte array input stream bytearrayinputstream java i o exception ioexception java interruptedioexception java net inet address inetaddress java security no such provider exception nosuchproviderexception java security cert certificate factory certificatefactory java security cert certificate java util concurrent atomic atomic boolean atomicboolean javax servlet http http servlet response httpservletresponse org apache coyote abstract processor abstractprocessor org apache coyote action code actioncode org apache coyote async context callback asynccontextcallback org apache coyote error state errorstate org apache coyote input buffer inputbuffer org apache coyote output buffer outputbuffer org apache coyote request org apache coyote request info requestinfo org apache coyote response org apache coyote http upgrade servlet http upgrade handler httpupgradehandler org apache tomcat util exception utils exceptionutils org apache tomcat util buf byte chunk bytechunk org apache tomcat util buf hex utils hexutils org apache tomcat util buf message bytes messagebytes org apache tomcat util http http messages httpmessages org apache tomcat util http mime headers mimeheaders org apache tomcat util net abstract endpoint abstractendpoint org apache tomcat util net abstract endpoint abstractendpoint handler socket state socketstate org apache tomcat util net ssl support sslsupport org apache tomcat util net socket status socketstatus org apache tomcat util res string manager stringmanager base ajp processor implementations abstract ajp processor abstractajpprocessor abstract processor abstractprocessor string manager string manager stringmanager string manager stringmanager get manager getmanager constants message array end message array endmessagearray end and close message array endandclosemessagearray flush message array flush message array flushmessagearray pong message array pong message array pongmessagearray all ocate allocate message array ajp message ajpmessage end message endmessage ajp message ajpmessage end message endmessage reset end message endmessage append byte appendbyte constants ajp response end message endmessage append byte appendbyte end message endmessage end message array endmessagearray end message endmessage get len getlen system arraycopy end message endmessage get buffer getbuffer end message array endmessagearray end message endmessage get len getlen all ocate allocate close message array ajp message ajpmessage end and close message endandclosemessage ajp message ajpmessage end and close message endandclosemessage reset end and close message endandclosemessage append byte appendbyte constants ajp response end and close message endandclosemessage append byte appendbyte end and close message endandclosemessage end and close message array endandclosemessagearray end and close message endandclosemessage get len getlen system arraycopy end and close message endandclosemessage get buffer getbuffer end and close message array endandclosemessagearray end and close message endandclosemessage get len getlen all ocate allocate flush message array ajp message ajpmessage flush message flushmessage ajp message ajpmessage flush message flushmessage reset flush message flushmessage append byte appendbyte constants ajp send body chunk flush message flushmessage append int appendint flush message flushmessage append byte appendbyte flush message flushmessage flush message array flushmessagearray flush message flushmessage get len getlen system arraycopy flush message flushmessage get buffer getbuffer flush message array flushmessagearray flush message flushmessage get len getlen all ocate allocate pong message array ajp message ajpmessage pong message pongmessage ajp message ajpmessage pong message pongmessage reset pong message pongmessage append byte appendbyte constants ajp c pong cpong reply pong message pongmessage pong message array pongmessagearray pong message pongmessage get len getlen system arraycopy pong message pongmessage get buffer getbuffer pong message array pongmessagearray pong message pongmessage get len getlen instance variables get body getbody message array message arrays message var ies varies packet size packetsize vary connector get body message array getbodymessagearray ajp packet size packet size packetsize header message note header processing message request request header stay unchanged processing request ajp message ajpmessage request header message requestheadermessage message response comp osition composition ajp message ajpmessage response message responsemessage body message ajp message ajpmessage body message bodymessage body message message bytes messagebytes body bytes bodybytes message bytes messagebytes new instance newinstance host avoid use less useless conversion host host name c hostnamec temp message bytes processing message bytes messagebytes tmpmb message bytes messagebytes new instance newinstance chunk certs message bytes messagebytes certificates message bytes messagebytes new instance newinstance stream flag end of stream endofstream body empty flag empty read rep lay replay read replay response body swallowed client swallow response swallowresponse finished response finished bytes written client current request bytes written byteswritten abstract ajp processor abstractajpprocessor packet size packetsize abstract endpoint abstractendpoint endpoint endpoint packet size packetsize packet size packetsize request set input buffer setinputbuffer socket input buffer socketinputbuffer request header message requestheadermessage ajp message ajpmessage packet size packetsize response message responsemessage ajp message ajpmessage packet size packetsize body message bodymessage ajp message ajpmessage packet size packetsize get body getbody message buffer ajp message ajpmessage get body message getbodymessage ajp message ajpmessage get body message getbodymessage reset get body message getbodymessage append byte appendbyte constants ajp body chunk adjust read size packet size packetsize constants max packet size get body message getbodymessage append int appendint constants max read size packet size packetsize constants max packet size get body message getbodymessage get body message array getbodymessagearray get body message getbodymessage get len getlen system arraycopy get body message getbodymessage get buffer getbuffer get body message array getbodymessagearray get body message getbodymessage get len getlen properties send ajp flush packet flushing flush packet ajp send body chunk packet mod mod proxy ajp int erprete interprete request flush data client ajp flush response pack ets packets str eamed streamed client extra flush pack ets packets compatibility stay safe side flush pack ets packets enabled ajp flush ajpflush get ajp flush getajpflush ajp flush ajpflush set ajp flush setajpflush ajp flush ajpflush ajp flush ajpflush ajp flush ajpflush number milliseconds tomcat wait subsequent request closing connection apache http server milliseconds keep alive timeout keepalivetimeout get keep alive timeout getkeepalivetimeout keep alive timeout keepalivetimeout set keep alive timeout setkeepalivetimeout timeout keep alive timeout keepalivetimeout timeout tomcat authentication tomcat authentication tomcatauthentication get tomcat authentication gettomcatauthentication tomcat authentication tomcatauthentication set tomcat authentication settomcatauthentication tomcat authentication tomcatauthentication tomcat authentication tomcatauthentication tomcat authentication tomcatauthentication tomcat authorization tomcat authorization tomcatauthorization get tomcat authorization gettomcatauthorization tomcat authorization tomcatauthorization set tomcat authorization settomcatauthorization tomcat authorization tomcatauthorization tomcat authorization tomcatauthorization tomcat authorization tomcatauthorization required secret string required secret requiredsecret set required secret setrequiredsecret string required secret requiredsecret required secret requiredsecret required secret requiredsecret client certificate presented form instances link java security cert certificate converted property controls jsse provider perform conversion ajp connectors http apr connector link org apache catalina valves ssl valve sslvalve provider string client cert provider clientcertprovider string get client cert provider getclientcertprovider client cert provider clientcertprovider set client cert provider setclientcertprovider string client cert provider clientcertprovider methods send action connector param action code actioncode type action param param action parameter override action action code actioncode action code actioncode object param action code actioncode c ommit commit response is committed iscommitted validate write response headers prepare response prepareresponse i o exception ioexception set error state seterrorstate error state errorstate close flush i o exception ioexception set error state seterrorstate error state errorstate close client flush response is committed iscommitted validate write response headers prepare response prepareresponse i o exception ioexception set error state seterrorstate error state errorstate close flush i o exception ioexception set error state seterrorstate error state errorstate close error atomic boolean atomicboolean param get error state geterrorstate is error iserror disable swallow input todo swallow request input closing connection set error state seterrorstate error state errorstate close clean close finish i o exception ioexception set error state seterrorstate error state errorstate close req ssl attribute certificates is null isnull byte chunk bytechunk cert data certdata certificates get byte chunk getbytechunk certificate jsse certs jssecerts byte array input stream bytearrayinputstream bais byte array input stream bytearrayinputstream cert data certdata get bytes getbytes cert data certdata get start getstart cert data certdata get length getlength fill elements certificate factory certificatefactory client cert provider clientcertprovider certificate factory certificatefactory get instance getinstance certificate factory certificatefactory get instance getinstance client cert provider clientcertprovider bais certificate cert certificate generate certificate generatecertificate bais jsse certs jssecerts jsse certs jssecerts certificate jsse certs jssecerts cert certificate temp certificate jsse certs jssecerts length system arraycopy jsse certs jssecerts temp jsse certs jssecerts length temp jsse certs jssecerts length cert jsse certs jssecerts temp java security cert certificate exception certificateexception get log getlog error get string getstring ajpprocessor certs fail no such provider exception nosuchproviderexception get log getlog error get string getstring ajpprocessor certs fail request set attribute setattribute ssl support sslsupport c ertificate certificate key jsse certs jssecerts req host attribute remote host dns resolution request remote host remotehost is null isnull request remote host remotehost set string setstring inet address inetaddress get by name getbyname request remote addr remoteaddr to string tostring get host name gethostname i o exception ioexception iex req local addr attribute mode rn modern ajp for war der forwarder copy local request local addr localaddr is null isnull request local addr localaddr set string setstring request local name localname to string tostring req body replay bytes content byte chunk bytechunk byte chunk bytechunk param length get length getlength body bytes bodybytes set bytes setbytes get bytes getbytes get start getstart length request set content length setcontentlength length empty replay end of stream endofstream async start async state machine asyncstatemachine async start asyncstart async context callback asynccontextcallback param async time based socket wrapper socketwrapper access time get socket wrapper getsocketwrapper access async dispatched async state machine asyncstatemachine async dispatched asyncdispatched async timeout atomic boolean atomicboolean result atomic boolean atomicboolean param result async state machine asyncstatemachine async timeout asynctimeout async async state machine asyncstatemachine async run asyncrun runnable param async error async state machine asyncstatemachine async error asyncerror async started atomic boolean atomicboolean param async state machine asyncstatemachine is async started isasyncstarted async c ompleting completing atomic boolean atomicboolean param async state machine asyncstatemachine is comp leting iscompleting async dispatching atomic boolean atomicboolean param async state machine asyncstatemachine is async dispatching isasyncdispatching async async atomic boolean atomicboolean param async state machine asyncstatemachine is async isasync async timingout atomic boolean atomicboolean param async state machine asyncstatemachine is async timing out isasynctimingout async error atomic boolean atomicboolean param async state machine asyncstatemachine is async error isasyncerror async post process async state machine asyncstatemachine async post process asyncpostprocess upgrade tomcat noop action internal actioninternal action code actioncode param close prevent writes response swallow response swallowresponse set error state seterrorstate error state errorstate close request ajp override socket state socketstate async dispatch asyncdispatch socket status socketstatus status request info requestinfo request get request processor getrequestprocessor set s tag e setstage org apache coyote constants stage service get adapter getadapter async dispatch asyncdispatch request response status set error state seterrorstate error state errorstate close reset time outs resettimeouts interruptedioexception set error state seterrorstate error state errorstate close throwable exception utils exceptionutils handle throwable handlethrowable set error state seterrorstate error state errorstate close get log getlog error get string getstring http processor request process get error state geterrorstate is error iserror internal server error response set status setstatus adapter log request response set s tag e setstage org apache coyote constants stage ended is async isasync get error state geterrorstate is error iserror request update count ers updatecounters socket state socketstate closed socket state socketstate request update count ers updatecounters get error state geterrorstate is error iserror socket state socketstate closed recycle socket state socketstate open override set ssl support setsslsupport ssl support sslsupport ssl support sslsupport reach code illegal state exception illegalstateexception get string getstring ajpprocessor ssl not supported notsupported override socket state socketstate event socket status socketstatus status i o exception ioexception reach code i o exception ioexception get string getstring ajpprocessor comet not supported notsupported override socket state socketstate upgrade dispatch upgradedispatch i o exception ioexception reach code i o exception ioexception get string getstring ajpprocessor http upgrade httpupgrade not supported notsupported deprecated removed tomcat deprecated override org apache coyote http upgrade upgrade inbound upgradeinbound get upgrade inbound getupgradeinbound upgrade d upgraded tomcat prop rietary proprietary http upgrade mechanism override socket state socketstate upgrade dispatch upgradedispatch socket status socketstatus status i o exception ioexception reach code i o exception ioexception get string getstring ajpprocessor http upgrade httpupgrade not supported notsupported override http upgrade handler httpupgradehandler get http upgrade handler gethttpupgradehandler reach code illegal state exception illegalstateexception get string getstring ajpprocessor http upgrade httpupgrade not supported notsupported recycle processor ready request connection connection param socket closing socketclosing socket closed allowing processor perform additional clean required override recycle socket closing socketclosing get adapter getadapter check recycle d checkrecycled request response async state machine asyncstatemachine recycle recycle request object end of stream endofstream empty replay finished request recycle response recycle certificates recycle swallow response swallowresponse bytes written byteswritten reset error state reseterrorstate methods methods called action action internal actioninternal action code actioncode action code actioncode object param methods called async dispatch asyncdispatch mechanism connector implementations nio reset time outs timeouts async time outs timeouts standard http time outs timeouts async processing comp letes completes reset time outs resettimeouts methods called prepare response prepareresponse output src offset length i o exception ioexception methods socket input buffer socketinputbuffer receive i o exception ioexception override is comet iscomet ajp support comet override is upgrade isupgrade ajp support http upgrade request body data web server store internal buffer data ref ill read buffer refillreadbuffer i o exception ioexception form support replay read end of stream endofstream end of stream endofstream request data output get body message array getbodymessagearray get body message array getbodymessagearray length more data moredata receive more data moredata end of stream endofstream more data moredata reading request headers setup request filters prepare request preparerequest translate http method code string method code methodcode request header message requestheadermessage get byte getbyte method code methodcode constants stored string method name methodname constants get method for code getmethodforcode method code methodcode request method set string setstring method name methodname request header message requestheadermessage get bytes getbytes request protocol request header message requestheadermessage get bytes getbytes request requesturi request header message requestheadermessage get bytes getbytes request remote addr remoteaddr request header message requestheadermessage get bytes getbytes request remote host remotehost request header message requestheadermessage get bytes getbytes request local name localname request set local port setlocalport request header message requestheadermessage get int getint isssl request header message requestheadermessage get byte getbyte isssl request scheme set string setstring https decode headers mime headers mimeheaders headers request get mime headers getmimeheaders time limit changed jmx headers set limit setlimit endpoint get max header count getmaxheadercount request get cookies getcookies set limit setlimit get max cookie count getmaxcookiecount content length set contentlengthset h count hcount request header message requestheadermessage get int getint h count hcount string h name hname header names encoded int eger integer code starting normal string bytes length isc request header message requestheadermessage peek int peekint isc xff message bytes messagebytes vmb isc xff isc advance read position request header message requestheadermessage get int getint h name hname constants get header for code getheaderforcode vmb headers add value addvalue h name hname reset header read bytes code content type header content length header req content type req content length leading unexpected behaviour bug request header message requestheadermessage get bytes getbytes tmpmb byte chunk bytechunk tmpmb get byte chunk getbytechunk vmb headers add value addvalue get buffer getbuffer get start getstart get length getlength request header message requestheadermessage get bytes getbytes vmb constants req content length tmpmb equals ignore case equalsignorecase content length vmb get long getlong content length set contentlengthset response set status setstatus http servlet response httpservletresponse bad request set error state seterrorstate error state errorstate close clean content length set contentlengthset content length header request request set content length setcontentlength constants req content type tmpmb equals ignore case equalsignorecase content type read content type header byte chunk bytechunk bchunk vmb get byte chunk getbytechunk request content type contenttype set bytes setbytes bchunk get bytes getbytes bchunk get offset getoffset bchunk get length getlength decode extra attributes secret attribute code attributecode attribute code attributecode request header message requestheadermessage get byte getbyte constants attribute code attributecode constants req attribute request header message requestheadermessage get bytes getbytes tmpmb string tmpmb to string tostring request header message requestheadermessage get bytes getbytes tmpmb string tmpmb to string tostring ajp misses local add ress address remote port ajp connector add info request attributes accept for warded forwarded data remove list request attributes equals constants req local addr request local addr localaddr set string setstring equals constants req remote port request set remote port setremoteport integer parse int parseint number format exception numberformatexception nfe equals constants ssl protocol request set attribute setattribute ssl support sslsupport protocol version key request set attribute setattribute constants context request header message requestheadermessage get bytes getbytes tmpmb constants servlet path request header message requestheadermessage get bytes getbytes tmpmb constants remote user tomcat authorization tomcatauthorization tomcat authentication tomcatauthentication impl ies implies tomcat authentication tomcatauthentication request header message requestheadermessage get bytes getbytes request get remote user getremoteuser request set remote user needs authorization setremoteuserneedsauthorization tomcat authorization tomcatauthorization ignore user reverse proxy request header message requestheadermessage get bytes getbytes tmpmb constants type tomcat authentication tomcatauthentication ignore server request header message requestheadermessage get bytes getbytes tmpmb request header message requestheadermessage get bytes getbytes request get auth type getauthtype constants query string request header message requestheadermessage get bytes getbytes request query string querystring constants jvm route request header message requestheadermessage get bytes getbytes request instance i d instanceid constants ssl cert request scheme set string setstring https ssl certificate extract ion extraction lazy moved jk coyote handler jkcoyotehandler request header message requestheadermessage get bytes getbytes certificates constants ssl cipher request scheme set string setstring https request header message requestheadermessage get bytes getbytes tmpmb request set attribute setattribute ssl support sslsupport cipher suite key tmpmb to string tostring constants ssl session request scheme set string setstring https request header message requestheadermessage get bytes getbytes tmpmb request set attribute setattribute ssl support sslsupport session key tmpmb to string tostring constants ssl key size request set attribute setattribute ssl support sslsupport key size key integer value of valueof request header message requestheadermessage get int getint constants stored method request header message requestheadermessage get bytes getbytes request method constants secret request header message requestheadermessage get bytes getbytes tmpmb required secret requiredsecret secret tmpmb equals required secret requiredsecret response set status setstatus set error state seterrorstate error state errorstate close clean ignore unknown attribute compatibility check secret sub mitted submitted required required secret requiredsecret secret response set status setstatus set error state seterrorstate error state errorstate close clean check full uri including protocol host port byte chunk bytechunk uribc request requesturi get byte chunk getbytechunk uribc starts with ignore case startswithignorecase http pos uribc index of indexof uribcstart uribc get start getstart slash pos slashpos pos uri b urib uribc get bytes getbytes slash pos slashpos uribc index of indexof pos slash pos slashpos slash pos slashpos uribc get length getlength uri request requesturi set bytes setbytes uri b urib uribcstart pos request requesturi set bytes setbytes uri b urib uribcstart slash pos slashpos uribc get length getlength slash pos slashpos message bytes messagebytes hostmb headers set value setvalue host hostmb set bytes setbytes uri b urib uribcstart pos slash pos slashpos pos message bytes messagebytes valuemb request get mime headers getmimeheaders get value getvalue host parse host parsehost valuemb get error state geterrorstate is error iserror adapter log request response parse host parse host parsehost message bytes messagebytes valuemb valuemb valuemb is null isnull http request set server port setserverport request get local port getlocalport request server name servername duplicate request local name localname i o exception ioexception response set status setstatus set error state seterrorstate error state errorstate close clean byte chunk bytechunk valuebc valuemb get byte chunk getbytechunk value b valueb valuebc get bytes getbytes value l valuel valuebc get length getlength value s values valuebc get start getstart colon pos colonpos host name c hostnamec length value l valuel host name c hostnamec value l valuel ipv value b valueb value s values bracket closed bracketclosed value l valuel value b valueb value s values host name c hostnamec bracket closed bracketclosed ipv bracket closed bracketclosed colon pos colonpos colon pos colonpos request scheme equals ignore case equalsignorecase https https port request set server port setserverport htttp port request set server port setserverport request server name servername set chars setchars host name c hostnamec value l valuel request server name servername set chars setchars host name c hostnamec colon pos colonpos port mult value l valuel colon pos colonpos char value charvalue hex utils hexutils get dec getdec value b valueb value s values char value charvalue invalid character bad request response set status setstatus set error state seterrorstate error state errorstate close clean port port char value charvalue mult mult mult request set server port setserverport port commit ting committing response validate headers setup response filters prepare response prepareresponse i o exception ioexception response set committed setcommitted response message responsemessage reset response message responsemessage append byte appendbyte constants ajp send headers responses status codes permitted include response body status code statuscode response get status getstatus status code statuscode status code statuscode status code statuscode status code statuscode entity body swallow response swallowresponse responses head requests permitted inc ude incude response body message bytes messagebytes methodmb request method methodmb equals head entity body swallow response swallowresponse http header contents response message responsemessage append int appendint status code statuscode string message org apache coyote constants custom status msg header http messages httpmessages is safe i n http header issafeinhttpheader response get message getmessage message response get message getmessage message message http messages httpmessages get instance getinstance response get locale getlocale get message getmessage response get status getstatus message mod http d httpd fails status message bug message integer to string tostring response get status getstatus tmpmb set string setstring message response message responsemessage append bytes appendbytes tmpmb special headers mime headers mimeheaders headers response get mime headers getmimeheaders string content type contenttype response get content type getcontenttype content type contenttype headers set value setvalue content type set string setstring content type contenttype string content language contentlanguage response get content language getcontentlanguage content language contentlanguage headers set value setvalue content language set string setstring content language contentlanguage content length contentlength response get content length long getcontentlengthlong content length contentlength headers set value setvalue content length set long setlong content length contentlength headers num headers numheaders headers size response message responsemessage append int appendint num headers numheaders num headers numheaders message bytes messagebytes headers get name getname constants get response ajp index getresponseajpindex to string tostring response message responsemessage append int appendint response message responsemessage append bytes appendbytes message bytes messagebytes headers get value getvalue response message responsemessage append bytes appendbytes write buffer response message responsemessage output response message responsemessage get buffer getbuffer response message responsemessage get len getlen callback write data buffer flush explicit i o exception ioexception ajp flush ajpflush explicit finished send flush message output flush message array flushmessagearray flush message array flushmessagearray length finish ajp response finish i o exception ioexception response is committed iscommitted validate write response headers prepare response prepareresponse i o exception ioexception set error state seterrorstate error state errorstate close finished finished swallow unread body packet request get content length long getcontentlengthlong receive add message get error state geterrorstate is error iserror output end and close message array endandclosemessagearray end and close message array endandclosemessagearray length output end message array endmessagearray end message array endmessagearray length input buffer read data input stream socket input buffer socketinputbuffer input buffer inputbuffer read bytes chunk override do read doread byte chunk bytechunk chunk request req i o exception ioexception end of stream endofstream req get content length long getcontentlengthlong handle special body chunk receive empty ref ill read buffer refillreadbuffer byte chunk bytechunk body bytes bodybytes get byte chunk getbytechunk chunk set bytes setbytes get buffer getbuffer get start getstart get length getlength empty chunk get length getlength output buffer write data output stream socket output buffer socketoutputbuffer output buffer outputbuffer write chunk override do write dowrite byte chunk bytechunk chunk response res i o exception ioexception response is committed iscommitted validate write response headers prepare response prepareresponse i o exception ioexception set error state seterrorstate error state errorstate close swallow response swallowresponse len chunk get length getlength hardcoded marshaling over head overhead adjust allowed size packet size packetsize constants max packet size chunk size chunksize constants max send size packet size packetsize constants max packet size len this time thistime len this time thistime chunk size chunksize this time thistime chunk size chunksize len this time thistime response message responsemessage reset response message responsemessage append byte appendbyte constants ajp send body chunk response message responsemessage append bytes appendbytes chunk get bytes getbytes chunk get offset getoffset this time thistime response message responsemessage output response message responsemessage get buffer getbuffer response message responsemessage get len getlen this time thistime bytes written byteswritten chunk get length getlength chunk get length getlength override get bytes written getbyteswritten bytes written byteswritten
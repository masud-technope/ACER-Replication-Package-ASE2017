licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util threads java util collection java util concurrent atomic atomic long atomiclong java util concurrent locks abstract queued synchronizer abstractqueuedsynchronizer org apache juli logging log org apache juli logging log factory logfactory shared latch latch acquired limited number times subsequent requests acquire latch fifo queue shares returned limit latch limitlatch log log log factory logfactory get log getlog limit latch limitlatch sync abstract queued synchronizer abstractqueuedsynchronizer serialversionuid sync override try acquire shared tryacquireshared new count newcount count increment and get incrementandget released new count newcount limit limit exc eeded exceeded count decrement and get decrementandget override try release shared tryreleaseshared arg count decrement and get decrementandget sync sync atomic long atomiclong count limit released ins tantiates instantiates limit latch limitlatch object initial limit param limit maximum number concurrent acquisitions latch limit latch limitlatch limit limit limit count atomic long atomiclong sync sync returns current count latch current count latch get count getcount count current limit get limit getlimit limit sets limit limit dec reased decreased period shares latch acquired limit shares latch issued sufficient shares returned reduce number acquired shares latch limit limit inc reased increased threads queue issued newly shares request latch param limit limit set limit setlimit limit limit limit acquires shared latch waits shared latch current count up or await countuporawait interrupted exception interruptedexception log is debug enabled isdebugenabled log debug counting thread current thread currentthread get name getname latch get count getcount sync acquire shared interrupt ibly acquiresharedinterruptibly releases shared latch making thread previous counter count down countdown sync release shared releaseshared result get count getcount log is debug enabled isdebugenabled log debug counting thread current thread currentthread get name getname latch result result releases waiting threads link limit link reset called release all releaseall released sync release shared releaseshared resets latch initial izes initializes shared acquisition counter release all releaseall reset count released returns code code thread waiting acquire shared lock returns code code has queued threads hasqueuedthreads sync has queued threads hasqueuedthreads provide access list threads waiting acquire limited shared latch collection thread get queued threads getqueuedthreads sync get queued threads getqueuedthreads
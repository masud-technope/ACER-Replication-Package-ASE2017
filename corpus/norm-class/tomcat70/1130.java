licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache coyote http filters java io exception ioexception java input stream inputstream java print writer printwriter javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit assert false assertfalse org junit assert null assertnull org junit assert true asserttrue org junit test org apache catalina context org apache catalina startup simple http client simplehttpclient org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest test chunked input filter testchunkedinputfilter tomcat base test tomcatbasetest string ext size limit test testchunkheadercrlf exception dotestchunkingcrlf test test chunk header f testchunkheaderlf exception dotestchunkingcrlf test testchunkcrlf exception dotestchunkingcrlf test test chunk f testchunklf exception dotestchunkingcrlf test test first trailing headers f testfirsttrailingheaderscrlf exception dotestchunkingcrlf test test first trailing headers f testfirsttrailingheaderslf exception dotestchunkingcrlf test test second trailing headers f testsecondtrailingheaderscrlf exception dotestchunkingcrlf test test second trailing headers f testsecondtrailingheaderslf exception dotestchunkingcrlf test testendcrlf exception dotestchunkingcrlf test test end f testendlf exception dotestchunkingcrlf dotestchunkingcrlf chunkheaderusescrlf chunkusescrlf firstheaderusescrlf secondheaderusescrlf endusescrlf expect pass expectpass exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext configure allowed trailer headers tomcat get connector getconnector set property setproperty allowed trailer headers allowedtrailerheaders trailer trailer echo header servlet echoheaderservlet servlet echo header servlet echoheaderservlet expect pass expectpass tomcat add servlet addservlet ctx servlet servlet ctx add servlet mapping addservletmapping servlet tomcat start string request string post echo params jsp http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf transfer encoding chunked simple http client simplehttpclient crlf content type application form url encoded urlencoded simple http client simplehttpclient crlf connection close simple http client simplehttpclient crlf simple http client simplehttpclient crlf chunkheaderusescrlf simple http client simplehttpclient crlf chunkusescrlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer test firstheaderusescrlf simple http client simplehttpclient crlf trailer test value testvalue secondheaderusescrlf simple http client simplehttpclient crlf endusescrlf simple http client simplehttpclient crlf trailer client trailerclient client trailer client trailerclient tomcat get connector getconnector get local port getlocalport client set request setrequest request client connect exception process exception processexception client process request processrequest exception process exception processexception expect pass expectpass assert true asserttrue client is response isresponse assert equals assertequals null null nullnull test value testvalue test value testvalue client get response body getresponsebody assert null assertnull process exception processexception assert false assertfalse servlet get exception during read getexceptionduringread process exception processexception assert true asserttrue client get response line getresponseline client is response isresponse fall checking error occurred assert true asserttrue servlet get exception during read getexceptionduringread test test trailing headers size limit testtrailingheaderssizelimit exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet echo header servlet echoheaderservlet ctx add servlet mapping addservletmapping servlet limit size trailing header tomcat get connector getconnector set property setproperty max trailer size maxtrailersize tomcat start string request string post echo params jsp http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf transfer encoding chunked simple http client simplehttpclient crlf content type application form url encoded urlencoded simple http client simplehttpclient crlf connection close simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer test simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer client trailerclient client trailer client trailerclient tomcat get connector getconnector get local port getlocalport client set request setrequest request client connect client process request processrequest expected fail tra ilers trailers longer limit bytes assert true asserttrue client is response isresponse test test extension size limit one below testextensionsizelimitonebelow exception do test extension size limit dotestextensionsizelimit ext size limit test test extension size limit exact testextensionsizelimitexact exception do test extension size limit dotestextensionsizelimit ext size limit test test extension size limit one over testextensionsizelimitoneover exception do test extension size limit dotestextensionsizelimit ext size limit do test extension size limit dotestextensionsizelimit len exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance tomcat get connector getconnector set property setproperty max extension size maxextensionsize integer to string tostring ext size limit file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet echo header servlet echoheaderservlet ctx add servlet mapping addservletmapping servlet tomcat start string ext name extname foo string builder stringbuilder ext value extvalue string builder stringbuilder len len ext name extname length ext value extvalue append string request string post echo params jsp http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf transfer encoding chunked simple http client simplehttpclient crlf content type application form url encoded urlencoded simple http client simplehttpclient crlf connection close simple http client simplehttpclient crlf simple http client simplehttpclient crlf ext name extname ext value extvalue to string tostring simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer client trailerclient client trailer client trailerclient tomcat get connector getconnector get local port getlocalport client set request setrequest request client connect client process request processrequest assert true asserttrue client is response isresponse assert true asserttrue client is response isresponse test test no trailing headers testnotrailingheaders exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet echo header servlet echoheaderservlet ctx add servlet mapping addservletmapping servlet tomcat start string request post echo params jsp http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf transfer encoding chunked simple http client simplehttpclient crlf content type application form url encoded urlencoded simple http client simplehttpclient crlf connection close simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer client trailerclient client trailer client trailerclient tomcat get connector getconnector get local port getlocalport client set request setrequest string request client connect client process request processrequest assert equals assertequals null null nullnull null null nullnull client get response body getresponsebody test test chunk size zero testchunksizezero exception do test chunk size dotestchunksize test test chunk size absent testchunksizeabsent exception do test chunk size dotestchunksize simple http client simplehttpclient crlf test test chunk size t wenty five testchunksizetwentyfive exception do test chunk size dotestchunksize simple http client simplehttpclient crlf simple http client simplehttpclient crlf test test chunk size eight digit testchunksizeeightdigit exception do test chunk size dotestchunksize simple http client simplehttpclient crlf simple http client simplehttpclient crlf test test chunk size nine digit testchunksizeninedigit exception do test chunk size dotestchunksize simple http client simplehttpclient crlf simple http client simplehttpclient crlf test test chunk size long testchunksizelong exception do test chunk size dotestchunksize f f ff f fffffff simple http client simplehttpclient crlf simple http client simplehttpclient crlf test test chunk size integer min value testchunksizeintegerminvalue exception do test chunk size dotestchunksize simple http client simplehttpclient crlf simple http client simplehttpclient crlf test test chunk size minus one testchunksizeminusone exception do test chunk size dotestchunksize ffffffff simple http client simplehttpclient crlf simple http client simplehttpclient crlf param expect pass expectpass servlet expected process request param expect read whole body expectreadwholebody servlet expected fully read body rel iably reliably deliver response param chunks text chunks param read limit readlimit read bytes param expect read count expectreadcount expected count read bytes exception unexpected do test chunk size dotestchunksize expect pass expectpass expect read whole body expectreadwholebody string chunks read limit readlimit expect read count expectreadcount exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext body read servlet bodyreadservlet servlet body read servlet bodyreadservlet expect pass expectpass read limit readlimit tomcat add servlet addservlet ctx servlet servlet ctx add servlet mapping addservletmapping servlet tomcat start string request post echo params jsp http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf transfer encoding chunked simple http client simplehttpclient crlf content type text plain simple http client simplehttpclient crlf expect pass expectpass request connection close simple http client simplehttpclient crlf request simple http client simplehttpclient crlf chunks simple http client simplehttpclient crlf simple http client simplehttpclient crlf trailer client trailerclient client trailer client trailerclient tomcat get connector getconnector get local port getlocalport client set request setrequest string request exception process exception processexception client connect client process request processrequest exception process exception processexception expect pass expectpass expect read whole body expectreadwholebody assert null assertnull process exception processexception process exception processexception assert true asserttrue client get response line getresponseline client is response isresponse assert equals assertequals string value of valueof expect read count expectreadcount client get response body getresponsebody assert equals assertequals expect read count expectreadcount servlet get count read getcountread process exception processexception assert true asserttrue client get response line getresponseline client is response isresponse assert equals assertequals servlet get count read getcountread assert true asserttrue servlet get exception during read getexceptionduringread echo header servlet echoheaderservlet http servlet httpservlet serialversionuid exception during read exceptionduringread expect pass expectpass echo header servlet echoheaderservlet expect pass expectpass expect pass expectpass expect pass expectpass override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain print writer printwriter resp get writer getwriter headers visible body processed dump header dumpheader trailer req dump header dumpheader trailer req read body quick dirty input stream inputstream req get input stream getinputstream count read count io exception ioexception ioe exception during read exceptionduringread expect pass expectpass log ioe to string tostring resp send error senderror http servlet response httpservletresponse internal server error ioe write integer value of valueof count to string tostring headers visible dump header dumpheader trailer req dump header dumpheader trailer req get exception during read getexceptionduringread exception during read exceptionduringread dump header dumpheader string header name headername http servlet request httpservletrequest req print writer printwriter string req get header getheader header name headername write body read servlet bodyreadservlet http servlet httpservlet serialversionuid exception during read exceptionduringread count read countread expect pass expectpass read limit readlimit body read servlet bodyreadservlet expect pass expectpass read limit readlimit expect pass expectpass expect pass expectpass read limit readlimit read limit readlimit override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain print writer printwriter resp get writer getwriter read body quick dirty input stream inputstream req get input stream getinputstream read count read countread read limit readlimit count read countread io exception ioexception ioe exception during read exceptionduringread expect pass expectpass log ioe to string tostring resp send error senderror http servlet response httpservletresponse internal server error ioe write integer value of valueof count read countread to string tostring get exception during read getexceptionduringread exception during read exceptionduringread get count read getcountread count read countread trailer client trailerclient simple http client simplehttpclient trailer client trailerclient port set port setport port override is response body k isresponsebodyok get response body getresponsebody test test test testtesttest
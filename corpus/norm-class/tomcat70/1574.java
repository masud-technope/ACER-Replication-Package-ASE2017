licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java io exception ioexception java util linked hash set linkedhashset java util locale java util javax servlet filter chain filterchain javax servlet servlet exception servletexception javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test test cors filter testcorsfilter filter chain filterchain filter chain filterchain tester filter chain testerfilterchain tests request treated simple request http org cors simple method io exception ioexception servlet exception servletexception test test do filter simple t testdofiltersimpleget io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english tests post request treated simple request http org cors simple method io exception ioexception servlet exception servletexception test test do filter simple t testdofiltersimplepost io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set content type setcontenttype text plain request set method setmethod post tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english tests head request treated simple request http org cors simple method io exception ioexception servlet exception servletexception test test do filter simple d testdofiltersimplehead io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod head tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english test presence specific origin response io exception ioexception servlet exception servletexception test test do filter simple specific header testdofiltersimplespecificheader io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod post request set content type setcontenttype text plain tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english tests prsence origin response supports credentials enabled alongwith origin io exception ioexception servlet exception servletexception test test do filter simple any origin and supports credentials testdofiltersimpleanyoriginandsupportscredentials io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config any origin and supports credentials getfilterconfiganyoriginandsupportscredentials cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue response get header getheader cors filter corsfilter response header access control credentials equals assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english tests presence origin response supports credentials enabled alongwith origin io exception ioexception servlet exception servletexception test test do filter simple any origin and supports credentials disabled testdofiltersimpleanyoriginandsupportscredentialsdisabled io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config any origin and supports credentials disabled getfilterconfiganyoriginandsupportscredentialsdisabled cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs origin assert null assertnull response get header getheader cors filter corsfilter response header access control credentials assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english tests presence exposed headers response configured io exception ioexception servlet exception servletexception test test do filter simple with exposed headers testdofiltersimplewithexposedheaders io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod post request set content type setcontenttype text plain tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config with exposed headers getfilterconfigwithexposedheaders cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert true asserttrue response get header getheader cors filter corsfilter response header access control expose headers equals tester filter configs testerfilterconfigs exposed headers assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english checks options request processed pre flight io exception ioexception servlet exception servletexception test test do filter preflight testdofilterpreflight io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype pre flight to lower case tolowercase locale english assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request headers equals content type checks options request processed pre flight origin enabled io exception ioexception servlet exception servletexception test test do filter preflight any origin testdofilterpreflightanyorigin io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype pre flight to lower case tolowercase locale english assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request headers equals content type checks options request processed pre flight io exception ioexception servlet exception servletexception test test do filter preflight invalid origin testdofilterpreflightinvalidorigin io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals response get status getstatus http servlet response httpservletresponse forbidden test test do filter preflight negative max age testdofilterpreflightnegativemaxage io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config negative max age getspecificoriginfilterconfignegativemaxage cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert null assertnull response get header getheader cors filter corsfilter response header access control max age assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype pre flight to lower case tolowercase locale english assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request headers equals content type test test do filter preflight with credentials testdofilterpreflightwithcredentials io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get secure filter config getsecurefilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue response get header getheader cors filter corsfilter response header access control credentials equals assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype pre flight to lower case tolowercase locale english assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request headers equals content type test test do filter preflight without credentials and specific origin testdofilterpreflightwithoutcredentialsandspecificorigin io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config specific origin and supports credentials disabled getfilterconfigspecificoriginandsupportscredentialsdisabled cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals tester filter configs testerfilterconfigs https apache org assert null assertnull response get header getheader cors filter corsfilter response header access control credentials assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype pre flight to lower case tolowercase locale english assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request headers equals content type negative test cors request arrives origin header test test do filter no origin testdofilternoorigin io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set method setmethod post request set content type setcontenttype text plain tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype cors request type requesttype cors filter corsfilter do filter dofilter request response filter chain filterchain assert false assertfalse request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue negative test cors request arrives origin header test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin http localhost http localhost test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin http localhost https localhost test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin http localhost http localhost test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin http localhost http foo dev local test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin https localhost https localhost test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin https localhost https localhost test test do filter same host with origin testdofiltersamehostwithorigin io exception ioexception servlet exception servletexception do test do filter same host with origin dotestdofiltersamehostwithorigin http localhost http localhost do test do filter same host with origin dotestdofiltersamehostwithorigin string origin string scheme string host port is cors iscors io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set method setmethod post request set header setheader cors filter corsfilter request header origin origin request set scheme setscheme scheme request set server name setservername host request set server port setserverport port request set content type setcontenttype text plain tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request is cors iscors assert not equals assertnotequals cors filter corsfilter cors request type corsrequesttype cors request type requesttype assert equals assertequals cors filter corsfilter cors request type corsrequesttype cors request type requesttype cors filter corsfilter do filter dofilter request response filter chain filterchain is cors iscors assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert false assertfalse request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue test test do filter invalid origin not allowed testdofilterinvalidcorsoriginnotallowed io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin google request set method setmethod post tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus cors request arrives origin allowed test test do filter null origin allowed by default testdofilternulloriginallowedbydefault io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set method setmethod post request set content type setcontenttype text plain request set header setheader cors filter corsfilter request header origin tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype simple request type requesttype cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue cors request arrives origin explicitly allowed configuration test test do filter null origin allowed by configuration testdofilternulloriginallowedbyconfiguration io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set method setmethod post request set content type setcontenttype text plain request set header setheader cors filter corsfilter request header origin tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config specific origin null allowed getfilterconfigspecificoriginnullallowed cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype simple request type requesttype cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue test expected servlet exception servletexception test do filter null request null response testdofilternullrequestnullresponse io exception ioexception servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter filter chain filterchain test expected servlet exception servletexception test do filter null request response testdofilternullrequestresponse io exception ioexception servlet exception servletexception tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter response filter chain filterchain test expected servlet exception servletexception test do filter request null response testdofilterrequestnullresponse io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request filter chain filterchain test test init default filter config testinitdefaultfilterconfig io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute origin equals tester filter configs testerfilterconfigs https apache org assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute request type equals cors filter corsfilter cors request type corsrequesttype simple to lower case tolowercase locale english test expected servlet exception servletexception test init invalid filter config testinitinvalidfilterconfig servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config invalid max preflight age getfilterconfiginvalidmaxpreflightage don exception point mocked objects worked expected tests simple request simple request handler io exception ioexception servlet exception servletexception test expected illegal argument exception illegalargumentexception test not simple testnotsimple io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter handlesimplecors request response filter chain filterchain preflight request pre flight request handler io exception ioexception servlet exception servletexception test expected illegal argument exception illegalargumentexception test not preflight testnotpreflight io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter handlepreflightcors request response filter chain filterchain test expected illegal argument exception illegalargumentexception testdecoratecorspropertiesnullrequestnullcorsrequesttype cors filter corsfilter decoratecorsproperties test expected illegal argument exception illegalargumentexception testdecoratecorspropertiesnullrequestvalidcorsrequesttype cors filter corsfilter decoratecorsproperties cors filter corsfilter cors request type corsrequesttype simple test expected illegal argument exception illegalargumentexception test decorate properties valid request null request type testdecoratecorspropertiesvalidrequestnullrequesttype tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest cors filter corsfilter decoratecorsproperties request test testdecoratecorspropertiescorsrequesttypenotcors tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest cors filter corsfilter decoratecorsproperties request cors filter corsfilter cors request type corsrequesttype cors assert false assertfalse request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue test testdecoratecorspropertiescorsrequesttypeinvalidcors tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest cors filter corsfilter decoratecorsproperties request cors filter corsfilter cors request type corsrequesttype invalid cors assert null assertnull request get attribute getattribute cors filter corsfilter http request attribute cors request test test check simple request type any origin testchecksimplerequesttypeanyorigin servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype simple request type requesttype happy path test valid cors simple request arrives servlet exception servletexception test test check simple request type testchecksimplerequesttype servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype simple request type requesttype happy path test valid cors simple request arrives servlet exception servletexception test test check actual request type testcheckactualrequesttype servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype actual request type requesttype happy path test valid cors simple request arrives servlet exception servletexception test test check actual request type method not simple headers testcheckactualrequesttypemethodpostnotsimpleheaders servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set method setmethod post request set content type setcontenttype application json cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype actual request type requesttype happy path test valid cors pre flight request arrives servlet exception servletexception test test check pre flight request type testcheckpreflightrequesttype servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers content type request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype pre flight request type requesttype valid cors pre flight request arrives access control request method servlet exception servletexception io exception ioexception test test check pre flight request type no m testcheckpreflightrequesttypenoacrm servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype actual request type requesttype valid cors pre flight request arrives empty access control request method servlet exception servletexception io exception ioexception test test check pre flight request type empty m testcheckpreflightrequesttypeemptyacrm servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype happy path test valid cors pre flight request arrives servlet exception servletexception test test check pre flight request type no headers testcheckpreflightrequesttypenoheaders servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype pre flight request type requesttype servlet exception servletexception io exception ioexception test test check pre flight request type invalid request method testcheckpreflightrequesttypeinvalidrequestmethod servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method polite request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus servlet exception servletexception io exception ioexception test test check pre flight request type unsupported request method testcheckpreflightrequesttypeunsupportedrequestmethod servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method trace request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus servlet exception servletexception io exception ioexception test test check pre flight request type unsupported request headers testcheckpreflightrequesttypeunsupportedrequestheaders servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers answer request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get secure filter config getsecurefilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus servlet exception servletexception io exception ioexception test test check pre flight request type any origin no with credentials testcheckpreflightrequesttypeanyoriginnowithcredentials servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers origin request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config any origin and supports credentials disabled getfilterconfiganyoriginandsupportscredentialsdisabled cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals assert null assertnull response get header getheader cors filter corsfilter response header access control credentials test test check pre flight request type origin not allowed testcheckpreflightrequesttypeoriginnotallowed servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin ebay request set header setheader cors filter corsfilter request header access control request method request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get secure filter config getsecurefilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus happy path test valid cors pre flight request arrives servlet exception servletexception test test check pre flight request type empty headers testcheckpreflightrequesttypeemptyheaders servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs http tomcat apache org request set header setheader cors filter corsfilter request header access control request method request set header setheader cors filter corsfilter request header access control request headers request set method setmethod options cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype pre flight request type requesttype negative test cors request arrives empty origin servlet exception servletexception test test check not request type empty origin testchecknotcorsrequesttypeemptyorigin servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype tests failure domain allowed list origins servlet exception servletexception io exception ioexception test test check invalid origin testcheckinvalidorigin servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus tests failure origin list allowed origins test test check null origin not allowed testchecknulloriginnotallowed servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus tests failure domain allowed list origins servlet exception servletexception io exception ioexception test test check invalid origin not allowed sub domain testcheckinvalidoriginnotallowedsubdomain servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin http commons apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus allowed request method servlet exception servletexception io exception ioexception test test check invalid request method testcheckinvalidrequestmethod servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin http tomcat apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus request method requestmethod servlet exception servletexception test test check null request method testchecknullrequestmethod servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http tomcat apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype http tomcat apache org allowed origin https tomcat apache org scheme doesn match servlet exception servletexception test test check for scheme var iance testcheckforschemevariance servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin https tomcat apache org request set method setmethod post cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype http tomcat apache org allowed origin http tomcat apache org ports doesn match servlet exception servletexception io exception ioexception test test check for port var iance testcheckforportvariance servlet exception servletexception io exception ioexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse request set header setheader cors filter corsfilter request header origin http tomcat apache org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get specific origin filter config getspecificoriginfilterconfig cors filter corsfilter do filter dofilter request response filter chain filterchain assert equals assertequals http servlet response httpservletresponse forbidden response get status getstatus tests failure invalid link http servlet request httpservletrequest encountered servlet exception servletexception test expected illegal argument exception illegalargumentexception test check request type null testcheckrequesttypenull servlet exception servletexception http servlet request httpservletrequest request cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter check request type checkrequesttype request test test join testjoin string elements linked hash set linkedhashset string string separator elements add elements add peace string join cors filter corsfilter join elements separator assert true asserttrue peace equals join test test join single element testjoinsingleelement string elements linked hash set linkedhashset string string separator elements add string join cors filter corsfilter join elements separator assert true asserttrue equals join test test join sep null testjoinsepnull string elements linked hash set linkedhashset string string separator elements add elements add peace string join cors filter corsfilter join elements separator assert true asserttrue peace equals join test test join elements null testjoinelementsnull string elements string separator string join cors filter corsfilter join elements separator assert null assertnull join test test join one null element testjoinonenullelement string elements linked hash set linkedhashset string string separator elements add elements add peace string join cors filter corsfilter join elements separator assert true asserttrue peace equals join test test join all null elements testjoinallnullelements string elements linked hash set linkedhashset string string separator elements add elements add string join cors filter corsfilter join elements separator assert true asserttrue equals join test test join all empty elements testjoinallemptyelements string elements linked hash set linkedhashset string string separator elements add elements add string join cors filter corsfilter join elements separator assert true asserttrue equals join test test join pipe separator testjoinpipeseparator string elements linked hash set linkedhashset string string separator elements add elements add peace string join cors filter corsfilter join elements separator assert true asserttrue peace equals join test test with filter config testwithfilterconfig servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig assert true asserttrue cors filter corsfilter get allowed http headers getallowedhttpheaders size assert true asserttrue cors filter corsfilter get allowed http methods getallowedhttpmethods size assert true asserttrue cors filter corsfilter get allowed origins getallowedorigins size assert true asserttrue cors filter corsfilter is any origin allowed isanyoriginallowed assert true asserttrue cors filter corsfilter get exposed headers getexposedheaders size assert true asserttrue cors filter corsfilter is supports credentials issupportscredentials assert true asserttrue cors filter corsfilter get preflight max age getpreflightmaxage test expected servlet exception servletexception test with filter config invalid preflight age testwithfilterconfiginvalidpreflightage servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config invalid max preflight age getfilterconfiginvalidmaxpreflightage test test with string parser empty testwithstringparserempty servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get empty filter config getemptyfilterconfig assert true asserttrue cors filter corsfilter get allowed http headers getallowedhttpheaders size assert true asserttrue cors filter corsfilter get allowed http methods getallowedhttpmethods size assert true asserttrue cors filter corsfilter get allowed origins getallowedorigins size assert true asserttrue cors filter corsfilter get exposed headers getexposedheaders size assert false assertfalse cors filter corsfilter is supports credentials issupportscredentials assert true asserttrue cors filter corsfilter get preflight max age getpreflightmaxage init param servlet exception servletexception test test with string parser null testwithstringparsernull servlet exception servletexception cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get null filter config getnullfilterconfig assert true asserttrue cors filter corsfilter get allowed http headers getallowedhttpheaders size assert true asserttrue cors filter corsfilter get allowed http methods getallowedhttpmethods size assert true asserttrue cors filter corsfilter get allowed origins getallowedorigins size assert true asserttrue cors filter corsfilter is any origin allowed isanyoriginallowed assert true asserttrue cors filter corsfilter get exposed headers getexposedheaders size assert true asserttrue cors filter corsfilter is supports credentials issupportscredentials assert true asserttrue cors filter corsfilter get preflight max age getpreflightmaxage test test valid origin testvalidorigin assert true asserttrue cors filter corsfilter is valid origin isvalidorigin http org test test in valid origin f testinvalidorigincrlf assert false assertfalse cors filter corsfilter is valid origin isvalidorigin http org test test in valid origin encoded f testinvalidoriginencodedcrlf assert false assertfalse cors filter corsfilter is valid origin isvalidorigin http org test test in valid origin encoded f testinvalidoriginencodedcrlf assert false assertfalse cors filter corsfilter is valid origin isvalidorigin http org test test in valid origin encoded f testinvalidoriginencodedcrlf assert false assertfalse cors filter corsfilter is valid origin isvalidorigin http org test testcheckinvalidcrlf servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype test testcheckinvalidcrlf servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype test testcheckinvalidcrlf servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype test testcheckinvalidcrlf servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin http org request set method setmethod cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype invalid cors request type requesttype test test decorate request disabled testdecoraterequestdisabled io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set header setheader cors filter corsfilter request header origin tester filter configs testerfilterconfigs https apache org request set method setmethod tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get filter config decorate request disabled getfilterconfigdecoraterequestdisabled cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue response get header getheader cors filter corsfilter response header access control origin equals https apache org assert null assertnull request get attribute getattribute cors filter corsfilter http request attribute cors request assert null assertnull request get attribute getattribute cors filter corsfilter http request attribute origin assert null assertnull request get attribute getattribute cors filter corsfilter http request attribute request headers assert null assertnull request get attribute getattribute cors filter corsfilter http request attribute request type cors request arrives origin allowed test test content type with parameter testcontenttypewithparameter io exception ioexception servlet exception servletexception tester http servlet request testerhttpservletrequest request tester http servlet request testerhttpservletrequest request set method setmethod post request set content type setcontenttype text plain charset utf request set header setheader cors filter corsfilter request header origin tester http servlet response testerhttpservletresponse response tester http servlet response testerhttpservletresponse cors filter corsfilter cors filter corsfilter cors filter corsfilter cors filter corsfilter init tester filter configs testerfilterconfigs get default filter config getdefaultfilterconfig cors filter corsfilter cors request type corsrequesttype request type requesttype cors filter corsfilter check request type checkrequesttype request assert equals assertequals cors filter corsfilter cors request type corsrequesttype simple request type requesttype cors filter corsfilter do filter dofilter request response filter chain filterchain assert true asserttrue request get attribute getattribute cors filter corsfilter http request attribute cors request boolean value booleanvalue
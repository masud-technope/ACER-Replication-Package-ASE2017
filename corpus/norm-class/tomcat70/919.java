licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net java eof exception eofexception java io exception ioexception java net socket timeout exception sockettimeoutexception java nio byte buffer bytebuffer java nio channels selection key selectionkey java nio channels selector java nio channels socket channel socketchannel javax net ssl ssl engine sslengine javax net ssl ssl engine result sslengineresult javax net ssl ssl engine result sslengineresult handshake status handshakestatus javax net ssl ssl engine result sslengineresult status javax net ssl ssl exception sslexception org apache juli logging log org apache juli logging log factory logfactory secure nio channel secureniochannel nio channel niochannel log log log factory logfactory get log getlog secure nio channel secureniochannel byte buffer bytebuffer net in buffer netinbuffer byte buffer bytebuffer net out buffer netoutbuffer ssl engine sslengine ssl engine sslengine handshake complete handshakecomplete handshake handshake status handshakestatus handshake status handshakestatus closed closing nio selector pool nioselectorpool pool secure nio channel secureniochannel socket channel socketchannel channel ssl engine sslengine engine application buffer handler applicationbufferhandler buf handler bufhandler nio selector pool nioselectorpool pool io exception ioexception channel buf handler bufhandler ssl engine sslengine engine app buf size appbufsize ssl engine sslengine get session getsession get application buffer size getapplicationbuffersize net buf size netbufsize ssl engine sslengine get session getsession get packet buffer size getpacketbuffersize all ocate allocate network buf fers buffers todo add optional direct direct buf fers buffers net in buffer netinbuffer net in buffer netinbuffer byte buffer bytebuffer all ocate direct allocatedirect net buf size netbufsize net out buffer netoutbuffer net out buffer netoutbuffer byte buffer bytebuffer all ocate direct allocatedirect net buf size netbufsize selector pool blocking operations pool pool ensure application large read write buf fers buffers enc ounter encounter buffer overflow errors buf handler bufhandler expand buf handler bufhandler get read buffer getreadbuffer app buf size appbufsize buf handler bufhandler expand buf handler bufhandler get write buffer getwritebuffer app buf size appbufsize reset reset ssl engine sslengine engine io exception ioexception ssl engine sslengine engine reset override reset io exception ioexception reset net out buffer netoutbuffer position net out buffer netoutbuffer limit net in buffer netinbuffer position net in buffer netinbuffer limit handshake complete handshakecomplete closed closing init iate initiate handshake ssl engine sslengine begin handshake beginhandshake handshake status handshakestatus ssl engine sslengine get handshake status gethandshakestatus override get buffer size getbuffersize size get buffer size getbuffersize size net in buffer netinbuffer net in buffer netinbuffer capacity size net out buffer netoutbuffer net out buffer netoutbuffer capacity size nio ssl methods flush channel param block blocking write param param timeout code code network buffer flushed empty code code io exception ioexception override flush block selector timeout io exception ioexception block flush net out buffer netoutbuffer pool write net out buffer netoutbuffer timeout block net out buffer netoutbuffer has remaining hasremaining flushes buffer network blocking param buf byte buffer bytebuffer buffer emptied io exception ioexception flush byte buffer bytebuffer buf io exception ioexception remaining buf remaining remaining written write buf written remaining performs ssl handshake blocking performs task thread call method acc eptor acceptor thread slow system operation handshake complete positive complete event positive coming reregister selection key values int erest ops interestops param read underlying channel readable param write underlying channel writable hand shake complete returns selection key selectionkey int erest ops interestops io exception ioexception override handshake read write io exception ioexception initial handshake handshake complete handshakecomplete data write flush net out buffer netoutbuffer selection key selectionkey write ssl engine result sslengineresult handshake handshake complete handshakecomplete handshake status handshakestatus handshaking happen io exception ioexception handshaking handshake finished complete delivered handshake complete handshakecomplete net out buffer netoutbuffer has remaining hasremaining complete data write handshake complete handshakecomplete selection key selectionkey write wrap perform wrap function handshake handshake wrap handshakewrap write ssl exception sslexception log is debug enabled isdebugenabled log debug get string getstring channel nio ssl wrap exception wrapexception handshake handshake wrap handshakewrap write handshake get status getstatus status handshake status handshakestatus handshake status handshakestatus task handshake status handshakestatus tasks handshake get status getstatus status closed flush net out buffer netoutbuffer wrap work buf fers buffers io exception ioexception unexpected status handshake get status getstatus handshake wrap handshake status handshakestatus handshake status handshakestatus unwrap flush net out buffer netoutbuffer read unwrap selection key selectionkey write fall unwrap call result buffer underflow data fall unwrap perform unwrap function handshake handshake unwrap handshakeunwrap read handshake get status getstatus status handshake status handshakestatus handshake status handshakestatus task handshake status handshakestatus tasks handshake get status getstatus status buffer underflow read data reregister read selection key selectionkey read io exception ioexception invalid handshake status handshake status handshakestatus handshake unwrap task handshake status handshakestatus tasks illegal state exception illegalstateexception invalid handshake status handshake status handshakestatus handshake complete point reached force blocking handshake place key requires network application buf fers buffers emptied prior call place io exception ioexception thrown param timeout timeout milliseconds socket operation io exception ioexception exception occurs application network buf fers buffers data socket timeout exception sockettimeoutexception socket operation timed rehandshake timeout io exception ioexception validate network buf fers buffers empty net in buffer netinbuffer position net in buffer netinbuffer position net in buffer netinbuffer limit io exception ioexception network input buffer data handshake fail net out buffer netoutbuffer position net out buffer netoutbuffer position net out buffer netoutbuffer limit io exception ioexception network output buffer data handshake fail get buf handler getbufhandler get read buffer getreadbuffer position get buf handler getbufhandler get read buffer getreadbuffer position get buf handler getbufhandler get read buffer getreadbuffer limit io exception ioexception application input buffer data data lost get buf handler getbufhandler get write buffer getwritebuffer position get buf handler getbufhandler get write buffer getwritebuffer position get buf handler getbufhandler get write buffer getwritebuffer limit io exception ioexception application output buffer data data lost reset is readable isreadable is write able iswriteable handshaking selector selector selection key selectionkey key handshaking hs status hsstatus handshake is readable isreadable is write able iswriteable hs status hsstatus eof exception eofexception eof handshake handshaking system current time millis currenttimemillis selector selector selector open isn thread safe http bugs sun view bug bug fixed selector selector open key getiochannel register selector hs status hsstatus key int erest ops interestops hs status hsstatus key count keycount selector select timeout key count keycount system current time millis currenttimemillis timeout socket timeout exception sockettimeoutexception handshake operation timed is readable isreadable key is readable isreadable is write able iswriteable key is writable iswritable io exception ioexception exception io exception ioexception io exception ioexception key key cancel exception ignore selector selector close exception ignore executes tasks needed thread handshake status handshakestatus ssl engine result sslengineresult handshake status handshakestatus tasks runnable ssl engine sslengine get delegate d task getdelegatedtask ssl engine sslengine get handshake status gethandshakestatus performs wrap function param do write dowrite ssl engine result sslengineresult io exception ioexception ssl engine result sslengineresult handshake wrap handshakewrap do write dowrite io exception ioexception called network buffer data clear net out buffer netoutbuffer clear perform wrap ssl engine result sslengineresult result ssl engine sslengine wrap buf handler bufhandler get write buffer getwritebuffer net out buffer netoutbuffer prepare written net out buffer netoutbuffer flip status handshake status handshakestatus result get handshake status gethandshakestatus optimization writable channel write do write dowrite flush net out buffer netoutbuffer result perform handshake unwrap param doread ssl engine result sslengineresult io exception ioexception ssl engine result sslengineresult handshake unwrap handshakeunwrap doread io exception ioexception net in buffer netinbuffer position net in buffer netinbuffer limit clear buffer emptied data net in buffer netinbuffer clear doread data read read read read net in buffer netinbuffer read io exception ioexception eof encountered handshake ssl engine result sslengineresult result cont loop perform pure ssl engine sslengine data prepare buffer incoming data net in buffer netinbuffer flip call unwrap result ssl engine sslengine unwrap net in buffer netinbuffer buf handler bufhandler get read buffer getreadbuffer compact buffer optional method happen didn net in buffer netinbuffer compact read status handshake status handshakestatus result get handshake status gethandshakestatus result get status getstatus ssl engine result sslengineresult status result get handshake status gethandshakestatus handshake status handshakestatus task execute tasks handshake status handshakestatus tasks perform unwrap cont result get status getstatus ssl engine result sslengineresult status handshake status handshakestatus handshake status handshakestatus unwrap cont result s ends sends ssl close message physically close connection close connection pre code close is open isopen my timeout function mytimeoutfunction thread sleep is open isopen close for ces forces close timed code pre io exception ioexception error occurs io exception ioexception data out going outgoing network buffer unable flush todo implement java closeable method override close io exception ioexception closing closing ssl engine sslengine close outbound closeoutbound flush net out buffer netoutbuffer io exception ioexception remaining data network buffer send ssl close message force close close prep buffer close message net out buffer netoutbuffer clear perform close called ssl engine sslengine close outbound closeoutbound ssl engine result sslengineresult handshake ssl engine sslengine wrap get empty buf getemptybuf net out buffer netoutbuffer close handshake get status getstatus ssl engine result sslengineresult status closed io exception ioexception invalid close send network data prepare buffer writing net out buffer netoutbuffer flip data written flush net out buffer netoutbuffer channel closed closed net out buffer netoutbuffer has remaining hasremaining handshake get handshake status gethandshakestatus handshake status handshakestatus wrap force close io exception ioexception param force io exception ioexception override close force io exception ioexception close force closed closed socket close close reads sequence bytes channel buffer param dst buffer bytes transfer red transferred number bytes read channel reached stream io exception ioexception error occurs illegal argument exception illegalargumentexception destination buffer buf handler bufhandler get read buffer getreadbuffer todo implement java nio channels readable byte channel readablebytechannel method override read byte buffer bytebuffer dst io exception ioexception advantage expand function application buffer handler applicationbufferhandler buf fers buffers dst buf handler bufhandler get read buffer getreadbuffer illegal argument exception illegalargumentexception read application read buffer handler middle closing closed closing closed finish handshake handshake complete handshakecomplete illegal state exception illegalstateexception handshake incomplete complete handshake reading data read network net read netread read net in buffer netinbuffer reach eof send eof layer net read netread data read read ssl engine result ssl engine result sslengineresult unwrap prepare buffer net in buffer netinbuffer flip unwrap data unwrap ssl engine sslengine unwrap net in buffer netinbuffer dst compact buffer net in buffer netinbuffer compact unwrap get status getstatus status unwrap get status getstatus status buffer underflow receive data add total read unwrap bytes produce d bytesproduced perform tasks needed unwrap get handshake status gethandshakestatus handshake status handshakestatus task tasks network data bail unwrap get status getstatus status buffer underflow unwrap get status getstatus status buffer overflow read empty dst buffer read constructor io exception ioexception unable unwrap data invalid status unwrap get status getstatus unwrap ping unwrapping input buffer stuff net in buffer netinbuffer position read writes sequence bytes channel buffer param src buffer bytes retrieved number bytes written io exception ioexception error occurs todo implement java nio channels writable byte channel writablebytechannel method override write byte buffer bytebuffer src io exception ioexception check int err upt status checkinterruptstatus src net out buffer netoutbuffer recursive call nio blocking selector nioblockingselector written write src written closing closed closing closed io exception ioexception channel closing number bytes written written flush net out buffer netoutbuffer have n haven emptied buffer written data buffer empty reuse entire buffer net out buffer netoutbuffer clear ssl engine result sslengineresult result ssl engine sslengine wrap src net out buffer netoutbuffer written result bytes consumed bytesconsumed net out buffer netoutbuffer flip result get status getstatus status result get handshake status gethandshakestatus handshake status handshakestatus task tasks io exception ioexception unable wrap data invalid engine result get status getstatus force flush flush net out buffer netoutbuffer written override get outbound remaining getoutboundremaining net out buffer netoutbuffer remaining override flush outbound flushoutbound io exception ioexception remaining net out buffer netoutbuffer remaining flush net out buffer netoutbuffer remaining net out buffer netoutbuffer remaining remaining remaining callback expand buf fers buffers buffer overflow exceptions happen application buffer handler applicationbufferhandler byte buffer bytebuffer expand byte buffer bytebuffer buffer remaining byte buffer bytebuffer get read buffer getreadbuffer byte buffer bytebuffer get write buffer getwritebuffer override application buffer handler applicationbufferhandler get buf handler getbufhandler buf handler bufhandler override is handshake complete ishandshakecomplete handshake complete handshakecomplete override is closing isclosing closing ssl engine sslengine get ssl engine getsslengine ssl engine sslengine byte buffer bytebuffer get empty buf getemptybuf empty buf emptybuf set buf handler setbufhandler application buffer handler applicationbufferhandler buf handler bufhandler buf handler bufhandler buf handler bufhandler override socket channel socketchannel getiochannel
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java i o exception ioexception java util regex pattern javax servlet filter chain filterchain javax servlet servlet exception servletexception javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina comet comet event cometevent org apache catalina comet comet filter cometfilter org apache catalina comet comet filter chain cometfilterchain implementation filter performs filtering based comparing request property selected based subclass choose configure container pipeline regular expressions configured filter filter configured setting code code code deny code properties regular expressions syntax supported link pattern request property compared evaluation proc eeds proceeds subclass extra cts extracts request property filtered calls common code process code method deny expression configured property compared expression match request rejected for bidden forbidden http response expression configured property compared expression match request allowed pass filter current pipeline deny expression expression request pass deny expressions matched request rejected for bidden forbidden http response request filter requestfilter filter base filterbase comet filter cometfilter instance variables regular expression test allowed requests pattern regular expression test denied requests pattern deny http response status code rejecting denied request changed deny status denystatus http servlet response httpservletresponse forbidden mime type text plain string plain text mime type text plain properties regular expression test allowed requests filter code code string get allow getallow to string tostring regular expression test allowed requests filter param expression set allow setallow string length pattern compile regular expression test denied requests filter code code string get deny getdeny deny deny to string tostring regular expression test denied requests filter param deny deny expression set deny setdeny string deny deny deny length deny deny pattern compile deny response status code reject denied request get deny status getdenystatus deny status denystatus response status code reject denied request set deny status setdenystatus deny status denystatus deny status denystatus deny status denystatus methods extract desired request property pass request response objects code process code method perform actual filtering method implemented concrete subclass param request servlet request processed param response servlet response created param chain filter chain exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs override do filter dofilter servlet request servletrequest request servlet response servletresponse response filter chain filterchain chain i o exception ioexception servlet exception servletexception methods override is config problem fatal isconfigproblemfatal perform filtering configured filter matching request property param property request property filter param request servlet request processed param response servlet response processed exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs process string property servlet request servletrequest request servlet response servletresponse response filter chain filterchain chain i o exception ioexception servlet exception servletexception is allowed isallowed property chain do filter dofilter request response response http servlet response httpservletresponse get logger getlogger is debug enabled isdebugenabled get logger getlogger debug get string getstring request filter requestfilter deny http servlet request httpservletrequest request getrequesturi property http servlet response httpservletresponse response send error senderror deny status denystatus send error when not http senderrorwhennothttp response perform filtering configured filter matching request property param property property check deny rules param event comet event filtered param chain comet filter chain exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs process comet event processcometevent string property comet event cometevent event comet filter chain cometfilterchain chain i o exception ioexception servlet exception servletexception http servlet response httpservletresponse response event get http servlet response gethttpservletresponse is allowed isallowed property chain do filter event dofilterevent event response send error senderror deny status denystatus event close process deny rules property param property property test deny lists code code request allowed code code is allowed isallowed string property deny deny matcher property matches check patterns matcher property matches denies deny deny request send error when not http senderrorwhennothttp servlet response servletresponse response i o exception ioexception response set content type setcontenttype plain text mime type response get writer getwriter write get string getstring http response get writer getwriter flush
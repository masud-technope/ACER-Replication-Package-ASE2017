licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina loader java io exception ioexception java lang reflect method javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test org apache catalina context org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util comp at compat jre compat jrecompat test parallel webapp class loader testparallelwebappclassloader tomcat base test tomcatbasetest string parallel class loader classloader org apache catalina loader parallel webapp class loader parallelwebappclassloader string dummy servlet org apache catalina loader dummy servlet dummyservlet test test parallel capable on jre testparallelcapableonjre jre compat jrecompat is jre isjre ignore jre tomcat tomcat get tomcat instance gettomcatinstance context ctx tomcat add context addcontext webapp loader webapploader webapp loader webapploader webapp loader webapploader webapp loader webapploader set loader class setloaderclass parallel class loader classloader ctx set loader setloader webapp loader webapploader tomcat start class loader classloader class loader classloader ctx get loader getloader get class loader getclassloader assert true asserttrue class loader classloader parallel webapp class loader parallelwebappclassloader parallel loading capable method get class loading lock getclassloadinglock get declared method getdeclaredmethod class loader classloader get class getclass get class loading lock getclassloadinglock string get class loading lock getclassloadinglock jre assert not null assertnotnull get class loading lock getclassloadinglock permission access method get class loading lock getclassloadinglock set accessible setaccessible object lock get class loading lock getclassloadinglock invoke class loader classloader dummy servlet parallel webapp class loader parallelwebappclassloader object lock assert not equals assertnotequals lock class loader classloader exception print stack trace printstacktrace fail test parallel capable on jre testparallelcapableonjre fails test test parallel inc apable on jre testparallelincapableonjre jre compat jrecompat is jre isjre ignore jre tomcat tomcat get tomcat instance gettomcatinstance real doc base docbase temp context ctx tomcat add context addcontext system get property getproperty java tmp dir tmpdir webapp loader webapploader webapp loader webapploader webapp loader webapploader webapp loader webapploader set loader class setloaderclass parallel class loader classloader ctx set loader setloader webapp loader webapploader tomcat start class loader classloader class loader classloader ctx get loader getloader get class loader getclassloader assert true asserttrue class loader classloader parallel webapp class loader parallelwebappclassloader parallel loading capable method get class loading lock getclassloadinglock get declared method getdeclaredmethod class loader classloader get class getclass get class loading lock getclassloadinglock string don get class loading lock getclassloadinglock jre assert null assertnull get class loading lock getclassloadinglock exception print stack trace printstacktrace fail test parallel inc apable on jre testparallelincapableonjre fails method get declared method getdeclaredmethod clazz string parameter types parametertypes clazz method method clazz get declared methods getdeclaredmethods method get name getname equals method find get declared method getdeclaredmethod clazz get superclass getsuperclass parameter types parametertypes suppress warnings suppresswarnings unused dummy servlet dummyservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception
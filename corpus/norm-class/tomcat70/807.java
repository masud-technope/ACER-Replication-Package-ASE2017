licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java buffered reader bufferedreader java io exception ioexception java input stream inputstream java input stream reader inputstreamreader java output stream outputstream java output stream writer outputstreamwriter java reader java writer java net inet socket address inetsocketaddress java net socket java net socket address socketaddress java net unknown host exception unknownhostexception java util array list arraylist java util list java util locale simple client unit testing isn robust isn secure basis product ion production code purpose bar e bare minimum unit tests simple http client simplehttpclient string temp dir system get property getproperty java tmp dir tmpdir string string string crlf string info http string http string redirect http string fail http string forbidden http string fail http string timeout http string fail http string fail http string fail http string fail http string fail http string content length header prefix content length string session cookie jsessionid string session parameter session cookie to lower case tolowercase locale english string cookie header prefix cookie string session cookie header prefix cookie header prefix session cookie string redirect header prefix location string session path parameter prefix session parameter string session path parameter tails crlf string element head string element tail string resource tag string login tag form socket socket writer writer buffered reader bufferedreader reader port string request use continue usecontinue use cookies usecookies request pause requestpause string response line responseline list string response headers responseheaders array list arraylist string string session id sessionid use content length usecontentlength content length contentlength string redirect uri redirecturi string response body responsebody list string body uri elements bodyurielements set port setport the port theport port the port theport set request setrequest string the request therequest request the request therequest expect server reply int erim interim response set use continue setusecontinue the use continue flag theusecontinueflag use continue usecontinue the use continue flag theusecontinueflag get use continue getusecontinue use continue usecontinue set use cookies setusecookies the use cookies flag theusecookiesflag use cookies usecookies the use cookies flag theusecookiesflag get use cookies getusecookies use cookies usecookies set request pause setrequestpause the request pause therequestpause request pause requestpause the request pause therequestpause string get response line getresponseline response line responseline list string get response headers getresponseheaders response headers responseheaders string get response body getresponsebody response body responsebody opening tags html elements extracted link extract uri elements extracturielements method note link extract uri elements extracturielements method called explicitly list html tags accumulated link extract uri elements extracturielements method code method called list string get response body uri elements getresponsebodyurielements body uri elements bodyurielements set use content length setusecontentlength use content length usecontentlength set session id setsessionid string the session id thesessionid session id sessionid the session id thesessionid string get session id getsessionid session id sessionid string get redirect uri getredirecturi redirect uri redirecturi connect connect timeout connecttimeout so timeout sotimeout unknown host exception unknownhostexception io exception ioexception string encoding iso socket address socketaddress add r addr inet socket address inetsocketaddress localhost port socket socket socket set so timeout setsotimeout so timeout sotimeout socket connect add r addr connect timeout connecttimeout output stream outputstream socket get output stream getoutputstream writer output stream writer outputstreamwriter encoding input stream inputstream socket get input stream getinputstream reader input stream reader inputstreamreader encoding reader buffered reader bufferedreader connect unknown host exception unknownhostexception io exception ioexception connect process request processrequest io exception ioexception interrupted exception interruptedexception process request processrequest process request processrequest want body wantbody io exception ioexception interrupted exception interruptedexception send request sendrequest read response readresponse want body wantbody send component parts request tolerant simply skip entries send request sendrequest interrupted exception interruptedexception io exception ioexception string request part requestpart request request part requestpart thread sleep request pause requestpause writer write request part requestpart writer flush read response readresponse want body wantbody io exception ioexception clear res i dual residual data starting response response headers responseheaders clear response body responsebody body uri elements bodyurielements body uri elements bodyurielements clear read response status response line responseline read line readline response expected use continue usecontinue is response isresponse skip blank response read line readline response response line responseline read line readline io exception ioexception response headers map process int eresting interesting process headers processheaders read body requested exists process body processbody want body wantbody is response isresponse session time d timed session id sessionid acc umulate accumulate response headers map extract int eresting interesting details time process headers processheaders io exception ioexception reset response fields redirect uri redirecturi content length contentlength string read line readline length response headers responseheaders add starts with startswith content length header prefix content length contentlength integer parse int parseint substring starts with startswith cookie header prefix use cookies usecookies string temp substring session cookie header prefix length temp temp substring temp index of indexof set session id setsessionid temp starts with startswith redirect header prefix redirect uri redirecturi substring redirect header prefix length read line readline read body server response save contents search uri elements requested process body processbody want body wantbody io exception ioexception read body exists string builder stringbuilder builder string builder stringbuilder want body wantbody use content length usecontentlength content length contentlength body content length contentlength reader read body builder append body content length read string read line readline builder append response body responsebody builder to string tostring scan response body opening tags html elements form accumulate note method limitations assumes response html searches lowercase tags get response body uri elements getresponsebodyurielements extract uri elements extracturielements body uri elements bodyurielements array list arraylist string response body responsebody length extract uri element extracturielement response body responsebody resource tag loop extract uri element extracturielement response body responsebody login tag loop scan html body html uri element starting source string simply accumulate literal strings including angle brackets not e note nested elements collected param body http body response param start ix startix offset body resume scan iteration param element name elementname scan time returns body scan iteration extract uri element extracturielement string body start ix startix string element name elementname string detector element head element name elementname i start istart body index of indexof detector start ix startix i start istart i end iend body index of indexof element tail i start istart i end iend illegal argument exception illegalargumentexception response body check failure element detector terminated element tail n actual nactual body string element body substring i start istart i end iend body uri elements bodyurielements add element i start istart element length i start istart string read line readline io exception ioexception reader read line readline disconnect io exception ioexception writer close reader close socket close reset socket writer reader request request pause requestpause use continue usecontinue reset response resetresponse reset response resetresponse response line responseline response headers responseheaders array list arraylist string response body responsebody is response isresponse get response line getresponseline starts with startswith info is response isresponse get response line getresponseline starts with startswith is response isresponse get response line getresponseline starts with startswith redirect is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith forbidden is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith timeout is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith fail is response isresponse get response line getresponseline starts with startswith fail socket get socket getsocket socket is response body k isresponsebodyok
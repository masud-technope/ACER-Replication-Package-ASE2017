licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina connector java io exception ioexception java print writer printwriter java util hash map hashmap java util list java util map javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse javax servlet http http session httpsession org junit assert equals assertequals org junit fail org junit org junit test org apache catalina context org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat unit test unittest tester context testercontext org apache tomcat unit test unittest tester request testerrequest org apache tomcat util buf byte chunk bytechunk test link request test response testresponse tomcat base test tomcatbasetest test test bug testbug exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet bug servlet ctx add servlet mapping addservletmapping servlet tomcat start map string list string headers hash map hashmap string list string get url geturl http localhost get port getport byte chunk bytechunk headers check headers map entry string list string header headers entry set entryset header get key getkey expected response list string values header get value getvalue values size values starts with startswith http fail header detected values check cookie header count string header name headername headers key set keyset cookie equals header name headername count assert equals assertequals count bug servlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception http session httpsession session req get session getsession session invalid ate invalidate req get session getsession tests issue notice d noticed investigation test test charset testcharset exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet charset servlet charsetservlet ctx add servlet mapping addservletmapping servlet tomcat start byte chunk bytechunk get url geturl http localhost get port getport assert equals assertequals to string tostring charset servlet charsetservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception print writer printwriter resp get writer getwriter resp set header setheader content type text plain charset utf set header setheader resp get character encoding getcharacterencoding equals iso print print fail resp get character encoding getcharacterencoding test test bug testbug exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet bug servlet ctx add servlet mapping addservletmapping servlet tomcat start byte chunk bytechunk get url geturl http localhost get port getport assert equals assertequals to string tostring test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost result test expected illegal argument exception illegalargumentexception test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req resp to absolute toabsolute test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute bar html assert equals assertequals http localhost level level bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp to absolute toabsolute assert equals assertequals http localhost level result do test encode l dotestencodeurl string location string expected request req tester request testerrequest req set requested session id setrequestedsessionid req set requested session l setrequestedsessionurl response resp response resp set request setrequest req string result resp encodeurl location assert equals assertequals expected result test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid testencodeurl exception do test encode l dotestencodeurl test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl bar html bar html jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid test testencodeurl exception do test encode l dotestencodeurl jsessionid do test encode redirect l dotestencoderedirecturl string location string expected request req tester request testerrequest req set requested session id setrequestedsessionid req set requested session l setrequestedsessionurl response resp response resp set request setrequest req string result resp encoderedirecturl location assert equals assertequals expected result test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test expected illegal argument exception illegalargumentexception test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl iae test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl bar html bar html jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode redirect l dotestencoderedirecturl jsessionid test test encode redirect l testencoderedirecturl exception do test encode l dotestencodeurl jsessionid test test send redirect testsendredirect exception do test send redirect dotestsendredirect foo foo test test send redirect testsendredirect exception do test send redirect dotestsendredirect foo bar foo bar test test send redirect testsendredirect exception do test send redirect dotestsendredirect foo bar foo bar do test send redirect dotestsendredirect string input string expected location expectedlocation exception note sufficient testing relative absolute connector connector connector org apache coyote response c response cresponse org apache coyote response response response response response set connector setconnector connector response set coyote response setcoyoteresponse c response cresponse request request request org apache coyote request c request crequest org apache coyote request request set coyote request setcoyoterequest c request crequest context context tester context testercontext request set context setcontext context response set request setrequest request test response send redirect sendredirect input string location response get header getheader location assert equals assertequals expected location expectedlocation location test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp encodeurl bar html assert equals assertequals bar html result test test bug testbug exception request req tester request testerrequest response resp response resp set request setrequest req string result resp encodeurl bar html assert equals assertequals bar html result bug servlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype multipart boundary cdf start smil type application smil charset utf iso charset type parameter print writer printwriter resp get writer getwriter resp get character encoding getcharacterencoding equals iso print print fail resp get character encoding getcharacterencoding
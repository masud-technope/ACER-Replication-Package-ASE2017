licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java buffered input stream bufferedinputstream java file java i o exception ioexception java input stream inputstream java output stream outputstream java print writer printwriter java net httpurlconnection java net inet address inetaddress java net url java util enumeration java util hash map hashmap java util list java util map javax servlet servlet context servletcontext javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse javax servlet http http session httpsession org junit fail org junit org junit org junit org apache catalina container org apache catalina lifecycle exception lifecycleexception org apache catalina lifecycle state lifecyclestate org apache catalina manager org apache catalina server org apache catalina service org apache catalina connector connector org apache catalina core apr lifecycle listener aprlifecyclelistener org apache catalina core standard server standardserver org apache catalina session manager base managerbase org apache catalina session standard manager standardmanager org apache catalina valves access log valve accesslogvalve org apache tomcat util buf byte chunk bytechunk base test tomcat instance test don writing cleanup code tomcat base test tomcatbasetest logging base test loggingbasetest tomcat tomcat access log enabled accesslogenabled string temp dir system get property getproperty java tmp dir tmpdir tomcat instance accessible classes tomcat get tomcat instance gettomcatinstance tomcat classes port connect get port getport tomcat get connector getconnector get local port getlocalport classes check access log valve accesslogvalve active is access log enabled isaccesslogenabled access log enabled accesslogenabled override set up setup exception set up setup trigger loading catalina properties catalina properties catalinaproperties get property getproperty foo file app base appbase file get temporary directory gettemporarydirectory web apps webapps app base appbase exists app base appbase mkdir fail unable create app base appbase test tomcat tomcat with fast session ds tomcatwithfastsessionids string protocol get protocol getprotocol connector connector connector protocol listen localhost connector set attribute setattribute add ress address inet address inetaddress get by name getbyname localhost get host address gethostaddress random free port connector set port setport reduce time outs timeouts async tests connector set attribute setattribute connection timeout connectiontimeout tomcat get service getservice add connector addconnector connector tomcat set connector setconnector connector add apr lifecycle listener aprlifecyclelistener apr connector protocol apr standard server standardserver server standard server standardserver tomcat get server getserver apr lifecycle listener aprlifecyclelistener listener apr lifecycle listener aprlifecyclelistener listener setsslrandomseed dev urandom server add lifecycle listener addlifecyclelistener listener connector set attribute setattribute poller thread count pollerthreadcount integer value of valueof file catalina base catalinabase get temporary directory gettemporarydirectory tomcat set base dir setbasedir catalina base catalinabase get absolute path getabsolutepath tomcat get host gethost set app base setappbase app base appbase get absolute path getabsolutepath access log enabled accesslogenabled parse boolean parseboolean system get property getproperty tomcat test access log accesslog access log enabled accesslogenabled string access log directory accesslogdirectory system get property getproperty tomcat test reports access log directory accesslogdirectory access log directory accesslogdirectory file get build directory getbuilddirectory logs to string tostring access log valve accesslogvalve alv access log valve accesslogvalve alv set directory setdirectory access log directory accesslogdirectory alv set pattern setpattern tomcat get host gethost get pipeline getpipeline add valve addvalve alv delete temp dir tempdir logs delete sub directories subdirectories add delete on tear down adddeleteonteardown file catalina base catalinabase web apps webapps add delete on tear down adddeleteonteardown file catalina base catalinabase work string get protocol getprotocol protocol string protocol system get property getproperty tomcat test protocol bio protocol protocol org apache coyote http http protocol protocol override tear down teardown exception destroy called tomcat server tomcat server get state getstate lifecycle state lifecyclestate destroyed tomcat server get state getstate lifecycle state lifecyclestate stopped tomcat tomcat destroy tear down teardown simple servlet test cases hello world servlet helloworldservlet http servlet httpservlet serialversionuid string response text html body body html override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception print writer printwriter resp get writer getwriter print response text request descriptor requestdescriptor map string string request info requestinfo hash map hashmap string string map string string context init parameters contextinitparameters hash map hashmap string string map string string context attributes contextattributes hash map hashmap string string map string string headers case ins ensitive key map caseinsensitivekeymap string map string string attributes hash map hashmap string string map string string params hash map hashmap string string map string string session attributes sessionattributes hash map hashmap string string map string string get request info getrequestinfo request info requestinfo map string string get context init parameters getcontextinitparameters context init parameters contextinitparameters map string string get context attributes getcontextattributes context attributes contextattributes map string string get headers getheaders headers map string string get attributes getattributes attributes map string string get params getparams params map string string get session attributes getsessionattributes session attributes sessionattributes string get request info getrequestinfo string request info requestinfo put request info putrequestinfo string string request info requestinfo string get context init parameter getcontextinitparameter string context init parameters contextinitparameters put context init parameter putcontextinitparameter string string context init parameters contextinitparameters string get context attribute getcontextattribute string context attributes contextattributes put context attribute putcontextattribute string string context attributes contextattributes string get header getheader string headers put header putheader string string headers string get attribute getattribute string attributes put attribute putattribute string string attributes string get param getparam string params put param putparam string string params string get session attribute getsessionattribute string session attributes sessionattributes put session attribute putsessionattribute string string session attributes sessionattributes compare request descriptor requestdescriptor request map string string base map string string cmp base request get request info getrequestinfo cmp get request info getrequestinfo string base key set keyset assert equals assertequals request info base cmp base request get context init parameters getcontextinitparameters cmp get context init parameters getcontextinitparameters string base key set keyset assert equals assertequals context parameter base cmp base request get context attributes getcontextattributes cmp get context attributes getcontextattributes string base key set keyset assert equals assertequals context attribute base cmp base request get headers getheaders cmp get headers getheaders string base key set keyset assert equals assertequals header base cmp base request get attributes getattributes cmp get attributes getattributes string base key set keyset assert equals assertequals attribute base cmp base request get params getparams cmp get params getparams string base key set keyset assert equals assertequals param base cmp base request get session attributes getsessionattributes cmp get session attributes getsessionattributes string base key set keyset assert equals assertequals session attribute base cmp snoop result snoopresult request descriptor requestdescriptor parse string body string key string string request descriptor requestdescriptor request request descriptor requestdescriptor string line separator lineseparator system get property getproperty separator string body split line separator lineseparator index of indexof key substring substring key index of indexof key substring key key substring key equals context param request put context init parameter putcontextinitparameter key equals context attribute request put context attribute putcontextattribute key equals header request put header putheader key equals attribute request put attribute putattribute key equals param request put param putparam key equals session attribute request put session attribute putsessionattribute request put request info putrequestinfo key request put request info putrequestinfo key request simple servlet dumps request tests not e note additional test values snoop result snoopresult snoop servlet snoopservlet http servlet httpservlet serialversionuid suppress warnings suppresswarnings deprecation override service http servlet request httpservletrequest request http servlet response httpservletresponse response servlet exception servletexception i o exception ioexception string string builder stringbuilder object attribute servlet context servletcontext ctx get servlet context getservletcontext http session httpsession session request get session getsession print writer printwriter response get writer getwriter response set content type setcontenttype text plain println context ctx get servlet context name getservletcontextname println context path ctx get context path getcontextpath println context major version ctx get major version getmajorversion println context minor version ctx get minor version getminorversion println context server info ctx get server info getserverinfo enumeration string ctx get init parameter names getinitparameternames has more elements hasmoreelements next element nextelement println context init param ctx get init parameter getinitparameter enumeration string ctx get attribute names getattributenames has more elements hasmoreelements next element nextelement println context attribute ctx get attribute getattribute println request context path request get context path getcontextpath println request server request get server name getservername println request server port request get server port getserverport println request local request get local name getlocalname println request local addr request get local addr getlocaladdr println request local port request get local port getlocalport println request remote host request get remote host getremotehost println request remote addr request get remote addr getremoteaddr println request remote port request get remote port getremoteport println request protocol request get protocol getprotocol println request scheme request get scheme getscheme println request secure request is secure issecure println request uri request getrequesturi println request url request getrequesturl println request servlet path request get servlet path getservletpath println request method request get method getmethod println request path info request get path info getpathinfo println request path translated request get path translated getpathtranslated println request query string request get query string getquerystring println request remote user request get remote user getremoteuser println request type request get auth type getauthtype println request user principal request get user principal getuserprincipal println request character encoding request get character encoding getcharacterencoding println request content length request get content length getcontentlength println request content type request get content type getcontenttype println request locale request get locale getlocale enumeration string request get header names getheadernames has more elements hasmoreelements next element nextelement string builder stringbuilder enumeration string request get headers getheaders has more elements hasmoreelements append next element nextelement has more elements hasmoreelements append println header enumeration string request get attribute names getattributenames has more elements hasmoreelements next element nextelement attribute request get attribute getattribute println attribute attribute attribute enumeration string request get parameter names getparameternames has more elements hasmoreelements next element nextelement string builder stringbuilder string values request get parameter values getparametervalues values length append values append println param println session requested request get requested session id getrequestedsessionid println session requested cookie request is requested session id from cookie isrequestedsessionidfromcookie println session requested url request is requested session id from url isrequestedsessionidfromurl println session requested valid request is requested session id valid isrequestedsessionidvalid session println session session get id getid println session creation time session get creation time getcreationtime println session acc essed accessed time session get last accessed time getlastaccessedtime println session max inactive interval session get max inactive interval getmaxinactiveinterval println session session is new isnew enumeration string session get attribute names getattributenames has more elements hasmoreelements next element nextelement attribute session get attribute getattribute println session attribute attribute attribute body size bodysize equals ignore case equalsignorecase request get method getmethod input stream inputstream request get input stream getinputstream read buffer read read read buffer read body size bodysize read println request body size body size bodysize servlet simply echos request body response body echo body servlet echobodyservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception body echo override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception beware clients send request body reading response test lock buffer read input stream inputstream output stream outputstream req get input stream getinputstream resp get output stream getoutputstream read write buffer read read read buffer i o exception ioexception close i o exception ioexception close i o exception ioexception wrapper response byte chunk bytechunk get url geturl string path i o exception ioexception byte chunk bytechunk byte chunk bytechunk get url geturl path get url geturl string path byte chunk bytechunk map string list string res head reshead i o exception ioexception get url geturl path res head reshead head url headurl string path byte chunk bytechunk map string list string res head reshead i o exception ioexception method url methodurl path res head reshead head get url geturl string path byte chunk bytechunk map string list string req head reqhead map string list string res head reshead i o exception ioexception get url geturl path req head reqhead res head reshead get url geturl string path byte chunk bytechunk read timeout readtimeout map string list string req head reqhead map string list string res head reshead i o exception ioexception method url methodurl path read timeout readtimeout req head reqhead res head reshead method url methodurl string path byte chunk bytechunk read timeout readtimeout map string list string req head reqhead map string list string res head reshead string method i o exception ioexception url url url path httpurlconnection connection httpurlconnection url open connection openconnection connection set use caches setusecaches connection set read timeout setreadtimeout read timeout readtimeout connection set request method setrequestmethod method req head reqhead map entry string list string entry req head reqhead entry set entryset string builder stringbuilder value list valuelist string builder stringbuilder string entry get value getvalue value list valuelist length value list valuelist append value list valuelist append connection set request property setrequestproperty entry get key getkey value list valuelist to string tostring connection connect connection get response code getresponsecode res head reshead map string list string head connection get header fields getheaderfields res head reshead put all putall head input stream inputstream connection get input stream getinputstream connection get error stream geterrorstream buffered input stream bufferedinputstream bis bis buffered input stream bufferedinputstream buf bis read buf append buf bis bis close i o exception ioexception byte chunk bytechunk post url posturl body string path i o exception ioexception byte chunk bytechunk byte chunk bytechunk post url posturl body path post url posturl body string path byte chunk bytechunk map string list string res head reshead i o exception ioexception post url posturl body path res head reshead post url posturl body string path byte chunk bytechunk map string list string req head reqhead map string list string res head reshead i o exception ioexception url url url path httpurlconnection connection httpurlconnection url open connection openconnection connection set d o output setdooutput connection set read timeout setreadtimeout req head reqhead map entry string list string entry req head reqhead entry set entryset string builder stringbuilder value list valuelist string builder stringbuilder string entry get value getvalue value list valuelist length value list valuelist append value list valuelist append connection set request property setrequestproperty entry get key getkey value list valuelist to string tostring connection connect write request body output stream outputstream connection get output stream getoutputstream body write body body length i o exception ioexception ioe ioe print stack trace printstacktrace close i o exception ioexception ioe connection get response code getresponsecode res head reshead map string list string head connection get header fields getheaderfields res head reshead put all putall head http servlet response httpservletresponse input stream inputstream connection get input stream getinputstream buffered input stream bufferedinputstream bis bis buffered input stream bufferedinputstream buf bis read buf append buf bis bis close i o exception ioexception tomcat with fast session ds tomcatwithfastsessionids tomcat override start lifecycle exception lifecycleexception fast ins ecure insecure session generation tests server server get server getserver service service server find services findservices container service get container getcontainer container find children findchildren container find children findchildren manager get manager getmanager standard manager standardmanager set manager setmanager manager base managerbase manager base managerbase set secure random class setsecurerandomclass org apache catalina startup fast non secure random fastnonsecurerandom start
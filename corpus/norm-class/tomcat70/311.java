licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java i o exception ioexception java security principal java security cert certificate java text simple date format simpledateformat java util java util locale javax servlet servlet exception servletexception javax servlet http cookie javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina authenticator org apache catalina container org apache catalina context org apache catalina globals org apache catalina lifecycle exception lifecycleexception org apache catalina manager org apache catalina realm org apache catalina session org apache catalina valve org apache catalina wrapper org apache catalina connector request org apache catalina connector response org apache catalina deploy login config loginconfig org apache catalina deploy security constraint securityconstraint org apache catalina realm generic principal genericprincipal org apache catalina util date tool datetool org apache catalina util session id generator base sessionidgeneratorbase org apache catalina util standard session id generator standardsessionidgenerator org apache catalina valves valve base valvebase org apache coyote action code actioncode org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util res string manager stringmanager authenticator base authenticatorbase valve base valvebase authenticator log log log factory logfactory get log getlog authenticator base authenticatorbase constructor authenticator base authenticatorbase instance variables authentication header string header authenticate authentication realm string realm authentication required session user authenticated offer performance benefits session cache authenticated principal removing authenticate user realm request combinations basic authentication jndi realm jndirealm data source real ms datasourcerealms performance cost creating ing session session created always use session alwaysusesession cache authenticated principals request http session cache session changed successful authentication prevent session fixation att ack attack change session id on authentication changesessionidonauthentication context valve attached context context descriptive implementation string info org apache catalina authenticator authenticator base authenticatorbase flag determine disable proxy caching leave issue webapp dev eloper developer disable proxy caching disableproxycaching flag determine disable proxy caching headers incompatible secure pages with pragma securepageswithpragma java secure random number generator generating sso session identifiers random number generator see ding seeding argument constructor instance link java security secure random securerandom generated string secure random class securerandomclass algorithm create instances link java security secure random securerandom generate sso session i d s ids algorithm sha prng platform sha prng empty string invalid algorithm provider secure random securerandom instances created defaults fails secure random securerandom instances created platform defaults string secure random algorithm securerandomalgorithm sha prng provider create instances link java security secure random securerandom generate session sso i d s ids algorithm sha prng invalid algorithm provider secure random securerandom instances created defaults fails secure random securerandom instances created platform defaults string secure random provider securerandomprovider session id generator base sessionidgeneratorbase session id generator sessionidgenerator string manager string manager stringmanager string manager stringmanager get manager getmanager constants single sign on singlesignon implementation request processing chain single sign on singlesignon sso expires header generate string simple date format simpledateformat date tool datetool http response header locale format properties get always use session getalwaysusesession always use session alwaysusesession set always use session setalwaysusesession always use session alwaysusesession always use session alwaysusesession always use session alwaysusesession cache authenticated principals flag get cache getcache cache cache authenticated principals flag param cache cache flag set cache setcache cache cache cache container valve attached override container get container getcontainer context container valve attached param container container attached override set container setcontainer container container container container context illegal argument exception illegalargumentexception get string getstring authenticator not context notcontext set container setcontainer container context context container descriptive valve implementation override string get info getinfo info flag add headers disable caching proxies get disable proxy caching getdisableproxycaching disable proxy caching disableproxycaching flag add headers disable caching proxies param nocache code code add headers disable proxy caching code code leave headers set disable proxy caching setdisableproxycaching nocache disable proxy caching disableproxycaching nocache flag proxy caching disabled headers add disable caching get secure pages with pragma getsecurepageswithpragma secure pages with pragma securepageswithpragma flag headers add disable proxy caching param secure pages with pragma securepageswithpragma code code add headers incompatible down loading downloading off ice office doc uments documents ssl caching problem mozilla set secure pages with pragma setsecurepageswithpragma secure pages with pragma securepageswithpragma secure pages with pragma securepageswithpragma secure pages with pragma securepageswithpragma flag change session existing session successful authentication code code change session successful authentication code code perform change get change session id on authentication getchangesessionidonauthentication change session id on authentication changesessionidonauthentication flag change session existing session successful authentication param change session id on authentication changesessionidonauthentication code code change session successful authentication code code perform change set change session id on authentication setchangesessionidonauthentication change session id on authentication changesessionidonauthentication change session id on authentication changesessionidonauthentication change session id on authentication changesessionidonauthentication secure random number generator string get secure random class getsecurerandomclass secure random class securerandomclass secure random number generator param secure random class securerandomclass secure random number generator set secure random class setsecurerandomclass string secure random class securerandomclass secure random class securerandomclass secure random class securerandomclass secure random number generator algorithm string get secure random algorithm getsecurerandomalgorithm secure random algorithm securerandomalgorithm secure random number generator algorithm param secure random algorithm securerandomalgorithm secure random number generator algorithm set secure random algorithm setsecurerandomalgorithm string secure random algorithm securerandomalgorithm secure random algorithm securerandomalgorithm secure random algorithm securerandomalgorithm secure random number generator provider string get secure random provider getsecurerandomprovider secure random provider securerandomprovider secure random number generator provider param secure random provider securerandomprovider secure random number generator provider set secure random provider setsecurerandomprovider string secure random provider securerandomprovider secure random provider securerandomprovider secure random provider securerandomprovider methods enforce security restrictions web application deployment descriptor context param request request processed param response response processed exception i o exception ioexception input output error occurs exception servlet exception servletexception thrown processing element override invoke request request response response i o exception ioexception servlet exception servletexception log is debug enabled isdebugenabled log debug security checking request request get method getmethod request getrequesturi login config loginconfig config context get login config getloginconfig cached authenticated principal record cache principal principal request get user principal getuserprincipal principal session session request get session internal getsessioninternal session principal session get principal getprincipal principal log is debug enabled isdebugenabled log debug cached type session get auth type getauthtype principal session get principal getprincipal request set auth type setauthtype session get auth type getauthtype request set user principal setuserprincipal principal special handling form based log ins logins deal login form security check uri sub mits submits secure d secured area string context path contextpath context get path getpath string requesturi request get decoded request i getdecodedrequesturi requesturi starts with startswith context path contextpath requesturi ends with endswith constants form action authenticate request response config log is debug enabled isdebugenabled log debug failed authenticate test requesturi special handling form based log ins logins deal resource http methods authentication redirecting resource todo form authenticator formauthenticator match request matchrequest logic remove dup lication duplication session session request get session internal getsessioninternal session saved request savedrequest saved request savedrequest saved request savedrequest session get note getnote constants form request note saved request savedrequest string decodedrequesturi request get decoded request i getdecodedrequesturi decodedrequesturi decodedrequesturi equals saved request savedrequest get decoded request i getdecodedrequesturi authenticate request response log is debug enabled isdebugenabled log debug failed authenticate test authenticator http status code special servlet security constraints annotations ensure processed constraints checked wrapper wrapper wrapper request get mapping data getmappingdata wrapper wrapper wrapper servlet security annotation scan servletsecurityannotationscan realm realm context get realm getrealm request uri subject security constraint security constraint securityconstraint constraints realm find security constraints findsecurityconstraints request context constraints context get preemptive authentication getpreemptiveauthentication log is debug enabled isdebugenabled log debug subject constraint get next getnext invoke request response browse rs browsers caching provide security hole constraints disable proxy caching disableproxycaching post equals ignore case equalsignorecase request get method getmethod secure pages with pragma securepageswithpragma note problems down loading downloading files response set header setheader pragma cache response set header setheader cache control cache response set header setheader cache control response set header setheader expires constraints enforce user data constraint security constraint log is debug enabled isdebugenabled log debug calling has user data permission hasuserdatapermission realm has user data permission hasuserdatapermission request response constraints log is debug enabled isdebugenabled log debug failed has user data permission hasuserdatapermission test authenticator http status code special authenticate modifies response failure check auth required authrequired constraints auth required authrequired auth required authrequired constraints length auth required authrequired constraints get auth constraint getauthconstraint auth required authrequired constraints get all roles getallroles string roles constraints find auth roles findauthroles roles roles length auth required authrequired auth required authrequired context get preemptive authentication getpreemptiveauthentication auth required authrequired request get coyote request getcoyoterequest get mime headers getmimeheaders get value getvalue authorization auth required authrequired context get preemptive authentication getpreemptiveauthentication http servlet request httpservletrequest client cert equals get auth method getauthmethod certificate certs get request certificates getrequestcertificates request auth required authrequired certs certs length auth required authrequired log is debug enabled isdebugenabled log debug calling authenticate authenticate request response config log is debug enabled isdebugenabled log debug failed authenticate test authenticator http status code special constraints log is debug enabled isdebugenabled log debug calling access control accesscontrol realm has resource permission hasresourcepermission request response constraints context log is debug enabled isdebugenabled log debug failed access control accesscontrol test access control accesscontrol method http status code special constraints satisfied log is debug enabled isdebugenabled log debug passed security constraints get next getnext invoke request response methods certificate chain request key code javax servlet request certificate code trigger extra cting extracting certificate chain coyote request param request request processed certificate chain code code certificate get request certificates getrequestcertificates request request illegal state exception illegalstateexception certificate certs certificate request get attribute getattribute globals certificates attr certs certs length request get coyote request getcoyoterequest action action code actioncode req ssl certificate certs certificate request get attribute getattribute globals certificates attr illegal state exception illegalstateexception ise certs associate single sign identifier session param sso id ssoid single sign identifier param session session associate string sso id ssoid session session sso sso associate sso id ssoid session authenticate user making request based login configuration link context authenticator code code constraint satisfied code code created response challenge param request request processing param response response pop ulating populating exception i o exception ioexception input output error occurs override authenticate request request http servlet response httpservletresponse response i o exception ioexception context context get login config getloginconfig authenticate request response context get login config getloginconfig authenticate user making request based login configuration code code constraint satisfied code code created response challenge param request request processing param response response pop ulating populating param config login configuration describing authentication performed exception i o exception ioexception input output error occurs override authenticate request request http servlet response httpservletresponse response login config loginconfig config i o exception ioexception check user authenticated earlier processing chain authenticate user req uiring requiring user int eraction interaction param request current request param response current response param usesso sso attempt authenticate current user code code user authenticated cache code code check for cached authentication checkforcachedauthentication request request http servlet response httpservletresponse response usesso user authenticated principal principal request get user principal getuserprincipal string sso id ssoid string request get note getnote constants req ssoid note principal log is debug enabled isdebugenabled log debug get string getstring authenticator check principal get name getname invalidation log sso id ssoid associate sso id ssoid request get session internal getsessioninternal sso session reauthenticate usesso sso id ssoid log is debug enabled isdebugenabled log debug get string getstring authenticator check sso sso id ssoid reauthenticate data cached sso fails original sso log on logon digest ssl reauthenticate cached username password realm denied user reauthentication reason prompt user log on logon reauthenticatefromsso sso id ssoid request author ized authorized request get coyote request getcoyoterequest get remote user needs authorization getremoteuserneedsauthorization string username request get coyote request getcoyoterequest get remote user getremoteuser to string tostring username log is debug enabled isdebugenabled log debug get string getstring authenticator check auth orize authorize username principal author ized authorized context get realm getrealm authenticate username author ized authorized authenticated user log is debug enabled isdebugenabled log debug get string getstring authenticator check auth orize fail authorizefail username author ized authorized generic principal genericprincipal username string auth type authtype request get auth type getauthtype auth type authtype auth type authtype length auth type authtype get auth method getauthmethod register request response author ized authorized auth type authtype username attempts reauthentication code realm code credentials included argument code entry code param sso id ssoid identifier single sign on singlesignon session caller param request request authenticated reauthenticatefromsso string sso id ssoid request request sso sso id ssoid reauthenticated container parent get container getcontainer parent realm realm parent get realm getrealm realm reauthenticated sso reauthenticate sso id ssoid realm request reauthenticated associate sso id ssoid request get session internal getsessioninternal log is debug enabled isdebugenabled log debug reauthenticated cached principal request get user principal getuserprincipal get name getname type request get auth type getauthtype reauthenticated register authenticated principal authentication type request current session single sign on singlesignon valve cookie returned param request servlet request processing param response servlet response generating param principal authenticated principal registered param auth type authtype authentication type registered param username username authenticate param password password authenticate register request request http servlet response httpservletresponse response principal principal string auth type authtype string username string password log is debug enabled isdebugenabled string principal principal get name getname log debug authenticated type auth type authtype cache authentication request request set auth type setauthtype auth type authtype request set user principal setuserprincipal principal session session request get session internal getsessioninternal session session change session id on authentication changesessionidonauthentication principal manager manager request get context getcontext get manager getmanager manager change session id changesessionid session request change session id changesessionid session get id getid always use session alwaysusesession session request get session internal getsessioninternal cache authentication session cache session session set auth type setauthtype auth type authtype session set principal setprincipal principal username session set note setnote constants sess use rname username note username session remove note removenote constants sess use rname username note password session set note setnote constants sess password note password session remove note removenote constants sess password note construct cookie returned client sso create sso entry sso not e note existing entry subsequent requests digest ssl authenticated contexts string sso id ssoid string request get note getnote constants req ssoid note sso id ssoid construct cookie returned client sso id ssoid session id generator sessionidgenerator generate session id generatesessionid cookie cookie cookie constants single sig n sign cookie sso id ssoid cookie set max age setmaxage cookie set path setpath bug zilla bugzilla cookie set secure setsecure request is secure issecure bug zilla bugzilla string sso domain ssodomain sso get cookie domain getcookiedomain sso domain ssodomain cookie set domain setdomain sso domain ssodomain configure http only httponly sso cookie rules session cookies request get servlet context getservletcontext get session cookie config getsessioncookieconfig is http only ishttponly request get context getcontext get use http only getusehttponly cookie set http only sethttponly response add cookie addcookie cookie register principal sso valve sso register sso id ssoid principal auth type authtype username password request set note setnote constants req ssoid note sso id ssoid principal registering program matic programmatic log out logout sso deregister sso id ssoid request remove note removenote constants req ssoid note update sso session latest authentication data sso update sso id ssoid principal auth type authtype username password sso entry cleared don associate session session session request get session internal getsessioninternal sso associate sso id ssoid session override login string username string password request request servlet exception servletexception principal principal do login dologin request username password register request request get response getresponse principal get auth method getauthmethod username password string get auth method getauthmethod process login request param request request param username user param password password authenticated principal servlet exception servletexception principal do login dologin request request string username string password servlet exception servletexception principal context get realm getrealm authenticate username password servlet exception servletexception get string getstring authenticator login fail loginfail override log out logout request request servlet exception servletexception register request request get response getresponse start component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception single sign on singlesignon implementation request processing path container parent context get parent getparent sso parent valve valves parent get pipeline getpipeline get val ves getvalves valves length valves single sign on singlesignon sso single sign on singlesignon valves sso parent parent get parent getparent log is debug enabled isdebugenabled sso log debug single sign on singlesignon valve sso log debug single sign on singlesignon valve session id generator sessionidgenerator standard session id generator standardsessionidgenerator session id generator sessionidgenerator set secure random algorithm setsecurerandomalgorithm get secure random algorithm getsecurerandomalgorithm session id generator sessionidgenerator set secure random class setsecurerandomclass get secure random class getsecurerandomclass session id generator sessionidgenerator set secure random provider setsecurerandomprovider get secure random provider getsecurerandomprovider start internal startinternal component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override stop internal stopinternal lifecycle exception lifecycleexception stop internal stopinternal sso
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http file upload fileupload java file java file output stream fileoutputstream java io exception ioexception java output stream outputstream output stream retain data memory threshold reached commit disk stream closed threshold reached data written disk originated file upload fileupload processing advance size file uploaded file small store memory speed file large store file avoid memory issues deferred file output stream deferredfileoutputstream thresholding output stream thresholdingoutputstream data members output stream data written prior the shold theshold reached byte array output stream bytearrayoutputstream memory output stream memoryoutputstream output stream data written time code memory output stream memoryoutputstream code code disk output stream diskoutputstream code output stream outputstream current output stream currentoutputstream file output dir ected directed threshold exc eeded exceeded file output file outputfile temporary file prefix string prefix temporary file suffix string suffix directory temporary files file directory constructs instance trigger event threshold save data file point param threshold number bytes trigger event param output file outputfile file data saved threshold deferred file output stream deferredfileoutputstream threshold file output file outputfile threshold output file outputfile constructs instance trigger event threshold save data file point param threshold number bytes trigger event param output file outputfile file data saved threshold param prefix prefix temporary file param suffix suffix temporary file param directory temporary file directory deferred file output stream deferredfileoutputstream threshold file output file outputfile string prefix string suffix file directory threshold output file outputfile output file outputfile memory output stream memoryoutputstream byte array output stream bytearrayoutputstream current output stream currentoutputstream memory output stream memoryoutputstream prefix prefix suffix suffix directory directory thresholding output stream thresholdingoutputstream methods returns current output stream memory based disk based depending current resp ect respect threshold underlying output stream exception io exception ioexception error occurs override output stream outputstream get stream getstream io exception ioexception current output stream currentoutputstream switches underlying output stream memory based stream backed disk point realise data written memory elect disk based storage exception io exception ioexception error occurs override threshold reached thresholdreached io exception ioexception prefix output file outputfile file create temp file createtempfile prefix suffix directory file output stream fileoutputstream fos file output stream fileoutputstream output file outputfile memory output stream memoryoutputstream write to writeto fos current output stream currentoutputstream fos memory output stream memoryoutputstream methods determines data output stream retained memory code data memory code is in memory isinmemory is threshold exceeded isthresholdexceeded returns data output stream array bytes assuming data retained memory data written disk method returns code data output stream code data get data getdata memory output stream memoryoutputstream memory output stream memoryoutputstream to byte array tobytearray returns output file constructor temporary file created constructor file returns output file threshold reached constructor temporary file prefix suffix temporary file created threshold reached returned threshold reached code returned file output stream code file exists file get file getfile output file outputfile closes underlying output stream mark closed exception io exception ioexception error occurs override close io exception ioexception close
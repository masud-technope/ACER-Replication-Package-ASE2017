licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java security principal java util array list arraylist java util iterator java util list javax naming context org apache catalina group org apache catalina lifecycle exception lifecycleexception org apache catalina role org apache catalina user org apache catalina user database userdatabase org apache catalina wrapper org apache tomcat util exception utils exceptionutils implementation link org apache catalina realm based implementation link user database userdatabase global jndi resources configured instance catalina code resource name resourcename code parameter global jndi resources configured instance code user database userdatabase code consult author craig mc clanahan mcclanahan user database realm userdatabaserealm realm base realmbase instance variables code user database userdatabase code authenticate users identify roles user database userdatabase database descriptive realm implementation string info org apache catalina realm user database realm userdatabaserealm descriptive realm implementation string user database realm userdatabaserealm global jndi code user database userdatabase code resource util izing utilizing string resource name resourcename user database userdatabase properties descriptive realm implementation version number format code description version code override string get info getinfo info global jndi code user database userdatabase code resource string get resource name getresourcename resource name resourcename global jndi code user database userdatabase code resource param resource name resourcename global jndi set resource name setresourcename string resource name resourcename resource name resourcename resource name resourcename methods code code principal security role context realm code code implementation returns code code code user code role code group code code user code member role param principal principal role checked param role security role checked override has role hasrole wrapper wrapper principal principal string role check role alias defined security role element wrapper string real role realrole wrapper find security reference findsecurityreference role real role realrole role real role realrole principal generic principal genericprincipal generic principal genericprincipal generic principal genericprincipal principal get user principal getuserprincipal user principal get user principal getuserprincipal principal user play nice sso mixed real ms realms has role hasrole principal role equals role role user user user principal role dbrole database find role findrole role dbrole user is in role isinrole dbrole iterator group groups user get groups getgroups groups has next hasnext group group groups group is in role isinrole dbrole methods realm implementation override string get name getname password principal user override string get password getpassword string username user user database find user finduser username user user get password getpassword principal user override principal get principal getprincipal string username user user database find user finduser username user list string roles array list arraylist string iterator role uroles user get roles getroles uroles has next hasnext role role uroles roles add role get name getname iterator group groups user get groups getgroups groups has next hasnext group group groups uroles group get roles getroles uroles has next hasnext role role uroles roles add role get name getname generic principal genericprincipal username user get password getpassword roles user lifecycle methods prepare active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception context context get server getserver get global naming context getglobalnamingcontext database user database userdatabase context lookup resource name resourcename throwable exception utils exceptionutils handle throwable handlethrowable container log containerlog error get string getstring user database realm userdatabaserealm lookup resource name resourcename database database lifecycle exception lifecycleexception get string getstring user database realm userdatabaserealm no database nodatabase resource name resourcename start internal startinternal gracefully terminate active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error reported override stop internal stopinternal lifecycle exception lifecycleexception perform normal superclass fin alization finalization stop internal stopinternal release reference user database database
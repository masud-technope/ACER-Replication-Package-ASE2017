licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util scan java file java i o exception ioexception java net jarurlconnection java net url java net url class loader urlclassloader java net url connection urlconnection java util hash set hashset java util iterator java util java util string tokenizer stringtokenizer javax servlet servlet context servletcontext org apache juli logging log org apache juli logging log factory logfactory org apache tomcat jar scanner jarscanner org apache tomcat jar scanner callback jarscannercallback org apache tomcat util exception utils exceptionutils org apache tomcat util buf uri util uriutil org apache tomcat util file matcher org apache tomcat util res string manager stringmanager link jar scanner jarscanner implementation scans web inf lib directory class loader classloader works class loader classloader hierarchy implementation sufficient meet requirements servlet specification provide number tomcat specific extensions extensions scan ning scanning class loader classloader hierarchy enabled testing files jar s jars disabled testing directories exp loded exploded jar s jars disabled extensions control led controlled configuration standard jar scanner standardjarscanner jar scanner jarscanner log log log factory logfactory get log getlog standard jar scanner standardjarscanner string default jars to skip defaultjarstoskip hash set hashset string string resources string manager stringmanager string manager stringmanager get manager getmanager constants string jar list jarlist system get property getproperty constants skip jars property jar list jarlist string tokenizer stringtokenizer tokenizer string tokenizer stringtokenizer jar list jarlist tokenizer has more elements hasmoreelements string token tokenizer next token nexttoken trim token length default jars to skip defaultjarstoskip add token controls classpath scanning extension scan class path scanclasspath is scan class path isscanclasspath scan class path scanclasspath set scan class path setscanclasspath scan class path scanclasspath scan class path scanclasspath scan class path scanclasspath controls testing files jar files extension scan all files scanallfiles is scan all files isscanallfiles scan all files scanallfiles set scan all files setscanallfiles scan all files scanallfiles scan all files scanallfiles scan all files scanallfiles controls testing directories exp loded exploded jar files extension scan all dir ectories scanalldirectories is scan all dir ectories isscanalldirectories scan all dir ectories scanalldirectories set scan all dir ectories setscanalldirectories scan all dir ectories scanalldirectories scan all dir ectories scanalldirectories scan all dir ectories scanalldirectories controls testing bootstrap classpath consists runtime classes jvm installed system extensions scan bootstrap class path scanbootstrapclasspath is scan bootstrap class path isscanbootstrapclasspath scan bootstrap class path scanbootstrapclasspath set scan bootstrap class path setscanbootstrapclasspath scan bootstrap class path scanbootstrapclasspath scan bootstrap class path scanbootstrapclasspath scan bootstrap class path scanbootstrapclasspath scan servlet context servletcontext class loader classloader jar files jar file passed callback handler processed param context servlet context servletcontext locate access web inf lib param class loader classloader class loader classloader access jar s jars web inf lib param callback handler process jar s jars param jars to skip jarstoskip list jar s jars ignore list list read system property defined link constants skip jars property override scan servlet context servletcontext context class loader classloader class loader classloader jar scanner callback jarscannercallback callback string jars to skip jarstoskip log is trace enabled istraceenabled log trace get string getstring jar scan jarscan web inflib start webinflibstart string ignored jars ignoredjars jars to skip jarstoskip ignored jars ignoredjars default jars to skip defaultjarstoskip ignored jars ignoredjars jars to skip jarstoskip scan web inf lib string dir list dirlist context get resource paths getresourcepaths constants web inf lib dir list dirlist iterator string dir list dirlist iterator has next hasnext string path path ends with endswith constants jar ext matcher match name matchname ignored jars ignoredjars path substring path last index of lastindexof scan jar log is debug enabled isdebugenabled log debug get string getstring jar scan jarscan web inflib jar scan webinflibjarscan path url url file ur ls urls faster work string real path realpath context get real path getrealpath path real path realpath url context get resource getresource path url file real path realpath touri tourl process callback url i o exception ioexception log warn get string getstring jar scan jarscan web inflib fail webinflibfail url log is trace enabled istraceenabled log trace get string getstring jar scan jarscan web inflib jar no scan webinflibjarnoscan path scan classpath scan class path scanclasspath class loader classloader log is trace enabled istraceenabled log trace get string getstring jar scan jarscan class loader start classloaderstart class loader classloader loader class loader classloader class loader classloader stop loader stoploader scan bootstrap class path scanbootstrapclasspath reach bootstrap loader stop loader stoploader class loader classloader get system class loader getsystemclassloader get parent getparent loader loader stop loader stoploader loader url class loader urlclassloader url urls url class loader urlclassloader loader geturls urls length extract jar name jarname string jar name jarname get jar name getjarname urls web inf lib scanned jar name jarname matcher match name matchname ignored jars ignoredjars jar name jarname urls to string tostring constants web inf lib jar name jarname log is debug enabled isdebugenabled log debug get string getstring jar scan jarscan class loader jar scan classloaderjarscan urls process callback urls i o exception ioexception ioe log warn get string getstring jar scan jarscan class loader fail classloaderfail urls ioe log is trace enabled istraceenabled log trace get string getstring jar scan jarscan class loader jar no scan classloaderjarnoscan urls loader loader get parent getparent scan url jar s jars optional extensions files directories process jar scanner callback jarscannercallback callback url url i o exception ioexception log is trace enabled istraceenabled log trace get string getstring jar scan jarscan jar url start jarurlstart url url connection urlconnection conn url open connection openconnection conn jarurlconnection callback scan jarurlconnection conn string url str urlstr url to string tostring url str urlstr starts with startswith file url str urlstr starts with startswith jndi url str urlstr starts with startswith http url str urlstr starts with startswith https url str urlstr ends with endswith constants jar ext url jarurl uri util uriutil build jar url buildjarurl url str urlstr callback scan jarurlconnection jarurl open connection openconnection file file url touri is file isfile scan all files scanallfiles treat file jar url jarurl uri util uriutil build jar url buildjarurl callback scan jarurlconnection jarurl open connection openconnection is directory isdirectory scan all dir ectories scanalldirectories file meta inf metainf file get absolute file getabsolutefile file separator meta inf meta inf metainf is directory isdirectory callback scan throwable exception utils exceptionutils handle throwable handlethrowable i o exception ioexception ioe i o exception ioexception ioe init cause initcause ioe extract jar url string get jar name getjarname url url string string path url get path getpath path index of indexof constants jar ext start path last index of lastindexof path substring start is scan all dir ectories isscanalldirectories start path last index of lastindexof path substring start
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http java print writer printwriter java string writer stringwriter org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util buf byte chunk bytechunk org apache tomcat util buf message bytes messagebytes org apache tomcat util log user data helper userdatahelper org apache tomcat util res string manager stringmanager collection cookies reusable tuned server side performance based rfc author costin manolache author kevin seguin cookies log log log factory logfactory get log getlog cookies user data helper userdatahelper user data log userdatalog user data helper userdatahelper log string manager stringmanager string manager stringmanager get manager getmanager org apache tomcat util http expected average number cookies request initial size server cookie servercookie scookies server cookie servercookie initial size cookie count cookiecount limit unprocessed mime headers mimeheaders headers construct cookie collection extract headers param headers cookies lazy eval uated evaluated extract headers cookies mime headers mimeheaders headers headers headers set limit setlimit limit limit limit limit scookies length limit cookie count cookiecount limit shrink cookie list array server cookie servercookie scookies tmp scookiestmp server cookie servercookie limit system arraycopy scookies scookies tmp scookiestmp cookie count cookiecount scookies scookies tmp scookiestmp recycle recycle cookie count cookiecount scookies scookies recycle cookie count cookiecount unprocessed expensive debug ging debugging override string to string tostring string writer stringwriter string writer stringwriter print writer printwriter print writer printwriter println cookies count get cookie count getcookiecount count println get cookie getcookie to string tostring to string tostring indexed access server cookie servercookie get cookie getcookie idx unprocessed update cookies get cookie count getcookiecount scookies idx get cookie count getcookiecount unprocessed unprocessed process cookies processcookies headers cookie count cookiecount adding cookies register initialized cookie cookies recycle d recycled time existing server cookie servercookie object returned caller attributes cookie server cookie servercookie add cookie addcookie limit cookie count cookiecount limit illegal argument exception illegalargumentexception get string getstring cookies max count fail maxcountfail integer value of valueof limit cookie count cookiecount scookies length new size newsize math min cookie count cookiecount limit server cookie servercookie scookies tmp scookiestmp server cookie servercookie new size newsize system arraycopy scookies scookies tmp scookiestmp cookie count cookiecount scookies scookies tmp scookiestmp server cookie servercookie scookies cookie count cookiecount server cookie servercookie scookies cookie count cookiecount cookie count cookiecount code cookie tools cookietools add cookie headers request process cookies processcookies mime headers mimeheaders headers headers process process cookie header pos pos cookie version needed pos headers find header findheader cookie pos cookie headers headers pos message bytes messagebytes cookie value cookievalue headers get value getvalue pos cookie value cookievalue cookie value cookievalue is null isnull pos cookie value cookievalue get type gettype message bytes messagebytes bytes exception exception log warn cookies parsing cookie string expected bytes cookie value cookievalue to bytes tobytes log is debug enabled isdebugenabled log debug cookies parsing cookie value cookievalue to string tostring byte chunk bytechunk cookie value cookievalue get byte chunk getbytechunk cookie support cookiesupport preserve cookie header len get length getlength len buf len system arraycopy get bytes getbytes get offset getoffset buf len process cookie header processcookieheader buf len process cookie header processcookieheader get bytes getbytes get offset getoffset get length getlength search position pos xxx ref actored refactored equals string start blen start blen length boff start blen boff char at charat returns whitespace character defined rfc jvk is white space iswhitespace unescapes quotes cookie param cookie modify unescape double quotes unescapedoublequotes byte chunk bytechunk get length getlength index of indexof src get start getstart get end getend dest src buffer get buffer getbuffer src buffer src src buffer src src buffer dest buffer src dest src set end setend dest process cookie header processcookieheader bytes len len bytes len pos name start namestart name end nameend value start valuestart value end valueend version server cookie servercookie is special isspecial is quoted isquoted pos is special isspecial is quoted isquoted pos cookie support cookiesupport is http separator ishttpseparator bytes pos cookie support cookiesupport http separators cookie support cookiesupport is v isv separator bytes pos is white space iswhitespace bytes pos pos pos bytes pos is special isspecial pos value end valueend value start valuestart name start namestart pos pos name end nameend get token end position gettokenendposition bytes pos version pos is white space iswhitespace bytes pos pos pos bytes pos pos pos is white space iswhitespace bytes pos pos bytes pos is quoted isquoted value start valuestart pos value end valueend get quoted value end position getquotedvalueendposition bytes value start valuestart pos value end valueend pos value start valuestart value end valueend version cookie support cookiesupport is v isv separator bytes pos cookie support cookiesupport http separators cookie support cookiesupport is http separator ishttpseparator bytes pos bytes pos cookie support cookiesupport equals value start valuestart pos value end valueend get token end position gettokenendposition bytes value start valuestart version pos value end valueend user data helper userdatahelper mode log mode logmode user data log userdatalog get next mode getnextmode log mode logmode string message get string getstring cookies invalid cookie token invalidcookietoken log mode logmode info debug message get string getstring cookies fall to debug falltodebug info log info message debug log debug message pos bytes pos bytes pos pos pos value start valuestart value end valueend pos name end nameend pos is white space iswhitespace bytes pos pos pos bytes pos bytes pos pos pos is special isspecial is special isspecial equals version bytes name start namestart name end nameend bytes value start valuestart value end valueend value start valuestart version equals domain bytes name start namestart name end nameend get domain getdomain set bytes setbytes bytes value start valuestart value end valueend value start valuestart equals path bytes name start namestart name end nameend get path getpath set bytes setbytes bytes value start valuestart value end valueend value start valuestart equals port bytes name start namestart name end nameend equals commenturl bytes name start namestart name end nameend user data helper userdatahelper mode log mode logmode user data log userdatalog get next mode getnextmode log mode logmode string message get string getstring cookies invalid special invalidspecial log mode logmode info debug message get string getstring cookies fall to debug falltodebug info log info message debug log debug message value start valuestart cookie support cookiesupport add cookie addcookie set version setversion version get name getname set bytes setbytes bytes name start namestart name end nameend name start namestart value start valuestart get value getvalue set bytes setbytes bytes value start valuestart value end valueend value start valuestart is quoted isquoted unescape double quotes unescapedoublequotes get value getvalue get byte chunk getbytechunk get value getvalue set string setstring get token end position gettokenendposition bytes version is name isname pos pos cookie support cookiesupport is http separator ishttpseparator bytes pos version cookie support cookiesupport http separators bytes pos cookie support cookiesupport is v isv separator bytes pos is name isname bytes pos cookie support cookiesupport equals pos pos pos get quoted value end position getquotedvalueendposition bytes pos pos bytes pos pos bytes pos pos pos pos
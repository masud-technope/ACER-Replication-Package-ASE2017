licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http java util locale java util map java util concurrent concurrent hash map concurrenthashmap org apache tomcat util res string manager stringmanager handle intern ationalized internationalized http messages author james duncan david son davidson duncan eng sun author james todd gonzo eng sun author jason hunter jch eng sun author harish prabandham author cost in costin eng sun http messages httpmessages map locale http messages httpmessages instances concurrent hash map concurrenthashmap locale http messages httpmessages http messages httpmessages http messages httpmessages string manager stringmanager get manager getmanager org apache tomcat util http res locale get default getdefault xxx move message resources string manager stringmanager string string string string http messages httpmessages string manager stringmanager status string status code messages defined http spec user isn supposed translate common messages cached string get message getmessage status pre defined user doesn time status get string getstring get string getstring get string getstring get string getstring get string getstring status http messages httpmessages get instance getinstance locale locale http messages httpmessages result instances locale result string manager stringmanager string manager stringmanager get manager getmanager org apache tomcat util http res locale locale get default getdefault equals get locale getlocale result result http messages httpmessages instances locale result result filter message string characters sensitive html avoids potential att acks attacks caused including java script javascript codes request url reported error messages param message message string filtered string filter string message message content message length message get chars getchars message length content string builder stringbuilder result string builder stringbuilder content length content length content result append result append result append amp result append quot result append content result to string tostring message safe http header safe messages meet requirements rfc consist text param msg message test code code message safe http header code code is safe in http header issafeinhttpheader string msg concerns msg reason phrase defined text excluding text defined octet ctl s ctls including lws octet defined bit sequence data ctl defined octets lws exclude pairs defined len msg length len msg char at charat
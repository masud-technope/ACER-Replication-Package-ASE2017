licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat websocket java output stream outputstream java writer java net uri java nio byte buffer bytebuffer java util array list arraylist java util list java util concurrent count down latch countdownlatch java util concurrent time unit timeunit javax websocket client endpoint config clientendpointconfig builder javax websocket container provider containerprovider javax websocket endpoint javax websocket session javax websocket web socket container websocketcontainer org junit org junit test org apache catalina context org apache catalina servlets default servlet defaultservlet org apache catalina startup tomcat org apache tomcat util buf c converter cconverter org apache tomcat websocket tester message count client testermessagecountclient async binary asyncbinary org apache tomcat websocket tester message count client testermessagecountclient async handler asynchandler org apache tomcat websocket tester message count client testermessagecountclient async text asynctext org apache tomcat websocket tester message count client testermessagecountclient tester annotated endpoint testerannotatedendpoint org apache tomcat websocket tester message count client testermessagecountclient tester endpoint testerendpoint org apache tomcat websocket tester message count client testermessagecountclient tester programmatic endpoint testerprogrammaticendpoint test ws remote endpoint testwsremoteendpoint web socket base test websocketbasetest string sequence abc de abcde len sequence length string test message string builder stringbuilder string builder stringbuilder len append sequence test message to string tostring test test writer annotation testwriterannotation exception do test writer dotestwriter tester annotated endpoint testerannotatedendpoint test test writer programmatic testwriterprogrammatic exception do test writer dotestwriter tester programmatic endpoint testerprogrammaticendpoint test test stream annotation teststreamannotation exception do test writer dotestwriter tester annotated endpoint testerannotatedendpoint test test stream programmatic teststreamprogrammatic exception do test writer dotestwriter tester programmatic endpoint testerprogrammaticendpoint do test writer dotestwriter clazz use writer usewriter exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener tester echo server testerechoserver config get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start session ws session wssession uri uri uri localhost get port getport tester echo server testerechoserver config path async endpoint is assignable from isassignablefrom clazz suppress warnings suppresswarnings unchecked endpoint endpoint clazz endpointclazz endpoint clazz ws session wssession ws container wscontainer connect to server connecttoserver endpoint clazz endpointclazz builder create build uri ws session wssession ws container wscontainer connect to server connecttoserver clazz uri count down latch countdownlatch latch count down latch countdownlatch tester endpoint testerendpoint tep tester endpoint testerendpoint ws session wssession get user properties getuserproperties endpoint tep set latch setlatch latch async handler asynchandler handler use writer usewriter handler async text asynctext latch handler async binary asyncbinary latch ws session wssession add message handler addmessagehandler handler use writer usewriter writer ws session wssession get basic remote getbasicremote get send writer getsendwriter write test message close output stream outputstream ws session wssession get basic remote getbasicremote get send stream getsendstream write test message get bytes getbytes c converter cconverter utf close latch result latchresult handler get latch getlatch await time unit timeunit seconds assert true asserttrue latch result latchresult list string array list arraylist string use writer usewriter suppress warnings suppresswarnings unchecked list string messages list string handler get messages getmessages add all addall messages advantage fact message characters represented single utf won split binary messages suppress warnings suppresswarnings unchecked list byte buffer bytebuffer messages list byte buffer bytebuffer handler get messages getmessages byte buffer bytebuffer message messages bytes message limit message bytes add string bytes c converter cconverter utf offset string result fragment assert equals assertequals sequence substring offset len result substring len offset len offset len result length sequence equals result substring len fail len offset result length sequence substring offset equals result substring fail
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina valves java i o exception ioexception java sql connection java sql driver java sql prepared statement preparedstatement java sql sql exception sqlexception java sql timestamp java util properties javax servlet servlet exception servletexception org apache catalina access log accesslog org apache catalina lifecycle exception lifecycleexception org apache catalina lifecycle state lifecyclestate org apache catalina connector request org apache catalina connector response org apache tomcat util exception utils exceptionutils jdbc access log valve jdbcaccesslogvalve valve base valvebase access log accesslog constructor initializes fields values defaults pre driver name drivername connectionurl table name tablename access remote host field remotehostfield remote host remotehost user field userfield user name username timestamp field timestampfield timestamp virtual host field virtualhostfield virtual host virtualhost method field methodfield method query field queryfield query status field statusfield status bytes field bytesfield bytes ref erer field refererfield ref erer referer user agent field useragentfield user agent useragent pattern common resolve hosts resolvehosts pre jdbc access log valve jdbcaccesslogvalve driver name drivername connectionurl table name tablename access remote host field remotehostfield remote host remotehost user field userfield user name username timestamp field timestampfield timestamp virtual host field virtualhostfield virtual host virtualhost method field methodfield method query field queryfield query status field statusfield status bytes field bytesfield bytes ref erer field refererfield ref erer referer user agent field useragentfield user agent useragent pattern common resolve hosts resolvehosts conn current time millis currenttimemillis java util get time gettime instance variables content length contentlength output use long content length uselongcontentlength connection username connect database string connection name connectionname connection url connect database string connection password connectionpassword instance jdbc driver connection factory driver driver string driver name drivername string connectionurl string table name tablename string remote host field remotehostfield string user field userfield string timestamp field timestampfield string virtual host field virtualhostfield string method field methodfield string query field queryfield string status field statusfield string bytes field bytesfield string ref erer field refererfield string user agent field useragentfield string pattern resolve hosts resolvehosts connection conn prepared statement preparedstatement current time millis currenttimemillis set request attributes enabled setrequestattributesenabled request attributes enabled requestattributesenabled descriptive implementation string info org apache catalina valves jdbc access log valve jdbcaccesslogvalve properties inherit doc inheritdoc override set request attributes enabled setrequestattributesenabled request attributes enabled requestattributesenabled request attributes enabled requestattributesenabled request attributes enabled requestattributesenabled inherit doc inheritdoc override get request attributes enabled getrequestattributesenabled request attributes enabled requestattributesenabled username connect database string get connection name getconnectionname connection name connectionname username connect database param connection name connectionname username set connection name setconnectionname string connection name connectionname connection name connectionname connection name connectionname sets database driver param driver name drivername complete database driver set driver name setdrivername string driver name drivername driver name drivername driver name drivername password connect database string get connection password getconnectionpassword connection password connectionpassword password connect database param connection password connectionpassword user password set connection password setconnectionpassword string connection password connectionpassword connection password connectionpassword connection password connectionpassword sets jdbc url database log stored param connectionurl jdbc url database setconnectionurl string connectionurl connectionurl connectionurl sets table logs stored param table name tablename table set table name settablename string table name tablename table name tablename table name tablename sets field remote host param remote host field remotehostfield remote host field set remote host field setremotehostfield string remote host field remotehostfield remote host field remotehostfield remote host field remotehostfield sets field remote user param user field userfield remote user field set user field setuserfield string user field userfield user field userfield user field userfield sets field server determined timestamp param timestamp field timestampfield server determined timestamp field set timestamp field settimestampfield string timestamp field timestampfield timestamp field timestampfield timestamp field timestampfield sets field virtual host fact server param virtual host field virtualhostfield virtual host field set virtual host field setvirtualhostfield string virtual host field virtualhostfield virtual host field virtualhostfield virtual host field virtualhostfield sets field http request method param method field methodfield http request method field set method field setmethodfield string method field methodfield method field methodfield method field methodfield sets field url http query param query field queryfield field url http query set query field setqueryfield string query field queryfield query field queryfield query field queryfield sets field http response status code param status field statusfield http response status code field set status field setstatusfield string status field statusfield status field statusfield status field statusfield sets field number bytes returned param bytes field bytesfield returned bytes field set bytes field setbytesfield string bytes field bytesfield bytes field bytesfield bytes field bytesfield sets field ref erer referer param ref erer field refererfield ref erer referer field set ref erer field setrefererfield string ref erer field refererfield ref erer field refererfield ref erer field refererfield sets field user agent param user agent field useragentfield user agent field set user agent field setuseragentfield string user agent field useragentfield user agent field useragentfield user agent field useragentfield sets logging pattern patterns supported correspond file based common combined translated tab les tables fields flexible field choices param pattern logging pattern set pattern setpattern string pattern pattern pattern determines host resolution param resolve hosts resolvehosts host resolution desired set resolve hosts setresolvehosts string resolve hosts resolvehosts resolve hosts resolvehosts parse boolean parseboolean resolve hosts resolvehosts use long content length uselongcontentlength get use long content length getuselongcontentlength use long content length uselongcontentlength param use long content length uselongcontentlength use long content length uselongcontentlength set use long content length setuselongcontentlength use long content length uselongcontentlength use long content length uselongcontentlength use long content length uselongcontentlength methods method invoked tomcat query param request request object param response response object exception i o exception ioexception thrown exception servlet exception servletexception data base database sql exception sqlexception wrapped servlet exception servletexception override invoke request request response response i o exception ioexception servlet exception servletexception get next getnext invoke request response override log request request response response time get state getstate is available isavailable string empty string remote host remotehost resolve hosts resolvehosts request attributes enabled requestattributesenabled object host request get attribute getattribute remote host attribute host remote host remotehost request get remote host getremotehost remote host remotehost string host remote host remotehost request get remote host getremotehost request attributes enabled requestattributesenabled object add r addr request get attribute getattribute remote addr attribute add r addr remote host remotehost request get remote addr getremoteaddr remote host remotehost string add r addr remote host remotehost request get remote addr getremoteaddr string user request get remote user getremoteuser string query request getrequesturi bytes response get bytes written getbyteswritten bytes bytes status response get status getstatus string virtual host virtualhost empty string method empty string ref erer referer empty string user agent useragent empty string log pattern logpattern pattern log pattern logpattern equals combined virtual host virtualhost request get server name getservername method request get method getmethod ref erer referer request get header getheader ref erer referer user agent useragent request get header getheader user agent number of tries numberoftries number of tries numberoftries open set string setstring remote host remotehost set string setstring user set timestamp settimestamp timestamp get current time millis getcurrenttimemillis set string setstring query set int setint status use long content length uselongcontentlength set long setlong bytes bytes integer max bytes set int setint bytes log pattern logpattern equals combined set string setstring virtual host virtualhost set string setstring method set string setstring ref erer referer set string setstring user agent useragent execute update executeupdate sql exception sqlexception container get logger getlogger error get string getstring jdbc access log valve jdbcaccesslogvalve exception conn close number of tries numberoftries open database connection access log valve accesslogvalve exception sql exception sqlexception database error occurs open sql exception sqlexception database connection open conn instantiate database driver driver clazz for name forname driver name drivername driver driver clazz new instance newinstance throwable exception utils exceptionutils handle throwable handlethrowable sql exception sqlexception get message getmessage open connection properties props properties props auto reconnect autoreconnect connection name connectionname props user connection name connectionname connection password connectionpassword props password connection password connectionpassword conn driver connect connectionurl props conn set auto commit setautocommit string log pattern logpattern pattern log pattern logpattern equals common conn prepare statement preparestatement insert table name tablename remote host field remotehostfield user field userfield timestamp field timestampfield query field queryfield status field statusfield bytes field bytesfield values log pattern logpattern equals combined conn prepare statement preparestatement insert table name tablename remote host field remotehostfield user field userfield timestamp field timestampfield query field queryfield status field statusfield bytes field bytesfield virtual host field virtualhostfield method field methodfield ref erer field refererfield user agent field useragentfield values close database connection close database connection closed conn close prepared statements close throwable exception utils exceptionutils handle throwable handlethrowable close database connection log errors conn close sql exception sqlexception container get logger getlogger error get string getstring jdbc access log valve jdbcaccesslogvalve close conn start component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception open sql exception sqlexception lifecycle exception lifecycleexception set state setstate lifecycle state lifecyclestate starting component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override stop internal stopinternal lifecycle exception lifecycleexception set state setstate lifecycle state lifecyclestate stopping close get current time millis getcurrenttimemillis systime system current time millis currenttimemillis systime current time millis currenttimemillis current time millis currenttimemillis java util systime get time gettime current time millis currenttimemillis
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java beans property change listener propertychangelistener java beans property change support propertychangesupport java i o exception ioexception java unsupported encoding exception unsupportedencodingexception java nio charset charset java security message digest messagedigest java security no such algorithm exception nosuchalgorithmexception java security principal java security cert certificate java util array list arraylist java util arrays java util locale javax servlet http http servlet response httpservletresponse org apache catalina container org apache catalina context org apache catalina engine org apache catalina host org apache catalina lifecycle exception lifecycleexception org apache catalina lifecycle state lifecyclestate org apache catalina realm org apache catalina server org apache catalina service org apache catalina wrapper org apache catalina connector request org apache catalina connector response org apache catalina deploy security collection securitycollection org apache catalina deploy security constraint securityconstraint org apache catalina mbeans m bean utils mbeanutils org apache catalina util lifecycle bean base lifecyclembeanbase org apache catalina util session config sessionconfig org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util buf c converter cconverter org apache tomcat util buf hex utils hexutils org apache tomcat util code c codec binary base org apache tomcat util res string manager stringmanager org apache tomcat util security encoder org ietf jgss gss context gsscontext org ietf jgss gss credential gsscredential org ietf jgss gss exception gssexception org ietf jgss gss name gssname simple implementation realm reads xml file configure valid users passwords roles file format file location identical supported tomcat author craig mc clanahan mcclanahan realm base realmbase lifecycle bean base lifecyclembeanbase realm log log log factory logfactory get log getlog realm base realmbase instance variables container realm container container container log log container log containerlog digest algorithm storing passwords plain text plaintext format valid values accepted algorithm message digest messagedigest code code digesting performed string digest encoding charset digest string digest encoding digestencoding descriptive realm implementation string info org apache catalina realm realm base realmbase message digest messagedigest object digesting user credentials passwords message digest messagedigest helper object deprecated unused removed tomcat deprecated encoder encoder encoder message digest provider message digest messagedigest helper string manager string manager stringmanager string manager stringmanager get manager getmanager constants property change support component property change support propertychangesupport support property change support propertychangesupport validate client certificate chains presented validate retrieving user names certificates string username retriever class name usernameretrieverclassname object extract user names client certificates username retriever usernameretriever username retriever usernameretriever role mode all roles mode allrolesmode all roles mode allrolesmode all roles mode allrolesmode strict mode processing users authenticated gss api quot quot str ipped stripped user str ip realm for gss striprealmforgss transport guarantee redirect status transportguaranteeredirectstatus http servlet response httpservletresponse properties http status code container issue http redirect meet requirements configured transport guarantee get transport guarantee redirect status gettransportguaranteeredirectstatus transport guarantee redirect status transportguaranteeredirectstatus http status code container issue http redirect meet requirements configured transport guarantee param transport guarantee redirect status transportguaranteeredirectstatus status validated set transport guarantee redirect status settransportguaranteeredirectstatus transport guarantee redirect status transportguaranteeredirectstatus transport guarantee redirect status transportguaranteeredirectstatus transport guarantee redirect status transportguaranteeredirectstatus container realm override container get container getcontainer container container realm param container container override set container setcontainer container container container old container oldcontainer container container container support fire property change firepropertychange container old container oldcontainer container roles mode string get all roles mode getallrolesmode all roles mode allrolesmode to string tostring roles mode set all roles mode setallrolesmode string all roles mode allrolesmode all roles mode allrolesmode all roles mode allrolesmode to mode tomode all roles mode allrolesmode digest algorithm storing credentials string get digest getdigest digest digest algorithm storing credentials param digest digest algorithm set digest setdigest string digest digest digest returns digest encoding charset charset platform string get digest encoding getdigestencoding digest encoding digestencoding sets digest encoding charset param charset charset platform set digest encoding setdigestencoding string charset digest encoding digestencoding charset charset get digest charset getdigestcharset unsupported encoding exception unsupportedencodingexception digest encoding digestencoding charset default charset defaultcharset c converter cconverter get charset getcharset get digest encoding getdigestencoding descriptive realm implementation version number format code description version code override string get info getinfo info validate certificate chains flag get validate getvalidate validate validate certificate chains flag param validate validate certificate chains flag set validate setvalidate validate validate validate extract user names client certificates extract user names client certificates string get x getx username retriever class name usernameretrieverclassname username retriever class name usernameretrieverclassname sets extract user names client certificates implement link username retriever usernameretriever param class name classname extract user names client certificates set x setx username retriever class name usernameretrieverclassname string class name classname username retriever class name usernameretrieverclassname class name classname is str ip realm for gss isstriprealmforgss str ip realm for gss striprealmforgss set str ip realm for gss setstriprealmforgss str ip realm for gss striprealmforgss str ip realm for gss striprealmforgss str ip realm for gss striprealmforgss methods add property change listener component param listener listener add override add property change listener addpropertychangelistener property change listener propertychangelistener listener support add property change listener addpropertychangelistener listener principal username code code param username username principal override principal authenticate string username username container log containerlog is trace enabled istraceenabled container log containerlog trace get string getstring realm base realmbase authenticate success authenticatesuccess username get principal getprincipal username principal username credentials code code param username username principal param credentials password credentials auth enticating authenticating username override principal authenticate string username string credentials authenticate don bother username credentials container log containerlog is trace enabled istraceenabled container log containerlog trace get string getstring realm base realmbase authenticate failure authenticatefailure username user credentials string server credentials servercredentials get password getpassword username server credentials servercredentials user w ast e waste bit time reveal user exist compare credentials comparecredentials credentials get class getclass get name getname container log containerlog is trace enabled istraceenabled container log containerlog trace get string getstring realm base realmbase authenticate failure authenticatefailure username validated compare credentials comparecredentials credentials server credentials servercredentials validated container log containerlog is trace enabled istraceenabled container log containerlog trace get string getstring realm base realmbase authenticate success authenticatesuccess username get principal getprincipal username container log containerlog is trace enabled istraceenabled container log containerlog trace get string getstring realm base realmbase authenticate failure authenticatefailure username principal username matches digest calculated parameters method rfc code code param username username principal param client digest clientdigest digest sub mitted submitted client param nonce unique sup pos edly supposedly unique token request param realm realm param digest calculate digest method uri override principal authenticate string username string client digest clientdigest string nonce string string cnonce string qop string realm string digest digests string get digest getdigest username realm to lower case tolowercase locale english string server digest value serverdigestvalue qop server digest value serverdigestvalue nonce server digest value serverdigestvalue nonce cnonce qop value bytes valuebytes value bytes valuebytes server digest value serverdigestvalue get bytes getbytes get digest charset getdigestcharset unsupported encoding exception unsupportedencodingexception uee log error illegal digest encoding digestencoding get digest encoding getdigestencoding uee illegal argument exception illegalargumentexception uee get message getmessage string server digest serverdigest bug zilla bugzilla helper server digest serverdigest encoder encode helper digest value bytes valuebytes log is debug enabled isdebugenabled log debug digest client digest clientdigest username username client sigest clientsigest client digest clientdigest nonce nonce cnonce cnonce qop qop realm realm server digest server digest serverdigest server digest serverdigest equals client digest clientdigest get principal getprincipal username principal chain client certificates code code param certs array client certificates array certificate client override principal authenticate certificate certs certs certs length check val idity validity certificate chain log is debug enabled isdebugenabled log debug auth enticating authenticating client certificate chain validate certs length log is debug enabled isdebugenabled log debug checking val idity validity certs get sub ject n getsubjectdn get name getname certs check validity checkvalidity exception log is debug enabled isdebugenabled log debug validity exception check existence client principal database get principal getprincipal certs inherit doc inheritdoc override principal authenticate gss context gsscontext gss context gsscontext store cred storecred gss context gsscontext is established isestablished gss name gssname gss name gssname gss name gssname gss context gsscontext get src name getsrcname gss exception gssexception log warn get string getstring realm base realmbase gss name fail gssnamefail gss name gssname string gss name gssname to string tostring is str ip realm for gss isstriprealmforgss index of indexof don leave length substring gss credential gsscredential gss credential gsscredential store cred storecred gss context gsscontext get cred deleg state getcreddelegstate gss credential gsscredential gss context gsscontext get deleg cred getdelegcred gss exception gssexception log is debug enabled isdebugenabled log debug get string getstring realm base realmbase delegate d credential fail delegatedcredentialfail get principal getprincipal gss credential gsscredential fail cases compare credentials comparecredentials string user credentials usercredentials string server credentials servercredentials server credentials servercredentials has message digest hasmessagedigest normal hex encoding digest server credentials servercredentials starts with startswith server credentials servercredentials starts with startswith sha server storing digested passwords prefix indicating digest type string server digest serverdigest server credentials servercredentials substring string user digest userdigest reset update user credentials usercredentials get bytes getbytes c converter cconverter iso user digest userdigest base encode base encodebase string digest user digest userdigest equals server digest serverdigest server credentials servercredentials starts with startswith ssha server storing digested passwords prefix indicating digest type salt creating digest string server digest plus salt serverdigestplussalt server credentials servercredentials substring convert salt bytes apply user digested password server digest plus salt bytes serverdigestplussaltbytes base decode base decodebase server digest plus salt serverdigestplussalt salt pos saltpos server digest bytes serverdigestbytes salt pos saltpos system arraycopy server digest plus salt bytes serverdigestplussaltbytes server digest bytes serverdigestbytes salt pos saltpos generate digested form user password salt user digest bytes userdigestbytes reset user password update user credentials usercredentials get bytes getbytes c converter cconverter iso add salt update server digest plus salt bytes serverdigestplussaltbytes salt pos saltpos server digest plus salt bytes serverdigestplussaltbytes length salt pos saltpos user digest bytes userdigestbytes digest arrays equals user digest bytes userdigestbytes server digest bytes serverdigestbytes hex has hes hashes compared ins ensitively insensitively string user digest userdigest digest user credentials usercredentials server credentials servercredentials equals ignore case equalsignorecase user digest userdigest digests compare server credentials servercredentials equals user credentials usercredentials execute per iodic periodic task reloading method invoked class loading classloading context container unexpected throw ables throwables caught log ged logged override background process backgroundprocess noop base security constraints securityconstraints configured guard request uri request code code constraint param request request processing param context context request mapped override security constraint securityconstraint find security constraints findsecurityconstraints request request context context array list arraylist security constraint securityconstraint defined security constraints security constraint securityconstraint constraints context find constraints findconstraints constraints constraints length log is debug enabled isdebugenabled log debug applicable constraints defined check defined security constraint string uri request get request path b getrequestpathmb to string tostring mapper treats prevent npe uri uri string method request get method getmethod constraints length security collection securitycollection collection constraints find collections findcollections bug zilla bugzilla collection log is debug enabled isdebugenabled log debug checking constraint constraints method uri constraints included uri method collection length string patterns collection find patterns findpatterns bug zilla bugzilla patterns patterns length uri equals patterns collection find method findmethod method array list arraylist security constraint securityconstraint add constraints results to array resultstoarray longest constraints length security collection securitycollection collection constraints find collections findcollections bug zilla bugzilla collection log is debug enabled isdebugenabled log debug checking constraint constraints method uri constraints included uri method collection length string patterns collection find patterns findpatterns bug zilla bugzilla patterns matched length patterns length string pattern patterns pattern starts with startswith pattern ends with endswith pattern length longest pattern length matched length pattern length pattern region matches regionmatches uri pattern length pattern length uri length pattern region matches regionmatches uri pattern length matched length pattern length matched length longest clear longest length collection find method findmethod method array list arraylist security constraint securityconstraint add constraints results to array resultstoarray constraints length security collection securitycollection collection constraints find collections findcollections bug zilla bugzilla collection log is debug enabled isdebugenabled log debug checking constraint constraints method uri constraints included uri method matched pos collection length string patterns collection find patterns findpatterns bug zilla bugzilla patterns patterns length matched string pattern patterns pattern starts with startswith slash uri last index of lastindexof dot uri last index of lastindexof slash dot slash dot uri length uri length dot pattern length pattern region matches regionmatches uri dot uri length dot matched pos matched collection pos find method findmethod method array list arraylist security constraint securityconstraint add constraints results to array resultstoarray constraints length security collection securitycollection collection constraints find collections findcollections bug zilla bugzilla collection log is debug enabled isdebugenabled log debug checking constraint constraints method uri constraints included uri method collection length string patterns collection find patterns findpatterns bug zilla bugzilla patterns matched patterns length matched string pattern patterns pattern equals matched matched array list arraylist security constraint securityconstraint add constraints applicable security constraint log is debug enabled isdebugenabled log debug applicable constraint located results to array resultstoarray convert array list arraylist security contraint securitycontraint security constraint securityconstraint results to array resultstoarray array list arraylist security constraint securityconstraint size security constraint securityconstraint array security constraint securityconstraint size to array toarray array array perform access control based authorization constraint code code constraint satisfied processing code code param request request processing param response response creating param constraints security constraint enforcing param context context client attached exception i o exception ioexception input output error occurs override has resource permission hasresourcepermission request request response response security constraint securityconstraint constraints context context i o exception ioexception constraints constraints length user principal authenticated principal principal request get principal getprincipal status denyfromall constraints length security constraint securityconstraint constraint constraints string roles constraint get all roles getallroles roles defined web xml roles request get context getcontext find security roles findsecurityroles roles constraint find auth roles findauthroles roles roles string log is debug enabled isdebugenabled log debug checking roles principal roles length constraint get all roles getallroles constraint get auth constraint getauthconstraint log is debug enabled isdebugenabled log debug roles listed roles access status denyfromall log is debug enabled isdebugenabled log debug passing access status principal log is debug enabled isdebugenabled log debug user authenticated grant access roles length has role hasrole principal roles status log is debug enabled isdebugenabled log debug role roles log is debug enabled isdebugenabled log debug role roles denyfromall all roles mode allrolesmode all roles mode allrolesmode strict mode status principal log is debug enabled isdebugenabled log debug checking roles mode all roles mode allrolesmode check roles role constraints length security constraint securityconstraint constraint constraints string roles roles mode exists sets constraint get all roles getallroles all roles mode allrolesmode all roles mode allrolesmode mode log is debug enabled isdebugenabled log debug granting access role status all roles mode allrolesmode strict mode roles roles request get context getcontext find security roles findsecurityroles roles length all roles mode allrolesmode all roles mode allrolesmode strict mode log is debug enabled isdebugenabled log debug granting access role str ict strict status for bidden forbidden message denying access resource status response send error senderror http servlet response httpservletresponse forbidden get string getstring realm base realmbase for bidden forbidden status code code principal security role context realm code code method overridden realm implementations adequate instance code generic principal genericprincipal code represent authenticated principals realm param principal principal role checked param role security role checked override has role hasrole wrapper wrapper principal principal string role check role alias defined security role element wrapper string real role realrole wrapper find security reference findsecurityreference role real role realrole role real role realrole overridden jaas realm jaasrealm avoid pretty inefficient conversions principal role principal generic principal genericprincipal generic principal genericprincipal generic principal genericprincipal principal result has role hasrole role log is debug enabled isdebugenabled string principal get name getname result log debug get string getstring realm base realmbase has role success hasrolesuccess role log debug get string getstring realm base realmbase has role failure hasrolefailure role result enforce user data constraint required security constraint guarding request uri code code constraint violated processing code code created response param request request processing param response response creating param constraints security constraint checked exception i o exception ioexception input output error occurs override has user data permission hasuserdatapermission request request response response security constraint securityconstraint constraints i o exception ioexception relevant user data constraint constraints constraints length log is debug enabled isdebugenabled log debug applicable security constraint defined constraints length security constraint securityconstraint constraint constraints string user constraint userconstraint constraint get user constraint getuserconstraint user constraint userconstraint log is debug enabled isdebugenabled log debug applicable user data constraint defined user constraint userconstraint equals constants transport log is debug enabled isdebugenabled log debug user data constraint restrictions validate request user data constraint request get request getrequest is secure issecure log is debug enabled isdebugenabled log debug user data constraint satisfied initialize variables determine action redirect port redirectport request get connector getconnector get redirect port getredirectport redirecting disabled redirect port redirectport log is debug enabled isdebugenabled log debug ssl redirect disabled response send error senderror http servlet response httpservletresponse forbidden request getrequesturi redirect ssl port string builder stringbuilder file string builder stringbuilder string protocol https string host request get server name getservername protocol file append protocol append append host host port redirect port redirectport file append append redirect port redirectport uri file append request getrequesturi string requested session id requestedsessionid request get requested session id getrequestedsessionid requested session id requestedsessionid request is requested session id from l isrequestedsessionidfromurl file append file append session config sessionconfig get session uri param name getsessionuriparamname request get context getcontext file append file append requested session id requestedsessionid string query string querystring request get query string getquerystring query string querystring file append file append query string querystring log is debug enabled isdebugenabled log debug red irecting redirecting file to string tostring response send redirect sendredirect file to string tostring transport guarantee redirect status transportguaranteeredirectstatus remove property change listener component param listener listener remove override remove property change listener removepropertychangelistener property change listener propertychangelistener listener support remove property change listener removepropertychangelistener listener override init internal initinternal lifecycle exception lifecycleexception init internal initinternal logger container container log containerlog container get logger getlogger username retriever usernameretriever create username retriever createusernameretriever username retriever class name usernameretrieverclassname prepare active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception create message digest messagedigest instance credentials desired digest message digest messagedigest get instance getinstance digest no such algorithm exception nosuchalgorithmexception lifecycle exception lifecycleexception get string getstring realm base realmbase algorithm digest set state setstate lifecycle state lifecyclestate starting gracefully terminate active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error reported override stop internal stopinternal lifecycle exception lifecycleexception set state setstate lifecycle state lifecyclestate stopping clean all ocated allocated resources string representation component override string to string tostring string builder stringbuilder string builder stringbuilder realm append get name getname append to string tostring methods digest password algorithm convert result hexadecimal string exception plain credentials string returned param credentials password credentials auth enticating authenticating username string digest string credentials message digest messagedigest instance unchanged has message digest hasmessagedigest credentials digest user credentials hexadecimal reset bytes bytes credentials get bytes getbytes get digest charset getdigestcharset unsupported encoding exception unsupportedencodingexception uee log error illegal digest encoding digestencoding get digest encoding getdigestencoding uee illegal argument exception illegalargumentexception uee get message getmessage update bytes hex utils hexutils to hex string tohexstring digest exception log error get string getstring realm base realmbase digest credentials has message digest hasmessagedigest digest principal user string get digest getdigest string username string realm name realmname helper helper message digest messagedigest get instance getinstance no such algorithm exception nosuchalgorithmexception log error could n couldn digest illegal state exception illegalstateexception get message getmessage has message digest hasmessagedigest pre generated digest get password getpassword username string digest value digestvalue username realm name realmname get password getpassword username value bytes valuebytes value bytes valuebytes digest value digestvalue get bytes getbytes get digest charset getdigestcharset unsupported encoding exception unsupportedencodingexception uee log error illegal digest encoding digestencoding get digest encoding getdigestencoding uee illegal argument exception illegalargumentexception uee get message getmessage digest bug zilla bugzilla helper digest helper digest value bytes valuebytes encoder encode digest realm implementation log messages string get name getname password principal user string get password getpassword string username principal certificate principal get principal getprincipal certificate user cert usercert string username username retriever usernameretriever get username getusername user cert usercert log is debug enabled isdebugenabled log debug get string getstring realm base realmbase got x gotx username username get principal getprincipal username principal user principal get principal getprincipal string username principal get principal getprincipal string username gss credential gsscredential gss credential gsscredential principal get principal getprincipal username generic principal genericprincipal generic principal genericprincipal set gss credential setgsscredential gss credential gsscredential server object ultimate parent container realm server container hierarchy complete code code returned server get server getserver container container context get parent getparent host get parent getparent engine service engine get service getservice get server getserver methods digest password algorithm convert result hex string exception plain credentials string returned param credentials password credentials auth enticating authenticating username param algorithm algorithm digest param encoding character encoding string digest string digest string credentials string algorithm string encoding message digest digest encryption message digest messagedigest message digest messagedigest message digest messagedigest get instance getinstance algorithm clone digest encoding digestencoding field encoding update credentials get bytes getbytes update credentials get bytes getbytes encoding digest credentials hexadecimal hex utils hexutils to hex string tohexstring digest exception log error credentials digest password algorithm convert result hex string exception plain credentials string returned main string args string encoding first credential arg firstcredentialarg args length args equals ignore case equalsignorecase encoding args first credential arg firstcredentialarg args length first credential arg firstcredentialarg args equals ignore case equalsignorecase first credential arg firstcredentialarg args length system print args system println digest args args encoding system println usage realm base realmbase algorithm encoding credentials jmx registration override string get object name key properties getobjectnamekeyproperties string builder stringbuilder key properties keyproperties string builder stringbuilder type realm key properties keyproperties append get realm suffix getrealmsuffix key properties keyproperties append m bean utils mbeanutils get container key properties getcontainerkeyproperties container key properties keyproperties to string tostring override string get domain internal getdomaininternal m bean utils mbeanutils get domain getdomain container string realm path realmpath realm string get realm path getrealmpath realm path realmpath set realm path setrealmpath string the realm path therealmpath realm path realmpath the realm path therealmpath string get realm suffix getrealmsuffix realm path realmpath get realm path getrealmpath all roles mode allrolesmode string str ict strict servlet spec int erpretation interpretation requires user web app security role role all roles mode allrolesmode strict mode all roles mode allrolesmode str ict strict authenticated user all roles mode allrolesmode mode all roles mode allrolesmode auth only authonly authenticated user web app security roles all roles mode allrolesmode strict mode all roles mode allrolesmode str ict auth only strictauthonly all roles mode allrolesmode to mode tomode string all roles mode allrolesmode mode equals ignore case equalsignorecase strict mode mode strict mode equals ignore case equalsignorecase mode mode mode equals ignore case equalsignorecase strict mode mode strict mode illegal state exception illegalstateexception unknown mode str ict strict auth only authonly str ict auth only strictauthonly mode all roles mode allrolesmode string override equals object equals all roles mode allrolesmode all roles mode allrolesmode mode all roles mode allrolesmode equals equals mode equals override hash code hashcode hash code hashcode override string to string tostring username retriever usernameretriever create username retriever createusernameretriever string class name classname lifecycle exception lifecycleexception class name classname equals class name classname trim sub ject dn retriever subjectdnretriever suppress warnings suppresswarnings unchecked username retriever usernameretriever clazz username retriever usernameretriever for name forname class name classname clazz new instance newinstance class not found exception classnotfoundexception lifecycle exception lifecycleexception get string getstring realm base realmbase create username retriever createusernameretriever class not found exception classnotfoundexception class name classname instantiation exception instantiationexception lifecycle exception lifecycleexception get string getstring realm base realmbase create username retriever createusernameretriever instantiation exception instantiationexception class name classname illegal access exception illegalaccessexception lifecycle exception lifecycleexception get string getstring realm base realmbase create username retriever createusernameretriever illegal access exception illegalaccessexception class name classname class cast exception classcastexception lifecycle exception lifecycleexception get string getstring realm base realmbase create username retriever createusernameretriever class cast exception classcastexception class name classname
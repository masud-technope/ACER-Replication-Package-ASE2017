licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat jdbc pool int erceptor interceptor java lang reflect constructor java lang reflect invocation handler invocationhandler java lang reflect invocation target exception invocationtargetexception java lang reflect method java lang reflect proxy java sql callable statement callablestatement java sql prepared statement preparedstatement java sql sql exception sqlexception java sql statement org apache juli logging log org apache juli logging log factory logfactory org apache tomcat jdbc pool jdbc interceptor jdbcinterceptor wraps statements int ercepts intercepts query executions author fhanik abstract query report abstractqueryreport abstract create statement interceptor abstractcreatestatementinterceptor logger log log log factory logfactory get log getlog abstract query report abstractqueryreport threshold milliseconds query faster don measure don report queries threshold constructors create statement proxies constructor constructors constructor abstract create statement interceptor abstractcreatestatementinterceptor statement type count abstract query report abstractqueryreport invoked prepare statement preparestatement called completed param sql string prepare statement param time time invoke prepare prepare statement preparestatement string sql time invoked prepare call preparecall called completed param query string prepare statement param time time invoke prepare prepare call preparecall string query time invoked query execution call execute execute query executequery execute batch executebatch failed param query query executed failed param args arguments execution param method execute link abstract create statement interceptor abstractcreatestatementinterceptor is execute isexecute method param start time query execution started param exception happened sql executed string quot batch quot batch execution string report failed query reportfailedquery string query object args string start throwable extract query string string sql query args args length string args query batch execution query batch sql compare execute batch sql batch sql invoked query execution call execute execute query executequery execute batch executebatch succeeded timing threshold param query query executed failed param args arguments execution param method execute link abstract create statement interceptor abstractcreatestatementinterceptor is execute isexecute method param start time query execution started param delta time execution sql executed string quot batch quot batch execution string report query reportquery string query object args string start delta extract query string string sql query args args length string args query batch execution query batch sql compare execute batch sql batch sql invoked query execution call execute execute query executequery execute batch executebatch succeeded exc eeded exceeded timing threshold param query query executed failed param args arguments execution param method execute link abstract create statement interceptor abstractcreatestatementinterceptor is execute isexecute method param start time query execution started param delta time execution sql executed string quot batch quot batch execution string report slow query reportslowquery string query object args string start delta extract query string string sql query args args length string args query batch execution query batch sql compare execute batch sql batch sql returns query measure threshold milliseconds query faster threshold won t wont accounted thr eshhold threshhold milliseconds get threshold getthreshold threshold sets query measurement threshold milliseconds query faster threshold recorded param threshold record query milliseconds set threshold setthreshold threshold threshold threshold creates constructor proxy doesn exist param idx constructor param clazz proxy implement returns constructor create instances no such method exception nosuchmethodexception constructor get constructor getconstructor idx clazz no such method exception nosuchmethodexception constructors idx proxy class proxyclass proxy get proxy class getproxyclass slow query report slowqueryreport get class loader getclassloader clazz constructors idx proxy class proxyclass get constructor getconstructor invocation handler invocationhandler constructors idx creates statement int erceptor interceptor monitor query response times override object create statement createstatement object proxy method method object args object statement time object result string method get name getname string sql constructor constructor compare create statement create statement createstatement constructor get constructor getconstructor create statement idx statement compare prepare statement prepare statement preparestatement sql string args constructor get constructor getconstructor prepare statement idx prepared statement preparedstatement sql prepare statement preparestatement sql time compare prepare call prepare call preparecall sql string args constructor get constructor getconstructor prepare call idx callable statement callablestatement prepare call preparecall sql time bail system statement result constructor new instance newinstance object statement proxy statementproxy statement sql result exception log warn unable create statement proxy slow query report statement measure query execute time author fhanik statement proxy statementproxy invocation handler invocationhandler closed object delegate string query statement proxy statementproxy object parent string query delegate parent query query override object invoke object proxy method method object args throwable method comparison string method get name getname close invoked close compare jdbc interceptor jdbcinterceptor close val close called multiple times close closed calling is closed isclosed compare jdbc interceptor jdbcinterceptor isclosed val value of valueof closed calling bail closed sql exception sqlexception statement closed process check execute query process is execute isexecute method process executing current time start process system current time millis currenttimemillis object result execute query result method invoke delegate args throwable report failed query reportfailedquery query args start invocation target exception invocationtargetexception get cause getcause get cause getcause measure time delta process system current time millis currenttimemillis start min meet requirements measure delta threshold report slow query report slow query reportslowquery query args start delta exception log is warn enabled iswarnenabled log warn unable process slow query process report query reportquery query args start delta perform close cleanup close closed delegate result
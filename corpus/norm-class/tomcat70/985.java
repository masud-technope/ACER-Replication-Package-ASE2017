licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java i o exception ioexception java util concurrent atomic atomic integer atomicinteger javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit org junit test org apache catalina context org apache catalina connector request org apache catalina core standard context standardcontext org apache catalina deploy login config loginconfig org apache catalina filters tester http servlet response testerhttpservletresponse org apache catalina startup test tomcat testtomcat map realm maprealm org apache tomcat util security concurrent message digest concurrentmessagedigest org apache tomcat util security encoder tester digest authenticator performance testerdigestauthenticatorperformance string user user string pwd pwd string role role string method string uri string context path foo string client header authorization string realm test realm testrealm string qop atomic integer atomicinteger nonce count noncecount atomic integer atomicinteger digest authenticator digestauthenticator authenticator digest authenticator digestauthenticator test test simple testsimple exception do test dotest do test dotest thread count threadcount request count requestcount exception tester runnable testerrunnable run nables runnables tester runnable testerrunnable thread count threadcount thread threads thread thread count threadcount string nonce authenticator generate non ce generatenonce tester digest request testerdigestrequest create run nables runnables threads thread count threadcount run nables runnables tester runnable testerrunnable authenticator nonce request count requestcount threads thread run nables runnables start system current time millis currenttimemillis start threads thread count threadcount threads start wait threads finish thread count threadcount threads join wall time walltime system current time millis currenttimemillis start gather total time totaltime total success totalsuccess thread count threadcount system println thread success run nables runnables get success getsuccess total success totalsuccess total success totalsuccess run nables runnables get success getsuccess total time totaltime total time totaltime run nables runnables get time gettime system println average time request user total time totaltime thread count threadcount request count requestcount system println average time request wall wall time walltime thread count threadcount request count requestcount assert equals assertequals request count requestcount thread count threadcount total success totalsuccess set up setup exception concurrent message digest concurrentmessagedigest init configure realm map realm maprealm realm map realm maprealm realm add user adduser user pwd realm add user role adduserrole user role add realm context context context standard context standardcontext context set name setname context path context set realm setrealm realm context realm visible authenticator authenticator set container setcontainer context authenticator set non ce count window size setnoncecountwindowsize authenticator start tester runnable testerrunnable runnable string nonce request count requestcount success time tester digest request testerdigestrequest request http servlet response httpservletresponse response login config loginconfig config digest authenticator digestauthenticator authenticator string user realm pwd string method context path uri string encoder encode concurrent message digest concurrentmessagedigest digest get bytes getbytes string encoder encode concurrent message digest concurrentmessagedigest digest get bytes getbytes init code quick tester runnable testerrunnable digest authenticator digestauthenticator authenticator string nonce request count requestcount exception authenticator authenticator nonce nonce request count requestcount request count requestcount request tester digest request testerdigestrequest response tester http servlet response testerhttpservletresponse config login config loginconfig config set realm name setrealmname realm override start system current time millis currenttimemillis request count requestcount request set auth header setauthheader build digest response builddigestresponse nonce authenticator authenticate request response success clear authenticated user ready iteration request set user principal setuserprincipal i o exception ioexception ioe time system current time millis currenttimemillis start get success getsuccess success get time gettime time string build digest response builddigestresponse string nonce string nc string ncstring string format integer value of valueof nonce count noncecount increment and get incrementandget string cnonce cnonce string response nonce nc string ncstring cnonce qop string response encoder encode concurrent message digest concurrentmessagedigest digest response get bytes getbytes string builder stringbuilder string builder stringbuilder append digest username append user append realm append realm append nonce append nonce append uri append context path uri append opaque append authenticator get opaque getopaque append response append response append append qop append qop append append nc string ncstring append cnonce append cnonce append to string tostring tester digest request testerdigestrequest request string auth header authheader override string get remote addr getremoteaddr set auth header setauthheader string auth header authheader auth header authheader auth header authheader override string get header getheader string client header equals ignore case equalsignorecase auth header authheader get header getheader override string get method getmethod method override string get query string getquerystring override string getrequesturi context path uri override org apache coyote request get coyote request getcoyoterequest org apache coyote request
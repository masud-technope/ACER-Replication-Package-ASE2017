licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina util java io exception ioexception java input stream inputstream java util locale java util properties org apache tomcat util exception utils exceptionutils utility attempts map locale character int erpreting interpreting input text generating output text content type header include customize behavior modifying mapping data loads sub cla ssi ng subclassing change algorithm version web application author craig mc clanahan mcclanahan charset mapper charsetmapper manifest constants properties resource string resource org apache catalina util charset mapper default charsetmapperdefault properties construct charset mapper charsetmapper properties resource charset mapper charsetmapper resource construct charset mapper charsetmapper properties resource param properties resource loaded exception illegal argument exception illegalargumentexception properties resource loaded reason charset mapper charsetmapper string input stream inputstream stream stream get class getclass get resource as stream getresourceasstream map load stream throwable exception utils exceptionutils handle throwable handlethrowable illegal argument exception illegalargumentexception to string tostring stream stream close io exception ioexception instance variables mapping properties initialized properties resource properties map properties methods calculate character assumed locale absence character content type header param locale locale calculate character string get charset getcharset locale locale match full language country variant language country language string charset map get property getproperty locale to string tostring charset charset map get property getproperty locale get language getlanguage locale get country getcountry charset charset map get property getproperty locale get language getlanguage charset deployment descriptor locale encoding mapping list element describes webapp desired mapping locale charset method called processing web xml file context param locale locale character param charset charset locale add charset mapping from deployment descriptor addcharsetmappingfromdeploymentdescriptor string locale string charset map locale charset
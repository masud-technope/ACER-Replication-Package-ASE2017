licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat websocket pojo java net uri java util concurrent count down latch countdownlatch java util concurrent time unit timeunit javax websocket client endpoint clientendpoint javax websocket container provider containerprovider javax websocket endpoint config endpointconfig javax websocket on close onclose javax websocket on error onerror javax websocket on open onopen javax websocket session javax websocket web socket container websocketcontainer javax websocket server server endpoint serverendpoint org junit org junit test org apache catalina context org apache catalina servlets default servlet defaultservlet org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat websocket test util testutil org apache tomcat websocket pojo tester util testerutil server config listener serverconfiglistener org apache tomcat websocket pojo tester util testerutil singleton configurator singletonconfigurator test pojo endpoint base testpojoendpointbase tomcat base test tomcatbasetest test test bug testbug exception test util testutil generate mask generatemask utility classes bug server bug singleton configurator singletonconfigurator set instance setinstance server server config listener serverconfiglistener set pojo clazz setpojoclazz bug tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener server config listener serverconfiglistener get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start client client client uri uri uri localhost get port getport ws container wscontainer connect to server connecttoserver client uri server close connection exception open closed client wait for close waitforclose assert true asserttrue server failed close connection closed test test on open pojo method testonopenpojomethod exception utility classes on open server endpoint onopenserverendpoint server on open server endpoint onopenserverendpoint singleton configurator singletonconfigurator set instance setinstance server server config listener serverconfiglistener set pojo clazz setpojoclazz on open server endpoint onopenserverendpoint tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener server config listener serverconfiglistener get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start client client client uri uri uri localhost get port getport session session ws container wscontainer connect to server connecttoserver client uri client wait for close waitforclose assert true asserttrue session is open isopen server endpoint serverendpoint on open server endpoint onopenserverendpoint on open onopen on open onopen suppress warnings suppresswarnings unused session session endpoint config endpointconfig config config runtime exception runtimeexception on error onerror on error onerror suppress warnings suppresswarnings unused throwable runtime exception runtimeexception server endpoint serverendpoint bug on open onopen on open onopen runtime exception runtimeexception client endpoint clientendpoint client count down latch countdownlatch close latch closelatch count down latch countdownlatch on close onclose on close onclose close latch closelatch count down countdown wait for close waitforclose seconds interrupted exception interruptedexception close latch closelatch await seconds time unit timeunit seconds
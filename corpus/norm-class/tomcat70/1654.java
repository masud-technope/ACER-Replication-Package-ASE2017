licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java security principal java security cert certificate java util linked hash map linkedhashmap java util map java util concurrent atomic atomic integer atomicinteger org apache catalina lifecycle exception lifecycleexception org apache juli logging log org apache juli logging log factory logfactory org ietf jgss gss context gsscontext org ietf jgss gss exception gssexception org ietf jgss gss name gssname combined realm combinedrealm wrap real ms realms provide user lock mechanism failed authentication attempts period time ensure correct operation reason able reasonable degree synch ronisation synchronisation realm realm require modification underlying real ms realms user storage mechanisms achieves recording failed log ins logins including users exist prevent dos del iberating deliberating making requests invalid users causing cache grow size list users failed authentication limited lock out realm lockoutrealm combined realm combinedrealm log log log factory logfactory get log getlog lock out realm lockoutrealm descriptive realm implementation string lock out realm lockoutrealm number times row user fail authentication locked defaults failure count failurecount time seconds user locked authentication failures defaults min utes minutes lock out time lockouttime number users failed authentication cache time cache grow size shrink defaults cache size cachesize failed user removed cache cache big cache period time seconds warning message log ged logged defaults hour cache removal warning time cacheremovalwarningtime use rs users authentication attempt failed entries ordered access order map string lock record lockrecord failed use rs failedusers prepare active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception configure list failed users delete oldest entry exc eeds exceeds size failed use rs failedusers linked hash map linkedhashmap string lock record lockrecord cache size cachesize serialversionuid override remove eldest entry removeeldestentry map entry string lock record lockrecord eldest size cache size cachesize check element removed time in cache timeincache system current time millis currenttimemillis eldest get value getvalue get last failure time getlastfailuretime time in cache timeincache cache removal warning time cacheremovalwarningtime log warn get string getstring lock out realm lockoutrealm remove warning removewarning eldest get key getkey value of valueof time in cache timeincache start internal startinternal principal username matches digest calculated parameters method rfc code code param username username principal param client digest clientdigest digest sub mitted submitted client param non ce nonce unique sup pos edly supposedly unique token request param realm name realmname realm param digest calculate digest method uri override principal authenticate string username string client digest clientdigest string non ce nonce string string cnonce string qop string realm name realmname string principal authenticated user authenticateduser authenticate username client digest clientdigest non ce nonce cnonce qop realm name realmname filter locked acc ounts filterlockedaccounts username authenticated user authenticateduser principal username credentials code code param username username principal param credentials password credentials auth enticating authenticating username override principal authenticate string username string credentials principal authenticated user authenticateduser authenticate username credentials filter locked acc ounts filterlockedaccounts username authenticated user authenticateduser principal chain client certificates code code param certs array client certificates array certificate client override principal authenticate certificate certs string username certs certs length username certs get sub ject n getsubjectdn get name getname principal authenticated user authenticateduser authenticate certs filter locked acc ounts filterlockedaccounts username authenticated user authenticateduser inherit doc inheritdoc override principal authenticate gss context gsscontext gss context gsscontext store creds storecreds gss context gsscontext is established isestablished string username gss name gssname gss context gsscontext get src name getsrcname gss exception gssexception log warn get string getstring realm base realmbase gss name fail gssnamefail username to string tostring principal authenticated user authenticateduser authenticate gss context gsscontext store creds storecreds filter locked acc ounts filterlockedaccounts username authenticated user authenticateduser fail cases filters authenticated principals ensure code code returned user locked principal filter locked acc ounts filterlockedaccounts string username principal authenticated user authenticateduser register failed auth entications authentications authenticated user authenticateduser register auth failure registerauthfailure username is locked islocked username user locked authentication fail log warn get string getstring lock out realm lockoutrealm auth locked user authlockeduser username authenticated user authenticateduser register auth success registerauthsuccess username authenticated user authenticateduser unlock username remove records authentication failures user param username user unlock unlock string username success clears lock record register auth success registerauthsuccess username checks current user locked login attempt access time recorded attempt authenticated locked user log warning is locked islocked string username lock record lockrecord lock record lockrecord lock record lockrecord failed use rs failedusers username lock record user locked lock record lockrecord check user locked lock record lockrecord get failures getfailures failure count failurecount system current time millis currenttimemillis lock record lockrecord get last failure time getlastfailuretime lock out time lockouttime user exc eeded exceeded lock thr esholds thresholds successful authentication record previous authentication failure removed register auth success registerauthsuccess string username successful authentication removal list failed users failed use rs failedusers remove username failed authentication add record failed authentication register auth failure registerauthfailure string username lock record lockrecord lock record lockrecord failed use rs failedusers contains key containskey username lock record lockrecord lock record lockrecord failed use rs failedusers username lock record lockrecord lock record lockrecord failed use rs failedusers username lock record lockrecord get failures getfailures failure count failurecount system current time millis currenttimemillis lock record lockrecord get last failure time getlastfailuretime lock out time lockouttime user locked lock out lockout expired reset failure count lock record lockrecord set failures setfailures lock record lockrecord register failure registerfailure number failed authentication attempts required lock user account failure count failurecount get failure count getfailurecount failure count failurecount number failed authentication attempts required lock user account param failure count failurecount failure count failurecount set failure count setfailurecount failure count failurecount failure count failurecount failure count failurecount period account locked lock out time lockouttime get lock out time getlockouttime lock out time lockouttime override string get name getname period account locked param lock out time lockouttime lock out time lockouttime set lock out time setlockouttime lock out time lockouttime lock out time lockouttime lock out time lockouttime maximum number users authentication failure cache cache size cachesize get cache size getcachesize cache size cachesize maximum number users authentication failure cache param cache size cachesize cache size cachesize set cache size setcachesize cache size cachesize cache size cachesize cache size cachesize minimum period failed authentication remain cache avoid generating warning removed cache space entry cache removal warning time cacheremovalwarningtime get cache removal warning time getcacheremovalwarningtime cache removal warning time cacheremovalwarningtime minimum period failed authentication remain cache avoid generating warning removed cache space entry param cache removal warning time cacheremovalwarningtime cache removal warning time cacheremovalwarningtime set cache removal warning time setcacheremovalwarningtime cache removal warning time cacheremovalwarningtime cache removal warning time cacheremovalwarningtime cache removal warning time cacheremovalwarningtime lock record lockrecord atomic integer atomicinteger failures atomic integer atomicinteger last failure time lastfailuretime get failures getfailures failures set failures setfailures the failures thefailures failures the failures thefailures get last failure time getlastfailuretime last failure time lastfailuretime register failure registerfailure failures increment and get incrementandget last failure time lastfailuretime system current time millis currenttimemillis
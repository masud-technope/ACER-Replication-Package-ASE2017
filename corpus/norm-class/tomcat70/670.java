licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache jasper servlet java io exception ioexception java input stream inputstream java net url java net url class loader urlclassloader java security code source codesource java security permission collection permissioncollection org apache jasper constants loader loading servlet files jsp files tag handler files tag files author anil vijendran author harish prabandham author jean francois arcand jasper loader jasperloader url class loader urlclassloader permission collection permissioncollection permission collection permissioncollection class loader classloader parent security manager securitymanager security manager securitymanager jasper loader jasperloader url urls class loader classloader parent permission collection permissioncollection permission collection permissioncollection urls parent permission collection permissioncollection permission collection permissioncollection parent parent security manager securitymanager system get security manager getsecuritymanager load method searches classes manner code load class loadclass string code code code argument param loaded exception class not found exception classnotfoundexception override load class loadclass string class not found exception classnotfoundexception load class loadclass load searching algorithm finds returns returns code class not found exception classnotfoundexception code call code find loaded class findloadedclass string code check loaded code code object returned code delegate code property code code call code load class loadclass code method parent loader call code find class findclass code find locally defined repositories call code load class loadclass code method parent loader steps code resolve code flag code code method call code resolve class resolveclass code object param loaded param resolve code code resolve exception class not found exception classnotfoundexception override load class loadclass string resolve class not found exception classnotfoundexception clazz check loaded cache clazz find loaded class findloadedclass clazz resolve resolve class resolveclass clazz clazz permission access security manager securitymanager security manager securitymanager dot last index of lastindexof dot call security manager grant org apache jasper runtime equals ignore case equalsignorecase substring dot security manager securitymanager check package access checkpackageaccess substring dot security exception securityexception string error security violation attempt restricted print stack trace printstacktrace class not found exception classnotfoundexception error starts with startswith constants jsp org apache jsp parent load clazz parent load class loadclass resolve resolve class resolveclass clazz clazz find class findclass delegate parent java lang class loader classloader get resource as stream getresourceasstream java lang string override input stream inputstream get resource as stream getresourceasstream string input stream inputstream parent get resource as stream getresourceasstream url url find resource findresource url url open stream openstream io exception ioexception per missions permissions code source codesource class loader classloader jsp web application context preset permission collection permissioncollection web app context param code source codesource code source code loaded permission collection permissioncollection code source codesource override permission collection permissioncollection get per missions getpermissions code source codesource code source codesource permission collection permissioncollection
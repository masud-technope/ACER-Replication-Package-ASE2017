licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina session java buffered input stream bufferedinputstream java buffered output stream bufferedoutputstream java file java file input stream fileinputstream java file not found exception filenotfoundexception java file output stream fileoutputstream java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream java security access controller accesscontroller java security privileged action exception privilegedactionexception java security privileged exception action privilegedexceptionaction java util array list arraylist java util iterator javax servlet servlet context servletcontext org apache catalina context org apache catalina lifecycle exception lifecycleexception org apache catalina lifecycle state lifecyclestate org apache catalina loader org apache catalina session org apache catalina security security util securityutil org apache catalina util custom object input stream customobjectinputstream org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils standard implementation manager simple session persistence res tarts restarts component entire server shut res tarted restarted web application reloaded implementation note correct behavior session storing reloading depends external calls code start code code code methods correct times author craig mc clanahan mcclanahan author jean francois arcand standard manager standardmanager manager base managerbase log log log factory logfactory get log getlog standard manager standardmanager privileged do load privilegeddoload privileged exception action privilegedexceptionaction privileged do load privilegeddoload noop override exception do load doload privileged do unload privilegeddounload privileged exception action privilegedexceptionaction privileged do unload privilegeddounload noop override exception do unload dounload instance variables descriptive implementation string info standard manager standardmanager descriptive manager implementation logging string standard manager standardmanager path disk file active sessions saved sessions loaded start code code persistence desired pathname relative resolved temporary working directory context code javax servlet context temp dir tempdir code context attribute string pathname sessions ser properties override string get info getinfo info override string get name getname session persistence pathname string get path name getpathname pathname session persistence pathname persistence support desired pathname code code param pathname session persistence pathname set path name setpathname string pathname string old path name oldpathname pathname pathname pathname support fire property change firepropertychange pathname old path name oldpathname pathname methods override load class not found exception classnotfoundexception io exception ioexception security util securityutil is package protection enabled ispackageprotectionenabled access controller accesscontroller do privileged doprivileged privileged do load privilegeddoload privileged action exception privilegedactionexception exception exception get exception getexception exception class not found exception classnotfoundexception class not found exception classnotfoundexception exception exception io exception ioexception io exception ioexception exception log is debug enabled isdebugenabled log debug unreported exception load exception do load doload load active sessions unloaded persistence mechanism persistence supported method returns exception class not found exception classnotfoundexception serialized reload exception io exception ioexception input output error occurs do load doload class not found exception classnotfoundexception io exception ioexception log is debug enabled isdebugenabled log debug start loading persisted sessions initialize internal data str uctures structures sessions clear open input stream pathname file file file file log is debug enabled isdebugenabled log debug get string getstring standard manager standardmanager loading pathname file input stream fileinputstream fis buffered input stream bufferedinputstream bis object input stream objectinputstream ois loader loader class loader classloader class loader classloader log logger fis file input stream fileinputstream file get absolute path getabsolutepath bis buffered input stream bufferedinputstream fis loader container get loader getloader logger container get logger getlogger loader class loader classloader loader get class loader getclassloader class loader classloader class loader classloader get class getclass get class loader getclassloader ois custom object input stream customobjectinputstream bis class loader classloader logger get session attribute value class name pattern getsessionattributevalueclassnamepattern get warn on session attribute filter failure getwarnonsessionattributefilterfailure file not found exception filenotfoundexception log is debug enabled isdebugenabled log debug persisted data file io exception ioexception log error get string getstring standard manager standardmanager loading ioe fis fis close io exception ioexception bis bis close io exception ioexception load unloaded active sessions sessions integer count integer ois read object readobject count int value intvalue log is debug enabled isdebugenabled log debug loading persisted sessions standard session standardsession session get new session getnewsession session read object data readobjectdata ois session set manager setmanager sessions session get id internal getidinternal session session activate session is valid internal isvalidinternal session invalid expire session prevent memory leak session set valid setvalid session expire session counter sessioncounter class not found exception classnotfoundexception log error get string getstring standard manager standardmanager loading cnfe ois close io exception ioexception io exception ioexception log error get string getstring standard manager standardmanager loading ioe ois close io exception ioexception close input stream ois close io exception ioexception delete persistent storage file file exists file delete log is debug enabled isdebugenabled log debug finish loading persisted sessions override unload io exception ioexception security util securityutil is package protection enabled ispackageprotectionenabled access controller accesscontroller do privileged doprivileged privileged do unload privilegeddounload privileged action exception privilegedactionexception exception exception get exception getexception exception io exception ioexception io exception ioexception exception log is debug enabled isdebugenabled log debug unreported exception un load unload exception do unload dounload save active sessions persistence mechanism persistence supported method returns exception io exception ioexception input output error occurs do unload dounload io exception ioexception log is debug enabled isdebugenabled log debug get string getstring standard manager standardmanager unloading debug sessions is empty isempty log debug get string getstring standard manager standardmanager unloading nosessions open output stream pathname file file file file log is debug enabled isdebugenabled log debug get string getstring standard manager standardmanager unloading pathname file output stream fileoutputstream fos buffered output stream bufferedoutputstream bos object output stream objectoutputstream oos error fos file output stream fileoutputstream file get absolute path getabsolutepath bos buffered output stream bufferedoutputstream fos oos object output stream objectoutputstream bos io exception ioexception error log error get string getstring standard manager standardmanager unloading ioe error oos oos close io exception ioexception ioe bos bos close io exception ioexception ioe fos fos close io exception ioexception ioe write number active sessions details array list arraylist standard session standardsession list array list arraylist standard session standardsession sessions log is debug enabled isdebugenabled log debug unloading sessions size sessions oos write object writeobject integer value of valueof sessions size iterator session elements sessions values iterator elements has next hasnext standard session standardsession session standard session standardsession elements list add session session pass ivate passivate session write object data writeobjectdata oos io exception ioexception log error get string getstring standard manager standardmanager unloading ioe oos close io exception ioexception flush close output stream oos flush oos close io exception ioexception expire sessions wrote log is debug enabled isdebugenabled log debug exp iring expiring list size persisted sessions iterator standard session standardsession expires list iterator expires has next hasnext standard session standardsession session expires session expire throwable exception utils exceptionutils handle throwable handlethrowable session recycle log is debug enabled isdebugenabled log debug unloading complete start component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception start internal startinternal load unloaded sessions load throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring standard manager standardmanager manager load managerload set state setstate lifecycle state lifecyclestate starting component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override stop internal stopinternal lifecycle exception lifecycleexception log is debug enabled isdebugenabled log debug stopping set state setstate lifecycle state lifecyclestate stopping write sessions unload throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring standard manager standardmanager manager unload managerunload expire active sessions session sessions find sessions findsessions sessions length session session sessions session is valid isvalid session expire throwable exception utils exceptionutils handle throwable handlethrowable measure memory leaking references session object shared field session recycle require random number generator res tarted restarted stop internal stopinternal methods file object representing pathname persistence file file file pathname pathname length file file file pathname file is absolute isabsolute servlet context servletcontext servlet context servletcontext context container get servlet context getservletcontext file temp dir tempdir file servlet context servletcontext get attribute getattribute servlet context servletcontext temp dir tempdir temp dir tempdir file file temp dir tempdir pathname file
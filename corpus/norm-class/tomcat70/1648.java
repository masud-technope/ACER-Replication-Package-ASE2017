licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina deploy java util hash set hashset java util javax servlet http constraint element httpconstraintelement javax servlet http method constraint element httpmethodconstraintelement javax servlet servlet security element servletsecurityelement javax servlet annotation servlet security servletsecurity javax servlet annotation servlet security servletsecurity empty role semantic emptyrolesemantic org junit assert equals assertequals org junit assert false assertfalse org junit assert true asserttrue org junit fail org junit test test security constraint testsecurityconstraint string url pattern test string role examples srv basis tests test test create constraints testcreateconstraints servlet security element servletsecurityelement element security constraint securityconstraint result http method constraint element httpmethodconstraintelement hmces hash set hashset http method constraint element httpmethodconstraintelement servlet security servletsecurity element servlet security element servletsecurityelement result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length servlet security servletsecurity http constraint httpconstraint transport guarantee transportguarantee transport guarantee transportguarantee confidential element servlet security element servletsecurityelement http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee confidential result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert false assertfalse result get auth constraint getauthconstraint assert true asserttrue result find collections findcollections find pattern findpattern url pattern assert equals assertequals result find collections findcollections find methods findmethods length assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee confidential result get user constraint getuserconstraint servlet security servletsecurity http constraint httpconstraint empty role semantic emptyrolesemantic deny element servlet security element servletsecurityelement http constraint element httpconstraintelement empty role semantic emptyrolesemantic deny result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert true asserttrue result get auth constraint getauthconstraint assert true asserttrue result find collections findcollections find pattern findpattern url pattern assert equals assertequals result find collections findcollections find methods findmethods length assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee result get user constraint getuserconstraint servlet security servletsecurity http constraint httpconstraint roles allowed rolesallowed element servlet security element servletsecurityelement http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee role result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert true asserttrue result get auth constraint getauthconstraint assert equals assertequals result find auth roles findauthroles length assert true asserttrue result find auth role findauthrole role assert true asserttrue result find collections findcollections find pattern findpattern url pattern assert equals assertequals result find collections findcollections find methods findmethods length assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee result get user constraint getuserconstraint servlet security servletsecurity http method constraints httpmethodconstraints http method constraint httpmethodconstraint roles allowed rolesallowed http method constraint httpmethodconstraint post roles allowed rolesallowed transport guarantee transportguarantee transport guarantee transportguarantee confidential hmces clear hmces add http method constraint element httpmethodconstraintelement http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee role hmces add http method constraint element httpmethodconstraintelement post http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee confidential role element servlet security element servletsecurityelement hmces result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert true asserttrue result get auth constraint getauthconstraint assert equals assertequals result find auth roles findauthroles length assert true asserttrue result find auth role findauthrole role assert true asserttrue result find collections findcollections find pattern findpattern url pattern assert equals assertequals result find collections findcollections find methods findmethods length string method result find collections findcollections find methods findmethods equals method assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee result get user constraint getuserconstraint post equals method assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee confidential result get user constraint getuserconstraint fail unexpected method method servlet security servletsecurity http constraint httpconstraint roles allowed rolesallowed http method constraints httpmethodconstraints http method constraint httpmethodconstraint hmces clear hmces add http method constraint element httpmethodconstraintelement element servlet security element servletsecurityelement http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee role hmces result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert true asserttrue result find collections findcollections find pattern findpattern url pattern result find collections findcollections find methods findmethods length assert equals assertequals result find collections findcollections find methods findmethods assert false assertfalse result get auth constraint getauthconstraint result find collections findcollections find omitted methods findomittedmethods length assert equals assertequals result find collections findcollections find omitted methods findomittedmethods assert true asserttrue result get auth constraint getauthconstraint assert equals assertequals result find auth roles findauthroles length assert equals assertequals role result find auth roles findauthroles fail unexpected number methods defined assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee result get user constraint getuserconstraint servlet security servletsecurity http constraint httpconstraint roles allowed rolesallowed http method constraints httpmethodconstraints http method constraint httpmethodconstraint trace empty role semantic emptyrolesemantic empty role semantic emptyrolesemantic deny hmces clear hmces add http method constraint element httpmethodconstraintelement trace http constraint element httpconstraintelement empty role semantic emptyrolesemantic deny element servlet security element servletsecurityelement http constraint element httpconstraintelement servlet security servletsecurity transport guarantee transportguarantee role hmces result security constraint securityconstraint create constraints createconstraints element url pattern assert equals assertequals result length assert true asserttrue result find collections findcollections find pattern findpattern url pattern result find collections findcollections find methods findmethods length assert equals assertequals trace result find collections findcollections find methods findmethods assert true asserttrue result get auth constraint getauthconstraint assert equals assertequals result find auth roles findauthroles length result find collections findcollections find omitted methods findomittedmethods length assert equals assertequals trace result find collections findcollections find omitted methods findomittedmethods assert true asserttrue result get auth constraint getauthconstraint assert equals assertequals result find auth roles findauthroles length assert equals assertequals role result find auth roles findauthroles fail unexpected number methods defined assert equals assertequals servlet security servletsecurity transport guarantee transportguarantee result get user constraint getuserconstraint
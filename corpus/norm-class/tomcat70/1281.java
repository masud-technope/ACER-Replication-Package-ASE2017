licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream java serializable java security principal java util java util concurrent concurrent hash map concurrenthashmap java util concurrent concurrent map concurrentmap javax servlet http http servlet request httpservletrequest org apache catalina session represents entries cache authenticated users code authenticator base authenticatorbase code subclasses order perform reauthentications single sign on singlesignon author stansberry based work craig mc clanahan mcclanahan single sign on singlesignon authenticator base authenticatorbase reauthenticatefromsso single sign on entry singlesignonentry serializable serialversionuid instance fields string auth type authtype string password marked special handling applied serialization principal principal concurrent map concurrentmap single sign on session key singlesignonsessionkey single sign on session key singlesignonsessionkey session keys sessionkeys concurrent hash map concurrenthashmap single sign on session key singlesignonsessionkey single sign on session key singlesignonsessionkey string username can reauthenticate canreauthenticate creates single sign on entry singlesignonentry param principal code principal code returned latest call code realm authenticate code param auth type authtype type authenticator basic client cert digest form param username username authentication param password password authentication single sign on entry singlesignonentry principal principal string auth type authtype string username string password update credentials updatecredentials principal auth type authtype username password methods adds code session code list sso param sso code single sign on singlesignon code valve managing sso session param session code session code sso add session addsession single sign on singlesignon sso string sso id ssoid session session single sign on session key singlesignonsessionkey key single sign on session key singlesignonsessionkey session single sign on session key singlesignonsessionkey current key currentkey session keys sessionkeys put if absent putifabsent key key current key currentkey session session add session listener addsessionlistener sso get session listener getsessionlistener sso id ssoid removes code session code list sso param session code session code remove remove session removesession session session single sign on session key singlesignonsessionkey key single sign on session key singlesignonsessionkey session session keys sessionkeys remove key returns http session identifiers sso identifiers http sessions current ss o sso entry single sign on session key singlesignonsessionkey find sessions findsessions session keys sessionkeys key set keyset authentication type originally authenticate user sso basic client cert digest form string get auth type getauthtype auth type authtype authentication type original authentication supports reauthentication code code code get auth type getauthtype code returns basic form code code get can reauthenticate getcanreauthenticate can reauthenticate canreauthenticate password credential sso password credential sso code code original authentication type involve password string get password getpassword password code principal code authenticated sso principal created authentication triggered creation sso entry principal get principal getprincipal principal user user authentication process user authenticated authentication triggered creation sso entry string get username getusername username updates single sign on entry singlesignonentry reflect latest security caller param principal code principal code returned latest call code realm authenticate code param auth type authtype type authenticator basic client cert digest form param username username authentication param password password authentication update credentials updatecredentials principal principal string auth type authtype string username string password principal principal auth type authtype auth type authtype username username password password can reauthenticate canreauthenticate http servlet request httpservletrequest basic equals auth type authtype http servlet request httpservletrequest form equals auth type authtype write object writeobject object output stream objectoutputstream io exception ioexception default write object defaultwriteobject principal serializable write boolean writeboolean write object writeobject principal write boolean writeboolean read object readobject object input stream objectinputstream io exception ioexception class not found exception classnotfoundexception default read object defaultreadobject has principal hasprincipal read boolean readboolean has principal hasprincipal principal principal read object readobject
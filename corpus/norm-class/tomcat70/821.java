licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina valves java i o exception ioexception java string reader stringreader java unsupported encoding exception unsupportedencodingexception java net inet address inetaddress java net url encoder urlencoder java text simple date format simpledateformat java util array list arraylist java util java util iterator java util list java util locale java util time zone timezone javax servlet http cookie javax servlet http http session httpsession org apache catalina connector request org apache catalina connector response org apache catalina util server info serverinfo org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils implementation extended log file format http org log file logfile html format fields supported code dns code client host name hostname add ress address code enable look ups enablelookups code connector code code client add ress address code bytes code bytes served code method code request method code uri code full uri requested code uri query code query string code uri stem code uri query string code code yyyy format gmt code dns code server dns entry code code server add ress address code xxx code header xxx client server code xxx code header xxx server client code status code status code code time code time request served code time code time seconds serve request code thread name threadname code current request thread compare stack tra ces stacktraces code xxx code pull xxx attribute servlet context code xxx code pull cookie xxx code xxx code pull response header values xxx code xxx code pull xxx attribute servlet request code xxx code pull xxx attribute session code code call request get parameter getparameter url encode urlencode helpful capture post parameters method called http servlet request httpservletrequest object code auth type authtype code get auth type getauthtype code character encoding characterencoding code get character encoding getcharacterencoding code content length contentlength code get content length getcontentlength code locale code get locale getlocale code protocol code get protocol getprotocol code remote user remoteuser code get remote user getremoteuser code requested session id requestedsessionid code get requested session id getrequestedsessionid code requested session id from cookie requestedsessionidfromcookie code is requested session id from cookie isrequestedsessionidfromcookie code requested session id valid requestedsessionidvalid code is requested session id valid isrequestedsessionidvalid code scheme code get scheme getscheme code secure code is secure issecure log rotation dict ated dictated code rotatable code property unix users field called code check exists checkexists code log file existence checked logging external log rotator move file tomcat start file jmx junkies method called code rotate code instance move existing log file start writing log file conditional logging supported code condition code property returned servlet request servletrequest get attribute getattribute condition yields logging skipped extended attributes coming get attribute getattribute call resp onsibility responsibility ensure new line newline control characters author tim funk author peter rossbach extended access log valve extendedaccesslogvalve access log valve accesslogvalve log log log factory logfactory get log getlog extended access log valve extendedaccesslogvalve instance variables descriptive implementation string extended access log info extendedaccessloginfo org apache catalina valves extended access log valve extendedaccesslogvalve properties descriptive implementation override string get info getinfo extended access log info extendedaccessloginfo methods methods wrap incoming quotes escape quotes app earing appearing quotes param wrap to string tostring called object wrapped quotes quotes escaped sets quotes string wrap object string svalue encode equals svalue to string tostring throwable exception utils exceptionutils handle throwable handlethrowable wrap values quotes string builder stringbuilder buffer string builder stringbuilder svalue length buffer append svalue length svalue index of indexof buffer append svalue substring svalue length buffer append svalue substring buffer append buffer append buffer to string tostring open log file code date stamp datestamp code override open open current log file currentlogfile length writer println fields pattern writer println version writer println software server info serverinfo get server info getserverinfo date element dateelement access log element accesslogelement milli seconds hours interval thread local threadlocal element timestamp struct elementtimestampstruct current date currentdate thread local threadlocal element timestamp struct elementtimestampstruct override element timestamp struct elementtimestampstruct initial value initialvalue element timestamp struct elementtimestampstruct yyyy override add element addelement string builder stringbuilder buf request request response response time element timestamp struct elementtimestampstruct eds current date currentdate millis eds current timestamp currenttimestamp get time gettime get time gettime millis interval get time gettime millis eds current timestamp currenttimestamp set time settime get time gettime get time gettime interval eds current timestamp string currenttimestampstring eds current timestamp format currenttimestampformat format eds current timestamp currenttimestamp buf append eds current timestamp string currenttimestampstring time element timeelement access log element accesslogelement milli seconds interval thread local threadlocal element timestamp struct elementtimestampstruct current time currenttime thread local threadlocal element timestamp struct elementtimestampstruct override element timestamp struct elementtimestampstruct initial value initialvalue element timestamp struct elementtimestampstruct override add element addelement string builder stringbuilder buf request request response response time element timestamp struct elementtimestampstruct eds current time currenttime millis eds current timestamp currenttimestamp get time gettime get time gettime millis interval get time gettime millis eds current timestamp currenttimestamp set time settime get time gettime get time gettime interval eds current timestamp string currenttimestampstring eds current timestamp format currenttimestampformat format eds current timestamp currenttimestamp buf append eds current timestamp string currenttimestampstring request header element requestheaderelement access log element accesslogelement string header request header element requestheaderelement string header header header override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get header getheader header response header element responseheaderelement access log element accesslogelement string header response header element responseheaderelement string header header header override add element addelement string builder stringbuilder buf request request response response time buf append wrap response get header getheader header servlet context element servletcontextelement access log element accesslogelement string attribute servlet context element servletcontextelement string attribute attribute attribute override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get context getcontext get servlet context getservletcontext get attribute getattribute attribute cookie element cookieelement access log element accesslogelement string cookie element cookieelement string override add element addelement string builder stringbuilder buf request request response response time cookie request get cookies getcookies length equals get name getname buf append wrap get value getvalue write specific response header xxx response all header element responseallheaderelement access log element accesslogelement string header response all header element responseallheaderelement string header header header override add element addelement string builder stringbuilder buf request request response response time response iterator string iter response get headers getheaders header iterator iter has next hasnext string builder stringbuilder buffer string builder stringbuilder iter has next hasnext buffer append buffer append iter buf append wrap buffer to string tostring buf append request attribute element requestattributeelement access log element accesslogelement string attribute request attribute element requestattributeelement string attribute attribute attribute override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get attribute getattribute attribute session attribute element sessionattributeelement access log element accesslogelement string attribute session attribute element sessionattributeelement string attribute attribute attribute override add element addelement string builder stringbuilder buf request request response response time http session httpsession session request session request get session getsession session buf append wrap session get attribute getattribute attribute request parameter element requestparameterelement access log element accesslogelement string parameter request parameter element requestparameterelement string parameter parameter parameter url encode urlencode string empty string url encode urlencode string length url encoder urlencoder encode utf unsupported encoding exception unsupportedencodingexception override add element addelement string builder stringbuilder buf request request response response time buf append wrap url encode urlencode request get parameter getparameter parameter pattern tokenizer patterntokenizer string reader stringreader string builder stringbuilder buf string builder stringbuilder ended sub token subtoken parameter pattern tokenizer patterntokenizer string str string reader stringreader str has sub token hassubtoken sub token subtoken has parameter hasparameter parameter string get token gettoken i o exception ioexception ended string result sub token subtoken parameter read result buf to string tostring buf string builder stringbuilder buf append result result buf to string tostring buf string builder stringbuilder sub token subtoken result result buf to string tostring buf string builder stringbuilder parameter result result buf to string tostring buf string builder stringbuilder buf append read ended buf length buf to string tostring string get parameter getparameter i o exception ioexception string result parameter parameter read result buf to string tostring buf string builder stringbuilder result buf append read string get white spaces getwhitespaces i o exception ioexception is ended isended string builder stringbuilder white spaces whitespaces string builder stringbuilder buf length white spaces whitespaces append buf buf string builder stringbuilder read character is whitespace iswhitespace white spaces whitespaces append read ended buf append white spaces whitespaces to string tostring is ended isended ended string get remains getremains i o exception ioexception string builder stringbuilder remains string builder stringbuilder read read remains append remains to string tostring override access log element accesslogelement create log elements createlogelements log is debug enabled isdebugenabled log debug decode pattern decodepattern pattern pattern list access log element accesslogelement list array list arraylist access log element accesslogelement pattern tokenizer patterntokenizer tokenizer pattern tokenizer patterntokenizer pattern ignore leading whitespace tokenizer get white spaces getwhitespaces tokenizer is ended isended log info pattern empty whitespace string token tokenizer get token gettoken token log is debug enabled isdebugenabled log debug token token access log element accesslogelement element get log element getlogelement token tokenizer element list add element string white spaces whitespaces tokenizer get white spaces getwhitespaces white spaces whitespaces length list add string element stringelement white spaces whitespaces tokenizer is ended isended token tokenizer get token gettoken log is debug enabled isdebugenabled log debug finished decoding element size list size list to array toarray access log element accesslogelement i o exception ioexception log error parse error access log element accesslogelement get log element getlogelement string token pattern tokenizer patterntokenizer tokenizer i o exception ioexception equals token date element dateelement time equals token tokenizer has sub token hassubtoken string next token nexttoken tokenizer get token gettoken equals next token nexttoken elapsed time element elapsedtimeelement time element timeelement bytes equals token byte sent element bytesentelement cached equals token don evaluate string element stringelement equals token string next token nexttoken tokenizer get token gettoken equals next token nexttoken remote addr element remoteaddrelement dns equals next token nexttoken host element hostelement equals token string next token nexttoken tokenizer get token gettoken equals next token nexttoken local addr element localaddrelement dns equals next token nexttoken access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time string inet address inetaddress get local host getlocalhost get host name gethostname throwable exception utils exceptionutils handle throwable handlethrowable localhost buf append equals token get client to server element getclienttoserverelement tokenizer equals token get server to client element getservertoclientelement tokenizer equals token equals token get proxy element getproxyelement tokenizer equals token get parameter element getxparameterelement tokenizer log error unable decode chars starting token access log element accesslogelement get client to server element getclienttoserverelement pattern tokenizer patterntokenizer tokenizer i o exception ioexception tokenizer has sub token hassubtoken string token tokenizer get token gettoken method equals token method element methodelement uri equals token tokenizer has sub token hassubtoken token tokenizer get token gettoken stem equals token requesturielement query equals token access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time string query request get query string getquerystring query buf append query buf append access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time string query request get query string getquerystring query buf append request getrequesturi buf append request getrequesturi buf append buf append request get query string getquerystring tokenizer has parameter hasparameter string parameter tokenizer get parameter getparameter parameter log error closing decode request header element requestheaderelement parameter log error characters couldn decoded tokenizer get remains getremains access log element accesslogelement get server to client element getservertoclientelement pattern tokenizer patterntokenizer tokenizer i o exception ioexception tokenizer has sub token hassubtoken string token tokenizer get token gettoken status equals token http status code element httpstatuscodeelement comment equals token string element stringelement tokenizer has parameter hasparameter string parameter tokenizer get parameter getparameter parameter log error closing decode response header element responseheaderelement parameter log error characters couldn decoded tokenizer get remains getremains access log element accesslogelement get proxy element getproxyelement pattern tokenizer patterntokenizer tokenizer i o exception ioexception string token tokenizer has sub token hassubtoken tokenizer get token gettoken string element stringelement tokenizer has parameter hasparameter tokenizer get parameter getparameter string element stringelement log error characters couldn decoded token access log element accesslogelement get parameter element getxparameterelement pattern tokenizer patterntokenizer tokenizer i o exception ioexception tokenizer has sub token hassubtoken log error param wrong format read docs string token tokenizer get token gettoken thread name threadname equals token thread name element threadnameelement tokenizer has parameter hasparameter log error param wrong format read docs string parameter tokenizer get parameter getparameter parameter log error closing decode equals token servlet context element servletcontextelement parameter equals token cookie element cookieelement parameter equals token request attribute element requestattributeelement parameter equals token session attribute element sessionattributeelement parameter equals token get servlet request element getservletrequestelement parameter equals token request parameter element requestparameterelement parameter equals token response all header element responseallheaderelement parameter log error param servlet request couldn decode token access log element accesslogelement get servlet request element getservletrequestelement string parameter auth type authtype equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get auth type getauthtype remote user remoteuser equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get remote user getremoteuser requested session id requestedsessionid equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get requested session id getrequestedsessionid requested session id from cookie requestedsessionidfromcookie equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request is requested session id from cookie isrequestedsessionidfromcookie requested session id valid requestedsessionidvalid equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request is requested session id valid isrequestedsessionidvalid content length contentlength equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get content length getcontentlength character encoding characterencoding equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get character encoding getcharacterencoding locale equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get locale getlocale protocol equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request get protocol getprotocol scheme equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append request get scheme getscheme secure equals parameter access log element accesslogelement override add element addelement string builder stringbuilder buf request request response response time buf append wrap request is secure issecure log error param servlet request couldn decode parameter element timestamp struct elementtimestampstruct current timestamp currenttimestamp simple date format simpledateformat current timestamp format currenttimestampformat string current timestamp string currenttimestampstring element timestamp struct elementtimestampstruct string format current timestamp format currenttimestampformat simple date format simpledateformat format locale current timestamp format currenttimestampformat set time zone settimezone time zone timezone get time zone gettimezone gmt
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat websocket pojo java io exception ioexception java net uri java nio byte buffer bytebuffer java util array list arraylist java util collections java util hash map hashmap java util list java util map java util queue java util concurrent concurrent linked queue concurrentlinkedqueue javax servlet servlet context event servletcontextevent javax websocket client endpoint clientendpoint javax websocket container provider containerprovider javax websocket decode exception decodeexception javax websocket decoder javax websocket deployment exception deploymentexception javax websocket encode exception encodeexception javax websocket encoder javax websocket endpoint javax websocket endpoint config endpointconfig javax websocket extension javax websocket message handler messagehandler javax websocket on message onmessage javax websocket session javax websocket web socket container websocketcontainer javax websocket server server container servercontainer javax websocket server server endpoint serverendpoint javax websocket server server endpoint config serverendpointconfig org junit org junit test org apache catalina context org apache catalina servlets default servlet defaultservlet org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat websocket pojo tester util testerutil server config listener serverconfiglistener org apache tomcat websocket pojo tester util testerutil singleton configurator singletonconfigurator org apache tomcat websocket server ws context listener wscontextlistener test encoding dec oding testencodingdecoding tomcat base test tomcatbasetest string message message string path programmatic echo programmatic p echoprogrammaticep string path annotated echo annotated p echoannotatedep string path generics echo generics p echogenericsep test test programmatic end points testprogrammaticendpoints exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener program atic server endpoint config programaticserverendpointconfig get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start client client client uri uri uri localhost get port getport path programmatic session session ws container wscontainer connect to server connecttoserver client uri msg string msgstring msg msg string msgstring msg set data setdata message session get basic remote getbasicremote send object sendobject msg msg string message handler msgstringmessagehandler received size client received size thread sleep check messages received assert equals assertequals msg string message handler msgstringmessagehandler received size assert equals assertequals client received size check correct messages received assert equals assertequals message msg string msgstring msg string message handler msgstringmessagehandler received peek get data getdata assert equals assertequals message string msg byte msgbyte client received peek get data getdata session close test test annotated end points testannotatedendpoints exception utility classes server server server singleton configurator singletonconfigurator set instance setinstance server server config listener serverconfiglistener set pojo clazz setpojoclazz server tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener server config listener serverconfiglistener get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start client client client uri uri uri localhost get port getport path annotated session session ws container wscontainer connect to server connecttoserver client uri msg string msgstring msg msg string msgstring msg set data setdata message session get basic remote getbasicremote send object sendobject msg server received size client received size thread sleep check messages received assert equals assertequals server received size assert equals assertequals client received size check correct messages received assert equals assertequals message msg string msgstring server received peek get data getdata assert equals assertequals message msg string msgstring client received peek get data getdata session close failures test event testevent msg string encoder msgstringencoder get name getname init test event testevent msg string decoder msgstringdecoder get name getname init test event testevent msg byte encoder msgbyteencoder get name getname init test event testevent msg byte decoder msgbytedecoder get name getname init test event testevent msg string encoder msgstringencoder get name getname destroy test event testevent msg string decoder msgstringdecoder get name getname destroy test event testevent msg byte encoder msgbyteencoder get name getname destroy test event testevent msg byte decoder msgbytedecoder get name getname destroy test test generics code rs testgenericscoders exception utility classes generics server genericsserver server generics server genericsserver singleton configurator singletonconfigurator set instance setinstance server server config listener serverconfiglistener set pojo clazz setpojoclazz generics server genericsserver tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener server config listener serverconfiglistener get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start generics client genericsclient client generics client genericsclient uri uri uri localhost get port getport path generics session session ws container wscontainer connect to server connecttoserver client uri array list arraylist string list array list arraylist string list add str list add str session get basic remote getbasicremote send object sendobject list server received size client received size thread sleep check messages received assert equals assertequals server received size assert equals assertequals server received peek to string tostring str str assert equals assertequals client received size assert equals assertequals client received peek to string tostring str str session close test event testevent string count interrupted exception interruptedexception count server is life cycle event called islifecycleeventcalled thread sleep assert true asserttrue server is life cycle event called islifecycleeventcalled client endpoint clientendpoint decoders list string decoder liststringdecoder encoders list string encoder liststringencoder generics client genericsclient queue object received concurrent linked queue concurrentlinkedqueue object on message onmessage list string received add client endpoint clientendpoint decoders msg string decoder msgstringdecoder msg byte decoder msgbytedecoder encoders msg string encoder msgstringencoder msg byte encoder msgbyteencoder client queue object received concurrent linked queue concurrentlinkedqueue object on message onmessage msg string msgstring received add on message onmessage msg byte msgbyte received add server endpoint serverendpoint path generics decoders list string decoder liststringdecoder encoders list string encoder liststringencoder config urator configurator singleton configurator singletonconfigurator generics server genericsserver queue object received concurrent linked queue concurrentlinkedqueue object on message onmessage list string list string received add echo message server endpoint serverendpoint path annotated decoders msg string decoder msgstringdecoder msg byte decoder msgbytedecoder encoders msg string encoder msgstringencoder msg byte encoder msgbyteencoder config urator configurator singleton configurator singletonconfigurator server queue object received concurrent linked queue concurrentlinkedqueue object hash map hashmap string life cycles called lifecyclescalled hash map hashmap string on message onmessage msg string msgstring msg string msgstring received add echo message on message onmessage msg byte msgbyte msg byte msgbyte received add echo message add life cycle event addlifecycleevent string event life cycles called lifecyclescalled event is life cycle event called islifecycleeventcalled string event called life cycles called lifecyclescalled event called called boolean value booleanvalue msg byte message handler msgbytemessagehandler message handler messagehandler msg byte msgbyte queue object received concurrent linked queue concurrentlinkedqueue object session session msg byte message handler msgbytemessagehandler session session session session override on message onmessage msg byte msgbyte system println get class getclass received received add msg byte msgbyte msg msg byte msgbyte msg set data setdata get bytes getbytes session get basic remote getbasicremote send object sendobject msg io exception ioexception illegal state exception illegalstateexception encode exception encodeexception illegal state exception illegalstateexception msg string message handler msgstringmessagehandler message handler messagehandler msg string msgstring queue object received concurrent linked queue concurrentlinkedqueue object session session msg string message handler msgstringmessagehandler session session session session override on message onmessage msg string msgstring received add msg byte msgbyte msg msg byte msgbyte msg set data setdata message get bytes getbytes session get basic remote getbasicremote send object sendobject msg io exception ioexception print stack trace printstacktrace encode exception encodeexception print stack trace printstacktrace programmatic endpoint programmaticendpoint endpoint override on open onopen session session endpoint config endpointconfig config session add message handler addmessagehandler msg string message handler msgstringmessagehandler session msg string msgstring string data string get data getdata data set data setdata string data data data msg string encoder msgstringencoder encoder text msg string msgstring override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override string encode msg string msgstring msg encode exception encodeexception msg string msgstring msg get data getdata msg string decoder msgstringdecoder decoder text msg string msgstring override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override msg string msgstring decode string decode exception decodeexception msg string msgstring result msg string msgstring result set data setdata substring result override will decode willdecode string starts with startswith msg string msgstring msg byte msgbyte data get data getdata data set data setdata data data data msg byte encoder msgbyteencoder encoder binary msg byte msgbyte override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override byte buffer bytebuffer encode msg byte msgbyte msg encode exception encodeexception data msg get data getdata byte buffer bytebuffer reply byte buffer bytebuffer all ocate allocate data length reply reply reply data reply flip reply msg byte decoder msgbytedecoder decoder binary msg byte msgbyte override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override msg byte msgbyte decode byte buffer bytebuffer decode exception decodeexception msg byte msgbyte result msg byte msgbyte data limit position data result set data setdata data result override will decode willdecode byte buffer bytebuffer mark reset list string encoder liststringencoder encoder text list string override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override string encode list string str encode exception encodeexception string buffer stringbuffer sbuf string buffer stringbuffer sbuf append string str sbuf append append sbuf delete char at deletecharat sbuf last index of lastindexof append sbuf to string tostring list string decoder liststringdecoder decoder text list string override init endpoint config endpointconfig endpoint config endpointconfig server add life cycle event addlifecycleevent get class getclass get name getname init override destroy server add life cycle event addlifecycleevent get class getclass get name getname destroy override list string decode string str decode exception decodeexception list string lst array list arraylist string str str substring str length string strings str split string strings lst add lst override will decode willdecode string str str starts with startswith str ends with endswith program atic server endpoint config programaticserverendpointconfig ws context listener wscontextlistener override context initialized contextinitialized servlet context event servletcontextevent sce context initialized contextinitialized sce server container servercontainer server container servercontainer sce get servlet context getservletcontext get attribute getattribute org apache tomcat websocket server constants server container servlet context attribute add endpoint addendpoint server endpoint config serverendpointconfig override map string object get user properties getuserproperties collections empty map emptymap override list encoder get encode rs getencoders list encoder encoders array list arraylist encoder encoders add msg string encoder msgstringencoder encoders add msg byte encoder msgbyteencoder encoders override list decoder get decoders getdecoders list decoder decoders array list arraylist decoder decoders add msg string decoder msgstringdecoder decoders add msg byte decoder msgbytedecoder decoders override list string get sub protocols getsubprotocols collections empty list emptylist override string get path getpath path programmatic override list extension get extensions getextensions collections empty list emptylist override get endpoint class getendpointclass programmatic endpoint programmaticendpoint override configurator get configurator getconfigurator server endpoint config serverendpointconfig configurator deployment exception deploymentexception illegal state exception illegalstateexception test test unsupported object testunsupportedobject exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener program atic server endpoint config programaticserverendpointconfig get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer tomcat start client client client uri uri uri localhost get port getport path programmatic session session ws container wscontainer connect to server connecttoserver client uri fail object msg object session get basic remote getbasicremote send object sendobject msg fail exception thrown encode exception encodeexception throwable fail wrong exception type session close
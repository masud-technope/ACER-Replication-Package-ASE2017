licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina valves java i o exception ioexception java util regex pattern javax servlet servlet exception servletexception javax servlet http http servlet response httpservletresponse org apache catalina context org apache catalina lifecycle exception lifecycleexception org apache catalina connector request org apache catalina connector response org apache juli logging log implementation valve performs filtering based comparing request property selected based subclass choose configure container pipeline regular expressions configured valve valve configured setting code code code deny code properties regular expressions syntax supported link pattern request property compared evaluation proc eeds proceeds subclass extra cts extracts request property filtered calls common code process code method deny expression configured property compared expression match request rejected for bidden forbidden http response expression configured property compared expression match request allowed pass valve current pipeline deny expression expression request pass deny expressions matched request rejected for bidden forbidden http response option valve generate invalid code authenticate code header denying request combined context attribute code preemptive authentication preemptiveauthentication code authenticator force authentication denial valve attached container depending granularity filtering perform author craig mc clanahan mcclanahan request filter valve requestfiltervalve valve base valvebase constructor request filter valve requestfiltervalve variables descriptive implementation string info org apache catalina valves request filter valve requestfiltervalve instance variables regular expression test allowed requests pattern current configuration compile valid link pattern string allow value allowvalue helper variable configuration errors code code code code attempt assign invalid code code pattern allow valid allowvalid regular expression test denied requests pattern deny current deny configuration compile valid link pattern string deny value denyvalue helper variable configuration errors code code code code attempt assign invalid code deny code pattern deny valid denyvalid http response status code rejecting denied request changed deny status denystatus http servlet response httpservletresponse forbidden code invalid authentication when deny invalidauthenticationwhendeny code context code preemptive authentication preemptiveauthentication code invalid authorization header trigger basic denying request invalid authentication when deny invalidauthenticationwhendeny properties regular expression test allowed requests valve code code string get allow getallow allow value allowvalue regular expression test allowed requests valve param expression set allow setallow string length allow value allowvalue allow valid allowvalid success allow value allowvalue pattern compile success allow valid allowvalid success regular expression test denied requests valve code code string get deny getdeny deny value denyvalue regular expression test denied requests valve param deny deny expression set deny setdeny string deny deny deny length deny deny value denyvalue deny valid denyvalid success deny value denyvalue deny deny pattern compile deny success deny valid denyvalid success returns code change code pattern apply pattern syntactically invalid is allow valid isallowvalid allow valid allowvalid returns code change code deny pattern apply pattern syntactically invalid is deny valid isdenyvalid deny valid denyvalid response status code reject denied request get deny status getdenystatus deny status denystatus response status code reject denied request set deny status setdenystatus deny status denystatus deny status denystatus deny status denystatus descriptive valve implementation override string get info getinfo info deny handled setting invalid header get invalid authentication when deny getinvalidauthenticationwhendeny invalid authentication when deny invalidauthenticationwhendeny invalid authentication when deny invalidauthenticationwhendeny property set invalid authentication when deny setinvalidauthenticationwhendeny invalid authentication when deny invalidauthenticationwhendeny methods extract desired request property pass request response objects code process code method perform actual filtering method implemented concrete subclass param request servlet request processed param response servlet response created exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs override invoke request request response response i o exception ioexception servlet exception servletexception methods override init internal initinternal lifecycle exception lifecycleexception init internal initinternal allow valid allowvalid deny valid denyvalid lifecycle exception lifecycleexception get string getstring request filter valve requestfiltervalve config invalid configinvalid override start internal startinternal lifecycle exception lifecycleexception allow valid allowvalid deny valid denyvalid lifecycle exception lifecycleexception get string getstring request filter valve requestfiltervalve config invalid configinvalid start internal startinternal perform filtering configured valve matching request property param property request property filter param request servlet request processed param response servlet response processed exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs process string property request request response response i o exception ioexception servlet exception servletexception is allowed isallowed property get next getnext invoke request response get log getlog is debug enabled isdebugenabled get log getlog debug get string getstring request filter valve requestfiltervalve deny request getrequesturi property deny request deny request denyrequest request response log get log getlog reject request denied valve code invalid authentication when deny invalidauthenticationwhendeny code context code preemptive authentication preemptiveauthentication code invalid authorization header trigger basic param request servlet request processed param response servlet response processed exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs deny request denyrequest request request response response i o exception ioexception servlet exception servletexception invalid authentication when deny invalidauthenticationwhendeny context context request get context getcontext context context get preemptive authentication getpreemptiveauthentication request get coyote request getcoyoterequest get mime headers getmimeheaders get value getvalue authorization request get coyote request getcoyoterequest get mime headers getmimeheaders add value addvalue authorization set string setstring invalid get next getnext invoke request response response send error senderror deny status denystatus perform test implemented valve matching request property method called jmx test add ress address allowed denied valve configuration param property request property filter is allowed isallowed string property local copies thread safety pattern deny deny pattern check deny patterns deny deny matcher property matches check patterns matcher property matches denies deny deny request
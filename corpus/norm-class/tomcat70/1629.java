licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http file upload fileupload java io exception ioexception java input stream inputstream java output stream outputstream java util array list arraylist java util list output stream data written array buffer automatically grows data written data retrieved code to byte array tobytearray code code to string tostring code closing byte array output stream bytearrayoutputstream methods called stream closed generating io exception ioexception alternative implementation link java byte array output stream bytearrayoutputstream original implementation alloc ates allocates bytes designed heavy duty starts bytes contrast original doesn real locate reallocate memory block alloc ates allocates additional buf fers buffers buf fers buffers garbage collected contents don copied buffer designed behave original exception deprecated to string tostring method byte array output stream bytearrayoutputstream output stream outputstream singleton empty array empty array list buf fers buffers grows reduces list buf fers buffers array list arraylist current buffer current buffer index currentbufferindex total count bytes filled buf fers buffers filled buffer sum filledbuffersum current buffer current buffer currentbuffer total count bytes written count creates array output stream buffer capacity init ially initially bytes size inc reases increases byte array output stream bytearrayoutputstream creates array output stream buffer capacity size bytes param size initial size illegal argument exception illegalargumentexception size negative byte array output stream bytearrayoutputstream size size illegal argument exception illegalargumentexception negative initial size size need new buffer neednewbuffer size buffer alloc ating allocating cycling existing param new count newcount size buffer created need new buffer neednewbuffer new count newcount current buffer index currentbufferindex buf fers buffers size recycling buffer filled buffer sum filledbuffersum current buffer currentbuffer length current buffer index currentbufferindex current buffer currentbuffer buf fers buffers current buffer index currentbufferindex creating buffer new buffer size newbuffersize current buffer currentbuffer new buffer size newbuffersize new count newcount filled buffer sum filledbuffersum new buffer size newbuffersize math max current buffer currentbuffer length new count newcount filled buffer sum filledbuffersum filled buffer sum filledbuffersum current buffer currentbuffer length current buffer index currentbufferindex current buffer currentbuffer new buffer size newbuffersize buf fers buffers add current buffer currentbuffer write bytes array param bytes write param start offset param len number bytes write override write len length len len length len index out of bounds exception indexoutofboundsexception len new count newcount count len remaining len in buffer pos inbufferpos count filled buffer sum filledbuffersum remaining math min remaining current buffer currentbuffer length in buffer pos inbufferpos system arraycopy len remaining current buffer currentbuffer in buffer pos inbufferpos remaining remaining need new buffer neednewbuffer new count newcount in buffer pos inbufferpos count new count newcount write array param write override write in buffer pos inbufferpos count filled buffer sum filledbuffersum in buffer pos inbufferpos current buffer currentbuffer length need new buffer neednewbuffer count in buffer pos inbufferpos current buffer currentbuffer in buffer pos inbufferpos count writes entire contents input stream stream bytes input stream read internal buf fers buffers str eams streams param input stream read total number bytes read input stream written stream io exception ioexception error occurs reading input stream write input stream inputstream io exception ioexception read count readcount in buffer pos inbufferpos count filled buffer sum filledbuffersum read current buffer currentbuffer in buffer pos inbufferpos current buffer currentbuffer length in buffer pos inbufferpos read count readcount in buffer pos inbufferpos count in buffer pos inbufferpos current buffer currentbuffer length need new buffer neednewbuffer current buffer currentbuffer length in buffer pos inbufferpos read current buffer currentbuffer in buffer pos inbufferpos current buffer currentbuffer length in buffer pos inbufferpos read count readcount closing byte array output stream bytearrayoutputstream methods called stream closed generating io exception ioexception io exception ioexception method declare exception comp atability compatability override close io exception ioexception nop writes entire contents stream output stream param output stream write io exception ioexception error occurs stream closed java byte array output stream bytearrayoutputstream write to writeto output stream outputstream write to writeto output stream outputstream io exception ioexception remaining count buf buf fers buffers math min buf length remaining write buf remaining remaining curent contents stream array result independent stream current contents output stream array java byte array output stream bytearrayoutputstream to byte array tobytearray to byte array tobytearray remaining count remaining empty array new buf newbuf remaining pos buf buf fers buffers math min buf length remaining system arraycopy buf new buf newbuf pos pos remaining remaining new buf newbuf curent contents stream string contents array string java byte array output stream bytearrayoutputstream to string tostring override string to string tostring string to byte array tobytearray
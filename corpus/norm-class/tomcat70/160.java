licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina security java util hash set hashset java util iterator java util locale java util org apache catalina lifecycle org apache catalina lifecycle event lifecycleevent org apache catalina lifecycle listener lifecyclelistener org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util res string manager stringmanager security listener securitylistener lifecycle listener lifecyclelistener log log log factory logfactory get log getlog security listener securitylistener string manager stringmanager string manager stringmanager get manager getmanager constants string umask property constants security listener securitylistener umask string umask format list operating system users permitted tomcat string checked os use rs checkedosusers hash set hashset string minimum umask configured operating system user running tomcat umask handled octal integer minimum umask minimumumask integer value of valueof security listener securitylistener checked os use rs checkedosusers add root override lifecycle event lifecycleevent lifecycle event lifecycleevent event earliest event lifecycle event get type gettype equals lifecycle init event do checks dochecks list operating system users permitted tomcat root prev ented prevented running tomcat calling method empty string clear list users effectively disables check user names checked insensitive manner system locale param user name list usernamelist comma separated list operating system users permitted tomcat set checked os use rs setcheckedosusers string user name list usernamelist user name list usernamelist user name list usernamelist length checked os use rs checkedosusers clear string user names usernames user name list usernamelist split string user name username user names usernames user name username length checked os use rs checkedosusers add user name username to lower case tolowercase locale get default getdefault returns current list operating system users permitted tomcat comma separated list operating sytem user names string get checked os use rs getcheckedosusers checked os use rs checkedosusers size string builder stringbuilder result string builder stringbuilder iterator string iter checked os use rs checkedosusers iterator result append iter iter has next hasnext result append result append iter result to string tostring minimum umask configured tomcat start param umask digit umask returned command umask set minimum umask setminimumumask string umask umask umask length minimum umask minimumumask integer value of valueof minimum umask minimumumask integer value of valueof umask minimum umask configured tomcat start digit umask command umask string get minimum umask getminimumumask string format umask format minimum umask minimumumask execute security checks check separate method do checks dochecks check os user checkosuser check umask checkumask check os user checkosuser string user name username system get property getproperty user user name username string user name c usernamelc user name username to lower case tolowercase locale get default getdefault checked os use rs checkedosusers user name c usernamelc error force start process aborted error get string getstring security listener securitylistener check user warning checkuserwarning user name username check umask checkumask string prop system get property getproperty umask property integer umask prop umask integer value of valueof prop number format exception numberformatexception nfe log warn get string getstring security listener securitylistener check umask parse fail checkumaskparsefail prop umask constants crlf equals constants sep running windows umask log is debug enabled isdebugenabled log debug get string getstring security listener securitylistener check umask skip checkumaskskip minimum umask minimumumask int value intvalue log warn get string getstring security listener securitylistener check umask non e checkumasknone umask property get minimum umask getminimumumask umask int value intvalue minimum umask minimumumask int value intvalue minimum umask minimumumask int value intvalue error get string getstring security listener securitylistener check umask fail checkumaskfail string format umask format umask get minimum umask getminimumumask
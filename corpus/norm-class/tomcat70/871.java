licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java util array list arraylist java util hash map hashmap java util hash set hashset java util list java util map java util org junit assert equals assertequals org junit assert true asserttrue org junit org junit test org apache catalina context org apache catalina lifecycle exception lifecycleexception org apache catalina connector request org apache catalina deploy login config loginconfig org apache catalina deploy security collection securitycollection org apache catalina deploy security constraint securityconstraint org apache catalina startup test tomcat testtomcat map realm maprealm org apache catalina startup tester servlet testerservlet org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat unit test unittest tester context testercontext org apache tomcat util buf byte chunk bytechunk org apache tomcat util security concurrent message digest concurrentmessagedigest org apache tomcat util security encoder test digest authenticator testdigestauthenticator tomcat base test tomcatbasetest string user user string pwd pwd string role role string uri string query foo bar string context path foo string client header authorization string realm test realm testrealm string cnonce cnonce string string string qop test bug lifecycle exception lifecycleexception digest authenticator digestauthenticator digest authenticator digestauthenticator digest authenticator digestauthenticator digest authenticator digestauthenticator set container setcontainer tester context testercontext digest authenticator digestauthenticator start request request tester request testerrequest count string non ces nonces hash set hashset string count non ces nonces add digest authenticator digestauthenticator generate non ce generatenonce request assert equals assertequals count non ces nonces size test test all valid testallvalid exception do test dotest user pwd context path uri realm cnonce qop test test valid no qop testvalidnoqop exception do test dotest user pwd context path uri realm test test valid query testvalidquery exception do test dotest user pwd context path uri query realm cnonce qop test test invalid uri fail testinvalidurifail exception do test dotest user pwd context path uri realm cnonce qop test test invalid uri pass testinvaliduripass exception do test dotest user pwd context path uri realm cnonce qop test test invalid realm testinvalidrealm exception do test dotest user pwd context path uri cnonce qop test test invalid non ce testinvalidnonce exception do test dotest user pwd context path uri realm cnonce qop test test invalid opaque testinvalidopaque exception do test dotest user pwd context path uri realm cnonce qop test test invalid nc testinvalidnc exception do test dotest user pwd context path uri realm cnonce qop test test invalid qop testinvalidqop exception do test dotest user pwd context path uri realm cnonce test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm cnonce test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm qop test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm cnonce qop test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm cnonce test test invalid qop combo testinvalidqopcombo exception do test dotest user pwd context path uri realm qop test test rep lay testreplay exception do test dotest user pwd context path uri realm cnonce qop do test dotest string user string pwd string uri break uri breakuri validate uri validateuri string realm use server non ce useservernonce use server opaque useserveropaque string string string cnonce string qop req expect req expect exception validate uri validateuri digest authenticator digestauthenticator digest authenticator digestauthenticator get tomcat instance gettomcatinstance get host gethost find child findchild context path get pipeline getpipeline get first getfirst set validate uri setvalidateuri get tomcat instance gettomcatinstance start string digest uri digesturi break uri breakuri digest uri digesturi broken uri digest uri digesturi uri list string array list arraylist string add build digest response builddigestresponse user pwd digest uri digesturi realm cnonce qop map string list string req headers reqheaders hash map hashmap string list string req headers reqheaders client header map string list string resp headers respheaders hash map hashmap string list string request fail extract nonce byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport uri req headers reqheaders resp headers respheaders assert equals assertequals assert true asserttrue get length getlength recycle request succeed server nonce clear use server non ce useservernonce use server opaque useserveropaque add build digest response builddigestresponse user pwd digest uri digesturi realm get non ce getnonce resp headers respheaders get opaque getopaque resp headers respheaders cnonce qop add build digest response builddigestresponse user pwd digest uri digesturi realm get non ce getnonce resp headers respheaders cnonce qop add build digest response builddigestresponse user pwd digest uri digesturi realm get opaque getopaque resp headers respheaders cnonce qop get url geturl http localhost get port getport uri req headers reqheaders req expect assert equals assertequals assert equals assertequals to string tostring assert equals assertequals assert true asserttrue get length getlength request succeed increment clear recycle reset add build digest response builddigestresponse user pwd digest uri digesturi realm get non ce getnonce resp headers respheaders get opaque getopaque resp headers respheaders cnonce qop get url geturl http localhost get port getport uri req headers reqheaders req expect assert equals assertequals assert equals assertequals to string tostring assert equals assertequals assert true asserttrue get length getlength override set up setup exception set up setup configure context digest single resource tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctxt tomcat add context addcontext context path add servlet tomcat add servlet addservlet ctxt tester servlet testerservlet tester servlet testerservlet ctxt add servlet mapping addservletmapping uri tester servlet testerservlet security collection securitycollection collection security collection securitycollection collection add pattern addpattern uri security constraint securityconstraint security constraint securityconstraint add auth role addauthrole role add collection addcollection collection ctxt add constraint addconstraint configure realm map realm maprealm realm map realm maprealm realm add user adduser user pwd realm add user role adduserrole user role ctxt set realm setrealm realm configure authenticator login config loginconfig login config loginconfig set auth method setauthmethod digest set realm name setrealmname realm ctxt set login config setloginconfig ctxt get pipeline getpipeline add valve addvalve digest authenticator digestauthenticator string get non ce getnonce map string list string resp headers respheaders list string auth headers authheaders resp headers respheaders authenticator base authenticatorbase header assume string auth header authheader auth headers authheaders iterator start auth header authheader index of indexof nonce auth header authheader index of indexof start auth header authheader substring start string get opaque getopaque map string list string resp headers respheaders list string auth headers authheaders resp headers respheaders authenticator base authenticatorbase header assume string auth header authheader auth headers authheaders iterator start auth header authheader index of indexof opaque auth header authheader index of indexof start auth header authheader substring start notes rfc data data secret data concat secret data unq username unq realm pass wd passwd method digest uri request digest unq nonce unq cnonce unq qop string build digest response builddigestresponse string user string pwd string uri string realm string nonce string opaque string string cnonce string qop string user realm pwd string uri string digest string digest string response qop response nonce response nonce cnonce qop string response digest response string builder stringbuilder string builder stringbuilder append digest username append user append realm append realm append nonce append nonce append uri append uri append opaque append opaque append response append response append qop append qop append qop append append append cnonce append cnonce append cnonce append to string tostring string digest string input encoder encode concurrent message digest concurrentmessagedigest digestmd input get bytes getbytes tester request testerrequest request override string get remote addr getremoteaddr
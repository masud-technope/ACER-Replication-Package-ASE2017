licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina loader java sql driver java sql driver manager drivermanager java sql sql exception sqlexception java util array list arraylist java util enumeration java util hash set hashset java util list loaded link webapp class loader base webappclassloaderbase enable deregister jdbc drivers for gotten forgotten web application class loading classloading hacks involved link webapp class loader base webappclassloaderbase clear references clearreferences details version create instance keyword loaded link webapp class loader base webappclassloaderbase refer internal tomcat classes security manager complain jdbc leak prevention jdbcleakprevention list string clear jdbc driver registrations clearjdbcdriverregistrations sql exception sqlexception list string driver names drivernames array list arraylist string driver manager drivermanager get drivers getdrivers nasty side registering drivers visible loader have n haven loaded call method list originally loaded drivers triggers unwanted side call complete list drivers ensuring original drivers loaded result side effects registered hash set hashset driver original drivers originaldrivers hash set hashset driver enumeration driver drivers driver manager drivermanager get drivers getdrivers drivers has more elements hasmoreelements original drivers originaldrivers add drivers next element nextelement drivers driver manager drivermanager get drivers getdrivers drivers has more elements hasmoreelements driver driver drivers next element nextelement unload drivers web app loaded driver get class getclass get class loader getclassloader get class getclass get class loader getclassloader registered side code original drivers originaldrivers driver driver names drivernames add driver get class getclass get canonical name getcanonicalname driver manager drivermanager deregister driver deregisterdriver driver driver names drivernames
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java i o exception ioexception java security principal java util map java util java util concurrent concurrent hash map concurrenthashmap javax servlet servlet exception servletexception javax servlet http cookie org apache catalina container org apache catalina context org apache catalina engine org apache catalina globals org apache catalina lifecycle exception lifecycleexception org apache catalina manager org apache catalina realm org apache catalina session org apache catalina session listener sessionlistener org apache catalina connector request org apache catalina connector response org apache catalina valves valve base valvebase org apache tomcat util res string manager stringmanager strong valve strong supports single sign user exp erience experience security identity user auth enticates authenticates web application prop agated propagated web applications security domain successful requirements met valve configured container represents virtual host typically implementation code host code code realm code shared user role configured container higher overridden web application level web applications standard auth enticators authenticators code org apache catalina authenticator code author craig mc clanahan mcclanahan single sign on singlesignon valve base valvebase access start string last access at start lastaccessatstart system get property getproperty org apache catalina session standard session standardsession access start last access at start lastaccessatstart access start globals strict servlet compliance access start parse boolean parseboolean last access at start lastaccessatstart string manager stringmanager string manager stringmanager get manager getmanager constants engine top container hierarchy sso valve session object single sign on session key singlesignonsessionkey updated valve starts stops engine engine single sign on singlesignon instance variables cache single sign on entry singlesignonentry instances authenticated principals keyed cookie select map string single sign on entry singlesignonentry cache concurrent hash map concurrenthashmap string single sign on entry singlesignonentry descriptive valve implementation string info org apache catalina authenticator single sign on singlesignon valve require downstream authenticator reauthenticate request bind user principal userprincipal auth type authtype object request require reauthentication requirereauthentication optional sso cookie domain string cookie domain cookiedomain properties returns optional cookie domain cookie domain string get cookie domain getcookiedomain cookie domain cookiedomain sets domain sso cookies param cookie domain cookiedomain cookie domain set cookie domain setcookiedomain string cookie domain cookiedomain cookie domain cookiedomain cookie domain cookiedomain trim length cookie domain cookiedomain cookie domain cookiedomain cookie domain cookiedomain request reauthenticated authenticator downstream pipeline security code realm code valve bind security info request based presence valid sso entry rechecking code realm code code code required downstream authenticator reauthenticate request calls code http servlet request httpservletrequest set user principal setuserprincipal code code http servlet request httpservletrequest set auth type setauthtype code code code code valve code calls relying presence valid single sign on singlesignon entry request set require reauthentication setrequirereauthentication get require reauthentication getrequirereauthentication require reauthentication requirereauthentication sets request reauthenticated authenticator downstream pipeline security code realm code valve bind security info request based presence valid sso entry rechecking code realm code property code code code valve code bind user principal userprincipal auth type authtype request valid sso entry request notify security code realm code incoming request property code code server configuration requires code realm code reauthenticate request thread configuration code realm code implementation security web tier ejb tier security credentials request thread order support ejb access property code code valve flags request not ifying notifying downstream authenticator request sso session authenticator call link authenticator base authenticatorbase reauthenticatefromsso reauthenticatefromsso method attempt reauthenticate request code realm code credentials cached valve property code code order main tain maintain compatibility previous versions tomcat param required code code required downstream authenticator reauthenticate request calls code http servlet request httpservletrequest set user principal setuserprincipal code code http servlet request httpservletrequest set auth type setauthtype code code code code valve code calls relying presence valid single sign on singlesignon entry request authenticator base authenticatorbase reauthenticatefromsso set require reauthentication setrequirereauthentication required require reauthentication requirereauthentication required valve methods descriptive valve implementation override string get info getinfo info perform single sign support processing request param request servlet request processing param response servlet response creating exception i o exception ioexception input output error occurs exception servlet exception servletexception servlet error occurs override invoke request request response response i o exception ioexception servlet exception servletexception request remove note removenote constants req sso id ssoid note valid user authenticated container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug invoke request getrequesturi request get user principal getuserprincipal container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug has principal hasprincipal request get user principal getuserprincipal get name getname get next getnext invoke request response check single sign cookie container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug cookie check cookiecheck cookie cookie cookie cookies request get cookies getcookies cookies cookies length constants single sig n sign cookie equals cookies get name getname cookie cookies cookie container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug cookie not found cookienotfound get next getnext invoke request response cached principal cookie container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug principal check principalcheck cookie get value getvalue single sign on entry singlesignonentry entry cache cookie get value getvalue entry container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug principal found principalfound entry get principal getprincipal entry get principal getprincipal get name getname entry get auth type getauthtype request set note setnote constants req sso id ssoid note cookie get value getvalue security elements reauthentication required get require reauthentication getrequirereauthentication request set auth type setauthtype entry get auth type getauthtype request set user principal setuserprincipal entry get principal getprincipal container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug principal not found principalnotfound cookie get value getvalue valid sso session cookie set value setvalue remove age trigger removal cookie set max age setmaxage domain path match original cookie replace original cookie cookie set path setpath string domain get cookie domain getcookiedomain domain cookie set domain setdomain domain trigger cookie header security sensitive ensure expect ations expectations secure http only httponly met cookie set secure setsecure request is secure issecure request get servlet context getservletcontext get session cookie config getsessioncookieconfig is http only ishttponly request get context getcontext get use http only getusehttponly cookie set http only sethttponly response add cookie addcookie cookie invoke valve pipeline get next getnext invoke request response methods process session destroyed event removing references session caches session dest ruction destruction result log out logout destroy sso session param sso id ssoid sso session destroyed session param session session destroyed session destroyed sessiondestroyed string sso id ssoid session session get state getstate is available isavailable sso session get max inactive interval getmaxinactiveinterval system current time millis currenttimemillis session get this accessed time internal getthisaccessedtimeinternal session get max inactive interval getmaxinactiveinterval context session get manager getmanager get container getcontainer get state getstate is available isavailable container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug session timeout sessiontimeout sso id ssoid session remove session removesession sso id ssoid session sessions container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug session log out sessionlogout sso id ssoid session remove session expired log ged logged removed manager don remove deregister log warning remove session removesession sso id ssoid session removed sso session cache cache contains key containskey sso id ssoid deregister sso id ssoid associate single sign identifier session param sso id ssoid single sign identifier param session session code code session sso session code code associate string sso id ssoid session session single sign on entry singlesignonentry sso cache sso id ssoid sso container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug associate fail associatefail sso id ssoid session container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug associate sso id ssoid session sso add session addsession sso id ssoid session deregister single sign identifier invalid ate invalidate sessions param sso id ssoid single sign identifier deregister deregister string sso id ssoid remove single sign on entry singlesignonentry single sign on entry singlesignonentry sso cache remove sso id ssoid sso container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug deregister fail deregisterfail sso id ssoid expire sessions single sign on session key singlesignonsessionkey sso keys ssokeys sso find sessions findsessions sso keys ssokeys size container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug deregister non e deregisternone sso id ssoid single sign on session key singlesignonsessionkey sso key ssokey sso keys ssokeys container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug deregister sso key ssokey sso id ssoid invalid ate invalidate session expire sso key ssokey note clients pos sess possess single sign cookie removed request longer cache expire single sign on session key singlesignonsessionkey key engine container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire engine null enginenull key container host engine find child findchild key get host name gethostname host container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire host not found hostnotfound key context context context host find child findchild key get context name getcontextname context container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire context not found contextnotfound key manager manager context get manager getmanager manager container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire manager not found managernotfound key session session session manager find session findsession key get session id getsessionid i o exception ioexception container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire manager error managererror key session container log containerlog warn get string getstring single sign on singlesignon session expire sessionexpire session not found sessionnotfound key session expire attempts reauthentication code realm code credentials single sign session identified argument code sso id ssoid code reauthentication successful code principal code authorization type sso session bound code request code object calls link request set auth type setauthtype request set auth type setauthtype link request set user principal setuserprincipal request set user principal setuserprincipal param sso id ssoid identifier single sign on singlesignon session caller param realm realm implementation caller authenticated param request request authenticated code code reauthentication successful code code reauthenticate string sso id ssoid realm realm request request sso id ssoid realm reauthenticated single sign on entry singlesignonentry entry cache sso id ssoid entry entry get can reauthenticate getcanreauthenticate string username entry get username getusername username principal reauth principal reauthprincipal realm authenticate username entry get password getpassword reauth principal reauthprincipal reauthenticated bind authorization credentials request request set auth type setauthtype entry get auth type getauthtype request set user principal setuserprincipal reauth principal reauthprincipal reauthenticated register principal single sign identifier param sso id ssoid single sign identifier register param principal user principal identified param auth type authtype authentication type authenticate user principal param username username authenticate user param password password authenticate user register string sso id ssoid principal principal string auth type authtype string username string password container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug register sso id ssoid principal principal get name getname auth type authtype cache sso id ssoid single sign on entry singlesignonentry principal auth type authtype username password updates code single sign on entry singlesignonentry code key code sso id ssoid code authentication data purpose method sso entry established username password combination established digest client cert authentication updated username password subsequent basic form authentication sso entry usable reauthentication note updates sso entry call code single sign on entry singlesignonentry get can reauthenticate getcanreauthenticate code returns code code assumed sso entry sufficient reauthentication update needed param sso id ssoid identifier single sign updated param principal code principal code returned latest call code realm authenticate code param auth type authtype type authenticator basic client cert digest form param username username authentication param password password authentication code code credentials updated code code update string sso id ssoid principal principal string auth type authtype string username string password single sign on entry singlesignonentry sso cache sso id ssoid sso sso get can reauthenticate getcanreauthenticate container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug update sso id ssoid auth type authtype sso update credentials updatecredentials principal auth type authtype username password remove single session single sign on singlesignon called session time d timed longer active param sso id ssoid single sign identifier remove session param session session removed remove session removesession string sso id ssoid session session container log containerlog is debug enabled isdebugenabled container log containerlog debug get string getstring single sign on singlesignon debug remove session removesession session sso id ssoid reference single sign on singlesignon single sign on entry singlesignonentry entry cache sso id ssoid entry remove inactive session single sign on entry singlesignonentry entry remove session removesession session deregister entry entry find sessions findsessions size deregister sso id ssoid session listener sessionlistener get session listener getsessionlistener string sso id ssoid single sign on listener singlesignonlistener sso id ssoid override start internal startinternal lifecycle exception lifecycleexception container get container getcontainer engine get parent getparent engine engine engine start internal startinternal override stop internal stopinternal lifecycle exception lifecycleexception stop internal stopinternal engine
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java i o exception ioexception java input stream inputstream java security principal java util enumeration java util iterator java util locale javax servlet request dispatcher requestdispatcher javax servlet http cookie javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina manager org apache catalina realm org apache catalina session org apache catalina connector request org apache catalina deploy login config loginconfig org apache coyote action code actioncode org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils org apache tomcat util buf byte chunk bytechunk org apache tomcat util buf char chunk charchunk org apache tomcat util buf message bytes messagebytes org apache tomcat util http mime headers mimeheaders authenticator valve implementation form base d based authentication servlet api specification version author craig mc clanahan mcclanahan author remy maucherat form authenticator formauthenticator authenticator base authenticatorbase log log log factory logfactory get log getlog form authenticator formauthenticator instance variables descriptive implementation string info org apache catalina authenticator form authenticator formauthenticator character encoding read username password parameters request encoding request body string character encoding characterencoding landing user access login session times login error resp onses responses string landing page landingpage properties descriptive valve implementation override string get info getinfo info character encoding read username password string get character encoding getcharacterencoding character encoding characterencoding character encoding read username password set character encoding setcharacterencoding string encoding character encoding characterencoding encoding landing form mis string get landing page getlandingpage landing page landingpage landing form mis set landing page setlandingpage string landing page landingpage landing page landingpage landing page landingpage methods auth enticate authenticate user making request based login configuration code code constraint satisfied code code created response challenge param request request processing param response response creating param config login configuration describing authentication performed exception i o exception ioexception input output error occurs override authenticate request request http servlet response httpservletresponse response login config loginconfig config i o exception ioexception check for cached authentication checkforcachedauthentication request response references objects session session principal principal authenticated user caching disabled cache session request get session internal getsessioninternal log is debug enabled isdebugenabled log debug checking reauthenticate session session string username string session get note getnote constants sess use rname username note string password string session get note getnote constants sess password note username password log is debug enabled isdebugenabled log debug reauthenticating username username principal context get realm getrealm authenticate username password principal session set note setnote constants form principal note principal match request matchrequest request register request response principal http servlet request httpservletrequest form username password log is debug enabled isdebugenabled log debug reauthentication failed proceed authentication original request match request matchrequest request session request get session internal getsessioninternal log is debug enabled isdebugenabled log debug restore request session session get id internal getidinternal principal principal session get note getnote constants form principal note register request response principal http servlet request httpservletrequest form string session get note getnote constants sess use rname username note string session get note getnote constants sess password note password session remove cache session remove note removenote constants sess use rname username note session remove note removenote constants sess password note restore request restorerequest request session log is debug enabled isdebugenabled log debug proc eed proceed restored request log is debug enabled isdebugenabled log debug restore original request failed response send error senderror http servlet response httpservletresponse bad request acquire references objects evaluate message bytes messagebytes urimb message bytes messagebytes new instance newinstance char chunk charchunk uricc urimb get char chunk getcharchunk uricc set limit setlimit string context path contextpath request get context path getcontextpath string requesturi request get decoded request i getdecodedrequesturi action request login login action loginaction requesturi starts with startswith context path contextpath requesturi ends with endswith constants form action save request redirect form login login action loginaction correct web application request get servlet path getservletpath length request get path info getpathinfo string builder stringbuilder location string builder stringbuilder requesturi location append request get query string getquerystring location append location append request get query string getquerystring response send redirect sendredirect response encoderedirecturl location to string tostring session request get session internal getsessioninternal log is debug enabled isdebugenabled log debug save request session session get id internal getidinternal save request saverequest request session i o exception ioexception ioe log debug request body big save authentication response send error senderror http servlet response httpservletresponse forbidden get string getstring authenticator request body too big requestbodytoobig for ward to login page forwardtologinpage request response config acknowledge request validate credentials redirect error correct request get response getresponse send acknowledgement sendacknowledgement realm realm context get realm getrealm character encoding characterencoding request set character encoding setcharacterencoding character encoding characterencoding string username request get parameter getparameter constants form use rname username string password request get parameter getparameter constants form password log is debug enabled isdebugenabled log debug auth enticating authenticating username username principal realm authenticate username password principal for ward to error page forwardtoerrorpage request response config log is debug enabled isdebugenabled log debug authentication username successful session session request get session internal getsessioninternal session container log containerlog is debug enabled isdebugenabled container log containerlog debug user log session expired landing page landingpage response send error senderror http servlet response httpservletresponse request timeout get string getstring authenticator session expired sessionexpired authenticator user originally requested landing string uri request get context path getcontextpath landing page landingpage saved request savedrequest saved saved request savedrequest saved set method setmethod saved setrequesturi uri saved set decoded request i setdecodedrequesturi uri request get session internal getsessioninternal set note setnote constants form request note saved response send redirect sendredirect response encoderedirecturl uri save authenticated principal session session set note setnote constants form principal note principal save username password session set note setnote constants sess use rname username note username session set note setnote constants sess password note password redirect user original request uri original request restored requesturi savedrequesturl session log is debug enabled isdebugenabled log debug red irecting redirecting original requesturi requesturi landing page landingpage response send error senderror http servlet response httpservletresponse bad request get string getstring authenticator form login formlogin authenticator user originally requested landing string uri request get context path getcontextpath landing page landingpage saved request savedrequest saved saved request savedrequest saved set method setmethod saved setrequesturi uri saved set decoded request i setdecodedrequesturi uri session set note setnote constants form request note saved response send redirect sendredirect response encoderedirecturl uri response send redirect sendredirect response encoderedirecturl requesturi override string get auth method getauthmethod http servlet request httpservletrequest form methods called login param request request processing param response response pop ulating populating param config login configuration describing authentication performed i o exception ioexception login fails call link http servlet response httpservletresponse send error senderror string link i o exception ioexception for ward to login page forwardtologinpage request request http servlet response httpservletresponse response login config loginconfig config i o exception ioexception log is debug enabled isdebugenabled log debug get string getstring form authenticator formauthenticator for ward login forwardlogin request getrequesturi request get method getmethod config get login page getloginpage context get name getname string login page loginpage config get login page getloginpage login page loginpage login page loginpage length string msg get string getstring form authenticator formauthenticator no login page nologinpage context get name getname log warn msg response send error senderror http servlet response httpservletresponse internal server error msg get change session id on authentication getchangesessionidonauthentication session session request get session internal getsessioninternal session manager manager request get context getcontext get manager getmanager manager change session id changesessionid session request change session id changesessionid session get id getid login method string old method oldmethod request get method getmethod request get coyote request getcoyoterequest method set string setstring request dispatcher requestdispatcher disp context get servlet context getservletcontext get request dispatcher getrequestdispatcher login page loginpage context fire request init event firerequestinitevent request disp request get request getrequest response context fire request destroy event firerequestdestroyevent request throwable exception utils exceptionutils handle throwable handlethrowable string msg get string getstring form authenticator formauthenticator for ward login fail forwardloginfail log warn msg request set attribute setattribute request dispatcher requestdispatcher error exception response send error senderror http servlet response httpservletresponse internal server error msg restore original method written access log request get coyote request getcoyoterequest method set string setstring old method oldmethod called error param request request processing param response response pop ulating populating param config login configuration describing authentication performed i o exception ioexception error fails call link http servlet response httpservletresponse send error senderror string link i o exception ioexception for ward to error page forwardtoerrorpage request request http servlet response httpservletresponse response login config loginconfig config i o exception ioexception string error page errorpage config get error page geterrorpage error page errorpage error page errorpage length string msg get string getstring form authenticator formauthenticator no error page noerrorpage context get name getname log warn msg response send error senderror http servlet response httpservletresponse internal server error msg request dispatcher requestdispatcher disp context get servlet context getservletcontext get request dispatcher getrequestdispatcher config get error page geterrorpage context fire request init event firerequestinitevent request disp request get request getrequest response context fire request destroy event firerequestdestroyevent request throwable exception utils exceptionutils handle throwable handlethrowable string msg get string getstring form authenticator formauthenticator for ward error fail forwarderrorfail log warn msg request set attribute setattribute request dispatcher requestdispatcher error exception response send error senderror http servlet response httpservletresponse internal server error msg request match saved redirect sig naled signaled successful authentication param request request verified match request matchrequest request request session created session session request get session internal getsessioninternal session saved request saved request savedrequest sreq saved request savedrequest session get note getnote constants form request note sreq saved principal session get note getnote constants form principal note request uri match string decodedrequesturi request get decoded request i getdecodedrequesturi decodedrequesturi decodedrequesturi equals sreq get decoded request i getdecodedrequesturi restore original request stored session original request longer session time d timed code code code code param request request restored param session session saved restore request restorerequest request request session session i o exception ioexception retrieve remove saved request savedrequest object session saved request savedrequest saved saved request savedrequest session get note getnote constants form request note session remove note removenote constants form request note session remove note removenote constants form principal note saved swallow request body replacing headers restored ajp connector content length header determine data read request body buffer input stream inputstream request create input stream createinputstream read buffer ignore request body modify current request reflect original request clear cookies clearcookies iterator cookie cookies saved get cookies getcookies cookies has next hasnext request add cookie addcookie cookies string method saved get method getmethod mime headers mimeheaders rmh request get coyote request getcoyoterequest get mime headers getmimeheaders rmh recycle cachable equals ignore case equalsignorecase method head equals ignore case equalsignorecase method iterator string names saved get header names getheadernames names has next hasnext string names modified equals ignore case equalsignorecase cachable match equals ignore case equalsignorecase iterator string values saved get header values getheadervalues values has next hasnext rmh add value addvalue set string setstring values request clear locales clearlocales iterator locale locales saved get locales getlocales locales has next hasnext request add locale addlocale locales request get coyote request getcoyoterequest get parameters getparameters recycle request get coyote request getcoyoterequest get parameters getparameters set query string encoding setquerystringencoding request get connector getconnector geturiencoding byte chunk bytechunk body saved get body getbody body request get coyote request getcoyoterequest action action code actioncode req body replay body content type message bytes messagebytes content type contenttype message bytes messagebytes new instance newinstance content type post string saved content type savedcontenttype saved get content type getcontenttype saved content type savedcontenttype post equals ignore case equalsignorecase method saved content type savedcontenttype application form url encoded urlencoded content type contenttype set string setstring saved content type savedcontenttype request get coyote request getcoyoterequest set content type setcontenttype content type contenttype request get coyote request getcoyoterequest method set string setstring method request get coyote request getcoyoterequest query string querystring set string setstring saved get query string getquerystring request get coyote request getcoyoterequest requesturi set string setstring saved getrequesturi save original request session param request request saved param session session saved i o exception ioexception save request saverequest request request session session i o exception ioexception create populate saved request savedrequest object request saved request savedrequest saved saved request savedrequest cookie cookies request get cookies getcookies cookies cookies length saved add cookie addcookie cookies enumeration string names request get header names getheadernames names has more elements hasmoreelements string names next element nextelement enumeration string values request get headers getheaders values has more elements hasmoreelements string values next element nextelement saved add header addheader enumeration locale locales request get locales getlocales locales has more elements hasmoreelements locale locale locales next element nextelement saved add locale addlocale locale acknowledge expectation request get response getresponse send acknowledgement sendacknowledgement byte chunk bytechunk body byte chunk bytechunk body set limit setlimit request get connector getconnector get max save post size getmaxsavepostsize buffer bytes read bytesread input stream inputstream request get input stream getinputstream bytes read bytesread read buffer body append buffer bytes read bytesread save request body save body get length getlength saved set content type setcontenttype request get content type getcontenttype saved set body setbody body saved set method setmethod request get method getmethod saved set query string setquerystring request get query string getquerystring saved setrequesturi request getrequesturi saved set decoded request i setdecodedrequesturi request get decoded request i getdecodedrequesturi stash saved request savedrequest session session set note setnote constants form request note saved request uri query string saved request redirect param session current session string savedrequesturl session session saved request savedrequest saved saved request savedrequest session get note getnote constants form request note saved string builder stringbuilder string builder stringbuilder saved getrequesturi saved get query string getquerystring append append saved get query string getquerystring to string tostring
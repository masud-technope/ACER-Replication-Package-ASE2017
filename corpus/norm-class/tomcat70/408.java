licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java security secure random securerandom java util random javax servlet filter config filterconfig javax servlet servlet exception servletexception javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache juli logging log org apache juli logging log factory logfactory csrf prevention filter base csrfpreventionfilterbase filter base filterbase log log log factory logfactory get log getlog csrf prevention filter base csrfpreventionfilterbase string random class randomclass secure random securerandom get name getname random random source randomsource deny status denystatus http servlet response httpservletresponse forbidden override log get logger getlogger log response status code reject denied request get deny status getdenystatus deny status denystatus response status code reject denied request param deny status denystatus http status code set deny status setdenystatus deny status denystatus deny status denystatus deny status denystatus generate non ces nonces instance link random param random class randomclass set random class setrandomclass string random class randomclass random class randomclass random class randomclass override init filter config filterconfig filter config filterconfig servlet exception servletexception parameters init filter config filterconfig clazz for name forname random class randomclass random source randomsource random clazz new instance newinstance class not found exception classnotfoundexception servlet exception servletexception servlet exception servletexception get string getstring csrf prevention csrfprevention invalid random class invalidrandomclass random class randomclass instantiation exception instantiationexception servlet exception servletexception servlet exception servletexception get string getstring csrf prevention csrfprevention invalid random class invalidrandomclass random class randomclass illegal access exception illegalaccessexception servlet exception servletexception servlet exception servletexception get string getstring csrf prevention csrfprevention invalid random class invalidrandomclass random class randomclass override is config problem fatal isconfigproblemfatal generate time token non ce nonce auth enticating authenticating subsequent requests non ce nonce generation simplified version manager base managerbase generate session id generatesessionid string generate non ce generatenonce random render result string hexadecimal digits string builder stringbuilder buffer string builder stringbuilder random source randomsource next bytes nextbytes random random length random random buffer append buffer append buffer append buffer append buffer to string tostring string get requested path getrequestedpath http servlet request httpservletrequest request string path request get servlet path getservletpath request get path info getpathinfo path path request get path info getpathinfo path
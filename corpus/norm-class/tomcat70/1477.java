licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java io exception ioexception javax servlet dispatcher type dispatchertype javax servlet request dispatcher requestdispatcher javax servlet servlet javax servlet servlet exception servletexception javax servlet unavailable exception unavailableexception javax servlet http http servlet response httpservletresponse org apache catalina context org apache catalina globals org apache catalina lifecycle exception lifecycleexception org apache catalina comet comet event cometevent org apache catalina comet comet processor cometprocessor org apache catalina connector client abort exception clientabortexception org apache catalina connector request org apache catalina connector response org apache catalina valves valve base valvebase org apache tomcat util exception utils exceptionutils org apache tomcat util buf message bytes messagebytes org apache tomcat util log system log handler systemloghandler org apache tomcat util res string manager stringmanager valve basic behavior code standard wrapper standardwrapper code container implementation author craig mc clanahan mcclanahan standard wrapper valve standardwrappervalve valve base valvebase constructor standard wrapper valve standardwrappervalve instance variables jmx statistics valve standard wrapper standardwrapper expose standard wrapper standardwrapper jmx ee type eetype servlet fields performance processing time processingtime max time maxtime min time mintime max request count requestcount error count errorcount string manager string manager stringmanager string manager stringmanager get manager getmanager constants methods invoke servlet managing resp ecting respecting rules servlet lifecycle single thread model singlethreadmodel support param request request processed param response response produced exception io exception ioexception input output error occurred exception servlet exception servletexception servlet error occurred override invoke request request response response io exception ioexception servlet exception servletexception initialize local variables unavailable throwable throwable request attribute system current time millis currenttimemillis request count requestcount standard wrapper standardwrapper wrapper standard wrapper standardwrapper get container getcontainer servlet servlet context context context wrapper get parent getparent check application marked unavailable context get state getstate is available isavailable response send error senderror http servlet response httpservletresponse service unavailable get string getstring standard context standardcontext is unavailable isunavailable unavailable check servlet marked unavailable unavailable wrapper is unavailable isunavailable container get logger getlogger info get string getstring standard wrapper standardwrapper is unavailable isunavailable wrapper get name getname wrapper get available getavailable max response set date header setdateheader retry response send error senderror http servlet response httpservletresponse service unavailable get string getstring standard wrapper standardwrapper is unavailable isunavailable wrapper get name getname max response send error senderror http servlet response httpservletresponse get string getstring standard wrapper standardwrapper not found notfound wrapper get name getname unavailable all ocate allocate servlet instance process request unavailable servlet wrapper all ocate allocate unavailable exception unavailableexception container get logger getlogger error get string getstring standard wrapper standardwrapper all ocate exception allocateexception wrapper get name getname wrapper get available getavailable max response set date header setdateheader retry response send error senderror http servlet response httpservletresponse service unavailable get string getstring standard wrapper standardwrapper is unavailable isunavailable wrapper get name getname max response send error senderror http servlet response httpservletresponse get string getstring standard wrapper standardwrapper not found notfound wrapper get name getname servlet exception servletexception container get logger getlogger error get string getstring standard wrapper standardwrapper all ocate exception allocateexception wrapper get name getname standard wrapper standardwrapper get root cause getrootcause throwable exception request response throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper all ocate exception allocateexception wrapper get name getname throwable exception request response servlet identify request comet servlet all ocated allocated comet servlet comet processor cometprocessor equals request get attribute getattribute globals comet supported attr comet request set comet setcomet message bytes messagebytes request path b requestpathmb request get request path b getrequestpathmb dispatcher type dispatchertype dispatcher type dispatchertype dispatcher type dispatchertype request request get dispatcher type getdispatchertype dispatcher type dispatchertype async dispatcher type dispatchertype dispatcher type dispatchertype async request set attribute setattribute globals dispatcher type attr dispatcher type dispatchertype request set attribute setattribute globals dispatcher request path attr request path b requestpathmb create filter chain request application filter factory applicationfilterfactory factory application filter factory applicationfilterfactory get instance getinstance application filter chain applicationfilterchain filter chain filterchain factory create filter chain createfilterchain request wrapper servlet reset comet flag creating filter chain request set comet setcomet note calls servlet service method servlet filter chain filterchain swallow output needed context get swallow output getswallowoutput system log handler systemloghandler start capture startcapture request is async dispatching isasyncdispatching request get async context internal getasynccontextinternal do internal dispatch dointernaldispatch comet filter chain filterchain do filter event dofilterevent request get event getevent request set comet setcomet filter chain filterchain do filter dofilter request get request getrequest response get response getresponse string log system log handler systemloghandler stop capture stopcapture log log length context get logger getlogger info log request is async dispatching isasyncdispatching request get async context internal getasynccontextinternal do internal dispatch dointernaldispatch comet request set comet setcomet filter chain filterchain do filter event dofilterevent request get event getevent filter chain filterchain do filter dofilter request get request getrequest response get response getresponse client abort exception clientabortexception throwable exception request response io exception ioexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname throwable exception request response unavailable exception unavailableexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname wrapper unavailable wrapper get available getavailable max response set date header setdateheader retry response send error senderror http servlet response httpservletresponse service unavailable get string getstring standard wrapper standardwrapper is unavailable isunavailable wrapper get name getname max response send error senderror http servlet response httpservletresponse get string getstring standard wrapper standardwrapper not found notfound wrapper get name getname servlet exception servletexception throwable root cause rootcause standard wrapper standardwrapper get root cause getrootcause root cause rootcause client abort exception clientabortexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception root serviceexceptionroot wrapper get name getname context get name getname get message getmessage root cause rootcause throwable exception request response throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname throwable exception request response release filter chain request filter chain filterchain request is comet iscomet comet request chain processing subsequent events filter chain filterchain reuse filter chain filterchain release deallocate all ocated allocated servlet instance servlet wrapper deallocate servlet throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper deallocate exception deallocateexception wrapper get name getname throwable throwable exception request response unload release instance servlet wrapper get available getavailable max wrapper unload throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper unload exception unloadexception wrapper get name getname throwable throwable exception request response system current time millis currenttimemillis time processing time processingtime time time max time maxtime max time maxtime time time min time mintime min time mintime time process comet event main diff erences differences send error senderror response committed avoid creating filter chain work point less pointless minor tweaks param request servlet request processed param response servlet response created exception io exception ioexception input output error occurs thrown sub sequently subsequently invoked valve filter servlet exception servlet exception servletexception servlet error occurs thrown sub sequently subsequently invoked valve filter servlet override event request request response response comet event cometevent event io exception ioexception servlet exception servletexception initialize local variables throwable throwable request attribute system current time millis currenttimemillis fixme add flag count total amount events processed request count requestcount standard wrapper standardwrapper wrapper standard wrapper standardwrapper get container getcontainer wrapper context shutdown servlet servlet context context context wrapper get parent getparent check application marked unavailable unavailable context get state getstate is available isavailable wrapper is unavailable isunavailable all ocate allocate servlet instance process request unavailable servlet wrapper all ocate allocate unavailable exception unavailableexception servlet exception servletexception container get logger getlogger error get string getstring standard wrapper standardwrapper all ocate exception allocateexception wrapper get name getname standard wrapper standardwrapper get root cause getrootcause throwable exception request response throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper all ocate exception allocateexception wrapper get name getname throwable exception request response servlet message bytes messagebytes request path b requestpathmb request get request path b getrequestpathmb request set attribute setattribute globals dispatcher type attr dispatcher type dispatchertype request request set attribute setattribute globals dispatcher request path attr request path b requestpathmb current unchanged filter chain request application filter chain applicationfilterchain filter chain filterchain application filter chain applicationfilterchain request get filter chain getfilterchain note calls servlet event method servlet filter chain filterchain swallow output needed context get swallow output getswallowoutput system log handler systemloghandler start capture startcapture filter chain filterchain do filter event dofilterevent request get event getevent string log system log handler systemloghandler stop capture stopcapture log log length context get logger getlogger info log filter chain filterchain do filter event dofilterevent request get event getevent client abort exception clientabortexception throwable exception request response io exception ioexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname throwable exception request response unavailable exception unavailableexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname servlet exception servletexception throwable root cause rootcause standard wrapper standardwrapper get root cause getrootcause root cause rootcause client abort exception clientabortexception container get logger getlogger error get string getstring standard wrapper standardwrapper service exception root serviceexceptionroot wrapper get name getname context get name getname get message getmessage root cause rootcause throwable exception request response throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper service exception serviceexception wrapper get name getname context get name getname throwable exception request response release filter chain request filter chain filterchain filter chain filterchain reuse deallocate all ocated allocated servlet instance servlet wrapper deallocate servlet throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper deallocate exception deallocateexception wrapper get name getname throwable throwable exception request response unload release instance servlet wrapper get available getavailable max wrapper unload throwable exception utils exceptionutils handle throwable handlethrowable container get logger getlogger error get string getstring standard wrapper standardwrapper unload exception unloadexception wrapper get name getname throwable throwable exception request response system current time millis currenttimemillis time processing time processingtime time time max time maxtime max time maxtime time time min time mintime min time mintime time methods handle servlet exception servletexception encountered processing request produce response exceptions occur generation exception report log ged logged swallowed param request request processed param response response generated param exception exception occurred wraps root exception exception request request response response throwable exception request set attribute setattribute request dispatcher requestdispatcher error exception exception response set status setstatus http servlet response httpservletresponse internal server error response set error seterror get processing time getprocessingtime processing time processingtime deprecated unused deprecated set processing time setprocessingtime processing time processingtime processing time processingtime processing time processingtime get max time getmaxtime max time maxtime deprecated unused deprecated set max time setmaxtime max time maxtime max time maxtime max time maxtime get min time getmintime min time mintime deprecated unused deprecated set min time setmintime min time mintime min time mintime min time mintime get request count getrequestcount request count requestcount deprecated unused deprecated set request count setrequestcount request count requestcount request count requestcount request count requestcount get error count geterrorcount error count errorcount increment error count incrementerrorcount error count errorcount deprecated unused deprecated set error count seterrorcount error count errorcount error count errorcount error count errorcount override init internal initinternal lifecycle exception lifecycleexception noop don register valve jmx
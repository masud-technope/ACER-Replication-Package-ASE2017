licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java file org junit assert equals assertequals org junit test org apache catalina wrapper org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest test default instance manager testdefaultinstancemanager tomcat base test tomcatbasetest test test class unloading testclassunloading exception default instance manager defaultinstancemanager instance manager instancemanager do class unloading prep doclassunloadingprep request jsp doesn load tag libraries post construct postconstruct ensure cache retain strong references get url geturl http localhost get port getport test annotations jsp request jsp tag libraries get url geturl http localhost get port getport test bug jsp check number classes cache count instance manager instancemanager get annotation cache size getannotationcachesize request jsp tag libraries get url geturl http localhost get port getport test bug nnnn bug jsp force clear unloaded jsp system spi n spin wait loop loop instance manager instancemanager get annotation cache size getannotationcachesize count thread sleep loop jsp unloaded replaced left change count assert equals assertequals count instance manager instancemanager get annotation cache size getannotationcachesize default instance manager defaultinstancemanager do class unloading prep doclassunloadingprep exception tomcat tomcat get tomcat instance gettomcatinstance create context don add webapp addwebapp modify jsp servlet settings file app dir appdir file test webapp standard context standardcontext ctxt standard context standardcontext tomcat add context addcontext test app dir appdir get absolute path getabsolutepath configure defaults tweak jsp servlet settings note min max loaded jsps maxloadedjsps tomcat init webapp defaults initwebappdefaults ctxt wrapper wrapper ctxt find child findchild jsp add init parameter addinitparameter max loaded jsps maxloadedjsps tomcat start default instance manager defaultinstancemanager ctxt get instance manager getinstancemanager
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util security java security message digest messagedigest java security no such algorithm exception nosuchalgorithmexception java util hash map hashmap java util map java util queue java util concurrent concurrent linked queue concurrentlinkedqueue thread safe wrapper link message digest messagedigest thread local threadlocal broadly creates message digest messagedigest objects satisfy concurrency requirements concurrent message digest concurrentmessagedigest string string sha sha map string queue message digest messagedigest queues hash map hashmap string queue message digest messagedigest concurrent message digest concurrentmessagedigest hide constructor utility init commonly algorithms init init sha no such algorithm exception nosuchalgorithmexception illegal argument exception illegalargumentexception digestmd input digest input digestsha input digest sha input digest string algorithm input queue message digest messagedigest queue queues algorithm queue illegal state exception illegalstateexception call init message digest messagedigest queue poll message digest messagedigest get instance getinstance algorithm no such algorithm exception nosuchalgorithmexception illegal state exception illegalstateexception call init bytes input update bytes result digest queue add result ensures link digest string support algorithm method called link digest string param algorithm message digest algorithm supported no such algorithm exception nosuchalgorithmexception algorithm supported jvm init string algorithm no such algorithm exception nosuchalgorithmexception queues queues contains key containskey algorithm message digest messagedigest message digest messagedigest get instance getinstance algorithm queue message digest messagedigest queue concurrent linked queue concurrentlinkedqueue message digest messagedigest queue add queues algorithm queue
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java io exception ioexception java util arrays java util collection javax servlet async context asynccontext javax servlet request dispatcher requestdispatcher javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test org junit runner run with runwith org junit run ners runners parameterized org junit run ners runners parameterized parameters org apache catalina context org apache catalina wrapper org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache catalina util url encoder urlencoder org apache tomcat util buf byte chunk bytechunk run with runwith parameterized test application context get request dispatcher testapplicationcontextgetrequestdispatcher tomcat base test tomcatbasetest use async useasync test application context get request dispatcher testapplicationcontextgetrequestdispatcher use async useasync use async useasync use async useasync parameters use async useasync collection object data arrays as list aslist object test test get request dispatcher null path testgetrequestdispatchernullpath exception do test get request dispatcher dotestgetrequestdispatcher start target dispatcher servlet dispatcherservlet test test get request dispatcher null path testgetrequestdispatchernullpath exception do test get request dispatcher dotestgetrequestdispatcher start target dispatcher servlet dispatcherservlet test test get request dispatcher out side context root testgetrequestdispatcheroutsidecontextroot exception do test get request dispatcher dotestgetrequestdispatcher start target dispatcher servlet dispatcherservlet test test get request dispatcher out side context root testgetrequestdispatcheroutsidecontextroot exception do test get request dispatcher dotestgetrequestdispatcher start target dispatcher servlet dispatcherservlet test test get request dispatcher encoded traversal testgetrequestdispatcherencodedtraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target dispatcher servlet dispatcherservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher traversal testgetrequestdispatchertraversal exception do test get request dispatcher dotestgetrequestdispatcher prefix start target target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start target prefix target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception expected fail processes unencoded sees target thinks query string tomcat encodes do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception expected fail processes unencoded sees target thinks query string tomcat encodes do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception expected fail processes unencoded sees target thinks query string tomcat encodes do test get request dispatcher dotestgetrequestdispatcher fbb dcc start target fbb dcc target servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher dbb dcc start target dbb dcc target target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc servlet test test get request dispatcher testgetrequestdispatcher exception do test get request dispatcher dotestgetrequestdispatcher prefix start fbb dcc prefix fbb dcc target servlet targetservlet do test get request dispatcher dotestgetrequestdispatcher use encoded dispatch paths useencodeddispatchpaths string start path startpath string start query string startquerystring string dispatch path dispatchpath string target path targetpath string expected body expectedbody exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext test ctx set dispatch ers use encoded paths setdispatchersuseencodedpaths use encoded dispatch paths useencodeddispatchpaths add servlet resources tomcat add servlet addservlet ctx servlet ctx add servlet mapping addservletmapping add target servlet dispatch tomcat add servlet addservlet ctx target target servlet targetservlet note decode path ctx add servlet mapping addservletmapping target path targetpath target use async useasync wrapper tomcat add servlet addservlet ctx async dispatcher servlet asyncdispatcherservlet dispatch path dispatchpath use encoded dispatch paths useencodeddispatchpaths set async supported setasyncsupported tomcat add servlet addservlet ctx dispatcher servlet dispatcherservlet dispatch path dispatchpath note decode path ctx add servlet mapping addservletmapping start path startpath tomcat start string builder stringbuilder url string builder stringbuilder http localhost url append get port getport url append test url append start path startpath start query string startquerystring url append url append start query string startquerystring byte chunk bytechunk get url geturl url to string tostring string body to string tostring assert equals assertequals expected body expectedbody body servlet http servlet httpservlet serialversionuid string override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf resp get writer getwriter print resp set status setstatus dispatcher servlet dispatcherservlet http servlet httpservlet serialversionuid string string dispatch path dispatchpath dispatcher servlet dispatcherservlet string dispatch path dispatchpath dispatch path dispatchpath dispatch path dispatchpath override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception request dispatcher requestdispatcher req get request dispatcher getrequestdispatcher dispatch path dispatchpath resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf resp get writer getwriter print req resp target servlet targetservlet http servlet httpservlet serialversionuid string override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf resp get writer getwriter print string req get query string getquerystring resp get writer getwriter print async dispatcher servlet asyncdispatcherservlet http servlet httpservlet serialversionuid string string dispatch path dispatchpath encode path encodepath async dispatcher servlet asyncdispatcherservlet string dispatch path dispatchpath encode path encodepath dispatch path dispatchpath dispatch path dispatchpath encode path encodepath encode path encodepath override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception async context asynccontext req start async startasync quick dirty sufficient test ignores lots edge cases string target dispatch path dispatchpath target req get servlet path getservletpath last slash lastslash target last index of lastindexof target target substring last slash lastslash encode path encodepath target url encoder urlencoder encode target utf target dispatch path dispatchpath dispatch target unsupported operation exception unsupportedoperationexception uoe complete resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf resp get writer getwriter print
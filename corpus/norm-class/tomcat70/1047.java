licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina session java buffered output stream bufferedoutputstream java byte array output stream bytearrayoutputstream java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream java util array list arraylist java util java util iterator org apache catalina context org apache catalina engine org apache catalina host org apache catalina lifecycle exception lifecycleexception org apache catalina lifecycle state lifecyclestate org apache catalina session org apache catalina cluster manager clustermanager org apache catalina cluster message clustermessage org apache catalina session manager base managerbase org apache catalina tribes member org apache catalina tribes replication stream replicationstream org apache tomcat util exception utils exceptionutils org apache tomcat util res string manager stringmanager delta manager deltamanager manages replicated sessions replicating deltas data applications written handle delta manager deltamanager opt imal optimal replicating data code identical standard manager standardmanager difference per sists persists sessions modifications implementation note correct behavior session storing reloading depends external calls code start code code code methods correct times author filip hanik author craig mc clanahan mcclanahan author jean francois arcand author peter rossbach delta manager deltamanager cluster manager base clustermanagerbase security classes org apache juli logging log log org apache juli logging log factory logfactory get log getlog delta manager deltamanager string manager string manager stringmanager string manager stringmanager get manager getmanager constants instance variables descriptive implementation string info delta manager deltamanager descriptive manager implementation logging string manager name managername delta manager deltamanager string expire sessions on shutdown expiresessionsonshutdown notify session listeners on replication notifysessionlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication state transfered statetransfered no context manager received nocontextmanagerreceived state transfer timeout statetransfertimeout send all sessions sendallsessions send all sessions size sendallsessionssize wait time send session block send all sessions wait time sendallsessionswaittime array list arraylist session message sessionmessage received message queue receivedmessagequeue array list arraylist session message sessionmessage receiver queue receiverqueue state timestamp drop statetimestampdrop state transfer create send time statetransfercreatesendtime stats attributes session replace counter sessionreplacecounter counter receive counterreceive evt sessions counter receive counterreceive evt session data counter receive counterreceive evt session created counter receive counterreceive evt session expired counter receive counterreceive evt session accessed counter receive counterreceive evt session delta counter receive counterreceive evt session transfercomplete counter receive counterreceive evt change session counter receive counterreceive evt session nocontextmanager counter send countersend evt sessions counter send countersend evt session data counter send countersend evt session created counter send countersend evt session delta counter send countersend evt session accessed counter send countersend evt session expired counter send countersend evt session transfercomplete counter send countersend evt change session counter no state transfered counternostatetransfered constructor delta manager deltamanager properties descriptive manager implementation version number format code description version code override string get info getinfo info override set name setname string override string get name getname returns counter send countersend evt sessions get counter send getcountersend evt sessions counter send countersend evt sessions returns counter send countersend evt session accessed get counter send getcountersend evt session accessed counter send countersend evt session accessed returns counter send countersend evt session created get counter send getcountersend evt session created counter send countersend evt session created returns counter send countersend evt session delta get counter send getcountersend evt session delta counter send countersend evt session delta returns counter send countersend evt session expired get counter send getcountersend evt session expired counter send countersend evt session expired returns counter send countersend evt session data get counter send getcountersend evt session data counter send countersend evt session data returns counter send countersend evt session transfercomplete get counter send getcountersend evt session transfercomplete counter send countersend evt session transfercomplete returns counter send countersend evt change session get counter send getcountersend evt change session counter send countersend evt change session returns counter receive counterreceive evt session data get counter receive getcounterreceive evt session data counter receive counterreceive evt session data returns counter receive counterreceive evt sessions get counter receive getcounterreceive evt sessions counter receive counterreceive evt sessions returns counter receive counterreceive evt session accessed get counter receive getcounterreceive evt session accessed counter receive counterreceive evt session accessed returns counter receive counterreceive evt session created get counter receive getcounterreceive evt session created counter receive counterreceive evt session created returns counter receive counterreceive evt session delta get counter receive getcounterreceive evt session delta counter receive counterreceive evt session delta returns counter receive counterreceive evt session expired get counter receive getcounterreceive evt session expired counter receive counterreceive evt session expired returns counter receive counterreceive evt session transfercomplete get counter receive getcounterreceive evt session transfercomplete counter receive counterreceive evt session transfercomplete returns counter receive counterreceive evt change session get counter receive getcounterreceive evt change session counter receive counterreceive evt change session returns counter receive counterreceive evt session nocontextmanager get counter receive getcounterreceive evt session nocontextmanager counter receive counterreceive evt session nocontextmanager returns processing time processingtime override get processing time getprocessingtime processing time processingtime returns session replace counter sessionreplacecounter get session replace counter getsessionreplacecounter session replace counter sessionreplacecounter returns counter no state transfered counternostatetransfered get counter no state transfered getcounternostatetransfered counter no state transfered counternostatetransfered get received queue size getreceivedqueuesize received message queue receivedmessagequeue size returns state transfer timeout statetransfertimeout get state transfer timeout getstatetransfertimeout state transfer timeout statetransfertimeout param timeout all session timeoutallsession timeout set state transfer timeout setstatetransfertimeout timeout all session timeoutallsession state transfer timeout statetransfertimeout timeout all session timeoutallsession session transfered complete get state transfered getstatetransfered state transfered statetransfered is t ist complete transfered param state transfered statetransfered set state transfered setstatetransfered state transfered statetransfered state transfered statetransfered state transfered statetransfered is no context manager received isnocontextmanagerreceived no context manager received nocontextmanagerreceived set no context manager received setnocontextmanagerreceived no context manager received nocontextmanagerreceived no context manager received nocontextmanagerreceived no context manager received nocontextmanagerreceived returns send all sessions wait time sendallsessionswaittime msec get send all sessions wait time getsendallsessionswaittime send all sessions wait time sendallsessionswaittime param send all sessions wait time sendallsessionswaittime send all sessions wait time sendallsessionswaittime msec set send all sessions wait time setsendallsessionswaittime send all sessions wait time sendallsessionswaittime send all sessions wait time sendallsessionswaittime send all sessions wait time sendallsessionswaittime returns state timestamp drop statetimestampdrop is state timestamp drop isstatetimestampdrop state timestamp drop statetimestampdrop param is timestamp drop istimestampdrop flag set state timestamp drop setstatetimestampdrop is timestamp drop istimestampdrop state timestamp drop statetimestampdrop is timestamp drop istimestampdrop returns send all sessions sendallsessions is send all sessions issendallsessions send all sessions sendallsessions param send all sessions sendallsessions send all sessions sendallsessions set send all sessions setsendallsessions send all sessions sendallsessions send all sessions sendallsessions send all sessions sendallsessions returns send all sessions size sendallsessionssize get send all sessions size getsendallsessionssize send all sessions size sendallsessionssize param send all sessions size sendallsessionssize send all sessions size sendallsessionssize set send all sessions size setsendallsessionssize send all sessions size sendallsessionssize send all sessions size sendallsessionssize send all sessions size sendallsessionssize returns notify session listeners on replication notifysessionlistenersonreplication is notify session listeners on replication isnotifysessionlistenersonreplication notify session listeners on replication notifysessionlistenersonreplication param notify listeners create session on replication notifylistenerscreatesessiononreplication notify session listeners on replication notifysessionlistenersonreplication set notify session listeners on replication setnotifysessionlistenersonreplication notify listeners create session on replication notifylistenerscreatesessiononreplication notify session listeners on replication notifysessionlistenersonreplication notify listeners create session on replication notifylistenerscreatesessiononreplication is expire sessions on shutdown isexpiresessionsonshutdown expire sessions on shutdown expiresessionsonshutdown set expire sessions on shutdown setexpiresessionsonshutdown expire sessions on shutdown expiresessionsonshutdown expire sessions on shutdown expiresessionsonshutdown expire sessions on shutdown expiresessionsonshutdown is notify container listeners on replication isnotifycontainerlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication set notify container listeners on replication setnotifycontainerlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication methods override session create session createsession string session id sessionid create session createsession session id sessionid create session check max active sessions maxactivesessions send session creation cluster nodes param distribute session session create session createsession string session id sessionid distribute delta session deltasession session delta session deltasession create session createsession session id sessionid distribute send create session sendcreatesession session get id getid session log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create session createsession new session newsession session get id getid integer value of valueof sessions size session send create session evt backup node param session id sessionid param session send create session sendcreatesession string session id sessionid delta session deltasession session cluster get members getmembers length session message sessionmessage msg session message impl sessionmessageimpl get name getname session message sessionmessage evt session created session id sessionid session id sessionid system current time millis currenttimemillis log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager send message sendmessage new session newsession session id sessionid msg set timestamp settimestamp session get creation time getcreationtime counter send countersend evt session created send msg send messages backup member domain param msg session message send session message sessionmessage msg cluster cluster send msg inherit doc inheritdoc creates delta session deltasession instance override session create empty session createemptysession get new delta session getnewdeltasession session do load doload method delta session deltasession get new delta session getnewdeltasession delta session deltasession override change session id changesessionid session session change session id changesessionid session change session id changesessionid session session notify original sessionid string org session d orgsessionid session get id getid change session id changesessionid session notify cluster get members getmembers length changed sessionid string new session d newsessionid session get id getid serialize sessionid data serialize session id serializesessionid new session d newsessionid notify change sessionid session message sessionmessage msg session message impl sessionmessageimpl get name getname session message sessionmessage evt change session data org session d orgsessionid org session d orgsessionid system current time millis currenttimemillis msg set timestamp settimestamp system current time millis currenttimemillis counter send countersend evt change session send msg io exception ioexception log error get string getstring delta manager deltamanager unable serialize session d unableserializesessionid new session d newsessionid serialize sessionid io exception ioexception input output error occurs serialize session id serializesessionid string session id sessionid io exception ioexception byte array output stream bytearrayoutputstream bos byte array output stream bytearrayoutputstream object output stream objectoutputstream oos object output stream objectoutputstream bos oos writeutf session id sessionid oos flush oos close bos to byte array tobytearray load sessionid io exception ioexception input output error occurs string deserialize session id deserializesessionid data io exception ioexception replication stream replicationstream ois get replication stream getreplicationstream data string session id sessionid ois readutf ois close session id sessionid load delta request deltarequest external node load container class loader classloader delta request deltarequest read external readexternal java object input objectinput param session param data message data request class not found exception classnotfoundexception io exception ioexception delta request deltarequest deserialize delta request deserializedeltarequest delta session deltasession session data class not found exception classnotfoundexception io exception ioexception session lock replication stream replicationstream ois get replication stream getreplicationstream data session get delta request getdeltarequest read external readexternal ois ois close session get delta request getdeltarequest session unlock serialize delta request deltarequest delta request deltarequest write external writeexternal java object output objectoutput param delta request deltarequest serialized delta request io exception ioexception serialize delta request serializedeltarequest delta session deltasession session delta request deltarequest delta request deltarequest io exception ioexception session lock delta request deltarequest serialize session unlock load sessions cluster node fixme replace sessions not ification notification fixme sso handling correct session replacement exception class not found exception classnotfoundexception serialized reload exception io exception ioexception input output error occurs deserialize sessions deserializesessions data class not found exception classnotfoundexception io exception ioexception initialize internal data str uctures structures sessions clear open input stream path name pathname class loader classloader original loader originalloader thread current thread currentthread get context class loader getcontextclassloader object input stream objectinputstream ois load unloaded active sessions ois get replication stream getreplicationstream data integer count integer ois read object readobject count int value intvalue delta session deltasession session delta session deltasession create empty session createemptysession session read object data readobjectdata ois session set manager setmanager session set valid setvalid session set primary session setprimarysession nodes cluster time synch correct timestamp is valid isvalid returns access count accesscount session access session ready expire needed session set access count setaccesscount session reset delta request resetdeltarequest increment session counter sessioncounter correct stats report find session findsession session get id internal getidinternal session counter sessioncounter session replace counter sessionreplacecounter fixme grap sessions log is warn enabled iswarnenabled log warn get string getstring delta manager deltamanager loading existing session session get id internal getidinternal add session notify session listeners on replication notifysessionlistenersonreplication session tell new tellnew class not found exception classnotfoundexception log error get string getstring delta manager deltamanager loading cnfe io exception ioexception log error get string getstring delta manager deltamanager loading ioe close input stream ois ois close io exception ioexception ois original loader originalloader thread current thread currentthread set context class loader setcontextclassloader original loader originalloader save active sessions persistence mechanism persistence supported method returns exception io exception ioexception input output error occurs serialize sessions serializesessions session current sessions currentsessions io exception ioexception open output stream path name pathname byte array output stream bytearrayoutputstream fos object output stream objectoutputstream oos fos byte array output stream bytearrayoutputstream oos object output stream objectoutputstream buffered output stream bufferedoutputstream fos oos write object writeobject integer value of valueof current sessions currentsessions length current sessions currentsessions length delta session deltasession current sessions currentsessions write object data writeobjectdata oos flush close output stream oos flush io exception ioexception log error get string getstring delta manager deltamanager unloading ioe oos oos close io exception ioexception oos send object data fos to byte array tobytearray start component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception start internal startinternal load unloaded sessions cluster log error get string getstring delta manager deltamanager no cluster nocluster get name getname log is info enabled isinfoenabled string type unknown cluster get container getcontainer host type host cluster get container getcontainer engine type engine log info get string getstring delta manager deltamanager register cluster registercluster get name getname type cluster get cluster name getclustername log is info enabled isinfoenabled log info get string getstring delta manager deltamanager start clustering startclustering get name getname get all cluster sessions getallclustersessions throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring delta manager deltamanager manager load managerload set state setstate lifecycle state lifecyclestate starting session master backup clustered sessions find session master member findsessionmastermember get all cluster sessions getallclustersessions cluster cluster get members getmembers length before send time beforesendtime system current time millis currenttimemillis member mbr find session master member findsessionmastermember mbr domain member session message sessionmessage msg session message impl sessionmessageimpl get name getname session message sessionmessage evt sessions get name getname msg set timestamp settimestamp before send time beforesendtime reference time state transfer create send time statetransfercreatesendtime before send time beforesendtime request session counter send countersend evt sessions state transfered statetransfered fixme send call block deploy thread sender wait for ack waitforack enabled received message queue receivedmessagequeue receiver queue receiverqueue cluster send msg mbr log is info enabled isinfoenabled log info get string getstring delta manager deltamanager wait for session state waitforsessionstate get name getname mbr integer value of valueof get state transfer timeout getstatetransfertimeout fixme sender ack mode method check transfer res end resend problem wait for send all sessions waitforsendallsessions before send time beforesendtime received message queue receivedmessagequeue iterator session message sessionmessage iter received message queue receivedmessagequeue iterator iter has next hasnext session message sessionmessage smsg iter state timestamp drop statetimestampdrop message received messagereceived smsg smsg get address getaddress member smsg get address getaddress smsg get event type geteventtype session message sessionmessage evt sessions smsg get timestamp gettimestamp state transfer create send time statetransfercreatesendtime fixme handle evt sessions message received messagereceived smsg smsg get address getaddress member smsg get address getaddress log is warn enabled iswarnenabled log warn get string getstring delta manager deltamanager drop message dropmessage get name getname smsg get event type string geteventtypestring state transfer create send time statetransfercreatesendtime smsg get timestamp gettimestamp received message queue receivedmessagequeue clear receiver queue receiverqueue log is info enabled isinfoenabled log info get string getstring delta manager deltamanager no members nomembers get name getname find master session master member sessions member find session master member findsessionmastermember member mbr member mbrs cluster get members getmembers mbrs length mbr mbrs mbr log is warn enabled iswarnenabled log warn get string getstring delta manager deltamanager no master member nomastermember get name getname mbr log is debug enabled isdebugenabled log warn get string getstring delta manager deltamanager found master member foundmastermember get name getname mbr mbr wait cluster session transfer timeout state transfer timeout statetransfertimeout wait backup transfered mode wait for send all sessions waitforsendallsessions before send time beforesendtime req start reqstart system current time millis currenttimemillis req now reqnow req start reqstart is timeout istimeout get state transfer timeout getstatetransfertimeout wait transfered timeout check thread sleep exception sleep req now reqnow system current time millis currenttimemillis is timeout istimeout req now reqnow req start reqstart get state transfer timeout getstatetransfertimeout get state transfered getstatetransfered is timeout istimeout is no context manager received isnocontextmanagerreceived get state transfer timeout getstatetransfertimeout wait transfered thread sleep exception sleep get state transfered getstatetransfered is no context manager received isnocontextmanagerreceived req now reqnow system current time millis currenttimemillis is timeout istimeout counter no state transfered counternostatetransfered log error get string getstring delta manager deltamanager no session state nosessionstate get name getname before send time beforesendtime value of valueof req now reqnow before send time beforesendtime is no context manager received isnocontextmanagerreceived log is warn enabled iswarnenabled log warn get string getstring delta manager deltamanager no context manager nocontextmanager get name getname before send time beforesendtime value of valueof req now reqnow before send time beforesendtime log is info enabled isinfoenabled log info get string getstring delta manager deltamanager session received sessionreceived get name getname before send time beforesendtime value of valueof req now reqnow before send time beforesendtime component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override stop internal stopinternal lifecycle exception lifecycleexception log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager stopped get name getname set state setstate lifecycle state lifecyclestate stopping expire active sessions log is info enabled isinfoenabled log info get string getstring delta manager deltamanager expire sessions expiresessions get name getname session sessions find sessions findsessions sessions length delta session deltasession session delta session deltasession sessions session is valid isvalid session expire is expire sessions on shutdown isexpiresessionsonshutdown throwable exception utils exceptionutils handle throwable handlethrowable require random number generator res tarted restarted stop internal stopinternal replication methods message received node callback method implement int erested interested receiving replication messages param cmsg message received override message data received messagedatareceived cluster message clustermessage cmsg cmsg cmsg session message sessionmessage session message sessionmessage msg session message sessionmessage cmsg msg get event type geteventtype session message sessionmessage evt sessions session message sessionmessage evt session created session message sessionmessage evt session expired session message sessionmessage evt session accessed session message sessionmessage evt session delta session message sessionmessage evt change session received message queue receivedmessagequeue receiver queue receiverqueue received message queue receivedmessagequeue add msg didn queue message received messagereceived msg msg get address getaddress member msg get address getaddress request completed replication valve notify manager manager decide replication needed replication manager create session message replicated cluster determines param session id sessionid session id sessionid completed session message sessionmessage override cluster message clustermessage request completed requestcompleted string session id sessionid request completed requestcompleted session id sessionid request completed replication valve notify manager manager decide replication needed replication manager create session message replicated cluster determines session expiration calls method expires param session id sessionid session id sessionid completed param expires method called session expiration session message sessionmessage cluster message clustermessage request completed requestcompleted string session id sessionid expires delta session deltasession session session message sessionmessage msg session delta session deltasession find session findsession session id sessionid session removed session manager delta request deltarequest delta request deltarequest session get delta request getdeltarequest session lock delta request deltarequest get size getsize counter send countersend evt session delta data serialize delta request serializedeltarequest session delta request deltarequest msg session message impl sessionmessageimpl get name getname session message sessionmessage evt session delta data session id sessionid session id sessionid system current time millis currenttimemillis session reset delta request resetdeltarequest io exception ioexception log error get string getstring delta manager deltamanager create message createmessage unable create delta request unablecreatedeltarequest session id sessionid session session unlock msg expires session is primary session isprimarysession counter send countersend evt session accessed msg session message impl sessionmessageimpl get name getname session message sessionmessage evt session accessed session id sessionid session id sessionid system current time millis currenttimemillis log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage access change primary accesschangeprimary get name getname session id sessionid log synch block log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage delta get name getname session id sessionid expires session set primary session setprimarysession check send access message expires msg repl delta repldelta system current time millis currenttimemillis session get last time replicated getlasttimereplicated session get max inactive interval getmaxinactiveinterval repl delta repldelta session get max inactive interval getmaxinactiveinterval counter send countersend evt session accessed msg session message impl sessionmessageimpl get name getname session message sessionmessage evt session accessed session id sessionid session id sessionid system current time millis currenttimemillis log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage access get name getname session id sessionid update replicated time msg session set last time replicated setlasttimereplicated system current time millis currenttimemillis msg set timestamp settimestamp session get last time replicated getlasttimereplicated msg reset manager statistics reset statistics resetstatistics processing time processingtime expired sessions expiredsessions session creation timing sessioncreationtiming session creation timing sessioncreationtiming clear session creation timing sessioncreationtiming size manager base managerbase timing stats cache size session creation timing sessioncreationtiming add session expiration timing sessionexpirationtiming session expiration timing sessionexpirationtiming clear session expiration timing sessionexpirationtiming size manager base managerbase timing stats cache size session expiration timing sessionexpirationtiming add rejected sessions rejectedsessions session replace counter sessionreplacecounter counter no state transfered counternostatetransfered set max active setmaxactive get active sessions getactivesessions session counter sessioncounter get active sessions getactivesessions counter receive counterreceive evt session data counter receive counterreceive evt sessions counter receive counterreceive evt session accessed counter receive counterreceive evt session created counter receive counterreceive evt session delta counter receive counterreceive evt session expired counter receive counterreceive evt session transfercomplete counter receive counterreceive evt change session counter send countersend evt session data counter send countersend evt sessions counter send countersend evt session accessed counter send countersend evt session created counter send countersend evt session delta counter send countersend evt session expired counter send countersend evt session transfercomplete counter send countersend evt change session expire send session expired cluster nodes param session session expired sessionexpired string cluster get members getmembers length counter send countersend evt session expired session message sessionmessage msg session message impl sessionmessageimpl get name getname session message sessionmessage evt session expired expired msg msg set timestamp settimestamp system current time millis currenttimemillis log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage expire get name getname send msg expire find sessions expire all local sessions expirealllocalsessions time now timenow system current time millis currenttimemillis session sessions find sessions findsessions expire direct expiredirect expire indirect expireindirect log is debug enabled isdebugenabled log debug start expire sessions get name getname time now timenow session count sessioncount sessions length sessions length sessions delta session deltasession delta session deltasession session delta session deltasession sessions session is primary session isprimarysession session is valid isvalid session expire expire direct expiredirect expire indirect expireindirect time end timeend system current time millis currenttimemillis log is debug enabled isdebugenabled log debug expire sessions get name getname expire processing time processingtime time end timeend time now timenow expired direct sessions expire direct expiredirect expired direct sessions expire indirect expireindirect override string get invalid ated sessions getinvalidatedsessions string message receive method called received thread session message sessionmessage received nodes cluster param msg message received param sender sender message receive evt session message reply req uesting requesting node message received messagereceived session message sessionmessage msg member sender class loader classloader context loader contextloader thread current thread currentthread get context class loader getcontextclassloader class loader classloader load ers loaders get class loaders getclassloaders thread current thread currentthread set context class loader setcontextclassloader load ers loaders log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage event type eventtype get name getname msg get event type string geteventtypestring sender msg get event type geteventtype session message sessionmessage evt sessions handleget sessions msg sender session message sessionmessage evt session data handleall session data msg sender session message sessionmessage evt session transfercomplete handleall session transfercomplete msg sender session message sessionmessage evt session created handlesession created msg sender session message sessionmessage evt session expired handlesession expired msg sender session message sessionmessage evt session accessed handlesession accessed msg sender session message sessionmessage evt session delta handlesession delta msg sender session message sessionmessage evt change session handlechange session msg sender session message sessionmessage evt session nocontextmanager handleall session nocontextmanager msg sender didn recognize message type exception log error get string getstring delta manager deltamanager receive message receivemessage error get name getname thread current thread currentthread set context class loader setcontextclassloader context loader contextloader message receiver handler handle receive session complete transfered param msg param sender handleall session transfercomplete session message sessionmessage msg member sender counter receive counterreceive evt session transfercomplete log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage transfer complete transfercomplete get name getname sender get host gethost integer value of valueof sender get port getport state transfer create send time statetransfercreatesendtime msg get timestamp gettimestamp state transfered statetransfered handle receive session delta param msg param sender io exception ioexception class not found exception classnotfoundexception handlesession delta session message sessionmessage msg member sender io exception ioexception class not found exception classnotfoundexception counter receive counterreceive evt session delta delta msg get session getsession delta session deltasession session delta session deltasession find session findsession msg get session d getsessionid session log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage delta get name getname msg get session d getsessionid session lock delta request deltarequest dreq deserialize delta request deserializedeltarequest session delta dreq execute session is notify listeners on replication isnotifylistenersonreplication session set primary session setprimarysession session unlock handle receive session access node primary session param msg param sender io exception ioexception handlesession accessed session message sessionmessage msg member sender io exception ioexception counter receive counterreceive evt session accessed delta session deltasession session delta session deltasession find session findsession msg get session d getsessionid session log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage accessed get name getname msg get session d getsessionid session access session set primary session setprimarysession session end access endaccess handle receive session expire node expire session param msg param sender io exception ioexception handlesession expired session message sessionmessage msg member sender io exception ioexception counter receive counterreceive evt session expired delta session deltasession session delta session deltasession find session findsession msg get session d getsessionid session log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage expired get name getname msg get session d getsessionid session expire notify session listeners on replication notifysessionlistenersonreplication handle receive session created node create backup primary param msg param sender handlesession created session message sessionmessage msg member sender counter receive counterreceive evt session created log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage create new session createnewsession get name getname msg get session d getsessionid delta session deltasession session delta session deltasession create empty session createemptysession session set manager setmanager session set valid setvalid session set primary session setprimarysession session set creation time setcreationtime msg get timestamp gettimestamp container max inactive interval maxinactiveinterval session expire correctly primary transfer session set max inactive interval setmaxinactiveinterval context get container getcontainer get session timeout getsessiontimeout session access session set id setid msg get session d getsessionid notify session listeners on replication notifysessionlistenersonreplication session reset delta request resetdeltarequest session end access endaccess handle receive sessions restart param msg param sender class not found exception classnotfoundexception io exception ioexception handleall session data session message sessionmessage msg member sender class not found exception classnotfoundexception io exception ioexception counter receive counterreceive evt session data log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage all session data begin allsessiondatabegin get name getname data msg get session getsession deserialize sessions deserializesessions data log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage all session data after allsessiondataafter get name getname state transfer red statetransferred handle receive node sessions restart send sessions message send session blocks sending send complete transfered param msg param sender io exception ioexception handleget sessions session message sessionmessage msg member sender io exception ioexception counter receive counterreceive evt sessions list session manager log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage unloading begin unloadingbegin get name getname write number active sessions details sessions serialize sync session current sessions currentsessions find sessions findsessions find session timestamp findsessiontimestamp system current time millis currenttimemillis is send all sessions issendallsessions send sessions sendsessions sender current sessions currentsessions find session timestamp findsessiontimestamp send session blocks remain current sessions currentsessions length current sessions currentsessions length get send all sessions size getsendallsessionssize len get send all sessions size getsendallsessionssize current sessions currentsessions length current sessions currentsessions length get send all sessions size getsendallsessionssize session send sessions sendsessions session len system arraycopy current sessions currentsessions send sessions sendsessions len send sessions sendsessions sender send sessions sendsessions find session timestamp findsessiontimestamp remain remain len get send all sessions wait time getsendallsessionswaittime remain thread sleep get send all sessions wait time getsendallsessionswaittime exception sleep session message sessionmessage new msg newmsg session message impl sessionmessageimpl session message sessionmessage evt session transfercomplete session transfered session transfered get name getname new msg newmsg set timestamp settimestamp find session timestamp findsessiontimestamp log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage all session transfered allsessiontransfered get name getname counter send countersend evt session transfercomplete cluster send new msg newmsg sender handle receive change sessionid node param msg param sender io exception ioexception handlechange session session message sessionmessage msg member sender io exception ioexception counter receive counterreceive evt change session delta session deltasession session delta session deltasession find session findsession msg get session d getsessionid session string new session d newsessionid deserialize session id deserializesessionid msg get session getsession session set primary session setprimarysession session set id setid new session d newsessionid notify container listeners on replication notifycontainerlistenersonreplication get container getcontainer fire container event firecontainerevent context change session event string msg get session d getsessionid new session d newsessionid handle receive context manager param msg param sender handleall session nocontextmanager session message sessionmessage msg member sender counter receive counterreceive evt session nocontextmanager log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage no context manager nocontextmanager get name getname sender get host gethost integer value of valueof sender get port getport no context manager received nocontextmanagerreceived send block session sender param sender param current sessions currentsessions param send timestamp sendtimestamp io exception ioexception send sessions sendsessions member sender session current sessions currentsessions send timestamp sendtimestamp io exception ioexception data serialize sessions serializesessions current sessions currentsessions log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager receive message receivemessage unloading after unloadingafter get name getname session message sessionmessage new msg newmsg session message impl sessionmessageimpl session message sessionmessage evt session data data session session get name getname new msg newmsg set timestamp settimestamp send timestamp sendtimestamp log is debug enabled isdebugenabled log debug get string getstring delta manager deltamanager create message createmessage all session data allsessiondata get name getname counter send countersend evt session data cluster send new msg newmsg sender override cluster manager clustermanager clone from template clonefromtemplate delta manager deltamanager result delta manager deltamanager clone result result expire sessions on shutdown expiresessionsonshutdown expire sessions on shutdown expiresessionsonshutdown result notify session listeners on replication notifysessionlistenersonreplication notify session listeners on replication notifysessionlistenersonreplication result notify container listeners on replication notifycontainerlistenersonreplication notify container listeners on replication notifycontainerlistenersonreplication result state transfer timeout statetransfertimeout state transfer timeout statetransfertimeout result send all sessions sendallsessions send all sessions sendallsessions result send all sessions size sendallsessionssize send all sessions size sendallsessionssize result send all sessions wait time sendallsessionswaittime send all sessions wait time sendallsessionswaittime result state timestamp drop statetimestampdrop state timestamp drop statetimestampdrop result
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net java security access controller accesscontroller java security privileged action privilegedaction java util array list arraylist java util hash map hashmap java util hash set hashset java util iterator java util map java util java util concurrent concurrent hash map concurrenthashmap java util concurrent concurrent linked queue concurrentlinkedqueue java util concurrent executor java util concurrent rejected execution exception rejectedexecutionexception java util concurrent atomic atomic integer atomicinteger org apache juli logging log org apache juli logging log factory logfactory org apache tomcat jni address org apache tomcat jni error org apache tomcat jni file org apache tomcat jni library org apache tomcat jni org apache tomcat jni poll org apache tomcat jni pool org apache tomcat jni ssl org apache tomcat jni ssl context sslcontext org apache tomcat jni ssl socket sslsocket org apache tomcat jni sockaddr org apache tomcat jni socket org apache tomcat jni status org apache tomcat util exception utils exceptionutils org apache tomcat util net abstract endpoint abstractendpoint acceptor acceptor state acceptorstate org apache tomcat util net abstract endpoint abstractendpoint handler socket state socketstate org apache tomcat util security privileged set tccl privilegedsettccl apr tail ored tailored thread pool providing services socket accept or acceptor thread socket poller thread sendfile thread worker threads pool switching java opportunity virtual machine thread pool author mladen turk author remy maucherat apr endpoint aprendpoint abstract endpoint abstractendpoint constants log log log factory logfactory get log getlog apr endpoint aprendpoint string ssl proto hash set hashset string ssl protocol sslprotocol configured ssl protocol sslprotocol ssl proto add constants ssl proto tls v tlsv ssl proto add constants ssl proto tls v tlsv ssl proto add constants ssl proto tls v tlsv fields root apr memory pool root pool rootpool server socket pointer server sock serversock apr memory pool server socket server sock pool serversockpool ssl context ssl context sslcontext concurrent linked queue concurrentlinkedqueue socket wrapper socketwrapper waiting requests waitingrequests concurrent linked queue concurrentlinkedqueue socket wrapper socketwrapper override remove waiting request removewaitingrequest socket wrapper socketwrapper socket wrapper socketwrapper waiting requests waitingrequests remove socket wrapper socketwrapper map apr socket wrapper aprsocketwrapper connections concurrent hash map concurrenthashmap apr socket wrapper aprsocketwrapper apr endpoint aprendpoint override max connections maxconnections align poller size pollersize merged set max connections setmaxconnections properties defer accept defer accept deferaccept set defer accept setdeferaccept defer accept deferaccept defer accept deferaccept defer accept deferaccept override get defer accept getdeferaccept defer accept deferaccept size sendfile concurrent files served sendfile size sendfilesize set sendfile size setsendfilesize sendfile size sendfilesize sendfile size sendfilesize sendfile size sendfilesize get sendfile size getsendfilesize sendfile size sendfilesize handling accepted sockets handler handler set handler sethandler handler handler handler handler handler get handler gethandler handler poll int erval interval microseconds smaller cpu poller resp onsive responsive activity poll time polltime get poll time getpolltime poll time polltime set poll time setpolltime poll time polltime poll time polltime poll time polltime poll time polltime sendfile sending files use sendfile usesendfile library apr sendfile set use sendfile setusesendfile use sendfile usesendfile use sendfile usesendfile use sendfile usesendfile override get use sendfile getusesendfile use sendfile usesendfile comet request handling use comet usecomet set use comet setusecomet use comet usecomet use comet usecomet use comet usecomet override get use comet getusecomet use comet usecomet override get use comet timeout getusecomettimeout supported override get use polling getusepolling supported sendfile thread count sendfile thread count sendfilethreadcount set sendfile thread count setsendfilethreadcount sendfile thread count sendfilethreadcount sendfile thread count sendfilethreadcount sendfile thread count sendfilethreadcount get sendfile thread count getsendfilethreadcount sendfile thread count sendfilethreadcount socket poller poller poller poller get poller getpoller poller socket poller async timeout asynctimeout async timeout asynctimeout async timeout asynctimeout get async timeout getasynctimeout async timeout asynctimeout file sender sendfile sendfile sendfile get sendfile getsendfile sendfile ssl protocols string ssl protocol sslprotocol string getsslprotocol ssl protocol sslprotocol setsslprotocol string ssl protocol sslprotocol ssl protocol sslprotocol ssl protocol sslprotocol ssl password cert encrypted password callback password string ssl password sslpassword string getsslpassword ssl password sslpassword setsslpassword string ssl password sslpassword ssl password sslpassword ssl password sslpassword ssl cipher suite string ssl cipher suite sslciphersuite high anull enull export des krsa string getsslciphersuite ssl cipher suite sslciphersuite setsslciphersuite string ssl cipher suite sslciphersuite ssl cipher suite sslciphersuite ssl cipher suite sslciphersuite ssl certificate file string ssl certificate file sslcertificatefile string getsslcertificatefile ssl certificate file sslcertificatefile setsslcertificatefile string ssl certificate file sslcertificatefile ssl certificate file sslcertificatefile ssl certificate file sslcertificatefile ssl certificate key file string ssl certificate key file sslcertificatekeyfile string getsslcertificatekeyfile ssl certificate key file sslcertificatekeyfile setsslcertificatekeyfile string ssl certificate key file sslcertificatekeyfile ssl certificate key file sslcertificatekeyfile ssl certificate key file sslcertificatekeyfile ssl certificate chain file string ssl certificate chain file sslcertificatechainfile string getsslcertificatechainfile ssl certificate chain file sslcertificatechainfile setsslcertificatechainfile string ssl certificate chain file sslcertificatechainfile ssl certificate chain file sslcertificatechainfile ssl certificate chain file sslcertificatechainfile ssl certificate path string ssl ca certificate path sslcacertificatepath string getsslcacertificatepath ssl ca certificate path sslcacertificatepath setsslcacertificatepath string ssl ca certificate path sslcacertificatepath ssl ca certificate path sslcacertificatepath ssl ca certificate path sslcacertificatepath ssl certificate file string ssl ca certificate file sslcacertificatefile string getsslcacertificatefile ssl ca certificate file sslcacertificatefile setsslcacertificatefile string ssl ca certificate file sslcacertificatefile ssl ca certificate file sslcacertificatefile ssl ca certificate file sslcacertificatefile ssl revocation path string ssl ca revocation path sslcarevocationpath string getsslcarevocationpath ssl ca revocation path sslcarevocationpath setsslcarevocationpath string ssl ca revocation path sslcarevocationpath ssl ca revocation path sslcarevocationpath ssl ca revocation path sslcarevocationpath ssl revocation file string ssl ca revocation file sslcarevocationfile string getsslcarevocationfile ssl ca revocation file sslcarevocationfile setsslcarevocationfile string ssl ca revocation file sslcarevocationfile ssl ca revocation file sslcarevocationfile ssl ca revocation file sslcarevocationfile ssl verify client string ssl verify client sslverifyclient string getsslverifyclient ssl verify client sslverifyclient setsslverifyclient string ssl verify client sslverifyclient ssl verify client sslverifyclient ssl verify client sslverifyclient ssl verify depth ssl verify depth sslverifydepth getsslverifydepth ssl verify depth sslverifydepth setsslverifydepth ssl verify depth sslverifydepth ssl verify depth sslverifydepth ssl verify depth sslverifydepth ssl ins ecure insecure renegotiation client support secure renegotiation ssl ins ecure renegotiation sslinsecurerenegotiation setsslinsecurerenegotiation ssl ins ecure renegotiation sslinsecurerenegotiation ssl ins ecure renegotiation sslinsecurerenegotiation ssl ins ecure renegotiation sslinsecurerenegotiation getsslinsecurerenegotiation ssl ins ecure renegotiation sslinsecurerenegotiation ssl honor cipher order sslhonorcipherorder code code enforce server cipher order client choose preferred cipher setsslhonorcipherorder ssl honor cipher order sslhonorcipherorder ssl honor cipher order sslhonorcipherorder ssl honor cipher order sslhonorcipherorder getsslhonorcipherorder ssl honor cipher order sslhonorcipherorder disables compression ssl stream thwarts crime att ack attack imp roves improves performance comp res sing compressing uncompressible content jpeg ssl disable compression ssldisablecompression code code disable ssl compression thwarts crime att ack attack setssldisablecompression ssl disable compression ssldisablecompression ssl disable compression ssldisablecompression ssl disable compression ssldisablecompression getssldisablecompression ssl disable compression ssldisablecompression port override get local port getlocalport server sock serversock address socket apr local sockaddr add r addr address get info getinfo add r addr port exception endpoint support code code unlimited connections support setting attribute endpoint running inherit doc inheritdoc override set max connections setmaxconnections max connections maxconnections max connections maxconnections log warn get string getstring endpoint apr max connections maxconnections unlimited integer value of valueof get max connections getmaxconnections running log warn get string getstring endpoint apr max connections maxconnections running integer value of valueof get max connections getmaxconnections set max connections setmaxconnections max connections maxconnections methods number keep alive keepalive sockets get keep alive count getkeepalivecount poller poller get connection count getconnectioncount number sendfile sockets get sendfile count getsendfilecount sendfile sendfile get sendfile count getsendfilecount lifecycle methods initialize endpoint override bind exception create root apr memory pool root pool rootpool pool create unsatisfied link error unsatisfiedlinkerror exception get string getstring endpoint init not avail notavail create pool server socket server sock pool serversockpool pool create root pool rootpool create apr add ress address bound string add ress str addressstr get address getaddress add ress str addressstr get address getaddress get host address gethostaddress family socket apr inet library apr ipv add ress str addressstr bsd win win family socket apr unspec add ress str addressstr index of indexof family socket apr unspec inet address inetaddress address info add ress str addressstr family get port getport root pool rootpool create apr server socket server sock serversock socket create address get info getinfo inet address inetaddress family socket s ock sock stream socket apr proto tcp root pool rootpool unix socket opt set optset server sock serversock socket apr reuseaddr deal fire walls firewalls tend drop inactive sockets socket opt set optset server sock serversock socket apr keep alive keepalive bind server socket ret socket bind server sock serversock inet address inetaddress ret exception get string getstring endpoint init bind ret error str error strerror ret start list ening listening server socket ret socket listen server sock serversock get backlog getbacklog ret exception get string getstring endpoint init listen ret error str error strerror ret win win windows reuse addr reuseaddr flag bind listen socket opt set optset server sock serversock socket apr reuseaddr sendfile usage systems don support major problems use sendfile usesendfile library apr sendfile use sendfile usesendfile initialize thread count accept or acceptor accept or thread count acceptorthreadcount fixme does n doesn work multiple accept threads accept or thread count acceptorthreadcount platforms call noop apr enotimpl defer accept deferaccept socket opt set optset server sock serversock socket apr tcp defer accept status apr enotimpl defer accept deferaccept initialize ssl needed issslenabled ssl certificate file sslcertificatefile required exception get string getstring endpoint apr no ssl cert file nosslcertfile ssl protocol ssl ssl protocol ssl protocol sslprotocol ssl protocol sslprotocol length ssl ssl protocol string protocols hash set hashset string capture check string protocol ssl protocol sslprotocol split string trimmed protocol trim ignore token consists prefix character trimmed length trimmed char at charat trimmed trimmed substring trim trimmed equals ignore case equalsignorecase constants ssl proto protocols remove all removeall ssl proto protocols remove trimmed trimmed char at charat trimmed trimmed substring trim trimmed equals ignore case equalsignorecase constants ssl proto protocols add all addall ssl proto protocols add trimmed string protocol protocols constants ssl proto ssl v sslv equals ignore case equalsignorecase protocol ssl ssl protocol ssl v sslv constants ssl proto ssl v sslv equals ignore case equalsignorecase protocol ssl ssl protocol ssl v sslv constants ssl proto tls v tlsv equals ignore case equalsignorecase protocol ssl ssl protocol tlsv constants ssl proto tls v tlsv equals ignore case equalsignorecase protocol ssl ssl protocol tlsv constants ssl proto tls v tlsv equals ignore case equalsignorecase protocol ssl ssl protocol tlsv required exception get string getstring endpoint apr invalid ssl protocol invalidsslprotocol ssl protocol sslprotocol create ssl context ssl context sslcontext ssl context sslcontext root pool rootpool ssl ssl mode server exception exception get string getstring endpoint apr fail ssl context make failsslcontextmake ssl ins ecure renegotiation sslinsecurerenegotiation legacy reneg supported legacyrenegsupported legacy reneg supported legacyrenegsupported ssl has op hasop ssl ssl unsafe legacy renegotiation legacy reneg supported legacyrenegsupported ssl context sslcontext set options setoptions ssl context sslcontext ssl ssl unsafe legacy renegotiation unsatisfied link error unsatisfiedlinkerror legacy reneg supported legacyrenegsupported openssl support unsafe legacy renegotiation log warn get string getstring endpoint warn no ins ecure reneg noinsecurereneg ssl version string versionstring cipher order client server ssl honor cipher order sslhonorcipherorder order ciphers supported ordercipherssupported order ciphers supported ordercipherssupported ssl has op hasop ssl ssl cipher server preference order ciphers supported ordercipherssupported ssl context sslcontext set options setoptions ssl context sslcontext ssl ssl cipher server preference unsatisfied link error unsatisfiedlinkerror order ciphers supported ordercipherssupported openssl support ciphers ordering log warn get string getstring endpoint warn no honor cipher order nohonorcipherorder ssl version string versionstring disable compression requested ssl disable compression ssldisablecompression disable compression supported disablecompressionsupported disable compression supported disablecompressionsupported ssl has op hasop ssl ssl compression disable compression supported disablecompressionsupported ssl context sslcontext set options setoptions ssl context sslcontext ssl ssl compression unsatisfied link error unsatisfiedlinkerror disable compression supported disablecompressionsupported openssl support ciphers ordering log warn get string getstring endpoint warn no disable compression nodisablecompression ssl version string versionstring list ciphers client permitted negotiate ssl context sslcontext set cipher suite setciphersuite ssl context sslcontext ssl cipher suite sslciphersuite load server key certificate ssl context sslcontext set certificate setcertificate ssl context sslcontext ssl certificate file sslcertificatefile ssl certificate key file sslcertificatekeyfile ssl password sslpassword ssl ssl aidx rsa certificate chain file ssl context sslcontext set certificate chain file setcertificatechainfile ssl context sslcontext ssl certificate chain file sslcertificatechainfile support client certificates ssl context sslcontext setcacertificate ssl context sslcontext ssl ca certificate file sslcacertificatefile ssl ca certificate path sslcacertificatepath revocation ssl context sslcontext setcarevocation ssl context sslcontext ssl ca revocation file sslcarevocationfile ssl ca revocation path sslcarevocationpath client certificate verification ssl ssl cverify optional equals ignore case equalsignorecase ssl verify client sslverifyclient ssl ssl cverify optional require equals ignore case equalsignorecase ssl verify client sslverifyclient ssl ssl cverify require optional no a optionalnoca equals ignore case equalsignorecase ssl verify client sslverifyclient ssl ssl cverify optional ssl context sslcontext set verify setverify ssl context sslcontext ssl verify depth sslverifydepth sendfile supported ssl use sendfile usesendfile start apr endpoint creating accept or acceptor poller sendfile threads override start internal startinternal exception running running paused create worker collection get executor getexecutor create executor createexecutor initialize connection latch initializeconnectionlatch start poller thread poller poller poller init thread poller thread pollerthread thread poller get name getname poller poller thread pollerthread set priority setpriority thread priority threadpriority poller thread pollerthread set daemon setdaemon poller thread pollerthread start start sendfile thread use sendfile usesendfile sendfile sendfile sendfile init thread sendfile thread sendfilethread thread sendfile get name getname sendfile sendfile thread sendfilethread set priority setpriority thread priority threadpriority sendfile thread sendfilethread set daemon setdaemon sendfile thread sendfilethread start start acceptor threads startacceptorthreads start async timeout thread async timeout asynctimeout async timeout asynctimeout thread timeout thread timeoutthread thread async timeout asynctimeout get name getname async timeout asynctimeout timeout thread timeoutthread set priority setpriority thread priority threadpriority timeout thread timeoutthread set daemon setdaemon timeout thread timeoutthread start endpoint processing threads override stop internal stopinternal release connection latch releaseconnectionlatch paused pause running running poller async timeout asynctimeout unlock accept unlockaccept abstract endpoint abstractendpoint acceptor accept or acceptor accept ors acceptors wait left waitleft wait left waitleft accept or acceptor get state getstate acceptor state acceptorstate ended server sock serversock thread sleep interrupted exception interruptedexception wait left waitleft wait left waitleft log warn get string getstring endpoint warn unlock acceptor failed unlockacceptorfailed accept or acceptor get thread name getthreadname hard socket close server sock serversock socket shutdown server sock serversock socket apr shutdown read server sock serversock poller destroy exception poller connections clear use sendfile usesendfile sendfile destroy exception sendfile shutdown executor shutdownexecutor deallocate apr memory pools close server socket override unbind exception running destroy pool initial ised initialised server sock pool serversockpool pool destroy server sock pool serversockpool server sock pool serversockpool close server socket initial ised initialised server sock serversock socket close server sock serversock server sock serversock ssl context sslcontext close apr memory pools resources initial ised initialised root pool rootpool pool destroy root pool rootpool root pool rootpool handler recycle methods override abstract endpoint abstractendpoint acceptor create acceptor createacceptor acceptor process connection set socket options setsocketoptions socket process connection step socket options timeout linger socket properties socketproperties get so linger on getsolingeron socket properties socketproperties get so linger time getsolingertime socket opt set optset socket socket apr linger socket properties socketproperties get so linger time getsolingertime socket properties socketproperties get tcp no delay gettcpnodelay socket opt set optset socket socket apr tcp node lay nodelay socket properties socketproperties get tcp no delay gettcpnodelay socket timeout set timeoutset socket socket properties socketproperties get so timeout getsotimeout ssl handshake step ssl context sslcontext ssl socket sslsocket attach ssl context sslcontext socket ssl socket sslsocket handshake socket log is debug enabled isdebugenabled log debug get string getstring endpoint err handshake ssl get last error getlasterror throwable exception utils exceptionutils handle throwable handlethrowable log is debug enabled isdebugenabled step log debug get string getstring endpoint err handshake log debug get string getstring endpoint err unexpected all ocate allocate poller size all ocate poller allocatepoller size pool timeout poll create size pool timeout error status apr status einval get error geterror log info get string getstring endpoint poll limited poll size limitedpollsize size log error get string getstring endpoint poll init fail initfail process socket called socket accepted process socket with options processsocketwithoptions socket shutdown executor avoid npe running log is debug enabled isdebugenabled log debug get string getstring endpoint debug socket value of valueof socket apr socket wrapper aprsocketwrapper wrapper apr socket wrapper aprsocketwrapper value of valueof socket wrapper set keep alive left setkeepaliveleft get max keep alive requests getmaxkeepaliverequests wrapper set secure setsecure issslenabled connections value of valueof socket wrapper get executor getexecutor execute socket with options processor socketwithoptionsprocessor wrapper rejected execution exception rejectedexecutionexception log warn socket processing request rejected socket throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring endpoint process fail process socket called comet mode typically alive upgrade d upgraded protocol process socket processsocket socket socket status socketstatus status executor executor get executor getexecutor executor log warn get string getstring endpoint warn no exec tor noexector value of valueof socket socket wrapper socketwrapper wrapper connections value of valueof socket connection has n hasn closed wrapper executor execute socket processor socketprocessor wrapper status rejected execution exception rejectedexecutionexception log warn socket processing request rejected socket throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring endpoint process fail override process socket async processsocketasync socket wrapper socketwrapper socket socket status socketstatus status socket waiting requests waitingrequests remove socket socket processor socketprocessor proc socket processor socketprocessor socket status class loader classloader loader thread current thread currentthread get context class loader getcontextclassloader threads created webapp class loader classloader constants security enabled privileged action privilegedaction privileged set tccl privilegedsettccl get class getclass get class loader getclassloader access controller accesscontroller do privileged doprivileged thread current thread currentthread set context class loader setcontextclassloader get class getclass get class loader getclassloader executor executor get executor getexecutor executor log warn get string getstring endpoint warn no exec tor noexector socket status executor execute proc constants security enabled privileged action privilegedaction privileged set tccl privilegedsettccl loader access controller accesscontroller do privileged doprivileged thread current thread currentthread set context class loader setcontextclassloader loader rejected execution exception rejectedexecutionexception log warn socket processing request rejected socket throwable exception utils exceptionutils handle throwable handlethrowable log error get string getstring endpoint process fail close socket closesocket socket running socket dest royed destroyed parent pool accept or acceptor socket disable free jvm core connections remove value of valueof socket connector running destroy socket destroysocket call count down connection countdownconnection connector stopped latch removed matter destroy socket destroysocket call count down connection countdownconnection poller poller poller poller poller close socket destroy socket destroysocket socket method called chance socket poller gen erally generally bad idea call error condition destroy socket destroysocket socket connections remove value of valueof socket log is debug enabled isdebugenabled string msg get string getstring endpoint debug destroy socket destroysocket value of valueof socket log is trace enabled istraceenabled log trace msg exception log debug msg closed calling start socket socket destroy socket count down connection countdownconnection override log get log getlog log background thread list ens listens incoming tcp connections hands processor acceptor abstract endpoint abstractendpoint acceptor log log log factory logfactory get log getlog apr endpoint aprendpoint acceptor override error delay errordelay loop receive shutdown command running loop endpoint paused paused running acceptor state acceptorstate paused thread sleep interrupted exception interruptedexception running acceptor state acceptorstate running reached max connections wait count up or await connection countuporawaitconnection socket accept incoming connection server socket socket socket accept server sock serversock log is debug enabled isdebugenabled address socket apr remote socket sockaddr add r addr address get info getinfo log debug get string getstring endpoint apr remote port remoteport value of valueof socket value of valueof add r addr port exception count down connection countdownconnection error delay errordelay handle exception with delay handleexceptionwithdelay error delay errordelay successful accept reset error delay error delay errordelay running paused hand socket processor process socket with options processsocketwithoptions socket close socket close socket closesocket socket close socket code path socket poller destroy socket destroysocket destroy socket destroysocket socket throwable exception utils exceptionutils handle throwable handlethrowable running string msg get string getstring endpoint accept fail error error error get error geterror log warn msg log error msg log error msg processor recycle fin is hes finishes acceptor state acceptorstate ended async timeout thread async timeout asynctimeout runnable async timeout running asynctimeoutrunning background thread checks async requests fires timeout activity override loop receive shutdown command async timeout running asynctimeoutrunning thread sleep interrupted exception interruptedexception system current time millis currenttimemillis iterator socket wrapper socketwrapper sockets waiting requests waitingrequests iterator sockets has next hasnext socket wrapper socketwrapper socket sockets socket async access socket get last access getlastaccess socket get timeout gettimeout access socket get timeout gettimeout prevent multiple timeouts socket set timeout settimeout process socket async processsocketasync socket socket status socketstatus timeout loop endpoint paused paused async timeout running asynctimeoutrunning thread sleep interrupted exception interruptedexception async timeout running asynctimeoutrunning socket info socketinfo socket timeout flags read flags poll apr pollin poll apr pollin write flags poll apr pollout poll apr pollout merge flag flag flag poll apr pollin flag poll apr pollin flag poll apr pollout flag poll apr pollout override string to string tostring string builder stringbuilder string builder stringbuilder append socket append socket append timeout append timeout append flags append flags to string tostring socket time outs sockettimeouts size sockets timeouts pos socket time outs sockettimeouts size size sockets size timeouts size add socket timeout sockets size socket timeouts size timeout size removes socket poller configured timeout socket socket list socket timeouts remove socket result size sockets socket result timeouts sockets sockets size timeouts timeouts size size result check pos size timeouts pos result sockets pos sockets pos sockets size timeouts pos timeouts size size result pos pos socket list socketlist size pos sockets timeouts flags socket info socketinfo info socket info socketinfo socket list socketlist size size pos sockets size timeouts size flags size size size socket info socketinfo pos size info socket sockets pos info timeout timeouts pos info flags flags pos pos info clear size pos add socket timeout flag size sockets length size sockets socket flags socket info socketinfo merge flags flag sockets size socket timeouts size timeout flags size flag size remove socket size sockets socket sockets sockets size timeouts timeouts size flags size flags size size duplicate socket list socketlist copy copy size size copy pos pos system arraycopy sockets copy sockets size system arraycopy timeouts copy timeouts size system arraycopy flags copy flags size poller runnable point ers pointers pollers pollers actual poller size actual poller size actualpollersize amount spots left poller poller space pollerspace amount level pollers poller poller count pollercount timeout poll call poller time pollertime variable poller timeout adjusts depending poll sets total poll time poll sets remains equal poll time polltime next poller time nextpollertime root pool pool socket descriptors desc list sockets poller socket list socketlist add list addlist list sockets closed socket list socketlist close list closelist structure storing timeouts socket time outs sockettimeouts timeouts maintain main tain maintain longer runs last main tain lastmaintain system current time millis currenttimemillis number connections poller correct operation poller depends figure correct poller enter wait loop waits connection poller calls poll polling existing connections time writing comment implemented atomic integer atomicinteger ensure remains thread safe atomic integer atomicinteger connection count connectioncount atomic integer atomicinteger get connection count getconnectioncount connection count connectioncount poller running pollerrunning create poller versions apr maximum poller size recompiling apr remove limitation init pool pool create server sock pool serversockpool single poller default poller size defaultpollersize get max connections getmaxconnections win win default poller size defaultpollersize maximum poller reason able reasonable performance adjust poller size won reach limit limitation server fixed vista server onwards actual poller size actualpollersize actual poller size actualpollersize default poller size defaultpollersize timeouts socket time outs sockettimeouts default poller size defaultpollersize moment setting timeout use less useless normal poller faster maintain worth both ering bothering pollset all ocate poller allocatepoller actual poller size actualpollersize pool pollset actual poller size actualpollersize actual poller size actualpollersize pollset all ocate poller allocatepoller actual poller size actualpollersize pool pollset actual poller size actualpollersize pollset all ocate poller allocatepoller actual poller size actualpollersize pool poller count pollercount default poller size defaultpollersize actual poller size actualpollersize poller time pollertime poll time polltime poller count pollercount next poller time nextpollertime poller time pollertime pollers poller count pollercount pollers pollset poller count pollercount pollers all ocate poller allocatepoller actual poller size actualpollersize pool poller space pollerspace poller count pollercount poller count pollercount poller space pollerspace actual poller size actualpollersize desc actual poller size actualpollersize connection count connectioncount add list addlist socket list socketlist default poller size defaultpollersize close list closelist socket list socketlist default poller size defaultpollersize method socket poller add list addlist method completed poller running pollerrunning destroy poller destroy poller problems notify wait poll time polltime interrupted exception interruptedexception close sockets add queue socket info socketinfo info add list addlist info comet connections value of valueof info socket is comet iscomet comet process socket processsocket info socket socket status socketstatus poller isn running point destroy socket destroysocket destroy socket destroysocket info socket info add list addlist add list addlist clear close sockets poller poller count pollercount poll pollset pollers desc comet connections value of valueof desc is comet iscomet comet process socket processsocket desc socket status socketstatus destroy socket destroysocket desc pool destroy pool connection count connectioncount add socket pool poller socket temporary array polled maximum amount time equal poll time polltime cases latency note read write socket checked timeout socket poller callback event generated socket removed poller param socket add poller param timeout connection param read read polling param write write polling add socket timeout read write add socket timeout read poll apr pollin write poll apr pollout add socket timeout flags log is debug enabled isdebugenabled string msg get string getstring endpoint debug poller add polleradd value of valueof socket integer value of valueof timeout integer value of valueof flags log is trace enabled istraceenabled log trace msg exception log debug msg timeout timeout timeout integer max poller running pollerrunning add list addlist add socket timeout flags notify close socket comet connections value of valueof socket is comet iscomet comet process socket processsocket socket socket status socketstatus error close socket closesocket socket add socket pollers called link poller add to poller addtopoller socket events pollers length poller space pollerspace poll add pollers socket events status apr success poller space pollerspace connection count connectioncount increment and get incrementandget close socket poller running pollerrunning poller running pollerrunning close list closelist add socket notify remove socket pollers called link poller remove from poller removefrompoller socket log is debug enabled isdebugenabled log debug get string getstring endpoint debug poller remove pollerremove value of valueof socket pollers length poller space pollerspace actual poller size actualpollersize poll remove pollers socket status apr not found notfound poller space pollerspace connection count connectioncount decrement and get decrementandget log is debug enabled isdebugenabled log debug get string getstring endpoint debug poller removed pollerremoved value of valueof socket timeouts remove socket status apr success timeout checks maintain system current time millis currenttimemillis called last main tain lastmaintain last main tain lastmaintain socket timeouts check socket log is debug enabled isdebugenabled log debug get string getstring endpoint debug socket timeout sockettimeout value of valueof socket remove from poller removefrompoller socket comet connections value of valueof socket is comet iscomet comet process socket processsocket socket socket status socketstatus timeout destroy socket destroysocket socket socket timeouts check displays list sockets pollers override string to string tostring string buffer stringbuffer buf string buffer stringbuffer buf append poller res actual poller size actualpollersize pollers length count poll pollset pollers res buf append count buf append desc append buf append buf to string tostring background thread list ens listens incoming tcp connections hands processor override socket list socketlist local add list localaddlist socket list socketlist get max connections getmaxconnections socket list socketlist local close list localcloselist socket list socketlist get max connections getmaxconnections loop receive shutdown command poller running pollerrunning loop endpoint paused poller running pollerrunning paused thread sleep interrupted exception interruptedexception check timeouts poller empty poller running pollerrunning connection count connectioncount add list addlist size close list closelist size get so timeout getsotimeout poller running pollerrunning maintain happened sync block entered add list addlist size close list closelist size wait interrupted exception interruptedexception throwable exception utils exceptionutils handle throwable handlethrowable get log getlog warn get string getstring endpoint timeout err don add poll poller stopped poller running pollerrunning min imised minimised close list closelist size duplicate list syncing minimal close list closelist duplicate local close list localcloselist close list closelist clear local close list localcloselist clear add list addlist size duplicate list syncing minimal add list addlist duplicate local add list localaddlist add list addlist clear local add list localaddlist clear remove sockets local close list localcloselist size socket info socketinfo info local close list localcloselist info local add list localaddlist remove info socket remove from poller removefrompoller info socket destroy socket destroysocket info socket info local close list localcloselist add sockets waiting poller local add list localaddlist size socket info socketinfo info local add list localaddlist info log is debug enabled isdebugenabled log debug get string getstring endpoint debug poller add do polleradddo value of valueof info socket timeouts remove info socket apr socket wrapper aprsocketwrapper wrapper connections value of valueof info socket wrapper info read info write comet wrapper is comet iscomet comet wrapper poller flags pollerflags remove from poller removefrompoller info socket wrapper poller flags pollerflags wrapper poller flags pollerflags info read poll apr pollin info write poll apr pollout add to poller addtopoller info socket wrapper poller flags pollerflags comet process socket processsocket info socket socket status socketstatus error close socket closesocket info socket timeouts add info socket system current time millis currenttimemillis info timeout happen close socket closesocket info socket get log getlog warn get string getstring endpoint apr poll add invalid polladdinvalid info info local add list localaddlist poll int erval interval pollers length flags real locate reallocate pool reset array list arraylist skip iter ate iterate pollers poll empty pollers poller space pollerspace actual poller size actualpollersize poll poll pollers next poller time nextpollertime desc reset next poller time nextpollertime next poller time nextpollertime poller time pollertime skip ping skipping empty poll skip ping skipping wait time poller time pollertime microseconds poll sets skipped loop tighter expected lead higher expected cpu usage ext ending extending next poller time nextpollertime ensures loop takes time execute next poller time nextpollertime poller time pollertime poller space pollerspace connection count connectioncount add and get addandget timeout timeouts remove desc apr socket wrapper aprsocketwrapper wrapper connections value of valueof desc get log getlog is debug enabled isdebugenabled log debug get string getstring endpoint debug poller process pollerprocess value of valueof desc value of valueof desc wrapper poller flags pollerflags wrapper poller flags pollerflags desc check failed sockets hand socket worker wrapper is comet iscomet event processes read write depending poller returns desc poll apr pollhup poll apr pollhup desc poll apr pollerr poll apr pollerr desc poll apr pollnval poll apr pollnval process socket processsocket desc socket status socketstatus error close socket clear pool close socket closesocket desc desc poll apr pollin poll apr pollin wrapper poller flags pollerflags add desc wrapper poller flags pollerflags process socket processsocket desc socket status socketstatus open read close socket clear pool close socket closesocket desc desc poll apr pollout poll apr pollout wrapper poller flags pollerflags add desc wrapper poller flags pollerflags process socket processsocket desc socket status socketstatus open write close socket clear pool close socket closesocket desc unknown event get log getlog warn get string getstring endpoint apr poll unknown event pollunknownevent value of valueof desc process socket processsocket desc socket status socketstatus error close socket clear pool close socket closesocket desc desc poll apr pollhup poll apr pollhup desc poll apr pollerr poll apr pollerr desc poll apr pollnval poll apr pollnval wrapper is upgrade d isupgraded registered desc poll apr pollin poll apr pollin error occurred blocking read process socket processsocket desc socket status socketstatus open read close socket clear pool close socket closesocket desc desc poll apr pollout poll apr pollout error occurred blocking write process socket processsocket desc socket status socketstatus open write close socket clear pool close socket closesocket desc wrapper poller flags pollerflags poll apr pollin poll apr pollin socket registered blocking read process socket processsocket desc socket status socketstatus open read close socket clear pool close socket closesocket desc wrapper poller flags pollerflags poll apr pollout poll apr pollout socket registered blocking write process socket processsocket desc socket status socketstatus open write close socket clear pool close socket closesocket desc close socket clear pool close socket closesocket desc close socket clear pool close socket closesocket desc desc poll apr pollin poll apr pollin desc poll apr pollout poll apr pollout error desc poll apr pollin poll apr pollin process socket processsocket desc socket status socketstatus open read error close socket clear pool close socket closesocket desc error desc poll apr pollout poll apr pollout process socket processsocket desc socket status socketstatus open write close socket clear pool error close socket closesocket desc error wrapper poller flags pollerflags sub tract subtract current timestamp timeout timeout timeout system current time millis currenttimemillis add timeout timeout timeout timeout integer max timeout integer max add desc timeout wrapper poller flags pollerflags unknown event get log getlog warn get string getstring endpoint apr poll unknown event pollunknownevent value of valueof desc close socket clear pool close socket closesocket desc errn time up timeup int errupted interrupted error critical errn status time up timeup errn status eintr errn status apr start use rerr usererr errn status apr start use rerr usererr get log getlog error get string getstring endpoint apr poll error pollerror integer value of valueof errn error str error strerror errn destroy real locate reallocate poller reset reset poller running pollerrunning real locate reallocate current poller count poll pollset pollers desc new poller newpoller all ocate poller allocatepoller actual poller size actualpollersize pool don restore connections tested poller space pollerspace actual poller size actualpollersize connection count connectioncount add and get addandget count poll destroy pollers pollers new poller newpoller throwable exception utils exceptionutils handle throwable handlethrowable get log getlog warn get string getstring endpoint poll error process socket timeouts get so timeout getsotimeout poller running pollerrunning works timeout mechanism event poller bit faster maintain maintain throwable exception utils exceptionutils handle throwable handlethrowable get log getlog warn get string getstring endpoint timeout err notify all notifyall sendfile data sendfiledata sendfile data sendfiledata file string file name filename fdpool range start socket socket pool socket position pos keep alive keepalive flag keep alive keepalive sendfile runnable sendfile pollset sendfilepollset pool desc hash map hashmap sendfile data sendfiledata sendfile data sendfiledata sendfile count sendfilecount get sendfile count getsendfilecount sendfile count sendfilecount array list arraylist sendfile data sendfiledata add s adds sendfile running sendfilerunning create sendfile poller versions apr maximum poller size recompiling apr remove limitation init pool pool create server sock pool serversockpool size sendfile size sendfilesize size size win win sendfile pollset sendfilepollset all ocate poller allocatepoller size pool get so timeout getsotimeout sendfile pollset sendfilepollset size size sendfile pollset sendfilepollset all ocate poller allocatepoller size pool get so timeout getsotimeout sendfile pollset sendfilepollset size sendfile pollset sendfilepollset all ocate poller allocatepoller size pool get so timeout getsotimeout desc size sendfile data sendfiledata hash map hashmap sendfile data sendfiledata size add s adds array list arraylist sendfile data sendfiledata destroy sendfile running sendfilerunning poller problems notify wait poll time polltime interrupted exception interruptedexception close socket remaining add queue add s adds size sendfile data sendfiledata data add s adds close socket closesocket data socket close sockets poller poll pollset sendfile pollset sendfilepollset desc close socket closesocket desc pool destroy pool sendfile data sendfiledata clear add sendfile data sendfile poller note cases initial blocking calls sendfile handled async hronously asynchronously kernel result poller param data reference data snet data add sendfile data sendfiledata data initialize data data fdpool socket pool data socket data file open data file name filename file apr fopen read file apr fopen sendfile enabled file apr fopen binary data fdpool data pos data start socket non blocking nonblocking mode socket timeout set timeoutset data socket socket sendfile n sendfilen data socket data data pos data data pos status eagain pool destroy data fdpool data socket loop add socket poller data pos data pos data pos data entire file pool destroy data fdpool socket blocking mode socket timeout set timeoutset data socket get so timeout getsotimeout exception log warn get string getstring endpoint sendfile error poll time polltime polled add s adds add data notify remove socket poller param data sendfile data removed remove sendfile data sendfiledata data poll remove sendfile pollset sendfilepollset data socket status apr success sendfile count sendfilecount sendfile data sendfiledata remove value of valueof data socket override maintain time maintaintime loop receive shutdown command sendfile running sendfilerunning loop endpoint paused sendfile running sendfilerunning paused thread sleep interrupted exception interruptedexception loop poller empty sendfile running sendfilerunning sendfile count sendfilecount add s adds size reset maintain time maintain time maintaintime wait interrupted exception interruptedexception don add poll poller stopped sendfile running sendfilerunning add socket poller add s adds size add s adds size sendfile data sendfiledata data add s adds poll add sendfile pollset sendfilepollset data socket poll apr pollout status apr success sendfile data sendfiledata value of valueof data socket data sendfile count sendfilecount get log getlog warn get string getstring endpoint sendfile add fail addfail integer value of valueof error str error strerror close socket close socket closesocket data socket add s adds clear maintain time maintaintime poll time polltime pool int erval interval poll poll sendfile pollset sendfilepollset poll time polltime desc sendfile sendfile data sendfiledata sendfile data sendfiledata value of valueof desc problem events desc poll apr pollhup poll apr pollhup desc poll apr pollerr poll apr pollerr close socket clear pool remove destroy file descriptor pool close file close socket response incomplete close socket closesocket socket write data sendfile socket sendfile n sendfilen socket pos pos close socket clear pool remove close socket response incomplete close file close socket closesocket socket pos pos pos remove keep alive keepalive destroy file descriptor pool close file pool destroy fdpool socket timeout set timeoutset socket get so timeout getsotimeout socket poller processing requests get poller getpoller add socket get keep alive timeout getkeepalivetimeout close socket alive request close socket closesocket socket errn time up timeup int errupted interrupted error critical errn status time up timeup errn status eintr errn status apr start use rerr usererr errn status apr start use rerr usererr get log getlog error get string getstring endpoint apr poll error pollerror integer value of valueof errn error str error strerror errn handle poll critical failure destroy init call maintain sendfile poller get so timeout getsotimeout maintain time maintaintime sendfile running sendfilerunning poll maintain sendfile pollset sendfilepollset desc maintain time maintaintime sendfile sendfile data sendfiledata sendfile data sendfiledata value of valueof desc close socket clear pool remove destroy file descriptor pool close file close socket response incomplete close socket closesocket socket throwable exception utils exceptionutils handle throwable handlethrowable get log getlog error get string getstring endpoint poll error notify all notifyall bar e bare bones socket processing thread data stored thread with attributes threadwithattributes extra folders alt ernately alternately thread local fields handler abstract endpoint abstractendpoint handler socket state socketstate process socket wrapper socketwrapper socket socket status socketstatus status equivalent worker simply external executor thread pool socket options handshake called accept socket with options processor socketwithoptionsprocessor runnable socket wrapper socketwrapper socket socket with options processor socketwithoptionsprocessor socket wrapper socketwrapper socket socket socket override socket defer accept deferaccept set socket options setsocketoptions socket get socket getsocket long value longvalue get poller getpoller add socket get socket getsocket long value longvalue get so timeout getsotimeout close socket pool close socket closesocket socket get socket getsocket long value longvalue socket process request socket set socket options setsocketoptions socket get socket getsocket long value longvalue close socket pool close socket closesocket socket get socket getsocket long value longvalue socket process request socket handler socket state socketstate handler process socket socket status socketstatus open read handler socket state socketstate closed close socket pool close socket closesocket socket get socket getsocket long value longvalue socket handler socket state socketstate socket access socket async waiting requests waitingrequests add socket equivalent worker simply external executor thread pool socket processor socketprocessor runnable socket wrapper socketwrapper socket socket status socketstatus status socket processor socketprocessor socket wrapper socketwrapper socket socket status socketstatus status socket socket status happen null pointer exception nullpointerexception status status override servlet nio configured socket is upgrade d isupgraded socket status socketstatus open write status socket get write thread lock getwritethreadlock do run dorun socket do run dorun do run dorun process request socket socket get socket getsocket closed thread socket state socketstate handler process socket status handler socket state socketstate closed close socket pool close socket closesocket socket get socket getsocket long value longvalue socket socket handler socket state socketstate socket access socket async waiting requests waitingrequests add socket handler socket state socketstate async socket access socket processor socketprocessor proc socket processor socketprocessor socket socket status socketstatus open read get executor getexecutor execute proc apr socket wrapper aprsocketwrapper socket wrapper socketwrapper field poller poller flags pollerflags apr socket wrapper aprsocketwrapper socket socket
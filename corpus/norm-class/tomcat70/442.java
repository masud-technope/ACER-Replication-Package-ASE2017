licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina util java io exception ioexception java input stream inputstream java invalid class exception invalidclassexception java object input stream objectinputstream java object stream class objectstreamclass java lang reflect proxy java util collections java util java util weak hash map weakhashmap java util concurrent concurrent hash map concurrenthashmap java util regex pattern org apache juli logging log org apache tomcat util res string manager stringmanager custom subclass code object input stream objectinputstream code loads loader web application classes defined web application correctly author craig mc clanahan mcclanahan author bip the lin thelin custom object input stream customobjectinputstream object input stream objectinputstream string manager stringmanager string manager stringmanager get manager getmanager custom object input stream customobjectinputstream weak hash map weakhashmap class loader classloader string reported class cache reportedclasscache weak hash map weakhashmap class loader classloader string loader resolve classes class loader classloader class loader classloader string reported classes reportedclasses log log pattern allowed class name pattern allowedclassnamepattern string allowed class name filter allowedclassnamefilter warn on failure warnonfailure construct instance custom object input stream customobjectinputstream filtering deserialized classes param stream input stream read param class loader classloader loader instantiate objects exception io exception ioexception input output error occurs custom object input stream customobjectinputstream input stream inputstream stream class loader classloader class loader classloader io exception ioexception stream class loader classloader construct instance custom object input stream customobjectinputstream filtering deserialized classes param stream input stream read param class loader classloader loader instantiate objects param log logger report issues filter mode filtermode require logging param allowed class name pattern allowedclassnamepattern regular expression filter deserialized classes fully qualified match pattern deserialization allowed filtering enabled param warn on failure warnonfailure failures log ged logged exception io exception ioexception input output error occurs custom object input stream customobjectinputstream input stream inputstream stream class loader classloader class loader classloader log log pattern allowed class name pattern allowedclassnamepattern warn on failure warnonfailure io exception ioexception stream log allowed class name pattern allowedclassnamepattern warn on failure warnonfailure illegal argument exception illegalargumentexception get string getstring custom object input stream customobjectinputstream log required logrequired class loader classloader class loader classloader log log allowed class name pattern allowedclassnamepattern allowed class name pattern allowedclassnamepattern allowed class name pattern allowedclassnamepattern allowed class name filter allowedclassnamefilter allowed class name filter allowedclassnamefilter allowed class name pattern allowedclassnamepattern to string tostring warn on failure warnonfailure warn on failure warnonfailure string reported classes reportedclasses reported class cache reportedclasscache reported classes reportedclasses reported class cache reportedclasscache class loader classloader reported classes reportedclasses reported classes reportedclasses collections new set from map newsetfrommap concurrent hash map concurrenthashmap string reported class cache reportedclasscache class loader classloader reported classes reportedclasses reported classes reportedclasses reported classes reportedclasses load local equivalent stream description loader assigned context param class desc classdesc description input stream exception class not found exception classnotfoundexception exception io exception ioexception input output error occurs override resolve class resolveclass object stream class objectstreamclass class desc classdesc class not found exception classnotfoundexception io exception ioexception string class desc classdesc get name getname allowed class name pattern allowedclassnamepattern allowed allowed class name pattern allowedclassnamepattern matcher matches allowed do log dolog warn on failure warnonfailure reported classes reportedclasses add string msg get string getstring custom object input stream customobjectinputstream nomatch allowed class name filter allowedclassnamefilter do log dolog log warn msg log is debug enabled isdebugenabled log debug msg invalid class exception invalidclassexception msg for name forname class loader classloader class not found exception classnotfoundexception resolve class resolveclass class desc classdesc class not found exception classnotfoundexception proxy interfaces named proxy descriptor loader assigned context override resolve proxy class resolveproxyclass string interfaces io exception ioexception class not found exception classnotfoundexception cinterfaces interfaces length interfaces length cinterfaces class loader classloader load class loadclass interfaces proxy get proxy class getproxyclass class loader classloader cinterfaces illegal argument exception illegalargumentexception class not found exception classnotfoundexception
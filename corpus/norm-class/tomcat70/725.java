licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat jdbc test java sql connection java sql result set resultset java sql statement java util concurrent count down latch countdownlatch javax sql data source datasource org junit test check out thread test checkoutthreadtest default test case defaulttestcase count down latch countdownlatch latch test testdbcpthreads connections exception datasource get pool properties getpoolproperties set max active setmaxactive threadcount transfer properties transferproperties t data source tdatasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat dbcp t data source tdatasource start latch await delta system current time millis currenttimemillis start system println testdbcpthreads connections test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections fair exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections fair test complete delta iterations threadcount iterations tear down teardown test test c testc threads connections exception datasource get pool properties getpoolproperties set max active setmaxactive threadcount transfer properties to c transferpropertiestoc data source datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool data source datasource start latch await delta system current time millis currenttimemillis start system println test c testc threads connections test complete delta iterations threadcount iterations tear down teardown test testdbcpthreads connections exception datasource get pool properties getpoolproperties set max active setmaxactive threadcount transfer properties transferproperties t data source tdatasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat dbcp t data source tdatasource start latch await delta system current time millis currenttimemillis start system println testdbcpthreads connections test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections fair exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections fair test complete delta iterations threadcount iterations tear down teardown test test c testc threads connections exception datasource get pool properties getpoolproperties set max active setmaxactive threadcount transfer properties to c transferpropertiestoc data source datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool data source datasource start latch await delta system current time millis currenttimemillis start system println test c testc threads connections test complete delta iterations threadcount iterations tear down teardown test testdbcpthreads connections validate exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow threadcount transfer properties transferproperties t data source tdatasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat dbcp validate t data source tdatasource start latch await delta system current time millis currenttimemillis start system println testdbcpthreads connections validate test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections validate exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool validate datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections validate test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections validate fair validatefair exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool validate datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections validate fair validatefair test complete delta iterations threadcount iterations tear down teardown test test c testc threads connections validate exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow threadcount transfer properties to c transferpropertiestoc data source datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool validate data source datasource start latch await delta system current time millis currenttimemillis start system println test c testc threads connections validate test complete delta iterations threadcount iterations tear down teardown test testdbcpthreads connections validate exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow threadcount transfer properties transferproperties t data source tdatasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat dbcp validate t data source tdatasource start latch await delta system current time millis currenttimemillis start system println testdbcpthreads connections validate test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections validate exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool validate datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections validate test complete delta iterations threadcount iterations tear down teardown test test pool threads testpoolthreads connections validate fair validatefair exception datasource get pool properties getpoolproperties set max active setmaxactive datasource get pool properties getpoolproperties set test on borrow settestonborrow datasource get pool properties getpoolproperties set fair queue setfairqueue threadcount transfer properties transferproperties datasource get connection getconnection close latch count down latch countdownlatch threadcount start system current time millis currenttimemillis threadcount test thread testthread test thread testthread set name setname tomcat pool validate datasource start latch await delta system current time millis currenttimemillis start system println test pool threads testpoolthreads connections validate fair validatefair test complete delta iterations threadcount iterations tear down teardown test thread testthread thread data source datasource string query override max total max totalmax total cmax totalcmax cmax nroffetch total runtime totalruntime check out thread test checkoutthreadtest iterations start system nano time nanotime connection con con get connection getconnection delta system nano time nanotime start total max totalmax delta max math max delta max nroffetch query statement con create statement createstatement result set resultset execute query executequery query close close cst art cstart system nano time nanotime con con close exception print stack trace printstacktrace cdelta system nano time nanotime cst art cstart total cmax totalcmax cdelta cmax math max cdelta cmax total runtime totalruntime system nano time nanotime start exception print stack trace printstacktrace check out thread test checkoutthreadtest latch count down countdown system get property getproperty print thread stats system println get name getname t max tmax time retrieve connection max t total ttotal time retrieve connection total max totalmax t average taverage time retrieve connection total max totalmax nroffetch t max tmax time close connection cmax t total ttotal time close connection total cmax totalcmax t average taverage time close connection total cmax totalcmax nroffetch t run trun time total runtime totalruntime t nr tnr fetch nroffetch
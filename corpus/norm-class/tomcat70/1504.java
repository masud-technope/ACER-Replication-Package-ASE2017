licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina core java file java i o exception ioexception java util array list arraylist java util hash map hashmap java util hash set hashset java util list java util map java util java util concurrent count down latch countdownlatch java util concurrent time unit timeunit java util concurrent atomic atomic integer atomicinteger javax servlet servlet javax servlet servlet config servletconfig javax servlet servlet container initializer servletcontainerinitializer javax servlet servlet context servletcontext javax servlet servlet exception servletexception javax servlet servlet registration servletregistration javax servlet annotation http constraint httpconstraint javax servlet annotation http method constraint httpmethodconstraint javax servlet annotation servlet security servletsecurity javax servlet annotation servlet security servletsecurity empty role semantic emptyrolesemantic javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit assert false assertfalse org junit assert true asserttrue org junit test org apache catalina context org apache catalina wrapper org apache catalina authenticator basic authenticator basicauthenticator org apache catalina deploy login config loginconfig org apache catalina startup test tomcat testtomcat map realm maprealm org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk test standard wrapper teststandardwrapper tomcat base test tomcatbasetest test test security annotations simple testsecurityannotationssimple exception do test dotest deny all servlet denyallservlet get name getname test test security annotations sub class testsecurityannotationssubclass exception do test dotest sub class deny all servlet subclassdenyallservlet get name getname test test security annotations sub class testsecurityannotationssubclass exception do test dotest sub class allow all servlet subclassallowallservlet get name getname test test security annotations methods testsecurityannotationsmethods exception do test dotest method constraint servlet methodconstraintservlet get name getname test test security annotations methods testsecurityannotationsmethods exception do test dotest method constraint servlet methodconstraintservlet get name getname test test security annotations role testsecurityannotationsrole exception do test dotest role allow servlet roleallowservlet get name getname test test security annotations role testsecurityannotationsrole exception do test dotest role deny servlet roledenyservlet get name getname test test security annotations web xml priority testsecurityannotationswebxmlpriority exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file test webapp fragments tomcat add webapp addwebapp app dir appdir get absolute path getabsolutepath tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport test standard wrapper teststandardwrapper security annotations web xml priority securityannotationswebxmlpriority assert true asserttrue get length getlength assert equals assertequals test test security annotations meta data priority testsecurityannotationsmetadatapriority exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file test webapp tomcat add webapp addwebapp app dir appdir get absolute path getabsolutepath tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport test standard wrapper teststandardwrapper security annotations meta data priority securityannotationsmetadatapriority assert equals assertequals to string tostring assert equals assertequals test test security annotations add servlet testsecurityannotationsaddservlet exception do test security annotations add servlet dotestsecurityannotationsaddservlet test test security annotations add servlet testsecurityannotationsaddservlet exception do test security annotations add servlet dotestsecurityannotationsaddservlet test test security annotations no web xml constraints testsecurityannotationsnowebxmlconstraints exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file test webapp servlets ecurity servletsecurity tomcat add webapp addwebapp app dir appdir get absolute path getabsolutepath tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport assert true asserttrue get length getlength assert equals assertequals test test security annotations no web xml login config testsecurityannotationsnowebxmlloginconfig exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file test webapp servlets ecurity servletsecurity tomcat add webapp addwebapp app dir appdir get absolute path getabsolutepath tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport jsp assert true asserttrue get length getlength assert equals assertequals recycle get url geturl http localhost get port getport unprotected jsp assert equals assertequals assert true asserttrue to string tostring do test security annotations add servlet dotestsecurityannotationsaddservlet use create servlet usecreateservlet exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext servlet deny all servlet denyallservlet servlet container initializer servletcontainerinitializer sci sci use create servlet usecreateservlet ctx add servlet container initializer addservletcontainerinitializer sci tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport use create servlet usecreateservlet assert true asserttrue get length getlength assert equals assertequals assert equals assertequals to string tostring assert equals assertequals do test dotest string servlet class name servletclassname use post usepost use role userole expect exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext wrapper wrapper tomcat add servlet addservlet ctx servlet servlet class name servletclassname wrapper set async supported setasyncsupported ctx add servlet mapping addservletmapping servlet use role userole map realm maprealm realm map realm maprealm realm add user adduser test user testuser test pwd testpwd realm add user role adduserrole test user testuser test role testrole ctx set realm setrealm realm ctx set login config setloginconfig login config loginconfig basic ctx get pipeline getpipeline add valve addvalve basic authenticator basicauthenticator tomcat start byte chunk bytechunk byte chunk bytechunk map string list string req headers reqheaders use role userole req headers reqheaders hash map hashmap string list string list string auth headers authheaders array list arraylist string test user testuser test pwd testpwd auth headers authheaders add basic dgvzdfvzzxi dgvzdfb req headers reqheaders authorization auth headers authheaders use post usepost post url posturl http localhost get port getport req headers reqheaders get url geturl http localhost get port getport req headers reqheaders expect assert equals assertequals to string tostring assert equals assertequals assert true asserttrue get length getlength assert equals assertequals test servlet testservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception resp set content type setcontenttype text plain resp get writer getwriter print override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception do get doget req resp servlet security servletsecurity http constraint httpconstraint empty role semantic emptyrolesemantic deny deny all servlet denyallservlet test servlet testservlet serialversionuid sub class deny all servlet subclassdenyallservlet deny all servlet denyallservlet serialversionuid servlet security servletsecurity http constraint httpconstraint empty role semantic emptyrolesemantic permit sub class allow all servlet subclassallowallservlet deny all servlet denyallservlet serialversionuid servlet security servletsecurity http constraint httpconstraint empty role semantic emptyrolesemantic permit http method constraints httpmethodconstraints http method constraint httpmethodconstraint empty role semantic emptyrolesemantic empty role semantic emptyrolesemantic deny method constraint servlet methodconstraintservlet test servlet testservlet serialversionuid servlet security servletsecurity http constraint httpconstraint roles allowed rolesallowed test role testrole role allow servlet roleallowservlet test servlet testservlet serialversionuid servlet security servletsecurity http constraint httpconstraint roles allowed rolesallowed other role otherrole role deny servlet roledenyservlet test servlet testservlet serialversionuid sci servlet container initializer servletcontainerinitializer servlet servlet create servlet createservlet sci servlet servlet create servlet createservlet servlet servlet create servlet createservlet create servlet createservlet override on startup onstartup servlet context servletcontext ctx servlet exception servletexception servlet create servlet createservlet ctx create servlet createservlet servlet get class getclass servlet servlet registration servletregistration dynamic ctx add servlet addservlet servlet add mapping addmapping bug thread count count down latch countdownlatch latch atomic integer atomicinteger counter atomic integer atomicinteger test test bug testbug add servlet addservlet exception latch count down latch countdownlatch bug thread count tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required standard context standardcontext ctx standard context standardcontext tomcat add context addcontext tomcat add servlet addservlet ctx bug bug servlet ctx add servlet mapping addservletmapping bug tomcat start start threads bug thread threads bug thread bug thread count threads bug thread get port getport threads start wait threads finish bug thread count threads join string servlets hash set hashset string output result bug thread count system println threads get result getresult check result bug thread count string threads get result getresult split assert equals assertequals length assert equals assertequals assert false assertfalse servlets servlets add test test bug testbug add child addchild exception latch count down latch countdownlatch bug thread count tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required standard context standardcontext ctx standard context standardcontext tomcat add context addcontext standard wrapper standardwrapper wrapper standard wrapper standardwrapper wrapper set servlet name setservletname bug wrapper set servlet class setservletclass bug servlet get name getname ctx add child addchild wrapper ctx add servlet mapping addservletmapping bug tomcat start start threads bug thread threads bug thread bug thread count threads bug thread get port getport threads start wait threads finish bug thread count threads join string servlets hash set hashset string output result bug thread count system println threads get result getresult check result bug thread count string threads get result getresult split assert equals assertequals length assert equals assertequals assert false assertfalse servlets servlets add bug thread thread port string result bug thread port port port override byte chunk bytechunk res get url geturl http localhost port result res to string tostring i o exception ioexception ioe result ioe get message getmessage string get result getresult result single thread model singlethreadmodel servlet sets init method suppress warnings suppresswarnings deprecation bug servlet http servlet httpservlet javax servlet single thread model singlethreadmodel serialversionuid latch timeout data counter bug servlet hash code hashcode environments multiple instances object created hash code hashcode counter test standard wrapper teststandardwrapper counter increment and get incrementandget override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception latch await result latchawaitresult ensure threads instance servlet latch count down countdown latch await result latchawaitresult latch await latch timeout time unit timeunit seconds interrupted exception interruptedexception resp set content type setcontenttype text plain latch await result latchawaitresult resp get writer getwriter print data resp get writer getwriter print latch await failed resp get writer getwriter print resp get writer getwriter print counter override init servlet config servletconfig config servlet exception servletexception init config data
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina loader java io exception ioexception java util timer java util timer task timertask javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit fail org junit test org apache catalina context org apache catalina core standard context standardcontext org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest test webapp class loader memory leak testwebappclassloadermemoryleak tomcat base test tomcatbasetest test test timer thread leak testtimerthreadleak exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx standard context standardcontext standard context standardcontext ctx set clear references stop timer threads setclearreferencesstoptimerthreads tomcat add servlet addservlet ctx task servlet taskservlet task servlet taskservlet ctx add servlet mapping addservletmapping task servlet taskservlet tomcat start trigger timer thread creation get url geturl http localhost get port getport context ctx thread threads get threads getthreads thread thread threads thread thread is alive isalive task servlet taskservlet timer thread equals thread get name getname thread join thread is alive isalive fail timer thread running current threads array copied webapp class loader base webappclassloaderbase thread get threads getthreads current thread group thread group threadgroup thread current thread currentthread get thread group getthreadgroup find root thread group get parent getparent get parent getparent thread count guess threadcountguess active count activecount thread threads thread thread count guess threadcountguess thread count actual threadcountactual enum erate enumerate threads don threads thread count actual threadcountactual thread count guess threadcountguess thread count guess threadcountguess threads thread thread count guess threadcountguess note enum erate enumerate thread silently ignores threads fit array thread count actual threadcountactual enum erate enumerate threads threads task servlet taskservlet http servlet httpservlet serialversionuid string timer thread leaked thread override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception timer timer timer timer thread timer schedule local task localtask local task localtask timer task timertask override doesn
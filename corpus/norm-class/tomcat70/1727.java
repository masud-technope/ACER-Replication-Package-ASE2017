licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java byte array input stream bytearrayinputstream java byte array output stream bytearrayoutputstream java object input stream objectinputstream java object output stream objectoutputstream javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit assert false assertfalse org junit assert true asserttrue org junit test org apache catalina filters csrf prevention filter csrfpreventionfilter lru cache lrucache org apache catalina startup tomcat base test tomcatbasetest test csrf prevention filter testcsrfpreventionfilter tomcat base test tomcatbasetest string result non ce nonce constants csrf non ce nonce session attr test nonce testnonce http servlet response httpservletresponse wrapper csrf prevention filter csrfpreventionfilter csrf response wrapper csrfresponsewrapper non encoding response nonencodingresponse test nonce testnonce test test add non ce no query no anchor testaddnoncenoquerynoanchor exception assert equals assertequals test result non ce nonce wrapper encoderedirecturl test test test add non ce query no anchor testaddnoncequerynoanchor exception assert equals assertequals test result non ce nonce wrapper encoderedirecturl test test test add non ce no query anchor testaddnoncenoqueryanchor exception assert equals assertequals test result non ce nonce wrapper encoderedirecturl test test test add non ce query anchor testaddnoncequeryanchor exception assert equals assertequals test result non ce nonce wrapper encoderedirecturl test test test lru cache serializable testlrucacheserializable exception lru cache lrucache string cache lru cache lrucache string cache add key cache add key cache add key cache add key cache add key cache add key byte array output stream bytearrayoutputstream baos byte array output stream bytearrayoutputstream object output stream objectoutputstream oos object output stream objectoutputstream baos oos write object writeobject cache byte array input stream bytearrayinputstream bais byte array input stream bytearrayinputstream baos to byte array tobytearray object input stream objectinputstream ois object input stream objectinputstream bais suppress warnings suppresswarnings unchecked lru cache lrucache string cache lru cache lrucache string ois read object readobject cache add key assert false assertfalse cache key assert false assertfalse cache key assert true asserttrue cache key assert true asserttrue cache key assert true asserttrue cache key assert true asserttrue cache key assert true asserttrue cache key test test lru cache serializable performance testlrucacheserializableperformance exception test lru cache serializable testlrucacheserializable non encoding response nonencodingresponse tester http servlet response testerhttpservletresponse override string encoderedirecturl string url url override string encode redirect url encoderedirecturl string url url override string encodeurl string url url override string encode url encodeurl string url url
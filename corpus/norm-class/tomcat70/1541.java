licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java io exception ioexception java net uri java net uri syntax exception urisyntaxexception javax servlet filter chain filterchain javax servlet filter config filterconfig javax servlet servlet exception servletexception javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet response httpservletresponse org apache juli logging log org apache juli logging log factory logfactory single configuration point security measures required add ition addition http headers response http header security filter httpheadersecurityfilter filter base filterbase log log log factory logfactory get log getlog http header security filter httpheadersecurityfilter hsts string hsts header strict transport security hsts enabled hstsenabled hsts max age seconds hstsmaxageseconds hsts include sub domains hstsincludesubdomains string hsts header value hstsheadervalue click jacking protection string anti click jacking header frame options anti click jacking enabled anticlickjackingenabled x frame option xframeoption anti click jacking option anticlickjackingoption x frame option xframeoption deny uri anti click jacking uri anticlickjackinguri string anti click jacking header value anticlickjackingheadervalue block content sniffing string block content type sniffing header content type options string block content type sniffing header nosniff block content type sniffing enabled blockcontenttypesniffingenabled cross site scripting filter protection string xss protection header xss protection string xss protection header mode block xss protection enabled xssprotectionenabled override init filter config filterconfig filter config filterconfig servlet exception servletexception init filter config filterconfig build hsts header string builder stringbuilder hsts value hstsvalue string builder stringbuilder max age hsts value hstsvalue append hsts max age seconds hstsmaxageseconds hsts include sub domains hstsincludesubdomains hsts value hstsvalue append include sub domains includesubdomains hsts header value hstsheadervalue hsts value hstsvalue to string tostring anti click jacking string builder stringbuilder cj value cjvalue string builder stringbuilder anti click jacking option anticlickjackingoption header value headervalue anti click jacking option anticlickjackingoption x frame option xframeoption cj value cjvalue append cj value cjvalue append anti click jacking uri anticlickjackinguri anti click jacking header value anticlickjackingheadervalue cj value cjvalue to string tostring override do filter dofilter servlet request servletrequest request servlet response servletresponse response filter chain filterchain chain io exception ioexception servlet exception servletexception response http servlet response httpservletresponse http servlet response httpservletresponse http response httpresponse http servlet response httpservletresponse response response is committed iscommitted servlet exception servletexception get string getstring http header security filter httpheadersecurityfilter committed hsts hsts enabled hstsenabled request is secure issecure http response httpresponse set header setheader hsts header hsts header value hstsheadervalue anti click jacking anti click jacking enabled anticlickjackingenabled http response httpresponse set header setheader anti click jacking header anti click jacking header value anticlickjackingheadervalue block content type sniffing block content type sniffing enabled blockcontenttypesniffingenabled http response httpresponse set header setheader block content type sniffing header block content type sniffing header cross site scripting filter protection xss protection enabled xssprotectionenabled http response httpresponse set header setheader xss protection header xss protection header chain do filter dofilter request response override log get logger getlogger log override is config problem fatal isconfigproblemfatal trigger failure is hsts enabled ishstsenabled hsts enabled hstsenabled set hsts enabled sethstsenabled hsts enabled hstsenabled hsts enabled hstsenabled hsts enabled hstsenabled get hsts max age seconds gethstsmaxageseconds hsts max age seconds hstsmaxageseconds set hsts max age seconds sethstsmaxageseconds hsts max age seconds hstsmaxageseconds hsts max age seconds hstsmaxageseconds hsts max age seconds hstsmaxageseconds hsts max age seconds hstsmaxageseconds hsts max age seconds hstsmaxageseconds is hsts include sub domains ishstsincludesubdomains hsts include sub domains hstsincludesubdomains set hsts include sub domains sethstsincludesubdomains hsts include sub domains hstsincludesubdomains hsts include sub domains hstsincludesubdomains hsts include sub domains hstsincludesubdomains is anti click jacking enabled isanticlickjackingenabled anti click jacking enabled anticlickjackingenabled set anti click jacking enabled setanticlickjackingenabled anti click jacking enabled anticlickjackingenabled anti click jacking enabled anticlickjackingenabled anti click jacking enabled anticlickjackingenabled string get anti click jacking option getanticlickjackingoption anti click jacking option anticlickjackingoption to string tostring set anti click jacking option setanticlickjackingoption string anti click jacking option anticlickjackingoption x frame option xframeoption option x frame option xframeoption values option get header value getheadervalue equals ignore case equalsignorecase anti click jacking option anticlickjackingoption anti click jacking option anticlickjackingoption option illegal argument exception illegalargumentexception get string getstring http header security filter httpheadersecurityfilter click jack clickjack invalid anti click jacking option anticlickjackingoption string get anti click jacking uri getanticlickjackinguri anti click jacking uri anticlickjackinguri to string tostring is block content type sniffing enabled isblockcontenttypesniffingenabled block content type sniffing enabled blockcontenttypesniffingenabled set block content type sniffing enabled setblockcontenttypesniffingenabled block content type sniffing enabled blockcontenttypesniffingenabled block content type sniffing enabled blockcontenttypesniffingenabled block content type sniffing enabled blockcontenttypesniffingenabled set anti click jacking uri setanticlickjackinguri string anti click jacking uri anticlickjackinguri uri uri uri uri anti click jacking uri anticlickjackinguri uri syntax exception urisyntaxexception illegal argument exception illegalargumentexception anti click jacking uri anticlickjackinguri uri is xss protection enabled isxssprotectionenabled xss protection enabled xssprotectionenabled set xss protection enabled setxssprotectionenabled xss protection enabled xssprotectionenabled xss protection enabled xssprotectionenabled xss protection enabled xssprotectionenabled enum x frame option xframeoption deny deny origin same origin sameorigin string header value headervalue x frame option xframeoption string header value headervalue header value headervalue header value headervalue string get header value getheadervalue header value headervalue
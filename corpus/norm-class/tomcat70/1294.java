licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java io exception ioexception java net uri java net uri syntax exception urisyntaxexception java security key management exception keymanagementexception java security no such algorithm exception nosuchalgorithmexception java security principal java text message format messageformat java util array list arraylist java util arrays java util collections java util hash map hashmap java util hashtable java util iterator java util list java util map java util map entry java util javax naming authentication exception authenticationexception javax naming communication exception communicationexception javax naming composite name compositename javax naming context javax naming invalid name exception invalidnameexception javax naming javax naming name not found exception namenotfoundexception javax naming name parser nameparser javax naming naming enumeration namingenumeration javax naming naming exception namingexception javax naming partial result exception partialresultexception javax naming service unavailable exception serviceunavailableexception javax naming directory attribute javax naming directory attributes javax naming directory dir context dircontext javax naming directory initial dir context initialdircontext javax naming directory search controls searchcontrols javax naming directory search result searchresult javax naming ldap initial ldap context initialldapcontext javax naming ldap ldap context ldapcontext javax naming ldap start tls request starttlsrequest javax naming ldap start tls response starttlsresponse javax net ssl hostname verifier hostnameverifier javax net ssl ssl context sslcontext javax net ssl ssl session sslsession javax net ssl ssl socket factory sslsocketfactory org apache catalina lifecycle exception lifecycleexception org ietf jgss gss credential gsscredential implementation strong realm strong works directory server accessed java naming directory jndi api s apis constraints imp osed imposed data structure underlying directory server user authenticated represented individual element top level code dir context dircontext code accessed code connectionurl code property socket connection code connecturl code attempt code alternateurl code exists user element distinguished for med formed subst ituting substituting presented username pattern configured code user pattern userpattern code property alternatively code user pattern userpattern code property unique element located searching directory context code user search usersearch code pattern specifies search filter substitution username code user base userbase code property element base subtree users search base top level context code user subtree usersubtree code property code code search entire subtree directory context code code requests search current level user authenticated binding directory username password presented method code user password userpassword code property user authenticated retrieving attribute directory comparing explicitly presented user method code user password userpassword code property element user attribute named code user password userpassword code property user password attribute clear text cleartext string result passing clear text cleartext string code realm base realmbase digest code method standard digest support included code realm base realmbase code user considered authenticated presented credentials passed code realm base realmbase digest code equal retrieved user password attribute group users assigned role represented individual element top level code dir context dircontext code accessed code connectionurl code property element character is tics characteristics groups int erest interest selected search pattern configured code role search rolesearch code property code role search rolesearch code pattern option ally optionally includes pattern replace ments replacements distinguished username attribute user directory entry attribute code user role attribute userroleattribute code property authenticated user roles retrieved code role base rolebase code property element base search matching roles entire context searched code role subtree rolesubtree code property code code search entire subtree directory context code code requests search current level element includes attribute configured code role name rolename code property role represented element add ition addition roles represented values attribute user element configured code user role name userrolename code property role assigned user authenticated setting code common role commonrole code property role role doesn exist directory directory server nested roles search setting code role nested rolenested code code code code code role searches find nested roles note standard code security role code element web application deployment descriptor applications refer roles program matically programmatically names directory server strong todo strong support connection pooling including message format objects code authenticate code strong warning strong reported bug netscape provider code net scape netscape jndi ldap ldap context factory ldapcontextfactory resp ect respect authenticated existing user report http apache org bug zilla bugzilla bug cgi luck netscape updated provider code issue author john holman author craig mc clanahan mcclanahan jndi realm jndirealm realm base realmbase instance variables type authentication string authentication connection username server contact string connection name connectionname connection password server contact string connection password connectionpassword connection url server contact string connectionurl directory context linking directory server dir context dircontext context jndi context factory acquire initial context initialcontext assumes ldap server standard jndi ldap provider string context factory contextfactory sun jndi ldap ldap ctx factory ldapctxfactory aliases dereferenced search operations string deref aliases derefaliases constant holds environment property manner aliases dereferenced string deref aliases java naming ldap deref aliases derefaliases descriptive realm implementation string info org apache catalina realm jndi realm jndirealm descriptive realm implementation string jndi realm jndirealm protocol communication directory server string protocol ignore partial result exceptions partialresultexceptions iter ating iterating naming enum erations namingenumerations microsoft active directory returns ref errals referrals lead partial result exceptions partialresultexceptions stable detect exceptions refer ral referral ignore partial result exceptions partialresultexceptions ad compat adcompat handle ref errals referrals microsoft active directory returns ref errals referrals follow ref errals referrals follow caution dns ldap client lib resolve domain dns find ldap server string ref errals referrals base element user searches string user base userbase message format search user marking spot username string user search usersearch searching users search performed user authenticated link connection name connectionname link connection password connectionpassword anonymous connection user search as user usersearchasuser message format messageformat object current code user search usersearch code message format messageformat user search format usersearchformat search entire subtree matching users user subtree usersubtree attribute retrieve user password string user password userpassword attribute users directory entry search roles attribute nested search string user role attribute userroleattribute string ldap user patterns paths separated form distinguished user marking spot username user pattern userpattern multiple searches user string user pattern array userpatternarray message format form distinguished user marking spot username string user pattern userpattern array message format messageformat objects current code user pattern array userpatternarray code message format messageformat user pattern format array userpatternformatarray base element role searches string role base rolebase message format messageformat object current code role base rolebase code message format messageformat role base format rolebaseformat message format messageformat object current code role search rolesearch code message format messageformat role format roleformat attribute user entry roles user string user role name userrolename attribute roles held string role name rolename message format select roles user marking spot distinguished user configuration reference string role search rolesearch search entire subtree matching members hips memberships role subtree rolesubtree nested group order determine roles role nested rolenested searching user roles search performed user authenticated link connection name connectionname link connection password connectionpassword anonymous connection role search as user rolesearchasuser alternate url connect connectionurl fails string alternateurl number connection attempts greater alternate url connection attempt connectionattempt add role authenticated user string common role commonrole timeout milliseconds create connection directory seconds string connection timeout connectiontimeout size limit sizelimit count limit countlimit realm configured link user search usersearch limit size limit sizelimit time limit timelimit milliseconds realm configured link user search usersearch limit time limit timelimit delegate d delegated credentials spnego authenticator use delegate d credential usedelegatedcredential qop connection ldap server authentication code javax security sasl qop code environment property ldap connection string spnego delegation qop spnegodelegationqop conf tls connections use start tls usestarttls start tls response starttlsresponse tls list enabled cipher suites establishing tls connections code code cipher suites string cipher suites array ciphersuitesarray verifier host names hostnames starttls secured connection code code verifier hostname verifier hostnameverifier hostname verifier hostnameverifier link ssl socket factory sslsocketfactory connection starttls enabled ssl socket factory sslsocketfactory ssl socket factory sslsocketfactory link ssl socket factory sslsocketfactory code code factory string ssl socket factory class name sslsocketfactoryclassname comma separated list cipher suites starttls empty suites string cipher suites ciphersuites link hostname verifier hostnameverifier code code verifier string host name verifier class name hostnameverifierclassname ssl protocol starttls string ssl protocol sslprotocol properties type authentication string get authentication getauthentication authentication type authentication param authentication authentication set authentication setauthentication string authentication authentication authentication connection username realm string get connection name getconnectionname connection name connectionname connection username realm param connection name connectionname connection username set connection name setconnectionname string connection name connectionname connection name connectionname connection name connectionname connection password realm string get connection password getconnectionpassword connection password connectionpassword connection password realm param connection password connectionpassword connection password set connection password setconnectionpassword string connection password connectionpassword connection password connectionpassword connection password connectionpassword connection url realm string getconnectionurl connectionurl connection url realm param connectionurl connection url setconnectionurl string connectionurl connectionurl connectionurl jndi context factory realm string get context factory getcontextfactory context factory contextfactory jndi context factory realm param context factory contextfactory context factory set context factory setcontextfactory string context factory contextfactory context factory contextfactory context factory contextfactory deref aliases derefaliases setting java lang string get deref aliases getderefaliases deref aliases derefaliases deref aliases derefaliases searching directory param deref aliases derefaliases property deref aliases derefaliases set deref aliases setderefaliases java lang string deref aliases derefaliases deref aliases derefaliases deref aliases derefaliases protocol string get protocol getprotocol protocol protocol realm param protocol protocol set protocol setprotocol string protocol protocol protocol returns current settings handling partial result exceptions partialresultexceptions get ad compat getadcompat ad compat adcompat handle partial result exceptions partialresultexceptions ignore partial result exceptions partialresultexceptions set ad compat setadcompat ad compat adcompat ad compat adcompat ad compat adcompat returns current settings handling jndi ref errals referrals string get ref err als getreferrals ref errals referrals handle jndi ref errals referrals ignore follow javax naming context ref erral referral set ref err als setreferrals string ref errals referrals ref errals referrals ref errals referrals base element user searches string get user base getuserbase user base userbase base element user searches param user base userbase base element set user base setuserbase string user base userbase user base userbase user base userbase message format pattern selecting users realm string get user search getusersearch user search usersearch message format pattern selecting users realm param user search usersearch user search pattern set user search setusersearch string user search usersearch user search usersearch user search usersearch user search usersearch user search format usersearchformat user search format usersearchformat message format messageformat user search usersearch is user search as user isusersearchasuser user search as user usersearchasuser set user search as user setusersearchasuser user search as user usersearchasuser user search as user usersearchasuser user search as user usersearchasuser search subtree users flag get user subtree getusersubtree user subtree usersubtree search subtree users flag param user subtree usersubtree search flag set user subtree setusersubtree user subtree usersubtree user subtree usersubtree user subtree usersubtree user role attribute realm string get user role name getuserrolename user role name userrolename user role attribute realm param user role name userrolename user role userrole attribute set user role name setuserrolename string user role name userrolename user role name userrolename user role name userrolename base element role searches string get role base getrolebase role base rolebase base element role searches param role base rolebase base element set role base setrolebase string role base rolebase role base rolebase role base rolebase role base rolebase role base format rolebaseformat role base format rolebaseformat message format messageformat role base rolebase role attribute realm string get role name getrolename role name rolename role attribute realm param role name rolename role attribute set role name setrolename string role name rolename role name rolename role name rolename message format pattern selecting roles realm string get role search getrolesearch role search rolesearch message format pattern selecting roles realm param role search rolesearch role search pattern set role search setrolesearch string role search rolesearch role search rolesearch role search rolesearch role search rolesearch role format roleformat role format roleformat message format messageformat role search rolesearch is role search as user isrolesearchasuser role search as user rolesearchasuser set role search as user setrolesearchasuser role search as user rolesearchasuser role search as user rolesearchasuser role search as user rolesearchasuser search subtree roles flag get role subtree getrolesubtree role subtree rolesubtree search subtree roles flag param role subtree rolesubtree search flag set role subtree setrolesubtree role subtree rolesubtree role subtree rolesubtree role subtree rolesubtree nested group search flag flag get role nested getrolenested role nested rolenested search subtree roles flag param role nested rolenested nested group search flag set role nested setrolenested role nested rolenested role nested rolenested role nested rolenested password attribute retrieve user password string get user password getuserpassword user password userpassword password attribute retrieve user password param user password userpassword password attribute set user password setuserpassword string user password userpassword user password userpassword user password userpassword string get user role attribute getuserroleattribute user role attribute userroleattribute set user role attribute setuserroleattribute string user role attribute userroleattribute user role attribute userroleattribute user role attribute userroleattribute message format pattern selecting users realm string get user pattern getuserpattern user pattern userpattern message format pattern selecting users realm simple pattern multiple patterns separated parent heses parentheses myorg full ldap search strings supported syntax myorg valid complex search strings supported param user pattern userpattern user pattern set user pattern setuserpattern string user pattern userpattern user pattern userpattern user pattern userpattern user pattern userpattern user pattern array userpatternarray user pattern array userpatternarray parse user pattern string parseuserpatternstring user pattern userpattern len user pattern array userpatternarray length user pattern format array userpatternformatarray message format messageformat len len user pattern format array userpatternformatarray message format messageformat user pattern array userpatternarray getter property alternateurl property alternateurl string getalternateurl alternateurl setter property alternateurl param alternateurl property alternateurl setalternateurl string alternateurl alternateurl alternateurl common role string get common role getcommonrole common role commonrole common role param common role commonrole common role set common role setcommonrole string common role commonrole common role commonrole common role commonrole connection timeout string get connection timeout getconnectiontimeout connection timeout connectiontimeout connection timeout param timeout connection timeout set connection timeout setconnectiontimeout string timeout connection timeout connectiontimeout timeout get size limit getsizelimit size limit sizelimit set size limit setsizelimit size limit sizelimit size limit sizelimit size limit sizelimit get time limit gettimelimit time limit timelimit set time limit settimelimit time limit timelimit time limit timelimit time limit timelimit is use delegate d credential isusedelegatedcredential use delegate d credential usedelegatedcredential set use delegate d credential setusedelegatedcredential use delegate d credential usedelegatedcredential use delegate d credential usedelegatedcredential use delegate d credential usedelegatedcredential string get s pnego delegation qop getspnegodelegationqop spnego delegation qop spnegodelegationqop set s pnego delegation qop setspnegodelegationqop string spnego delegation qop spnegodelegationqop spnego delegation qop spnegodelegationqop spnego delegation qop spnegodelegationqop descriptive realm implementation version number format code description version code override string get info getinfo info flag starttls connections ldap server get use start tls getusestarttls use start tls usestarttls flag starttls connecting ldap server param use start tls usestarttls code starttls code set use start tls setusestarttls use start tls usestarttls use start tls usestarttls use start tls usestarttls list allowed cipher suites connections starttls string get cipher suites array getciphersuitesarray cipher suites ciphersuites cipher suites array ciphersuitesarray cipher suites array ciphersuitesarray cipher suites ciphersuites trim is empty isempty container log containerlog warn get string getstring jndi realm jndirealm empty cipher suites emptyciphersuites cipher suites array ciphersuitesarray cipher suites array ciphersuitesarray cipher suites ciphersuites trim split container log containerlog debug get string getstring jndi realm jndirealm cipher suites ciphersuites arrays as list aslist cipher suites array ciphersuitesarray cipher suites array ciphersuitesarray allowed cipher suites opening connection starttls cipher suites expected comma separated list param suites comma separated list allowed cipher suites set cipher suites setciphersuites string suites cipher suites ciphersuites suites link hostname verifier hostnameverifier connections starttls empty string verifier string get hostname verifier class name gethostnameverifierclassname hostname verifier hostnameverifier hostname verifier hostnameverifier get class getclass get canonical name getcanonicalname link hostname verifier hostnameverifier opening connections starttls instance constructed constructor param verifier class name verifierclassname link hostname verifier hostnameverifier constructed set hostname verifier class name sethostnameverifierclassname string verifier class name verifierclassname verifier class name verifierclassname host name verifier class name hostnameverifierclassname verifier class name verifierclassname trim host name verifier class name hostnameverifierclassname link hostname verifier hostnameverifier peer certificate verification opening connections starttls hostname verifier hostnameverifier get hostname verifier gethostnameverifier hostname verifier hostnameverifier hostname verifier hostnameverifier host name verifier class name hostnameverifierclassname host name verifier class name hostnameverifierclassname equals object construct instance constructinstance host name verifier class name hostnameverifierclassname hostname verifier hostnameverifier hostname verifier hostnameverifier hostname verifier hostnameverifier hostname verifier hostnameverifier illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid hostname verifier invalidhostnameverifier host name verifier class name hostnameverifierclassname class not found exception classnotfoundexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid hostname verifier invalidhostnameverifier host name verifier class name hostnameverifierclassname security exception securityexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid hostname verifier invalidhostnameverifier host name verifier class name hostnameverifierclassname instantiation exception instantiationexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid hostname verifier invalidhostnameverifier host name verifier class name hostnameverifierclassname illegal access exception illegalaccessexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid hostname verifier invalidhostnameverifier host name verifier class name hostnameverifierclassname link ssl socket factory sslsocketfactory opening connections starttls instance factory created constructor ssl socket factory sslsocketfactory link jndi realm jndirealm set ssl protocol setsslprotocol string set ssl protocol setsslprotocol string param factory class name factoryclassname factory constructed set ssl socket factory class name setsslsocketfactoryclassname string factory class name factoryclassname ssl socket factory class name sslsocketfactoryclassname factory class name factoryclassname ssl protocol connections starttls param protocol allowed ssl protocol names set ssl protocol setsslprotocol string protocol ssl protocol sslprotocol protocol list supported ssl protocols link ssl context sslcontext string get supported ssl protocols getsupportedsslprotocols ssl context sslcontext ssl context sslcontext ssl context sslcontext get default getdefault ssl context sslcontext getsupportedsslparameters get protocols getprotocols no such algorithm exception nosuchalgorithmexception runtime exception runtimeexception get string getstring jndi realm jndirealm exception object construct instance constructinstance string class name classname class not found exception classnotfoundexception instantiation exception instantiationexception illegal access exception illegalaccessexception clazz for name forname class name classname clazz new instance newinstance realm methods principal username credentials code code errors jdbc connection executing query don authenticate event log ged logged connection closed subsequent request automatically open param username username principal param credentials password credentials auth enticating authenticating username override principal authenticate string username string credentials dir context dircontext context principal principal ensure directory context context open time authenticate username principal authenticate context username credentials null pointer exception nullpointerexception container log containerlog info get string getstring jndi realm jndirealm exception retry context close context context open principal authenticate context username credentials communication exception communicationexception container log containerlog info get string getstring jndi realm jndirealm exception retry context close context context open principal authenticate context username credentials service unavailable exception serviceunavailableexception container log containerlog info get string getstring jndi realm jndirealm exception retry context close context context open principal authenticate context username credentials release context release context authenticated principal principal naming exception namingexception container log containerlog error get string getstring jndi realm jndirealm exception context close context container log containerlog is debug enabled isdebugenabled container log containerlog debug returning principal methods methods principal username credentials code code param context directory context param username username principal param credentials password credentials auth enticating authenticating username exception naming exception namingexception directory server error occurs principal authenticate dir context dircontext context string username string credentials naming exception namingexception username username equals credentials credentials equals container log containerlog is debug enabled isdebugenabled container log containerlog debug username empty returning principal user pattern array userpatternarray cur user pattern curuserpattern cur user pattern curuserpattern user pattern format array userpatternformatarray length cur user pattern curuserpattern retrieve user user user get user getuser context username credentials cur user pattern curuserpattern user check user credentials check credentials checkcredentials context user credentials search additional roles list string roles get roles getroles context user container log containerlog is debug enabled isdebugenabled iterator string roles iterator todo single log message has next hasnext container log containerlog debug role generic principal genericprincipal username credentials roles invalid name exception invalidnameexception ine container log containerlog warn get string getstring jndi realm jndirealm exception ine retrieve user user user get user getuser context username credentials user check user credentials check credentials checkcredentials context user credentials search additional roles list string roles get roles getroles context user container log containerlog is debug enabled isdebugenabled iterator string roles iterator todo single log message has next hasnext container log containerlog debug role create suitable principal user generic principal genericprincipal username credentials roles user object user username directory code code param context directory context param username username looked exception naming exception namingexception directory server error occurs get user getuser dir context dircontext string string user get user getuser dir context dircontext context string username naming exception namingexception get user getuser context username user object user username directory code code param context directory context param username username looked param credentials user credentials optional exception naming exception namingexception directory server error occurs get user getuser dir context dircontext string string user get user getuser dir context dircontext context string username string credentials naming exception namingexception get user getuser context username credentials user object user username directory code code code user password userpassword code configuration attribute attribute retrieved user directory entry code user role name userrolename code configuration attribute values attribute retrieved directory entry param context directory context param username username looked param credentials user credentials optional param cur user pattern curuserpattern user pattern format array userpatternformatarray exception naming exception namingexception directory server error occurs user get user getuser dir context dircontext context string username string credentials cur user pattern curuserpattern naming exception namingexception user user attributes retrieve user entry array list arraylist string list array list arraylist string user password userpassword list add user password userpassword user role name userrolename list add user role name userrolename user role attribute userroleattribute list add user role attribute userroleattribute string attr ids attrids string list size list to array toarray attr ids attrids pattern search user entry user pattern format array userpatternformatarray cur user pattern curuserpattern user get user by pattern getuserbypattern context username credentials attr ids attrids cur user pattern curuserpattern container log containerlog is debug enabled isdebugenabled container log containerlog debug user pattern user this user search as user thisusersearchasuser is user search as user isusersearchasuser this user search as user thisusersearchasuser user credentials add usercredentialsadd context username credentials user get user by search getuserbysearch context username attr ids attrids this user search as user thisusersearchasuser user credentials remove usercredentialsremove context container log containerlog is debug enabled isdebugenabled container log containerlog debug user search user user password userpassword credentials user role searches user user get user name getusername user getdn credentials user get roles getroles user get user role id getuserroleid user distinguished locate directory entry user username user object code code param context directory context param username username param attr ids attrids string names attributes param distinguished user retrieve exception naming exception namingexception directory server error occurs user get user by pattern getuserbypattern dir context dircontext context string username string attr ids attrids string naming exception namingexception attributes requested attr ids attrids attr ids attrids length user username required attributes user entry attributes attrs attrs context get attributes getattributes attr ids attrids name not found exception namenotfoundexception attrs retrieve user password userpassword string password user password userpassword password get attribute value getattributevalue user password userpassword attrs string user role attr value userroleattrvalue user role attribute userroleattribute user role attr value userroleattrvalue get attribute value getattributevalue user role attribute userroleattribute attrs retrieve values user role name userrolename attribute array list arraylist string roles user role name userrolename roles add attribute values addattributevalues user role name userrolename attrs roles user username password roles user role attr value userroleattrvalue code user pattern userpattern code configuration attribute locate directory entry user username user object code code param context directory context param username username param credentials user credentials optional param attr ids attrids string names attributes param cur user pattern curuserpattern user pattern format array userpatternformatarray exception naming exception namingexception directory server error occurs get user by pattern getuserbypattern dir context dircontext string string string user get user by pattern getuserbypattern dir context dircontext context string username string credentials string attr ids attrids cur user pattern curuserpattern naming exception namingexception user user username user pattern format array userpatternformatarray cur user pattern curuserpattern form user pattern string user pattern format array userpatternformatarray cur user pattern curuserpattern format string username user get user by pattern getuserbypattern context username attr ids attrids name not found exception namenotfoundexception naming exception namingexception user credentials add usercredentialsadd context credentials user get user by pattern getuserbypattern context username attr ids attrids user credentials remove usercredentialsremove context user search directory user object user username directory code code param context directory context param username username param attr ids attrids string names attributes retrieve exception naming exception namingexception directory server error occurs user get user by search getuserbysearch dir context dircontext context string username string attr ids attrids naming exception namingexception username user search format usersearchformat form search filter string filter user search format usersearchformat format string username search controls search controls searchcontrols constraints search controls searchcontrols user subtree usersubtree constraints set search scope setsearchscope search controls searchcontrols subtree scope constraints set search scope setsearchscope search controls searchcontrols one level onelevel scope constraints set count limit setcountlimit size limit sizelimit constraints set time limit settimelimit time limit timelimit attributes retrieved attr ids attrids attr ids attrids string constraints set returning attributes setreturningattributes attr ids attrids naming enumeration namingenumeration search result searchresult context search user base userbase filter constraints fail entries has more hasmore partial result exception partialresultexception ad compat adcompat result entry search result searchresult result check entries has more hasmore container log containerlog is info enabled isinfoenabled container log containerlog info username username multiple entries partial result exception partialresultexception ad compat adcompat string get distinguished name getdistinguishedname context user base userbase result container log containerlog is trace enabled istraceenabled container log containerlog trace entry username entry attributes attributes attrs result get attributes getattributes attrs retrieve user password userpassword string password user password userpassword password get attribute value getattributevalue user password userpassword attrs string user role attr value userroleattrvalue user role attribute userroleattribute user role attr value userroleattrvalue get attribute value getattributevalue user role attribute userroleattribute attrs retrieve values user role name userrolename attribute array list arraylist string roles user role name userrolename roles add attribute values addattributevalues user role name userrolename attrs roles user username password roles user role attr value userroleattrvalue close check user authenticated credentials code user password userpassword code configuration attribute credentials retrieved directory compared explicitly presented user presented credentials checked binding directory user param context directory context param user user authenticated param credentials credentials presented user exception naming exception namingexception directory server error occurs check credentials checkcredentials dir context dircontext context user user string credentials naming exception namingexception validated user password userpassword validated bind as user bindasuser context user credentials validated compare credentials comparecredentials context user credentials container log containerlog is trace enabled istraceenabled validated container log containerlog trace get string getstring jndi realm jndirealm authenticate success authenticatesuccess user get user name getusername container log containerlog trace get string getstring jndi realm jndirealm authenticate failure authenticatefailure user get user name getusername validated check credentials presented user match retrieved directory param context directory context param info user authenticated param credentials authentication credentials exception naming exception namingexception directory server error occurs compare credentials comparecredentials dir context dircontext context user info string credentials naming exception namingexception validate credentials user container log containerlog is trace enabled istraceenabled container log containerlog trace valid ating validating credentials info credentials string password info get password getpassword compare credentials comparecredentials credentials password check credentials binding directory user param context directory context param user user authenticated param credentials authentication credentials exception naming exception namingexception directory server error occurs bind as user bindasuser dir context dircontext context user user string credentials naming exception namingexception credentials user string user getdn validate credentials user container log containerlog is trace enabled istraceenabled container log containerlog trace valid ating validating credentials binding user user credentials add usercredentialsadd context credentials elicit ldap bind operation validated container log containerlog is trace enabled istraceenabled container log containerlog trace binding context get attributes getattributes validated authentication exception authenticationexception container log containerlog is trace enabled istraceenabled container log containerlog trace bind attempt failed user credentials remove usercredentialsremove context validated configure context credentials authentication param context dir context dircontext configure param distinguished user param credentials credentials user user credentials add usercredentialsadd dir context dircontext context string string credentials naming exception namingexception security environment bind user context add to environment addtoenvironment context security principal context add to environment addtoenvironment context security credentials credentials configure context link connection name connectionname link connection password connectionpassword anonymous connection attributes param context dir context dircontext configure user credentials remove usercredentialsremove dir context dircontext context naming exception namingexception restore original security environment connection name connectionname context add to environment addtoenvironment context security principal connection name connectionname context remove from environment removefromenvironment context security principal connection password connectionpassword context add to environment addtoenvironment context security credentials connection password connectionpassword context remove from environment removefromenvironment context security credentials list roles user roles user directory entry sup plemented supplemented directory search roles user length list returned param context directory context searching param user user checked exception naming exception namingexception directory server error occurs list string get roles getroles dir context dircontext context user user naming exception namingexception user string user getdn string username user get user name getusername string user role id userroleid user get user role id getuserroleid username container log containerlog is trace enabled istraceenabled container log containerlog trace get roles getroles start roles retrieved user entry list string list array list arraylist string list string user roles userroles user get roles getroles user roles userroles list add all addall user roles userroles common role commonrole list add common role commonrole container log containerlog is trace enabled istraceenabled container log containerlog trace list size user internal roles list size container log containerlog trace user internal role list configured role searches role format roleformat role name rolename list parameters search string filter role format roleformat format string dorfc encoding username user role id userroleid search controls searchcontrols controls search controls searchcontrols role subtree rolesubtree controls set search scope setsearchscope search controls searchcontrols subtree scope controls set search scope setsearchscope search controls searchcontrols one level onelevel scope controls set returning attributes setreturningattributes string role name rolename string base role base format rolebaseformat name parser nameparser context get name parser getnameparser parse string name parts nameparts string size size name parts nameparts base role base format rolebaseformat format name parts nameparts base perform configured search process naming enumeration namingenumeration search result searchresult search as user searchasuser context user base filter controls is role search as user isrolesearchasuser happen list hash map hashmap string string group map groupmap hash map hashmap string string has more hasmore search result searchresult result attributes attrs result get attributes getattributes attrs string dname get distinguished name getdistinguishedname context role base rolebase result string get attribute value getattributevalue role name rolename attrs dname group map groupmap dname partial result exception partialresultexception ad compat adcompat close container log containerlog is trace enabled istraceenabled entry string string entries group map groupmap entry set entryset container log containerlog trace entries size direct roles entry string string entry entries container log containerlog trace direct role entry get key getkey entry get value getvalue nested group search enabled perform searches nested groups group get role nested getrolenested efficient algorithm member of memberof algorithm practices directory groups avoids group slurping handles cyclic group members hips memberships http middle war e middleware int ernet internet dir details map string string new groups newgroups hash map hashmap string string group map groupmap new groups newgroups is empty isempty stores groups find iteration map string string new this round newthisround hash map hashmap string string entry string string group new groups newgroups entry set entryset filter role format roleformat format string group get key getkey group get value getvalue group get value getvalue container log containerlog is trace enabled istraceenabled container log containerlog trace perform nested group search base role base rolebase filter filter search as user searchasuser context user role base rolebase filter controls is role search as user isrolesearchasuser has more hasmore search result searchresult result attributes attrs result get attributes getattributes attrs string dname get distinguished name getdistinguishedname context role base rolebase result string get attribute value getattributevalue role name rolename attrs dname group map groupmap key set keyset dname group map groupmap dname new this round newthisround dname container log containerlog is trace enabled istraceenabled container log containerlog trace nested role dname partial result exception partialresultexception ad compat adcompat close new groups newgroups new this round newthisround list add all addall group map groupmap values list perform search context code code search as user searchasuser code search context credentials param context context search param user user bind param base base start search param filter filter search param controls controls search param search as user searchasuser code search user code credentials enumeration entries naming exception namingexception directory server error occurs naming enumeration namingenumeration search result searchresult search as user searchasuser dir context dircontext context user user string base string filter search controls searchcontrols controls search as user searchasuser naming exception namingexception naming enumeration namingenumeration search result searchresult search as user searchasuser user credentials add usercredentialsadd context user getdn user get password getpassword context search base filter controls search as user searchasuser user credentials remove usercredentialsremove context string representing attribute param attr id attrid attribute param attrs attributes required exception naming exception namingexception directory server error occurs string get attribute value getattributevalue string attr id attrid attributes attrs naming exception namingexception container log containerlog is trace enabled istraceenabled container log containerlog trace retrieving attribute attr id attrid attr id attrid attrs attribute attr attrs attr id attrid attr object attr string value string valuestring value string valuestring string value string valuestring to string tostring value string valuestring add values attribute list param attr id attrid attribute param attrs attributes values param values array list arraylist values exception naming exception namingexception directory server error occurs array list arraylist string add attribute values addattributevalues string attr id attrid attributes attrs array list arraylist string values naming exception namingexception container log containerlog is trace enabled istraceenabled container log containerlog trace retrieving values attribute attr id attrid attr id attrid attrs values values values array list arraylist string attribute attr attrs attr id attrid attr values naming enumeration namingenumeration attr get all getall has more hasmore string string values add partial result exception partialresultexception ad compat adcompat close values close open connection directory server realm param context directory context closed close dir context dircontext context opened connection context close tls start response startresponse tls tls close io exception ioexception container log containerlog error get string getstring jndi realm jndirealm tls close tlsclose close opened connection container log containerlog is debug enabled isdebugenabled container log containerlog debug closing directory context context close naming exception namingexception container log containerlog error get string getstring jndi realm jndirealm close context realm implementation override string get name getname password principal user override string get password getpassword string username string user password userpassword get user password getuserpassword user password userpassword user password userpassword is empty isempty user user get user getuser open username user user password user get password getpassword naming exception namingexception principal user override principal get principal getprincipal string username get principal getprincipal username override principal get principal getprincipal string username gss credential gsscredential gss credential gsscredential dir context dircontext context principal principal ensure directory context context open time authenticate username principal get principal getprincipal context username gss credential gsscredential communication exception communicationexception container log containerlog info get string getstring jndi realm jndirealm exception retry context close context context open principal get principal getprincipal context username gss credential gsscredential service unavailable exception serviceunavailableexception container log containerlog info get string getstring jndi realm jndirealm exception retry context close context context open principal get principal getprincipal context username gss credential gsscredential release context release context authenticated principal principal naming exception namingexception container log containerlog error get string getstring jndi realm jndirealm exception context close context principal user principal get principal getprincipal dir context dircontext context string username gss credential gsscredential gss credential gsscredential naming exception namingexception user user list string roles hashtable preserved environment preservedenvironment gss credential gsscredential is use delegate d credential isusedelegatedcredential preserve current context environment parameters preserved environment preservedenvironment context get environment getenvironment context context add to environment addtoenvironment context security authentication gssapi context add to environment addtoenvironment javax security sasl server authentication context add to environment addtoenvironment javax security sasl qop spnego delegation qop spnegodelegationqop note subject spnego authenticator subject do as doas user get user getuser context username user roles get roles getroles context user restore environment parameter restoreenvironmentparameter context context security authentication preserved environment preservedenvironment restore environment parameter restoreenvironmentparameter context javax security sasl server authentication preserved environment preservedenvironment restore environment parameter restoreenvironmentparameter context javax security sasl qop preserved environment preservedenvironment user generic principal genericprincipal user get user name getusername user get password getpassword roles gss credential gsscredential restore environment parameter restoreenvironmentparameter dir context dircontext context string parameter name parametername hashtable preserved environment preservedenvironment context remove from environment removefromenvironment parameter name parametername preserved environment preservedenvironment preserved environment preservedenvironment contains key containskey parameter name parametername context add to environment addtoenvironment parameter name parametername preserved environment preservedenvironment parameter name parametername naming exception namingexception open connection configured directory server realm exception naming exception namingexception directory server error occurs dir context dircontext open naming exception namingexception directory server connection open context context ensure directory context context create dir context createdircontext get directory context environment getdirectorycontextenvironment exception connection attempt connectionattempt container log containerlog info get string getstring jndi realm jndirealm exception retry context create dir context createdircontext get directory context environment getdirectorycontextenvironment reset connection times primary connection attempt connectionattempt context dir context dircontext create dir context createdircontext hashtable string string env naming exception namingexception use start tls usestarttls create tls dir context createtlsdircontext env initial dir context initialdircontext env ssl socket factory sslsocketfactory getsslsocketfactory ssl socket factory sslsocketfactory ssl socket factory sslsocketfactory ssl socket factory sslsocketfactory result ssl socket factory class name sslsocketfactoryclassname ssl socket factory class name sslsocketfactoryclassname trim equals result create socket factory from class name createsslsocketfactoryfromclassname ssl socket factory class name sslsocketfactoryclassname result create context factory from protocol createsslcontextfactoryfromprotocol ssl protocol sslprotocol ssl socket factory sslsocketfactory result result ssl socket factory sslsocketfactory create socket factory from class name createsslsocketfactoryfromclassname string class name classname object construct instance constructinstance class name classname ssl socket factory sslsocketfactory ssl socket factory sslsocketfactory illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl socket factory invalidsslsocketfactory class name classname class not found exception classnotfoundexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl socket factory invalidsslsocketfactory class name classname security exception securityexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl socket factory invalidsslsocketfactory class name classname instantiation exception instantiationexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl socket factory invalidsslsocketfactory class name classname illegal access exception illegalaccessexception illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl socket factory invalidsslsocketfactory class name classname ssl socket factory sslsocketfactory create context factory from protocol createsslcontextfactoryfromprotocol string protocol ssl context sslcontext ssl context sslcontext protocol ssl context sslcontext ssl context sslcontext get instance getinstance protocol ssl context sslcontext init ssl context sslcontext ssl context sslcontext get default getdefault ssl context sslcontext get socket factory getsocketfactory no such algorithm exception nosuchalgorithmexception list string allowed protocols allowedprotocols arrays as list aslist get supported ssl protocols getsupportedsslprotocols illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl protocol invalidsslprotocol protocol allowed protocols allowedprotocols key management exception keymanagementexception list string allowed protocols allowedprotocols arrays as list aslist get supported ssl protocols getsupportedsslprotocols illegal argument exception illegalargumentexception get string getstring jndi realm jndirealm invalid ssl protocol invalidsslprotocol protocol allowed protocols allowedprotocols create tls enabled ldap context ldapcontext start tls response starttlsresponse tls instance variable param env environment context creation configured link ldap context ldapcontext naming exception namingexception wrong negotiating connection dir context dircontext create tls dir context createtlsdircontext hashtable string string env naming exception namingexception map string object saved env savedenv hash map hashmap string object string key arrays as list aslist context security authentication context security credentials context security principal context security protocol object entry env remove key entry saved env savedenv key entry ldap context ldapcontext result result initial ldap context initialldapcontext env tls start tls response starttlsresponse result extended operation extendedoperation start tls request starttlsrequest get hostname verifier gethostnameverifier tls set hostname verifier sethostnameverifier get hostname verifier gethostnameverifier get cipher suites array getciphersuitesarray tls set enabled cipher suites setenabledciphersuites get cipher suites array getciphersuitesarray ssl session sslsession negotiate tls negotiate getsslsocketfactory container log containerlog debug get string getstring jndi realm jndirealm negotiated tls negotiatedtls negotiate get protocol getprotocol io exception ioexception naming exception namingexception get message getmessage result map entry string object saved entry savedentry saved env savedenv entry set entryset result add to environment addtoenvironment saved entry savedentry get key getkey saved entry savedentry get value getvalue result create directory context configuration java util hashtable configuration directory context hashtable string string get directory context environment getdirectorycontextenvironment hashtable string string env hashtable string string configure directory context environment container log containerlog is debug enabled isdebugenabled connection attempt connectionattempt container log containerlog debug connecting url connectionurl container log containerlog is debug enabled isdebugenabled connection attempt connectionattempt container log containerlog debug connecting url alternateurl env context initial context factory context factory contextfactory connection name connectionname env context security principal connection name connectionname connection password connectionpassword env context security credentials connection password connectionpassword connectionurl connection attempt connectionattempt env context provider url connectionurl alternateurl connection attempt connectionattempt env context provider url alternateurl authentication env context security authentication authentication protocol env context security protocol protocol ref errals referrals env context ref erral referral ref errals referrals deref aliases derefaliases env jndi realm jndirealm deref aliases deref aliases derefaliases connection timeout connectiontimeout env sun jndi ldap connect timeout connection timeout connectiontimeout env release connection recycle d recycled param context directory context release release dir context dircontext context pooling lifecycle methods prepare active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase start internal startinternal exception lifecycle exception lifecycleexception component detects fatal error prevents component override start internal startinternal lifecycle exception lifecycleexception check connection directory opened open naming exception namingexception container log containerlog error get string getstring jndi realm jndirealm open start internal startinternal gracefully terminate active methods component implement requirements link org apache catalina util lifecycle base lifecyclebase stop internal stopinternal exception lifecycle exception lifecycleexception component detects fatal error reported override stop internal stopinternal lifecycle exception lifecycleexception stop internal stopinternal close open directory server connection close context string ldap patterns user locations separated parent heses parentheses pseudo ldap search string format location location returns array paths real ldap search strings supported type param user pattern string userpatternstring string ldap search paths surrounded parent heses parentheses string parse user pattern string parseuserpatternstring string user pattern string userpatternstring user pattern string userpatternstring array list arraylist string path list pathlist array list arraylist string start paren loc startparenloc user pattern string userpatternstring index of indexof start paren loc startparenloc parens string user pattern string userpatternstring starting point startingpoint start paren loc startparenloc end paren loc endparenloc strings something else somethingelse user pattern string userpatternstring char at charat start paren loc startparenloc start paren loc startparenloc user pattern string userpatternstring char at charat start paren loc startparenloc start paren loc startparenloc user pattern string userpatternstring index of indexof start paren loc startparenloc end paren loc endparenloc user pattern string userpatternstring index of indexof start paren loc startparenloc user pattern string userpatternstring char at charat end paren loc endparenloc end paren loc endparenloc user pattern string userpatternstring index of indexof end paren loc endparenloc string next path part nextpathpart user pattern string userpatternstring substring start paren loc startparenloc end paren loc endparenloc path list pathlist add next path part nextpathpart starting point startingpoint end paren loc endparenloc start paren loc startparenloc user pattern string userpatternstring index of indexof starting point startingpoint path list pathlist to array toarray string string dorfc encoding string in string instring string builder stringbuilder buf string builder stringbuilder in string instring length in string instring length in string instring char at charat buf append buf append buf append buf append buf append buf append buf to string tostring string get distinguished name getdistinguishedname dir context dircontext context string base search result searchresult result naming exception namingexception result relative names returned result is relative isrelative container log containerlog is trace enabled istraceenabled container log containerlog trace search returned relative result get name getname name parser nameparser parser context get name parser getnameparser context name contextname parser parse context get name in name space getnameinnamespace base name basename parser parse base bug zilla bugzilla entry name entryname parser parse composite name compositename result get name getname context name contextname add all addall base name basename add all addall entry name entryname to string tostring string absolute name absolutename result get name getname container log containerlog is trace enabled istraceenabled container log containerlog trace search returned absolute result get name getname normalize running parser name parser nameparser parser context get name parser getnameparser uri user name uri usernameuri uri absolute name absolutename string path component pathcomponent user name uri usernameuri get path getpath empty path component path component pathcomponent length invalid name exception invalidnameexception search returned unparseable absolute absolute name absolutename parser parse path component pathcomponent substring to string tostring uri syntax exception urisyntaxexception invalid name exception invalidnameexception search returned unparseable absolute absolute name absolutename representing user user string username string string password list string roles string user role id userroleid user string username string string password list string roles string user role id userroleid username username password password roles roles collections empty list emptylist roles collections unmodifiable list unmodifiablelist roles user role id userroleid user role id userroleid string get user name getusername username string getdn string get password getpassword password list string get roles getroles roles string get user role id getuserroleid user role id userroleid
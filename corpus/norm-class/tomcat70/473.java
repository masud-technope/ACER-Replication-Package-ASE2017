licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat websocket java net uri java util queue java util concurrent count down latch countdownlatch java util concurrent time unit timeunit javax websocket client endpoint config clientendpointconfig javax websocket container provider containerprovider javax websocket session javax websocket web socket container websocketcontainer org junit org junit test org apache catalina context org apache catalina servlets default servlet defaultservlet org apache catalina startup tomcat org apache tomcat websocket tester message count client testermessagecountclient basic text basictext org apache tomcat websocket tester message count client testermessagecountclient tester program matic endpoint testerprogrammaticendpoint test web socket frame client testwebsocketframeclient web socket base test websocketbasetest test test connect to server endpoint testconnecttoserverendpoint exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener tester firehose server testerfirehoseserver config get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping tomcat start web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer client endpoint config clientendpointconfig client endpoint config clientendpointconfig client endpoint config clientendpointconfig builder create build session ws session wssession ws container wscontainer connect to server connecttoserver tester program matic endpoint testerprogrammaticendpoint client endpoint config clientendpointconfig uri localhost get port getport tester firehose server testerfirehoseserver config path count down latch countdownlatch latch count down latch countdownlatch tester firehose server testerfirehoseserver message count basic text basictext handler basic text basictext latch ws session wssession add message handler addmessagehandler handler ws session wssession get basic remote getbasicremote send text sendtext system println message waiting data ignore latch result message count test number messages arr ived arrived handler get latch getlatch await tester firehose server testerfirehoseserver wait time millis time unit timeunit milliseconds queue string messages handler get messages getmessages assert equals assertequals tester firehose server testerfirehoseserver message count messages size string message messages assert equals assertequals tester firehose server testerfirehoseserver message message test test connect to root endpoint testconnecttorootendpoint exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext ctx add application listener addapplicationlistener tester echo server testerechoserver config get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping context ctx tomcat add context addcontext foo ctx add application listener addapplicationlistener tester echo server testerechoserver config get name getname tomcat add servlet addservlet ctx default servlet defaultservlet ctx add servlet mapping addservletmapping tomcat start echo tester echotester echo tester echotester fixme client doesn handle response upgrade allowed server redirect root webapp avoid broken relative paths echo tester echotester foo echo tester echotester foo echo tester echotester string path exception web socket container websocketcontainer ws container wscontainer container provider containerprovider get web socket container getwebsocketcontainer client endpoint config clientendpointconfig client endpoint config clientendpointconfig client endpoint config clientendpointconfig builder create build session ws session wssession ws container wscontainer connect to server connecttoserver tester program matic endpoint testerprogrammaticendpoint client endpoint config clientendpointconfig uri localhost get port getport path count down latch countdownlatch latch count down latch countdownlatch basic text basictext handler basic text basictext latch ws session wssession add message handler addmessagehandler handler ws session wssession get basic remote getbasicremote send text sendtext latch result latchresult handler get latch getlatch await time unit timeunit seconds assert true asserttrue latch result latchresult queue string messages handler get messages getmessages assert equals assertequals messages size string message messages assert equals assertequals message ws session wssession close
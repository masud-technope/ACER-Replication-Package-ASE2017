licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception org junit org junit test org apache catalina container org apache catalina context org apache catalina engine org apache catalina globals org apache catalina host org apache catalina lifecycle org apache catalina lifecycle event lifecycleevent org apache catalina lifecycle listener lifecyclelistener org apache catalina lifecycle state lifecyclestate org apache catalina core standard context standardcontext org apache catalina core standard host standardhost org apache catalina util context name contextname org apache catalina util io tools iotools org apache tomcat util buf c converter cconverter purpose test automatic deployment features link host config hostconfig implementation test host config auto matic deployment testhostconfigautomaticdeployment tomcat base test tomcatbasetest context name contextname app context name contextname myapp file xml source file test deployment context xml file war xml source file test deployment context war file war xml copyxml source file test deployment contextcopyxmlfalse war file war xml copyxml source file test deployment contextcopyxmltrue war file war xml unpackwar source file test deployment contextunpackwarfalse war file war xml unpackwar source file test deployment contextunpackwartrue war file war source file test deployment no context nocontext war file war broken source file test deployment broken war file dir xml source file test deployment dir context dircontext file dir xml source meta inf file test deployment dir context dircontext meta inf file dir source file test deployment dir no context dirnocontext xml ext war dir dir xml reload redeploy string xml cookie xml context string war cookie war context string dir cookie dir context string cookie jsessionid file external override set up setup exception set up setup tomcat tomcat get tomcat instance gettomcatinstance external file get temporary directory gettemporarydirectory external external exists external mkdir fail unable create external test disable background thread tomcat get engine getengine set background processor delay setbackgroundprocessordelay enable deployer tomcat get host gethost add lifecycle listener addlifecyclelistener host config hostconfig disable deployment start tomcat get host gethost set deploy on startup setdeployonstartup clean test add delete on tear down adddeleteonteardown file tomcat based ir basedir conf add delete on tear down adddeleteonteardown external expected behaviour deployment xml file deployxml copyxml unpackwars xml war dir note context fail start valid doc base docbase test test deployment xml f testdeploymentxmlfff exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml t testdeploymentxmlfft exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml f testdeploymentxmlftf exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml t testdeploymentxmlftt exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml f testdeploymentxmltff exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml t testdeploymentxmltft exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml f testdeploymentxmlttf exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie test test deployment xml t testdeploymentxmlttt exception create xml in config base for appbase createxmlinconfigbaseforappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed xml cookie expected behaviour deployment xml file points external war deployxml copyxml unpackwars xml war dir notes war file app base appbase external war context xml file embedded external war file test test deployment xml external war xml f testdeploymentxmlexternalwarxmlfff exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml t testdeploymentxmlexternalwarxmlfft exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml f testdeploymentxmlexternalwarxmlftf exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml t testdeploymentxmlexternalwarxmlftt exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml f testdeploymentxmlexternalwarxmltff exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml t testdeploymentxmlexternalwarxmltft exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml f testdeploymentxmlexternalwarxmlttf exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external war xml t testdeploymentxmlexternalwarxmlttt exception file war create war createwar war xml source create xml in config base for external createxmlinconfigbaseforexternal war do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie expected behaviour deployment xml file points external dir deployxml copyxml unpackwars xml war dir notes context xml file embedded external dir file test test deployment xml external dir xml f testdeploymentxmlexternaldirxmlfff exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml t testdeploymentxmlexternaldirxmlfft exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml f testdeploymentxmlexternaldirxmlftf exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml t testdeploymentxmlexternaldirxmlftt exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml f testdeploymentxmlexternaldirxmltff exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml t testdeploymentxmlexternaldirxmltft exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml f testdeploymentxmlexternaldirxmlttf exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie test test deployment xml external dir xml t testdeploymentxmlexternaldirxmlttt exception file dir create dir in external createdirinexternal create xml in config base for external createxmlinconfigbaseforexternal dir do test deployment dotestdeployment lifecycle state lifecyclestate started xml cookie expected behaviour deployment war embedded xml file deployxml copyxml unpackwars xml war dir test test deployment war xml f testdeploymentwarxmlfff exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment war xml t testdeploymentwarxmlfft exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment war xml f testdeploymentwarxmlftf exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment war xml t testdeploymentwarxmlftt exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment war xml f testdeploymentwarxmltff exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate started war cookie test test deployment war xml t testdeploymentwarxmltft exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate started war cookie test test deployment war xml f testdeploymentwarxmlttf exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate started war cookie test test deployment war xml t testdeploymentwarxmlttt exception create war createwar war xml source do test deployment dotestdeployment lifecycle state lifecyclestate started war cookie expected behaviour deployment war embedded xml file deployxml copyxml unpackwars xml war dir test test deployment war f testdeploymentwarfff exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war t testdeploymentwarfft exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war f testdeploymentwarftf exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war t testdeploymentwarftt exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war f testdeploymentwartff exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war t testdeploymentwartft exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war f testdeploymentwarttf exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment war t testdeploymentwarttt exception create war createwar war source do test deployment dotestdeployment lifecycle state lifecyclestate started expected behaviour deployment dir embedded xml file deployxml copyxml unpackwars xml war dir test test deployment dir xml f testdeploymentdirxmlfff exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment dir xml t testdeploymentdirxmlfft exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment dir xml f testdeploymentdirxmlftf exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment dir xml t testdeploymentdirxmlftt exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate failed test test deployment dir xml f testdeploymentdirxmltff exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started dir cookie test test deployment dir xml t testdeploymentdirxmltft exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started dir cookie test test deployment dir xml f testdeploymentdirxmlttf exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started dir cookie test test deployment dir xml t testdeploymentdirxmlttt exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started dir cookie expected behaviour deployment dir embedded xml file deployxml copyxml unpackwars xml war dir test test deployment dir f testdeploymentdirfff exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir t testdeploymentdirfft exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir f testdeploymentdirftf exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir t testdeploymentdirftt exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir f testdeploymentdirtff exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir t testdeploymentdirtft exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir f testdeploymentdirttf exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started test test deployment dir t testdeploymentdirttt exception create dir in appbase createdirinappbase do test deployment dotestdeployment lifecycle state lifecyclestate started do test deployment dotestdeployment deployxml copyxml unpackwars lifecycle state lifecyclestate result state resultstate string cookie name cookiename result xml resultxml result war resultwar result dir resultdir exception tomcat tomcat get tomcat instance gettomcatinstance start instance tomcat start attributes standard host standardhost host standard host standardhost tomcat get host gethost host setdeployxml deployxml host setcopyxml copyxml host setunpackwars unpackwars trigger automatic deployment host background process backgroundprocess test context ctxt context tomcat get host gethost find child findchild app get path getpath result state resultstate assert null assertnull ctxt assert not null assertnotnull ctxt assert equals assertequals result state resultstate ctxt get state getstate assert equals assertequals cookie name cookiename ctxt get session cookie name getsessioncookiename file xml file get config base file getconfigbasefile host app get base name getbasename xml assert equals assertequals value of valueof result xml resultxml value of valueof xml is file isfile file war file get app base file getappbasefile host app get base name getbasename war assert equals assertequals value of valueof result war resultwar value of valueof war is file isfile file dir file host get app base getappbase app get base name getbasename assert equals assertequals value of valueof result dir resultdir value of valueof dir is directory isdirectory expected behaviour deletion files artifacts artifact artifacts remaining xml war ext dir removed xml war ext dir notes dir war dir war xml dir xml ext xml dir ext xml war xml dir war xml notes dir created unpackwars xml extracted war dir deployxml copyxml test test delete dir remove dir testdeletedirremovedir exception do test delete dotestdelete dir test test delete war remove war testdeletewarremovewar exception do test delete dotestdelete war test test delete war dir remove dir testdeletewardirremovedir exception do test delete dotestdelete dir war cookie test test delete war dir remove war testdeletewardirremovewar exception do test delete dotestdelete war test test delete xml remove xml testdeletexmlremovexml exception do test delete dotestdelete xml test test delete xml dir remove dir testdeletexmldirremovedir exception do test delete dotestdelete dir test test delete xml dir remove xml testdeletexmldirremovexml exception do test delete dotestdelete xml dir cookie test test delete xml dir remove xml copy xml testdeletexmldirremovexmlcopyxml exception standard host standardhost get tomcat instance gettomcatinstance get host gethost setcopyxml do test delete dotestdelete xml dir cookie test test delete xml extwar remove ext testdeletexmlextwarremoveext exception do test delete dotestdelete ext xml cookie test test delete xml extdir remove ext testdeletexmlextdirremoveext exception do test delete dotestdelete ext xml cookie test test delete xml extwar remove xml testdeletexmlextwarremovexml exception do test delete dotestdelete xml test test delete xml extdir remove xml testdeletexmlextdirremovexml exception do test delete dotestdelete xml test test delete xml extwar dir remove dir testdeletexmlextwardirremovedir exception do test delete dotestdelete dir xml cookie test test delete xml extwar dir remove ext testdeletexmlextwardirremoveext exception do test delete dotestdelete ext xml cookie test test delete xml extwar dir remove xml testdeletexmlextwardirremovexml exception do test delete dotestdelete xml test test delete xml war remove war testdeletexmlwarremovewar exception do test delete dotestdelete war test test delete xml war remove xml testdeletexmlwarremovexml exception do test delete dotestdelete xml war cookie test test delete xml war remove xml copy xml testdeletexmlwarremovexmlcopyxml exception standard host standardhost get tomcat instance gettomcatinstance get host gethost setcopyxml do test delete dotestdelete xml war cookie test test delete xml war dir remove dir testdeletexmlwardirremovedir exception do test delete dotestdelete dir war cookie test test delete xml war dir remove dir copy xml testdeletexmlwardirremovedircopyxml exception standard host standardhost get tomcat instance gettomcatinstance get host gethost setcopyxml do test delete dotestdelete dir war cookie test test delete xml war dir remove war testdeletexmlwardirremovewar exception do test delete dotestdelete war test test delete xml war dir remove war copy xml testdeletexmlwardirremovewarcopyxml exception standard host standardhost get tomcat instance gettomcatinstance get host gethost setcopyxml do test delete dotestdelete war test test delete xml war dir remove xml testdeletexmlwardirremovexml exception do test delete dotestdelete xml dir cookie test test delete xml war dir remove xml copy xml testdeletexmlwardirremovexmlcopyxml exception standard host standardhost get tomcat instance gettomcatinstance get host gethost setcopyxml do test delete dotestdelete xml war cookie do test delete dotestdelete start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to delete todelete result xml resultxml result war resultwar result dir resultdir string result cookie name resultcookiename exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost init file xml file ext file war file dir start xml startxml start external war startexternalwar start external dir startexternaldir xml create xml in config base for appbase createxmlinconfigbaseforappbase start external war startexternalwar ext create war createwar war xml source xml create xml in config base for external createxmlinconfigbaseforexternal ext start external dir startexternaldir ext create dir in external createdirinexternal xml create xml in config base for external createxmlinconfigbaseforexternal ext start war startwar war create war createwar war xml source start dir startdir dir create dir in appbase createdirinappbase start war startwar start external war startexternalwar start dir startdir host setunpackwars war dir context wardircontext locks war file anti resource loc king locking enable war deleted host set context class setcontextclass anti resource locking context antiresourcelockingcontext get name getname deploy files copied tomcat start host background process backgroundprocess remove file to delete todelete xml expand war expandwar delete xml ext expand war expandwar delete ext war expand war expandwar delete war dir expand war expandwar delete dir fail trigger auto deployment cycle host background process backgroundprocess context ctxt context host find child findchild app get name getname behaviour external resource deleted to delete todelete ext ext fail assert false assertfalse ext exists start external war startexternalwar ext fail assert true asserttrue ext is file isfile start external dir startexternaldir ext fail assert true asserttrue ext is directory isdirectory result xml resultxml xml fail assert true asserttrue xml is file isfile result war resultwar war fail assert true asserttrue war is file isfile result dir resultdir dir fail assert true asserttrue dir is directory isdirectory result xml resultxml start external war startexternalwar start external dir startexternaldir assert null assertnull ctxt result war resultwar result dir resultdir result xml resultxml assert not null assertnotnull ctxt assert equals assertequals lifecycle state lifecyclestate failed ctxt get state getstate assert null assertnull ctxt ctxt assert equals assertequals result cookie name resultcookiename ctxt get session cookie name getsessioncookiename expected behaviour modification files artifacts artifact artifacts remaining xml war ext dir modified xml war ext dir action dir war redeploy dir war redeploy xml redeploy dir xml redeploy ext reload war xml redeploy dir ext reload xml redeploy war reload xml redeploy dir war reload xml redeploy test test modify dir update dir testmodifydirupdatedir exception do test modify dotestmodify dir dir cookie test test modify war update war testmodifywarupdatewar exception do test modify dotestmodify war war cookie redeploy test test modify war dir update dir testmodifywardirupdatedir exception dir cookie tomcat assume dir expanded war do test modify dotestmodify dir dir cookie test test modify war dir update war testmodifywardirupdatewar exception do test modify dotestmodify war war cookie redeploy test test modify xml update xml testmodifyxmlupdatexml exception do test modify dotestmodify xml xml cookie redeploy lifecycle state lifecyclestate failed test test modify xml dir update dir testmodifyxmldirupdatedir exception do test modify dotestmodify dir xml cookie test test modify xml dir update xml testmodifyxmldirupdatexml exception do test modify dotestmodify xml xml cookie redeploy test test modify xml extwar update extwar testmodifyxmlextwarupdateextwar exception do test modify dotestmodify ext xml cookie reload test test modify xml extdir update extdir testmodifyxmlextdirupdateextdir exception do test modify dotestmodify ext xml cookie test test modify xml extwar update xml testmodifyxmlextwarupdatexml exception do test modify dotestmodify xml xml cookie redeploy test test modify xml extdir update xml testmodifyxmlextdirupdatexml exception do test modify dotestmodify xml xml cookie redeploy test test modify xml extwar dir update dir testmodifyxmlextwardirupdatedir exception do test modify dotestmodify dir xml cookie test test modify xml extwar dir update ext testmodifyxmlextwardirupdateext exception do test modify dotestmodify ext xml cookie reload test test modify xml extwar dir update xml testmodifyxmlextwardirupdatexml exception do test modify dotestmodify xml xml cookie redeploy test test modify xml war update war testmodifyxmlwarupdatewar exception do test modify dotestmodify war xml cookie reload test test modify xml war update xml testmodifyxmlwarupdatexml exception do test modify dotestmodify xml xml cookie redeploy test test modify xml war dir update dir testmodifyxmlwardirupdatedir exception do test modify dotestmodify dir xml cookie test test modify xml war dir update war testmodifyxmlwardirupdatewar exception do test modify dotestmodify war xml cookie reload test test modify xml war dir update xml testmodifyxmlwardirupdatexml exception do test modify dotestmodify xml xml cookie redeploy do test modify dotestmodify start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to modify tomodify result xml resultxml result war resultwar result dir resultdir string result cookie name resultcookiename result action resultaction exception do test modify dotestmodify start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to modify tomodify result xml resultxml result war resultwar result dir resultdir result cookie name resultcookiename result action resultaction lifecycle state lifecyclestate started do test modify dotestmodify start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to modify tomodify result xml resultxml result war resultwar result dir resultdir string result cookie name resultcookiename result action resultaction lifecycle state lifecyclestate result state resultstate exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost init file xml file ext file war file dir start xml startxml start external war startexternalwar start external dir startexternaldir xml create xml in config base for appbase createxmlinconfigbaseforappbase start external war startexternalwar ext create war createwar war xml source xml create xml in config base for external createxmlinconfigbaseforexternal ext start external dir startexternaldir ext create dir in appbase createdirinappbase xml create xml in config base for external createxmlinconfigbaseforexternal ext start war startwar war create war createwar war xml source start dir startdir dir create dir in appbase createdirinappbase start war startwar start external war startexternalwar start dir startdir host setunpackwars deploy files copied tomcat start host background process backgroundprocess modification time host config hostconfig detect to modify tomodify xml xml fail xml set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution ext ext fail ext set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution fail failed modified time external war file expected jvm bug java windows war war fail war set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution fail failed modified time war file expected jvm bug java windows dir dir fail dir set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution fail context old context oldcontext context host find child findchild app get name getname state tracker statetracker tracker state tracker statetracker old context oldcontext add lifecycle listener addlifecyclelistener tracker trigger auto deployment cycle host background process backgroundprocess context new context newcontext context host find child findchild app get name getname check result xml resultxml xml fail assert true asserttrue xml is file isfile result war resultwar war fail assert true asserttrue war is file isfile result dir resultdir dir fail assert true asserttrue dir is directory isdirectory result xml resultxml start external war startexternalwar start external dir startexternaldir assert null assertnull new context newcontext result war resultwar result dir resultdir result xml resultxml assert not null assertnotnull new context newcontext start external war startexternalwar start external dir startexternaldir assert equals assertequals lifecycle state lifecyclestate failed new context newcontext get state getstate assert equals assertequals lifecycle state lifecyclestate started new context newcontext get state getstate assert null assertnull new context newcontext new context newcontext assert equals assertequals result cookie name resultcookiename new context newcontext get session cookie name getsessioncookiename assert equals assertequals result state resultstate new context newcontext get state getstate result action resultaction assert same assertsame old context oldcontext new context newcontext assert equals assertequals tracker get history gethistory result action resultaction reload assert same assertsame old context oldcontext new context newcontext assert equals assertequals stop start stopstart tracker get history gethistory result action resultaction redeploy assert not same assertnotsame old context oldcontext new context newcontext init start context object assert equals assertequals stop after stopafter destroy tracker get history gethistory fail expected behaviour add ition addition files artifacts copyxml deployxml artifact artifacts remaining xml war ext dir xml war ext dir action dir war redeploy dir xml redeploy war reload xml redeploy dir war reload xml redeploy dir war ext redeploy ext redeploy dir xml redeploy failed dir xml redeploy dir xml redeploy addition file treated file modified additional actions war dir removed recreated depending unpackwars xml file ref ers refers external doc base docbase war dir app base appbase removed dir recreated external resource war unpackwars dir war exists unpackwars dir warning log ged logged dir detected war removed dir left deployed automatic deployment war external war exists context war treated dir treated previous bullet point test test addition war add dir testadditionwaradddir exception do test addition dotestaddition dir war cookie test test addition dir add war testadditiondiraddwar exception do test addition dotestaddition war war cookie redeploy test test addition xml add dir testadditionxmladddir exception do test addition dotestaddition dir xml cookie test test addition dir add xml testadditiondiraddxml exception do test addition dotestaddition xml xml cookie redeploy test test addition xml add war testadditionxmladdwar exception do test addition dotestaddition war xml cookie reload test test addition war add xml testadditionwaraddxml exception do test addition dotestaddition xml xml cookie redeploy test test addition xml war add dir testadditionxmlwaradddir exception do test addition dotestaddition dir xml cookie test test addition xml dir add war testadditionxmldiraddwar exception do test addition dotestaddition war xml cookie reload test test addition war dir add xml testadditionwardiraddxml exception do test addition dotestaddition xml xml cookie redeploy test test addition xml extwar add dir testadditionxmlextwaradddir exception do test addition dotestaddition dir xml cookie test test addition xml extdir add dir testadditionxmlextdiradddir exception do test addition dotestaddition dir xml cookie test test addition xml extwar add war testadditionxmlextwaraddwar exception do test addition dotestaddition war xml cookie test test addition xml extdir add war testadditionxmlextdiraddwar exception do test addition dotestaddition war xml cookie test test addition dir add xml extwar testadditiondiraddxmlextwar exception do test addition dotestaddition ext xml cookie redeploy test test addition war add xml extwar testadditionwaraddxmlextwar exception do test addition dotestaddition ext xml cookie redeploy test test addition dir add dir xml f testadditiondiradddirxmltf exception do test addition dotestaddition dir xml redeploy lifecycle state lifecyclestate failed test test addition dir add dir xml f testadditiondiradddirxmlff exception do test addition dotestaddition dir xml redeploy lifecycle state lifecyclestate failed test test addition dir add dir xml t testadditiondiradddirxmltt exception do test addition dotestaddition dir xml dir cookie redeploy lifecycle state lifecyclestate started test test addition dir add dir xml t testadditiondiradddirxmlft exception do test addition dotestaddition dir xml dir cookie redeploy lifecycle state lifecyclestate started do test addition dotestaddition start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to add toadd result xml resultxml result war resultwar result dir resultdir string result cookie name resultcookiename result action resultaction exception do test addition dotestaddition start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir to add toadd result xml resultxml result war resultwar result dir resultdir result cookie name resultcookiename result action resultaction lifecycle state lifecyclestate started do test addition dotestaddition start xml startxml start external war startexternalwar start external dir startexternaldir start war startwar start dir startdir copyxml deployxml to add toadd result xml resultxml result war resultwar result dir resultdir string result cookie name resultcookiename result action resultaction lifecycle state lifecyclestate exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost init file xml file ext file war file dir start xml startxml start external war startexternalwar start external dir startexternaldir xml create xml in config base for appbase createxmlinconfigbaseforappbase start external war startexternalwar ext create war createwar war xml source xml create xml in config base for external createxmlinconfigbaseforexternal ext start external dir startexternaldir ext create dir in external createdirinexternal xml create xml in config base for external createxmlinconfigbaseforexternal ext start war startwar war create war createwar war xml source start dir startdir dir create dir in appbase createdirinappbase to add toadd dir xml start war startwar start external war startexternalwar start dir startdir host setunpackwars host setcopyxml copyxml host setdeployxml deployxml deploy files copied tomcat start host background process backgroundprocess change file to add toadd xml xml xml create xml in config base for appbase createxmlinconfigbaseforappbase fail ext ext xml ext create war createwar war xml source xml create xml in config base for external createxmlinconfigbaseforexternal ext fail war war war create war createwar war xml source fail dir dir dir create dir in appbase createdirinappbase fail dir xml dir create dir xml in appbase createdirxmlinappbase xml get xml in config base for appbase getxmlinconfigbaseforappbase fail context old context oldcontext context host find child findchild app get name getname state tracker statetracker tracker state tracker statetracker old context oldcontext add lifecycle listener addlifecyclelistener tracker trigger auto deployment cycle host background process backgroundprocess context new context newcontext context host find child findchild app get name getname check result xml resultxml xml fail assert true asserttrue xml is file isfile result war resultwar war fail assert true asserttrue war is file isfile result dir resultdir dir fail assert true asserttrue dir is directory isdirectory result xml resultxml start external war startexternalwar start external dir startexternaldir assert null assertnull new context newcontext result war resultwar result dir resultdir result xml resultxml assert not null assertnotnull new context newcontext start external war startexternalwar start external dir startexternaldir assert equals assertequals lifecycle state lifecyclestate failed new context newcontext get state getstate assert equals assertequals lifecycle state lifecyclestate started new context newcontext get state getstate assert null assertnull new context newcontext new context newcontext assert equals assertequals result cookie name resultcookiename new context newcontext get session cookie name getsessioncookiename result action resultaction assert same assertsame old context oldcontext new context newcontext assert equals assertequals tracker get history gethistory result action resultaction reload assert same assertsame old context oldcontext new context newcontext assert equals assertequals stop start stopstart tracker get history gethistory result action resultaction redeploy new context newcontext fail assert equals assertequals new context newcontext get state getstate assert not same assertnotsame old context oldcontext new context newcontext init start context object assert equals assertequals stop after stopafter destroy tracker get history gethistory fail test context unpackwar setting context getunpackwar host getunpackwars host wins test testunpackwarfff exception do test unpack r dotestunpackwar test testunpackwarfft exception do test unpack r dotestunpackwar test testunpackwarftf exception do test unpack r dotestunpackwar test testunpackwarftt exception do test unpack r dotestunpackwar test testunpackwartff exception do test unpack r dotestunpackwar test testunpackwartft exception external war xml war do test unpack r dotestunpackwar test testunpackwarttf exception do test unpack r dotestunpackwar test testunpackwarttt exception do test unpack r dotestunpackwar do test unpack r dotestunpackwar unpackwars unpackwar external result dir resultdir exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost host setunpackwars unpackwars tomcat start file war unpackwar war create war createwar war xml unpackwar source external war create war createwar war xml unpackwar source external external create xml in config base for external createxmlinconfigbaseforexternal war host background process backgroundprocess file dir file host get app base getappbase app get base name getbasename assert equals assertequals value of valueof result dir resultdir value of valueof dir is directory isdirectory test test broken app with anti locking f testbrokenappwithantilockingf exception test broken app with anti locking testbrokenappwithantilocking test test broken app with anti locking t testbrokenappwithantilockingt exception test broken app with anti locking testbrokenappwithantilocking test broken app with anti locking testbrokenappwithantilocking unpackwars exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost host setunpackwars unpackwars file war create war createwar war broken source create xml in config base for external createxmlinconfigbaseforexternal war file dir file get app base file getappbasefile host app get base name getbasename tomcat start simulate deploy start tomcat get host gethost background process backgroundprocess assert true asserttrue war is file isfile unpackwars assert true asserttrue dir is directory isdirectory file create dir in appbase createdirinappbase with xml withxml io exception ioexception file dir file get app base file getappbasefile get tomcat instance gettomcatinstance get host gethost app get base name getbasename with xml withxml recurrsive copy recurrsivecopy dir xml source dir recurrsive copy recurrsivecopy dir source dir dir file create dir xml in appbase createdirxmlinappbase io exception ioexception file dir file get app base file getappbasefile get tomcat instance gettomcatinstance get host gethost app get base name getbasename meta inf recurrsive copy recurrsivecopy dir xml source meta inf dir dir file create dir in external createdirinexternal with xml withxml io exception ioexception file ext file external external war with xml withxml recurrsive copy recurrsivecopy dir xml source ext recurrsive copy recurrsivecopy dir source ext ext file create war createwar file src use appbase useappbase io exception ioexception file dest use appbase useappbase dest file get app base file getappbasefile get tomcat instance gettomcatinstance get host gethost app get base name getbasename war dest file external external war copy src dest host config hostconfig thinks war modified dest set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution dest file create xml in config base for appbase createxmlinconfigbaseforappbase io exception ioexception file xml get xml in config base for appbase getxmlinconfigbaseforappbase file parent xml get parent file getparentfile parent is directory isdirectory assert true asserttrue parent mkdirs copy xml source xml host config hostconfig thinks xml modified xml set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution xml file get xml in config base for appbase getxmlinconfigbaseforappbase host host get tomcat instance gettomcatinstance get host gethost file get config base file getconfigbasefile host app xml file create xml in config base for external createxmlinconfigbaseforexternal file ext io exception ioexception create xml in config base for external createxmlinconfigbaseforexternal ext file create xml in config base for external createxmlinconfigbaseforexternal file ext anti locking antilocking io exception ioexception file xml file get config base file getconfigbasefile get tomcat instance gettomcatinstance get host gethost app xml file parent xml get parent file getparentfile parent is directory isdirectory assert true asserttrue parent mkdirs file output stream fileoutputstream fos fos file output stream fileoutputstream xml string builder stringbuilder context string builder stringbuilder context append context session cookie name sessioncookiename context append xml cookie context append doc base docbase context append ext get absolute path getabsolutepath anti locking antilocking context append anti resource locking antiresourcelocking context append fos write context to string tostring get bytes getbytes c converter cconverter iso fos fos close host config hostconfig thinks xml modified xml set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution xml test test set context class name testsetcontextclassname exception tomcat tomcat get tomcat instance gettomcatinstance host host tomcat get host gethost host standard host standardhost standard host standardhost standard host standardhost standard host standardhost host standard host standardhost set context class setcontextclass tester context testercontext get name getname copy war file file war file get app base file getappbasefile host app get base name getbasename war copy war xml source war deploy copied war tomcat start host background process backgroundprocess check context context ctxt context host find child findchild app get name getname assert true asserttrue ctxt tester context testercontext anti resource locking context antiresourcelockingcontext standard context standardcontext override get anti resource locking getantiresourcelocking tester context testercontext standard context standardcontext functional change state tracker statetracker lifecycle listener lifecyclelistener string builder stringbuilder state history statehistory string builder stringbuilder override lifecycle event lifecycleevent lifecycle event lifecycleevent event string type event get type gettype type equals lifecycle start event type equals lifecycle event type equals lifecycle destroy event state history statehistory append type string get history gethistory state history statehistory to string tostring test context copyxml setting context copyxml host copyxml host wins external wa rs wars context xml exist test testcopyxmlfff exception do test copy l dotestcopyxml test testcopyxmlfft exception do test copy l dotestcopyxml test testcopyxmlftf exception do test copy l dotestcopyxml test testcopyxmlftt exception do test copy l dotestcopyxml test testcopyxmltff exception do test copy l dotestcopyxml test testcopyxmltft exception do test copy l dotestcopyxml test testcopyxmlttf exception do test copy l dotestcopyxml test testcopyxmlttt exception do test copy l dotestcopyxml do test copy l dotestcopyxml copy xml host copyxmlhost copy xml war copyxmlwar external result xml resultxml exception tomcat tomcat get tomcat instance gettomcatinstance standard host standardhost host standard host standardhost tomcat get host gethost host setcopyxml copy xml host copyxmlhost tomcat start file war copy xml war copyxmlwar war create war createwar war xml copyxml source external war create war createwar war xml copyxml source external external create xml in config base for external createxmlinconfigbaseforexternal war host background process backgroundprocess file xml file get config base file getconfigbasefile host app get base name getbasename xml assert equals assertequals value of valueof result xml resultxml value of valueof xml is file isfile context context context host find child findchild app get name getname external assert equals assertequals xml cookie context get session cookie name getsessioncookiename assert equals assertequals war cookie context get session cookie name getsessioncookiename methods comp ensate compensate methods file get config base file getconfigbasefile host host string path host get xml base getxmlbase path host get xml base getxmlbase string builder stringbuilder xml dir xmldir string builder stringbuilder conf container parent host get parent getparent parent engine xml dir xmldir append xml dir xmldir append parent get name getname xml dir xmldir append xml dir xmldir append host get name getname path xml dir xmldir to string tostring get canonical path getcanonicalpath path file get app base file getappbasefile host host get canonical path getcanonicalpath host get app base getappbase file get canonical path getcanonicalpath string path file file file path file base file system get property getproperty globals catalina base prop file is absolute isabsolute file file base path file get canonical file getcanonicalfile io exception ioexception file methods replace java nio file files methods tomcat tomcat methods intended robust good unit tests pass copy file src file dest io exception ioexception file input stream fileinputstream file output stream fileoutputstream file input stream fileinputstream src file output stream fileoutputstream dest io tools iotools flow close io exception ioexception close io exception ioexception dest set last modified setlastmodified system current time millis currenttimemillis host config hostconfig file modification resolution recurrsive copy recurrsivecopy file src file dest io exception ioexception dest mkdirs file files src list files listfiles file file files file new file newfile file dest file get name getname file is directory isdirectory recurrsive copy recurrsivecopy file new file newfile copy file new file newfile
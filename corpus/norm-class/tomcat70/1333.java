licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina connector java buffered writer bufferedwriter java io exception ioexception java writer javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit test org apache catalina context org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk test output buffer testoutputbuffer tomcat base test tomcatbasetest test test write speed testwritespeed exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext writing servlet writingservlet expected content length writing servlet writingservlet servlet writing servlet writingservlet tomcat add servlet addservlet root servlet servlet root add servlet mapping addservletmapping servlet servlet tomcat start byte chunk bytechunk byte chunk bytechunk writing servlet writingservlet expected content length get url geturl http localhost get port getport servlet assert equals assertequals http servlet response httpservletresponse assert equals assertequals writing servlet writingservlet expected content length get length getlength recycle get url geturl http localhost get port getport servlet use buffer usebuffer assert equals assertequals http servlet response httpservletresponse assert equals assertequals writing servlet writingservlet expected content length get length getlength recycle test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext bug servlet bug bug servlet tomcat add servlet addservlet root bug bug root add servlet mapping addservletmapping bug tomcat start byte chunk bytechunk byte chunk bytechunk get url geturl http localhost get port getport assert equals assertequals http servlet response httpservletresponse assert equals assertequals to string tostring writing servlet writingservlet http servlet httpservlet serialversionuid expected content length string write string writestring write count writecount writing servlet writingservlet write length writelength string builder stringbuilder string builder stringbuilder write length writelength append write string writestring to string tostring write count writecount expected content length write length writelength override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding iso writer resp get writer getwriter wrap buffer string use buffer str usebufferstr req get parameter getparameter use buffer usebuffer use buffer str usebufferstr buffered writer bufferedwriter start system nano time nanotime write count writecount write write string writestring use buffer str usebufferstr flush last run nano lastrunnano system nano time nanotime start system println write length write string writestring length buffered use buffer str usebufferstr time last run nano lastrunnano bug servlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception writer resp get writer getwriter write resp reset buffer resetbuffer write
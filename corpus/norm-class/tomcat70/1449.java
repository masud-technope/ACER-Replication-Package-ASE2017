licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina tribes group int erceptors interceptors java util arrays java util hash map hashmap java util org apache catalina tribes channel exception channelexception org apache catalina tribes channel message channelmessage org apache catalina tribes member org apache catalina tribes group channel interceptor base channelinterceptorbase org apache catalina tribes group interceptor payload interceptorpayload org apache catalina tribes x byte buffer xbytebuffer frag mentation fragmentation int erceptor interceptor splits large messages smaller messages ass embles assembles don large messages hogging sending sockets smaller messages configuration options order int eceptor orderinteceptor expire milliseconds fragments memory wait arrive seconds setting avoid out of memory errors outofmemoryerrors order int eceptor orderinteceptor max size maxsize max message size message size bytes tenth author filip hanik version frag mentation interceptor fragmentationinterceptor channel interceptor base channelinterceptorbase org apache juli logging log log org apache juli logging log factory logfactory get log getlog frag mentation interceptor fragmentationinterceptor hash map hashmap frag key fragkey frag collection fragcollection fragpieces hash map hashmap frag key fragkey frag collection fragcollection max size maxsize minute expiration expire deep clone deepclone override send message sendmessage member destination channel message channelmessage msg interceptor payload interceptorpayload payload channel exception channelexception size msg get message getmessage get length getlength frag size max size maxsize ok to process oktoprocess msg get options getoptions frag frag destination msg payload msg get message getmessage append frag send message sendmessage destination msg payload override message received messagereceived channel message channelmessage msg is frag isfrag x byte buffer xbytebuffer to boolean toboolean msg get message getmessage get bytes direct getbytesdirect msg get message getmessage get length getlength msg get message getmessage trim is frag isfrag def rag defrag msg message received messagereceived msg frag collection fragcollection get frag collection getfragcollection frag key fragkey key channel message channelmessage msg frag collection fragcollection coll fragpieces key coll fragpieces coll fragpieces key coll coll frag collection fragcollection msg fragpieces key coll coll remove frag collection removefragcollection frag key fragkey key fragpieces remove key def rag defrag channel message channelmessage msg frag key fragkey key frag key fragkey msg get unique id getuniqueid frag collection fragcollection coll get frag collection getfragcollection key msg coll add message addmessage channel message channelmessage msg deep clone deepclone coll complete remove frag collection removefragcollection key channel message channelmessage complete coll assemble message received messagereceived complete frag member destination channel message channelmessage msg interceptor payload interceptorpayload payload channel exception channelexception size msg get message getmessage get length getlength count size max size maxsize size max size maxsize channel message channelmessage messages channel message channelmessage count remaining size count channel message channelmessage tmp channel message channelmessage msg clone offset max size maxsize length math min remaining max size maxsize tmp get message getmessage clear tmp get message getmessage append msg get message getmessage get bytes direct getbytesdirect offset length add msg tmp get message getmessage append x byte buffer xbytebuffer to bytes tobytes tmp get message getmessage append add total messages tmp get message getmessage append x byte buffer xbytebuffer to bytes tobytes count tmp get message getmessage append count add frag flag flag x byte buffer xbytebuffer to bytes tobytes tmp get message getmessage append flag flag length tmp get message getmessage append messages tmp remaining length messages length send message sendmessage destination messages payload override heartbeat frag key fragkey fragpieces key set keyset object to array toarray length frag key fragkey key frag key fragkey key key expired get expire getexpire remove frag collection removefragcollection key exception log is error enabled iserrorenabled log error unable perform heartbeat clean frag int erceptor interceptor heartbeat get max size getmaxsize max size maxsize get expire getexpire expire set max size setmaxsize max size maxsize max size maxsize max size maxsize set expire setexpire expire expire expire frag collection fragcollection received system current time millis currenttimemillis channel message channelmessage msg x byte buffer xbytebuffer frags frag collection fragcollection channel message channelmessage msg total messages count x byte buffer xbytebuffer to int toint msg get message getmessage get bytes direct getbytesdirect msg get message getmessage get length getlength frags x byte buffer xbytebuffer count msg msg add message addmessage channel message channelmessage msg remove total messages msg get message getmessage trim msg x byte buffer xbytebuffer to int toint msg get message getmessage get bytes direct getbytesdirect msg get message getmessage get length getlength remove msg msg get message getmessage trim frags msg get message getmessage complete result frags length result result frags result channel message channelmessage assemble complete illegal state exception illegalstateexception fragments missing buffer size buffersize frags length buffer size buffersize frags get length getlength x byte buffer xbytebuffer buf x byte buffer xbytebuffer buffer size buffersize msg set message setmessage buf frags length msg get message getmessage append frags get bytes direct getbytesdirect frags get length getlength msg expired expire system current time millis currenttimemillis received expire frag key fragkey unique id uniqueid received system current time millis currenttimemillis frag key fragkey unique id uniqueid override hash code hashcode x byte buffer xbytebuffer to int toint unique id uniqueid override equals object frag key fragkey arrays equals unique id uniqueid frag key fragkey unique id uniqueid expired expire system current time millis currenttimemillis received expire
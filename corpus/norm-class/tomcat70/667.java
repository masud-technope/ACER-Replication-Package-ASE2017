licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina ssi java io exception ioexception java print writer printwriter java reader java string writer stringwriter java util hash map hashmap java util locale java util string tokenizer stringtokenizer org apache catalina util io tools iotools entry point ssi processing actual parsing delegating ssi mediator ssimediator ssi command ssicommand ssi external resolver ssiexternalresolver author dan sandberg author david becker ssi processor ssiprocessor start pattern string command start pattern string command buffer size ssi external resolver ssiexternalresolver ssi external resolver ssiexternalresolver hash map hashmap string ssi command ssicommand commands hash map hashmap string ssi command ssicommand debug allow exec allowexec ssi processor ssiprocessor ssi external resolver ssiexternalresolver ssi external resolver ssiexternalresolver debug allow exec allowexec ssi external resolver ssiexternalresolver ssi external resolver ssiexternalresolver debug debug allow exec allowexec allow exec allowexec add built in commands addbuiltincommands add built in commands addbuiltincommands add command addcommand config ssi config ssiconfig add command addcommand echo ssi echo ssiecho allow exec allowexec add command addcommand exec ssi exec ssiexec add command addcommand include ssi include ssiinclude add command addcommand flastmod ssi f last mod ssiflastmod add command addcommand fsize ssi f size ssifsize add command addcommand print env printenv ssi p rint env ssiprintenv add command addcommand ssi set ssiset ssi conditional ssiconditional ssi conditional ssiconditional ssi conditional ssiconditional add command addcommand ssi conditional ssiconditional add command addcommand elif ssi conditional ssiconditional add command addcommand end if endif ssi conditional ssiconditional add command addcommand ssi conditional ssiconditional add command addcommand string ssi command ssicommand command commands command process file server side commands reading reader writing processed version writer note str eaming streaming converting array param reader reader read file ssi s ssis param writer writer write file ssi s ssis processed current modified ssi commands io exception ioexception horribly awry ssi command ssicommand cat ches catches normal io exceptions ioexceptions process reader reader last modified date lastmodifieddate print writer printwriter writer io exception ioexception ssi mediator ssimediator ssi mediator ssimediator ssi mediator ssimediator ssi external resolver ssiexternalresolver last modified date lastmodifieddate debug string writer stringwriter string writer stringwriter string writer stringwriter io tools iotools flow reader string writer stringwriter string file contents filecontents string writer stringwriter to string tostring string writer stringwriter string builder stringbuilder command string builder stringbuilder file contents filecontents length file contents filecontents char at charat command start char at charat char cmp charcmp file contents filecontents command start command start length clear command string command set length setlength ssi mediator ssimediator get conditional state getconditionalstate process conditional commands only processconditionalcommandsonly writer write command char at charat char cmp charcmp file contents filecontents command command length string str cmd strcmd parse cmd parsecmd command debug ssi external resolver ssiexternalresolver log ssi processor ssiprocessor process processing command str cmd strcmd string param names paramnames parse param names parseparamnames command str cmd strcmd length string param values paramvalues parse param values parseparamvalues command str cmd strcmd length param names paramnames length fetch time change loop string config err msg configerrmsg ssi mediator ssimediator get config err msg getconfigerrmsg ssi command ssicommand ssi command ssicommand commands str cmd strcmd to lower case tolowercase locale english string error message errormessage ssi command ssicommand error message errormessage unknown command str cmd strcmd param values paramvalues error message errormessage error parsing directive parameters param names paramnames length param values paramvalues length error message errormessage parameter names count match parameter values count command str cmd strcmd command conditional ssi mediator ssimediator get conditional state getconditionalstate process conditional commands only processconditionalcommandsonly ssi command ssicommand ssi conditional ssiconditional lmd ssi command ssicommand process ssi mediator ssimediator str cmd strcmd param names paramnames param values paramvalues writer lmd last modified date lastmodifieddate last modified date lastmodifieddate lmd error message errormessage ssi external resolver ssiexternalresolver log error message errormessage writer write config err msg configerrmsg command append ssi stop processing exception ssistopprocessingexception last modified date lastmodifieddate parse string builder stringbuilder param type token called code request handler requesthandler code param cmd type string builder stringbuilder type string string parse param names parseparamnames string builder stringbuilder cmd start b idx bidx start quotes string builder stringbuilder ret buf retbuf string builder stringbuilder b idx bidx cmd length b idx bidx cmd length is space isspace cmd char at charat b idx bidx b idx bidx b idx bidx cmd length b idx bidx cmd length cmd char at charat b idx bidx ret buf retbuf append cmd char at charat b idx bidx b idx bidx ret buf retbuf append quotes escaped b idx bidx cmd length quotes b idx bidx cmd char at charat b idx bidx skip escaped characters escaped escaped escaped quotes escaped string tokenizer stringtokenizer str string tokenizer stringtokenizer ret buf retbuf to string tostring string ret string retstring string str count tokens counttokens str has more tokens hasmoretokens ret string retstring str next token nexttoken trim ret string retstring string parse param values parseparamvalues string builder stringbuilder cmd start count val index valindex string vals string count string builder stringbuilder string builder stringbuilder end quote endquote b idx bidx start b idx bidx cmd length b idx bidx b idx bidx cmd length is quote isquote cmd char at charat b idx bidx b idx bidx b idx bidx cmd length end quote endquote cmd char at charat b idx bidx escaped b idx bidx cmd length b idx bidx cmd char at charat b idx bidx escaped escaped end quote endquote escaped leave escape string escaped append escaped append b idx bidx cmd length vals val index valindex to string tostring delete length vals string parse cmd parsecmd string builder stringbuilder cmd first letter firstletter last letter lastletter cmd length cmd char at charat character is letter isletter first letter firstletter first letter firstletter last letter lastletter is space isspace last letter lastletter first letter firstletter cmd substring first letter firstletter last letter lastletter char cmp charcmp string buf string command buf region matches regionmatches command command length is space isspace is quote isquote
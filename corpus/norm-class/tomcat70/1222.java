licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina connector java file java io exception ioexception java output stream outputstream java print writer printwriter javax servlet async context asynccontext javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit org junit test org apache catalina context org apache catalina wrapper org apache catalina startup simple http client simplehttpclient org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf c converter cconverter org apache tomcat util buf byte chunk bytechunk test coyote adapter testcoyoteadapter tomcat base test tomcatbasetest string text bytes string builder stringbuilder string builder stringbuilder append abc def abcdef text to string tostring bytes text get bytes getbytes c converter cconverter utf test test path parms root non e testpathparmsrootnone exception path param test pathparamtest test test path parms foo non e testpathparmsfoonone exception path param test pathparamtest foo test test path parms root session only testpathparmsrootsessiononly exception path param test pathparamtest jsessionid test test path parms foo session only testpathparmsfoosessiononly exception path param test pathparamtest foo jsessionid test test path parms foo session dummy testpathparmsfoosessiondummy exception path param test pathparamtest foo jsessionid dummy test test path parms foo session dummy value testpathparmsfoosessiondummyvalue exception path param test pathparamtest foo jsessionid dummy test test path parms foo session value testpathparmsfoosessionvalue exception path param test pathparamtest foo jsessionid test test path parms foo session bar testpathparmsfoosessionbar exception path param test pathparamtest foo jsessionid bar test test path params redirect testpathparamsredirect exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance real doc base docbase don java tmp dir tmpdir writable file doc base docbase file get temporary directory gettemporarydirectory test coyote adapter testcoyoteadapter add delete on tear down adddeleteonteardown doc base docbase doc base docbase mkdirs doc base docbase is directory isdirectory fail failed create doc base docbase to string tostring create folder trigger redirect file foo file doc base docbase foo add delete on tear down adddeleteonteardown foo foo mkdirs foo is directory isdirectory fail unable create foo directory doc base docbase context ctx tomcat add context addcontext doc base docbase get absolute path getabsolutepath tomcat add servlet addservlet ctx servlet path param servlet pathparamservlet ctx add servlet mapping addservletmapping servlet tomcat start test path testpath test path testpath jsessionid test path testpath foo jsessionid test path testpath foo jsessionid dummy test path testpath foo jsessionid dummy test path testpath foo jsessionid test path testpath foo jsessionid bar path param test pathparamtest string path string expected exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext tomcat add servlet addservlet ctx servlet path param servlet pathparamservlet ctx add servlet mapping addservletmapping servlet tomcat start byte chunk bytechunk res get url geturl http localhost get port getport path assert equals assertequals expected res to string tostring test path testpath string path string expected exception byte chunk bytechunk res get url geturl http localhost get port getport path assert equals assertequals expected res to string tostring path param servlet pathparamservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain print writer printwriter resp get writer getwriter string session id sessionid req get requested session id getrequestedsessionid session id sessionid session id sessionid write session id sessionid test test path param ext root no param testpathparamextrootnoparam exception path param ext enion test pathparamexteniontest test app testapp blah txt test test path param ext level testpathparamextlevel no param noparam exception path param ext enion test pathparamexteniontest test app testapp blah blah txt test test path param ext level testpathparamextlevel with param withparam exception path param ext enion test pathparamexteniontest test app testapp blah blah txt path param ext enion test pathparamexteniontest string path string expected exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext test app testapp tomcat add servlet addservlet ctx servlet path param servlet pathparamservlet ctx add servlet mapping addservletmapping txt servlet tomcat start byte chunk bytechunk res get url geturl http localhost get port getport path assert equals assertequals expected res to string tostring test test bug testbug exception utf do test uri decoding dotesturidecoding foo utf foo test test bug testbug exception valid utf do test uri decoding dotesturidecoding foo utf foo test test bug testbug exception partial utf do test uri decoding dotesturidecoding foo utf foo test test bug testbug exception invalid utf do test uri decoding dotesturidecoding foo utf foo test test bug testbug exception invalid utf do test uri decoding dotesturidecoding foo utf foo do test uri decoding dotesturidecoding string path string encoding string expected path info expectedpathinfo exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance tomcat get connector getconnector seturiencoding encoding file system doc base docbase required context ctx tomcat add context addcontext path info servlet pathinfoservlet servlet path info servlet pathinfoservlet tomcat add servlet addservlet ctx servlet servlet ctx add servlet mapping addservletmapping servlet tomcat start get url geturl http localhost get port getport path byte chunk bytechunk assert equals assertequals http servlet response httpservletresponse assert equals assertequals expected path info expectedpathinfo servlet get path info getpathinfo path info servlet pathinfoservlet http servlet httpservlet serialversionuid string path info pathinfo string get path info getpathinfo path info pathinfo override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception thread safe path info pathinfo req get path info getpathinfo test test bug testbug exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext async servlet asyncservlet servlet async servlet asyncservlet wrapper tomcat add servlet addservlet ctx async servlet set async supported setasyncsupported ctx add servlet mapping addservletmapping async async tomcat start simple http client simplehttpclient client simple http client simplehttpclient override is response body k isresponsebodyok string request async http simple http client simplehttpclient crlf host simple http client simplehttpclient crlf simple http client simplehttpclient crlf client set port setport get port getport client set request setrequest string request client connect client send request sendrequest string client read line readline length log info sub sequence subsequence client disconnect wait server thread thread servlet get thread getthread start time starttime system nano time nanotime join end time endtime system nano time nanotime log info waited servlet thread end time endtime start time starttime assert true asserttrue servlet is completed iscompleted async servlet asyncservlet http servlet httpservlet serialversionuid hack won work gen erally generally servlets expected handle request thread completed thread get thread getthread is completed iscompleted completed override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf output stream outputstream resp get output stream getoutputstream async context asynccontext async ctxt asyncctxt req start async startasync async ctxt asyncctxt set timeout settimeout thread runnable override write fails write bytes flush thread sleep exception log info exception caught async ctxt asyncctxt complete completed set name setname test bug testbug start
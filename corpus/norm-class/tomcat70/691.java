licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina users java util array list arraylist java util iterator org apache catalina group org apache catalina role org apache catalina user database userdatabase org apache catalina util request util requestutil concrete implementation link org apache catalina user link memory user database memoryuserdatabase implementation link user database userdatabase author craig mc clanahan mcclanahan memory user memoryuser abstract user abstractuser constructor factory method link memory user database memoryuserdatabase param database link memory user database memoryuserdatabase owns user param username log on logon username user param password log on logon password user param full name fullname full user memory user memoryuser memory user database memoryuserdatabase database string username string password string full name fullname database database set username setusername username set password setpassword password set full name setfullname full name fullname instance variables link memory user database memoryuserdatabase owns user memory user database memoryuserdatabase database link group user member array list arraylist group groups array list arraylist group link role user array list arraylist role roles array list arraylist role properties link group user belongs override iterator group get groups getgroups groups groups iterator link role assigned user override iterator role get roles getroles roles roles iterator link user database userdatabase user defined override user database userdatabase get user database getuserdatabase database methods add link group user belongs param group group override add group addgroup group group groups groups group groups add group add link role assigned user param role role override add role addrole role role roles roles role roles add role user group param group group check override is in group isingroup group group groups groups group user assigned link role method strong strong check roles inherited based link group membership param role role check override is in role isinrole role role roles roles role remove link group user belongs param group group override remove group removegroup group group groups groups remove group remove link group user belongs override remove groups removegroups groups groups clear remove link role assigned user param role role override remove role removerole role role roles roles remove role remove link role assigned user override remove roles removeroles roles roles clear string representation user xml format strong implementation note strong compatibility reader processes entry accept code username code code code username property string to xml toxml string builder stringbuilder string builder stringbuilder user username append request util requestutil filter username append password append request util requestutil filter password append full name fullname append full name fullname append request util requestutil filter full name fullname append groups groups size append groups iterator group values groups iterator values has next hasnext append append request util requestutil filter values get group name getgroupname append roles roles size append roles iterator role values roles iterator values has next hasnext append append request util requestutil filter values get role name getrolename append append to string tostring string representation user override string to string tostring string builder stringbuilder string builder stringbuilder user username append request util requestutil filter username append full name fullname append full name fullname append request util requestutil filter full name fullname append groups groups size append groups iterator group values groups iterator values has next hasnext append append request util requestutil filter values get group name getgroupname append roles roles size append roles iterator role values roles iterator values has next hasnext append append request util requestutil filter values get role name getrolename append to string tostring
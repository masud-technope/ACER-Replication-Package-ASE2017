licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net jsse java byte array input stream bytearrayinputstream java io exception ioexception java input stream inputstream java net socket exception socketexception java security cert certificate java security cert certificate factory certificatefactory java util map java util weak hash map weakhashmap javax net ssl handshake completed event handshakecompletedevent javax net ssl handshake completed listener handshakecompletedlistener javax net ssl ssl exception sslexception javax net ssl ssl session sslsession javax net ssl ssl socket sslsocket javax security cert certificate org apache tomcat util net ssl session manager sslsessionmanager org apache tomcat util net ssl support sslsupport org apache tomcat util res string manager stringmanager jsse support jssesupport ssl support sslsupport ssl session manager sslsessionmanager org apache juli logging log log org apache juli logging log factory logfactory get log getlog jsse support jssesupport string manager stringmanager string manager stringmanager get manager getmanager org apache tomcat util net jsse res map ssl session sslsession integer key size cache keysizecache weak hash map weakhashmap ssl session sslsession integer ssl socket sslsocket ssl ssl session sslsession session listener listener listener jsse support jssesupport ssl socket sslsocket sock ssl sock session sock get session getsession sock add handshake completed listener addhandshakecompletedlistener listener jsse support jssesupport ssl session sslsession session session session override string get cipher suite getciphersuite io exception ioexception current ssl session sslsession session session get cipher suite getciphersuite override object get peer certificate chain getpeercertificatechain io exception ioexception get peer certificate chain getpeercertificatechain java security cert certificate get x getx certificates ssl session sslsession session certificate certs certs session get peer certificates getpeercertificates throwable log debug get string getstring jsse support jssesupport client cert error clientcerterror certs java security cert certificate certs java security cert certificate certs length certs length certs java security cert certificate jsse certs java security cert certificate certs buffer certs get encoded getencoded certificate factory certificatefactory certificate factory certificatefactory get instance getinstance byte array input stream bytearrayinputstream stream byte array input stream bytearrayinputstream buffer certs java security cert certificate generate certificate generatecertificate stream exception log info get string getstring jsee support jseesupport cert translation error certtranslationerror certs log is trace enabled istraceenabled log trace cert certs certs length certs override object get peer certificate chain getpeercertificatechain force io exception ioexception current ssl session sslsession session convert jsse certificate format certificate jsse certs jssecerts jsse certs jssecerts session get peer certificate chain getpeercertificatechain exception bex jsse certs jssecerts jsse certs jssecerts certificate jsse certs jssecerts length force ssl session invalid ate invalidate hand shake handshake session ssl get session getsession get x getx certificates session hand shake handshake io exception ioexception ssl get want client auth getwantclientauth log debug get string getstring jsse support jssesupport no cert want nocertwant ssl set need client auth setneedclientauth ssl get enabled cipher suites getenabledciphersuites length handshake successful assume hand shakes handshakes disabled log warn get string getstring jsse support jssesupport server reneg disabled serverrenegdisabled session invalid ate invalidate ssl close input stream inputstream ssl get input stream getinputstream old timeout oldtimeout ssl get so timeout getsotimeout ssl set so timeout setsotimeout listener reset ssl start handshake starthandshake minute time max tries maxtries max tries maxtries log is trace enabled istraceenabled log trace reading read read read wrong bomb ssl exception sslexception get string getstring jsse support jssesupport unexpected data unexpecteddata ssl exception sslexception ssl ex sslex log info get string getstring jsse support jssesupport client cert error clientcerterror ssl ex sslex ssl ex sslex io exception ioexception listener completed ssl set so timeout setsotimeout old timeout oldtimeout listener completed socket exception socketexception ssl cert handshake timeout copied code org apache catalina valves certificate valve certificatevalve code override integer get key size getkeysize io exception ioexception current ssl session sslsession ssl support sslsupport cipher data cipherdata aux ciphers session integer key size keysize key size cache keysizecache key size keysize key size cache keysizecache session key size keysize size string cipher suite ciphersuite session get cipher suite getciphersuite aux length cipher suite ciphersuite index of indexof aux phrase size aux key size keysize key size keysize integer value of valueof size key size cache keysizecache key size cache keysizecache session key size keysize key size keysize override string get session id getsessionid io exception ioexception current ssl session sslsession session expose ssl session get id getid ssl session session get id getid ssl session string builder stringbuilder buf string builder stringbuilder ssl session length string digit integer to hex string tohexstring ssl session digit length buf append digit length digit digit substring digit length buf append digit buf to string tostring listener handshake completed listener handshakecompletedlistener completed override handshake completed handshakecompleted handshake completed event handshakecompletedevent event completed reset completed invalid ate invalidate session support object override invalid ate session invalidatesession session invalid ate invalidate override string get protocol getprotocol io exception ioexception session session get protocol getprotocol
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net jsse java file not found exception filenotfoundexception java io exception ioexception java input stream inputstream java net inet address inetaddress java net server socket serversocket java net socket java net socket exception socketexception java security key management exception keymanagementexception java security key store keystore java security no such algorithm exception nosuchalgorithmexception java security unrecoverable key exception unrecoverablekeyexception java security cert crl java security cert crl exception crlexception java security cert cert path parameters certpathparameters java security cert cert store certstore java security cert cert store parameters certstoreparameters java security cert certificate exception certificateexception java security cert certificate factory certificatefactory java security cert collection cert store parameters collectioncertstoreparameters java security cert pkix builder parameters pkixbuilderparameters java security cert cert selector certselector java util array list arraylist java util arrays java util collection java util list java util locale javax net ssl cert path trust manager parameters certpathtrustmanagerparameters javax net ssl key manager keymanager javax net ssl key manager factory keymanagerfactory javax net ssl manager factory parameters managerfactoryparameters javax net ssl ssl context sslcontext javax net ssl ssl exception sslexception javax net ssl ssl server socket sslserversocket javax net ssl ssl server socket factory sslserversocketfactory javax net ssl ssl session sslsession javax net ssl ssl session context sslsessioncontext javax net ssl ssl socket sslsocket javax net ssl trust manager trustmanager javax net ssl trust manager factory trustmanagerfactory javax net ssl key manager keymanager org apache tomcat util comp at compat jre compat jrecompat org apache tomcat util comp at compat jre vendor jrevendor org apache tomcat util file config file loader configfileloader org apache tomcat util net abstract endpoint abstractendpoint org apache tomcat util net constants org apache tomcat util net ssl util sslutil org apache tomcat util net server socket factory serversocketfactory org apache tomcat util res string manager stringmanager ssl server socket factory requires valid rsa key jsse key tool keytool gen key genkey alias tomcat key alg keyalg rsa change it changeit password author harish prabandham author costin manolache author stefan freyr stefansson author ekr renamed jsse socket factory jssesocketfactory author jan luehe author bill bar ker barker jsse socket factory jssesocketfactory server socket factory serversocketfactory ssl util sslutil org apache juli logging log log org apache juli logging log factory logfactory get log getlog jsse socket factory jssesocketfactory string manager stringmanager string manager stringmanager get manager getmanager org apache tomcat util net jsse res defaults string default protocol defaultprotocol constants ssl proto tls string default key store type defaultkeystoretype jks string default key store file defaultkeystorefile system get property getproperty user keystore default session cache size defaultsessioncachesize default session timeout defaultsessiontimeout string supported ciphers string key pass change it changeit abstract endpoint abstractendpoint endpoint rfc supported string default server protocols defaultserverprotocols string default server cipher suites defaultserverciphersuites ssl server socket factory sslserversocketfactory ssl proxy sslproxy string enabled ciphers enabledciphers string enabled protocols enabledprotocols allow unsafe legacy renegotiation allowunsafelegacyrenegotiation flag require client authentication require client auth requireclientauth flag client authentication want client auth wantclientauth jsse socket factory jssesocketfactory abstract endpoint abstractendpoint endpoint endpoint endpoint string ssl protocol sslprotocol endpoint get ssl protocol getsslprotocol ssl protocol sslprotocol ssl protocol sslprotocol default protocol defaultprotocol ssl context sslcontext context context ssl context sslcontext get instance getinstance ssl protocol sslprotocol context init no such algorithm exception nosuchalgorithmexception illegal argument exception illegalargumentexception key management exception keymanagementexception illegal argument exception illegalargumentexception supported cipher suites accessible ssl context sslcontext ssl server socket factory ssl server socket factory sslserversocketfactory ssf context get server socket factory getserversocketfactory string supported ciphers supportedciphers ssf get supported cipher suites getsupportedciphersuites string cipher supported ciphers supportedciphers tls empty renegotiation info scsv equals cipher rfc supported standard determine protocols cipher suites create server socket defaults ssl server socket sslserversocket socket socket ssl server socket sslserversocket ssf create server socket createserversocket io exception ioexception default server cipher suites defaultserverciphersuites string default server protocols defaultserverprotocols string log warn get string getstring jsse no default ciphers nodefaultciphers endpoint get name getname log warn get string getstring jsse no default protocols nodefaultprotocols endpoint get name getname ciphers supported older jre versions considered ins ecure insecure code attempts filter list string filtered ciphers filteredciphers array list arraylist string string cipher socket get enabled cipher suites getenabledciphersuites remove export ciphers freak cipher to upper case touppercase locale english exp log debug get string getstring jsse exclude default cipher excludedefaultcipher cipher remove des ciphers cipher to upper case touppercase locale english des log debug get string getstring jsse exclude default cipher excludedefaultcipher cipher remove ciphers cipher to upper case touppercase locale english log debug get string getstring jsse exclude default cipher excludedefaultcipher cipher remove dhe ciphers running java jre compat jrecompat is jre isjre cipher to upper case touppercase locale english dhe log debug get string getstring jsse exclude default cipher excludedefaultcipher cipher left jre compat jrecompat is jre isjre cipher to upper case touppercase locale english starts with startswith tls rsa cipher to upper case touppercase locale english starts with startswith ssl rsa log debug get string getstring jsse exclude default cipher excludedefaultcipher cipher filtered ciphers filteredciphers add cipher default server cipher suites defaultserverciphersuites filtered ciphers filteredciphers to array toarray string filtered ciphers filteredciphers size default server cipher suites defaultserverciphersuites length log warn get string getstring jsse no default ciphers nodefaultciphers endpoint get name getname filter ssl protocols ssl v sslv ssl v sslv defaults longer considered secure list string filtered protocols filteredprotocols array list arraylist string string protocol socket get enabled protocols getenabledprotocols protocol to upper case touppercase locale english ssl log debug get string getstring jsse exclude default protocol excludedefaultprotocol protocol filtered protocols filteredprotocols add protocol default server protocols defaultserverprotocols filtered protocols filteredprotocols to array toarray string filtered protocols filteredprotocols size default server protocols defaultserverprotocols length log warn get string getstring jsse no default protocols nodefaultprotocols endpoint get name getname socket close io exception ioexception log warn get string getstring jsse exception on close exceptiononclose override server socket serversocket create socket createsocket port io exception ioexception init server socket serversocket socket ssl proxy sslproxy create server socket createserversocket port init server socket initserversocket socket socket override server socket serversocket create socket createsocket port backlog io exception ioexception init server socket serversocket socket ssl proxy sslproxy create server socket createserversocket port backlog init server socket initserversocket socket socket override server socket serversocket create socket createsocket port backlog inet address inetaddress if address ifaddress io exception ioexception init server socket serversocket socket ssl proxy sslproxy create server socket createserversocket port backlog if address ifaddress init server socket initserversocket socket socket override socket accept socket acceptsocket server socket serversocket socket io exception ioexception ssl socket sslsocket asock asock ssl socket sslsocket socket accept ssl exception sslexception socket exception socketexception ssl handshake error to string tostring asock override handshake socket sock io exception ioexception get session getsession start handshake starthandshake call multiple times ssl session sslsession session ssl socket sslsocket sock get session getsession session get cipher suite getciphersuite equals ssl io exception ioexception ssl handshake failed ciper suite ssl session ssl allow unsafe legacy renegotiation allowunsafelegacyrenegotiation rfc supported prevent hand shakes handshakes removing cipher suites ssl socket sslsocket sock set enabled cipher suites setenabledciphersuites string override string get enable able ciphers getenableableciphers ssl context sslcontext context string requested ciphers str requestedciphersstr endpoint get ciphers getciphers supported ciphers equals requested ciphers str requestedciphersstr context getsupportedsslparameters get cipher suites getciphersuites requested ciphers str requestedciphersstr requested ciphers str requestedciphersstr trim length default server cipher suites defaultserverciphersuites list string requested ciphers requestedciphers array list arraylist string string requested ciphers str requestedciphersstr split string cipher trim cipher length requested ciphers requestedciphers add cipher requested ciphers requestedciphers is empty isempty default server cipher suites defaultserverciphersuites list string ciphers array list arraylist string requested ciphers requestedciphers string supported cipher suite array supportedciphersuitearray context getsupportedsslparameters get cipher suites getciphersuites ibm jre accept cipher suites names ssl xxx tls xxx returns ssl xxx form supported cipher suites filter requested cipher suites forms ibm jre list string supported cipher suite list supportedciphersuitelist jre vendor jrevendor ibm jvm supported cipher suite list supportedciphersuitelist array list arraylist string supported cipher suite array supportedciphersuitearray length string supported cipher suite array supportedciphersuitearray supported cipher suite list supportedciphersuitelist add starts with startswith ssl supported cipher suite list supportedciphersuitelist add tls substring supported cipher suite list supportedciphersuitelist arrays as list aslist supported cipher suite array supportedciphersuitearray ciphers retain all retainall supported cipher suite list supportedciphersuitelist ciphers is empty isempty log warn get string getstring jsse requested ciphers supported requested ciphers str requestedciphersstr log is debug enabled isdebugenabled log debug get string getstring jsse enable able enableable ciphers ciphers ciphers size requested ciphers requestedciphers size list string skipped array list arraylist string requested ciphers requestedciphers skipped remove all removeall ciphers log debug get string getstring jsse unsupported ciphers skipped ciphers to array toarray string ciphers size ssl server keystore password string get key store password getkeystorepassword string keystore pass keystorepass endpoint get key store pass getkeystorepass keystore pass keystorepass keystore pass keystorepass endpoint get key pass getkeypass keystore pass keystorepass keystore pass keystorepass key pass keystore pass keystorepass ssl server keystore key store keystore get key store getkeystore string type string provider string pass io exception ioexception string keystore file keystorefile endpoint get key store file getkeystorefile keystore file keystorefile keystore file keystorefile default key store file defaultkeystorefile get store getstore type provider keystore file keystorefile pass ssl server truststore key store keystore get trust store gettruststore string keystore type keystoretype string keystore provider keystoreprovider io exception ioexception key store keystore trust store truststore string truststore file truststorefile endpoint get truststore file gettruststorefile truststore file truststorefile truststore file truststorefile system get property getproperty javax net ssl trust store truststore log is debug enabled isdebugenabled log debug truststore truststore file truststorefile string truststore password truststorepassword endpoint get truststore pass gettruststorepass truststore password truststorepassword truststore password truststorepassword system get property getproperty javax net ssl trust store password truststorepassword log is debug enabled isdebugenabled log debug trust pass trustpass truststore password truststorepassword string truststore type truststoretype endpoint get truststore type gettruststoretype truststore type truststoretype truststore type truststoretype system get property getproperty javax net ssl trust store type truststoretype truststore type truststoretype truststore type truststoretype keystore type keystoretype log is debug enabled isdebugenabled log debug trust type trusttype truststore type truststoretype string truststore provider truststoreprovider endpoint get truststore provider gettruststoreprovider truststore provider truststoreprovider truststore provider truststoreprovider system get property getproperty javax net ssl trust store provider truststoreprovider truststore provider truststoreprovider truststore provider truststoreprovider keystore provider keystoreprovider log is debug enabled isdebugenabled log debug trust provider trustprovider truststore provider truststoreprovider truststore file truststorefile trust store truststore get store getstore truststore type truststoretype truststore provider truststoreprovider truststore file truststorefile truststore password truststorepassword io exception ioexception ioe throwable ioe get cause getcause unrecoverable key exception unrecoverablekeyexception log warn get string getstring jsse invalid truststore password trust store truststore get store getstore truststore type truststoretype truststore provider truststoreprovider truststore file truststorefile ioe trust store truststore key truststore type path password key store keystore get store getstore string type string provider string path string pass io exception ioexception key store keystore input stream inputstream istream provider key store keystore get instance getinstance type key store keystore get instance getinstance type provider pkcs equals ignore case equalsignorecase type equals ignore case equalsignorecase path istream config file loader configfileloader get input stream getinputstream path store pass storepass pass equals pass store pass storepass pass to char array tochararray load istream store pass storepass file not found exception filenotfoundexception fnfe log error get string getstring jsse keystore load failed type path fnfe get message getmessage fnfe fnfe io exception ioexception ioe ioe exception string msg get string getstring jsse keystore load failed type path get message getmessage log error msg io exception ioexception msg istream istream close io exception ioexception ioe reads keystore initial izes initializes ssl socket factory init io exception ioexception string client auth str clientauthstr endpoint get client auth getclientauth equals ignore case equalsignorecase client auth str clientauthstr equals ignore case equalsignorecase client auth str clientauthstr require client auth requireclientauth equals ignore case equalsignorecase client auth str clientauthstr want client auth wantclientauth ssl context sslcontext context createsslcontext context init get key managers getkeymanagers get trust managers gettrustmanagers configure ssl session cache ssl session context sslsessioncontext session context sessioncontext context get server session context getserversessioncontext session context sessioncontext configure session context configuresessioncontext session context sessioncontext create proxy ssl proxy sslproxy context get server socket factory getserversocketfactory determine cipher suites enable enabled ciphers enabledciphers get enable able ciphers getenableableciphers context enabled protocols enabledprotocols get enable able protocols getenableableprotocols context allow unsafe legacy renegotiation allowunsafelegacyrenegotiation equals endpoint get allow unsafe legacy renegotiation getallowunsafelegacyrenegotiation check ssl config check config checkconfig exception io exception ioexception io exception ioexception io exception ioexception get message getmessage override ssl context sslcontext createsslcontext exception ssl protocol variant tls ssl string protocol endpoint get ssl protocol getsslprotocol protocol protocol default protocol defaultprotocol ssl context sslcontext context ssl context sslcontext get instance getinstance protocol context override key manager keymanager get key managers getkeymanagers exception string keystore type keystoretype endpoint get key store type getkeystoretype keystore type keystoretype keystore type keystoretype default key store type defaultkeystoretype string algorithm endpoint get algorithm getalgorithm algorithm algorithm key manager factory keymanagerfactory get default algorithm getdefaultalgorithm get key managers getkeymanagers keystore type keystoretype endpoint get key store provider getkeystoreprovider algorithm endpoint get key alias getkeyalias override trust manager trustmanager get trust managers gettrustmanagers exception string truststore type truststoretype endpoint get truststore type gettruststoretype truststore type truststoretype truststore type truststoretype system get property getproperty javax net ssl trust store type truststoretype truststore type truststoretype truststore type truststoretype endpoint get key store type getkeystoretype truststore type truststoretype truststore type truststoretype default key store type defaultkeystoretype string algorithm endpoint get truststore algorithm gettruststorealgorithm algorithm algorithm trust manager factory trustmanagerfactory get default algorithm getdefaultalgorithm get trust managers gettrustmanagers truststore type truststoretype endpoint get key store provider getkeystoreprovider algorithm override configure session context configuresessioncontext ssl session context sslsessioncontext ssl session context sslsessioncontext session cache size sessioncachesize endpoint get session cache size getsessioncachesize session cache size sessioncachesize integer parse int parseint endpoint get session cache size getsessioncachesize session cache size sessioncachesize default session cache size defaultsessioncachesize session timeout sessiontimeout endpoint get session timeout getsessiontimeout session timeout sessiontimeout integer parse int parseint endpoint get session timeout getsessiontimeout session timeout sessiontimeout default session timeout defaultsessiontimeout ssl session context sslsessioncontext set session cache size setsessioncachesize session cache size sessioncachesize ssl session context sslsessioncontext set session timeout setsessiontimeout session timeout sessiontimeout initialized key managers key manager keymanager get key managers getkeymanagers string keystore type keystoretype string keystore provider keystoreprovider string algorithm string key alias keyalias exception key manager keymanager kms string keystore pass keystorepass get key store password getkeystorepassword key store keystore get key store getkeystore keystore type keystoretype keystore provider keystoreprovider keystore pass keystorepass key alias keyalias is key entry iskeyentry key alias keyalias io exception ioexception get string getstring jsse alias key entry key alias keyalias key manager factory keymanagerfactory kmf key manager factory keymanagerfactory get instance getinstance algorithm string key pass keypass endpoint get key pass getkeypass key pass keypass key pass keypass keystore pass keystorepass kmf init key pass keypass to char array tochararray kms kmf get key managers getkeymanagers key alias keyalias string alias key alias keyalias jsse socket factory jssesocketfactory default key store type defaultkeystoretype equals keystore type keystoretype alias alias to lower case tolowercase locale english kms length kms jsse key manager jssekeymanager key manager keymanager kms alias kms initialized trust managers trust manager trustmanager get trust managers gettrustmanagers string keystore type keystoretype string keystore provider keystoreprovider string algorithm exception string crlf endpoint get crl file getcrlfile string class name classname endpoint get trust manager class name gettrustmanagerclassname class name classname class name classname length class loader classloader class loader classloader get class getclass get class loader getclassloader clazz class loader classloader load class loadclass class name classname trust manager trustmanager is assignable from isassignablefrom clazz instantiation exception instantiationexception get string getstring jsse invalid trust manager class name invalidtrustmanagerclassname class name classname object trust manager object trustmanagerobject clazz new instance newinstance trust manager trustmanager trust manager trustmanager trust manager trustmanager trust manager object trustmanagerobject trust manager trustmanager trust manager trustmanager trust manager trustmanager tms key store keystore trust store truststore get trust store gettruststore keystore type keystoretype keystore provider keystoreprovider trust store truststore endpoint get trust manager class name gettrustmanagerclassname crlf trust manager factory trustmanagerfactory tmf trust manager factory trustmanagerfactory get instance getinstance algorithm tmf init trust store truststore tms tmf get trust managers gettrustmanagers trust manager factory trustmanagerfactory tmf trust manager factory trustmanagerfactory get instance getinstance algorithm cert path parameters certpathparameters params get parameters getparameters algorithm crlf trust store truststore manager factory parameters managerfactoryparameters mfp cert path trust manager parameters certpathtrustmanagerparameters params tmf init mfp tms tmf get trust managers gettrustmanagers tms initialization parameters trust manager trustmanager code pkix code supported param algorithm algorithm parameters param crlf path crl file param trust store truststore configured trust store truststore parameters including cr ls crls trust store truststore cert path parameters certpathparameters get parameters getparameters string algorithm string crlf key store keystore trust store truststore exception cert path parameters certpathparameters params pkix equals ignore case equalsignorecase algorithm pkix builder parameters pkixbuilderparameters xparams pkix builder parameters pkixbuilderparameters trust store truststore cert selector certselector collection crl crls getcrls crlf cert store parameters certstoreparameters csp collection cert store parameters collectioncertstoreparameters crls cert store certstore store cert store certstore get instance getinstance collection csp xparams add cert store addcertstore store xparams set revocation enabled setrevocationenabled string trust length trustlength endpoint get trust max cert length gettrustmaxcertlength trust length trustlength xparams set max path length setmaxpathlength integer parse int parseint trust length trustlength exception log warn bad max cert length maxcertlength trust length trustlength params xparams crl exception crlexception cr ls crls supported type algorithm params load collection cr ls crls collection crl getcrls string crlf io exception ioexception crl exception crlexception certificate exception certificateexception collection crl crls input stream inputstream certificate factory certificatefactory certificate factory certificatefactory get instance getinstance config file loader configfileloader get input stream getinputstream crlf crls generatecrls io exception ioexception iex iex crl exception crlexception crle crle certificate exception certificateexception close exception crls override string get enable able protocols getenableableprotocols ssl context sslcontext context string requested protocols requestedprotocols endpoint get ssl enabled protocols array getsslenabledprotocolsarray requested protocols requestedprotocols requested protocols requestedprotocols length default server protocols defaultserverprotocols list string protocols array list arraylist string arrays as list aslist requested protocols requestedprotocols protocols retain all retainall arrays as list aslist context getsupportedsslparameters get protocols getprotocols protocols is empty isempty log warn get string getstring jsse requested protocols supported arrays as list aslist requested protocols requestedprotocols log is debug enabled isdebugenabled log debug get string getstring jsse enable able enableable protocols protocols protocols size requested protocols requestedprotocols length list string skipped array list arraylist string arrays as list aslist requested protocols requestedprotocols skipped remove all removeall protocols log debug get string getstring jsse unsupported protocols skipped protocols to array toarray string protocols size configure client authentication version jsse jsse included java supports prior versions jsse treat param socket ssl server socket sslserversocket configure client auth configureclientauth ssl server socket sslserversocket socket want client auth wantclientauth socket set want client auth setwantclientauth want client auth wantclientauth socket set need client auth setneedclientauth require client auth requireclientauth config ures configures ssl engine sslengine honor cipher suites ordering based endpoint configuration invalid algorithm parameter exception invalidalgorithmparameterexception runtime jvm doesn support setting configure use server cipher suites order configureuseserverciphersuitesorder ssl server socket sslserversocket socket string use server cipher suites order str useserverciphersuitesorderstr endpoint get use server cipher suites order getuseserverciphersuitesorder trim feature user explicitly requested equals use server cipher suites order str useserverciphersuitesorderstr use server cipher suites order useserverciphersuitesorder equals ignore case equalsignorecase use server cipher suites order str useserverciphersuitesorderstr equals ignore case equalsignorecase use server cipher suites order str useserverciphersuitesorderstr jre compat jrecompat jre compat jrecompat jre compat jrecompat get instance getinstance jre compat jrecompat set use server cipher suites order setuseserverciphersuitesorder socket use server cipher suites order useserverciphersuitesorder config ures configures ssl server socket requested cipher suites protocol versions client authentication init server socket initserversocket server socket serversocket ssocket ssl server socket sslserversocket socket ssl server socket sslserversocket ssocket socket set enabled cipher suites setenabledciphersuites enabled ciphers enabledciphers socket set enabled protocols setenabledprotocols enabled protocols enabledprotocols don client needed parsing request handshake configure client auth configureclientauth socket configure use server cipher suites order configureuseserverciphersuitesorder socket checks certificate compatible enabled cipher suites don check ji o endpoint jioendpoint enter nasty logging loop bug check config checkconfig io exception ioexception create unbound server socket server socket serversocket socket ssl proxy sslproxy create server socket createserversocket init server socket initserversocket socket timeout care ssl exception sslexception accept socket set so timeout setsotimeout socket accept client connect unbound port ssl exception sslexception ssl e ssle io exception ioexception ioe io exception ioexception get string getstring jsse invalid ssl conf ssl e ssle get message getmessage ioe init cause initcause ssl e ssle ioe exception open socket is closed isclosed socket close
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina valves java io exception ioexception javax servlet servlet exception servletexception org junit assert equals assertequals org junit fail org junit test org apache catalina context org apache catalina connector connector org apache catalina connector request org apache catalina connector response org apache catalina core standard context standardcontext link request filter valve requestfiltervalve tests test request filter valve testrequestfiltervalve forbidden custom string addr pat string addr deny pat string addr string addr deny string addr deny string addr deny string host pat string host deny pat org string host string host deny host org string host deny org string host deny host port string port match pattern string port match pattern terminating valve terminatingvalve valve base valvebase override invoke request request response response io exception ioexception servlet exception servletexception mock response mockresponse response status override send error senderror status io exception ioexception status status override get status getstatus status one test onetest string string deny deny status denystatus add connector port addconnectorport string property string type allowed prepare request filter valve requestfiltervalve valve connector connector connector context context standard context standardcontext request request request response response mock response mockresponse string builder stringbuilder msg string builder stringbuilder expected allowed forbidden connector set port setport port request set connector setconnector connector request set context setcontext context request set coyote request setcoyoterequest org apache coyote request type fail invalid test type property type equals addr valve remote addr valve remoteaddrvalve request set remote addr setremoteaddr property msg append property type equals host valve remote host valve remotehostvalve request set remote host setremotehost property msg append host property fail invalid test type type valve set next setnext terminating valve terminatingvalve valve set allow setallow msg append deny valve set deny setdeny deny msg append deny deny deny status denystatus valve set deny status setdenystatus custom msg append deny status denystatus custom allowed expected custom add connector port addconnectorport valve remote addr valve remoteaddrvalve remote addr valve remoteaddrvalve valve set add connector port setaddconnectorport valve remote host valve remotehostvalve remote host valve remotehostvalve valve set add connector port setaddconnectorport fail add connector port addconnectorport remote addr valve remoteaddrvalve remote host valve remotehostvalve msg append add connector port addconnectorport context set preemptive authentication setpreemptiveauthentication valve set invalid authentication when deny setinvalidauthenticationwhendeny msg append test valve invoke request response io exception ioexception servlet exception servletexception verify allowed assert equals assertequals msg to string tostring response get status getstatus assert equals assertequals msg to string tostring invalid request get header getheader authorization assert equals assertequals msg to string tostring expected response get status getstatus standard tests standardtests string pat string deny pat string only allow onlyallow string only deny onlydeny string allow and deny allowanddeny string no allow no deny noallownodeny string type string apat string dpat test ports apat pat dpat deny pat one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test port pattern for got ten forgotten add connector port addconnectorport apat pat port match pattern dpat deny pat port match pattern one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test add connector port addconnectorport port pattern apat pat dpat deny pat one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test add connector port addconnectorport port matching patterns apat pat port match pattern dpat deny pat port match pattern one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test add connector port addconnectorport port matching patterns apat pat port match pattern dpat deny pat port match pattern one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test add connector port addconnectorport port matching apat pat port match pattern dpat deny pat port match pattern one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test add connector port addconnectorport port matching deny apat pat port match pattern dpat deny pat port match pattern one test onetest allow and deny allowanddeny type one test onetest allow and deny allowanddeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest apat allow and deny allowanddeny type one test onetest apat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest dpat allow and deny allowanddeny type one test onetest dpat no allow no deny noallownodeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type one test onetest apat dpat no allow no deny noallownodeny type one test onetest apat dpat only allow onlyallow type one test onetest apat dpat only deny onlydeny type one test onetest apat dpat allow and deny allowanddeny type test test remote addr valve pv testremoteaddrvalveipv standard tests standardtests addr pat addr deny pat addr addr deny addr deny addr deny addr standard tests standardtests addr pat addr deny pat addr addr deny addr deny addr deny addr test test remote host valve testremotehostvalve standard tests standardtests host pat host deny pat host host deny host deny host deny host standard tests standardtests host pat host deny pat host host deny host deny host deny host
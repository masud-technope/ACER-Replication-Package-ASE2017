licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java buffered output stream bufferedoutputstream java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java input stream inputstream java net jarurlconnection java net url java nio channels file channel filechannel java util enumeration java util jar jar entry jarentry java util jar jar file jarfile java util zip zip exception zipexception org apache catalina globals org apache catalina host org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils org apache tomcat util res string manager stringmanager expand war host app base appbase author craig mc clanahan mcclanahan author remy maucherat author g len n glenn nielsen expand war expandwar log log log factory logfactory get log getlog expand war expandwar string resources string manager stringmanager string manager stringmanager get manager getmanager constants expand war file url unpacked directory structure absolute path name pathname expanded directory param host host war installed param war url web application archive expanded start jar param path name pathname context path web application exception illegal argument exception illegalargumentexception jar url war file invalid exception io exception ioexception input output error encountered exp ansion expansion string expand host host url war string path name pathname io exception ioexception directory existing file app base appbase file host get app base getappbase app base appbase is absolute isabsolute app base appbase file system get property getproperty globals catalina base prop host get app base getappbase app base appbase exists app base appbase is directory isdirectory io exception ioexception get string getstring host config hostconfig app base appbase app base appbase get absolute path getabsolutepath file doc base docbase file app base appbase path name pathname doc base docbase exists war file installed doc base docbase get absolute path getabsolutepath create document base directory doc base docbase mkdir doc base docbase is directory isdirectory io exception ioexception get string getstring expand war expandwar create failed createfailed doc base docbase expand war document base directory string canonical doc base prefix canonicaldocbaseprefix doc base docbase get canonical path getcanonicalpath canonical doc base prefix canonicaldocbaseprefix ends with endswith file separator canonical doc base prefix canonicaldocbaseprefix file separator jarurlconnection juc jarurlconnection war open connection openconnection juc set use caches setusecaches jar file jarfile jar file jarfile input stream inputstream input success jar file jarfile juc get jar file getjarfile enumeration jar entry jarentry jar entries jarentries jar file jarfile entries jar entries jarentries has more elements hasmoreelements jar entry jarentry jar entry jarentry jar entries jarentries next element nextelement string jar entry jarentry get name getname file expanded file expandedfile file doc base docbase expanded file expandedfile get canonical path getcanonicalpath starts with startswith canonical doc base prefix canonicaldocbaseprefix exception deployment illegal argument exception illegalargumentexception get string getstring expand war expandwar illegal path illegalpath war expanded file expandedfile get canonical path getcanonicalpath canonical doc base prefix canonicaldocbaseprefix last index of lastindexof file parent file doc base docbase substring parent mkdirs parent is directory isdirectory io exception ioexception get string getstring expand war expandwar create failed createfailed parent ends with endswith input jar file jarfile get input stream getinputstream jar entry jarentry input zip exception zipexception get string getstring expand war expandwar missing jar entry missingjarentry jar entry jarentry get name getname bug zilla bugzilla expand input expanded file expandedfile last modified lastmodified jar entry jarentry get time gettime last modified lastmodified last modified lastmodified expanded file expandedfile set last modified setlastmodified last modified lastmodified input close input success io exception ioexception success wrong delete expanded dir clean delete dir deletedir doc base docbase input input close throwable exception utils exceptionutils handle throwable handlethrowable input jar file jarfile jar file jarfile close throwable exception utils exceptionutils handle throwable handlethrowable jar file jarfile absolute path document base directory doc base docbase get absolute path getabsolutepath validate war file url param host host war installed param war url web application archive validated start jar param path name pathname context path web application exception illegal argument exception illegalargumentexception jar url war file invalid exception io exception ioexception input output error encountered validation validate host host url war string path name pathname io exception ioexception app base appbase absolute file app base appbase file host get app base getappbase app base appbase is absolute isabsolute app base appbase file system get property getproperty globals catalina base prop host get app base getappbase file doc base docbase file app base appbase path name pathname calculate document base directory string canonical doc base prefix canonicaldocbaseprefix doc base docbase get canonical path getcanonicalpath canonical doc base prefix canonicaldocbaseprefix ends with endswith file separator canonical doc base prefix canonicaldocbaseprefix file separator jarurlconnection juc jarurlconnection war open connection openconnection juc set use caches setusecaches jar file jarfile jar file jarfile jar file jarfile juc get jar file getjarfile enumeration jar entry jarentry jar entries jarentries jar file jarfile entries jar entries jarentries has more elements hasmoreelements jar entry jarentry jar entry jarentry jar entries jarentries next element nextelement string jar entry jarentry get name getname file expanded file expandedfile file doc base docbase expanded file expandedfile get canonical path getcanonicalpath starts with startswith canonical doc base prefix canonicaldocbaseprefix exception deployment illegal argument exception illegalargumentexception get string getstring expand war expandwar illegal path illegalpath war expanded file expandedfile get canonical path getcanonicalpath canonical doc base prefix canonicaldocbaseprefix io exception ioexception jar file jarfile jar file jarfile close throwable exception utils exceptionutils handle throwable handlethrowable jar file jarfile copy file directory destination param src file object representing source param dest file object representing destination copy file src file dest result string files src is directory isdirectory files src list result dest mkdir files string files files files string files length result file file src filesrc file src files file file dest filedest file dest files file src filesrc is directory isdirectory result copy file src filesrc file dest filedest file channel filechannel file channel filechannel file input stream fileinputstream file src filesrc get channel getchannel file output stream fileoutputstream file dest filedest get channel getchannel transfer to transferto size io exception ioexception log error get string getstring expand war expandwar copy file src filesrc file dest filedest result close io exception ioexception close io exception ioexception result delete directory including contents directories recursively failure log ged logged param dir file object representing directory deleted delete file dir log failure delete dir delete directory including contents directories recursively param dir file object representing directory deleted param log failure logfailure code code failure delete resource log ged logged delete file dir log failure logfailure result dir is directory isdirectory result delete dir deletedir dir log failure logfailure dir exists result dir delete result log failure logfailure result log error get string getstring expand war expandwar delete failed deletefailed dir get absolute path getabsolutepath result delete directory including contents directories recursively failure log ged logged param dir file object representing directory deleted delete dir deletedir file dir delete dir deletedir dir delete directory including contents directories recursively param dir file object representing directory deleted param log failure logfailure code code failure delete resource log ged logged delete dir deletedir file dir log failure logfailure string files dir list files files string files length file file file dir files file is directory isdirectory delete dir deletedir file log failure logfailure file delete result dir exists result dir delete result log failure logfailure result log error get string getstring expand war expandwar delete failed deletefailed dir get absolute path getabsolutepath result expand input stream file param input input stream inputstream copied param file file created exception io exception ioexception input output error occurs expand input stream inputstream input file file io exception ioexception buffered output stream bufferedoutputstream output output buffered output stream bufferedoutputstream file output stream fileoutputstream file buffer input read buffer output write buffer output output close io exception ioexception
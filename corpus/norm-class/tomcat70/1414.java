licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina authenticator java i o exception ioexception java string reader stringreader java security message digest messagedigest java security no such algorithm exception nosuchalgorithmexception java security principal java util linked hash map linkedhashmap java util map java util string tokenizer stringtokenizer javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache catalina lifecycle exception lifecycleexception org apache catalina realm org apache catalina connector request org apache catalina deploy login config loginconfig org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util buf c converter cconverter org apache tomcat util http parser http parser httpparser org apache tomcat util security concurrent message digest concurrentmessagedigest org apache tomcat util security encoder digest authenticator digestauthenticator authenticator base authenticatorbase log log log factory logfactory get log getlog digest authenticator digestauthenticator constants helper object deprecated unused removed tomcat deprecated encoder encoder encoder descriptive implementation string info org apache catalina authenticator digest authenticator digestauthenticator tomcat digest implementation supports quality protection string qop digest authenticator digestauthenticator set cache setcache helper helper message digest messagedigest get instance getinstance no such algorithm exception nosuchalgorithmexception illegal state exception illegalstateexception instance variables message digest provider deprecated unused removed tomcat onwards deprecated message digest messagedigest helper list server nonce values tracked map string nonce info nonceinfo non ces nonces timestamp generate nonce nonce unique timestamp last timestamp lasttimestamp object last timestamp lock lasttimestamplock object maximum number server non ces nonces cache nonce cache size noncecachesize window size track nonce count values nonce nonce count window size noncecountwindowsize key string key server non ces nonces valid milliseconds defaults min utes minutes nonce validity noncevalidity opaque string string opaque uri validated required rfc disabled reverse proxies proxy modified uri validate uri validateuri properties descriptive valve implementation override string get info getinfo info get nonce count window size getnoncecountwindowsize nonce count window size noncecountwindowsize set nonce count window size setnoncecountwindowsize nonce count window size noncecountwindowsize nonce count window size noncecountwindowsize nonce count window size noncecountwindowsize get nonce cache size getnoncecachesize nonce cache size noncecachesize set nonce cache size setnoncecachesize nonce cache size noncecachesize nonce cache size noncecachesize nonce cache size noncecachesize string get key getkey key set key setkey string key key key get nonce validity getnoncevalidity nonce validity noncevalidity set nonce validity setnoncevalidity nonce validity noncevalidity nonce validity noncevalidity nonce validity noncevalidity string get opaque getopaque opaque set opaque setopaque string opaque opaque opaque is validate uri isvalidateuri validate uri validateuri set validate uri setvalidateuri validate uri validateuri validate uri validateuri validate uri validateuri methods authenticate user making request based login configuration code code constraint satisfied code code created response challenge param request request processing param response response creating param config login configuration describing authentication performed exception i o exception ioexception input output error occurs override authenticate request request http servlet response httpservletresponse response login config loginconfig config i o exception ioexception todo config urable configurable attribute single sign on singlesignon check for cached authentication checkforcachedauthentication request response validate credentials included request principal principal string authorization request get header getheader authorization digest info digestinfo digest info digestinfo digest info digestinfo get opaque getopaque get nonce validity getnoncevalidity get key getkey non ces nonces is validate uri isvalidateuri authorization digest info digestinfo parse request authorization digest info digestinfo validate request config principal digest info digestinfo authenticate context get realm getrealm principal digest info digestinfo is nonce stale isnoncestale register request response principal http servlet request httpservletrequest digest digest info digestinfo get username getusername send unauthorized response challenge generate nonce token token supposed unique string nonce generate nonce generatenonce request set authenticate header setauthenticateheader request response config nonce principal digest info digestinfo is nonce stale isnoncestale response send error senderror http servlet response httpservletresponse unauthorized override string get auth method getauthmethod http servlet request httpservletrequest digest methods parse username authorization string identified code code param authorization authorization string parsed deprecated unused removed tomcat deprecated string parse username parseusername string authorization validate authorization credentials format authorization authorization starts with startswith digest authorization authorization substring trim string tokenizer stringtokenizer comma tokenizer commatokenizer string tokenizer stringtokenizer authorization comma tokenizer commatokenizer has more tokens hasmoretokens string current token currenttoken comma tokenizer commatokenizer next token nexttoken equal sign equalsign current token currenttoken index of indexof equal sign equalsign string current token name currenttokenname current token currenttoken substring equal sign equalsign trim string current token value currenttokenvalue current token currenttoken substring equal sign equalsign trim username equals current token name currenttokenname remove quotes removequotes current token value currenttokenvalue removes quotes string rfc quotes optional parameters realm string remove quotes removequotes string quoted string quotedstring quotes required quotesrequired support quoted quoted quoted string quotedstring length quoted string quotedstring char at charat quotes required quotesrequired quoted string quotedstring quoted string quotedstring length quoted string quotedstring substring quoted string quotedstring length removes quotes string string remove quotes removequotes string quoted string quotedstring remove quotes removequotes quoted string quotedstring generate unique token token generated pattern n once token noncetoken base client time stamp key param request http servlet request string generate nonce generatenonce request request current time currenttime system current time millis currenttimemillis last timestamp lock lasttimestamplock current time currenttime last timestamp lasttimestamp last timestamp lasttimestamp current time currenttime current time currenttime last timestamp lasttimestamp string ip time key iptimekey request get remote addr getremoteaddr current time currenttime get key getkey buffer concurrent message digest concurrentmessagedigest digestmd ip time key iptimekey get bytes getbytes c converter cconverter iso string nonce current time currenttime encoder encode buffer nonce info nonceinfo info nonce info nonceinfo current time currenttime get nonce count window size getnoncecountwindowsize non ces nonces non ces nonces nonce info nonce generates authenticate header header follow template pre authenticate authenticate digest digest challenge digest challenge realm domain nonce digest opaque stale algorithm realm realm realm realm quoted string domain domain uri nonce nonce nonce nonce quoted string opaque opaque quoted string stale stale algorithm algorithm token pre param request http servlet request param response http servlet response param config login configuration describing authentication performed param nonce nonce token set authenticate header setauthenticateheader http servlet request httpservletrequest request http servlet response httpservletresponse response login config loginconfig config string nonce is nonce stale isnoncestale realm string realm name realmname config get realm name getrealmname realm name realmname realm name realmname realm string authenticate header authenticateheader is nonce stale isnoncestale authenticate header authenticateheader digest realm realm name realmname qop qop nonce nonce opaque get opaque getopaque stale authenticate header authenticateheader digest realm realm name realmname qop qop nonce nonce opaque get opaque getopaque response set header setheader header authenticate header authenticateheader lifecycle methods override start internal startinternal lifecycle exception lifecycleexception start internal startinternal generate random secret key get key getkey set key setkey session id generator sessionidgenerator generate session id generatesessionid generate opaque string get opaque getopaque set opaque setopaque session id generator sessionidgenerator generate session id generatesessionid non ces nonces linked hash map linkedhashmap string digest authenticator digestauthenticator nonce info nonceinfo serialversionuid log suppress time last log lastlog override remove eldest entry removeeldestentry map entry string nonce info nonceinfo eldest called sync simple current time currenttime system current time millis currenttimemillis size get nonce cache size getnoncecachesize last log lastlog current time currenttime current time currenttime eldest get value getvalue get timestamp gettimestamp get nonce validity getnoncevalidity rep lay replay att ack attack log warn get string getstring digest authenticator digestauthenticator cache remove cacheremove last log lastlog current time currenttime log suppress time digest info digestinfo string opaque nonce validity noncevalidity string key map string nonce info nonceinfo non ces nonces validate uri validateuri string user name username string method string uri string response string nonce string string cnonce string realm name realmname string qop string opaque received opaquereceived nonce stale noncestale digest info digestinfo string opaque nonce validity noncevalidity string key map string nonce info nonceinfo non ces nonces validate uri validateuri opaque opaque nonce validity noncevalidity nonce validity noncevalidity key key non ces nonces non ces nonces validate uri validateuri validate uri validateuri string get username getusername user name username parse request request string authorization validate authorization credentials format authorization map string string directives directives http parser httpparser parse authorization digest parseauthorizationdigest string reader stringreader authorization i o exception ioexception directives method request get method getmethod user name username directives username realm name realmname directives realm nonce directives nonce directives cnonce directives cnonce qop directives qop uri directives uri response directives response opaque received opaquereceived directives opaque validate request request login config loginconfig config user name username realm name realmname nonce uri response validate uri match request client validate uri validateuri string uri query uriquery string query request get query string getquerystring query uri query uriquery request getrequesturi uri query uriquery request getrequesturi query uri equals uri query uriquery clients older and roid android absolute uri digest relative uri request request fixed and roid android version string host request get header getheader host string scheme request get scheme getscheme host uri query uriquery starts with startswith scheme string builder stringbuilder absolute string builder stringbuilder absolute append scheme absolute append absolute append host absolute append uri query uriquery uri equals absolute to string tostring validate realm string lc realm lcrealm config get realm name getrealmname lc realm lcrealm lc realm lcrealm realm lc realm lcrealm equals realm name realmname validate opaque string opaque equals opaque received opaquereceived validate nonce nonce index of indexof nonce length nonce time noncetime nonce time noncetime parse long parselong nonce substring number format exception numberformatexception nfe string client ip time key clientiptimekey nonce substring current time currenttime system current time millis currenttimemillis current time currenttime nonce time noncetime nonce validity noncevalidity nonce stale noncestale non ces nonces non ces nonces remove nonce string server ip time key serveriptimekey request get remote addr getremoteaddr nonce time noncetime key buffer concurrent message digest concurrentmessagedigest digestmd server ip time key serveriptimekey get bytes getbytes c converter cconverter iso string server ip time key serveriptimekey encoder encode buffer server ip time key serveriptimekey equals client ip time key clientiptimekey validate qop qop qop equals qop check presence cnonce consistent presence qop qop cnonce cnonce fixed and roid android version length length count count parse long parselong number format exception numberformatexception nfe nonce info nonceinfo info non ces nonces info non ces nonces nonce info nonce valid cache dropped cache force authentication nonce stale noncestale info nonce count valid noncecountvalid count is nonce stale isnoncestale nonce stale noncestale principal authenticate realm realm digest calculate digest method uri string method uri buffer concurrent message digest concurrentmessagedigest digestmd get bytes getbytes c converter cconverter iso string encoder encode buffer realm authenticate user name username response nonce cnonce qop realm name realmname nonce info nonceinfo timestamp offset count nonce info nonceinfo current time currenttime see n window size seenwindowsize timestamp current time currenttime see n window size seenwindowsize offset see n window size seenwindowsize nonce count valid noncecountvalid nonce count noncecount count offset nonce count noncecount nonce count noncecount count offset length check index checkindex nonce count noncecount offset length check index checkindex check index checkindex count length count get timestamp gettimestamp timestamp
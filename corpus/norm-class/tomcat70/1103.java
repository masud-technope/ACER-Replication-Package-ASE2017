licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina realm java file java io exception ioexception java security principal java util map javax security subject javax security callback callback javax security callback callback handler callbackhandler javax security callback name callback namecallback javax security callback password callback passwordcallback javax security callback text input callback textinputcallback javax security callback unsupported callback exception unsupportedcallbackexception javax security login failed login exception failedloginexception javax security login login exception loginexception javax security spi login module loginmodule javax servlet http http servlet request httpservletrequest org apache catalina globals org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util digester digester implementation jaas strong login module loginmodule strong testing code jaas realm jaasrealm code util izes utilizes xml format data file username password role identical supported code org apache catalina realm memory realm memoryrealm code digested pass words passwords supported recognizes string value d valued options configuration file passed constructor code options code argument strong debug strong debug ging debugging messages generated system code code strong path name pathname strong relative path name pathname catalina base system property absolute path name pathname xml file user format supported link memory realm memoryrealm matches memory realm memoryrealm strong implementation note strong code realm code satisfy calling requirements code generic principal genericprincipal code constructor perform functionality required code realm code implementation author craig mc clanahan mcclanahan jaas memory login module jaasmemoryloginmodule memory realm memoryrealm login module loginmodule extend memory realm memoryrealm avoid log log log factory logfactory get log getlog jaas memory login module jaasmemoryloginmodule instance variables callback handler responsible answering requests callback handler callbackhandler callback handler callbackhandler code commit code returned committed configuration code login module loginmodule code map string options absolute relative path name pathname xml configuration file string path name pathname conf tomcat users xml code principal code identified validation code code validation failed principal principal shared configured code login module loginmodule code instances map string shared state sharedstate subject performing authentication subject subject jaas memory login module jaasmemoryloginmodule log debug memory login module p has e phase auth enticating authenticating code subject code p has e phase fails method called code login context logincontext code failed authentication chain code code method succeeded code code code login module loginmodule code exception login exception loginexception abort fails override abort login exception loginexception authentication successful principal clean authentication failed committed log out logout committed principal log debug abort p has e phase auth enticating authenticating code subject code p has e phase successful method called code login context logincontext code succeeded authentication chain code code authentication succeeded code code code login module loginmodule code exception login exception loginexception commit fails override commit login exception loginexception log debug commit principal authentication successful principal add principal subject needed subject get principals getprincipals principal subject get principals getprincipals add principal jaas realm jaasrealm principal generic principal genericprincipal string roles generic principal genericprincipal principal get roles getroles roles length subject get principals getprincipals add generic principal genericprincipal roles committed initialize code login module loginmodule code configuration param subject code subject code authenticated param callback handler callbackhandler code callback handler callbackhandler code communicating user param shared state sharedstate shared code login module loginmodule code instances param options configuration specific code login module loginmodule code instance override initialize subject subject callback handler callbackhandler callback handler callbackhandler map string shared state sharedstate map string options log debug init save configuration values subject subject callback handler callbackhandler callback handler callbackhandler shared state sharedstate shared state sharedstate options options perform instance specific initialization options path name pathname path name pathname string options path name pathname load defined principals load p has e phase auth enticating authenticating code subject code code code authentication succeeded code code code login module loginmodule code exception login exception loginexception authentication fails override login login exception loginexception callback handler callbackhandler requests callback handler callbackhandler login exception loginexception callback handler callbackhandler callback callbacks callback callbacks name callback namecallback username callbacks password callback passwordcallback password callbacks text input callback textinputcallback non ce nonce callbacks text input callback textinputcallback callbacks text input callback textinputcallback cnonce callbacks text input callback textinputcallback qop callbacks text input callback textinputcallback realm name realmname callbacks text input callback textinputcallback callbacks text input callback textinputcallback auth method authmethod int eract interact user retrieve username password string username string password string non ce nonce string string cnonce string qop string realm name realmname string string auth method authmethod callback handler callbackhandler handle callbacks username name callback namecallback callbacks get name getname password string password callback passwordcallback callbacks get password getpassword non ce nonce text input callback textinputcallback callbacks get text gettext text input callback textinputcallback callbacks get text gettext cnonce text input callback textinputcallback callbacks get text gettext qop text input callback textinputcallback callbacks get text gettext realm name realmname text input callback textinputcallback callbacks get text gettext text input callback textinputcallback callbacks get text gettext auth method authmethod text input callback textinputcallback callbacks get text gettext io exception ioexception login exception loginexception to string tostring unsupported callback exception unsupportedcallbackexception login exception loginexception to string tostring validate username password received auth method authmethod basic form principal authenticate username password auth method authmethod equals http servlet request httpservletrequest digest principal authenticate username password non ce nonce cnonce qop realm name realmname auth method authmethod equals http servlet request httpservletrequest client cert principal get principal getprincipal username login exception loginexception unknown authentication method log debug login username principal report based success failure principal failed login exception failedloginexception username password incorrect log user code code cases code login module loginmodule code exception login exception loginexception logging failed override log out logout login exception loginexception subject get principals getprincipals remove principal committed principal realm methods methods load contents configuration file load validate existence configuration file file file file path name pathname file is absolute isabsolute file file system get property getproperty globals catalina base prop path name pathname file exists file can read canread log warn load configuration file file get absolute path getabsolutepath load contents configuration file digester digester digester digester set valid ating setvalidating digester add rule set addruleset memory rule set memoryruleset digester push digester parse file exception log warn error processing configuration file file get absolute path getabsolutepath digester reset
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license compression filters compressionfilters java io exception ioexception java output stream outputstream java util zip gzip output stream gzipoutputstream javax servlet servlet output stream servletoutputstream implementation servlet output stream servletoutputstream works compression servlet response wrapper compressionservletresponsewrapper implementation author amy roh author dmitri val din valdin compression response stream compressionresponsestream servlet output stream servletoutputstream construct servlet output stream response param response wrapper responsewrapper response wrapper param original output originaloutput output stream compression response stream compressionresponsestream compression servlet response wrapper compressionservletresponsewrapper response wrapper responsewrapper servlet output stream servletoutputstream original output originaloutput closed response response wrapper responsewrapper output original output originaloutput instance variables threshold number decides comp ress compress use rs users configure web xml fit compression threshold compressionthreshold compression buffer size avoid chunking compression buffer compressionbuffer mime types comp ress compress string compression mime types compressionmimetypes text html text xml text plain debug level debug buffer output bytes passed buffer number data bytes buffer buffer count buffercount underlying gzip output stream write data output stream outputstream gzipstream stream closed closed content length write defined content length length response servlet output stream compression servlet response wrapper compressionservletresponsewrapper response underlying servlet output stream write data servlet output stream servletoutputstream output methods debug level set debug level setdebuglevel debug debug debug compression threshold compressionthreshold number create buffer size set compression threshold setcompressionthreshold compression threshold compressionthreshold compression threshold compressionthreshold compression threshold compressionthreshold buffer compression threshold compressionthreshold debug system println compression threshold compressionthreshold compression threshold compressionthreshold compression buffer size avoid chunking set compression buffer setcompressionbuffer compression buffer compressionbuffer compression buffer compressionbuffer compression buffer compressionbuffer debug system println compression buffer compressionbuffer compression buffer compressionbuffer supported mime types set compression mime types setcompressionmimetypes string compression mime types compressionmimetypes compression mime types compressionmimetypes compression mime types compressionmimetypes debug system println compression mime types compressionmimetypes compression mime types compressionmimetypes close output stream causing buf fered buffered data flushed output data io exception ioexception override close io exception ioexception debug system println close compression response stream compressionresponsestream closed io exception ioexception output stream closed gzipstream flush to zip flushtogzip gzipstream close gzipstream buffer count buffercount debug system print output write system write buffer buffer count buffercount system println output write buffer buffer count buffercount buffer count buffercount output close closed flush buf fered buffered data output stream response committed override flush io exception ioexception debug system println flush compression response stream compressionresponsestream closed io exception ioexception flush closed output stream gzipstream gzipstream flush flush to zip flushtogzip io exception ioexception debug system println flush to zip flushtogzip compression response stream compressionresponsestream buffer count buffercount debug system println flushing g zip stream gzipstream buffer count buffercount buffer count buffercount write to zip writetogzip buffer buffer count buffercount buffer count buffercount write output stream param written exception io exception ioexception input output error occurs override write io exception ioexception debug system println write compression response stream compressionresponsestream closed io exception ioexception write closed output stream buffer count buffercount buffer length flush to zip flushtogzip buffer buffer count buffercount write code length code bytes array output stream param array written exception io exception ioexception input output error occurs override write io exception ioexception write length write code len code bytes array starting offset output stream param array bytes written param relative starting offset bytes written param len number bytes written exception io exception ioexception input output error occurs override write len io exception ioexception debug system println write buffer count buffercount buffer count buffercount len len debug system print write system write len system println closed io exception ioexception write closed output stream len write buffer len buffer length buffer count buffercount system arraycopy buffer buffer count buffercount len buffer count buffercount len space buffer flush flush to zip flushtogzip note buffer count buffercount len buffer length buffer count buffercount system arraycopy buffer buffer count buffercount len buffer count buffercount len write direct gzip write to zip writetogzip len write to zip writetogzip len io exception ioexception debug system println write to zip writetogzip len len debug system print write to zip writetogzip system write len system println gzipstream debug system println gzip output stream gzipoutputstream already comp res sed alreadycompressed string content encoding contentencoding response get header getheader content encoding content encoding contentencoding content encoding contentencoding gzip already comp res sed alreadycompressed debug system println content comp res sed compressed debug system println content comp res sed compressed comp res sible mime type compressiblemimetype check compatible mime type compression mime types compressionmimetypes starts with string array startswithstringarray compression mime types compressionmimetypes response get content type getcontenttype comp res sible mime type compressiblemimetype debug system println mime type response get content type getcontenttype comp res sible compressible debug system println mime type response get content type getcontenttype comp res sible compressible response is committed iscommitted debug system print response committed original output stream gzipstream output already comp res sed alreadycompressed debug system print response comp res sed compressed original output stream gzipstream output comp res sible mime type compressiblemimetype debug system print response mime type comp res sible compressible original output stream gzipstream output response add header addheader content encoding gzip don preset content length wrong gzip ping gzipping response set content length setcontentlength response set buffer size setbuffersize compression buffer compressionbuffer gzipstream gzip output stream gzipoutputstream output gzipstream write len methods response stream closed closed closed checks entry string array starts param s array sarray string array stringarray param string starts with string array startswithstringarray string s array sarray string s array sarray length starts with startswith s array sarray
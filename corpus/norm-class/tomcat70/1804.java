licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license javax servlet http java io exception ioexception java print writer printwriter java util hash map hashmap java util list java util map javax servlet servlet exception servletexception org junit org junit test org apache catalina core standard context standardcontext org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk test http servlet testhttpservlet tomcat base test tomcatbasetest test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required standard context standardcontext ctx standard context standardcontext tomcat add context addcontext map test servlet l arg e body servlet largebodyservlet large body servlet largebodyservlet l arg e body servlet largebodyservlet tomcat add servlet addservlet ctx large body servlet largebodyservlet large body servlet largebodyservlet ctx add servlet mapping addservletmapping large body servlet largebodyservlet tomcat start map string list string res headers resheaders hash map hashmap string list string head url headurl http localhost get port getport byte chunk bytechunk res headers resheaders assert equals assertequals http servlet response httpservletresponse assert equals assertequals l arg e body servlet largebodyservlet response length res headers resheaders content length l arg e body servlet largebodyservlet http servlet httpservlet serialversionuid string response length override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set header setheader content length response length verifies content length returned head operations servlet includes content servlet test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required standard context standardcontext ctx standard context standardcontext tomcat add context addcontext bug servlet outer servletouter bug servlet outer servletouter tomcat add servlet addservlet ctx bug servlet outer servletouter ctx add servlet mapping addservletmapping bug servlet outer servletouter bug servlet inner servletinner bug servlet inner servletinner tomcat add servlet addservlet ctx bug servlet inner servletinner ctx add servlet mapping addservletmapping bug servlet inner servletinner tomcat start map string list string res headers resheaders hash map hashmap string list string string path http localhost get port getport byte chunk bytechunk byte chunk bytechunk get url geturl path res headers resheaders assert equals assertequals http servlet response httpservletresponse string length res headers resheaders content length assert equals assertequals parse long parselong length get length getlength recycle head url headurl path res headers resheaders assert equals assertequals http servlet response httpservletresponse assert equals assertequals get length getlength assert equals assertequals length res headers resheaders content length tomcat bug servlet outer servletouter http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf print writer printwriter resp get writer getwriter println header req get request dispatcher getrequestdispatcher include req resp println foo ter footer bug servlet inner servletinner http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception io exception ioexception resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf print writer printwriter resp get writer getwriter println included
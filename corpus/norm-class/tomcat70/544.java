licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache coyote http upgrade java io exception ioexception java nio channels selection key selectionkey java nio channels selector org apache tomcat util net nio channel niochannel org apache tomcat util net nio endpoint nioendpoint org apache tomcat util net nio selector pool nioselectorpool org apache tomcat util net socket wrapper socketwrapper nio servlet output stream nioservletoutputstream abstract servlet output stream abstractservletoutputstream nio channel niochannel channel nio selector pool nioselectorpool pool max write maxwrite nio servlet output stream nioservletoutputstream socket wrapper socketwrapper nio channel niochannel socket wrapper socketwrapper async write buffer size asyncwritebuffersize nio selector pool nioselectorpool pool async write buffer size asyncwritebuffersize channel socket wrapper socketwrapper get socket getsocket pool pool max write maxwrite channel get buf handler getbufhandler get write buffer getwritebuffer capacity override do write dowrite block len io exception ioexception left to write lefttowrite len count offset left to write lefttowrite write this loop writethisloop written this loop writtenthisloop left to write lefttowrite max write maxwrite write this loop writethisloop max write maxwrite write this loop writethisloop left to write lefttowrite written this loop writtenthisloop do write internal dowriteinternal block offset write this loop writethisloop count written this loop writtenthisloop offset written this loop writtenthisloop left to write lefttowrite written this loop writtenthisloop written this loop writtenthisloop write this loop writethisloop count do write internal dowriteinternal block len io exception ioexception channel get buf handler getbufhandler get write buffer getwritebuffer clear channel get buf handler getbufhandler get write buffer getwritebuffer len channel get buf handler getbufhandler get write buffer getwritebuffer flip written nio endpoint nioendpoint key attachment keyattachment att nio endpoint nioendpoint key attachment keyattachment channel get attachment getattachment att io exception ioexception key cancelled write timeout writetimeout att get write timeout getwritetimeout selector selector selector pool io exception ioexception written pool write channel get buf handler getbufhandler get write buffer getwritebuffer channel selector write timeout writetimeout block selector pool selector written len channel get poller getpoller add channel selection key selectionkey write written override do flush doflush io exception ioexception nio endpoint nioendpoint key attachment keyattachment att nio endpoint nioendpoint key attachment keyattachment channel get attachment getattachment att io exception ioexception key cancelled write timeout writetimeout att get write timeout getwritetimeout selector selector selector pool io exception ioexception channel flush selector write timeout writetimeout selector pool selector override do close doclose io exception ioexception channel close
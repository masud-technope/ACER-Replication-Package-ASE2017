licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina security java io exception ioexception java lang reflect invocation target exception invocationtargetexception java lang reflect method java security principal java security privileged action exception privilegedactionexception java security privileged exception action privilegedexceptionaction java util map java util concurrent concurrent hash map concurrenthashmap javax security subject javax servlet filter javax servlet servlet javax servlet servlet exception servletexception javax servlet unavailable exception unavailableexception javax servlet http http servlet request httpservletrequest javax servlet http http session httpsession org apache catalina globals org apache catalina comet comet filter cometfilter org apache catalina comet comet processor cometprocessor org apache tomcat util exception utils exceptionutils org apache tomcat util res string manager stringmanager security util securityutil note indexes over lap overlap servlet init service event destroy filter do filter dofilter do filter event dofilterevent destroy init service dofilter event dofilterevent destroy string init method init string dofilter method do filter dofilter string service method service string event method event string dofilterevent method do filter event dofilterevent string destroy method destroy cache creating methods map object method class cache classcache concurrent hash map concurrenthashmap object method org apache juli logging log log org apache juli logging log factory logfactory get log getlog security util securityutil package definition enabled packagedefinitionenabled system get property getproperty definition system get property getproperty access string resources string manager stringmanager string manager stringmanager get manager getmanager constants perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code servlet code method called do as privilege doasprivilege string method name methodname servlet target object targetobject java lang exception do as privilege doasprivilege method name methodname target object targetobject perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code servlet code method called param target type targettype code code array instantiate code method code object param target arguments targetarguments code object code array runtime parameters instance do as privilege doasprivilege string method name methodname servlet target object targetobject target type targettype object target arguments targetarguments java lang exception do as privilege doasprivilege method name methodname target object targetobject target type targettype target arguments targetarguments perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code servlet code method called param target parameter types targetparametertypes code code array instantiate code method code object param target arguments targetarguments code object code array runtime parameters instance param principal code principal code security privilege apply do as privilege doasprivilege string method name methodname servlet target object targetobject target parameter types targetparametertypes object target arguments targetarguments principal principal java lang exception comet processor cometprocessor instances cached servlet no such method exception nosuchmethodexception thrown servlet target type targettype target object targetobject comet processor cometprocessor comet processor cometprocessor servlet method method method methods cache methodscache class cache classcache servlet methods cache methodscache method create method and cache it createmethodandcacheit methods cache methodscache target type targettype method name methodname target parameter types targetparametertypes method find method findmethod methods cache methodscache method name methodname method method create method and cache it createmethodandcacheit methods cache methodscache target type targettype method name methodname target parameter types targetparametertypes execute method target object targetobject target arguments targetarguments principal perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code filter code method called do as privilege doasprivilege string method name methodname filter target object targetobject java lang exception do as privilege doasprivilege method name methodname target object targetobject perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code filter code method called param target type targettype code code array instantiate code method code object param target arguments targetarguments code object code array runtime parameters instance do as privilege doasprivilege string method name methodname filter target object targetobject target type targettype object target arguments targetarguments java lang exception do as privilege doasprivilege method name methodname target object targetobject target type targettype target arguments targetarguments perform work code subject code work granted code code subject param method name methodname method apply security restriction param target object targetobject code filter code method called param target parameter types targetparametertypes code code array instantiate code method code object param target parameter values targetparametervalues code object code array runtime parameters instance param principal code principal code security privilege apply do as privilege doasprivilege string method name methodname filter target object targetobject target parameter types targetparametertypes object target parameter values targetparametervalues principal principal java lang exception comet filter cometfilter instances cached filter no such method exception nosuchmethodexception thrown filter target type targettype target object targetobject comet filter cometfilter comet filter cometfilter filter method method method methods cache methodscache class cache classcache filter methods cache methodscache method create method and cache it createmethodandcacheit methods cache methodscache target type targettype method name methodname target parameter types targetparametertypes method find method findmethod methods cache methodscache method name methodname method method create method and cache it createmethodandcacheit methods cache methodscache target type targettype method name methodname target parameter types targetparametertypes execute method target object targetobject target parameter values targetparametervalues principal perform work code subject code work granted code code subject param method method apply security restriction param target object targetobject code servlet code method called param target arguments targetarguments code object code array runtime parameters instance param principal code principal code security privilege applies execute method method object target object targetobject object target arguments targetarguments principal principal java lang exception subject subject privileged exception action privilegedexceptionaction pea privileged exception action privilegedexceptionaction override exception method invoke target object targetobject target arguments targetarguments argument request object target arguments targetarguments target arguments targetarguments http servlet request httpservletrequest http servlet request httpservletrequest request http servlet request httpservletrequest target arguments targetarguments has subject hassubject http session httpsession session request get session getsession session subject subject session get attribute getattribute globals subject attr has subject hassubject subject subject subject subject principal subject get principals getprincipals add principal session has subject hassubject session set attribute setattribute globals subject attr subject subject do as privileged doasprivileged subject pea privileged action exception privilegedactionexception throwable get exception getexception invocation target exception invocationtargetexception get exception getexception get cause getcause exception utils exceptionutils handle throwable handlethrowable log is debug enabled isdebugenabled log debug get string getstring security util securityutil do as privilege doasprivilege unavailable exception unavailableexception unavailable exception unavailableexception servlet exception servletexception servlet exception servletexception io exception ioexception io exception ioexception runtime exception runtimeexception runtime exception runtimeexception servlet exception servletexception get message getmessage find method stored cache param methods cache methodscache cache store method instance param method name methodname method apply security restriction method instance created method find method findmethod method methods cache methodscache string method name methodname method name methodname equals init method methods cache methodscache init method name methodname equals destroy method methods cache methodscache destroy method name methodname equals service method methods cache methodscache service method name methodname equals dofilter method methods cache methodscache dofilter method name methodname equals event method methods cache methodscache event method name methodname equals dofilterevent method methods cache methodscache dofilterevent create method cache param methods cache methodscache cache store method instance param target type targettype method called param method name methodname method apply security restriction param parameter types parametertypes code code array instantiate code method code object method instance method create method and cache it createmethodandcacheit method methods cache methodscache target type targettype string method name methodname parameter types parametertypes exception methods cache methodscache methods cache methodscache method method method target type targettype get method getmethod method name methodname parameter types parametertypes method name methodname equals init method methods cache methodscache init method method name methodname equals destroy method methods cache methodscache destroy method method name methodname equals service method methods cache methodscache service method method name methodname equals dofilter method methods cache methodscache dofilter method method name methodname equals event method methods cache methodscache event method method name methodname equals dofilterevent method methods cache methodscache dofilterevent method class cache classcache target type targettype methods cache methodscache method remove object cache param cached object cachedobject object remove remove object cached object cachedobject class cache classcache remove cached object cachedobject code security manager securitymanager code security enabled protection mechanism enabled is package protection enabled ispackageprotectionenabled package definition enabled packagedefinitionenabled globals security enabled
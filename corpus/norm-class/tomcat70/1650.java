licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina filters java i o exception ioexception java net uri java net uri syntax exception urisyntaxexception java util arrays java util collection java util hash set hashset java util linked list linkedlist java util list java util locale java util javax servlet filter javax servlet filter chain filterchain javax servlet filter config filterconfig javax servlet servlet exception servletexception javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util res string manager stringmanager link filter enable client side cross origin requests implementing cors ross rigin esource haring specification resources link http servlet request httpservletrequest request ins pected inspected specification response headers link http servlet response httpservletresponse sets request attributes determine nature request down stream downstream cors is cors request iscorsrequest flag determine request cors request code code cors request code code cors request origin origin url url request origin ated originated cors request type type request values simple request preceded pre flight request actual request preceded pre flight request pre flight pre flight request cors normal origin request invalid cors cross origin request invalid cors request headers request headers access control request headers header pre flight request href http org cors cors specification cors filter corsfilter filter log log log factory logfactory get log getlog cors filter corsfilter string manager stringmanager string manager stringmanager get manager getmanager constants link collection origins consisting origins allowed access resource collection string allowed origins allowedorigins determines origin allowed request any origin allowed anyoriginallowed link collection methods consisting methods supported resource collection string allowed http methods allowedhttpmethods link collection headers consisting header field names supported resource collection string allowed http headers allowedhttpheaders link collection exposed headers consisting header field names headers simple response headers resource exposed collection string exposed headers exposedheaders supports credentials flag resource supports user credentials request resource supports credentials supportscredentials seconds pre flight request cached pre flight result cache preflight max age preflightmaxage determines request decorated decorate request decoraterequest cors filter corsfilter allowed origins allowedorigins hash set hashset string allowed http methods allowedhttpmethods hash set hashset string allowed http headers allowedhttpheaders hash set hashset string exposed headers exposedheaders hash set hashset string override do filter dofilter servlet request servletrequest servlet request servletrequest servlet response servletresponse servlet response servletresponse filter chain filterchain filter chain filterchain i o exception ioexception servlet exception servletexception servlet request servletrequest http servlet request httpservletrequest servlet response servletresponse http servlet response httpservletresponse servlet exception servletexception get string getstring cors filter corsfilter only http onlyhttp safe down cast downcast point http servlet request httpservletrequest request http servlet request httpservletrequest servlet request servletrequest http servlet response httpservletresponse response http servlet response httpservletresponse servlet response servletresponse determines cors request type cors filter corsfilter cors request type corsrequesttype request type requesttype check request type checkrequesttype request adds cors specific attributes request decorate request decoraterequest cors filter corsfilter decoratecorsproperties request request type requesttype request type requesttype simple handles simple cors request handlesimplecors request response filter chain filterchain actual handles actual cors request handlesimplecors request response filter chain filterchain pre flight handles pre flight cors request handlepreflightcors request response filter chain filterchain cors handles normal request cross origin request handlenoncors request response filter chain filterchain handles cors request violates specification handleinvalidcors request response filter chain filterchain override init filter config filterconfig filter config filterconfig servlet exception servletexception initialize defaults parse and store parseandstore allowed origins allowed http methods allowed http headers exposed headers supports credentials pref light preflight max age maxage decorate request filter config filterconfig string config allowed origins configallowedorigins filter config filterconfig get init parameter getinitparameter param cors allowed origins string config allowed http methods configallowedhttpmethods filter config filterconfig get init parameter getinitparameter param cors allowed methods string config allowed http headers configallowedhttpheaders filter config filterconfig get init parameter getinitparameter param cors allowed headers string config exposed headers configexposedheaders filter config filterconfig get init parameter getinitparameter param cors exposed headers string config supports credentials configsupportscredentials filter config filterconfig get init parameter getinitparameter param cors support credentials string config preflight max age configpreflightmaxage filter config filterconfig get init parameter getinitparameter param cors pref light preflight max age maxage string config decorate request configdecoraterequest filter config filterconfig get init parameter getinitparameter param cors request decorate parse and store parseandstore config allowed origins configallowedorigins config allowed http methods configallowedhttpmethods config allowed http headers configallowedhttpheaders config exposed headers configexposedheaders config supports credentials configsupportscredentials config preflight max age configpreflightmaxage config decorate request configdecoraterequest handles cors request type link cors request type corsrequesttype simple param request link http servlet request httpservletrequest object param response link http servlet response httpservletresponse object param filter chain filterchain link filter chain filterchain object i o exception ioexception servlet exception servletexception href http org cors resource requests simple cross origin request actual request redirects handlesimplecors http servlet request httpservletrequest request http servlet response httpservletresponse response filter chain filterchain filter chain filterchain i o exception ioexception servlet exception servletexception cors filter corsfilter cors request type corsrequesttype request type requesttype check request type checkrequesttype request request type requesttype cors filter corsfilter cors request type corsrequesttype simple request type requesttype cors filter corsfilter cors request type corsrequesttype actual illegal argument exception illegalargumentexception get string getstring cors filter corsfilter wrong type wrongtype cors filter corsfilter cors request type corsrequesttype simple cors filter corsfilter cors request type corsrequesttype actual string origin request get header getheader cors filter corsfilter request header origin string method request get method getmethod is origin allowed isoriginallowed origin handleinvalidcors request response filter chain filterchain allowed http methods allowedhttpmethods method handleinvalidcors request response filter chain filterchain add single access control origin header any origin allowed anyoriginallowed supports credentials supportscredentials resource doesn support credentials origin allowed cors request header response add header addheader cors filter corsfilter response header access control origin resource supports credentials add single access control origin header origin header response add header addheader cors filter corsfilter response header access control origin origin string supports credentials supportscredentials response add header addheader cors filter corsfilter response header access control credentials field names list exposed headers exposed headers exposedheaders exposed headers exposedheaders size string exposed headers string exposedheadersstring join exposed headers exposedheaders response add header addheader cors filter corsfilter response header access control expose headers exposed headers string exposedheadersstring request filter chain filter chain filterchain do filter dofilter request response handles cors pre flight request param request link http servlet request httpservletrequest object param response link http servlet response httpservletresponse object param filter chain filterchain link filter chain filterchain object i o exception ioexception servlet exception servletexception handlepreflightcors http servlet request httpservletrequest request http servlet response httpservletresponse response filter chain filterchain filter chain filterchain i o exception ioexception servlet exception servletexception cors request type corsrequesttype request type requesttype check request type checkrequesttype request request type requesttype cors request type corsrequesttype pre flight illegal argument exception illegalargumentexception get string getstring cors filter corsfilter wrong type wrongtype cors request type corsrequesttype pre flight to lower case tolowercase locale english string origin request get header getheader cors filter corsfilter request header origin is origin allowed isoriginallowed origin handleinvalidcors request response filter chain filterchain string access control request method accesscontrolrequestmethod request get header getheader cors filter corsfilter request header access control request method access control request method accesscontrolrequestmethod handleinvalidcors request response filter chain filterchain access control request method accesscontrolrequestmethod access control request method accesscontrolrequestmethod trim string access control request headers header accesscontrolrequestheadersheader request get header getheader cors filter corsfilter request header access control request headers list string access control request headers accesscontrolrequestheaders linked list linkedlist string access control request headers header accesscontrolrequestheadersheader access control request headers header accesscontrolrequestheadersheader trim is empty isempty string headers access control request headers header accesscontrolrequestheadersheader trim split string header headers access control request headers accesscontrolrequestheaders add header trim to lower case tolowercase locale english allowed http methods allowedhttpmethods access control request method accesscontrolrequestmethod handleinvalidcors request response filter chain filterchain access control request headers accesscontrolrequestheaders is empty isempty string header access control request headers accesscontrolrequestheaders allowed http headers allowedhttpheaders header handleinvalidcors request response filter chain filterchain supports credentials supportscredentials response add header addheader cors filter corsfilter response header access control origin origin response add header addheader cors filter corsfilter response header access control credentials any origin allowed anyoriginallowed response add header addheader cors filter corsfilter response header access control origin response add header addheader cors filter corsfilter response header access control origin origin preflight max age preflightmaxage response add header addheader cors filter corsfilter response header access control max age string value of valueof preflight max age preflightmaxage response add header addheader cors filter corsfilter response header access control methods access control request method accesscontrolrequestmethod allowed http headers allowedhttpheaders allowed http headers allowedhttpheaders is empty isempty response add header addheader cors filter corsfilter response header access control headers join allowed http headers allowedhttpheaders request filter chain handles request cors request valid request cross origin request implementation for wards forwards request filter chain param request link http servlet request httpservletrequest object param response link http servlet response httpservletresponse object param filter chain filterchain link filter chain filterchain object i o exception ioexception servlet exception servletexception handlenoncors http servlet request httpservletrequest request http servlet response httpservletresponse response filter chain filterchain filter chain filterchain i o exception ioexception servlet exception servletexception request pass filter chain filterchain do filter dofilter request response handles cors request violates specification param request link http servlet request httpservletrequest object param response link http servlet response httpservletresponse object param filter chain filterchain link filter chain filterchain object handleinvalidcors http servlet request httpservletrequest request http servlet response httpservletresponse response filter chain filterchain filter chain filterchain string origin request get header getheader cors filter corsfilter request header origin string method request get method getmethod string access control request headers accesscontrolrequestheaders request get header getheader request header access control request headers response set content type setcontenttype text plain response set status setstatus http servlet response httpservletresponse forbidden response reset buffer resetbuffer log is debug enabled isdebugenabled debug string builder stringbuilder message string builder stringbuilder invalid cors request origin message append origin message append method message append method access control request headers accesscontrolrequestheaders message append access control request headers message append access control request headers accesscontrolrequestheaders log debug message to string tostring override destroy noop dec orates decorates link http servlet request httpservletrequest cors attributes cors is cors request iscorsrequest flag determine request cors request code code cors request code code cors request origin origin url cors request type type request values code simple code code preflight code code cors code code invalid cors code cors request headers request headers access control request headers header pre flight request param request link http servlet request httpservletrequest object param cors request type corsrequesttype link cors request type corsrequesttype object decoratecorsproperties http servlet request httpservletrequest request cors request type corsrequesttype cors request type corsrequesttype request illegal argument exception illegalargumentexception get string getstring cors filter corsfilter null request nullrequest cors request type corsrequesttype illegal argument exception illegalargumentexception get string getstring cors filter corsfilter null request type nullrequesttype cors request type corsrequesttype simple request set attribute setattribute cors filter corsfilter http request attribute cors request request set attribute setattribute cors filter corsfilter http request attribute origin request get header getheader cors filter corsfilter request header origin request set attribute setattribute cors filter corsfilter http request attribute request type cors request type corsrequesttype to lower case tolowercase locale english actual request set attribute setattribute cors filter corsfilter http request attribute cors request request set attribute setattribute cors filter corsfilter http request attribute origin request get header getheader cors filter corsfilter request header origin request set attribute setattribute cors filter corsfilter http request attribute request type cors request type corsrequesttype to lower case tolowercase locale english pre flight request set attribute setattribute cors filter corsfilter http request attribute cors request request set attribute setattribute cors filter corsfilter http request attribute origin request get header getheader cors filter corsfilter request header origin request set attribute setattribute cors filter corsfilter http request attribute request type cors request type corsrequesttype to lower case tolowercase locale english string headers request get header getheader request header access control request headers headers headers request set attribute setattribute cors filter corsfilter http request attribute request headers headers cors request set attribute setattribute cors filter corsfilter http request attribute cors request don attributes joins elements link string element separated separator param elements link elements join param join separator joinseparator character sep arating separating elements joined link string code code elements link string join collection string elements string join separator joinseparator string separator elements join separator joinseparator separator join separator joinseparator string builder stringbuilder buffer string builder stringbuilder is first isfirst string element elements is first isfirst buffer append separator is first isfirst element buffer append element buffer to string tostring determines request type param request cors request type corsrequesttype check request type checkrequesttype http servlet request httpservletrequest request cors request type corsrequesttype request type requesttype cors request type corsrequesttype invalid cors request illegal argument exception illegalargumentexception get string getstring cors filter corsfilter null request nullrequest string origin header originheader request get header getheader request header origin origin header originheader origin header originheader is empty isempty request type requesttype cors request type corsrequesttype invalid cors is valid origin isvalidorigin origin header originheader request type requesttype cors request type corsrequesttype invalid cors is local origin islocalorigin request origin header originheader cors request type corsrequesttype cors string method request get method getmethod method options equals method string access control request method header accesscontrolrequestmethodheader request get header getheader request header access control request method access control request method header accesscontrolrequestmethodheader access control request method header accesscontrolrequestmethodheader is empty isempty request type requesttype cors request type corsrequesttype pre flight access control request method header accesscontrolrequestmethodheader access control request method header accesscontrolrequestmethodheader is empty isempty request type requesttype cors request type corsrequesttype invalid cors request type requesttype cors request type corsrequesttype actual equals method head equals method request type requesttype cors request type corsrequesttype simple post equals method string media type mediatype get media type getmediatype request get content type getcontenttype media type mediatype simple http request content type values media type mediatype request type requesttype cors request type corsrequesttype simple request type requesttype cors request type corsrequesttype actual request type requesttype cors request type corsrequesttype actual request type requesttype cors request type corsrequesttype cors request type requesttype is local origin islocalorigin http servlet request httpservletrequest request string origin build scheme host port request string builder stringbuilder target string builder stringbuilder string scheme request get scheme getscheme scheme scheme scheme to lower case tolowercase locale english target append scheme target append string host request get server name getservername host target append host port request get server port getserverport http equals scheme port https equals scheme port target append target append port origin equals ignore case equalsignorecase target to string tostring trimmed media type content type string get media type getmediatype string content type contenttype content type contenttype string result content type contenttype to lower case tolowercase locale english first semi colon index firstsemicolonindex result index of indexof first semi colon index firstsemicolonindex result result substring first semi colon index firstsemicolonindex result result trim result checks origin allowed cors request param origin origin code code origin allowed code code is origin allowed isoriginallowed string origin any origin allowed anyoriginallowed origins allowed origins allowedorigins origin parses param pop ulates populates configuration variables param overrides param allowed origins allowedorigins link string comma separated origins param allowed http methods allowedhttpmethods link string comma separated http methods param allowed http headers allowedhttpheaders link string comma separated http headers param exposed headers exposedheaders link string comma separated headers exposed param supports credentials supportscredentials support credentials enabled param preflight max age preflightmaxage amount seconds user agent allowed cache result pre flight request servlet exception servletexception parse and store parseandstore string allowed origins allowedorigins string allowed http methods allowedhttpmethods string allowed http headers allowedhttpheaders string exposed headers exposedheaders string supports credentials supportscredentials string preflight max age preflightmaxage string decorate request decoraterequest servlet exception servletexception allowed origins allowedorigins allowed origins allowedorigins trim equals any origin allowed anyoriginallowed any origin allowed anyoriginallowed string set allowed origins setallowedorigins parse string to set parsestringtoset allowed origins allowedorigins allowed origins allowedorigins clear allowed origins allowedorigins add all addall set allowed origins setallowedorigins allowed http methods allowedhttpmethods string set allowed http methods setallowedhttpmethods parse string to set parsestringtoset allowed http methods allowedhttpmethods allowed http methods allowedhttpmethods clear allowed http methods allowedhttpmethods add all addall set allowed http methods setallowedhttpmethods allowed http headers allowedhttpheaders string set allowed http headers setallowedhttpheaders parse string to set parsestringtoset allowed http headers allowedhttpheaders string lower case headers lowercaseheaders hash set hashset string string header set allowed http headers setallowedhttpheaders string lower case lowercase header to lower case tolowercase locale english lower case headers lowercaseheaders add lower case lowercase allowed http headers allowedhttpheaders clear allowed http headers allowedhttpheaders add all addall lower case headers lowercaseheaders exposed headers exposedheaders string set exposed headers setexposedheaders parse string to set parsestringtoset exposed headers exposedheaders exposed headers exposedheaders clear exposed headers exposedheaders add all addall set exposed headers setexposedheaders supports credentials supportscredentials supports credentials supportscredentials parse boolean parseboolean supports credentials supportscredentials preflight max age preflightmaxage preflight max age preflightmaxage is empty isempty preflight max age preflightmaxage parse long parselong preflight max age preflightmaxage preflight max age preflightmaxage number format exception numberformatexception servlet exception servletexception get string getstring cors filter corsfilter invalid preflight max age invalidpreflightmaxage decorate request decoraterequest decorate request decoraterequest parse boolean parseboolean decorate request decoraterequest takes comma separated list returns string param data comma separated list strings string string parse string to set parsestringtoset string data string splits data data length splits data split splits string string hash set hashset string splits length string split splits add split trim checks origin valid criteria encoded character origin valid origin valid origin valid link uri param origin href http tools ietf org html rfc rfc is valid origin isvalidorigin string origin checks encoded characters helps prevent crlf injection origin valid origin equals origin treat file uri s uris valid origins origin starts with startswith file uri originuri originuri uri origin uri syntax exception urisyntaxexception scheme uri originuri get scheme getscheme determines origin allowed cors request code code enabled is any origin allowed isanyoriginallowed any origin allowed anyoriginallowed returns link headers exposed browser collection string get exposed headers getexposedheaders exposed headers exposedheaders determines supports credentials enabled is supports credentials issupportscredentials supports credentials supportscredentials returns preflight response cache time seconds time cache seconds get preflight max age getpreflightmaxage preflight max age preflightmaxage returns link allowed origins allowed requests link collection string get allowed origins getallowedorigins allowed origins allowedorigins returns link http methods allowed requests link collection string get allowed http methods getallowedhttpmethods allowed http methods allowedhttpmethods returns link headers support resource link collection string get allowed http headers getallowedhttpheaders allowed http headers allowedhttpheaders cors response headers access control origin header resource shared based returning origin request header response string response header access control origin access control origin access control credentials header response request exposed omit credentials flag unset response preflight request actual request include user credentials string response header access control credentials access control credentials access control expose headers header headers safe expose api cors api specification string response header access control expose headers access control expose headers access control max age header preflight request cached preflight result cache string response header access control max age access control max age access control methods header response preflight request methods actual request string response header access control methods access control methods access control headers header response preflight request header field names actual request string response header access control headers access control headers cors request headers origin header cross origin request preflight request origin ates originates string request header origin origin access control request method header method actual request preflight request string request header access control request method access control request method access control request headers header headers actual request preflight request string request header access control request headers access control request headers request attributes prefix cors request attribute string http request attribute prefix cors attribute origin request string http request attribute origin http request attribute prefix request origin suggesting request cors request string http request attribute cors request http request attribute prefix is cors request iscorsrequest type cors request type link cors request type corsrequesttype string http request attribute request type http request attribute prefix request type request headers access control request headers header pre flight request string http request attribute request headers http request attribute prefix request headers enum erates enumerates var ies varies types cors requests utility methods determine request type enum cors request type corsrequesttype simple http request should n shouldn pre flighted simple http request pre flighted actual pre flight cors request meta simple http request pre flight cors request normal request cors invalid cors request qualifies cors request fails valid invalid cors link collection http methods sensitive deprecated removed tomcat onwards deprecated collection string http methods hash set hashset string arrays as list aslist options head post delete trace connect link collection simple http methods sensitive deprecated removed tomcat onwards http methods link simple http methods assumed simple deprecated collection string complex http methods hash set hashset string arrays as list aslist delete trace connect link collection simple http methods sensitive href http org cors terminology http org cors terminology collection string simple http methods hash set hashset string arrays as list aslist post head link collection simple http request headers sensitive href http org cors terminology http org cors terminology collection string simple http request headers hash set hashset string arrays as list aslist accept accept language content language link collection simple http request headers sensitive href http org cors terminology http org cors terminology collection string simple http response headers hash set hashset string arrays as list aslist cache control content language content type expires modified pragma link collection media type values content type header treated simple note media type values compared ignoring parameters insensitive manner href http org cors terminology http org cors terminology collection string simple http request content type values hash set hashset string arrays as list aslist application form url encoded urlencoded multipart form data text plain configuration defaults origins allowed requests string allowed origins methods supported post head options string allowed http methods post head options time duration cache pre flight response mins string pref light preflight max age maxage support credentials turned string supports credentials headers supported origin accept requested content type access control request method access control request headers string allowed http headers origin accept requested content type access control request method access control request headers headers exposed response string exposed headers request decorated cors attributes string decorate request filter config init param key retrieve allowed origins link filter config filterconfig string param cors allowed origins cors allowed origins key retrieve support credentials link filter config filterconfig string param cors support credentials cors support credentials key retrieve exposed headers link filter config filterconfig string param cors exposed headers cors exposed headers key retrieve allowed headers link filter config filterconfig string param cors allowed headers cors allowed headers key retrieve allowed methods link filter config filterconfig string param cors allowed methods cors allowed methods key retrieve preflight max age link filter config filterconfig string param cors pref light preflight max age maxage cors preflight max age maxage key determine request decorated string param cors request decorate cors request decorate
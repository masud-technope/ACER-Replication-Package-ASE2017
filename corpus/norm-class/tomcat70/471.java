licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net java buffered reader bufferedreader java file java io exception ioexception java input stream inputstream java input stream reader inputstreamreader java output stream outputstream java reader javax net ssl handshake completed event handshakecompletedevent javax net ssl handshake completed listener handshakecompletedlistener javax net ssl ssl context sslcontext javax net ssl ssl socket sslsocket javax net ssl ssl socket factory sslsocketfactory org junit assert true asserttrue org junit fail org junit assume org junit test org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat util buf byte chunk bytechunk certificates file svn generated test files tomcat pmc repository license d licensed test ssl testssl tomcat base test tomcatbasetest test test simple ssl testsimplessl exception tester support testersupport configure client ssl configureclientssl tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file get build directory getbuilddirectory webapps examples tomcat add webapp addwebapp examples app dir appdir get absolute path getabsolutepath tester support testersupport init ssl initssl tomcat tomcat start byte chunk bytechunk res get url geturl https localhost get port getport examples servlets servlet hello world example helloworldexample assert true asserttrue res to string tostring index of indexof href helloworld html test test key pass testkeypass exception tester support testersupport configure client ssl configureclientssl tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file get build directory getbuilddirectory webapps examples tomcat add webapp addwebapp examples app dir appdir get absolute path getabsolutepath tester support testersupport init ssl initssl tomcat localhost copy jks change it changeit tomcat pass tomcatpass tomcat start byte chunk bytechunk res get url geturl https localhost get port getport examples servlets servlet hello world example helloworldexample assert true asserttrue res to string tostring index of indexof href helloworld html handshake done handshakedone test test renegotiate fail testrenegotiatefail exception secure tester support testersupport rfc supported tomcat tomcat get tomcat instance gettomcatinstance file app dir appdir file get build directory getbuilddirectory webapps examples app dir relative server tomcat add webapp addwebapp examples app dir appdir get absolute path getabsolutepath tester support testersupport init ssl initssl tomcat mitm att ack attack prev ented prevented tomcat start ssl context sslcontext ssl ctx sslctx ssl context sslcontext get instance getinstance tls ssl ctx sslctx init tester support testersupport get trust managers gettrustmanagers ssl socket factory sslsocketfactory socket factory socketfactory ssl ctx sslctx get socket factory getsocketfactory ssl socket sslsocket socket ssl socket sslsocket socket factory socketfactory create socket createsocket localhost get port getport socket add handshake completed listener addhandshakecompletedlistener handshake completed listener handshakecompletedlistener override handshake completed handshakecompleted handshake completed event handshakecompletedevent event handshake done handshakedone output stream outputstream socket get output stream getoutputstream write examples servlets servlet hello world example helloworldexample http get bytes getbytes flush input stream inputstream socket get input stream getinputstream nio connector read request handshake thread sleep socket start handshake starthandshake socket get output stream getoutputstream write host localhost get bytes getbytes io exception ioexception print stack trace printstacktrace fail negotiation failed reader input stream reader inputstreamreader buffered reader bufferedreader buffered reader bufferedreader string read line readline testing system println read line readline handshake done handshakedone success time d timed handshake fail negotiation worked test test renegotiate works testrenegotiateworks exception tomcat tomcat get tomcat instance gettomcatinstance assume assume true assumetrue ssl renegotiation supported test tester support testersupport is renegotiation supported isrenegotiationsupported get tomcat instance gettomcatinstance file app dir appdir file get build directory getbuilddirectory webapps examples app dir relative server tomcat add webapp addwebapp examples app dir appdir get absolute path getabsolutepath tester support testersupport init ssl initssl tomcat tomcat start ssl context sslcontext ssl ctx sslctx ssl context sslcontext get instance getinstance tls ssl ctx sslctx init tester support testersupport get trust managers gettrustmanagers ssl socket factory sslsocketfactory socket factory socketfactory tester support testersupport nosslv socket factory socketfactory ssl ctx sslctx get socket factory getsocketfactory ssl socket sslsocket socket ssl socket sslsocket socket factory socketfactory create socket createsocket localhost get port getport output stream outputstream socket get output stream getoutputstream write examples servlets servlet hello world example helloworldexample http get bytes getbytes flush socket start handshake starthandshake write host localhost get bytes getbytes io exception ioexception print stack trace printstacktrace fail negotiation failed input stream inputstream socket get input stream getinputstream reader input stream reader inputstreamreader buffered reader bufferedreader buffered reader bufferedreader string read line readline testing system println read line readline override set up setup exception tester support testersupport rfc supported ssl renegotiation disabled jvm system set property setproperty sun security ssl allow unsafe renegotiation allowunsaferenegotiation set up setup
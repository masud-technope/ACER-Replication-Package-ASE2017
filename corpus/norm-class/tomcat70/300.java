licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache coyote http upgrade java io exception ioexception javax servlet servlet input stream servletinputstream org apache coyote http upgrade servlet read listener readlistener org apache tomcat util res string manager stringmanager servlet methods link servlet input stream servletinputstream abstract servlet input stream abstractservletinputstream servlet input stream servletinputstream string manager stringmanager string manager stringmanager get manager getmanager constants close required closerequired start blocking mode ready read listener readlistener listener class loader classloader application loader applicationloader servlet method is finished isfinished listener illegal state exception illegalstateexception get string getstring upgrade sis is finished isfinished ise socket servlet method is ready isready listener illegal state exception illegalstateexception get string getstring upgrade sis is ready isready ise current ready ready boolean value booleanvalue ready value of valueof do is ready doisready io exception ioexception on error onerror ready boolean value booleanvalue servlet method set read listener setreadlistener read listener readlistener listener listener illegal argument exception illegalargumentexception get string getstring upgrade sis read listener readlistener listener illegal argument exception illegalargumentexception get string getstring upgrade sis read listener readlistener listener listener application loader applicationloader thread current thread currentthread get context class loader getcontextclassloader switching blocking don data ready override read io exception ioexception pre read checks prereadchecks read internal readinternal override read line readline len io exception ioexception pre read checks prereadchecks len count read internal readinternal count count len count count override read len io exception ioexception pre read checks prereadchecks do read doread listener len io exception ioexception ioe close required closerequired ioe override close io exception ioexception close required closerequired do close doclose pre read checks prereadchecks listener ready ready boolean value booleanvalue illegal state exception illegalstateexception get string getstring upgrade sis read ise longer data ready read internal readinternal io exception ioexception single reads blocking special handling single reads method result result do read doread listener io exception ioexception ioe close required closerequired ioe result result echo safe xff on all data read onalldataread io exception ioexception listener thread thread thread current thread currentthread class loader classloader original class loader originalclassloader thread get context class loader getcontextclassloader thread set context class loader setcontextclassloader application loader applicationloader listener on all data read onalldataread thread set context class loader setcontextclassloader original class loader originalclassloader on data available ondataavailable io exception ioexception listener ready thread thread thread current thread currentthread class loader classloader original class loader originalclassloader thread get context class loader getcontextclassloader thread set context class loader setcontextclassloader application loader applicationloader listener on data available ondataavailable thread set context class loader setcontextclassloader original class loader originalclassloader on error onerror throwable listener thread thread thread current thread currentthread class loader classloader original class loader originalclassloader thread get context class loader getcontextclassloader thread set context class loader setcontextclassloader application loader applicationloader listener on error onerror thread set context class loader setcontextclassloader original class loader originalclassloader ready is close required iscloserequired close required closerequired do is ready doisready io exception ioexception method overridden concrete implementations base ensure concurrent calls method socket do read doread block len io exception ioexception do close doclose io exception ioexception
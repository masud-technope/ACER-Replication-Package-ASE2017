licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina startup java file java i o exception ioexception java net malformedurlexception java net url java net url class loader urlclassloader java security access controller accesscontroller java security privileged action privilegedaction java util linked hash set linkedhashset java util list java util locale java util org apache juli logging log org apache juli logging log factory logfactory class loader factory classloaderfactory log log log factory logfactory get log getlog class loader factory classloaderfactory methods create loader based configuration defaults directory paths param unpacked array path names pathnames unpacked directories repositories loader code code unpacked directories considered param packed array path names pathnames directories jar files repositories loader code code directories jar files considered param parent parent loader loader code code system loader exception exception error occurs constructing loader class loader classloader create class loader createclassloader file unpacked file packed class loader classloader parent exception log is debug enabled isdebugenabled log debug creating loader construct path loader url linked hash set linkedhashset url add unpacked directories unpacked unpacked length file file unpacked file exists file can read canread file file file get canonical path getcanonicalpath file separator url url file touri tourl log is debug enabled isdebugenabled log debug including directory url add url add packed directory jar files packed packed length file directory packed directory is directory isdirectory directory exists directory can read canread string file names filenames directory list file names filenames file names filenames length string filename file names filenames to lower case tolowercase locale english filename ends with endswith jar file file file directory file names filenames log is debug enabled isdebugenabled log debug including jar file file get absolute path getabsolutepath url url file touri tourl add url construct loader url array to array toarray url size access controller accesscontroller do privileged doprivileged privileged action privilegedaction url class loader urlclassloader override url class loader urlclassloader parent url class loader urlclassloader array url class loader urlclassloader array parent create loader based configuration defaults directory paths param repositories list directories jar files jar directories urls repositories loader param parent parent loader loader code code system loader exception exception error occurs constructing loader class loader classloader create class loader createclassloader list repository repositories class loader classloader parent exception log is debug enabled isdebugenabled log debug creating loader construct path loader url linked hash set linkedhashset url repositories repository repository repositories repository get type gettype repository type repositorytype url url url build class loader url buildclassloaderurl repository get location getlocation log is debug enabled isdebugenabled log debug including url url add url repository get type gettype repository type repositorytype dir file directory file repository get location getlocation directory directory get canonical file getcanonicalfile validate file validatefile directory repository type repositorytype dir url url build class loader url buildclassloaderurl directory log is debug enabled isdebugenabled log debug including directory url add url repository get type gettype repository type repositorytype jar file file file repository get location getlocation file file get canonical file getcanonicalfile validate file validatefile file repository type repositorytype jar url url build class loader url buildclassloaderurl file log is debug enabled isdebugenabled log debug including jar file url add url repository get type gettype repository type repositorytype glob file directory file repository get location getlocation directory directory get canonical file getcanonicalfile validate file validatefile directory repository type repositorytype glob log is debug enabled isdebugenabled log debug including directory glob directory get absolute path getabsolutepath string file names filenames directory list file names filenames file names filenames length string filename file names filenames to lower case tolowercase locale english filename ends with endswith jar file file file directory file names filenames file file get canonical file getcanonicalfile validate file validatefile file repository type repositorytype jar log is debug enabled isdebugenabled log debug including glob jar file file get absolute path getabsolutepath url url build class loader url buildclassloaderurl file add url construct loader url array to array toarray url size log is debug enabled isdebugenabled array length log debug location array access controller accesscontroller do privileged doprivileged privileged action privilegedaction url class loader urlclassloader override url class loader urlclassloader parent url class loader urlclassloader array url class loader urlclassloader array parent validate file validatefile file file repository type repositorytype type i o exception ioexception repository type repositorytype dir type repository type repositorytype glob type file exists file is directory isdirectory file can read canread string msg problem directory file exists file exists is directory isdirectory file is directory isdirectory can read canread file can read canread file file bootstrap get catalina home getcatalinahome get canonical file getcanonicalfile file base file bootstrap get catalina base getcatalinabase base base get canonical file getcanonicalfile file default value defaultvalue file base lib catalina base directory absent get path getpath equals base get path getpath file get path getpath equals default value defaultvalue get path getpath file exists log debug msg log warn msg repository type repositorytype jar type file exists file can read canread log warn problem jar file file exists file exists can read canread file can read canread methods ide ally ideally utility org apache tomcat util buf uri util uriutil visible load ers loaders constructed url build class loader url buildclassloaderurl string url string urlstring malformedurlexception url s urls passed load ers loaders point directories jar s jars url s urls construct url s urls resources jar url ensure sequence loader url string result url string urlstring replace all replaceall url result url build class loader url buildclassloaderurl file file malformedurlexception directory file string file url string fileurlstring file touri to string tostring file url string fileurlstring file url string fileurlstring replace all replaceall url file url string fileurlstring enum repository type repositorytype dir glob jar url repository string location repository type repositorytype type repository string location repository type repositorytype type location location type type string get location getlocation location repository type repositorytype get type gettype type
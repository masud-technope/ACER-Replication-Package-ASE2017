licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache catalina connector java buffered reader bufferedreader java i o exception ioexception java input stream inputstream java input stream reader inputstreamreader java output stream writer outputstreamwriter java print writer printwriter java net httpurlconnection java net url java util array list arraylist java util enumeration java util list java util locale java util tree map treemap javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue org junit fail org junit org junit before class beforeclass org junit test org apache catalina context org apache catalina authenticator basic authenticator basicauthenticator org apache catalina deploy filter def filterdef org apache catalina deploy filter map filtermap org apache catalina deploy login config loginconfig org apache catalina filters failed request filter failedrequestfilter org apache catalina startup simple http client simplehttpclient org apache catalina startup test tomcat testtomcat map realm maprealm org apache catalina startup tomcat org apache catalina startup tomcat base test tomcatbasetest org apache tomcat unit test unittest tester request testerrequest org apache tomcat util buf byte chunk bytechunk test link request test request testrequest tomcat base test tomcatbasetest before class beforeclass setup tests static ally statically system set property setproperty org apache tomcat util buf u decoder udecoder encoded slash test https apache org bug zilla bugzilla bug cgi post parameters returned call link http servlet request httpservletrequest getparameterxxx methods request chunked test test bug testbug bug client client bug client edge cases unlimited client do request dorequest assert true asserttrue client is response isresponse assert true asserttrue client is response body k isresponsebodyok client reset bytes small fail client do request dorequest assert true asserttrue client is response isresponse client reset small fail client do request dorequest assert true asserttrue client is response isresponse client reset edge cases actual content length client reset small fail client do request dorequest assert true asserttrue client is response isresponse client reset pass client do request dorequest assert true asserttrue client is response isresponse assert true asserttrue client is response body k isresponsebodyok client reset extra pass client do request dorequest assert true asserttrue client is response isresponse assert true asserttrue client is response body k isresponsebodyok larger client reset plenty space pass client do request dorequest assert true asserttrue client is response isresponse assert true asserttrue client is response body k isresponsebodyok check ins ensitivity insensitivity client reset plenty space pass client do request dorequest assert true asserttrue client is response isresponse assert true asserttrue client is response body k isresponsebodyok additional test failed requests handling failed request filter failedrequestfilter defined test test bug testbug without filter withoutfilter bug client client bug client edge cases actual content length client reset small fail client do request dorequest response code parameters list empty assert true asserttrue client is response isresponse assert equals assertequals client get response body getresponsebody bug servlet http servlet httpservlet serialversionuid int erested interested parameters values post requests override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception echo parameters values plain text resp set content type setcontenttype text plain print writer printwriter resp get writer getwriter assume attribute enumeration string names req get parameter names getparameternames names has more elements hasmoreelements string names next element nextelement println req get parameter getparameter bug test client bug client simple http client simplehttpclient create filter createfilter init bug client create filter createfilter create filter createfilter create filter createfilter init exception init tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext tomcat add servlet addservlet root bug bug servlet root add servlet mapping addservletmapping test bug create filter createfilter filter def filterdef failed request filter failedrequestfilter filter def filterdef failed request filter failedrequestfilter set filter name setfiltername failed request filter failedrequestfilter failed request filter failedrequestfilter set filter class setfilterclass failed request filter failedrequestfilter get name getname filter map filtermap failed request filter map failedrequestfiltermap filter map filtermap failed request filter map failedrequestfiltermap set filter name setfiltername failed request filter failedrequestfilter failed request filter map failedrequestfiltermap addurlpattern root add filter def addfilterdef failed request filter failedrequestfilter root add filter map addfiltermap failed request filter map failedrequestfiltermap tomcat start set port setport tomcat get connector getconnector get local port getlocalport init exception do request dorequest post limit postlimit uc chunked head ucchunkedhead tomcat tomcat get tomcat instance gettomcatinstance init tomcat get connector getconnector set max post size setmaxpostsize post limit postlimit open connection connect send request parts string request string uc chunked head ucchunkedhead request post http localhost test http crlf content type application form url encoded urlencoded crlf transfer encoding chunked crlf connection close crlf crlf crlf crlf request post http localhost test http crlf content type application form url encoded urlencoded crlf transfer encoding chunked crlf connection close crlf crlf crlf crlf request crlf crlf crlf crlf set request setrequest request blocks response read process request processrequest close connection disconnect exception override is response body k isresponsebodyok get response body getresponsebody get response body getresponsebody get response body getresponsebody test href https apache org bug zilla bugzilla bug cgi bug test test bug testbug exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext add servlet tomcat add servlet addservlet ctx servlet echo query string servlet echoquerystringservlet ctx add servlet mapping addservletmapping servlet tomcat start query string byte chunk bytechunk res get url geturl http localhost get port getport assert equals assertequals query string querystring res to string tostring query string res get url geturl http localhost get port getport assert equals assertequals query string querystring res to string tostring empty string res get url geturl http localhost get port getport assert equals assertequals query string querystring res to string tostring echo query string servlet echoquerystringservlet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception resp set content type setcontenttype text plain print writer printwriter resp get writer getwriter print query string querystring req get query string getquerystring test link request login string string link request log out logout test test login log out testloginlogout exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext login config loginconfig config login config loginconfig config set auth method setauthmethod basic ctx set login config setloginconfig config ctx get pipeline getpipeline add valve addvalve basic authenticator basicauthenticator tomcat add servlet addservlet ctx servlet login log out servlet loginlogoutservlet ctx add servlet mapping addservletmapping servlet map realm maprealm realm map realm maprealm realm add user adduser login log out servlet loginlogoutservlet user login log out servlet loginlogoutservlet pwd ctx set realm setrealm realm tomcat start byte chunk bytechunk res get url geturl http localhost get port getport assert equals assertequals login log out servlet loginlogoutservlet res to string tostring login log out servlet loginlogoutservlet http servlet httpservlet serialversionuid string user user string pwd pwd string override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception req login user pwd req get remote user getremoteuser equals user servlet exception servletexception req get user principal getuserprincipal get name getname equals user servlet exception servletexception req log out logout req get remote user getremoteuser servlet exception servletexception req get user principal getuserprincipal servlet exception servletexception resp get writer getwriter write test test bug testbug no chunking nochunking exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext tomcat add servlet addservlet root bug bug servlet root add servlet mapping addservletmapping bug tomcat start httpurlconnection conn get connection getconnection http localhost get port getport input stream inputstream conn get input stream getinputstream assert not null assertnotnull test test bug testbug with chunking withchunking exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext tomcat add servlet addservlet root bug bug servlet root add servlet mapping addservletmapping bug tomcat start httpurlconnection conn get connection getconnection http localhost get port getport conn set chunked str eaming mode setchunkedstreamingmode input stream inputstream conn get input stream getinputstream assert not null assertnotnull test https apache org bug zilla bugzilla bug cgi requests fetch request parameters coming request body properly configured parse body method parsebodymethod setting test test bug testbug bug client client bug client works properly client do request dorequest foo bar assert true asserttrue response request client is response isresponse assert equals assertequals incorrect response request foo bar client get response body getresponsebody client reset post works properly post separate post parameters client do request dorequest post foo bar application form url encoded urlencoded bar baz assert true asserttrue response post request client is response isresponse assert equals assertequals incorrect response post request bar baz foo bar client get response body getresponsebody client reset post over lapping overlapping post parameters client do request dorequest post foo bar bar foo application form url encoded urlencoded bar baz foo baz assert true asserttrue response post request client is response isresponse assert equals assertequals incorrect response post request bar baz bar foo foo bar foo baz client get response body getresponsebody client reset post style parsing client do request dorequest foo bar bar foo application form url encoded urlencoded bar baz foo baz assert true asserttrue response nop arse noparse request client is response isresponse assert equals assertequals incorrect response request bar foo foo bar client get response body getresponsebody client reset post style parsing client do request dorequest foo bar bar foo application form url encoded urlencoded bar baz foo baz assert true asserttrue response request client is response isresponse assert equals assertequals incorrect response parse request bar baz bar foo foo bar foo baz client get response body getresponsebody client reset exception do request dorequest string method string query string querystring string content type contenttype string request body requestbody allow body allowbody test test bug testbug exception tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext root set allow casual multipart parsing setallowcasualmultipartparsing tomcat add servlet addservlet root bug bug servlet root add servlet mapping addservletmapping bug tomcat start httpurlconnection conn get connection getconnection http localhost get port getport parse parameters before parse parts parseparametersbeforeparseparts prepare request bug preparerequestbug conn check response bug checkresponsebug conn conn disconnect conn get connection getconnection http localhost get port getport prepare request bug preparerequestbug conn check response bug checkresponsebug conn conn disconnect echo parameters servlet echoparametersservlet http servlet httpservlet serialversionuid int erested interested parameters values requests note echos parameters alphabetical order override service http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception echo parameters values plain text resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf print writer printwriter resp get writer getwriter tree map treemap string string parameters tree map treemap string string req get parameter map getparametermap string parameters key set keyset string values req get parameter values getparametervalues java util arrays sort values values length print print values bug test client test allowing request bodies bug client simple http client simplehttpclient init init exception init tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context root tomcat add context addcontext tomcat add servlet addservlet root echo parameters echoparameters echo parameters servlet echoparametersservlet root add servlet mapping addservletmapping echo echo parameters echoparameters tomcat start set port setport tomcat get connector getconnector get local port getlocalport init exception do request dorequest string method string query string querystring string content type contenttype string request body requestbody allow body allowbody tomcat tomcat get tomcat instance gettomcatinstance init allow body allowbody tomcat get connector getconnector set parse body methods setparsebodymethods method parse tomcat get connector getconnector set parse body methods setparsebodymethods open connection connect encode request body bytes characters request body requestbody request body requestbody string request body requestbody get bytes getbytes utf ascii send request body method string request method http localhost get port getport echo query string querystring query string querystring http crlf host localhost crlf content type contenttype content type content type contenttype crlf connection close crlf request body requestbody content length request body requestbody length crlf crlf request body requestbody request body requestbody set request setrequest request blocks response read process request processrequest close connection disconnect exception override is response body k isresponsebodyok don care httpurlconnection get connection getconnection string query i o exception ioexception url posturl posturl url query httpurlconnection conn httpurlconnection posturl open connection openconnection conn set request method setrequestmethod post conn set d o input setdoinput conn set d o output setdooutput conn set use caches setusecaches conn set allow user int eraction setallowuserinteraction conn bug servlet http servlet httpservlet serialversionuid override do post dopost http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception req set character encoding setcharacterencoding utf req getrequesturi ends with endswith parse parameters before parse parts parseparametersbeforeparseparts req get parameter names getparameternames req get part getpart resp set content type setcontenttype text plain resp set character encoding setcharacterencoding utf resp get writer getwriter println req get parameter getparameter prepare request bug preparerequestbug httpurlconnection conn exception string boundary system current time millis currenttimemillis conn set request property setrequestproperty content type multipart form data boundary boundary print writer printwriter writer writer print writer printwriter output stream writer outputstreamwriter conn get output stream getoutputstream utf writer append boundary append writer append content disposition form data writer append content type text plain charset utf writer append writer append уду╢ append writer flush writer append writer flush writer append boundary append writer writer close check response bug checkresponsebug httpurlconnection conn exception list string response array list arraylist string status conn get response code getresponsecode status httpurlconnection http buffered reader bufferedreader reader reader buffered reader bufferedreader input stream reader inputstreamreader conn get input stream getinputstream utf string reader read line readline response add assert true asserttrue response уду╢ reader reader close fail status expected status test test bug testbug exception do bug dobug path path path test test bug testbug exception do bug dobug path path path test test bug testbug exception do bug dobug path path xxx path test test bug testbug exception do bug dobug test test bug testbug exception do bug dobug test test bug testbug exception do bug dobug xxx test test bug testbug exception do bug dobug path abc path abc path abc test test bug testbug exception do bug dobug path abc path abc path abc test test bug testbug exception do bug dobug path abc path abc xxx path abc test test bug testbug exception do bug dobug abc fth abc fth abc test test bug testbug exception do bug dobug abc fth abc fth abc test test bug testbug exception do bug dobug abc fth abc xxx fth abc test test bug testbug exception do bug dobug abc abc abc test test bug testbug exception do bug dobug abc abc abc test test bug testbug exception do bug dobug abc abc xxx abc test test bug testbug exception do bug dobug path abc path abc xxx path abc test test bug testbug exception do bug dobug path abc path abc xxx path abc test test bug testbug exception do bug dobug path abc path abc xxx path abc test test bug testbug exception do bug dobug path abc path abc xxx path abc test test bug testbug exception do bug dobug path path path test test bug testbug exception do bug dobug path path path test test bug testbug exception do bug dobug path fpath fpath test test bug testbug exception do bug dobug path fpath fpath test test bug testbug exception do bug dobug path foo path foo path test test bug testbug exception do bug dobug path foo fpath foo fpath do bug dobug string deploy path deploypath string request path requestpath string expected exception setup tomcat instance tomcat tomcat get tomcat instance gettomcatinstance file system doc base docbase required context ctx tomcat add context addcontext deploy path deploypath tomcat add servlet addservlet ctx servlet bug servelet ctx add servlet mapping addservletmapping servlet tomcat start byte chunk bytechunk res get url geturl http localhost get port getport request path requestpath string result path resultpath res to string tostring result path resultpath result path resultpath assert equals assertequals expected result path resultpath bug servelet http servlet httpservlet serialversionuid override do get doget http servlet request httpservletrequest req http servlet response httpservletresponse resp servlet exception servletexception i o exception ioexception resp set content type setcontenttype text plain resp get writer getwriter print req get context path getcontextpath test get locale multiple headers getlocalemultipleheaders exception tester request testerrequest req tester request testerrequest req add header addheader accept language req add header addheader accept language locale actual req get locale getlocale locale expected locale assert equals assertequals expected actual reverse header order get locale multiple headers getlocalemultipleheaders result test get locale multiple headers getlocalemultipleheaders exception tester request testerrequest req tester request testerrequest req add header addheader accept language req add header addheader accept language locale actual req get locale getlocale locale expected locale assert equals assertequals expected actual
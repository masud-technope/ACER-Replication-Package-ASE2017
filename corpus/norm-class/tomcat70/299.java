licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util http file upload fileupload disk java buffered input stream bufferedinputstream java buffered output stream bufferedoutputstream java byte array input stream bytearrayinputstream java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java input stream inputstream java output stream outputstream java unsupported encoding exception unsupportedencodingexception java util map java util uuid java util concurrent atomic atomic integer atomicinteger org apache tomcat util http file upload fileupload deferred file output stream deferredfileoutputstream org apache tomcat util http file upload fileupload file item fileitem org apache tomcat util http file upload fileupload file item headers fileitemheaders org apache tomcat util http file upload fileupload file upload exception fileuploadexception org apache tomcat util http file upload fileupload io utils ioutils org apache tomcat util http file upload fileupload parameter parser parameterparser org apache tomcat util http file upload fileupload util streams implementation link org apache tomcat util http file upload fileupload file item fileitem file item fileitem retrieving instance link org apache tomcat util http file upload fileupload file upload fileupload file upload fileupload instance link org apache tomcat util http file upload fileupload file upload fileupload parse request parserequest org apache tomcat util http file upload fileupload request context requestcontext request contents file link request link java input stream inputstream input stream inputstream link get input stream getinputstream process file attempting load memory handy large files temporary files created file items deleted file upload fileupload disk file item diskfileitem file item fileitem manifest constants content charset explicit charset parameter sender media subtypes text type defined charset iso received http string charset iso data members uid unique file generation string uid uuid randomuuid to string tostring replace counter unique identifier generation atomic integer atomicinteger counter atomic integer atomicinteger form field browser string field name fieldname content type passed browser code code defined string content type contenttype item simple form field is form field isformfield original filename user file system filesystem string file name filename size item bytes cache size file item moved original location size threshold uploads stored disk size threshold sizethreshold directory uploaded files stored stored disk file repository cached contents file cached content cachedcontent output stream item deferred file output stream deferredfileoutputstream dfos temporary file file temp file tempfile file items headers file item headers fileitemheaders headers constructs code disk file item diskfileitem code instance param field name fieldname form field param content type contenttype content type passed browser code code param is form field isformfield item plain form field opposed file upload param file name filename original filename user file system filesystem code code param size threshold sizethreshold threshold bytes items retained memory stored file param repository data repository directory files created item size exc eed exceed threshold disk file item diskfileitem string field name fieldname string content type contenttype is form field isformfield string file name filename size threshold sizethreshold file repository field name fieldname field name fieldname content type contenttype content type contenttype is form field isformfield is form field isformfield file name filename file name filename size threshold sizethreshold size threshold sizethreshold repository repository methods javax activation data source datasource returns link java input stream inputstream input stream inputstream retrieve contents file link java input stream inputstream input stream inputstream retrieve contents file io exception ioexception error occurs override input stream inputstream get input stream getinputstream io exception ioexception is in memory isinmemory file input stream fileinputstream dfos get file getfile cached content cachedcontent cached content cachedcontent dfos get data getdata byte array input stream bytearrayinputstream cached content cachedcontent returns content type passed agent code code defined content type passed agent code code defined override string get content type getcontenttype content type contenttype returns content charset passed agent code code defined content charset passed agent code code defined string get char set getcharset parameter parser parameterparser parser parameter parser parameterparser parser set lower case names setlowercasenames parameter parser handle input map string string params parser parse get content type getcontenttype params charset returns original filename client file system filesystem original filename client file system filesystem org apache tomcat util http file upload fileupload invalid file name exception invalidfilenameexception file nul character indicator security att ack attack int end intend file exception link org apache tomcat util http file upload fileupload invalid file name exception invalidfilenameexception get name getname override string get name getname streams check file name checkfilename file name filename file item fileitem methods hint file contents read memory code code file contents read memory code code override is in memory isinmemory cached content cachedcontent dfos is in memory isinmemory returns size file size file bytes override get size getsize size size cached content cachedcontent cached content cachedcontent length dfos is in memory isinmemory dfos get data getdata length dfos get file getfile length returns contents file array bytes contents file cached memory loaded disk storage cached contents file array bytes code data read override is in memory isinmemory cached content cachedcontent dfos cached content cachedcontent dfos get data getdata cached content cachedcontent file data filedata get size getsize input stream inputstream fis fis file input stream fileinputstream dfos get file getfile io utils ioutils read fully readfully fis file data filedata io exception ioexception file data filedata io utils ioutils close quietly closequietly fis file data filedata returns contents file string encoding method link retrieve contents file param charset charset contents file string unsupported encoding exception unsupportedencodingexception requested character encoding override string get string getstring string charset unsupported encoding exception unsupportedencodingexception string charset returns contents file string character encoding method link retrieve contents file todo making method unsupported encoding exception unsupportedencodingexception contents file string override string get string getstring raw data rawdata string charset get char set getcharset charset charset charset string raw data rawdata charset unsupported encoding exception unsupportedencodingexception string raw data rawdata convenience method write uploaded item disk client code concerned item stored memory disk temporary location write uploaded item file implementation attempts rename uploaded item destination file item originally written disk data copied file method guaranteed work time invoked item event method renames temporary file file longer copy rename time param file code file code uploaded item stored exception error occurs override write file file exception is in memory isinmemory file output stream fileoutputstream fout fout file output stream fileoutputstream file fout write fout close io utils ioutils close quietly closequietly fout file output file outputfile get store location getstorelocation output file outputfile save length file size output file outputfile length uploaded file stored disk temporary location move desired file output file outputfile rename to renameto file buffered input stream bufferedinputstream buffered output stream bufferedoutputstream buffered input stream bufferedinputstream file input stream fileinputstream output file outputfile buffered output stream bufferedoutputstream file output stream fileoutputstream file io utils ioutils copy close io utils ioutils close quietly closequietly io utils ioutils close quietly closequietly reason write file disk file upload exception fileuploadexception write uploaded file disk deletes underlying storage file item including deleting temporary disk file storage deleted automatically code file item fileitem code instance garbage collected method ensure earlier time preserving system resources override delete cached content cachedcontent file output file outputfile get store location getstorelocation output file outputfile output file outputfile exists output file outputfile delete returns field multipart form file item form field set field name setfieldname java lang string override string get field name getfieldname field name fieldname sets field reference file item param field name fieldname form field get field name getfieldname override set field name setfieldname string field name fieldname field name fieldname field name fieldname determines code file item fileitem code instance represents simple form field code code instance represents simple form field code code represents uploaded file set form field setformfield override is form field isformfield is form field isformfield specifies code file item fileitem code instance represents simple form field param code code instance represents simple form field code code represents uploaded file is form field isformfield override set form field setformfield is form field isformfield returns link java output stream outputstream output stream outputstream storing contents file link java output stream outputstream output stream outputstream storing contents file io exception ioexception error occurs override output stream outputstream get output stream getoutputstream io exception ioexception dfos file output file outputfile get temp file gettempfile dfos deferred file output stream deferredfileoutputstream size threshold sizethreshold output file outputfile dfos methods returns link java file object code file item fileitem code data temporary location disk note code file item fileitem code data stored memory method code code handling large files link java file rename to renameto java file move file location copying data source destination locations reside logical vol ume volume data file code code data stored memory file get store location getstorelocation dfos is in memory isinmemory dfos get file getfile methods removes file contents temporary storage override finalize dfos file output file outputfile dfos get file getfile output file outputfile output file outputfile exists output file outputfile delete creates returns link java file file representing uniquely named temporary file configured repository path lifetime file tied lifetime code file item fileitem code instance file deleted instance garbage collected note subclasses override method ensure file time link java file file temporary storage file get temp file gettempfile temp file tempfile file temp dir tempdir repository temp dir tempdir temp dir tempdir file system get property getproperty java tmp dir tmpdir string temp file name tempfilename string format upload tmp uid get unique id getuniqueid temp file tempfile file temp dir tempdir temp file name tempfilename temp file tempfile methods returns identifier unique loader load random app earance appearance string random instance identifier string get unique id getuniqueid limit current counter get and increment getandincrement string integer to string tostring current start ids longer characters current limit substring length returns string representation object string representation object override string to string tostring string format store location storelocation size bytes is form field isformfield field name fieldname get name getname get store location getstorelocation value of valueof get size getsize value of valueof is form field isformfield get field name getfieldname returns file item headers file items headers override file item headers fileitemheaders get headers getheaders headers sets file item headers param p headers pheaders file items headers override set headers setheaders file item headers fileitemheaders p headers pheaders headers p headers pheaders
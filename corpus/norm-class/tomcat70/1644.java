licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache tomcat util net java eof exception eofexception java io exception ioexception java net socket timeout exception sockettimeoutexception java nio byte buffer bytebuffer java nio channels cancelled key exception cancelledkeyexception java nio channels closed channel exception closedchannelexception java nio channels selection key selectionkey java nio channels selector java nio channels socket channel socketchannel java util iterator java util queue java util concurrent concurrent linked queue concurrentlinkedqueue java util concurrent count down latch countdownlatch java util concurrent time unit timeunit java util concurrent atomic atomic integer atomicinteger org apache juli logging log org apache juli logging log factory logfactory org apache tomcat util exception utils exceptionutils org apache tomcat util net nio endpoint nioendpoint key attachment keyattachment nio blocking selector nioblockingselector log log log factory logfactory get log getlog nio blocking selector nioblockingselector thread counter threadcounter queue key reference keyreference key reference queue keyreferencequeue concurrent linked queue concurrentlinkedqueue key reference keyreference selector shared selector sharedselector block poller blockpoller poller nio blocking selector nioblockingselector open selector selector shared selector sharedselector selector poller block poller blockpoller poller selector shared selector sharedselector poller set daemon setdaemon poller set name setname nio blocking selector nioblockingselector block poller blockpoller thread counter threadcounter poller start close poller poller disable poller int errupt interrupt poller performs blocking write byte buffer bytebuffer data written code selector code parameter perform busy write lot cpu cycles param buf byte buffer bytebuffer buffer data write code buf has remaining hasremaining code param socket socket channel socketchannel socket write data param write timeout writetimeout timeout write operation milliseconds timeout returns number bytes written eof exception eofexception write returns socket timeout exception sockettimeoutexception write times io exception ioexception exception occurs underlying socket logic write byte buffer bytebuffer buf nio channel niochannel socket write timeout writetimeout io exception ioexception selection key selectionkey key socket getiochannel key for keyfor socket get poller getpoller get selector getselector key io exception ioexception key longer registered key reference keyreference reference key reference queue keyreferencequeue poll reference reference key reference keyreference key attachment keyattachment att key attachment keyattachment key attachment written timedout assume write key count keycount start timeout timer time system current time millis currenttimemillis timedout buf has remaining hasremaining key count keycount write registered write write data cnt socket write buf cnt eof exception eofexception written cnt cnt reset timeout timer time system current time millis currenttimemillis wrote selector att get write latch getwritelatch att get write latch getwritelatch get count getcount att start write latch startwritelatch poller add att selection key selectionkey write reference write timeout writetimeout att await write latch awaitwritelatch max time unit timeunit milliseconds att await write latch awaitwritelatch write timeout writetimeout time unit timeunit milliseconds interrupted exception interruptedexception ignore thread int errupted interrupted att get write latch getwritelatch att get write latch getwritelatch get count getcount int errupted interrupted have n haven received not ification notification poller key count keycount latch count down countdown happened key count keycount att reset write latch resetwritelatch write timeout writetimeout key count keycount timedout system current time millis currenttimemillis time write timeout writetimeout timedout socket timeout exception sockettimeoutexception poller remove att selection key selectionkey write timedout reference key poller cancel key cancelkey reference key reference key key reference queue keyreferencequeue add reference written performs blocking read byte buffer bytebuffer data read code selector code parameter perform busy read lot cpu cycles param buf byte buffer bytebuffer buffer data read read time d timed param socket socket channel socketchannel socket write data param read timeout readtimeout timeout read operation milliseconds timeout returns number bytes read eof exception eofexception read returns socket timeout exception sockettimeoutexception read times io exception ioexception exception occurs underlying socket logic read byte buffer bytebuffer buf nio channel niochannel socket read timeout readtimeout io exception ioexception selection key selectionkey key socket getiochannel key for keyfor socket get poller getpoller get selector getselector key io exception ioexception key longer registered key reference keyreference reference key reference queue keyreferencequeue poll reference reference key reference keyreference key attachment keyattachment att key attachment keyattachment key attachment read timedout assume read key count keycount start timeout timer time system current time millis currenttimemillis timedout key count keycount read registered read read socket read buf read eof exception eofexception read att get read latch getreadlatch att get read latch getreadlatch get count getcount att start read latch startreadlatch poller add att selection key selectionkey read reference read timeout readtimeout att await read latch awaitreadlatch max time unit timeunit milliseconds att await read latch awaitreadlatch read timeout readtimeout time unit timeunit milliseconds interrupted exception interruptedexception ignore thread int errupted interrupted att get read latch getreadlatch att get read latch getreadlatch get count getcount int errupted interrupted have n haven received not ification notification poller key count keycount latch count down countdown happened key count keycount att reset read latch resetreadlatch read timeout readtimeout key count keycount timedout system current time millis currenttimemillis time read timeout readtimeout timedout socket timeout exception sockettimeoutexception poller remove att selection key selectionkey read timedout reference key poller cancel key cancelkey reference key reference key key reference queue keyreferencequeue add reference read block poller blockpoller thread selector selector concurrent linked queue concurrentlinkedqueue runnable events concurrent linked queue concurrentlinkedqueue runnable disable selector wakeup atomic integer atomicinteger wakeup counter wakeupcounter atomic integer atomicinteger cancel key cancelkey selection key selectionkey key runnable runnable override key cancel events offer wakeup wakeup wakeup counter wakeupcounter add and get addandget selector wakeup cancel selection key selectionkey key attachment keyattachment key ops cancel attach selection key selectionkey write ops selection key selectionkey write count down countdown key get write latch getwritelatch selection key selectionkey read ops selection key selectionkey read count down countdown key get read latch getreadlatch add key attachment keyattachment key ops key reference keyreference runnable runnable override key nio channel niochannel nch key get channel getchannel nch socket channel socketchannel nch getiochannel selection key selectionkey key for keyfor selector register selector ops key key is valid isvalid cancel key ops int erest ops interestops int erest ops interestops ops cancelled key exception cancelledkeyexception cancel key ops closed channel exception closedchannelexception cancel key ops events offer wakeup remove key attachment keyattachment key ops runnable runnable override key nio channel niochannel nch key get channel getchannel nch socket channel socketchannel nch getiochannel selection key selectionkey key for keyfor selector selection key selectionkey write ops selection key selectionkey write count down countdown key get write latch getwritelatch selection key selectionkey read ops selection key selectionkey read count down countdown key get read latch getreadlatch is valid isvalid int erest ops interestops int erest ops interestops ops selection key selectionkey write ops selection key selectionkey write count down countdown key get write latch getwritelatch selection key selectionkey read ops selection key selectionkey read count down countdown key get read latch getreadlatch int erest ops interestops cancel attach cancel attach cancelled key exception cancelledkeyexception cancel attach events offer wakeup events result runnable result events size events poll result result override events key count keycount wakeup counter wakeupcounter key count keycount selector select now selectnow wakeup counter wakeupcounter key count keycount selector select wakeup counter wakeupcounter null pointer exception nullpointerexception selector log is debug enabled isdebugenabled log debug encountered sun bug windows jdk cancelled key exception cancelledkeyexception log is debug enabled isdebugenabled log debug encountered sun bug windows jdk throwable exception utils exceptionutils handle throwable handlethrowable log error iterator selection key selectionkey iterator key count keycount selector selected keys selectedkeys iterator active event iterator iterator has next hasnext selection key selectionkey iterator key attachment keyattachment attachment key attachment keyattachment attachment attachment access iterator remove int erest ops interestops int erest ops interestops ready ops readyops is readable isreadable count down countdown attachment get read latch getreadlatch is writable iswritable count down countdown attachment get write latch getwritelatch cancelled key exception cancelledkeyexception ckx cancel count down countdown attachment get read latch getreadlatch count down countdown attachment get write latch getwritelatch throwable log error events clear cancel remaining selector select now selectnow exception ignore log is debug enabled isdebugenabled log debug ignore close connector selector close exception ignore log is debug enabled isdebugenabled log debug ignore count down countdown count down latch countdownlatch latch latch latch count down countdown key reference keyreference selection key selectionkey key override finalize throwable key key is valid isvalid log warn key leak can celling cancelling key finalize r finalizer key cancel exception ignore key finalize
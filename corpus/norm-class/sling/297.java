licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling resource access security resourceaccesssecurity impl java util hash set hashset java util java util regex matcher java util regex pattern org apache sling commons osgi properties util propertiesutil org apache sling resource access security resourceaccesssecurity resource access gate resourceaccessgate org osgi framework service reference servicereference resource access gate handler resourceaccessgatehandler comparable resource access gate handler resourceaccessgatehandler resource access gate resourceaccessgate resource access gate resourceaccessgate service reference servicereference reference pattern path pattern pathpattern resource access gate resourceaccessgate operation operations hash set hashset resource access gate resourceaccessgate operation resource access gate resourceaccessgate operation final operations finaloperations hash set hashset resource access gate resourceaccessgate operation constructor resource access gate handler resourceaccessgatehandler service reference servicereference resource access gate ref resourceaccessgateref reference resource access gate ref resourceaccessgateref resource access gate resourceaccessgate resource access gate resourceaccessgate resource access gate ref resourceaccessgateref get bundle getbundle get bundle context getbundlecontext get service getservice resource access gate ref resourceaccessgateref extract service property path string path string resource access gate ref resourceaccessgateref get property getproperty resource access gate resourceaccessgate path path path pattern pathpattern pattern compile path path pattern pathpattern pattern compile extract service property operations string ops properties util propertiesutil to string tostring resource access gate ref resourceaccessgateref get property getproperty resource access gate resourceaccessgate operations ops ops length string ops array opsarray ops split string op as string opasstring ops array opsarray resource access gate resourceaccessgate operation operation resource access gate resourceaccessgate operation from string fromstring op as string opasstring operation operations add operation resource access gate resourceaccessgate operation resource access gate resourceaccessgate operation values operations add extract service property final operations finaloperations string final ops finalops properties util propertiesutil to string tostring resource access gate ref resourceaccessgateref get property getproperty resource access gate resourceaccessgate final operations finaloperations final ops finalops final ops finalops length string fin ops array finopsarray final ops finalops split string op as string opasstring fin ops array finopsarray resource access gate resourceaccessgate operation operation resource access gate resourceaccessgate operation from string fromstring op as string opasstring operation final operations finaloperations add operation matches string path resource access gate resourceaccessgate operation operation return value returnvalue operations operation path matcher match path pattern pathpattern matcher path return value returnvalue match matches security reason return value returnvalue is final operation isfinaloperation resource access gate resourceaccessgate operation operation final operations finaloperations operation resource access gate resourceaccessgate get resource access gate getresourceaccessgate resource access gate resourceaccessgate override compare to compareto resource access gate handler resourceaccessgatehandler services higher service ranking list reference compare to compareto reference override equals object obj obj resource access gate handler resourceaccessgatehandler resource access gate handler resourceaccessgatehandler obj reference equals reference override hash code hashcode reference hash code hashcode
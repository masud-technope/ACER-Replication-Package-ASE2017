licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl compiler optimization reduce java util collection java util map org apache sling scripting sightly impl compiler expression expression node expressionnode org apache sling scripting sightly impl compiler optimization stream transformer streamtransformer org apache sling scripting sightly impl compiler ris command org apache sling scripting sightly impl compiler ris command stream commandstream org apache sling scripting sightly impl compiler ris command variable binding variablebinding org apache sling scripting sightly impl compiler util stream emitter visitor emittervisitor org apache sling scripting sightly impl compiler util stream push stream pushstream org apache sling scripting sightly impl compiler util stream streams org apache sling scripting sightly impl compiler visitor tracking visitor trackingvisitor optimization eval uates evaluates constant expressions compilation time constant folding constantfolding tracking visitor trackingvisitor eval result evalresult emitter visitor emittervisitor push stream pushstream out stream outstream push stream pushstream constant folding constantfolding stream transformer streamtransformer transformer stream transformer streamtransformer override command stream commandstream transform command stream commandstream in stream instream streams map in stream instream constant folding constantfolding override visit variable binding variablebinding start variable binding start variablebindingstart string variable variable binding start variablebindingstart get variable name getvariablename expression node expressionnode node variable binding start variablebindingstart get expression getexpression eval result evalresult result expression reduce r expressionreducer reduce node tracker result avoid folding data structures avoidfoldingdatastructures result tracker push variable pushvariable variable result out stream outstream emit variable binding variablebinding start variable result get node getnode eval result evalresult avoid folding data structures avoidfoldingdatastructures eval result evalresult eval result evalresult time eval result evalresult is constant isconstant is data structure isdatastructure eval result evalresult get value getvalue eval result evalresult non constant nonconstant eval result evalresult get node getnode eval result evalresult is data structure isdatastructure object obj obj collection obj map override eval result evalresult assign default assigndefault command command override on command oncommand command command out stream outstream emit command override push stream pushstream get output stream getoutputstream out stream outstream
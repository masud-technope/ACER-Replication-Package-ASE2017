licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling sample sling shot slingshot impl java io exception ioexception java security principal java util dictionary java util hash map hashmap java util hashtable java util map javax jcr repository exception repositoryexception javax jcr session javax jcr security privilege org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations reference org apache jackrabbit api security principal principal manager principalmanager org apache jackrabbit api security user authorizable org apache jackrabbit api security user user manager usermanager org apache sling api resource login exception loginexception org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling jcr base util access control util accesscontrolutil org apache sling sample sling shot slingshot sling shot constants slingshotconstants org osgi framework bundle context bundlecontext org osgi framework invalid syntax exception invalidsyntaxexception org osgi service configuration org osgi service configuration admin configurationadmin org slf logger org slf logger factory loggerfactory setup service sets difference component setup service setupservice logger logger logger factory loggerfactory get logger getlogger get class getclass reference resource resolver factory resourceresolverfactory factory reference configuration admin configurationadmin config admin configadmin string use rs users string sling shot slingshot sling shot slingshot string folders string content sling shot constants slingshotconstants resource type resourcetype content info profile ugc activate activate bundle context bundlecontext io exception ioexception login exception loginexception persistence exception persistenceexception repository exception repositoryexception logger info setting sling shot slingshot resource resolver resourceresolver resolver resolver factory get administrative resource resolver getadministrativeresourceresolver setup use rs setupusers resolver setup content setupcontent resolver setupacl resolver resolver resolver close logger info finished setting sling shot slingshot setupacl resource resolver resourceresolver resolver repository exception repositoryexception session session resolver adapt to adaptto session create sling shot slingshot users string principal id principalid use rs users user string resource path resourcepath sling shot constants slingshotconstants app root path users principal id principalid modify ace modifyace session resource path resourcepath principal id principalid privilege jcr ugc path string ugc path ugcpath resource path resourcepath ugc modify ace modifyace session ugc path ugcpath internal constants internalconstants service user privilege jcr modify ace modifyace session jcr session jcrsession string resource path resourcepath string principal id principalid string privilege granted repository exception repositoryexception principal manager principalmanager principal manager principalmanager access control util accesscontrolutil get principal manager getprincipalmanager jcr session jcrsession principal principal principal manager principalmanager get principal getprincipal principal id principalid string granted privilege names grantedprivilegenames string denied privilege names deniedprivilegenames granted granted privilege names grantedprivilegenames string privilege denied privilege names deniedprivilegenames granted privilege names grantedprivilegenames denied privilege names deniedprivilegenames string privilege access control util accesscontrolutil replace access control entry replaceaccesscontrolentry jcr session jcrsession resource path resourcepath principal granted privilege names grantedprivilegenames denied privilege names deniedprivilegenames jcr session jcrsession has pending changes haspendingchanges jcr session jcrsession save setup use rs setupusers bundle context bundlecontext resource resolver resourceresolver resolver repository exception repositoryexception io exception ioexception user manager usermanager access control util accesscontrolutil get user manager getusermanager resolver adapt to adaptto session string user name username use rs users authorizable user get authorizable getauthorizable user name username user logger info creating user user name username create user createuser user name username user name username create service user authorizable user get authorizable getauthorizable internal constants internalconstants service user user logger info creating user internal constants internalconstants service user todo jackrabbit support creating system user create system user createsystemuser internal constants internalconstants service user create user createuser internal constants internalconstants service user internal constants internalconstants service user check service user config exists configuration configs config admin configadmin list configurations listconfigurations configuration admin configurationadmin service factory pid factorypid org apache sling service user mapping serviceusermapping impl service user mapper impl serviceusermapperimpl amended user mapping get bundle getbundle get symbolic name getsymbolicname configs configs length exists invalid syntax exception invalidsyntaxexception exists exists logger info creating service user mapping configuration config admin configadmin create factory configuration createfactoryconfiguration org apache sling service user mapping serviceusermapping impl service user mapper impl serviceusermapperimpl amended dictionary string object dict hashtable string object dict user mapping get bundle getbundle get symbolic name getsymbolicname internal constants internalconstants service user update dict setup content setupcontent resource resolver resourceresolver resolver persistence exception persistenceexception resource root resolver get resource getresource sling shot constants slingshotconstants app root path root resource type root folder root is resource type isresourcetype internal constants internalconstants resource type resourcetype modifiable value map modifiablevaluemap mvm root adapt to adaptto modifiable value map modifiablevaluemap mvm resource resolver resourceresolver property resource type internal constants internalconstants resource type resourcetype resolver commit resource users resource usersresource root get child getchild users string user name username use rs users resource home resource homeresource resolver get resource getresource users resource usersresource user name username home resource homeresource map string object props hash map hashmap string object props resource resolver resourceresolver property resource type sling shot constants slingshotconstants resource type resourcetype user home resource homeresource resolver create users resource usersresource user name username props resolver commit string def folders def index of indexof string string def sling ordered folder orderedfolder def substring def substring resource rsrc resolver get resource getresource home resource homeresource rsrc map string object props hash map hashmap string object props resource resolver resourceresolver property resource type resolver create home resource homeresource props resolver commit
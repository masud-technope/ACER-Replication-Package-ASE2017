licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl compiler visitor java util hash set hashset java util java util stack org apache sling scripting sightly impl compiled expression translator expressiontranslator org apache sling scripting sightly impl compiled java source javasource org apache sling scripting sightly impl compiled source gen constants sourcegenconstants org apache sling scripting sightly impl compiled type org apache sling scripting sightly impl compiled type inference typeinference org apache sling scripting sightly impl compiled type info typeinfo org apache sling scripting sightly impl compiled unit builder unitbuilder org apache sling scripting sightly impl compiled variable analyzer variableanalyzer org apache sling scripting sightly impl compiled variable descriptor variabledescriptor org apache sling scripting sightly impl compiler ris command visitor commandvisitor org apache sling scripting sightly impl compiler ris command conditional org apache sling scripting sightly impl compiler ris command loop org apache sling scripting sightly impl compiler ris command out text outtext org apache sling scripting sightly impl compiler ris command out variable outvariable org apache sling scripting sightly impl compiler ris command procedure org apache sling scripting sightly impl compiler ris command variable binding variablebinding org apache sling scripting sightly impl utils render utils renderutils java code generator code gen visitor codegenvisitor command visitor commandvisitor java source javasource source unit builder unitbuilder unit builder unitbuilder stack string loop status stack loopstatusstack stack string variable analyzer variableanalyzer analyzer variable analyzer variableanalyzer stateful visitor statefulvisitor state control statecontrol control string unit parameters unitparameters code gen visitor codegenvisitor unit builder unitbuilder unit builder unitbuilder stateful visitor statefulvisitor state control statecontrol control unit builder unitbuilder unit builder unitbuilder source unit builder unitbuilder get source getsource control control unit parameters unitparameters hash set hashset string string param unit builder unitbuilder get parameters getparameters unit parameters unitparameters add param to lower case tolowercase complete building source finish source prepend initial izations initializations string initial izations initializations java source javasource init source initsource java source javasource variable descriptor variabledescriptor descriptor analyzer all variables allvariables init variable initvariable descriptor init source initsource init source initsource to string tostring init variable initvariable variable descriptor variabledescriptor descriptor java source javasource init source initsource descriptor get scope getscope dynamic init source initsource begin assignment beginassignment descriptor get assigned name getassignedname descriptor is template variable istemplatevariable init source initsource start call startcall source gen constants sourcegenconstants record unit parameters unitparameters descriptor get original name getoriginalname to lower case tolowercase init source initsource start method call startmethodcall source gen constants sourcegenconstants arguments field source gen constants sourcegenconstants bindings method init source initsource start method call startmethodcall source gen constants sourcegenconstants bindings field source gen constants sourcegenconstants bindings method init source initsource string literal stringliteral descriptor get original name getoriginalname end call endcall end statement endstatement global init source initsource begin assignment beginassignment descriptor get assigned name getassignedname null literal nullliteral end statement endstatement string list coercion var listcoercionvar descriptor get list coercion getlistcoercion list coercion var listcoercionvar initialize list coercion init source initsource begin assignment beginassignment list coercion var listcoercionvar source gen constants sourcegenconstants collection type null literal nullliteral end statement endstatement override visit conditional start conditional variable descriptor variabledescriptor descriptor analyzer descriptor conditional get variable getvariable negate conditional get expected truth value getexpectedtruthvalue source begin if beginif negate source negation descriptor get type gettype type source append descriptor get assigned name getassignedname source start method call startmethodcall source gen constants sourcegenconstants render utils render utils renderutils coerce append descriptor get assigned name getassignedname end call endcall source complete if completeif override visit conditional conditional end conditionalend source end if endif override visit variable binding variablebinding start variable binding variablebinding source start block startblock type info typeinfo type info typeinfo type inference typeinference infer types infertypes variable binding variablebinding get expression getexpression analyzer type type type info typeinfo type of typeof variable binding variablebinding get expression getexpression string proper name propername declare variable binding variablebinding get variable name getvariablename type source begin assignment beginassignment proper name propername type get native class getnativeclass expression translator expressiontranslator build expression buildexpression variable binding variablebinding get expression getexpression source analyzer type info typeinfo source end statement endstatement override visit variable binding variablebinding variable binding end variablebindingend variable descriptor variabledescriptor descriptor analyzer end variable endvariable string list coercion var listcoercionvar descriptor get list coercion getlistcoercion list coercion var listcoercionvar variable coerce d coerced list point generate coercion clearing generatecoercionclearing list coercion var listcoercionvar source end block endblock override visit variable binding variablebinding global global assignment globalassignment type info typeinfo type info typeinfo type inference typeinference infer types infertypes global assignment globalassignment get expression getexpression analyzer variable descriptor variabledescriptor descriptor analyzer declare global declareglobal global assignment globalassignment get variable name getvariablename string descriptor get assigned name getassignedname source append assign expression translator expressiontranslator build expression buildexpression global assignment globalassignment get expression getexpression source analyzer type info typeinfo source end statement endstatement string list coercion var listcoercionvar descriptor get list coercion getlistcoercion list coercion var listcoercionvar variable list coercion gen erating generating coercion clearing generate coercion clearing generatecoercionclearing list coercion var listcoercionvar override visit out variable outvariable out variable outvariable string variable analyzer assigned name assignedname out variable outvariable get variable name getvariablename source start statement startstatement start method call startmethodcall source gen constants sourcegenconstants buffer source gen constants sourcegenconstants write method start method call startmethodcall source gen constants sourcegenconstants render utils render utils renderutils string coerce append variable end call endcall end call endcall end statement endstatement override visit out text outtext out text outtext source start statement startstatement start method call startmethodcall source gen constants sourcegenconstants buffer source gen constants sourcegenconstants write method string literal stringliteral out text outtext get text gettext end call endcall end statement endstatement override visit loop start loop variable descriptor variabledescriptor descriptor analyzer descriptor loop get list variable getlistvariable string list variable listvariable descriptor get assigned name getassignedname string collection var collectionvar descriptor require list coercion requirelistcoercion source begin if beginif append collection var collectionvar equality null literal nullliteral complete if completeif start statement startstatement append collection var collectionvar assign start method call startmethodcall source gen constants sourcegenconstants render utils render utils renderutils collection coerce append list variable listvariable end call endcall end statement endstatement end if endif string index var indexvar declare loop get index variable getindexvariable type source begin assignment beginassignment index var indexvar type get native class getnativeclass number end statement endstatement string item var itemvar declare loop get item variable getitemvariable type unknown source begin for beginfor item var itemvar collection var collectionvar loop status stack loopstatusstack push index var indexvar override visit loop loop end loopend string index var indexvar loop status stack loopstatusstack pop source start statement startstatement append index var indexvar increment end statement endstatement source end for endfor analyzer end variable endvariable analyzer end variable endvariable override visit procedure start start procedure startprocedure unit builder unitbuilder sub template unit subtemplateunit unit builder unitbuilder new sub builder newsubbuilder start procedure startprocedure get name getname start procedure startprocedure get parameters getparameters analyzer declare template declaretemplate start procedure startprocedure get name getname control push code gen visitor codegenvisitor sub template unit subtemplateunit control override visit procedure end procedure endprocedure code gen visitor codegenvisitor previous code gen visitor codegenvisitor control pop previous finish override visit procedure call proc edure call procedurecall string template var templatevar analyzer assigned name assignedname proc edure call procedurecall get template variable gettemplatevariable string arg var argvar analyzer assigned name assignedname proc edure call procedurecall get arguments variable getargumentsvariable source start statement startstatement start call startcall source gen constants sourcegenconstants call unit method append source gen constants sourcegenconstants render context instance separate argument separateargument append template var templatevar separate argument separateargument append arg var argvar end call endcall end statement endstatement string declare string original name originalname type type analyzer declare variable declarevariable original name originalname type get assigned name getassignedname generate coercion clearing generatecoercionclearing string coercion variable name coercionvariablename source start statement startstatement append coercion variable name coercionvariablename assign null literal nullliteral end statement endstatement
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core org junit assert true asserttrue java util dictionary java util hashtable java util uuid java util concurrent atomic atomic integer atomicinteger javax inject inject org apache sling api health check healthcheck org apache sling api result org apache sling api execution health check executor healthcheckexecutor org junit test org junit runner run with runwith org ops pax exam configuration org ops pax exam option org ops pax exam junit pax exam paxexam org osgi framework bundle context bundlecontext org osgi framework service registration serviceregistration run with runwith pax exam paxexam async health check test asynchealthchecktest inject health check executor healthcheckexecutor executor inject bundle context bundlecontext bundle context bundlecontext configuration option config config test test async health check testasynchealthcheck interrupted exception interruptedexception string uuid randomuuid to string tostring atomic integer atomicinteger counter atomic integer atomicinteger integer min health check healthcheck health check healthcheck override result execute counter increment and get incrementandget result result status counter dictionary string object props hashtable string object props health check healthcheck props health check healthcheck tags props health check healthcheck async cron expression suppress warnings suppresswarnings rawtypes service registration serviceregistration reg bundle context bundlecontext register service registerservice health check healthcheck props wait registered expect health checks expecthealthchecks executor reset counter check increments don executor counter timeout system current time millis currenttimemillis system current time millis currenttimemillis timeout counter thread sleep assert true asserttrue expecting counter inc remented incremented counter verify log string msg executor execute get health check result gethealthcheckresult iterator get message getmessage assert true asserttrue expecting message msg msg counter verify calling executor lots times doesn increment previous counter executor execute assert true asserttrue expecting counter increment asynchronously counter previous reg unregister
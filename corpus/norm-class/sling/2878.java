licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer provider file impl java file java file output stream fileoutputstream java io exception ioexception java input stream inputstream java math big integer biginteger java security message digest messagedigest java util array list arraylist java util dictionary java util list java util map org apache felix file configuration handler configurationhandler org apache sling installer api installable resource installableresource org apache sling installer api osgi installer osgiinstaller org apache sling installer api update handler updatehandler org apache sling installer api update result updateresult org apache sling settings sling settings service slingsettingsservice org slf logger org slf logger factory loggerfactory code file installer fileinstaller code manages file install ers installers handles updates file installer fileinstaller update handler updatehandler scheme register resources string scheme prefix file install fileinstall logger logger logger logger factory loggerfactory get logger getlogger get class getclass active scan configurations list scan configuration scanconfiguration scan configurations scanconfigurations array list arraylist scan configuration scanconfiguration monitors list file monitor filemonitor monitors array list arraylist file monitor filemonitor write back writeback file installer fileinstaller list scan configuration scanconfiguration configs write back writeback write back writeback write back writeback configs scan configurations scanconfigurations add all addall configs has configurations hasconfigurations scan configurations scanconfigurations is empty isempty start osgi installer osgiinstaller installer sling settings service slingsettingsservice settings scan configuration scanconfiguration config scan configurations scanconfigurations string key config directory key starts with startswith settings get sling home path getslinghomepath file separator key sling key substring settings get sling home path getslinghomepath length logger debug starting monitor config directory monitors add file monitor filemonitor file config directory config scan interval scaninterval installer installer settings config directory hash key file monitor filemonitor monitor monitors monitor monitors clear string get schemes getschemes string schemes string monitors size file monitor filemonitor monitors schemes get listener getlistener get scheme getscheme schemes org apache sling installer api update handler updatehandler handle removal handleremoval java lang string java lang string java lang string update result updateresult handle removal handleremoval string resource type resourcetype string string url write back writeback pos url index of indexof string path url substring pos remove logger debug removal path file file file path file exists file delete update result updateresult url org apache sling installer api update handler updatehandler handle update handleupdate java lang string java lang string java lang string java util dictionary map update result updateresult handle update handleupdate string resource type resourcetype string string url dictionary string object dict map string object attributes handle update handleupdate resource type resourcetype url dict attributes org apache sling installer api update handler updatehandler handle update handleupdate java lang string java lang string java lang string java input stream inputstream map update result updateresult handle update handleupdate string resource type resourcetype string string url input stream inputstream map string object attributes handle update handleupdate resource type resourcetype url attributes internal implementation update handling update result updateresult handle update handleupdate string resource type resourcetype string string url input stream inputstream dictionary string object dict map string object attributes write back writeback handle add update configs resource type resourcetype equals installable resource installableresource type config string path string prefix url update pos url index of indexof string old path oldpath url substring pos prefix url substring pos ensure extension config old path oldpath ends with endswith config file file file old path oldpath file exists file delete last dot lastdot old path oldpath last index of lastindexof last slash lastslash old path oldpath last index of lastindexof last dot lastdot last slash lastslash path old path oldpath config path old path oldpath substring last dot lastdot config path old path oldpath logger debug update resource type resourcetype path add file monitor filemonitor monitors path get root getroot get absolute path getabsolutepath config prefix get listener getlistener get scheme getscheme logger debug add resource type resourcetype path file file file path file get parent file getparentfile mkdirs file output stream fileoutputstream fos file output stream fileoutputstream file fos write configuration created apache sling file installer get bytes getbytes utf configuration handler configurationhandler write fos dict fos close io exception ioexception ignore update result updateresult result update result updateresult prefix path result set resource is moved setresourceismoved result io exception ioexception logger error unable add update resource resource type resourcetype hash string string hash string message digest messagedigest message digest messagedigest get instance getinstance update get bytes getbytes utf big integer biginteger big int bigint big integer biginteger digest string big int bigint to string tostring exception ignore
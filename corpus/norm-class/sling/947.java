licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr content loader contentloader internal java util calendar java util hash map hashmap java util hash set hashset java util list java util map java util java util string tokenizer stringtokenizer javax jcr node javax jcr repository exception repositoryexception javax jcr session javax jcr javax jcr lock lock exception lockexception org apache felix scr annotations component org apache felix scr annotations property org apache felix scr annotations reference org apache sling commons mime mime type service mimetypeservice org apache sling jcr api sling repository slingrepository org apache sling settings sling settings service slingsettingsservice org osgi framework bundle org osgi framework bundle event bundleevent org osgi framework constants org osgi framework sync hronous bundle listener synchronousbundlelistener org osgi service component component context componentcontext org slf logger org slf logger factory loggerfactory code content loader service contentloaderservice code service providing functionality bundle listener load unload initial content component property constants service description apache sling content loader implementation content loader service contentloaderservice sync hronous bundle listener synchronousbundlelistener bundle helper bundlehelper string property content loaded content loaded string property content loaded content load time string property content loaded content loaded string property content unloaded content unload time string property content unloaded content unloaded string property uninstall paths uninstall paths string bundle content node sling bundle content log logger log logger factory loggerfactory get logger getlogger get class getclass jcr repository access resolve resources reference sling repository slingrepository repository mime type service mimetypeservice bundle content loader resolve mime types files installed reference mime type service mimetypeservice mime type service mimetypeservice service storing content read ers readers reference content reader whiteboard contentreaderwhiteboard content reader whiteboard contentreaderwhiteboard initial content loader called load initial content repository providing bundle installed bundle content loader bundlecontentloader bundle content loader bundlecontentloader current instance string sling id slingid list updated bundles string updated bundles updatedbundles hash set hashset string sling settings service reference sling settings service slingsettingsservice settings service settingsservice bundle listener bundlelistener loads unloads content bundle changed bundle started content loaded bundle content unloaded param event code bundle event bundleevent code representing bundle change bundle changed bundlechanged bundle event bundleevent event note sync hronous synchronous care block system session session bundle bundle event get bundle getbundle event get type gettype bundle event bundleevent resolved safely add content point session get session getsession is update isupdate updated bundles updatedbundles is update isupdate updated bundles updatedbundles remove bundle get symbolic name getsymbolicname bundle content loader bundlecontentloader register bundle registerbundle session bundle is update isupdate throwable log error bundle changed bundlechanged problem loading initial content bundle bundle get symbolic name getsymbolicname bundle get bundle id getbundleid unget session ungetsession session bundle event bundleevent updated info start event triggered updated bundles updatedbundles updated bundles updatedbundles add bundle get symbolic name getsymbolicname bundle event bundleevent uninstalled session get session getsession bundle content loader bundlecontentloader unregister bundle unregisterbundle session bundle throwable log error bundle changed bundlechanged problem unloading initial content bundle bundle get symbolic name getsymbolicname bundle get bundle id getbundleid unget session ungetsession session implementation helpers returns mime type mime type service mimetypeservice string get mime type getmimetype string local copy npe check concurrent unbind mime type service mimetypeservice mts mime type service mimetypeservice mts mts get mime type getmimetype create repository path createrepositorypath session writer session writersession string repository path repositorypath repository exception repositoryexception writer session writersession item exists itemexists repository path repositorypath node node writer session writersession get root node getrootnode string path repository path repositorypath substring pos path last index of lastindexof pos string tokenizer stringtokenizer string tokenizer stringtokenizer path substring pos has more tokens hasmoretokens string token next token nexttoken node has node hasnode token node add node addnode token sling folder node save node node get node getnode token path path substring pos node has node hasnode path node add node addnode path sling folder node save scr int egration integration activates component called scr registering service activate component context componentcontext component context componentcontext sling id slingid settings service settingsservice get sling id getslingid bundle content loader bundlecontentloader bundle content loader bundlecontentloader content reader whiteboard contentreaderwhiteboard component context componentcontext get bundle context getbundlecontext add bundle listener addbundlelistener session session session get session getsession create repository path createrepositorypath session bundle content node log debug activated attempting load content bundles installed uninstalled bundle bundles component context componentcontext get bundle context getbundlecontext get bundles getbundles bundle bundle bundles bundle get state getstate bundle installed bundle uninstalled uninstalled bundle content loader bundlecontentloader register bundle registerbundle session bundle throwable log error problem loading initial content bundle bundle get symbolic name getsymbolicname bundle get bundle id getbundleid session has pending changes haspendingchanges session refresh log debug bundles suitable initial content loading bundles length throwable log error activate problem loading initial content registering mappings existing bundles unget session ungetsession session deactivates component called scr service deactivate component context componentcontext component context componentcontext component context componentcontext get bundle context getbundlecontext remove bundle listener removebundlelistener bundle content loader bundlecontentloader bundle content loader bundlecontentloader dispose bundle content loader bundlecontentloader internal helper returns jcr repository service sling repository slingrepository get repository getrepository repository returns administrative session workspace session get session getsession repository exception repositoryexception get repository getrepository login administrative loginadministrative returns administrative session named workspace session get session getsession string workspace repository exception repositoryexception get repository getrepository login administrative loginadministrative workspace administrative session close unget session ungetsession session session session session log out logout throwable log error unable log session get message getmessage bundle content info exclusive lock param session param bundle map bundle content info repository exception repositoryexception map string object get bundle content info getbundlecontentinfo session session bundle bundle create repository exception repositoryexception string node name nodename bundle get symbolic name getsymbolicname node parent node parentnode node session get item getitem bundle content node parent node parentnode has node hasnode node name nodename create node bc node bcnode parent node parentnode add node addnode node name nodename unstructured bc node bcnode add mixin addmixin mix lock able lockable parent node parentnode save repository exception repositoryexception log warn unable create node node name nodename session refresh node bc node bcnode parent node parentnode get node getnode node name nodename bc node bcnode is locked islocked bc node bcnode lock lock exception lockexception map string object info hash map hashmap string object bc node bcnode has property hasproperty property content loaded info property content loaded bc node bcnode get property getproperty property content loaded get date getdate bc node bcnode has property hasproperty property content loaded info property content loaded bc node bcnode get property getproperty property content loaded get boolean getboolean info property content loaded bc node bcnode has property hasproperty property uninstall paths values bc node bcnode get property getproperty property uninstall paths get values getvalues string string values length values length values get string getstring info property uninstall paths info unlock bundle content info unlockbundlecontentinfo session session bundle bundle content loaded contentloaded list string created nodes creatednodes repository exception repositoryexception string node name nodename bundle get symbolic name getsymbolicname node parent node parentnode node session get item getitem bundle content node node bc node bcnode parent node parentnode get node getnode node name nodename content loaded contentloaded bc node bcnode set property setproperty property content loaded content loaded contentloaded bc node bcnode set property setproperty property content loaded calendar get instance getinstance bc node bcnode set property setproperty property content loaded sling id slingid bc node bcnode set property setproperty property content unloaded string bc node bcnode set property setproperty property content unloaded string created nodes creatednodes created nodes creatednodes size bc node bcnode set property setproperty property uninstall paths created nodes creatednodes to array toarray string created nodes creatednodes size bc node bcnode save bc node bcnode unlock content is uninstalled contentisuninstalled session session bundle bundle string node name nodename bundle get symbolic name getsymbolicname node parent node parentnode node session get item getitem bundle content node parent node parentnode has node hasnode node name nodename node bc node bcnode parent node parentnode get node getnode node name nodename bc node bcnode set property setproperty property content loaded bc node bcnode set property setproperty property content unloaded calendar get instance getinstance bc node bcnode set property setproperty property content unloaded sling id slingid bc node bcnode set property setproperty property uninstall paths string bc node bcnode save repository exception repositoryexception log error unable update bundle content info
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling engine impl log java io exception ioexception javax servlet servlet output stream servletoutputstream javax servlet http http servlet response httpservletresponse org apache sling engine impl helper client abort exception clientabortexception org jmock expectations org jmock mockery org jmock int egration integration junit j mock jmock org jmock int egration integration junit j unit junit mockery org jmock lib legacy class imposteriser classimposteriser org junit org junit test org junit runner run with runwith verify request logger response requestloggerresponse wraps io exception ioexception client abort exception clientabortexception run with runwith j mock jmock client abort exception test clientabortexceptiontest mockery context request logger response requestloggerresponse setup io exception ioexception context j unit junit mockery set imposteriser setimposteriser class imposteriser classimposteriser instance servlet output stream servletoutputstream sos servlet output stream servletoutputstream override write io exception ioexception io exception ioexception fails purpose override flush io exception ioexception io exception ioexception fails purpose override close io exception ioexception io exception ioexception fails purpose http servlet response httpservletresponse raw context mock http servlet response httpservletresponse context checking expectations allowing raw get output stream getoutputstream return value returnvalue sos request logger response requestloggerresponse raw test expected client abort exception clientabortexception write int writeint io exception ioexception get output stream getoutputstream write test expected client abort exception clientabortexception write simple byte array writesimplebytearray io exception ioexception get output stream getoutputstream write foo get bytes getbytes test expected client abort exception clientabortexception write byte array writebytearray io exception ioexception data bar get bytes getbytes get output stream getoutputstream write data data length test expected client abort exception clientabortexception flush io exception ioexception get output stream getoutputstream flush test expected client abort exception clientabortexception close io exception ioexception get output stream getoutputstream close
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad base impl java file java file reader filereader java file writer filewriter java io exception ioexception java net url java net url class loader urlclassloader java util map org apache felix framework logger org apache sling launchpad api launchpad content provider launchpadcontentprovider org apache sling launchpad api startup mode startupmode org apache sling launchpad base shared shared constants sharedconstants org osgi framework constants code startup manager startupmanager code detect startup mode distinguishes initial startup install update update restart change restart startup manager startupmanager data file works marker detect startup string data file launchpad timestamp txt data file string data file bundle file separator char separatorchar bootstrap installer bootstrapinstaller ser mode override property string override prop org apache sling launchpad startup mode startupmode link logger logging messages installation startup logger logger startup mode startupmode mode file startup dir startupdir file conf dir confdir target start level targetstartlevel incremental startup enabled incrementalstartupenabled startup manager startupmanager map string string properties logger logger logger logger startup dir startupdir directory util directoryutil get startup dir getstartupdir properties conf dir confdir directory util directoryutil get config dir getconfigdir properties check override property string override mode overridemode system get property getproperty override prop properties override prop override mode overridemode mode startup mode startupmode value of valueof override mode overridemode to upper case touppercase logger log logger log info override property starting mode mode mode detect mode detectmode properties constants framework storage logger log logger log info detected startup mode starting mode mode target start level targetstartlevel value of valueof properties constants framework start level startlevel incremental startup enabled incrementalstartupenabled value of valueof properties shared constants sharedconstants sling install incremental start restart reduce start level mode startup mode startupmode restart incremental startup enabled incrementalstartupenabled string start level startlevel properties shared constants sharedconstants sling install start level startlevel properties constants framework start level startlevel start level startlevel start level startlevel startup mode startup mode startup mode startupmode get mode getmode mode incremental startup enabled is incremental startup enabled isincrementalstartupenabled incremental startup enabled incrementalstartupenabled target start level target start level get target start level gettargetstartlevel target start level targetstartlevel detect startup mode comparing time stamps startup mode startupmode detect mode detectmode string osgi storage dir osgistoragedir file data file datafile file conf dir confdir data file data file datafile exists file reader filereader fis self stamp selfstamp get self timestamp getselftimestamp self stamp selfstamp fis file reader filereader data file datafile txt len fis read txt string string txt len stored stamp storedstamp parse long parselong logger log logger log info string format stored startup timestamp stored stamp storedstamp stored stamp storedstamp self stamp selfstamp startup mode startupmode restart startup mode startupmode update number format exception numberformatexception nfe startup mode startupmode restart io exception ioexception ioe logger log logger log error io exception ioexception reading installed flag ioe fis fis close io exception ioexception ignore check data file bit hacky apache felix bundle cache older versions felix fine file felix dir felixdir file osgi storage dir osgistoragedir file old file oldfile file felix dir felixdir data file old file oldfile exists update remove file old file oldfile delete startup mode startupmode update installed fallback startup mode startupmode install time stamp url class loader classloader get time stamp of class gettimestampofclass clazz self stamp selfstamp time stamp timestamp self stamp selfstamp class loader classloader loader clazz get class loader getclassloader loader url class loader urlclassloader url class loader urlclassloader url loader urlloader url class loader urlclassloader loader url urls url loader urlloader geturls urls length url url urls stamp urls open connection openconnection get last modified getlastmodified stamp self stamp selfstamp logger log logger log info string format newer timestamp clazz get name getname url self stamp selfstamp time stamp timestamp stamp io exception ioexception ignore time stamp timestamp returns time stamp jar file loaded timestamp resolved method assumes class loader classloader url class loader urlclassloader url entry loader jar providing fact url class loader urlclassloader created launcher launcher jar file modification time stamp launcher jar file loader url class loader urlclassloader loader url entries situations expected io exception ioexception error occurs reading accessing modification time stamp get self timestamp getselftimestamp time stamp launcher jar bootstrap jar self stamp selfstamp get time stamp of class gettimestampofclass get class getclass self stamp selfstamp get time stamp of class gettimestampofclass launchpad content provider launchpadcontentprovider self stamp selfstamp check bundle you nger younger launcher jar file directories startup dir startupdir list files listfiles directory util directoryutil directory filter directories file level dir leveldir directories iter ate iterate files start level startlevel dir file jar files jarfiles level dir leveldir list files listfiles directory util directoryutil bundle file filter jar files jarfiles file bundle jar bundlejar jar files jarfiles bundle jar bundlejar last modified lastmodified self stamp selfstamp self stamp selfstamp bundle jar bundlejar last modified lastmodified logger log logger log info string format newer timestamp bundle jar bundlejar self stamp selfstamp logger log logger log info string format timestamp self stamp selfstamp bundle jar files self stamp selfstamp finished installation marker mark installed markinstalled file data file datafile file conf dir confdir data file conf dir confdir mkdirs file writer filewriter fos file writer filewriter data file datafile fos write string value of valueof system current time millis currenttimemillis fos close io exception ioexception ignore io exception ioexception ioe logger log logger log error io exception ioexception writing installed flag ioe
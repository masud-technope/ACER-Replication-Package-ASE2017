licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad base impl org junit assert equals assertequals org junit assert false assertfalse org junit fail org mockito mockito java io exception ioexception java net jarurlconnection java net malformedurlexception java net url java net url connection urlconnection java net url stream handler urlstreamhandler java util array list arraylist java util iterator java util list java util vector java util jar jar entry jarentry java util jar jar file jarfile org junit org junit test org mockito matchers org mockito mockito class loader resource provider children test classloaderresourceproviderchildrentest class loader classloader class loader classloader class loader resource provider classloaderresourceprovider provider throw exception on open connection throwexceptiononopenconnection string test paths resources install resources install jar resources install jar resources install jar resources install jackrabbit jar resources install jackrabbit jar resources install oak jar resources install oak jar class loader classloader mock class loader mockclassloader string paths malformedurlexception io exception ioexception class loader classloader mockito mock class loader classloader jarurlconnection conn mockito mock jarurlconnection url stream handler urlstreamhandler handler url stream handler urlstreamhandler override url connection urlconnection open connection openconnection url url io exception ioexception throw exception on open connection throwexceptiononopenconnection io exception ioexception throwing testing conn jar file jarfile mockito mock jar file jarfile url url url jar jar localhost jar handler vector jar entry jarentry entries vector jar entry jarentry string path paths entries add jar entry jarentry path get resource getresource matchers install then return thenreturn url conn get jar file getjarfile then return thenreturn entries then return thenreturn entries elements assert children assertchildren class loader resource provider classloaderresourceprovider string path string expected list string result array list arraylist string iterator string get children getchildren path has next hasnext result add string exp expected result exp fail path expected child result exp result result assert equals assertequals path expecting expected length children result result expected length result size setup malformedurlexception io exception ioexception class loader classloader mock class loader mockclassloader test paths provider class loader resource provider classloaderresourceprovider class loader classloader test test install testinstall assert children assertchildren provider resources install resources install jar test test install trailing slahs testinstalltrailingslahs assert children assertchildren provider resources install resources install jar test test install sub testinstallsub assert children assertchildren provider resources install resources install jar resources install jar test test install jackrabbit testinstalljackrabbit assert children assertchildren provider resources install jackrabbit resources install jackrabbit jar resources install jackrabbit jar test test install jackrabbit trailing slash testinstalljackrabbittrailingslash assert children assertchildren provider resources install jackrabbit resources install jackrabbit jar resources install jackrabbit jar test test install oak testinstalloak assert children assertchildren provider resources install oak resources install oak jar test test no results testnoresults iterator string provider get children getchildren foo assert false assertfalse expecting children has next hasnext test test exception testexception throw exception on open connection throwexceptiononopenconnection iterator string provider get children getchildren resources install assert false assertfalse expecting io exception ioexception has next hasnext
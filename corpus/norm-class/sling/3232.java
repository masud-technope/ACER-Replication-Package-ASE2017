licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base setup org junit assert true asserttrue org junit fail java lang reflect invocation target exception invocationtargetexception java net malformedurlexception java net url java util java util dictionary java util hash map hashmap java util iterator java util map javax servlet servlet org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling discovery instance description instancedescription org apache sling discovery property provider propertyprovider org apache sling discovery topology event listener topologyeventlistener org apache sling discovery base commons base discovery service basediscoveryservice org apache sling discovery base commons cluster view service clusterviewservice org apache sling discovery base commons undefined cluster view exception undefinedclusterviewexception org apache sling discovery base commons view checker viewchecker org apache sling discovery base connectors announcement announcement registry announcementregistry org apache sling discovery base connectors ping connector registry connectorregistry org apache sling discovery base connectors ping topology connector client information topologyconnectorclientinformation org apache sling discovery base connectors ping topology connector servlet topologyconnectorservlet org apache sling discovery base setup mock artificial delay artificialdelay org eclipse jetty server connector org eclipse jetty server server org eclipse jetty server nio select channel connector selectchannelconnector org eclipse jetty servlet servlet context handler servletcontexthandler org eclipse jetty servlet servlet holder servletholder org jmock expectations org jmock mockery org jmock int egration integration junit j unit junit mockery org osgi framework constants org osgi service component component context componentcontext org osgi service http http context httpcontext org osgi service http http service httpservice org slf logger org slf logger factory loggerfactory junit x junitx util private accessor privateaccessor virtual instance virtualinstance logger logger logger factory loggerfactory get logger getlogger virtual instance virtualinstance string sling id slingid cluster view service clusterviewservice cluster view service clusterviewservice resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory osg i mock osgimock osgi mock osgimock base discovery service basediscoveryservice discovery service discoveryservice announcement registry announcementregistry announcement registry announcementregistry connector registry connectorregistry connector registry connectorregistry string debug name debugname resource resolver resourceresolver resource resolver resourceresolver service id serviceid view checker runner viewcheckerrunner view checker runner viewcheckerrunner servlet context handler servletcontexthandler servlet context servletcontext server jetty server jettyserver modifiable test base config modifiabletestbaseconfig config view checker viewchecker view checker viewchecker virtual instance builder virtualinstancebuilder builder artificial delay artificialdelay delay view checker runner viewcheckerrunner runnable int erval in seconds intervalinseconds stopping stopped view checker runner viewcheckerrunner int erval in seconds intervalinseconds int erval in seconds intervalinseconds int erval in seconds intervalinseconds logger info stopping instance sling id slingid stopping notify all notifyall has stopped hasstopped stopped do run dorun stopped logger info instance sling id slingid stopped do run dorun stopping logger info instance sling id slingid stop ps stopps heartbeats and check view heartbeatsandcheckview exception logger error ping connector sling id slingid sling id slingid thr ew threw exception wait int erval in seconds intervalinseconds interrupted exception interruptedexception print stack trace printstacktrace virtual instance virtualinstance virtual instance builder virtualinstancebuilder builder exception builder builder sling id slingid builder get sling id getslingid debug name debugname builder get debug name getdebugname delay builder get delay getdelay logger info init starting sling id slingid sling id slingid debug name debugname debug name debugname osgi mock osgimock osg i mock osgimock resource resolver factory resourceresolverfactory builder get resource resolver factory getresourceresolverfactory config builder get connector config getconnectorconfig config add topology connector whitelist entry addtopologyconnectorwhitelistentry config set min event delay setmineventdelay builder get min event delay getmineventdelay cluster view service clusterviewservice builder get cluster view service getclusterviewservice announcement registry announcementregistry builder get announcement registry getannouncementregistry connector registry connectorregistry builder get connector registry getconnectorregistry view checker viewchecker builder get view checker getviewchecker discovery service discoveryservice builder get discover service getdiscoverservice osgi mock osgimock add service addservice cluster view service clusterviewservice osgi mock osgimock add service addservice announcement registry announcementregistry osgi mock osgimock add service addservice connector registry connectorregistry osgi mock osgimock add service addservice view checker viewchecker osgi mock osgimock add service addservice discovery service discoveryservice osgi mock osgimock add services addservices builder get additional services getadditionalservices resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver builder is reset repo isresetrepo sling reset repo resetrepo creating observation listener observationlistener tons events deletion previous test left add event listener addeventlistener prevent builder reset repo resetrepo osgi mock osgimock activate all activateall set delay setdelay string operation descriptor operationdescriptor delay millis delaymillis delay set delay setdelay operation descriptor operationdescriptor delay millis delaymillis override string to string tostring test instance sling id slingid sling id slingid debug name debugname debug name debugname bind property provider bindpropertyprovider property provider propertyprovider property provider propertyprovider string property names propertynames throwable map string object props hash map hashmap string object props constants service service id serviceid props property provider propertyprovider property properties property names propertynames private accessor privateaccessor invoke discovery service discoveryservice bind property provider bindpropertyprovider property provider propertyprovider map object property provider propertyprovider props string get sling id getslingid sling id slingid cluster view service clusterviewservice get cluster view service getclusterviewservice cluster view service clusterviewservice base discovery service basediscoveryservice get discovery service getdiscoveryservice discovery service discoveryservice announcement registry announcementregistry get announcement registry getannouncementregistry announcement registry announcementregistry start jetty startjetty throwable jetty server jettyserver servlet context servletcontext servlet context handler servletcontexthandler servlet context handler servletcontexthandler security servlet context servletcontext set context path setcontextpath topology connector servlet topologyconnectorservlet servlet topology connector servlet topologyconnectorservlet private accessor privateaccessor set field setfield servlet config config private accessor privateaccessor set field setfield servlet cluster view service clusterviewservice cluster view service clusterviewservice private accessor privateaccessor set field setfield servlet announcement registry announcementregistry announcement registry announcementregistry mockery context j unit junit mockery http service httpservice http service httpservice context mock http service httpservice context checking expectations allowing http service httpservice register servlet registerservlet string servlet dictionary http context httpcontext private accessor privateaccessor set field setfield servlet http service httpservice http service httpservice component context componentcontext private accessor privateaccessor invoke servlet activate component context componentcontext object servlet holder servletholder holder servlet holder servletholder servlet servlet context servletcontext add servlet addservlet holder system console topology jetty server jettyserver server jetty server jettyserver set handler sethandler servlet context servletcontext connector connector select channel connector selectchannelconnector jetty server jettyserver set connectors setconnectors connector connector jetty server jettyserver start get jetty port getjettyport jetty server jettyserver illegal state exception illegalstateexception jetty server jettyserver started connector connectors jetty server jettyserver get connectors getconnectors connectors get local port getlocalport topology connector client information topologyconnectorclientinformation connect to connectto string url malformedurlexception connector registry connectorregistry register out going connector registeroutgoingconnector cluster view service clusterviewservice url url instance description instancedescription get local instance description getlocalinstancedescription undefined cluster view exception undefinedclusterviewexception iterator instance description instancedescription get cluster view service getclusterviewservice get local cluster view getlocalclusterview get instances getinstances iterator has next hasnext instance description instancedescription sling id slingid equals get sling id getslingid fail local instance description instancedescription called heartbeats and check view heartbeatsandcheckview logger info instance sling id slingid issues pulse view checker viewchecker heartbeat and check view heartbeatandcheckview start view checker startviewchecker int erval in seconds intervalinseconds illegal access exception illegalaccessexception invocation target exception invocationtargetexception logger info start view checker startviewchecker int erval in seconds intervalinseconds int erval in seconds intervalinseconds view checker runner viewcheckerrunner logger info start view checker startviewchecker stopping view checker runner viewcheckerrunner logger info start view checker startviewchecker stopped logger info start view checker startviewchecker act ivating activating osg i mock osgimock activate view checker viewchecker error print stack trace printstacktrace system runtime exception runtimeexception print stack trace printstacktrace system logger info start view checker startviewchecker initial izing initializing view checker runner viewcheckerrunner view checker runner viewcheckerrunner int erval in seconds intervalinseconds thread thread view checker runner viewcheckerrunner test view checker runner viewcheckerrunner debug name debugname set daemon setdaemon logger info start view checker startviewchecker starting thread start logger info start view checker startviewchecker is view checker running isviewcheckerrunning view checker runner viewcheckerrunner stop view checker stopviewchecker throwable view checker runner viewcheckerrunner view checker runner viewcheckerrunner view checker runner viewcheckerrunner has stopped hasstopped logger info stop view checker stopviewchecker get debug name getdebugname waiting view checker runner viewcheckerrunner thread sleep logger info stop view checker stopviewchecker get debug name getdebugname view checker runner viewcheckerrunner stopped view checker runner viewcheckerrunner osg i mock osgimock deactivate view checker viewchecker error print stack trace printstacktrace system runtime exception runtimeexception print stack trace printstacktrace system dump repo dumprepo exception virtual instance helper virtualinstancehelper dump repo dumprepo resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory get resource resolver factory getresourceresolverfactory resource resolver factory resourceresolverfactory exception logger info stopping sling id slingid sling id slingid debug name debugname debug name debugname stop view checker stopviewchecker throwable exception caught throwable resource resolver resourceresolver resource resolver resourceresolver close osgi mock osgimock deactivate all deactivateall logger info stopped sling id slingid sling id slingid debug name debugname debug name debugname bind topology event listener bindtopologyeventlistener topology event listener topologyeventlistener event listener eventlistener throwable private accessor privateaccessor invoke discovery service discoveryservice bind topology event listener bindtopologyeventlistener topology event listener topologyeventlistener object event listener eventlistener modifiable test base config modifiabletestbaseconfig get config getconfig config view checker viewchecker get view checker getviewchecker view checker viewchecker assert established view assertestablishedview assert true asserttrue get discovery service getdiscoveryservice get topology gettopology is current iscurrent virtual instance builder virtualinstancebuilder get builder getbuilder builder string get debug name getdebugname debug name debugname
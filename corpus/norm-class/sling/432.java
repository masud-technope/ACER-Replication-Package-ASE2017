licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core org junit assert equals assertequals java io exception ioexception java util dictionary java util hashtable java util list java util uuid javax inject inject org junit org junit org junit test org junit runner run with runwith org ops pax exam configuration org ops pax exam option org ops pax exam junit pax exam paxexam org osgi framework bundle context bundlecontext org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service reference servicereference org osgi framework service registration serviceregistration org osgi service configuration admin configurationadmin org osgi service http http service httpservice verify health check executor servlet healthcheckexecutorservlet creating config run with runwith pax exam paxexam health check servlet test healthcheckservlettest inject configuration admin configurationadmin config admin configadmin inject bundle context bundlecontext bundle context bundlecontext mock http service mockhttpservice http service httpservice service registration serviceregistration reg configuration option config config count servlet services countservletservices string package name prefix packagenameprefix invalid syntax exception invalidsyntaxexception service reference servicereference bundle context bundlecontext get service references getservicereferences javax servlet servlet count service reference servicereference object bundle context bundlecontext get service getservice get class getclass get name getname starts with startswith package name prefix packagenameprefix count bundle context bundlecontext unget service ungetservice count setup http service httpservice mock http service mockhttpservice reg bundle context bundlecontext register service registerservice http service httpservice http service httpservice cleanup reg unregister reg http service httpservice test test servlet becomes active testservletbecomesactive invalid syntax exception invalidsyntaxexception io exception ioexception interrupted exception interruptedexception string property servlet path servletpath string path test uuid randomuuid string package prefix packageprefix org apache sling assert equals assertequals init ially initially expecting servlet package prefix packageprefix count servlet services countservletservices package prefix packageprefix paths before pathsbefore http service httpservice get paths getpaths size activate servlet wait string pid org apache sling core impl servlet health check executor servlet healthcheckexecutorservlet org osgi service configuration cfg config admin configadmin get configuration getconfiguration pid dictionary string object props hashtable string object props property path cfg update props timeout msec timeoutmsec end time endtime system current time millis currenttimemillis timeout msec timeoutmsec system current time millis currenttimemillis end time endtime count servlet services countservletservices package prefix packageprefix thread sleep assert equals assertequals adding configuration expecting servlet package prefix packageprefix count servlet services countservletservices package prefix packageprefix list string paths http service httpservice get paths getpaths assert equals assertequals expecting servlet registration paths before pathsbefore paths size assert equals assertequals expecting servlet registered path path paths paths size
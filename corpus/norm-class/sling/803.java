licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core impl executor org junit assert equals assertequals org junit assert true asserttrue org mockito mockito times org mockito mockito verify org mockito mockito java util collection java util java util linked list linkedlist java util list java util java util tree set treeset org apache sling api result org apache sling api execution health check execution result healthcheckexecutionresult org apache sling util health check metadata healthcheckmetadata org junit org junit test org mockito mock org mockito mockito annotations mockitoannotations health check executor impl test healthcheckexecutorimpltest health check executor impl healthcheckexecutorimpl health check executor impl healthcheckexecutorimpl mock health check future healthcheckfuture mock health check metadata healthcheckmetadata health check metadata healthcheckmetadata setup mockito annotations mockitoannotations init mocks initmocks get health check metadata gethealthcheckmetadata then return thenreturn health check metadata healthcheckmetadata health check metadata healthcheckmetadata get title gettitle then return thenreturn test check health check executor impl healthcheckexecutorimpl health check executor impl healthcheckexecutorimpl normal timeout health check executor impl healthcheckexecutorimpl set timeout in ms settimeoutinms timeout critical health check executor impl healthcheckexecutorimpl set long running future threshold for red ms setlongrunningfuturethresholdforredms test test collect results from futures testcollectresultsfromfutures exception list health check future healthcheckfuture futures linked list linkedlist health check future healthcheckfuture futures add collection health check execution result healthcheckexecutionresult tree set treeset health check execution result healthcheckexecutionresult is done isdone then return thenreturn execution result executionresult test result testresult execution result executionresult health check metadata healthcheckmetadata result result status test then return thenreturn test result testresult health check executor impl healthcheckexecutorimpl collect results from futures collectresultsfromfutures futures verify times assert equals assertequals size assert true asserttrue test result testresult test test collect results from futures timeout testcollectresultsfromfuturestimeout exception list health check future healthcheckfuture futures linked list linkedlist health check future healthcheckfuture futures add health check execution result healthcheckexecutionresult tree set treeset health check execution result healthcheckexecutionresult is done isdone then return thenreturn get created time getcreatedtime then return thenreturn health check executor impl healthcheckexecutorimpl collect results from futures collectresultsfromfutures futures verify times assert equals assertequals size health check execution result healthcheckexecutionresult result iterator assert equals assertequals result status warn result get health check result gethealthcheckresult get status getstatus test test collect results from futures critical timeout testcollectresultsfromfuturescriticaltimeout exception list health check future healthcheckfuture futures linked list linkedlist health check future healthcheckfuture futures add health check execution result healthcheckexecutionresult tree set treeset health check execution result healthcheckexecutionresult is done isdone then return thenreturn simulating min get created time getcreatedtime then return thenreturn get time gettime health check executor impl healthcheckexecutorimpl collect results from futures collectresultsfromfutures futures assert equals assertequals size health check execution result healthcheckexecutionresult result iterator verify times assert equals assertequals result status critical result get health check result gethealthcheckresult get status getstatus
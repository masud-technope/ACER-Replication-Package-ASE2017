licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution servlet javax servlet servlet exception servletexception java io exception ioexception java input stream inputstream java util list org apache commons io utils ioutils org apache felix scr annotations sling sling servlet slingservlet org apache http entity content type contenttype org apache sling api sling http servlet request slinghttpservletrequest org apache sling api sling http servlet response slinghttpservletresponse org apache sling api resource resource resolver resourceresolver org apache sling api servlets sling all methods servlet slingallmethodsservlet org apache sling distribution distribution request distributionrequest org apache sling distribution common distribution exception distributionexception org apache sling distribution serialization distribution package distributionpackage org apache sling distribution pack aging packaging distribution package exporter distributionpackageexporter org apache sling distribution resources distribution resource types distributionresourcetypes org apache sling distribution transport impl http transport utils httptransportutils org apache sling distribution util request utils requestutils org slf logger org slf logger factory loggerfactory servlet handle fetching distribution content sling servlet slingservlet resource types resourcetypes distribution resource types distributionresourcetypes exporter resource type methods post distribution package exporter servlet distributionpackageexporterservlet sling all methods servlet slingallmethodsservlet logger log logger factory loggerfactory get logger getlogger get class getclass override do post dopost sling http servlet request slinghttpservletrequest request sling http servlet response slinghttpservletresponse response servlet exception servletexception io exception ioexception string operation request get parameter getparameter operation delete equals operation delete package deletepackage request response fetch equals operation export one package exportonepackage request response export one package exportonepackage request response throwable response set status setstatus log error error exporting export one package exportonepackage sling http servlet request slinghttpservletrequest request sling http servlet response slinghttpservletresponse response delete servlet exception servletexception io exception ioexception distribution package exporter distributionpackageexporter distribution package exporter distributionpackageexporter request get resource getresource adapt to adaptto distribution package exporter distributionpackageexporter start system current time millis currenttimemillis response set content type setcontenttype content type contenttype application octet stream to string tostring distribution request distributionrequest distribution request distributionrequest request utils requestutils from servlet request fromservletrequest request resource resolver resourceresolver resource resolver resourceresolver request get resource resolver getresourceresolver consumed fetched items list distribution package distributionpackage distribution packages distributionpackages distribution package exporter distributionpackageexporter export packages exportpackages resource resolver resourceresolver distribution request distributionrequest fetched distribution packages distributionpackages size distribution packages distributionpackages size log info fetching distribution packages distributionpackages size distribution package distributionpackage distribution package distributionpackage distribution packages distributionpackages distribution package distributionpackage consumed input stream inputstream input stream inputstream bytes copied bytescopied response add header addheader http transport utils httptransportutils header distribution original distribution package distributionpackage get id getid input stream inputstream distribution package distributionpackage create input stream createinputstream bytes copied bytescopied io utils ioutils copy input stream inputstream response get output stream getoutputstream io utils ioutils close quietly closequietly input stream inputstream string package id packageid distribution package distributionpackage get id getid delete delete per manently permanently distribution package distributionpackage delete response set status setstatus log info exported deleted bytes written object package id packageid delete bytes copied bytescopied log warn fetched system current time millis currenttimemillis log info processed distribution export request consumed object start consumed fetched response set status setstatus log debug fetch throwable response set status setstatus log error error exporting delete package deletepackage sling http servlet request slinghttpservletrequest request sling http servlet response slinghttpservletresponse response distribution exception distributionexception distribution package exporter distributionpackageexporter distribution package exporter distributionpackageexporter request get resource getresource adapt to adaptto distribution package exporter distributionpackageexporter resource resolver resourceresolver resource resolver resourceresolver request get resource resolver getresourceresolver string request get parameter getparameter distribution package distributionpackage distribution package distributionpackage distribution package exporter distributionpackageexporter get package getpackage resource resolver resourceresolver distribution package distributionpackage distribution package distributionpackage delete log info exported deleted distribution package distributionpackage get id getid response set status setstatus response set status setstatus log debug delete
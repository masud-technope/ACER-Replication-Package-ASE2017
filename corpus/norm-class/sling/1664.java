licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr base util org apache jackrabbit api jackrabbit session jackrabbitsession org apache jackrabbit api security jackrabbit access control list jackrabbitaccesscontrollist org apache jackrabbit api security principal principal manager principalmanager org apache jackrabbit api security user user manager usermanager org slf logger org slf logger factory loggerfactory java lang reflect invocation target exception invocationtargetexception java lang reflect method java security principal java util array list arraylist java util arrays java util hash set hashset java util list java util map java util javax jcr access denied exception accessdeniedexception javax jcr repository exception repositoryexception javax jcr session javax jcr unsupported repository operation exception unsupportedrepositoryoperationexception javax jcr security access control entry accesscontrolentry javax jcr security access control exception accesscontrolexception javax jcr security access control list accesscontrollist javax jcr security access control manager accesscontrolmanager javax jcr security access control policy accesscontrolpolicy javax jcr security access control policy iterator accesscontrolpolicyiterator javax jcr security privilege simple utility providing util ities utilities resp ect respect access control repositories access control util accesscontrolutil accessor method access control manager accesscontrolmanager string method access control manager get access control manager getaccesscontrolmanager accessor method user manager usermanager string method user manager get user manager getusermanager accessor method principal manager principalmanager string method principal manager get principal manager getprincipalmanager jackrabbit access control list jackrabbitaccesscontrollist method get path getpath string method jackrabbit acl path get path getpath jackrabbit access control list jackrabbitaccesscontrollist method string method jackrabbit acl empty is empty isempty jackrabbit access control list jackrabbitaccesscontrollist method string method jackrabbit acl size size jackrabbit access control list jackrabbitaccesscontrollist method string method jackrabbit acl add entry add entry addentry jackrabbit access control entry jackrabbitaccesscontrolentry method string method jackrabbit ace is allow isallow logger log logger factory loggerfactory get logger getlogger access control util accesscontrolutil session impl sessionimpl methods returns code access control manager accesscontrolmanager code code session code session code get access control manager getaccesscontrolmanager code method code unsupported repository operation exception unsupportedrepositoryoperationexception code thrown code access control manager accesscontrolmanager code returned call fails res pective respective exception thrown param session jcr session code access control manager accesscontrolmanager code returned session pooled session session underlying pooled session code access control manager accesscontrolmanager code session unsupported repository operation exception unsupportedrepositoryoperationexception session code get access control manager getaccesscontrolmanager code method exception thrown method repository exception repositoryexception for warded forwarded code get access control manager getaccesscontrolmanager code method call access control manager accesscontrolmanager get access control manager getaccesscontrolmanager session session unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception safe invoke repo method safeinvokerepomethod session method access control manager access control manager accesscontrolmanager jackrabbit session jackrabbitsession methods returns code user manager usermanager code code session code session code get user manager getusermanager code method code unsupported repository operation exception unsupportedrepositoryoperationexception code thrown code user manager usermanager code returned call fails res pective respective exception thrown param session jcr session code user manager usermanager code returned session code jackrabbit session jackrabbitsession code ref lection reflection ret rive retrive manager repository code user manager usermanager code session access denied exception accessdeniedexception session allowed access user data unsupported repository operation exception unsupportedrepositoryoperationexception session code get user manager getusermanager code method exception thrown method repository exception repositoryexception for warded forwarded code get user manager getusermanager code method call user manager usermanager get user manager getusermanager session session access denied exception accessdeniedexception unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception jackrabbit session jackrabbitsession jackrabbit session jackrabbitsession get jackrabbit session getjackrabbitsession session jackrabbit session jackrabbitsession jackrabbit session jackrabbitsession get user manager getusermanager safe invoke repo method safeinvokerepomethod session method user manager user manager usermanager returns code principal manager principalmanager code code session code session code principal manager principalmanager code method code unsupported repository operation exception unsupportedrepositoryoperationexception code thrown code principal manager principalmanager code returned call fails res pective respective exception thrown param session jcr session code principal manager principalmanager code returned session code jackrabbit session jackrabbitsession code ref lection reflection ret rive retrive manager repository code principal manager principalmanager code session access denied exception accessdeniedexception unsupported repository operation exception unsupportedrepositoryoperationexception session code principal manager principalmanager code method exception thrown method repository exception repositoryexception for warded forwarded code principal manager principalmanager code method call principal manager principalmanager get principal manager getprincipalmanager session session access denied exception accessdeniedexception unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception jackrabbit session jackrabbitsession jackrabbit session jackrabbitsession get jackrabbit session getjackrabbitsession session jackrabbit session jackrabbitsession jackrabbit session jackrabbitsession get principal manager getprincipalmanager safe invoke repo method safeinvokerepomethod session method principal manager principal manager principalmanager access control list accesscontrollist methods returns path node code access control list accesscontrollist code acl created string get path getpath access control list accesscontrollist acl repository exception repositoryexception safe invoke repo method safeinvokerepomethod acl method jackrabbit acl path string returns code code code access control list accesscontrollist code acl define entries is empty isempty access control list accesscontrollist acl repository exception repositoryexception safe invoke repo method safeinvokerepomethod acl method jackrabbit acl empty returns number acl entries acl empty size access control list accesscontrollist acl repository exception repositoryexception safe invoke repo method safeinvokerepomethod acl method jackrabbit acl size integer link add entry addentry access control list accesscontrollist principal privilege map implementation specific restrictions suppress warnings suppresswarnings unchecked add entry addentry access control list accesscontrollist acl principal principal privilege privileges is allow isallow access control exception accesscontrolexception repository exception repositoryexception object args object principal privileges is allow isallow types principal privilege safe invoke repo method safeinvokerepomethod acl method jackrabbit acl add entry args types adds access control entry acl consisting code principal code code privileges code code is allow isallow code flag optional map additional restrictions method returns code code policy modified code code suppress warnings suppresswarnings unchecked add entry addentry access control list accesscontrollist acl principal principal privilege privileges is allow isallow map restrictions unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception object args object principal privileges is allow isallow restrictions types principal privilege map safe invoke repo method safeinvokerepomethod acl method jackrabbit acl add entry args types replaces existing access control entries acl code principal code code resource path resourcepath code existing granted denied privileges conflict privileges main tained maintained conflicts exist existing privileges dropped result ace s aces principal grants denies aggregate privileges disaggregated checking conflicts param session param resource path resourcepath param principal param granted privilege names grantedprivilegenames param denied privilege names deniedprivilegenames param removed privilege names removedprivilegenames privileges exist removed principal resource repository exception repositoryexception deprecated link link replace access control entry replaceaccesscontrolentry session string principal string string string string replace access control entry replaceaccesscontrolentry session session string resource path resourcepath principal principal string granted privilege names grantedprivilegenames string denied privilege names deniedprivilegenames string removed privilege names removedprivilegenames repository exception repositoryexception replace access control entry replaceaccesscontrolentry session resource path resourcepath principal granted privilege names grantedprivilegenames denied privilege names deniedprivilegenames removed privilege names removedprivilegenames replaces existing access control entries acl code principal code code resource path resourcepath code existing granted denied privileges conflict privileges main tained maintained conflicts exist existing privileges dropped result ace s aces principal grants denies aggregate privileges disaggregated checking conflicts param session param resource path resourcepath param principal param granted privilege names grantedprivilegenames param denied privilege names deniedprivilegenames param removed privilege names removedprivilegenames privileges exist removed principal resource param order access control entry list table ace principal doesn exist add leave ace current position place target ace siblings place target ace siblings xyz place target ace sibling xyz xyz place target ace sibling xyz numeric place target ace numeric table repository exception repositoryexception replace access control entry replaceaccesscontrolentry session session string resource path resourcepath principal principal string granted privilege names grantedprivilegenames string denied privilege names deniedprivilegenames string removed privilege names removedprivilegenames string order repository exception repositoryexception access control manager accesscontrolmanager access control manager accesscontrolmanager get access control manager getaccesscontrolmanager session string specified privilege names specifiedprivilegenames hash set hashset string string new granted privilege names newgrantedprivilegenames disaggregate to privilege names disaggregatetoprivilegenames access control manager accesscontrolmanager granted privilege names grantedprivilegenames specified privilege names specifiedprivilegenames string new denied privilege names newdeniedprivilegenames disaggregate to privilege names disaggregatetoprivilegenames access control manager accesscontrolmanager denied privilege names deniedprivilegenames specified privilege names specifiedprivilegenames disaggregate to privilege names disaggregatetoprivilegenames access control manager accesscontrolmanager removed privilege names removedprivilegenames specified privilege names specifiedprivilegenames create acl node access control list accesscontrollist acl access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get policies getpolicies resource path resourcepath access control policy accesscontrolpolicy policy policies policy access control list accesscontrollist acl access control list accesscontrollist policy acl access control policy iterator accesscontrolpolicyiterator applicable policies applicablepolicies access control manager accesscontrolmanager get applicable policies getapplicablepolicies resource path resourcepath applicable policies applicablepolicies has next hasnext access control policy accesscontrolpolicy policy applicable policies applicablepolicies next access control policy nextaccesscontrolpolicy policy access control list accesscontrollist acl access control list accesscontrollist policy acl repository exception repositoryexception acl resource resource path resourcepath logging privilege old grants oldgrants privilege old denies olddenies log is debug enabled isdebugenabled old grants oldgrants hash set hashset privilege old denies olddenies hash set hashset privilege combine existing ace s aces target principal access control entry accesscontrolentry access control entries accesscontrolentries acl get access control entries getaccesscontrolentries access control entries accesscontrolentries length access control entry accesscontrolentry ace access control entries accesscontrolentries principal equals ace get principal getprincipal log is debug enabled isdebugenabled log debug existing ace principal resource object principal get name getname resource path resourcepath order order length order track original ace position order string value of valueof is allow isallow is allow isallow ace privilege privileges ace get privileges getprivileges log is debug enabled isdebugenabled is allow isallow old grants oldgrants add all addall arrays as list aslist privileges old denies olddenies add all addall arrays as list aslist privileges privilege privilege privileges string main tained privileges maintainedprivileges disaggregate to privilege names disaggregatetoprivilegenames privilege existing privilege main tain maintain main tained privileges maintainedprivileges remove all removeall specified privilege names specifiedprivilegenames conflicts preserve original main tained privileges maintainedprivileges clear main tained privileges maintainedprivileges add privilege get name getname main tained privileges maintainedprivileges is empty isempty is allow isallow new granted privilege names newgrantedprivilegenames add all addall main tained privileges maintainedprivileges new denied privilege names newdeniedprivilegenames add all addall main tained privileges maintainedprivileges remove ace acl remove access control entry removeaccesscontrolentry ace add fresh ace granted privileges list privilege granted privilege list grantedprivilegelist array list arraylist privilege string new granted privilege names newgrantedprivilegenames privilege privilege access control manager accesscontrolmanager privilege from name privilegefromname granted privilege list grantedprivilegelist add privilege granted privilege list grantedprivilegelist size acl add access control entry addaccesscontrolentry principal granted privilege list grantedprivilegelist to array toarray privilege granted privilege list grantedprivilegelist size add fresh ace denied privileges list privilege denied privilege list deniedprivilegelist array list arraylist privilege string new denied privilege names newdeniedprivilegenames privilege privilege access control manager accesscontrolmanager privilege from name privilegefromname denied privilege list deniedprivilegelist add privilege denied privilege list deniedprivilegelist size add entry addentry acl principal denied privilege list deniedprivilegelist to array toarray privilege denied privilege list deniedprivilegelist size order acl reorder access control entries reorderaccesscontrolentries acl principal order access control manager accesscontrolmanager set policy setpolicy resource path resourcepath acl log is debug enabled isdebugenabled list string old granted names oldgrantednames array list arraylist string old grants oldgrants size privilege privilege old grants oldgrants old granted names oldgrantednames add privilege get name getname list string old denied names olddeniednames array list arraylist string old denies olddenies size privilege privilege old denies olddenies old denied names olddeniednames add privilege get name getname log debug updated ace principal name principalname resource grants denies grants denies object principal get name getname resource path resourcepath old granted names oldgrantednames old denied names olddeniednames new granted privilege names newgrantedprivilegenames new denied privilege names newdeniedprivilegenames access control entry accesscontrolentry methods returns access control entry accesscontrolentry represents allowed rights represents denied rights is allow isallow access control entry accesscontrolentry ace repository exception repositoryexception safe invoke repo method safeinvokerepomethod ace method jackrabbit ace internal ref lection reflection invoke repository method suppress warnings suppresswarnings unchecked safe invoke repo method safeinvokerepomethod object target string method name methodname return type returntype object args args types argstypes unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception method target get class getclass get method getmethod method name methodname args types argstypes is accessible isaccessible set accessible setaccessible invoke target args invocation target exception invocationtargetexception ite throwable ite get cause getcause unsupported repository operation exception unsupportedrepositoryoperationexception unsupported repository operation exception unsupportedrepositoryoperationexception access denied exception accessdeniedexception access denied exception accessdeniedexception access control exception accesscontrolexception access control exception accesscontrolexception repository exception repositoryexception repository exception repositoryexception runtime exception runtimeexception runtime exception runtimeexception error error repository exception repositoryexception method name methodname throwable repository exception repositoryexception method name methodname safe invoke repo method safeinvokerepomethod object target string method name methodname return type returntype object args unsupported repository operation exception unsupportedrepositoryoperationexception repository exception repositoryexception safe invoke repo method safeinvokerepomethod target method name methodname return type returntype args unwrap jackrabbit session jackrabbit session jackrabbitsession get jackrabbit session getjackrabbitsession session session session jackrabbit session jackrabbitsession jackrabbit session jackrabbitsession session helper routine transform input array privilege names safe adding disaggregated privileges input string disaggregate to privilege names disaggregatetoprivilegenames access control manager accesscontrolmanager access control manager accesscontrolmanager string privilege names privilegenames string disaggregated privilege names disaggregatedprivilegenames repository exception repositoryexception string original privilege names originalprivilegenames hash set hashset string privilege names privilegenames string privilege name privilegename privilege names privilegenames original privilege names originalprivilegenames add privilege name privilegename privilege privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege name privilegename disaggregated privilege names disaggregatedprivilegenames add all addall disaggregate to privilege names disaggregatetoprivilegenames privilege original privilege names originalprivilegenames transform aggregated privilege disaggregated privilege names privilege aggregate original string disaggregate to privilege names disaggregatetoprivilegenames privilege privilege string disaggregated privilege names disaggregatedprivilegenames hash set hashset string privilege is aggregate isaggregate privilege privileges privilege get aggregate privileges getaggregateprivileges privilege disaggregate privileges disaggregate is aggregate isaggregate nested aggregate skip privileges included disaggregated privilege names disaggregatedprivilegenames add disaggregate get name getname disaggregated privilege names disaggregatedprivilegenames add privilege get name getname disaggregated privilege names disaggregatedprivilegenames move ace principal position order parameter param acl acl node ace position param principal user group ace position param order access control entry list table place target ace siblings place target ace siblings xyz place target ace sibling xyz xyz place target ace sibling xyz numeric place target ace table repository exception repositoryexception unsupported repository operation exception unsupportedrepositoryoperationexception access control exception accesscontrolexception reorder access control entries reorderaccesscontrolentries access control list accesscontrollist acl principal principal string order repository exception repositoryexception order order length acl jackrabbit access control list jackrabbitaccesscontrollist jackrabbit access control list jackrabbitaccesscontrollist jacl jackrabbit access control list jackrabbitaccesscontrollist acl access control entry accesscontrolentry access control entries accesscontrolentries jacl get access control entries getaccesscontrolentries access control entries accesscontrolentries length ace reorder access control entry accesscontrolentry before entry beforeentry equals order before entry beforeentry access control entries accesscontrolentries equals order before entry beforeentry order starts with startswith string before principal name beforeprincipalname order substring find ace principal access control entries accesscontrolentries length before principal name beforeprincipalname equals access control entries accesscontrolentries get principal getprincipal get name getname before entry beforeentry access control entries accesscontrolentries before entry beforeentry didn find ace matched principal illegal argument exception illegalargumentexception ace principal before principal name beforeprincipalname order starts with startswith string after principal name afterprincipalname order substring find ace principal access control entries accesscontrolentries length after principal name afterprincipalname equals access control entries accesscontrolentries get principal getprincipal get name getname ace ace access control entries accesscontrolentries length list before entry beforeentry before entry beforeentry access control entries accesscontrolentries before entry beforeentry didn find ace matched principal illegal argument exception illegalargumentexception ace principal after principal name afterprincipalname integer parse int parseint order access control entries accesscontrolentries length invalid index out of bounds exception indexoutofboundsexception large before entry beforeentry access control entries accesscontrolentries principal principal ace s aces deny grant comp ensate compensate principal processed principals processedprincipals hash set hashset principal access control entries accesscontrolentries length principal principal access control entries accesscontrolentries get principal getprincipal processed principals processedprincipals size processed principals processedprincipals principal correct position list before entry beforeentry access control entries accesscontrolentries processed principals processedprincipals add principal number format exception numberformatexception nfe illegal argument exception illegalargumentexception illegal order parameter order position access control entries accesscontrolentries length access control entry accesscontrolentry ace access control entries accesscontrolentries principal equals ace get principal getprincipal ace principal jacl order before orderbefore ace before entry beforeentry illegal argument exception illegalargumentexception acl instance jackrabbit access control list jackrabbitaccesscontrollist
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling junit impl java net url java util array list arraylist java util enumeration java util hash map hashmap java util list java util map java util regex pattern java util regex pattern syntax exception patternsyntaxexception org apache felix scr annotations component org apache felix scr annotations service org apache sling junit tests provider testsprovider org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework bundle event bundleevent org osgi framework bundle listener bundlelistener org osgi framework constants org osgi service component component context componentcontext org slf logger org slf logger factory loggerfactory test provider testprovider test classes bundles sling test regexp header exported classes component service bundle tests provider bundletestsprovider tests provider testsprovider bundle listener bundlelistener logger log logger factory loggerfactory get logger getlogger get class getclass last modified lastmodified bundle context bundlecontext bundle context bundlecontext string pid string sling test regexp sling test regexp symbolic names bundles changed empty adjust list tests list string changed bundles changedbundles array list arraylist string list candidate test classes keyed bundle update easily bundles map string list string test classes map testclassesmap hash map hashmap string list string activate component context componentcontext ctx bundle context bundlecontext ctx get bundle context getbundlecontext bundle context bundlecontext add bundle listener addbundlelistener init ially initially bundles changed bundle bundle context bundlecontext get bundles getbundles get sling test regexp getslingtestregexp changed bundles changedbundles add get symbolic name getsymbolicname log debug test classes bundle get symbolic name getsymbolicname last modified lastmodified system current time millis currenttimemillis pid string ctx get properties getproperties constants service pid deactivate component context componentcontext ctx bundle context bundlecontext remove bundle listener removebundlelistener bundle context bundlecontext changed bundles changedbundles clear override string to string tostring get class getclass get simple name getsimplename pid pid update test classes testclasses bundle require may be update test classes maybeupdatetestclasses changed bundles changedbundles is empty isempty list bundles changed list string bundles to update bundlestoupdate array list arraylist string changed bundles changedbundles bundles to update bundlestoupdate add all addall changed bundles changedbundles changed bundles changedbundles clear remove test classes belong changed bundles string symbolic name symbolicname bundles to update bundlestoupdate test classes map testclassesmap remove symbolic name symbolicname test classes bundles list bundle bundle context bundlecontext get bundles getbundles bundles to update bundlestoupdate get symbolic name getsymbolicname list string test classes testclasses get test classes gettestclasses test classes testclasses test classes map testclassesmap get symbolic name getsymbolicname test classes testclasses log debug test classes bundle list test classes testclasses size get symbolic name getsymbolicname log debug test classes bundle get symbolic name getsymbolicname called bundle bundle changed bundlechanged bundle event bundleevent event bundles tests bundle event get bundle getbundle get sling test regexp getslingtestregexp log debug bundle header get symbolic name getsymbolicname sling test regexp changed bundles changedbundles log debug bundle event bundleevent bundle rebuild lists tests changed bundles changedbundles add get symbolic name getsymbolicname last modified lastmodified system current time millis currenttimemillis string get sling test regexp getslingtestregexp bundle string get headers getheaders sling test regexp test classes bundle felix sig il sigil list string get test classes gettestclasses bundle list string result array list arraylist string pattern test class regexp testclassregexp string header value headervalue get sling test regexp getslingtestregexp test class regexp testclassregexp pattern compile header value headervalue pattern syntax exception patternsyntaxexception pse log warn invalid pattern header value headervalue bundle get symbolic name getsymbolicname pse test class regexp testclassregexp log info bundle header test classes sling test regexp bundle active get state getstate log info bundle active test classes considered get symbolic name getsymbolicname suppress warnings suppresswarnings unchecked enumeration url class urls classurls find entries findentries class urls classurls has more elements hasmoreelements url url class urls classurls next element nextelement string to class name toclassname url test class regexp testclassregexp matcher matches result add log debug match pattern bundle object sling test regexp test class regexp testclassregexp get symbolic name getsymbolicname log info test classes bundle result size get symbolic name getsymbolicname result convert url string to class name toclassname url url string url get file getfile string substring length length replace find bundle symbolic bundle find bundle findbundle string symbolic name symbolicname bundle bundle context bundlecontext get bundles getbundles get symbolic name getsymbolicname equals symbolic name symbolicname inherit doc inheritdoc create test class createtestclass string test name testname class not found exception classnotfoundexception find bundle belongs bundle map entry string list string test classes map testclassesmap entry set entryset get value getvalue test name testname find bundle findbundle get key getkey illegal argument exception illegalargumentexception bundle sup plies supplies test test name testname load class loadclass test name testname inherit doc inheritdoc last modified lastmodified last modified lastmodified inherit doc inheritdoc string get service pid getservicepid pid inherit doc inheritdoc list string get test names gettestnames may be update test classes maybeupdatetestclasses list string result array list arraylist string list string list test classes map testclassesmap values result add all addall list result
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core impl java io exception ioexception java unsupported encoding exception unsupportedencodingexception javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache commons code c codec binary base org apache sling core auth util authutil org apache sling core spi authentication handler authenticationhandler org apache sling core spi authentication info authenticationinfo org apache sling core spi default authentication feedback handler defaultauthenticationfeedbackhandler org slf logger org slf logger factory loggerfactory code http basic authentication handler httpbasicauthenticationhandler code supports plain http basic authentication link extract credentials extractcredentials http servlet request httpservletrequest accesses header called link request credentials requestcredentials http servlet request httpservletrequest http servlet response httpservletresponse link drop credentials dropcredentials http servlet request httpservletrequest http servlet response httpservletresponse methods explicitly enabled send unauthorized reply force client http basic authentication extract credentials act ively actively request easy tools curl libraries apache httpclient preemptively authenticate http basic authentication http basic authentication handler httpbasicauthenticationhandler default authentication feedback handler defaultauthenticationfeedbackhandler authentication handler authenticationhandler string header authenticate authenticate string header authorization authorization string authentication scheme basic basic log logger log logger factory loggerfactory get logger getlogger get class getclass realm send response string realm authentication handler fully enabled sends resp onses responses link request credentials requestcredentials http servlet request httpservletrequest http servlet response httpservletresponse link drop credentials dropcredentials http servlet request httpservletrequest http servlet response httpservletresponse methods full support fullsupport http basic authentication handler httpbasicauthenticationhandler string realm full support fullsupport realm realm full support fullsupport full support fullsupport authentication handler authenticationhandler returns credential http basic authentication header code code credentials link authentication handler authenticationhandler request login parameter request parameter request attribute link authentication handler authenticationhandler request login parameter request parameter request attribute response client method returns link authentication info authenticationinfo handler started credentials requesting param request request object authentication param response response object send request failure user valid credentials instance identifying request user handler authentication transaction client request authentication method requesting client provide credentials authentication info authenticationinfo extract credentials extractcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response extract credentials authentication info authenticationinfo info extract credentials extractcredentials request info info credentials check client login force authentication forceauthentication request response authentication info authenticationinfo special header authenticate called sling authenticator slingauthenticator login method authentication handler request credentials client http basic authentication handler send link send unauthorized sendunauthorized http servlet response httpservletresponse response request http basic authentication client full support configured link http basic authentication handler httpbasicauthenticationhandler string constructor param request request object param response response object send request code code full support enabled response full support enabled code code returned request credentials requestcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response full support fullsupport send unauthorized sendunauthorized response s ends sends unauthorized response request authorization header handler configured send response response request drop credentials full support enabled link http basic authentication handler httpbasicauthenticationhandler string constructor note sending unauthorized response gen erally generally save remove http basic credentials browser cache nasty side browser login form displayed reaction unauthorized response drop credentials dropcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response full support fullsupport request get header getheader header authorization send unauthorized sendunauthorized response called credentials extracted link extract credentials extractcredentials http servlet request httpservletrequest http servlet response httpservletresponse method valid sends unauthorized response requesting credentials browser client general forget ting forgetting current credentials sending credentials sending response browser sends credentials assumption method unconditionally sending unauthorized response method called request invalid http basic credentials request link auth util authutil is validate request isvalidaterequest http servlet request httpservletrequest validation request method expected forbidden response override authentication failed authenticationfailed http servlet request httpservletrequest request http servlet response httpservletresponse response authentication info authenticationinfo auth info authinfo auth util authutil is validate request isvalidaterequest request send unauthorized sendunauthorized response returns link request login parameter parameter request attribute code code method returns code code parameter request attribute client wanted login authentication handler handle request fallback handler request http basic credentials param request request object providing parameter attribute code code link authentication handler authenticationhandler request login parameter parameter attribute is login requested isloginrequested http servlet request httpservletrequest request auth util authutil get attribute or parameter getattributeorparameter request request login parameter link request login parameter parameter method sends status code code unauthorized code authenticate code requesting standard http header authentication code basic code scheme configured realm response committed error message log ged logged status code code returned request parameter response committed error occurred sending status response situations log ged logged errors param request request object param response response object send request code code unauthorized method force authentication forceauthentication http servlet request httpservletrequest request http servlet response httpservletresponse response presume unauthorized authentication for ced authenticationforced is login requested isloginrequested request authentication for ced authenticationforced send unauthorized sendunauthorized response log debug force authentication forceauthentication for cing forcing authentication request parameter request login parameter unauthorized authentication for ced authenticationforced s ends sends status code code unauthorized code authenticate code requesting standard http header authentication code basic code scheme configured realm param response response object send request code code unauthorized method response committed send unauthorized sendunauthorized http servlet response httpservletresponse response response is committed iscommitted log error send unauthorized sendunauthorized send unauthorized response committed response reset buffer resetbuffer todo check redirect request targeted registration path handler selected redirect registration path resource attribute parameter current url resource parameter redirect setting sling auth request login authrequestlogin parameter basic response registration path redirect actual path status called error handler send error senderror result error handler loop response set status setstatus http servlet response httpservletresponse unauthorized response set header setheader header authenticate authentication scheme basic realm realm response flush buffer flushbuffer io exception ioexception ioe log error send unauthorized sendunauthorized failed requesting authentication ioe override string to string tostring http basic authentication handler full support fullsupport enabled preemptive internal extract base authentication string request authentication info authenticationinfo extract credentials extractcredentials http servlet request httpservletrequest request header missing string auth header authheader request get header getheader header authorization auth header authheader auth header authheader length auth type authtype basic digest auth info authinfo user password header auth header authheader auth header authheader trim blank auth header authheader index of indexof blank string auth type authtype auth header authheader substring blank string auth info authinfo auth header authheader substring blank trim check authorization type matches auth type authtype equals ignore case equalsignorecase authentication scheme basic base decode split colon base iso encoding iso required api spec string decoded encoded auth info authinfo get bytes getbytes iso bytes base decode base decodebase encoded decoded string bytes iso unsupported encoding exception unsupportedencodingexception uee log error extract authentication extractauthentication decode authentication info uee col idx colidx decoded index of indexof string user id userid password col idx colidx user id userid decoded password user id userid decoded substring col idx colidx password decoded substring col idx colidx to char array tochararray authentication info authenticationinfo http servlet request httpservletrequest basic user id userid password
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue java io exception ioexception java util array list arraylist java util list javax servlet http http servlet response httpservletresponse org apache commons http client httpclient header org apache commons http client httpclient http method httpmethod org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient methods post method postmethod org apache sling commons testing int egration integration http test httptest org junit org junit org junit test test response code authentication request depending request parameters headers including validate ajax detection browser client detection selector authentication response code test selectorauthenticationresponsecodetest http test httptest http test httptest setup exception set up setup cleanup exception tear down teardown method assumes selector bundle test test with accept header incorrect credentials testwithacceptheaderincorrectcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage simulate browser request list header headers array list arraylist header headers add header user agent mozilla sling int egration integration test http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse moved temp orarily temporarily params headers string location post get response header getresponseheader location get value getvalue assert not null assertnotnull location assert true asserttrue location starts with startswith http test httptest http base url system sling selector login assert true asserttrue location resource assert true asserttrue location reason invalid credentials todo move method commons testing http method httpmethod assert post status assertpoststatus string url expected status code expectedstatuscode list name value pair namevaluepair post params postparams list header headers string assert message assertmessage io exception ioexception post method postmethod post post method postmethod url post set follow redirects setfollowredirects headers header header headers post add request header addrequestheader header post params postparams name value pair namevaluepair nvp post set request body setrequestbody post params postparams to array toarray nvp status get http client gethttpclient execute method executemethod post assert message assertmessage assert equals assertequals expected status code expectedstatuscode status assert equals assertequals assert message assertmessage expected status code expectedstatuscode status post
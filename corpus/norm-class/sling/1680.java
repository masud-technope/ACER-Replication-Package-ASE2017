licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest servlets post java io exception ioexception java util array list arraylist java util hash map hashmap java util list java util map javax servlet http http servlet response httpservletresponse org apache commons http client httpclient name value pair namevaluepair org apache sling commons json json object jsonobject org apache sling commons testing int egration integration http status code exception httpstatuscodeexception org apache sling commons testing int egration integration http test base httptestbase org apache sling servlets post sling post constants slingpostconstants test node move microjax post servlet microjaxpostservlet post servlet move test postservletmovetest http test base httptestbase string test base path sling move tests override set up setup exception set up setup test move node absolute testmovenodeabsolute io exception ioexception string test path testpath test base path abs system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest test path testpath dest test client testclient create node createnode http base url test path testpath src props content location string content get content getcontent http base url test path testpath dest json content type json assert java script assertjavascript content println data text content location assert http status asserthttpstatus http base url test path testpath src json http servlet response httpservletresponse expected content test move node absolute below dest testmovenodeabsolutebelowdest io exception ioexception string test path testpath test base path abs system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props test failure dest parent exist list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest assert post status assertpoststatus http base url test path testpath src http servlet response httpservletresponse precondition failed nv pairs nvpairs expecting move failure dest exist create dest parent test client testclient create node createnode http base url test path testpath dest move succeeds dest assert post status assertpoststatus http base url test path testpath src http servlet response httpservletresponse created nv pairs nvpairs expecting move success content location string content get content getcontent http base url test path testpath dest json content type json assert java script assertjavascript content println data src text content location assert http status asserthttpstatus http base url test path testpath src json http servlet response httpservletresponse test move node relative testmovenoderelative io exception ioexception string test path testpath test base path rel system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest dest test client testclient create node createnode http base url test path testpath src props string content get content getcontent http base url test path testpath dest json content type json assert java script assertjavascript content println data text test move node existing fail testmovenodeexistingfail io exception ioexception string test path testpath test base path exist system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props create dest node props text destination test client testclient create node createnode http base url test path testpath dest props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest test path testpath dest test client testclient create node createnode http base url test path testpath props http status code exception httpstatuscodeexception hsce hsce get actual status getactualstatus hsce expect unmodified dest string content get content getcontent http base url test path testpath dest json content type json assert java script assertjavascript destination content println data text test move node existing replace testmovenodeexistingreplace io exception ioexception string test path testpath test base path replace system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props create dest node props text destination test client testclient create node createnode http base url test path testpath dest props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest test path testpath dest props sling post constants slingpostconstants replace test client testclient create node createnode http base url test path testpath src props string content get content getcontent http base url test path testpath dest json content type json assert java script assertjavascript content println data text test move node deep relative testmovenodedeeprelative io exception ioexception string test path testpath test base path system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest deep test client testclient create node createnode http base url test path testpath src props fail moving node existing parent location fail http status code exception httpstatuscodeexception hsce hsce get actual status getactualstatus hsce test move node deep absolute testmovenodedeepabsolute io exception ioexception string test path testpath test base path fail system current time millis currenttimemillis map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest existing structure test client testclient create node createnode http base url test path testpath props correct check status response fail moving node existing parent location fail http status code exception httpstatuscodeexception hsce hsce get actual status getactualstatus hsce test move node multiple source valid testmovenodemultiplesourcevalid io exception ioexception string test path testpath test base path mvmult system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src assert post status assertpoststatus test root testroot http servlet response httpservletresponse precondition failed nv pairs nvpairs expecting move failure dest parent exist create destination parent test client testclient create node createnode http base url test path testpath dest props dest exists expect success assert post status assertpoststatus test root testroot http servlet response httpservletresponse nv pairs nvpairs expecting move success existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse test client testclient delete test root testroot test move node multiple source in valid testmovenodemultiplesourceinvalid io exception ioexception string test path testpath test base path mvmult system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src assert post status assertpoststatus test root testroot http servlet response httpservletresponse internal server error nv pairs nvpairs expecting move failure dest trailing slash create destination parent test client testclient create node createnode http base url test path testpath dest props retest creating test assert post status assertpoststatus test root testroot http servlet response httpservletresponse precondition failed nv pairs nvpairs expecting move failure dest exists existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse test client testclient delete test root testroot test move node multiple source partial testmovenodemultiplesourcepartial io exception ioexception string test path testpath test base path mvmult system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src assert post status assertpoststatus test root testroot http servlet response httpservletresponse precondition failed nv pairs nvpairs expecting move failure dest parent exist create destination parent test client testclient create node createnode http base url test path testpath dest props dest exists expect success assert post status assertpoststatus test root testroot http servlet response httpservletresponse nv pairs nvpairs expecting move success partial existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath src html http servlet response httpservletresponse test client testclient delete test root testroot test move node multiple source replace testmovenodemultiplesourcereplace exception string test path testpath test base path mvmult system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath src props test client testclient create node createnode http base url test path testpath src props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src assert post status assertpoststatus test root testroot http servlet response httpservletresponse precondition failed nv pairs nvpairs expecting move failure dest parent exist create destination parent test client testclient create node createnode http base url test path testpath dest dest exists expect success assert post status assertpoststatus test root testroot http servlet response httpservletresponse nv pairs nvpairs expecting move success partial existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse content test string content get content getcontent http base url test path testpath dest src json content type json json object jsonobject json json object jsonobject content assert equals assertequals json text modify src content nv pairs nvpairs clear nv pairs nvpairs add name value pair namevaluepair text modified assert post status assertpoststatus http base url test path testpath src http servlet response httpservletresponse created nv pairs nvpairs expect content create success move src nodes nv pairs nvpairs clear nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test path testpath src assert post status assertpoststatus test root testroot http servlet response httpservletresponse nv pairs nvpairs expecting move success content test string content get content getcontent http base url test path testpath dest src json content type json json object jsonobject json json object jsonobject content assert equals assertequals modified json text clean test client testclient delete test root testroot test move a t root testmoveatroot io exception ioexception string path a patha get class getclass get simple name getsimplename string path b pathb get class getclass get simple name getsimplename string test text testtext math random map string string props hash map hashmap string string props text test text testtext create path a patha test client testclient delete http base url path a patha assert http status asserthttpstatus http base url path a patha http servlet response httpservletresponse test client testclient create node createnode http base url path a patha props move path b pathb test client testclient delete http base url path b pathb assert http status asserthttpstatus http base url path b pathb http servlet response httpservletresponse props clear props sling post constants slingpostconstants operation sling post constants slingpostconstants operation move props sling post constants slingpostconstants dest path b pathb props sling post constants slingpostconstants replace test client testclient create node createnode http base url path a patha props string content get content getcontent http base url path b pathb json content type json assert java script assertjavascript test text testtext content println data text assert http status asserthttpstatus http base url path a patha http servlet response httpservletresponse test sling ability move child nodes parent node apply to applyto test move all children testmoveallchildren io exception ioexception string test path testpath test base path mvmultwc system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props create destination parent test client testclient create node createnode http base url test path testpath dest props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply expect success assert post status assertpoststatus test root testroot test http servlet response httpservletresponse nv pairs nvpairs expecting move success existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse test client testclient delete test root testroot test sling ability move child nodes parent node apply to applyto test move all children by path testmoveallchildrenbypath io exception ioexception string test path testpath test base path mvmultwc system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props create destination parent test client testclient create node createnode http base url test path testpath dest props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply expect success assert post status assertpoststatus test root testroot test http servlet response httpservletresponse nv pairs nvpairs expecting move success existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse test client testclient delete test root testroot test sling ability move child nodes sub node subnode parent node apply to applyto sub node subnode path test move all children of sub node testmoveallchildrenofsubnode io exception ioexception string test path testpath test base path mvmultwc system current time millis currenttimemillis string test root testroot test client testclient create node createnode http base url test path testpath create multiple source nodes map string string props hash map hashmap string string props text test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props test client testclient create node createnode http base url test path testpath test src props create destination parent test client testclient create node createnode http base url test path testpath dest props move src nodes list name value pair namevaluepair nv pairs nvpairs array list arraylist name value pair namevaluepair nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants operation sling post constants slingpostconstants operation move nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants dest test path testpath dest nv pairs nvpairs add name value pair namevaluepair sling post constants slingpostconstants apply test expect success assert post status assertpoststatus test root testroot http servlet response httpservletresponse nv pairs nvpairs expecting move success existence src text properties assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath dest src text http servlet response httpservletresponse existence src assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse assert http status asserthttpstatus http base url test path testpath test src html http servlet response httpservletresponse test client testclient delete test root testroot
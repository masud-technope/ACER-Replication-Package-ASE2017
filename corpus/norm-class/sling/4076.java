licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest user manager usermanager java io exception ioexception java util array list arraylist java util list javax servlet http http servlet response httpservletresponse org apache commons http client httpclient credentials org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient username password credentials usernamepasswordcredentials org apache sling commons json json array jsonarray org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject tests update authorizable updateauthorizable sling post operation group resource update group test updategrouptest user manager test util usermanagertestutil string test group id testgroupid string test user id testuserid override tear down teardown exception test user id testuserid remove test user exists string post url posturl http base url system user manager usermanager user test user id testuserid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams test group id testgroupid remove test group exists string post url posturl http base url system user manager usermanager group test group id testgroupid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams tear down teardown test update group testupdategroup io exception ioexception json exception jsonexception test group id testgroupid create test group createtestgroup string post url posturl http base url system user manager usermanager group test group id testgroupid update html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair display name displayname updated test group post params postparams add name value pair namevaluepair url http apache org updated credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams fetch user profile json verify settings string get url geturl http base url system user manager usermanager group test group id testgroupid json profile request returns data assert authenticated http status assertauthenticatedhttpstatus creds get url geturl http servlet response httpservletresponse string json get authenticated content getauthenticatedcontent creds get url geturl content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals updated test group json obj jsonobj get string getstring display name displayname assert equals assertequals http apache org updated json obj jsonobj get string getstring url test update group members testupdategroupmembers io exception ioexception json exception jsonexception test group id testgroupid create test group createtestgroup test user id testuserid create test user createtestuser credentials creds username password credentials usernamepasswordcredentials admin admin verify members array exists empty json array jsonarray members get test group members gettestgroupmembers creds assert equals assertequals members length json array jsonarray member ships memberships get test user members hips gettestusermemberships creds assert equals assertequals member ships memberships length string post url posturl http base url system user manager usermanager group test group id testgroupid update html add group member list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair member test user id testuserid assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams members get test group members gettestgroupmembers creds assert equals assertequals members length assert equals assertequals system user manager usermanager user test user id testuserid members get string getstring member ships memberships get test user members hips gettestusermemberships creds assert equals assertequals member ships memberships length assert equals assertequals system user manager usermanager group test group id testgroupid member ships memberships get string getstring delete group member post params postparams clear post params postparams add name value pair namevaluepair member delete test user id testuserid assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams members get test group members gettestgroupmembers creds assert equals assertequals members length member ships memberships get test user members hips gettestusermemberships creds assert equals assertequals member ships memberships length json array jsonarray get test user members hips gettestusermemberships credentials creds io exception ioexception json exception jsonexception string get url geturl http base url system user manager usermanager user test user id testuserid json profile request returns data assert authenticated http status assertauthenticatedhttpstatus creds get url geturl http servlet response httpservletresponse string json get authenticated content getauthenticatedcontent creds get url geturl content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json json array jsonarray member ships memberships json obj jsonobj getjsonarray member of memberof member ships memberships json array jsonarray get test group members gettestgroupmembers credentials creds io exception ioexception json exception jsonexception string get url geturl http base url system user manager usermanager group test group id testgroupid json profile request returns data assert authenticated http status assertauthenticatedhttpstatus creds get url geturl http servlet response httpservletresponse string json get authenticated content getauthenticatedcontent creds get url geturl content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json json array jsonarray members json obj jsonobj getjsonarray members members test sling test update group response as n testupdategroupresponseasjson io exception ioexception json exception jsonexception test group id testgroupid create test group createtestgroup string post url posturl http base url system user manager usermanager group test group id testgroupid update json list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair display name displayname updated test group post params postparams add name value pair namevaluepair url http apache org updated credentials creds username password credentials usernamepasswordcredentials admin admin string json get authenticated post content getauthenticatedpostcontent creds post url posturl content type json post params postparams http servlet response httpservletresponse json response parsed json object json object jsonobject json obj jsonobj json object jsonobject json assert not null assertnotnull json obj jsonobj
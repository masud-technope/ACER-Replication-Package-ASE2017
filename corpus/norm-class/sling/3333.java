licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event org junit assert equals assertequals java io exception ioexception java serializable java util array list arraylist java util collections java util dictionary java util hash map hashmap java util hashtable java util list java util map java util concurrent atomic atomic integer atomicinteger org apache sling event impl jobs config configuration constants configurationconstants org apache sling event jobs job org apache sling event jobs job manager jobmanager org apache sling event jobs notification constants notificationconstants org apache sling event jobs queue configuration queueconfiguration org apache sling event jobs consumer job consumer jobconsumer org apache sling testing tools retry retry loop retryloop org junit org junit org junit test org junit runner run with runwith org ops pax exam junit pax exam paxexam org ops pax exam spi reactors exam reactor strategy examreactorstrategy org ops pax exam spi reactors per method permethod org osgi framework service registration serviceregistration org osgi service event event org osgi service event event handler eventhandler run with runwith pax exam paxexam exam reactor strategy examreactorstrategy per method permethod class loading test classloadingtest abstract job handling test abstractjobhandlingtest condition interval millis condition timeout seconds string queue cltest string topic sling cltest string queue config pid queueconfigpid override setup io exception ioexception setup create ignore test queue org osgi service configuration ordered config orderedconfig config admin configadmin create factory configuration createfactoryconfiguration org apache sling event jobs queue configuration queueconfiguration dictionary string object ordered props orderedprops hashtable string object ordered props orderedprops configuration constants configurationconstants prop queue ordered props orderedprops configuration constants configurationconstants prop type queue configuration queueconfiguration type unordered ordered props orderedprops configuration constants configurationconstants prop topics topic ordered config orderedconfig update ordered props orderedprops queue config pid queueconfigpid ordered config orderedconfig get pid getpid sleep clean up cleanup io exception ioexception remove configuration removeconfiguration queue config pid queueconfigpid cleanup test timeout test timeout test simple class loading testsimpleclassloading exception atomic integer atomicinteger processed jobs count processedjobscount atomic integer atomicinteger list event finished events finishedevents collections synchronized list synchronizedlist array list arraylist event service registration serviceregistration jc reg jcreg register job consumer registerjobconsumer topic job consumer jobconsumer override job result jobresult process job job processed jobs count processedjobscount increment and get incrementandget job result jobresult service registration serviceregistration eh reg ehreg register event handler registereventhandler notification constants notificationconstants topic job finished event handler eventhandler override handle event handleevent event event finished events finishedevents add event job manager jobmanager job manager jobmanager get job manager getjobmanager list string list array list arraylist string list add list add event properties map eventpropertiesmap map event properties map eventpropertiesmap map map start single job map string object props hash map hashmap string object props string props integer props props list list props map map string job id jobid job manager jobmanager add job addjob topic props get id getid retry loop retryloop conditions collection is not empty condition collectionisnotemptycondition finished events finishedevents waiting finished events finishedevents element jobs queue d queued processed retry loop retryloop retry loop retryloop condition override string get description getdescription waiting job processed conditions queue d jobs queuedjobs job manager jobmanager get statistics getstatistics get number of queue d jobs getnumberofqueuedjobs jobs count jobscount processed jobs count processedjobscount find jobs findjobs job manager jobmanager find jobs findjobs job manager jobmanager query type querytype topic map string object size override is true istrue exception job manager jobmanager get statistics getstatistics get number of queue d jobs getnumberofqueuedjobs processed jobs count processedjobscount job manager jobmanager find jobs findjobs job manager jobmanager query type querytype topic map string object size condition timeout seconds condition interval millis string job topic jobtopic string finished events finishedevents get property getproperty notification constants notificationconstants not ification notification property job topic assert not null assertnotnull job topic jobtopic assert equals assertequals finished events finishedevents get property getproperty string assert equals assertequals integer integer value of valueof finished events finishedevents get property getproperty to string tostring assert equals assertequals value of valueof finished events finishedevents get property getproperty to string tostring assert equals assertequals list finished events finishedevents get property getproperty list assert equals assertequals map finished events finishedevents get property getproperty map job manager jobmanager remove job by id removejobbyid job id jobid jc reg jcreg unregister eh reg ehreg unregister test timeout test timeout test failed class loading testfailedclassloading exception atomic integer atomicinteger failed jobs count failedjobscount atomic integer atomicinteger list event finished events finishedevents collections synchronized list synchronizedlist array list arraylist event service registration serviceregistration jc reg jcreg register job consumer registerjobconsumer topic failed job consumer jobconsumer override job result jobresult process job job failed jobs count failedjobscount increment and get incrementandget job result jobresult service registration serviceregistration eh reg ehreg register event handler registereventhandler notification constants notificationconstants topic job finished event handler eventhandler override handle event handleevent event event finished events finishedevents add event job manager jobmanager job manager jobmanager get job manager getjobmanager dao invisible dynamic loader scheduling job fail data object dataobject dao data object dataobject start single job map string object props hash map hashmap string object props dao dao string job manager jobmanager add job addjob topic failed props get id getid wait conditions met retry loop retryloop retry loop retryloop condition override is true istrue exception failed jobs count failedjobscount finished events finishedevents size job manager jobmanager find jobs findjobs job manager jobmanager query type querytype topic failed map string object size job manager jobmanager get statistics getstatistics get number of queue d jobs getnumberofqueuedjobs job manager jobmanager get statistics getstatistics get number of active jobs getnumberofactivejobs override string get description getdescription waiting job failure recorded conditions fail d jobs count faildjobscount failed jobs count failedjobscount finished events finishedevents finished events finishedevents size find jobs findjobs job manager jobmanager find jobs findjobs job manager jobmanager query type querytype topic failed map string object size queue d jobs queuedjobs job manager jobmanager get statistics getstatistics get number of queue d jobs getnumberofqueuedjobs active jobs activejobs job manager jobmanager get statistics getstatistics get number of active jobs getnumberofactivejobs condition timeout seconds condition interval millis moves job history job manager jobmanager remove job by id removejobbyid assert equals assertequals job manager jobmanager find jobs findjobs job manager jobmanager query type querytype topic failed map string object size removes job per manently permanently job manager jobmanager remove job by id removejobbyid jc reg jcreg unregister eh reg ehreg unregister data object dataobject serializable serialversionuid
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr resource internal java closeable java io exception ioexception java util hash map hashmap java util hash set hashset java util map java util map entry java util java util concurrent linked blocking queue linkedblockingqueue javax jcr node javax jcr repository exception repositoryexception javax jcr observation event javax jcr observation event iterator eventiterator javax jcr observation event listener eventlistener org apache jackrabbit api observation jackrabbit event jackrabbitevent org apache sling api sling constants slingconstants org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling jcr resource internal helper jcr path mapper pathmapper org osgi service event event admin eventadmin org osgi service event event constants eventconstants org osgi service event event properties eventproperties org slf logger org slf logger factory loggerfactory code jcr resource listener jcrresourcelistener code list ens listens jcr observation events creates resource events osg i osgi event admin jcr resource listener jcrresourcelistener event listener eventlistener closeable logger logger logger logger factory loggerfactory get logger getlogger jcr resource listener jcrresourcelistener repository mounted path string mount prefix mountprefix jackrabbit event has jackrabbit event class hasjackrabbiteventclass queue osg i osgi events created link send osgi event sendosgievent string event string event admin eventadmin changed attributes changedattributes waiting actual dispatching osg i osgi event admin link process osgi event queue processosgieventqueue linked blocking queue linkedblockingqueue map string object osgi event queue osgieventqueue helper object observation listener support observationlistenersupport support path mapper pathmapper path mapper pathmapper marker event link process osgi event queue processosgieventqueue sig naled signaled terminate processing events map string object terminate processing hash map hashmap string object jcr resource listener jcrresourcelistener string mount prefix mountprefix observation listener support observationlistenersupport support path mapper pathmapper path mapper pathmapper repository exception repositoryexception path mapper pathmapper path mapper pathmapper found class foundclass get class getclass get class loader getclassloader load class loadclass jackrabbit event jackrabbitevent get name getname found class foundclass throwable has jackrabbit event class hasjackrabbiteventclass found class foundclass mount prefix mountprefix mount prefix mountprefix mount prefix mountprefix length mount prefix mountprefix equals mount prefix mountprefix support support support get session getsession get workspace getworkspace get observation manager getobservationmanager add event listener addeventlistener event node event node removed event property event property changed event property removed osgi event queue osgieventqueue linked blocking queue linkedblockingqueue map string object thread oeqt thread runnable override process osgi event queue processosgieventqueue apache sling jcr resource event queue processor oeqt start dispose listener override close io exception ioexception unregister observations support get session getsession get workspace getworkspace get observation manager getobservationmanager remove event listener removeeventlistener repository exception repositoryexception logger warn unable remove session listener drop remaining osg i osgi events processed osgi event queue osgieventqueue clear osgi event queue osgieventqueue offer terminate processing support dispose javax jcr observation event listener eventlistener on event onevent javax jcr observation event iterator eventiterator override on event onevent event iterator eventiterator events event admin skip event admin eventadmin localea support get event admin geteventadmin localea map string map string object added events addedevents hash map hashmap string map string object map string changed attributes changedattributes changed events changedevents hash map hashmap string changed attributes changedattributes map string map string object removed events removedevents hash map hashmap string map string object events has next hasnext event event events next event nextevent string event path eventpath mount prefix mountprefix event path eventpath mount prefix mountprefix event get path getpath event path eventpath event get path getpath event get type gettype event property event get type gettype event property removed event get type gettype event property changed last slash lastslash event path eventpath last index of lastindexof string node path nodepath event path eventpath substring last slash lastslash string prop name propname event path eventpath substring last slash lastslash update changed event updatechangedevent changed events changedevents node path nodepath event prop name propname event get type gettype event node added events addedevents event path eventpath create event properties createeventproperties event event get type gettype event node removed remove str ongest strongest operation remove removed paths added events addedevents remove event path eventpath removed events removedevents event path eventpath create event properties createeventproperties event repository exception repositoryexception logger error error modification get message getmessage entry string map string object removed events removedevents entry set entryset launch osg i osgi event send osgi event sendosgievent get key getkey get value getvalue sling constants slingconstants topic resource removed entry string map string object added events addedevents entry set entryset launch osg i osgi event send osgi event sendosgievent get key getkey get value getvalue sling constants slingconstants topic resource changed events changedevents remove get key getkey send changed events entry string changed attributes changedattributes changed events changedevents entry set entryset launch osg i osgi event send osgi event sendosgievent get key getkey get value getvalue to event properties toeventproperties sling constants slingconstants topic resource changed changed attributes changedattributes map string object properties changed attributes changedattributes map string object properties properties properties string added attributes addedattributes changed attributes changedattributes removed attributes removedattributes add event addevent event event string prop name propname event get type gettype event property removed attributes removedattributes removed attributes removedattributes remove prop name propname added attributes addedattributes added attributes addedattributes hash set hashset string added attributes addedattributes add prop name propname event get type gettype event property removed added attributes addedattributes added attributes addedattributes remove prop name propname removed attributes removedattributes removed attributes removedattributes hash set hashset string removed attributes removedattributes add prop name propname event get type gettype event property changed changed attributes changedattributes changed attributes changedattributes hash set hashset string changed attributes changedattributes add prop name propname merges lists changed removed properties code code properties returns object param properties code dictionary add attribute lists code properties object returned map string object merge attributes into mergeattributesinto map string object properties added attributes addedattributes properties sling constants slingconstants property attributes added attributes addedattributes to array toarray string added attributes addedattributes size changed attributes changedattributes properties sling constants slingconstants property changed attributes changed attributes changedattributes to array toarray string changed attributes changedattributes size removed attributes removedattributes properties sling constants slingconstants property removed attributes removed attributes removedattributes to array toarray string removed attributes removedattributes size properties code dictionary recorded including original jcr event map string object to event properties toeventproperties merge attributes into mergeattributesinto properties update changed event updatechangedevent map string changed attributes changedattributes changed events changedevents string path event event string prop name propname changed attributes changedattributes stored event storedevent changed events changedevents path stored event storedevent stored event storedevent changed attributes changedattributes create event properties createeventproperties event changed events changedevents path stored event storedevent stored event storedevent add event addevent event prop name propname create base osg i osgi event properties based jcr event object map string object create event properties createeventproperties event event map string object properties hash map hashmap string object is external isexternal event properties event application unknown string userid event get user d getuserid userid properties sling constants slingconstants property user id userid userid properties send osg i osgi event based jcr observation event param path path node event occurred param properties base properties event param topic topic osg i osgi event send osgi event sendosgievent string path map string object properties string topic changed attributes changedattributes changed attributes changedattributes string resource path resourcepath path mapper pathmapper map path to resource path mapjcrpathtoresourcepath path resource path resourcepath support is excluded isexcluded resource path resourcepath changed attributes changedattributes changed attributes changedattributes merge attributes into mergeattributesinto properties path changed file content properties sling constants slingconstants property path resource path resourcepath properties event constants eventconstants event topic topic enqueue event dispatching osgi event queue osgieventqueue offer properties logger error drop ping dropping observation event path called runnable method jcr event queue processor process link osgi event queue osgieventqueue link terminate processing event received process osgi event queue processosgieventqueue map string object event event osgi event queue osgieventqueue interrupted exception interruptedexception event event terminate processing event admin eventadmin local ea localea support get event admin geteventadmin resource resolver resourceresolver resolver support get resource resolver getresourceresolver local ea localea resolver string topic string event remove event constants eventconstants event topic string path string event sling constants slingconstants property path resource resource resolver get resource getresource path send event sendevent sling constants slingconstants topic resource removed equals topic resource check jcr backed resource visible node node resource adapt to adaptto node node check file nodes path ends with endswith jcr content node get parent getparent is node type isnodetype file resource parent resource parentresource resource get parent getparent parent resource parentresource resource parent resource parentresource event sling constants slingconstants property path resource get path getpath repository exception repositoryexception string resource type resourcetype resource get resource type getresourcetype resource type resourcetype event sling constants slingconstants property resource type resource get resource type getresourcetype string resource super type resourcesupertype resource get resource super type getresourcesupertype resource super type resourcesupertype event sling constants slingconstants property resource type resource get resource super type getresourcesupertype jcr backed resource send event sendevent silent not e note resolve resource logger debug process osgi event queue processosgieventqueue resource expected modified node path send event sendevent send event sendevent local ea localea send event sendevent org osgi service event event topic event properties eventproperties event exception logger warn process osgi event queue processosgieventqueue unexpected problem processing event event osgi event queue osgieventqueue clear is external isexternal event event has jackrabbit event class hasjackrabbiteventclass event jackrabbit event jackrabbitevent jackrabbit event jackrabbitevent j event jevent jackrabbit event jackrabbitevent event j event jevent is external isexternal
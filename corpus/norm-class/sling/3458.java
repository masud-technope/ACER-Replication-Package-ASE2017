licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution transport impl java byte array input stream bytearrayinputstream java input stream inputstream java net uri java util hash map hashmap java util list java util map org apache http http entity httpentity org apache http http response httpresponse org apache http status line statusline org apache http client fluent executor org apache http client fluent request org apache http client fluent response org apache sling api resource resource resolver resourceresolver org apache sling distribution distribution request distributionrequest org apache sling distribution distribution request type distributionrequesttype org apache sling distribution simple distribution request simpledistributionrequest org apache sling distribution log impl default distribution log defaultdistributionlog org apache sling distribution serialization distribution package distributionpackage org apache sling distribution serialization distribution package info distributionpackageinfo org apache sling distribution serialization distribution package builder distributionpackagebuilder org apache sling distribution transport distribution transport secret distributiontransportsecret org apache sling distribution transport distribution transport secret provider distributiontransportsecretprovider org junit ignore org junit test org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert true asserttrue org mockito matchers org mockito mockito mock org mockito mockito test case testcase link simple http distribution transport simplehttpdistributiontransport ignore simple http distribution transport test simplehttpdistributiontransporttest test test deliver package testdeliverpackage exception distribution transport secret distributiontransportsecret secret mock distribution transport secret distributiontransportsecret map string string credentials map credentialsmap hash map hashmap string string credentials map credentialsmap username foo credentials map credentialsmap password foo secret as credentials map ascredentialsmap then return thenreturn credentials map credentialsmap distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider mock distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider get secret getsecret uri then return thenreturn secret executor executor mock executor response response mock response executor execute request then return thenreturn response distribution endpoint distributionendpoint endpoint distribution endpoint distributionendpoint http resource distribution package builder distributionpackagebuilder package builder packagebuilder mock distribution package builder distributionpackagebuilder max no of packages maxnoofpackages integer max simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport mock default distribution log defaultdistributionlog endpoint package builder packagebuilder secret provider secretprovider max no of packages maxnoofpackages resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver distribution package distributionpackage distribution package distributionpackage mock distribution package distributionpackage distribution package distributionpackage get info getinfo then return thenreturn distribution package info distributionpackageinfo type input stream inputstream stream mock input stream inputstream distribution package distributionpackage create input stream createinputstream then return thenreturn stream simple http distribution transport simplehttpdistributiontransport deliver package deliverpackage resource resolver resourceresolver distribution package distributionpackage test test retrieve packages remotely failing testretrievepackagesremotelyfailing exception distribution transport secret distributiontransportsecret secret mock distribution transport secret distributiontransportsecret map string string credentials map credentialsmap hash map hashmap string string credentials map credentialsmap username foo credentials map credentialsmap password foo secret as credentials map ascredentialsmap then return thenreturn credentials map credentialsmap distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider mock distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider get secret getsecret uri then return thenreturn secret executor executor mock executor response response mock response http response httpresponse http response httpresponse mock http response httpresponse status line statusline status line statusline mock status line statusline status line statusline get status code getstatuscode then return thenreturn http response httpresponse get status line getstatusline then return thenreturn status line statusline response return response returnresponse then return thenreturn http response httpresponse executor execute request then return thenreturn response distribution endpoint distributionendpoint endpoint distribution endpoint distributionendpoint http resource distribution package builder distributionpackagebuilder package builder packagebuilder mock distribution package builder distributionpackagebuilder max no of packages maxnoofpackages simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport mock default distribution log defaultdistributionlog endpoint package builder packagebuilder secret provider secretprovider max no of packages maxnoofpackages resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver distribution request distributionrequest distribution request distributionrequest simple distribution request simpledistributionrequest distribution request type distributionrequesttype add list distribution package distributionpackage packages simple http distribution transport simplehttpdistributiontransport retrieve packages retrievepackages resource resolver resourceresolver distribution request distributionrequest assert not null assertnotnull packages assert true asserttrue packages is empty isempty test test retrieve packages remotely working testretrievepackagesremotelyworking exception distribution transport secret distributiontransportsecret secret mock distribution transport secret distributiontransportsecret map string string credentials map credentialsmap hash map hashmap string string credentials map credentialsmap username foo credentials map credentialsmap password foo secret as credentials map ascredentialsmap then return thenreturn credentials map credentialsmap distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider mock distribution transport secret provider distributiontransportsecretprovider secret provider secretprovider get secret getsecret uri then return thenreturn secret executor executor mock executor response response mock response http response httpresponse http response httpresponse mock http response httpresponse status line statusline status line statusline mock status line statusline status line statusline get status code getstatuscode then return thenreturn http response httpresponse get status line getstatusline then return thenreturn status line statusline http entity httpentity entity mock http entity httpentity input stream inputstream stream byte array input stream bytearrayinputstream binary stuff get bytes getbytes utf entity get content getcontent then return thenreturn stream http response httpresponse get entity getentity then return thenreturn entity response return response returnresponse then return thenreturn http response httpresponse executor execute request then return thenreturn response distribution endpoint distributionendpoint endpoint distribution endpoint distributionendpoint http resource distribution package builder distributionpackagebuilder package builder packagebuilder mock distribution package builder distributionpackagebuilder distribution package distributionpackage distribution package distributionpackage mock distribution package distributionpackage distribution package distributionpackage get info getinfo then return thenreturn distribution package info distributionpackageinfo type package builder packagebuilder read package readpackage resource resolver resourceresolver input stream inputstream then return thenreturn distribution package distributionpackage max no of packages maxnoofpackages simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport simple http distribution transport simplehttpdistributiontransport mock default distribution log defaultdistributionlog endpoint package builder packagebuilder secret provider secretprovider max no of packages maxnoofpackages resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver distribution request distributionrequest distribution request distributionrequest simple distribution request simpledistributionrequest distribution request type distributionrequesttype add list distribution package distributionpackage packages simple http distribution transport simplehttpdistributiontransport retrieve packages retrievepackages resource resolver resourceresolver distribution request distributionrequest assert not null assertnotnull packages assert false assertfalse packages is empty isempty assert equals assertequals packages size assert not null assertnotnull packages
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling cassandra resource provider org apache commons code c codec binary base prettyprint cassandra model cql query cqlquery prettyprint cassandra model cql rows cqlrows prettyprint cassandra serialize rs serializers string serializer stringserializer prettyprint cassandra service thrift ks def thriftksdef prettyprint hector api cluster prettyprint hector api key space keyspace prettyprint hector api ddl column family definition columnfamilydefinition prettyprint hector api ddl comparator type comparatortype prettyprint hector api ddl key space definition keyspacedefinition prettyprint hector api exceptions h invalid request exception hinvalidrequestexception prettyprint hector api factory h factory hfactory prettyprint hector api query query result queryresult org apache felix scr annotations org apache sling api resource org apache sling cassandra resource provider mapper cassandra mapper cassandramapper org apache sling cassandra resource provider mapper default cassandra mapper impl defaultcassandramapperimpl org apache sling cassandra resource provider util cassandra resource provider util cassandraresourceproviderutil org slf logger org slf logger factory loggerfactory java unsupported encoding exception unsupportedencodingexception java security message digest messagedigest java security no such algorithm exception nosuchalgorithmexception java util hash map hashmap java util map java util concurrent concurrent hash map concurrenthashmap java util arrays java util iterator component metatype service resource provider resourceprovider properties property provider roots content cassandra cassandra resource provider cassandraresourceprovider resource provider resourceprovider modifying resource provider modifyingresourceprovider cluster cluster key space keyspace key space keyspace string pictures replication factor replicationfactor string key space keyspace sling cassandra string cassandra localhost concurrent hash map concurrenthashmap string cassandra mapper cassandramapper cassandra mapper map cassandramappermap concurrent hash map concurrenthashmap string cassandra mapper cassandramapper logger logger logger factory loggerfactory get logger getlogger cassandra resource provider cassandraresourceprovider map string value map valuemap cassandra map hash map hashmap string value map valuemap map string map create map hash map hashmap string map map string map delete map hash map hashmap string map cassandra resource provider cassandraresourceprovider init key space keyspace get key space getkeyspace key space keyspace set column family setcolumnfamily string init system println provider init cluster h factory hfactory get or create cluster getorcreatecluster cassandra constants cassandraconstants cassandra cluster cassandra key space definition keyspacedefinition key space def keyspacedef cluster describe key space describekeyspace key space keyspace key space def keyspacedef create schema createschema cluster exception ignore system println ignoring exception create existing schema ignore get message getmessage logger debug ignoring exception create existing schema ignore get message getmessage key space keyspace h factory hfactory create key space createkeyspace key space keyspace cluster system println provider init resource get resource getresource resource resolver resourceresolver resource resolver resourceresolver javax servlet http http servlet request httpservletrequest http servlet request httpservletrequest string get resource getresource resource resolver resourceresolver resource get resource getresource resource resolver resourceresolver resource resolver resourceresolver string pop ulating populating map cassandra map pers mappers starts with startswith equals content cassandra split length cassandra resource cassandraresource resource resolver resourceresolver cassandra resource cassandraresource cassandra value map cassandravaluemap hash map hashmap string object system println cassandra map cassandra resource provider util cassandraresourceproviderutil get column family sector getcolumnfamilysector get cassandra mapper map getcassandramappermap contains key containskey cassandra resource provider util cassandraresourceproviderutil get column family sector getcolumnfamilysector get cassandra mapper map getcassandramappermap cassandra resource provider util cassandraresourceproviderutil get column family sector getcolumnfamilysector default cassandra mapper impl defaultcassandramapperimpl cassandra resource cassandraresource resource resolver resourceresolver cassandra map cassandra resource provider util cassandraresourceproviderutil is resource exists isresourceexists key space keyspace cassandra resource cassandraresource resource resolver resourceresolver cassandra map exception system println error provider get message getmessage logger error error provider get message getmessage logger debug get message getmessage iterator resource list children listchildren resource resource resource list children listchildren create schema createschema cluster my cluster mycluster column family definition columnfamilydefinition cf def cfdef h factory hfactory create column family definition createcolumnfamilydefinition key space keyspace comparator type comparatortype bytes type bytestype key space definition keyspacedefinition new key space newkeyspace h factory hfactory create key space definition createkeyspacedefinition key space keyspace thrift ks def thriftksdef def strategy replication factor replicationfactor arrays as list aslist cf def cfdef my cluster mycluster add key space addkeyspace new key space newkeyspace concurrent hash map concurrenthashmap string cassandra mapper cassandramapper get cassandra mapper map getcassandramappermap cassandra mapper map cassandramappermap define cassandra definecassandra content cassandra define cassandra definecassandra content cassandra define cassandra definecassandra content cassandra load map with test data loadmapwithtestdata load map with test data loadmapwithtestdata string nodes string string node nodes exercise count exercisecount test count testcount string path content cassandra node exercise count exercisecount define cassandra definecassandra path exercise count exercisecount test count testcount define cassandra definecassandra path test count testcount value map valuemap define cassandra definecassandra string path value map valuemap value map valuemap cassandra resource cassandraresource cassandra value map cassandravaluemap path cassandra map path value map valuemap value map valuemap modification methods cassandra resource provider override resource create resource resolver resourceresolver resource resolver resourceresolver string map string object string object map stringobjectmap persistence exception persistenceexception system println create create map string object map stringobjectmap commit resource resolver resourceresolver get resource getresource resource resolver resourceresolver cassandra resource cassandraresource resource resolver resourceresolver cassandra resource cassandraresource cassandra value map cassandravaluemap string object map stringobjectmap override delete resource resolver resourceresolver resource resolver resourceresolver string persistence exception persistenceexception create map delete map create map create map remove cassandra map delete map cassandra map override revert resource resolver resourceresolver resource resolver resourceresolver create map clear delete map clear override commit resource resolver resourceresolver resource resolver resourceresolver persistence exception persistenceexception map entry string map entry create map entry set entryset entry get key getkey entry get value getvalue insert resource insertresource entry get key getkey entry get value getvalue define cassandra definecassandra entry get key getkey map entry string map entry delete map entry set entryset delete resource deleteresource resource resolver resourceresolver entry get key getkey cassandra map remove entry get key getkey delete resource deleteresource resource resolver resourceresolver resource resolver resourceresolver string path persistence exception persistenceexception string key get row d getrowid path key string cassandra resource provider util cassandraresourceproviderutil get column family sector getcolumnfamilysector path create column family createcolumnfamily get key space getkeyspace string serializer stringserializer string serializer stringserializer string serializer stringserializer cql query cqlquery string string string cql query cqlquery cql query cqlquery string string string key space keyspace string query delete key key cql query cqlquery set query setquery query query result queryresult cql rows cqlrows string string string result cql query cqlquery execute no such algorithm exception nosuchalgorithmexception persistence exception persistenceexception get message getmessage unsupported encoding exception unsupportedencodingexception persistence exception persistenceexception get message getmessage insert resource insertresource string path map map persistence exception persistenceexception string get row d getrowid path string cassandra resource provider util cassandraresourceproviderutil get column family sector getcolumnfamilysector path create column family createcolumnfamily get key space getkeyspace string serializer stringserializer string metadata map metadata resolution path info resolutionpathinfo json string map metadata string resource type resourcetype map resource type resourcetype cassandra string map resource type resourcetype string resource super type resourcesupertype map resource super type resourcesupertype super cassandra supercassandra string map resource super type resourcesupertype add data adddata get key space getkeyspace string serializer stringserializer string path resource type resourcetype resource super type resourcesupertype metadata no such algorithm exception nosuchalgorithmexception persistence exception persistenceexception get message getmessage unsupported encoding exception unsupportedencodingexception persistence exception persistenceexception get message getmessage add data adddata key space keyspace key space keyspace string string serializer stringserializer string data array dataarray string data data array dataarray cql query cqlquery string string string cql query cqlquery cql query cqlquery string string string key space keyspace string query insert key path resource type resourcetype resource super type resourcesupertype metadata values data cql query cqlquery set query setquery query query result queryresult cql rows cqlrows string string string result cql query cqlquery execute logger info result to string tostring create column family createcolumnfamily string key space keyspace key space keyspace string serializer stringserializer string createcf create column family columnfamily key var char varchar primary key path var char varchar resource type resourcetype var char varchar resource super type resourcesupertype var char varchar metadata var char varchar cql query cqlquery string string string cql query cqlquery cql query cqlquery string string string key space keyspace cql query cqlquery set query setquery createcf query result queryresult cql rows cqlrows string string string result cql query cqlquery execute logger info result get list getlist size finished h invalid request exception hinvalidrequestexception ignore logger debug column family exists ignore get message getmessage string get row d getrowid string path no such algorithm exception nosuchalgorithmexception unsupported encoding exception unsupportedencodingexception message digest messagedigest message digest messagedigest get instance getinstance sha string rem path rempath cassandra resource provider util cassandraresourceproviderutil get remaining path getremainingpath path rem path rempath string rowid string base encode base encodebase digest rem path rempath get bytes getbytes utf rowid override has changes haschanges resource resolver resourceresolver resource resolver resourceresolver create map is empty isempty delete map is empty isempty
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling bgservlets impl org junit assert equals assertequals org junit assert true asserttrue org junit fail java util concurrent atomic atomic integer atomicinteger javax jcr item exists exception itemexistsexception javax jcr node javax jcr repository exception repositoryexception javax jcr session org jmock expectations org jmock mockery org junit test test deep node creator deepnodecreator deep node creator test deepnodecreatortest test test existing node testexistingnode exception mockery mockery mockery deep node creator deepnodecreator deep node creator deepnodecreator string path foo bar session mockery mock session node mockery mock node mockery checking expectations allowing item exists itemexists path return value returnvalue allowing get item getitem path return value returnvalue allowing is node isnode return value returnvalue node result deep create node deepcreatenode path assert true asserttrue expecting deep create deepcreate existing node result test test create from root testcreatefromroot exception mockery mockery mockery deep node creator deepnodecreator deep node creator deepnodecreator string root path rootpath string foo path foopath foo string bar path barpath foo bar session mockery mock session node root mockery mock node root path rootpath node foo mockery mock node foo path foopath node bar mockery mock node bar path barpath string test node type testnodetype test mockery checking expectations allowing item exists itemexists bar path barpath return value returnvalue allowing item exists itemexists foo path foopath return value returnvalue allowing item exists itemexists root path rootpath return value returnvalue allowing get item getitem root path rootpath return value returnvalue root allowing root is node isnode return value returnvalue allowing root add node addnode foo test node type testnodetype return value returnvalue foo allowing foo add node addnode bar test node type testnodetype return value returnvalue bar allowing get root node getrootnode return value returnvalue root allowing save node result deep create node deepcreatenode bar path barpath test node type testnodetype assert true asserttrue expecting deep create deepcreate created node result bar test test create with various types testcreatewithvarioustypes exception mockery mockery mockery string foo path foopath foo string bar path barpath foo bar string wii path wiipath foo bar wii session mockery mock session node foo mockery mock node foo path foopath node bar mockery mock node bar path barpath node wii mockery mock node wii path wiipath mockery checking expectations allowing item exists itemexists wii path wiipath return value returnvalue allowing item exists itemexists bar path barpath return value returnvalue allowing item exists itemexists foo path foopath return value returnvalue allowing get item getitem foo path foopath return value returnvalue foo allowing foo is node isnode return value returnvalue allowing foo get path getpath return value returnvalue foo path foopath allowing foo add node addnode bar foo bar return value returnvalue bar allowing bar get path getpath return value returnvalue bar path barpath allowing bar add node addnode wii foo bar wii return value returnvalue wii allowing get root node getrootnode allowing save atomic integer atomicinteger counter atomic integer atomicinteger deep node creator deepnodecreator deep node creator deepnodecreator override string get node type getnodetype node parent string child path childpath string suggested node type suggestednodetype repository exception repositoryexception parent get path getpath child path childpath override node created nodecreated node repository exception repositoryexception counter add and get addandget node result deep create node deepcreatenode wii path wiipath assert true asserttrue expecting deep create deepcreate created node result wii assert equals assertequals expecting correct count node created nodecreated calls counter test test cannot read foo testcannotreadfoo exception mockery mockery mockery session mockery mock session string foo path foopath foo node foo mockery mock node foo path foopath string bar path barpath foo bar node bar mockery mock node bar path barpath node root mockery mock node mockery checking expectations allowing item exists itemexists string return value returnvalue allowing item exists itemexists bar path barpath return value returnvalue allowing get item getitem foo path foopath return value returnvalue foo allowing get item getitem bar path barpath return value returnvalue bar allowing get root node getrootnode return value returnvalue root allowing root add node addnode string string throw exception throwexception item exists exception itemexistsexception child node readable allowing save deep node creator deepnodecreator deep node creator deepnodecreator deep create node deepcreatenode foo bar unstructured fail expecting exception foo accessible item exists exception itemexistsexception as expected asexpected
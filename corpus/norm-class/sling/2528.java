licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event org junit assert equals assertequals org junit assert not equals assertnotequals org junit assert not null assertnotnull org junit assert true asserttrue java io exception ioexception java util dictionary java util hash map hashmap java util hashtable java util map java util concurrent atomic atomic integer atomicinteger org apache sling event impl bar rier barrier org apache sling event impl jobs config configuration constants configurationconstants org apache sling event jobs job org apache sling event jobs job manager jobmanager org apache sling event jobs notification constants notificationconstants org apache sling event jobs queue org apache sling event jobs queue configuration queueconfiguration org apache sling event jobs consumer job consumer jobconsumer org junit org junit org junit test org junit runner run with runwith org ops pax exam junit pax exam paxexam org ops pax exam spi reactors exam reactor strategy examreactorstrategy org ops pax exam spi reactors per method permethod org osgi framework service registration serviceregistration org osgi service event event org osgi service event event handler eventhandler run with runwith pax exam paxexam exam reactor strategy examreactorstrategy per method permethod ordered queue test orderedqueuetest abstract job handling test abstractjobhandlingtest string queue conf pid queueconfpid override setup io exception ioexception setup create ordered test queue org osgi service configuration ordered config orderedconfig config admin configadmin create factory configuration createfactoryconfiguration org apache sling event jobs queue configuration queueconfiguration dictionary string object ordered props orderedprops hashtable string object ordered props orderedprops configuration constants configurationconstants prop order edtest orderedtest ordered props orderedprops configuration constants configurationconstants prop type queue configuration queueconfiguration type ordered ordered props orderedprops configuration constants configurationconstants prop topics sling order edtest orderedtest ordered props orderedprops configuration constants configurationconstants prop retries ordered props orderedprops configuration constants configurationconstants prop retry delay ordered config orderedconfig update ordered props orderedprops queue conf pid queueconfpid ordered config orderedconfig get pid getpid sleep clean up cleanup io exception ioexception remove configuration removeconfiguration queue conf pid queueconfpid cleanup ordered queue test test timeout test timeout test ordered queue testorderedqueue exception job manager jobmanager job manager jobmanager get job manager getjobmanager register consumer event handler bar rier barrier bar rier barrier atomic integer atomicinteger count atomic integer atomicinteger atomic integer atomicinteger parallel count parallelcount atomic integer atomicinteger service registration serviceregistration jc reg jcreg register job consumer registerjobconsumer sling order edtest orderedtest job consumer jobconsumer last counter lastcounter override job result jobresult process job job counter job get property getproperty counter assert not equals assertnotequals counter property missing counter assert true asserttrue counter increment max counter last counter lastcounter counter last counter lastcounter counter last counter lastcounter last counter lastcounter counter sling order edtest orderedtest start equals job get topic gettopic block job result jobresult parallel count parallelcount increment and get incrementandget parallel count parallelcount decrement and get decrementandget job result jobresult failed string topic job get topic gettopic topic ends with endswith integer job get property getproperty job property job retry count parallel count parallelcount decrement and get decrementandget job result jobresult failed thread sleep interrupted exception interruptedexception parallel count parallelcount decrement and get decrementandget job result jobresult service registration serviceregistration eh reg ehreg register event handler registereventhandler notification constants notificationconstants topic job finished event handler eventhandler override handle event handleevent event event count increment and get incrementandget event queue started map string object properties hash map hashmap string object properties counter job manager jobmanager add job addjob sling order edtest orderedtest start properties assert true asserttrue event received time block reset queue queue job manager jobmanager get queue getqueue order edtest orderedtest assert not null assertnotnull queue order edtest orderedtest exist suspend suspend num jobs start jobs num jobs string sub topic subtopic sling order edtest orderedtest properties clear properties counter job manager jobmanager add job addjob sub topic subtopic properties start queue resume count num jobs thread sleep interrupted exception interruptedexception started event test add assert equals assertequals finished count num jobs count assert equals assertequals finished count num jobs job manager jobmanager get statistics getstatistics get number of finished jobs getnumberoffinishedjobs assert equals assertequals finished count num jobs get statistics getstatistics get number of finished jobs getnumberoffinishedjobs assert equals assertequals failed count num jobs get statistics getstatistics get number of failed jobs getnumberoffailedjobs assert equals assertequals cancelled count get statistics getstatistics get number of cancelled jobs getnumberofcancelledjobs jc reg jcreg unregister eh reg ehreg unregister
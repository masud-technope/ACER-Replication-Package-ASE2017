licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling sample sling shot slingshot comments impl java util hash map hashmap java util map javax jcr node javax jcr repository exception repositoryexception org apache felix scr annotations component org apache felix scr annotations service org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling sample sling shot slingshot sling shot constants slingshotconstants org apache sling sample sling shot slingshot sling shot util slingshotutil org apache sling sample sling shot slingshot comments comment org apache sling sample sling shot slingshot comments comments service commentsservice org apache sling sample sling shot slingshot comments comments util commentsutil org apache sling sample sling shot slingshot impl util org slf logger org slf logger factory loggerfactory implementation comments service component service comments service commentsservice comments service impl commentsserviceimpl comments service commentsservice resource type comments holder string resource type resourcetype comments sling ordered folder orderedfolder logger logger logger factory loggerfactory get logger getlogger get class getclass org apache sling sample sling shot slingshot comments comments service commentsservice get comments resource path getcommentsresourcepath org apache sling api resource resource string get comments resource path getcommentsresourcepath resource resource string content path contentpath sling shot util slingshotutil get content path getcontentpath resource content path contentpath string full path fullpath sling shot constants slingshotconstants app root path users sling shot util slingshotutil get user id getuserid resource ugc comments content path contentpath full path fullpath org apache sling sample sling shot slingshot comments comments service commentsservice add comment addcomment org apache sling api resource resource org apache sling sample sling shot slingshot comments comment add comment addcomment resource resource comment persistence exception persistenceexception string comments path commentspath get comments resource path getcommentsresourcepath resource map string object props hash map hashmap string object props resource resolver resourceresolver property resource type resource type resourcetype comments resource ratings resource ratingsresource resource util resourceutil get or create resource getorcreateresource resource get resource resolver getresourceresolver comments path commentspath props map string object properties hash map hashmap string object properties resource resolver resourceresolver property resource type comments util commentsutil resource type resourcetype comment properties comments util commentsutil property title get title gettitle properties comments util commentsutil property text get text gettext properties comments util commentsutil property user get created by getcreatedby times persistence exception persistenceexception exception resource new resource newresource exception string resource util resourceutil create unique child name createuniquechildname ratings resource ratingsresource util filter get title gettitle new resource newresource resource get resource resolver getresourceresolver create ratings resource ratingsresource properties resource get resource resolver getresourceresolver commit persistence exception persistenceexception resource get resource resolver getresourceresolver revert resource get resource resolver getresourceresolver refresh exception exception exception order node top jcr based node new node newnode new resource newresource adapt to adaptto node new node newnode node parent new node newnode get parent getparent node first node firstnode parent get nodes getnodes next node nextnode first node firstnode get name getname equals new node newnode get name getname parent order before orderbefore new node newnode get name getname first node firstnode get name getname new node newnode get session getsession save repository exception repositoryexception logger error unable order comment top
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling models impl org junit org mockito mockito java lang reflect field java util arrays java util collections java util hash map hashmap java util hashtable java util map org apache commons lang random string utils randomstringutils org apache sling api resource resource org apache sling api resource value map valuemap org apache sling api wrappers value map decorator valuemapdecorator org apache sling models factory missing elements exception missingelementsexception org apache sling models impl injectors child resource injector childresourceinjector org apache sling models impl injectors value map injector valuemapinjector org apache sling models test models testmodels classes array primitives model arrayprimitivesmodel org apache sling models test models testmodels classes array wrappers model arraywrappersmodel org apache sling models test models testmodels classes child model childmodel org apache sling models test models testmodels classes child resource model childresourcemodel org apache sling models test models testmodels classes child value map model childvaluemapmodel org apache sling models test models testmodels classes list model listmodel org apache sling models test models testmodels classes parent model parentmodel org apache sling models test models testmodels classes resource model with required field resourcemodelwithrequiredfield org apache sling models test models testmodels classes resource model with required field optional strategy resourcemodelwithrequiredfieldoptionalstrategy org apache sling models test models testmodels classes simple property model simplepropertymodel org junit org junit test org junit runner run with runwith org mockito mock org mockito invocation invocation on mock invocationonmock org mockito run ners runners mockito unit runner mockitojunitrunner org mockito stub bin g stubbing answer org osgi framework bundle context bundlecontext org osgi framework constants org osgi service component component context componentcontext run with runwith mockito unit runner mockitojunitrunner resource model classes test resourcemodelclassestest mock component context componentcontext component ctx componentctx mock bundle context bundlecontext bundle context bundlecontext model adapter factory modeladapterfactory factory setup component ctx componentctx get bundle context getbundlecontext then return thenreturn bundle context bundlecontext component ctx componentctx get properties getproperties then return thenreturn hashtable string object factory model adapter factory modeladapterfactory factory activate component ctx componentctx value map injector valuemapinjector value map injector valuemapinjector value map injector valuemapinjector factory bind injector bindinjector value map injector valuemapinjector service properties map servicepropertiesmap factory bind injector bindinjector child resource injector childresourceinjector service properties map servicepropertiesmap factory bind inject annotation processor factory bindinjectannotationprocessorfactory value map injector valuemapinjector collections string object singleton map singletonmap constants service test test simple property model testsimplepropertymodel map string object map hash map hashmap string object map map map int property intproperty integer map array property arrayproperty string value map valuemap value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn simple property model simplepropertymodel model factory get adapter getadapter res simple property model simplepropertymodel assert not null assertnotnull model assert equals assertequals model get first getfirst assert null assertnull model get second getsecond assert equals assertequals model get third property getthirdproperty assert equals assertequals model get int property getintproperty string array model get array property getarrayproperty assert equals assertequals array length assert equals assertequals array assert true asserttrue model is post construct called ispostconstructcalled test test array primitives model testarrayprimitivesmodel map string object map hash map hashmap string object map int array intarray map second int array secondintarray integer value map valuemap value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn array primitives model arrayprimitivesmodel model factory get adapter getadapter res array primitives model arrayprimitivesmodel assert not null assertnotnull model primitive int array primitiveintarray model get int array getintarray assert equals assertequals primitive int array primitiveintarray length assert equals assertequals primitive int array primitiveintarray second primitive int array secondprimitiveintarray model get second int array getsecondintarray assert equals assertequals second primitive int array secondprimitiveintarray length assert equals assertequals second primitive int array secondprimitiveintarray test test array wrappers model testarraywrappersmodel map string object map hash map hashmap string object map int array intarray integer map second int array secondintarray value map valuemap value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn array wrappers model arraywrappersmodel model factory get adapter getadapter res array wrappers model arraywrappersmodel assert not null assertnotnull model integer int array intarray model get int array getintarray assert equals assertequals int array intarray length assert equals assertequals integer int array intarray integer second int array secondintarray model get second int array getsecondintarray assert equals assertequals second int array secondintarray length assert equals assertequals integer second int array secondintarray test test list model testlistmodel map string object map hash map hashmap string object map int list intlist integer map string list stringlist string value map valuemap value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn list model listmodel model factory get adapter getadapter res list model listmodel assert not null assertnotnull model assert equals assertequals model get int list getintlist size assert equals assertequals integer model get int list getintlist assert equals assertequals model get string list getstringlist size assert equals assertequals model get string list getstringlist test test required property model testrequiredpropertymodel map string object map hash map hashmap string object map map value map valuemap spy value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn resource model with required field resourcemodelwithrequiredfield model factory get adapter getadapter res resource model with required field resourcemodelwithrequiredfield assert null assertnull model verify required string test test required property model with exception testrequiredpropertymodelwithexception map string object map hash map hashmap string object map map value map valuemap spy value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn thrown factory create model createmodel res resource model with required field resourcemodelwithrequiredfield missing elements exception missingelementsexception assert equals assertequals required field get missing elements getmissingelements iterator get element getelement get name getname thrown assert true asserttrue thrown verify required string test test required property missing model optional strategy testrequiredpropertymissingmodeloptionalstrategy map string object map hash map hashmap string object map value map valuemap spy value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn resource model with required field optional strategy resourcemodelwithrequiredfieldoptionalstrategy model factory get adapter getadapter res resource model with required field optional strategy resourcemodelwithrequiredfieldoptionalstrategy assert null assertnull model verify optional string verify required string test test required property model optional strategy testrequiredpropertymodeloptionalstrategy map string object map hash map hashmap string object map required required map required required map required required value map valuemap spy value map decorator valuemapdecorator map resource res mock resource res adapt to adaptto value map valuemap then return thenreturn resource model with required field optional strategy resourcemodelwithrequiredfieldoptionalstrategy model factory get adapter getadapter res resource model with required field optional strategy resourcemodelwithrequiredfieldoptionalstrategy assert not null assertnotnull model assert equals assertequals required model get required getrequired assert equals assertequals required model get required getrequired verify optional string verify required string test test child resource testchildresource resource child mock resource resource second child secondchild mock resource resource empty child emptychild mock resource resource first grand child firstgrandchild mock resource resource second grand child secondgrandchild mock resource second child secondchild list children listchildren then return thenreturn arrays as list aslist first grand child firstgrandchild second grand child secondgrandchild iterator empty child emptychild list children listchildren then return thenreturn collections resource empty set emptyset iterator resource res mock resource res get child getchild first child firstchild then return thenreturn child res get child getchild second child secondchild then return thenreturn second child secondchild res get child getchild empty child emptychild then return thenreturn empty child emptychild child resource model childresourcemodel model factory get adapter getadapter res child resource model childresourcemodel assert not null assertnotnull model assert equals assertequals child model get first child getfirstchild assert equals assertequals model get grand children getgrandchildren size assert equals assertequals first grand child firstgrandchild model get grand children getgrandchildren assert equals assertequals second grand child secondgrandchild model get grand children getgrandchildren assert equals assertequals model get empty grand children getemptygrandchildren size test test child value map testchildvaluemap value map valuemap map value map decorator valuemapdecorator empty resource child mock resource child adapt to adaptto value map valuemap then return thenreturn map resource res mock resource res get child getchild first child firstchild then return thenreturn child child value map model childvaluemapmodel model factory get adapter getadapter res child value map model childvaluemapmodel assert not null assertnotnull model assert equals assertequals map model get first child getfirstchild test test child model testchildmodel object first value firstvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap first map firstmap value map decorator valuemapdecorator collections singleton map singletonmap property first value firstvalue resource first child firstchild mock resource first child firstchild adapt to adaptto value map valuemap then return thenreturn first map firstmap first child firstchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel object first grand child value firstgrandchildvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap first grand child map firstgrandchildmap value map decorator valuemapdecorator collections singleton map singletonmap property first grand child value firstgrandchildvalue object second grand child value secondgrandchildvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap second grand child map secondgrandchildmap value map decorator valuemapdecorator collections singleton map singletonmap property second grand child value secondgrandchildvalue resource first grand child firstgrandchild mock resource first grand child firstgrandchild adapt to adaptto value map valuemap then return thenreturn first grand child map firstgrandchildmap first grand child firstgrandchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel resource second grand child secondgrandchild mock resource second grand child secondgrandchild adapt to adaptto value map valuemap then return thenreturn second grand child map secondgrandchildmap second grand child secondgrandchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel resource second child secondchild mock resource second child secondchild list children listchildren then return thenreturn arrays as list aslist first grand child firstgrandchild second grand child secondgrandchild iterator resource empty child emptychild mock resource empty child emptychild list children listchildren then return thenreturn collections resource empty set emptyset iterator resource res mock resource res get child getchild first child firstchild then return thenreturn first child firstchild res get child getchild second child secondchild then return thenreturn second child secondchild res get child getchild empty child emptychild then return thenreturn empty child emptychild parent model parentmodel model factory get adapter getadapter res parent model parentmodel assert not null assertnotnull model child model childmodel child model childmodel model get first child getfirstchild assert not null assertnotnull child model childmodel assert equals assertequals first value firstvalue child model childmodel get property getproperty assert equals assertequals model get grand children getgrandchildren size assert equals assertequals first grand child value firstgrandchildvalue model get grand children getgrandchildren get property getproperty assert equals assertequals second grand child value secondgrandchildvalue model get grand children getgrandchildren get property getproperty assert equals assertequals model get empty grand children getemptygrandchildren size adapt to child model adapttochildmodel answer child model childmodel override child model childmodel answer invocation on mock invocationonmock invocation throwable factory get adapter getadapter invocation get mock getmock child model childmodel
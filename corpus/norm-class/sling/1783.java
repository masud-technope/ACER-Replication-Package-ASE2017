licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base connectors ping org junit assert false assertfalse org junit assert true asserttrue org mockito mockito mock org mockito mockito javax servlet http http servlet request httpservletrequest org apache sling discovery base connectors base config baseconfig org junit org junit test junit x junitx util private accessor privateaccessor topology connector servlet test topologyconnectorservlettest topology connector servlet topologyconnectorservlet servlet http servlet request httpservletrequest get request getrequest string host string add r addr http servlet request httpservletrequest result mock http servlet request httpservletrequest result get remote addr getremoteaddr then return thenreturn add r addr result get remote host getremotehost then return thenreturn host result set up setup exception servlet topology connector servlet topologyconnectorservlet base config baseconfig config mock base config baseconfig private accessor privateaccessor set field setfield servlet config config test test null testnull exception work fine servlet init whitelist initwhitelist work fine servlet init whitelist initwhitelist string test test plain text whitelist testplaintextwhitelist enabled exception servlet init whitelist initwhitelist string foo bar assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest bar assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest bar test test plain text whitelist testplaintextwhitelist disabled exception servlet init whitelist initwhitelist string assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest bar assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest bar test test wildcard whitelist testwildcardwhitelist exception servlet init whitelist initwhitelist string foo test assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo o fooo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo oo foooo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo o fooo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo oo foooo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest bur assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest bur assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest test assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest testy test test sub net mask whitelist testsubnetmaskwhitelist exception servlet init whitelist initwhitelist string assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert true asserttrue servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo assert false assertfalse servlet is whitelisted iswhitelisted get request getrequest foo
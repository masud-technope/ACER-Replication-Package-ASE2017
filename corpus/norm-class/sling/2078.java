licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest servlets post java io exception ioexception java input stream inputstream java util array list arraylist java util hash map hashmap java util list java util map javax servlet http http servlet response httpservletresponse org apache commons http client httpclient name value pair namevaluepair org apache sling commons testing int egration integration http test base httptestbase org apache sling servlets post sling post constants slingpostconstants test node creation sling post servlet slingpostservlet post servlet create test postservletcreatetest http test base httptestbase string test base path sling tests string slash string post url posturl override set up setup exception set up setup post url posturl http base url test base path system current time millis currenttimemillis test post path is unique testpostpathisunique io exception ioexception assert http status asserthttpstatus post url posturl http servlet response httpservletresponse path exist test post url posturl test create node testcreatenode io exception ioexception string location test client testclient create node createnode post url posturl slash assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location generated location ends with endswith assert true asserttrue node location created post url post url posturl location post url posturl test create node with extension testcreatenodewithextension io exception ioexception string location test client testclient create node createnode post url posturl slash html assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location generated location ends with endswith assert true asserttrue node location created post url post url posturl location post url posturl test create node with star and extension testcreatenodewithstarandextension io exception ioexception string location test client testclient create node createnode post url posturl slash html assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location generated location ends with endswith assert true asserttrue node location created post url post url posturl location post url posturl test post with extension no star testpostwithextensionnostar io exception ioexception string extension html string location test client testclient create node createnode post url posturl extension assert equals assertequals expecting original location modified creating node post url posturl extension location test post with extension slash no star testpostwithextensionslashnostar io exception ioexception string extension html string location test client testclient create node createnode post url posturl slash extension assert equals assertequals expecting original location modified creating node post url posturl slash extension location test create node at specific url testcreatenodeatspecificurl io exception ioexception string specified location specifiedlocation post url posturl location string location test client testclient create node createnode specified location specifiedlocation assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location created url specified location specifiedlocation location equals specified location specifiedlocation test create node at deep url testcreatenodeatdeepurl io exception ioexception system current time millis currenttimemillis string specified location specifiedlocation post url posturl location deep a deepa deep b deepb string location test client testclient create node createnode specified location specifiedlocation assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location created deep url specified location specifiedlocation location equals specified location specifiedlocation create node data check data test create with data testcreatewithdata io exception ioexception map string string props hash map hashmap string string props props props string created node url creatednodeurl test client testclient create node createnode post url posturl slash props string content get content getcontent created node url creatednodeurl json content type json assert java script assertjavascript content println data data assert java script assertjavascript content println data create node propery sub node subnode check sling test create sub node property testcreatesubnodeproperty io exception ioexception map string string props hash map hashmap string string props props sub node subnode props string created node url creatednodeurl test client testclient create node createnode post url posturl slash props string content get content getcontent created node url creatednodeurl json content type json assert java script assertjavascript content println data assert java script assertjavascript content println data sub node subnode assert java script assertjavascript content println data save prefix parameters check prefix saved test default save prefix testdefaultsaveprefix io exception ioexception map string string props hash map hashmap string string props props props saved string created node url creatednodeurl test client testclient create node createnode post url posturl slash props string content get content getcontent created node url creatednodeurl json content type json assert java script assertjavascript content println data data assert java script assertjavascript undefined content println type of typeof data sling removed save param prefix saveparamprefix support check test custom save prefix testcustomsaveprefix io exception ioexception map string string props hash map hashmap string string props stuff props stuff props saved props save param prefix saveparamprefix stuff string created node url creatednodeurl test client testclient create node createnode post url posturl slash props string content get content getcontent created node url creatednodeurl json content type json assert java script assertjavascript undefined content println type of typeof data assert java script assertjavascript undefined content println type of typeof data assert java script assertjavascript content println data stuff data stuff assert java script assertjavascript string content println type of typeof data sling test create node exact node filtering test create node with exact name testcreatenodewithexactname io exception ioexception map string string node properties nodeproperties hash map hashmap string string node properties nodeproperties sling post constants slingpostconstants node exact node name exactnodename string location test client testclient create node createnode post url posturl slash node properties nodeproperties assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location exact location ends with endswith assert true asserttrue node location created post url post url posturl location post url posturl assert true asserttrue node location exact exact node name exactnodename location ends with endswith exact node name exactnodename sling test error reporting attempting create node invalid exact node test create node with invalid exact name testcreatenodewithinvalidexactname io exception ioexception string location post url posturl slash list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair sling post constants slingpostconstants node exact node name exactnodename expect status invalid assert post status assertpoststatus location http servlet response httpservletresponse internal server error post params postparams sling test error reporting attempting create node node test create node with already used exact name testcreatenodewithalreadyusedexactname io exception ioexception string test node name testnodename already used exact node name alreadyusedexactnodename map string string node properties nodeproperties hash map hashmap string string node properties nodeproperties sling post constants slingpostconstants node test node name testnodename string location test client testclient create node createnode post url posturl slash node properties nodeproperties assert http status asserthttpstatus location ext http servlet response httpservletresponse post redirect created resource location assert true asserttrue node location exact location ends with endswith assert true asserttrue node location created post url post url posturl location post url posturl assert true asserttrue node location exact test node name testnodename location ends with endswith test node name testnodename create node siblings allowed error thrown list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair sling post constants slingpostconstants node test node name testnodename expect status unique assert post status assertpoststatus post url posturl slash http servlet response httpservletresponse internal server error post params postparams test creating node under file testcreatingnodeunderfile io exception ioexception string base web dav url basewebdavurl webdav base url create file test createfiletest test client testclient mkdir base web dav url basewebdavurl string test file testfile int egration integration test test file testfile txt input stream inputstream data get class getclass get resource as stream getresourceasstream test file testfile string webdav url webdavurl base web dav url basewebdavurl system current time millis currenttimemillis txt assert not null assertnotnull local test file test file testfile data upload file webdav verify delete verify assert http status asserthttpstatus webdav url webdavurl resource webdav url webdavurl exist test status test client testclient upload webdav url webdavurl data assert equals assertequals upload status code status assert http status asserthttpstatus webdav url webdavurl resource webdav url webdavurl exist upload data data close string child url childurl webdav url webdavurl list name value pair namevaluepair list array list arraylist name value pair namevaluepair list add name value pair namevaluepair name hint namehint child list add name value pair namevaluepair prop list add name value pair namevaluepair jcr primary type primarytype unstructured assert post status assertpoststatus child url childurl list response creating child file fail should n shouldn check specific exception implementation specific sling result
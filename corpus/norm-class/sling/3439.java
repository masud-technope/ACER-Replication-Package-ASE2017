licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling service user mapping serviceusermapping impl junit framework test case testcase org junit test org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service event serviceevent org osgi framework service reference servicereference org osgi framework hooks service event listener hook eventlistenerhook org osgi framework hooks service find hook findhook org osgi framework hooks service listener hook listenerhook java util array list arraylist java util collection java util hash map hashmap java util list java util map org mockito mockito mock org mockito mockito test reference bundle filtering based code mapping service name servicename code service user mapped bundle filter test serviceusermappedbundlefiltertest string bundle bundle string bundle bundle bundle context bundlecontext bundle context bundlecontext bundle context bundlecontext bundle context bundlecontext bundle context bundlecontext mock bundle context bundlecontext bundle bundle mock bundle bundle context bundlecontext get bundle getbundle then return thenreturn bundle bundle get symbolic name getsymbolicname then return thenreturn bundle bundle context bundlecontext mock bundle context bundlecontext bundle bundle mock bundle bundle context bundlecontext get bundle getbundle then return thenreturn bundle bundle get symbolic name getsymbolicname then return thenreturn bundle test test event testevent map bundle context bundlecontext collection listener hook listenerhook listener info listenerinfo map hash map hashmap bundle context bundlecontext collection listener hook listenerhook listener info listenerinfo map bundle context bundlecontext array list arraylist listener hook listenerhook listener info listenerinfo map bundle context bundlecontext array list arraylist listener hook listenerhook listener info listenerinfo service event serviceevent service event serviceevent mock service event serviceevent service reference servicereference service reference servicereference mock service reference servicereference service event serviceevent get service reference getservicereference then return thenreturn service reference servicereference service reference servicereference get property getproperty constants obj ectclass objectclass then return thenreturn string service user mapped impl serviceusermappedimpl service user mapped serviceusermapped service reference servicereference get property getproperty mapping service name servicename then return thenreturn bundle event listener hook eventlistenerhook event listener hook eventlistenerhook service user mapped bundle filter serviceusermappedbundlefilter event listener hook eventlistenerhook event service event serviceevent map test case testcase assert equals assertequals map size test case testcase assert true asserttrue map contains key containskey bundle context bundlecontext test test find testfind list collection array list arraylist service reference servicereference service reference servicereference service reference servicereference mock service reference servicereference service reference servicereference service reference servicereference mock service reference servicereference collection add service reference servicereference collection add service reference servicereference service reference servicereference get property getproperty mapping service name servicename then return thenreturn bundle service reference servicereference get property getproperty constants obj ectclass objectclass then return thenreturn string service user mapped impl serviceusermappedimpl service user mapped serviceusermapped service reference servicereference get property getproperty mapping service name servicename then return thenreturn bundle service reference servicereference get property getproperty constants obj ectclass objectclass then return thenreturn string service user mapped impl serviceusermappedimpl service user mapped serviceusermapped find hook findhook find hook findhook service user mapped bundle filter serviceusermappedbundlefilter find hook findhook find bundle context bundlecontext collection test case testcase assert equals assertequals collection size test case testcase assert true asserttrue collection service reference servicereference
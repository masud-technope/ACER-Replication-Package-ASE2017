licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer core impl java buffered output stream bufferedoutputstream java byte array output stream bytearrayoutputstream java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java input stream inputstream java object output stream objectoutputstream java output stream outputstream java math big integer biginteger java security message digest messagedigest java util dictionary java util enumeration java util hash map hashmap java util map java util sorted set sortedset java util tree set treeset org osgi framework bundle context bundlecontext utility file handling file data store filedatastore bundle context property defining location installer files sling installer dir string config dir sling installer dir configuration data directory location configured installer string dir installer file directory instance avoid passing reference service data object file data store filedatastore shared cache url digest mapping map string string digest cache digestcache hash map hashmap string string create file util instance detect installer directory file data store filedatastore bundle context bundlecontext bundle context bundlecontext string location bundle context bundlecontext get property getproperty config dir area location file location file locationfile bundle context bundlecontext get data file getdatafile dir location file locationfile location location file locationfile get absolute path getabsolutepath support file system filesystem based data area location location system get property getproperty user dir file separator char separatorchar dir ensure file absolute file location file locationfile file location location file locationfile is absolute isabsolute file bundle location file bundlelocationfile bundle context bundlecontext get data file getdatafile location file locationfile get path getpath bundle location file bundlelocationfile location file locationfile bundle location file bundlelocationfile ensure file object absolute file object location file locationfile location file locationfile get absolute file getabsolutefile check location location file locationfile is directory isdirectory location file locationfile exists illegal argument exception illegalargumentexception location directory location file locationfile mkdirs illegal argument exception illegalargumentexception create directory location directory location file locationfile shared file installer directory param file name filename file file get data file getdatafile string file name filename file directory file name filename serial number create unique file names data storage serial number counter serialnumbercounter system current time millis currenttimemillis get next serial number getnextserialnumber registered resource impl registeredresourceimpl serial number counter serialnumbercounter create unique data file file create new data file createnewdatafile input stream inputstream stream string url string digest string hint io exception ioexception check data digest digest cache digestcache string stored digest storeddigest digest cache digestcache url stored digest storeddigest stored digest storeddigest equals digest pos url last index of lastindexof string url substring pos string filename hint rsrc hint get next serial number getnextserialnumber ser replace special characters filename allowed windows string filename filename replace all replaceall file file get data file getdatafile filename copy to local storage copytolocalstorage stream file digest digest cache digestcache digest cache digestcache url digest file update digest cache updatedigestcache string url string digest digest cache digestcache digest cache digestcache url digest copy data local storage copy to local storage copytolocalstorage input stream inputstream data file data file datafile io exception ioexception output stream outputstream buffered output stream bufferedoutputstream file output stream fileoutputstream data file datafile buffer count count data read buffer buffer length write buffer count flush close file create new data file createnewdatafile string hint input stream inputstream stream io exception ioexception string filename hint unknown hint resource get next serial number getnextserialnumber ser file file get data file getdatafile filename copy to local storage copytolocalstorage stream file file remove from digest cache removefromdigestcache string url string digest digest cache digestcache string stored digest storeddigest digest cache digestcache url stored digest storeddigest stored digest storeddigest equals digest digest cache digestcache remove url digest needed detect data string compute digest computedigest file data io exception ioexception input stream inputstream file input stream fileinputstream data message digest messagedigest message digest messagedigest get instance getinstance buffer count count read buffer buffer length update buffer count digest to string digesttostring close io exception ioexception ioe ioe exception ignore data to string tostring convert digest readable string http java lobby javalobby org java for ums forums html string digest to string digesttostring message digest messagedigest big integer biginteger big int bigint big integer biginteger digest string big int bigint to string tostring digest needed detect data depend dictionary ordering string compute digest computedigest dictionary string object data message digest messagedigest message digest messagedigest get instance getinstance byte array output stream bytearrayoutputstream bos byte array output stream bytearrayoutputstream object output stream objectoutputstream oos object output stream objectoutputstream bos sorted set sortedset string sorted keys sortedkeys tree set treeset string data enumeration string data has more elements hasmoreelements string key next element nextelement sorted keys sortedkeys add key string key sorted keys sortedkeys oos write object writeobject key object val data key val number oos write object writeobject string value of valueof val oos write object writeobject val oos flush update bos to byte array tobytearray digest to string digesttostring exception ignore data to string tostring
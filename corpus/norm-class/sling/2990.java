licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling maven project support projectsupport org junit assert equals assertequals org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue java file java i o exception ioexception java input stream inputstream java net malformedurlexception java net url java util array list arraylist java util iterator java util linked list linkedlist java util list org apache commons file name utils filenameutils org apache maven artifact artifact org apache maven plugin mojo execution exception mojoexecutionexception org apache maven plugin logging log org apache sling launchpad api launchpad content provider launchpadcontentprovider org apache sling maven project support projectsupport bundle list bundlelist bundle list bundlelist org apache sling maven project support projectsupport bundle list bundlelist start level startlevel org apache sling maven project support projectsupport bundle list bundlelist xpp bundle list xpp bundlelistxpp reader org junit org junit before class beforeclass org junit rule org junit test org junit rules temporary folder temporaryfolder org mockito matchers org mockito mockito org mockito invocation invocation on mock invocationonmock org mockito stub bin g stubbing answer test bundle list content provider bundlelistcontentprovider bundle list content provider test bundlelistcontentprovidertest bundle list bundlelist bundle list bundlelist string test bundle list test bundle list xml bundles test bundle list launchpad content provider launchpadcontentprovider provider file resource provider root resourceproviderroot file resource provider file resourceproviderfile file config directory configdirectory log warnings count logwarningscount string fake bundle path fakebundlepath rule temporary folder temporaryfolder temp folder tempfolder temporary folder temporaryfolder string config files file txt file cfg some file somefile properties dir file txt dir dir file txt before class beforeclass parse bundle list parsebundlelist exception bundle list xpp bundlelistxpp reader reader bundle list xpp bundlelistxpp reader input stream inputstream bundle list content provider test bundlelistcontentprovidertest get class loader getclassloader get resource as stream getresourceasstream test bundle list assert not null assertnotnull expecting test bundle list bundle list bundlelist reader read close setup temporary files setuptemporaryfiles i o exception ioexception temporary folder temporaryfolder config root configroot temporary folder temporaryfolder temp folder tempfolder get root getroot config root configroot create string filename config files file get config file getconfigfile config root configroot filename create new file createnewfile assert true asserttrue expecting temporary config file created get absolute path getabsolutepath exists config directory configdirectory config root configroot get root getroot resource provider root resourceproviderroot file temp folder tempfolder get root getroot resource provider root resource provider root resourceproviderroot mkdirs resource provider file resourceproviderfile file resource provider root resourceproviderroot file system current time millis currenttimemillis resource provider file resourceproviderfile create new file createnewfile fake bundle path fakebundlepath get fake bundle path getfakebundlepath file get config file getconfigfile file config root configroot string i o exception ioexception file file name utils filenameutils concat config root configroot get absolute path getabsolutepath file get config file getconfigfile temporary folder temporaryfolder config root configroot string i o exception ioexception file parent folder parentfolder config root configroot get root getroot string parent path parentpath substring last index of lastindexof substring last index of lastindexof parent folder parentfolder config root configroot new folder newfolder parent path parentpath split file parent folder parentfolder string get fake bundle path getfakebundlepath file fake bundle touri tourl to external form toexternalform malformedurlexception runtime exception runtimeexception setup provider setupprovider log log mockito mock log answer count warning answers countwarninganswers answer answer invocation on mock invocationonmock invocation throwable log warnings count logwarningscount mockito do answer doanswer count warning answers countwarninganswers log warn matchers string mockito do answer doanswer count warning answers countwarninganswers log warn matchers throwable mockito do answer doanswer count warning answers countwarninganswers log warn matchers string matchers throwable provider bundle list content provider bundlelistcontentprovider resource provider root resourceproviderroot override bundle list bundlelist get initialized bundle list getinitializedbundlelist bundle list bundlelist override file get config directory getconfigdirectory config directory configdirectory override artifact get artifact getartifact artifact definition artifactdefinition def mojo execution exception mojoexecutionexception artifact mockito mock artifact string fake name fakename string builder stringbuilder append fake bundle append def get artifact i d getartifactid append append def get start level getstartlevel append append def get run modes getrunmodes to string tostring mockito get file getfile then return thenreturn file fake name fakename override log get log getlog log assert children assertchildren string path string expected list string kids array list arraylist string iterator string provider get children getchildren path expected length assert true asserttrue expecting children path has next hasnext assert not null assertnotnull expecting iterator path has next hasnext kids add string exp expected assert true asserttrue expecting exp children path result kids kids exp assert equals assertequals expecting correct number children path result kids expected length kids size test test parse d bundles count testparsedbundlescount counter start level startlevel level bundle list bundlelist get start levels getstartlevels counter level get bundles getbundles size assert equals assertequals bundles test bundle list counter test test root testroot assert children assertchildren resources resources bundles resources core bundles corebundles resources config resources install resources install dev resources install test resources install oak resources install jackrabbit test test bundles testbundles assert children assertchildren resources bundles resources bundles test test install testinstall assert children assertchildren resources install resources install resources install resources install resources install test test install dev testinstalldev assert children assertchildren resources install dev resources install dev resources install dev test test install test testinstalltest assert children assertchildren resources install test resources install test resources install test test test install oak testinstalloak assert children assertchildren resources install oak resources install oak test test install jackrabbit testinstalljackrabbit assert children assertchildren resources install jackrabbit resources install jackrabbit test test core bundles testcorebundles assert children assertchildren resources core bundles corebundles test test config testconfig assert children assertchildren resources config resources config file txt resources config file cfg resources config some file somefile properties resources config dir test test nested config testnestedconfig assert children assertchildren resources config dir resources config dir file txt resources config dir dir test test config file testconfigfile assert children assertchildren resources config file txt assert equals assertequals expecting warnings log warnings count logwarningscount test test nested config file testnestedconfigfile assert children assertchildren resources config dir file txt assert equals assertequals expecting warnings log warnings count logwarningscount test test config sub path testconfigsubpath assert children assertchildren resources config some folder somefolder some sub folder somesubfolder assert equals assertequals expecting warning log warnings count logwarningscount test test non existent config directory testnonexistentconfigdirectory config directory configdirectory file existent system current time millis currenttimemillis assert children assertchildren resources config test test ignored non bootstrap bundles testignorednonbootstrapbundles start levels provide resources bundles moved resources install string path resources bundles assert null assertnull expecting resources path provider get children getchildren path test test install testinstall assert children assertchildren resources install fake bundle path fakebundlepath commons fake bundle path fakebundlepath commons file upload fileupload fake bundle path fakebundlepath commons collect ions collections test test bootstrap bundles testbootstrapbundles assert children assertchildren resources bundles fake bundle path fakebundlepath slf api fake bundle path fakebundlepath org apache sling commons log test test install testinstall assert children assertchildren resources install fake bundle path fakebundlepath nor unmode norunmode test test install testinstall dev assert children assertchildren resources install dev fake bundle path fakebundlepath org apache sling extensions webconsole branding webconsolebranding dev test test install testinstall test assert children assertchildren resources install test fake bundle path fakebundlepath org apache sling extensions webconsole security provider webconsolesecurityprovider test test test install testinstall assert children assertchildren resources install fake bundle path fakebundlepath fifteen nor unmode norunmode test test install testinstall oak assert children assertchildren resources install oak fake bundle path fakebundlepath org apache sling jcr oak server oak fake bundle path fakebundlepath jsr oak jackrabbit test test install testinstall jackrabbit assert children assertchildren resources install jackrabbit fake bundle path fakebundlepath guava jackrabbit fake bundle path fakebundlepath jsr oak jackrabbit test test config resource testconfigresource exception url url provider get resource getresource resources config file txt assert not null assertnotnull expecting config resource url assert equals assertequals get config file getconfigfile config directory configdirectory file txt touri tourl to external form toexternalform url to external form toexternalform test test nested config resource testnestedconfigresource exception url url provider get resource getresource resources config dir file txt assert not null assertnotnull expecting config resource url assert equals assertequals get config file getconfigfile config directory configdirectory dir file txt touri tourl to external form toexternalform url to external form toexternalform test test resource provider resource testresourceproviderresource exception url url provider get resource getresource resource provider file resourceproviderfile get name getname assert not null assertnotnull expecting resource provider file url assert equals assertequals resource provider file resourceproviderfile touri tourl to external form toexternalform url to external form toexternalform test test classpath resource testclasspathresource exception url url provider get resource getresource test bundle list assert not null assertnotnull expecting classpath resource url assert true asserttrue url to external form toexternalform ends with endswith test bundle list test test classpath resource as stream testclasspathresourceasstream exception input stream inputstream provider get resource as stream getresourceasstream test bundle list assert not null assertnotnull expecting classpath resource stream close test test not found stream testnotfoundstream exception input stream inputstream provider get resource as stream getresourceasstream resources config txt assert null assertnull expecting stream existent resource test testurlresource exception string url str urlstr http per du perdu url url provider get resource getresource url str urlstr assert not null assertnotnull expecting url resource url assert equals assertequals url url str urlstr url test test null result testnullresult assert null assertnull provider get children getchildren foo bar test test all bundles found testallbundlesfound list string all resources allresources linked list linkedlist string add recursively addrecursively all resources allresources resources list string bundles linked list linkedlist string string all resources allresources fake bundle bundles add bundles modes folders modes expected bundles test bundle list assert equals assertequals expecting exact number test bundles expected bundles size test test file testfile assert children assertchildren file add recursively addrecursively list string resources string path path ends with endswith path path substring path length resources add path iterator string provider get children getchildren path has next hasnext add recursively addrecursively resources
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest user manager usermanager org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull java io exception ioexception java util array list arraylist java util list java util random javax servlet http http servlet response httpservletresponse org apache commons http client httpclient credentials org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient username password credentials usernamepasswordcredentials org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons testing int egration integration http test httptest org junit org junit org junit test tests create user createuser sling post operation create user test createusertest random random random system current time millis currenttimemillis string test user id testuserid user manager test util usermanagertestutil user manager test util usermanagertestutil setup exception set up setup cleanup exception test user id testuserid remove test user exists string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams tear down teardown form action system user manager usermanager user create html method post div input type text test user testuser div div password input type text pwd test user testuser div div password confirm input type text pwd confirm pwdconfirm test user testuser div input type sub mit submit sub mit submit form test test create user testcreateuser io exception ioexception json exception jsonexception test user id testuserid test user testuser random next int nextint system current time millis currenttimemillis string post url posturl http test httptest http base url system user manager usermanager user create html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair test user id testuserid post params postparams add name value pair namevaluepair marker test user id testuserid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams fetch user profile json verify settings string get url geturl http test httptest http base url system user manager usermanager user test user id testuserid json string json get authenticated content getauthenticatedcontent creds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals test user id testuserid json obj jsonobj get string getstring marker assert false assertfalse json obj jsonobj assert false assertfalse json obj jsonobj pwd assert false assertfalse json obj jsonobj pwd confirm pwdconfirm fetch session info verify user log credentials new user creds newusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string get url geturl http test httptest http base url system sling info session info sessioninfo json string json get authenticated content getauthenticatedcontent new user creds newusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals test user id testuserid json obj jsonobj get string getstring userid test test create user missing user id testcreateusermissinguserid io exception ioexception string post url posturl http test httptest http base url system user manager usermanager user create html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams test test create user missing pwd testcreateusermissingpwd io exception ioexception string post url posturl http test httptest http base url system user manager usermanager user create html string user id userid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair user id userid credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams test test create user wrong confirm pwd testcreateuserwrongconfirmpwd io exception ioexception string post url posturl http test httptest http base url system user manager usermanager user create html string user id userid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair user id userid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams test test create user user already exists testcreateuseruseralreadyexists io exception ioexception string post url posturl http test httptest http base url system user manager usermanager user create html test user id testuserid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair test user id testuserid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams post info fail assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams form action system user manager usermanager user create html method post div input type text test user testuser div div password input type text pwd test user testuser div div password confirm input type text pwd confirm pwdconfirm test user testuser div div extra property input type text display name displayname test user div div extra property input type text url http apache org div input type sub mit submit sub mit submit form test test create user with extra properties testcreateuserwithextraproperties io exception ioexception json exception jsonexception string post url posturl http test httptest http base url system user manager usermanager user create html test user id testuserid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair test user id testuserid post params postparams add name value pair namevaluepair marker test user id testuserid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd post params postparams add name value pair namevaluepair display name displayname test user post params postparams add name value pair namevaluepair url http apache org credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams fetch user profile json verify settings string get url geturl http test httptest http base url system user manager usermanager user test user id testuserid json string json get authenticated content getauthenticatedcontent creds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals test user id testuserid json obj jsonobj get string getstring marker assert equals assertequals test user json obj jsonobj get string getstring display name displayname assert equals assertequals http apache org json obj jsonobj get string getstring url assert false assertfalse json obj jsonobj assert false assertfalse json obj jsonobj pwd assert false assertfalse json obj jsonobj pwd confirm pwdconfirm test sling verify user registration anonymous user allowed test test anonymous self registration disabled testanonymousselfregistrationdisabled io exception ioexception string post url posturl http test httptest http base url system user manager usermanager user create html string user id userid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair user id userid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd user create logging privileged user error get http client gethttpclient get state getstate clear credentials clearcredentials assert post status assertpoststatus post url posturl http servlet response httpservletresponse internal server error post params postparams test sling test test create user response as n testcreateuserresponseasjson io exception ioexception json exception jsonexception string post url posturl http test httptest http base url system user manager usermanager user create json test user id testuserid test user testuser random next int nextint list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair test user id testuserid post params postparams add name value pair namevaluepair marker test user id testuserid post params postparams add name value pair namevaluepair pwd test pwd testpwd post params postparams add name value pair namevaluepair pwd confirm pwdconfirm test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin string json get authenticated post content getauthenticatedpostcontent creds post url posturl http test httptest content type json post params postparams http servlet response httpservletresponse json response parsed json object json object jsonobject json obj jsonobj json object jsonobject json assert not null assertnotnull json obj jsonobj
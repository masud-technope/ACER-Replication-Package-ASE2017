licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr resources ecurity resourcesecurity impl java util map javax jcr repository exception repositoryexception javax jcr session org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations configuration policy configurationpolicy org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling commons osgi properties util propertiesutil org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate org apache sling resource accesssecurity resourceaccesssecurity resource access gate resourceaccessgate component configuration factory configurationfactory policy configuration policy configurationpolicy require metatype label apache sling jcr resource access gate description access gate handle access resources backed jcr repository providing acl s acls repos iory reposiory service resource access gate resourceaccessgate properties property resource access gate resourceaccessgate path label path description path regular expression resources service called property resource access gate factory resourceaccessgatefactory prop prefix label deep check prefix description configured prefix resource path starts prefix prefix removed path remaining appended jcr path check foo required prefix configured foo jcr node check check permissions check checked property resource access gate factory resourceaccessgatefactory prop jcr path label jcr node description node checked permissions resources property resource access gate resourceaccessgate operations read create update delete property private propertyprivate property resource access gate resourceaccessgate context resource access gate resourceaccessgate provider context property private propertyprivate resource access gate factory resourceaccessgatefactory all owing resource access gate allowingresourceaccessgate resource access gate resourceaccessgate string prop jcr path jcr path jcrpath string prop prefix check path checkpath prefix string jcr path jcrpath string prefix activate activate map string object props jcr path jcrpath properties util propertiesutil to string tostring props prop jcr path prefix properties util propertiesutil to string tostring props prop prefix prefix prefix ends with endswith prefix prefix check permission gate result gateresult check permission checkpermission resource resolver resourceresolver resolver string path string permission granted session session resolver adapt to adaptto session session string check path checkpath jcr path jcrpath prefix path starts with startswith prefix check path checkpath jcr path jcrpath path substring prefix length granted session has permission haspermission check path checkpath permission repository exception repositoryexception granted gate result gateresult granted gate result gateresult denied org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate has read restrictions hasreadrestrictions org apache sling api resource resource resolver resourceresolver override has read restrictions hasreadrestrictions resource resolver resourceresolver resource resolver resourceresolver org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate has create restrictions hascreaterestrictions org apache sling api resource resource resolver resourceresolver override has create restrictions hascreaterestrictions resource resolver resourceresolver resource resolver resourceresolver org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate has update restrictions hasupdaterestrictions org apache sling api resource resource resolver resourceresolver override has update restrictions hasupdaterestrictions resource resolver resourceresolver resource resolver resourceresolver org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate has delete restrictions hasdeleterestrictions org apache sling api resource resource resolver resourceresolver override has delete restrictions hasdeleterestrictions resource resolver resourceresolver resource resolver resourceresolver org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate can read canread org apache sling api resource resource override gate result gateresult can read canread resource resource check permission checkpermission resource get resource resolver getresourceresolver resource get path getpath session action read org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate can delete candelete org apache sling api resource resource override gate result gateresult can delete candelete resource resource check permission checkpermission resource get resource resolver getresourceresolver resource get path getpath session action remove org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate can update canupdate org apache sling api resource resource override gate result gateresult can update canupdate resource resource check permission checkpermission resource get resource resolver getresourceresolver resource get path getpath session action property org apache sling resource accesssecurity resourceaccesssecurity all owing resource access gate allowingresourceaccessgate can create cancreate java lang string org apache sling api resource resource resolver resourceresolver override gate result gateresult can create cancreate string abs path name abspathname resource resolver resourceresolver resource resolver resourceresolver check permission checkpermission resource resolver resourceresolver abs path name abspathname session action add node
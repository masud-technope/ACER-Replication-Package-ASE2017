licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest java io exception ioexception java util arrays java util hash map hashmap java util list java util map org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient methods get method getmethod org apache sling commons json json exception jsonexception org apache sling commons testing int egration integration http test base httptestbase org apache sling launchpad webapp int egrationtest integrationtest util events counter util eventscounterutil org apache sling servlets post sling post constants slingpostconstants tests sling vanity path vanitypath mixin support vanity path test vanitypathtest http test base httptestbase string post url posturl string vanity path vanitypath string vanity url vanityurl mapping event count mappingeventcount string mapping update topic org apache sling api resource resource resolver mapping resourceresolvermapping changed override set up setup exception set up setup create test node path specific collisions post url posturl http base url get class getclass get simple name getsimplename system current time millis currenttimemillis sling post constants slingpostconstants create suffix vanity path vanitypath get class getclass get simple name getsimplename system current time millis currenttimemillis vanity vanity url vanityurl http base url vanity path vanitypath reset mapping event count resetmappingeventcount reset mapping event count resetmappingeventcount json exception jsonexception io exception ioexception mapping event count mappingeventcount events counter util eventscounterutil get events count geteventscount mapping update topic test vanity path internal redirect test internal redirect testinternalredirect io exception ioexception create node vanity path map string string props hash map hashmap string string props jcr mixin types mixintypes sling vanity path vanitypath props sling vanity path vanitypath vanity path vanitypath string created node url creatednodeurl test client testclient create node createnode post url posturl props string created path createdpath created node url creatednodeurl substring http base url length wait for map reload waitformapreload created node redirects get method getmethod get method getmethod vanity url vanityurl set follow redirects setfollowredirects status http client httpclient execute method executemethod expect redirect assert equals assertequals status assert true asserttrue get response body as string getresponsebodyasstring created path createdpath test vanity path redirect test redirect io exception ioexception create node vanity path map string string props hash map hashmap string string props jcr mixin types mixintypes sling vanity path vanitypath props sling vanity path vanitypath vanity path vanitypath props sling redirect string created node url creatednodeurl test client testclient create node createnode post url posturl props wait for map reload waitformapreload created node vanity path redirects get method getmethod get method getmethod vanity url vanityurl set follow redirects setfollowredirects status http client httpclient execute method executemethod expect temporary redirect assert equals assertequals status created node string location get response header getresponseheader location get value getvalue assert not null assertnotnull location assert equals assertequals remove http base removehttpbase created node url creatednodeurl html location test vanity path redirect test redirect io exception ioexception create node vanity path map string string props hash map hashmap string string props jcr mixin types mixintypes sling vanity path vanitypath props sling vanity path vanitypath vanity path vanitypath props sling redirect props sling redirect status redirectstatus string created node url creatednodeurl test client testclient create node createnode post url posturl props wait for map reload waitformapreload created node redirects get method getmethod get method getmethod vanity url vanityurl set follow redirects setfollowredirects status http client httpclient execute method executemethod expect per manent permanent redirect assert equals assertequals status created node string location get response header getresponseheader location get value getvalue assert not null assertnotnull location assert equals assertequals remove http base removehttpbase created node url creatednodeurl html location test vanity path redirect html extension selector test redirect keeping extension and selector testredirectkeepingextensionandselector io exception ioexception create node vanity path map string string props hash map hashmap string string props jcr mixin types mixintypes sling vanity path vanitypath props sling vanity path vanitypath vanity path vanitypath props sling redirect string created node url creatednodeurl test client testclient create node createnode post url posturl props wait for map reload waitformapreload created node vanity path redirects get method getmethod get method getmethod vanity url vanityurl test json set follow redirects setfollowredirects status http client httpclient execute method executemethod expect temporary redirect assert equals assertequals status created node string location get response header getresponseheader location get value getvalue assert not null assertnotnull location assert equals assertequals remove http base removehttpbase created node url creatednodeurl test json location test vanity path path extension redirect test redirect on path with extension testredirectonpathwithextension io exception ioexception json exception jsonexception create node vanity path map string string props hash map hashmap string string props jcr mixin types mixintypes sling vanity path vanitypath props sling vanity path vanitypath vanity path vanitypath props sling redirect string created node url creatednodeurl test client testclient create node createnode post url posturl props wait for map reload waitformapreload reset mapping event count resetmappingeventcount string path with extension pathwithextension remove http base removehttpbase created node url creatednodeurl ext list name value pair namevaluepair move params moveparams arrays as list aslist name value pair namevaluepair dest path with extension pathwithextension name value pair namevaluepair operation move assert post status assertpoststatus created node url creatednodeurl move params moveparams move created node created node url creatednodeurl created node url creatednodeurl created node url creatednodeurl ext wait for map reload waitformapreload created node vanity path redirects get method getmethod get method getmethod vanity url vanityurl set follow redirects setfollowredirects status http client httpclient execute method executemethod assert equals assertequals expecting temporary redirect status created node string location get response header getresponseheader location get value getvalue assert not null assertnotnull expecting location location assert equals assertequals expecting redirect extension path with extension pathwithextension location string remove http base removehttpbase string url url starts with startswith http base url url substring http base url length url wait mapping update topic events assuming mapping event count mappingeventcount reset making content wait for map reload waitformapreload events counter util eventscounterutil wait for event waitforevent mapping update topic mapping event count mappingeventcount
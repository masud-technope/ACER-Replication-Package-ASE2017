licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling extensions leak detector leakdetector internal java print writer printwriter java lang management management factory managementfactory java lang management runtimemxbean java lang phantom reference phantomreference java lang reference java lang reference queue referencequeue java text simple date format simpledateformat java util array list arraylist java util collections java util java util dictionary java util hash set hashset java util hashtable java util iterator java util list java util java util concurrent concurrent hash map concurrenthashmap java util concurrent concurrent map concurrentmap org osgi framework bundle org osgi framework bundle activator bundleactivator org osgi framework bundle context bundlecontext org osgi framework bundle event bundleevent org osgi framework constants org osgi framework wiring bundle wiring bundlewiring org osgi util tracker bundle tracker bundletracker org slf logger org slf logger factory loggerfactory leak detector leakdetector runnable bundle activator bundleactivator phantom references phantomreferences phantom reference phantomreference analyzing heap dump roots class load ers classloaders suspected points leak detector leakdetector held phantom reference phantomreference normal positive reference collections synchronized set synchronizedset hash set hashset reference lock control concurrent access internal data str uctures structures object leak detector lock leakdetectorlock object reference queue referencequeue class loader classloader queue reference queue referencequeue class loader classloader concurrent map concurrentmap bundle info bundleinfo bundle infos bundleinfos concurrent hash map concurrenthashmap bundle info bundleinfo logger log logger factory loggerfactory get logger getlogger get class getclass thread reference poller referencepoller bundle context bundlecontext context bundle tracker bundletracker bundle tracker bundletracker start bundle context bundlecontext context context context bundle tracker bundletracker leak detector bundle tracker leakdetectorbundletracker context reference poller referencepoller thread bundle leak detector thread reference poller referencepoller set daemon setdaemon reference poller referencepoller start dictionary string object printer props printerprops hashtable string object printer props printerprops constants service vendor apache software foundation printer props printerprops constants service description sling log configuration printer printer props printerprops felix webconsole label leak detector leakdetector printer props printerprops felix webconsole title class loader classloader leak detector printer props printerprops felix webconsole config printer configprinter modes context register service registerservice leak detector leakdetector get name getname printer props printerprops bundle context bundlecontext context bundle tracker bundletracker close reference poller referencepoller int errupt interrupt leak detector bundle tracker leakdetectorbundletracker bundle tracker bundletracker leak detector bundle tracker leakdetectorbundletracker bundle context bundlecontext context listen started context bundle active open override object adding bundle addingbundle bundle bundle bundle event bundleevent event leak detector lock leakdetectorlock register bundle registerbundle bundle bundle register bundle registerbundle bundle bundle class loader classloader get class loader getclassloader bundle fragment bundle bundle reference bundlereference bundle reference bundlereference bundle add note bundle started multiple times ref res hed refreshed account bundle info bundleinfo bundle infos bundleinfos bundle get bundle id getbundleid bundle info bundleinfo bundle bundle infos bundleinfos bundle get bundle id getbundleid increment usage count incrementusagecount log info registered bundle class loader classloader class loader info classloaderinfo callback thread current thread currentthread is interrupted isinterrupted bundle reference bundlereference bundle reference bundlereference queue remove remove bundle removebundle interrupted exception interruptedexception log info shutting reference collector class loader classloader leak detector leakdetector drain queue bundle reference bundlereference bundle reference bundlereference queue poll remove bundle removebundle remove bundle removebundle bundle reference bundlereference bundle info bundleinfo bundle infos bundleinfos bundle id bundleid leak detector lock leakdetectorlock decrement usage count decrementusagecount remove clear log info detected garbage collection bundle class loader classloader class loader info classloaderinfo configuration printer org apache felix webconsole configuration printer configurationprinter print configuration printconfiguration java print writer printwriter suppress warnings suppresswarnings unused declaration unuseddeclaration print configuration printconfiguration print writer printwriter force todo user explicitly felix web console system active bundle ids activebundleids hash set hashset bundle context get bundles getbundles active bundle ids activebundleids add get bundle id getbundleid list bundle info bundleinfo suspicious bundles suspiciousbundles array list arraylist bundle info bundleinfo bundle infos bundleinfos values iterator bundle info bundleinfo itr suspicious bundles suspiciousbundles iterator itr has next hasnext bundle info bundleinfo itr class loader classloader created has single instance hassingleinstance active bundle ids activebundleids bundle id bundleid itr remove suspicious bundles suspiciousbundles is empty isempty println class loader classloader leak detected println class loader classloader leak detected printf number suspicious bundles suspicious bundles suspiciousbundles size println string tab bundle info bundleinfo suspicious bundles suspiciousbundles printf printf bundle tab bundle id bundleid printf leaked class load ers classloaders tab class loader info classloaderinfo leaked class loaders leakedclassloaders printf tab tab println add help addhelp add help addhelp print writer printwriter runtimemxbean bean management factory managementfactory getruntimemxbean list string arg list arglist bean get input arguments getinputarguments contains required args containsrequiredargs arg list arglist use conc mark sweep c useconcmarksweepgc arg list arglist c ms class unloading enabled cmsclassunloadingenabled contains required args containsrequiredargs println required options missing println println leak detector rel ies relies garbage collection class load ers classloaders println class load ers classloaders garbage collected enable garbage collection println class loader classloader start jvm options println println use conc mark sweep c useconcmarksweepgc c ms class unloading enabled cmsclassunloadingenabled bundle info bundleinfo string symbolic name symbolicname string version bundle id bundleid class loader info classloaderinfo class loader infos classloaderinfos collections synchronized set synchronizedset hash set hashset class loader info classloaderinfo bundle info bundleinfo bundle symbolic name symbolicname get symbolic name getsymbolicname version get version getversion to string tostring bundle id bundleid get bundle id getbundleid increment usage count incrementusagecount bundle reference bundlereference class loader infos classloaderinfos add class loader info classloaderinfo decrement usage count decrementusagecount bundle reference bundlereference class loader infos classloaderinfos remove class loader info classloaderinfo has single instance hassingleinstance class loader infos classloaderinfos size list class loader info classloaderinfo leaked class loaders leakedclassloaders has single instance hassingleinstance array list arraylist class loader info classloaderinfo class loader infos classloaderinfos list class loader info classloaderinfo cis array list arraylist class loader info classloaderinfo class loader infos classloaderinfos collections sort cis running bundle cis sub list sublist cis size override string to string tostring string format class loader classloader count symbolic name symbolicname version class loader infos classloaderinfos size class loader info classloaderinfo comparable class loader info classloaderinfo creation time creationtime system current time millis currenttimemillis hash code hashcode collide class load ers classloaders hard reference class loader classloader reference system hash code systemhashcode assume unqiue wrt class loader classloader instances system hash code systemhashcode class loader info classloaderinfo class loader classloader system hash code systemhashcode system identity hash code identityhashcode compare to compareto class loader info classloaderinfo creation time creationtime compare to compareto creation time creationtime string get address getaddress to hex string tohexstring system hash code systemhashcode string get creation date getcreationdate simple date format simpledateformat date format dateformat simple date format simpledateformat yyyy sss date format dateformat format creation time creationtime override equals object get class getclass get class getclass class loader info classloaderinfo class loader info classloaderinfo system hash code systemhashcode system hash code systemhashcode override hash code hashcode system hash code systemhashcode system hash code systemhashcode override string to string tostring string format identity hash code hashcode creation time get address getaddress get creation date getcreationdate bundle reference bundlereference phantom reference phantomreference class loader classloader bundle id bundleid class loader info classloaderinfo class loader info classloaderinfo bundle reference bundlereference bundle bundle class loader classloader queue bundle id bundleid bundle get bundle id getbundleid class loader info classloaderinfo class loader info classloaderinfo class loader classloader get class loader getclassloader bundle fails compile jdk explicit helps bundle wiring bundlewiring bundle wiring bundlewiring adapt bundle wiring bundlewiring get class loader getclassloader
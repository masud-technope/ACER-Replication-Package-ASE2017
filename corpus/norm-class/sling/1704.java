licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling maven project support projectsupport org apache sling maven project support projectsupport abstract using bundle list mojo abstractusingbundlelistmojo bundle path prefix org apache sling maven project support projectsupport abstract using bundle list mojo abstractusingbundlelistmojo config path prefix java file java file filter filefilter java i o exception ioexception java input stream inputstream java net malformedurlexception java net url java util array list arraylist java util collection java util collections java util hash set hashset java util iterator java util list java util org apache commons file name utils filenameutils org apache maven artifact artifact org apache maven plugin mojo execution exception mojoexecutionexception org apache maven plugin logging log org apache sling launchpad api launchpad content provider launchpadcontentprovider org apache sling maven project support projectsupport bundle list bundlelist bundle org apache sling maven project support projectsupport bundle list bundlelist bundle list bundlelist org apache sling maven project support projectsupport bundle list bundlelist start level startlevel launchpad content provider launchpadcontentprovider resources based bundle list bundlelist resources specific module bundle list content provider bundlelistcontentprovider launchpad content provider launchpadcontentprovider string install path prefix resources install bootstrap def start level actual bootstrap start level file resource provider root resourceproviderroot list string empty string list collections empty list emptylist bundle list content provider bundlelistcontentprovider file resource provider root resourceproviderroot resource provider root resourceproviderroot resource provider root resourceproviderroot iterator string handle bundle path root handlebundlepathroot string path string levels hash set hashset string start level startlevel level get initialized bundle list getinitializedbundlelist get start levels getstartlevels bundles install folder support modes level get start level getstartlevel bootstrap def start level levels add bundle path prefix actual bootstrap start level levels iterator iterator string handle config path handleconfigpath get config directory getconfigdirectory exists get config directory getconfigdirectory is directory isdirectory file config files configfiles get config directory getconfigdirectory list files listfiles list string file names filenames array list arraylist string file cfg file cfgfile config files configfiles file names filenames add config path prefix cfg file cfgfile get name getname file names filenames iterator empty string list iterator iterator string handle bundles sub folder handlebundlessubfolder string path iterator string result string start level info startlevelinfo path substring bundle path prefix length start level startlevel integer parse int parseint start level info startlevelinfo assigned bootstrap bundles start level startlevel actual bootstrap start level list string bundles array list arraylist string add bundles addbundles bundles actual bootstrap start level add bundles addbundles bundles bootstrap def start level result bundles iterator number format exception numberformatexception get log getlog warn invalid start level start level info startlevelinfo path path result add bundles addbundles collection string bundles start level startlevel string run mode runmode start level startlevel level get initialized bundle list getinitializedbundlelist get start levels getstartlevels level get start level getstartlevel start level startlevel bundle bundle level get bundles getbundles run mode matches runmodematches bundle run mode runmode artifact definition artifactdefinition artifact definition artifactdefinition bundle start level startlevel artifact artifact get artifact getartifact bundles add artifact get file getfile touri tourl to external form toexternalform exception get log getlog error unable resolve artifact run mode matches runmodematches bundle string run mode runmode run mode runmode run mode runmode length get run modes getrunmodes get run modes getrunmodes length get run modes getrunmodes get run modes getrunmodes run mode runmode iterator string handle resources root handleresourcesroot string sub dirs subdirs hash set hashset string sub dirs subdirs add bundle path prefix sub dirs subdirs add config path prefix sub dirs subdirs add resources core bundles corebundles sub dirs subdirs add install path prefix compute modes bundles string run modes runmodes hash set hashset string start level startlevel level get initialized bundle list getinitializedbundlelist get start levels getstartlevels bundle bundle level get bundles getbundles string modes bundle get run modes getrunmodes modes modes length string modes split run modes runmodes add add install sub dir subdir mode string run modes runmodes sub dirs subdirs add install path prefix sub dirs subdirs iterator add folder child path prefix start levels provide bundles mode add start level sub dirs addstartlevelsubdirs collection string children string path string run mode runmode start level startlevel level get initialized bundle list getinitializedbundlelist get start levels getstartlevels list string bundles array list arraylist string add bundles addbundles bundles level get start level getstartlevel run mode runmode bundles is empty isempty folder level folderlevel level get start level getstartlevel folder level folderlevel bootstrap def start level folder level folderlevel actual bootstrap start level children add path folder level folderlevel iterator string handle install path handleinstallpath string path extract optional mode start level path ends with endswith path path substring path length string parts path substring install path prefix length split parts length illegal state exception illegalstateexception parse path path string run mode runmode parts length parts substring string start level info startlevelinfo parts length parts string result hash set hashset string run mode runmode start level info startlevelinfo root folder add sub dir subdir start level bundles add start level sub dirs addstartlevelsubdirs result install path prefix start level info startlevelinfo root mode folder sub dir subdir start level bundles add start level sub dirs addstartlevelsubdirs result path run mode runmode folder bundles add bundles addbundles result integer parse int parseint start level info startlevelinfo run mode runmode number format exception numberformatexception get log getlog warn invalid start level info start level info startlevelinfo path path result iterator iterator string handle config sub path handleconfigsubpath string path file get config file getconfigfile path exists get log getlog warn bundle list content provider bundlelistcontentprovider children config path path empty string list iterator is file isfile empty string list iterator file config files configfiles list files listfiles list string file names filenames array list arraylist string file cfg file cfgfile config files configfiles file names filenames add path cfg file cfgfile get name getname file names filenames iterator file get config file getconfigfile string path file file name utils filenameutils concat get config directory getconfigdirectory get absolute path getabsolutepath path substring config path prefix length iterator string get children getchildren string path iterator string result path equals bundle path prefix result handle bundle path root handlebundlepathroot path path equals resources core bundles corebundles result empty string list iterator path equals config path prefix result handle config path handleconfigpath path starts with startswith config path prefix result handle config sub path handleconfigsubpath path path starts with startswith bundle path prefix result handle bundles sub folder handlebundlessubfolder path path starts with startswith install path prefix result handle install path handleinstallpath path path equals resources result handle resources root handleresourcesroot path starts with startswith file client files file file url s urls point maven artifacts result empty string list iterator get log getlog warn bundle list content provider bundlelistcontentprovider children path path result url get resource getresource string path path starts with startswith config path prefix file config file configfile get config file getconfigfile path config file configfile exists config file configfile touri tourl malformedurlexception file resource file resourcefile file resource provider root resourceproviderroot path resource file resourcefile exists resource file resourcefile touri tourl malformedurlexception get log getlog error unable create url file url from classpath fromclasspath get class getclass get resource getresource path from classpath fromclasspath from classpath fromclasspath url path malformedurlexception input stream inputstream get resource as stream getresourceasstream string path url res get resource getresource path res res open stream openstream i o exception ioexception ioe resource bundle list bundlelist get initialized bundle list getinitializedbundlelist file get config directory getconfigdirectory artifact get artifact getartifact artifact definition artifactdefinition def mojo execution exception mojoexecutionexception log get log getlog
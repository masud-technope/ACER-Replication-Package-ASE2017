licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr jackrabbit access manager accessmanager java security principal java util arrays java util hash set hashset java util iterator java util linked hash map linkedhashmap java util locale java util map java util resource bundle resourcebundle java util javax jcr node javax jcr repository exception repositoryexception javax jcr session javax jcr security access control entry accesscontrolentry javax jcr security access control list accesscontrollist javax jcr security access control manager accesscontrolmanager javax jcr security access control policy accesscontrolpolicy javax jcr security privilege org apache sling jcr base util access control util accesscontrolutil helper assist usage access control scripts privileges info privilegesinfo supported privileges node param node node check array privileges repository exception repositoryexception privilege get supported privileges getsupportedprivileges node node repository exception repositoryexception get supported privileges getsupportedprivileges node get session getsession node get path getpath returns supported privileges path param session session current user param abs path abspath path privileges array privileges repository exception repositoryexception privilege get supported privileges getsupportedprivileges session session string abs path abspath repository exception repositoryexception access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session privilege supported privileges supportedprivileges access control manager accesscontrolmanager get supported privileges getsupportedprivileges abs path abspath supported privileges supportedprivileges wrapper holds privileges granted denied specific principal access rights accessrights privilege granted hash set hashset privilege privilege denied hash set hashset privilege resource bundle resourcebundle res bundle resbundle resource bundle resourcebundle get resource bundle getresourcebundle locale locale res bundle resbundle res bundle resbundle get locale getlocale equals locale res bundle resbundle resource bundle resourcebundle get bundle getbundle get class getclass get package getpackage get name getname privileges resources privilegesresources locale res bundle resbundle privilege get granted getgranted granted privilege get denied getdenied denied string get privilege set display name getprivilegesetdisplayname locale locale denied denied is empty isempty denied privileges custom privilege get resource bundle getresourcebundle locale get string getstring privilegeset custom granted is empty isempty appears empty privilege get resource bundle getresourcebundle locale get string getstring privilegeset granted size check single privilege jcr jcr read iterator privilege iterator granted iterator privilege iterator jcr equals get name getname full control privilege get resource bundle getresourcebundle locale get string getstring privilegeset jcr read equals get name getname read only readonly privilege get resource bundle getresourcebundle locale get string getstring privilegeset read only readonly granted size check privileges jcr read jcr write iterator privilege iterator granted iterator privilege iterator privilege iterator jcr read equals get name getname jcr write equals get name getname jcr read equals get name getname jcr write equals get name getname read write privileges get resource bundle getresourcebundle locale get string getstring privilegeset read write readwrite privileges get resource bundle getresourcebundle locale get string getstring privilegeset custom returns mapping declared access rights resource path param node node access rights map access rights key user group principal granted denied privileges repository exception repositoryexception map principal access rights accessrights get declared access rights getdeclaredaccessrights node node repository exception repositoryexception map principal access rights accessrights access rights accessrights get declared access rights getdeclaredaccessrights node get session getsession node get path getpath access rights accessrights returns mapping declared access rights resource path param session current user session param abs path abspath path resource access rights map access rights key user group principal granted denied privileges repository exception repositoryexception map principal access rights accessrights get declared access rights getdeclaredaccessrights session session string abs path abspath repository exception repositoryexception map principal access rights accessrights access map accessmap linked hash map linkedhashmap principal access rights accessrights access control entry accesscontrolentry entries get declared access control entries getdeclaredaccesscontrolentries session abs path abspath entries access control entry accesscontrolentry ace entries principal principal ace get principal getprincipal access rights accessrights access privileges accessprivileges access map accessmap principal access privileges accessprivileges access privileges accessprivileges access rights accessrights access map accessmap principal access privileges accessprivileges access control util accesscontrolutil is allow isallow ace access privileges accessprivileges get granted getgranted add all addall arrays as list aslist ace get privileges getprivileges access privileges accessprivileges get denied getdenied add all addall arrays as list aslist ace get privileges getprivileges access map accessmap access control entry accesscontrolentry get declared access control entries getdeclaredaccesscontrolentries session session string abs path abspath repository exception repositoryexception access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get policies getpolicies abs path abspath access control policy accesscontrolpolicy access control policy accesscontrolpolicy policies access control policy accesscontrolpolicy access control list accesscontrollist access control entry accesscontrolentry access control entries accesscontrolentries access control list accesscontrollist access control policy accesscontrolpolicy get access control entries getaccesscontrolentries access control entries accesscontrolentries access control entry accesscontrolentry returns declared access rights node principal id principalid param node jcr node retrieve access rights param principal id principalid principal id principalid access rights access rights principal repository exception repositoryexception access rights accessrights get declared access rights for principal getdeclaredaccessrightsforprincipal node node string principal id principalid repository exception repositoryexception get declared access rights for principal getdeclaredaccessrightsforprincipal node get session getsession node get path getpath principal id principalid returns declared access rights resource path principal id principalid param session current jcr session param abs path abspath path resource retrieve rights param principal id principalid principal id principalid access rights access rights principal repository exception repositoryexception access rights accessrights get declared access rights for principal getdeclaredaccessrightsforprincipal session session string abs path abspath string principal id principalid repository exception repositoryexception access rights accessrights rights access rights accessrights principal id principalid principal id principalid length access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get policies getpolicies abs path abspath access control policy accesscontrolpolicy access control policy accesscontrolpolicy policies access control policy accesscontrolpolicy access control list accesscontrollist access control entry accesscontrolentry access control entries accesscontrolentries access control list accesscontrollist access control policy accesscontrolpolicy get access control entries getaccesscontrolentries access control entry accesscontrolentry ace access control entries accesscontrolentries principal id principalid equals ace get principal getprincipal get name getname is allow isallow access control util accesscontrolutil is allow isallow ace is allow isallow rights get granted getgranted add all addall arrays as list aslist ace get privileges getprivileges rights get denied getdenied add all addall arrays as list aslist ace get privileges getprivileges rights returns mapping effective access rights resource path param node node access rights map access rights key user group principal granted denied privileges repository exception repositoryexception map principal access rights accessrights get effective access rights geteffectiveaccessrights node node repository exception repositoryexception map principal access rights accessrights access rights accessrights get effective access rights geteffectiveaccessrights node get session getsession node get path getpath access rights accessrights returns mapping effective access rights resource path param session current user session param abs path abspath path resource access rights map access rights key user group principal granted denied privileges repository exception repositoryexception map principal access rights accessrights get effective access rights geteffectiveaccessrights session session string abs path abspath repository exception repositoryexception map principal access rights accessrights access map accessmap linked hash map linkedhashmap principal access rights accessrights access control entry accesscontrolentry entries get effective access control entries geteffectiveaccesscontrolentries session abs path abspath entries access control entry accesscontrolentry ace entries principal principal ace get principal getprincipal access rights accessrights access privleges accessprivleges access map accessmap principal access privleges accessprivleges access privleges accessprivleges access rights accessrights access map accessmap principal access privleges accessprivleges access control util accesscontrolutil is allow isallow ace access privleges accessprivleges get granted getgranted add all addall arrays as list aslist ace get privileges getprivileges access privleges accessprivleges get denied getdenied add all addall arrays as list aslist ace get privileges getprivileges access map accessmap access control entry accesscontrolentry get effective access control entries geteffectiveaccesscontrolentries session session string abs path abspath repository exception repositoryexception access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get effective policies geteffectivepolicies abs path abspath access control policy accesscontrolpolicy access control policy accesscontrolpolicy policies access control policy accesscontrolpolicy access control list accesscontrollist access control entry accesscontrolentry access control entries accesscontrolentries access control list accesscontrollist access control policy accesscontrolpolicy get access control entries getaccesscontrolentries access control entries accesscontrolentries access control entry accesscontrolentry returns effective access rights node principal id principalid param node jcr node retrieve access rights param principal id principalid principal id principalid access rights access rights principal repository exception repositoryexception access rights accessrights get effective access rights for principal geteffectiveaccessrightsforprincipal node node string principal id principalid repository exception repositoryexception get effective access rights for principal geteffectiveaccessrightsforprincipal node get session getsession node get path getpath principal id principalid returns effective access rights resource path principal id principalid param session current jcr session param abs path abspath path resource retrieve rights param principal id principalid principal id principalid access rights access rights principal repository exception repositoryexception access rights accessrights get effective access rights for principal geteffectiveaccessrightsforprincipal session session string abs path abspath string principal id principalid repository exception repositoryexception access rights accessrights rights access rights accessrights principal id principalid principal id principalid length access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get effective policies geteffectivepolicies abs path abspath access control policy accesscontrolpolicy access control policy accesscontrolpolicy policies access control policy accesscontrolpolicy access control list accesscontrollist access control entry accesscontrolentry access control entries accesscontrolentries access control list accesscontrollist access control policy accesscontrolpolicy get access control entries getaccesscontrolentries access control entry accesscontrolentry ace access control entries accesscontrolentries principal id principalid equals ace get principal getprincipal get name getname is allow isallow access control util accesscontrolutil is allow isallow ace is allow isallow rights get granted getgranted add all addall arrays as list aslist ace get privileges getprivileges rights get denied getdenied add all addall arrays as list aslist ace get privileges getprivileges rights checks current user granted privileges add children node param node node check current user privileges can add children canaddchildren node node can add children canaddchildren node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges add children path param session jcr session current user param abs path abspath path resource check current user privileges can add children canaddchildren session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr add child nodes repository exception repositoryexception checks current user granted privileges delete children node param node node check current user privileges can delete children candeletechildren node node can delete children candeletechildren node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges delete children path param session jcr session current user param abs path abspath path resource check current user privileges can delete children candeletechildren session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr remove child nodes repository exception repositoryexception checks current user granted privileges delete node param node node check current user privileges can delete candelete node node can delete candelete node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges delete path param session jcr session current user param abs path abspath path resource check current user privileges can delete candelete session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session string parent path parentpath last slash lastslash abs path abspath last index of lastindexof last slash lastslash parent root folder parent path parentpath str ip strip segment parent path parentpath abs path abspath substring last slash lastslash can delete candelete access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr remove node can delete children candeletechildren session parent path parentpath can delete candelete repository exception repositoryexception checks current user granted privileges modify properties node param node node check current user privileges can modify properties canmodifyproperties node node can modify properties canmodifyproperties node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges modify properties path param session jcr session current user param abs path abspath path resource check current user privileges can modify properties canmodifyproperties session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr modify properties repository exception repositoryexception checks current user granted privileges read access control node param node node check current user privileges can read access control canreadaccesscontrol node node can read access control canreadaccesscontrol node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges read access control path param session jcr session current user param abs path abspath path resource check current user privileges can read access control canreadaccesscontrol session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr read access control repository exception repositoryexception checks current user granted privileges modify access control node param node node check current user privileges can modify access control canmodifyaccesscontrol node node can modify access control canmodifyaccesscontrol node get session getsession node get path getpath repository exception repositoryexception checks current user granted privileges modify access control path param session jcr session current user param abs path abspath path resource check current user privileges can modify access control canmodifyaccesscontrol session session string abs path abspath access control manager accesscontrolmanager access control manager accesscontrolmanager access control util accesscontrolutil get access control manager getaccesscontrolmanager session access control manager accesscontrolmanager has privileges hasprivileges abs path abspath privilege access control manager accesscontrolmanager privilege from name privilegefromname privilege jcr modify access control repository exception repositoryexception
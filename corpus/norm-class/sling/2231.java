licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl compiler optimization java util array list arraylist java util list java util stack org apache sling scripting sightly impl compiler ris command org apache sling scripting sightly impl compiler ris command stream commandstream org apache sling scripting sightly impl compiler ris command variable binding variablebinding org apache sling scripting sightly impl compiler util stream emitter visitor emittervisitor org apache sling scripting sightly impl compiler util stream push stream pushstream org apache sling scripting sightly impl compiler util stream streams org apache sling scripting sightly impl compiler visitor tracking visitor trackingvisitor optimization removes variables bound command stream unused variable removal unusedvariableremoval tracking visitor trackingvisitor unused variable removal unusedvariableremoval variable activity variableactivity emitter visitor emittervisitor stream transformer streamtransformer transformer stream transformer streamtransformer override command stream commandstream transform command stream commandstream in stream instream streams map in stream instream unused variable removal unusedvariableremoval push stream pushstream output stream outputstream push stream pushstream stack list command stored commands stack storedcommandsstack stack list command unused variable removal unusedvariableremoval override push stream pushstream get output stream getoutputstream output stream outputstream override visit variable binding variablebinding start variable binding start variablebindingstart push buffer store commands commands emitted variable scope stored commands stack storedcommandsstack push array list arraylist command start tracking variable tracker push variable pushvariable variable binding start variablebindingstart get variable name getvariablename variable activity variableactivity variable binding start variablebindingstart override visit variable binding variablebinding variable binding end variablebindingend activity exiting variable variable activity variableactivity variable activity variableactivity tracker peek get value getvalue tracker pop variable popvariable emit binding end emitbindingend variable activity variableactivity tracked variable pop ping popping commands delayed variable list command commands stored commands stack storedcommandsstack pop variable binding emitted binding emitted emit binding end emitbindingend variable activity variableactivity is used isused variable activity variableactivity is used isused variable binding variablebinding start variable binding start variablebindingstart variable activity variableactivity get command getcommand variable pass emit variable binding start variablebindingstart register usage variables bound expression register usage registerusage variable binding start variablebindingstart emit delayed commands command command commands emit command emit binding end emitbindingend emit variable binding end variablebindingend override variable activity variableactivity assign default assigndefault command command override on command oncommand command command register usage registerusage command emit command emit current command command delayed variable tracking process add top command list param command stream command emit command command stored commands stack storedcommandsstack is empty isempty output stream outputstream emit command list command list stored commands stack storedcommandsstack peek list add command extract variables command mark param command stream command register usage registerusage command command list string used variables usedvariables command variable usage commandvariableusage extract variables extractvariables command string used variable usedvariable used variables usedvariables variable activity variableactivity activity tracker used variable usedvariable activity activity mark used markused track activity variable binding variable activity variableactivity variable binding variablebinding start command variable activity variableactivity variable binding variablebinding start command command command mark used markused is used isused variable binding variablebinding start get command getcommand command
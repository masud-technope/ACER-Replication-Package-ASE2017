licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling models impl org junit org mockito mockito java util arrays java util collections java util hashtable org apache commons lang random string utils randomstringutils org apache sling api resource resource org apache sling api resource value map valuemap org apache sling api wrappers value map decorator valuemapdecorator org apache sling models impl injectors child resource injector childresourceinjector org apache sling models impl injectors value map injector valuemapinjector org apache sling models test models testmodels classes child model childmodel org apache sling models test models testmodels classes constructor injection constructorinjection parent model parentmodel org junit org junit test org junit runner run with runwith org mockito mock org mockito invocation invocation on mock invocationonmock org mockito run ners runners mockito unit runner mockitojunitrunner org mockito stub bin g stubbing answer org osgi framework bundle context bundlecontext org osgi service component component context componentcontext run with runwith mockito unit runner mockitojunitrunner resource model constructor test resourcemodelconstructortest mock component context componentcontext component ctx componentctx mock bundle context bundlecontext bundle context bundlecontext model adapter factory modeladapterfactory factory setup component ctx componentctx get bundle context getbundlecontext then return thenreturn bundle context bundlecontext component ctx componentctx get properties getproperties then return thenreturn hashtable string object factory model adapter factory modeladapterfactory factory activate component ctx componentctx factory bind injector bindinjector value map injector valuemapinjector service properties map servicepropertiesmap factory bind injector bindinjector child resource injector childresourceinjector service properties map servicepropertiesmap test test child model testchildmodel object first value firstvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap first map firstmap value map decorator valuemapdecorator collections singleton map singletonmap property first value firstvalue resource first child firstchild mock resource first child firstchild adapt to adaptto value map valuemap then return thenreturn first map firstmap first child firstchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel object first grand child value firstgrandchildvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap first grand child map firstgrandchildmap value map decorator valuemapdecorator collections singleton map singletonmap property first grand child value firstgrandchildvalue object second grand child value secondgrandchildvalue random string utils randomstringutils random alphabetic randomalphabetic value map valuemap second grand child map secondgrandchildmap value map decorator valuemapdecorator collections singleton map singletonmap property second grand child value secondgrandchildvalue resource first grand child firstgrandchild mock resource first grand child firstgrandchild adapt to adaptto value map valuemap then return thenreturn first grand child map firstgrandchildmap first grand child firstgrandchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel resource second grand child secondgrandchild mock resource second grand child secondgrandchild adapt to adaptto value map valuemap then return thenreturn second grand child map secondgrandchildmap second grand child secondgrandchild adapt to adaptto child model childmodel then answer thenanswer adapt to child model adapttochildmodel resource second child secondchild mock resource second child secondchild list children listchildren then return thenreturn arrays as list aslist first grand child firstgrandchild second grand child secondgrandchild iterator resource empty child emptychild mock resource empty child emptychild list children listchildren then return thenreturn collections resource empty set emptyset iterator resource res mock resource res get child getchild first child firstchild then return thenreturn first child firstchild res get child getchild second child secondchild then return thenreturn second child secondchild res get child getchild empty child emptychild then return thenreturn empty child emptychild parent model parentmodel model factory get adapter getadapter res parent model parentmodel assert not null assertnotnull model child model childmodel child model childmodel model get first child getfirstchild assert not null assertnotnull child model childmodel assert equals assertequals first value firstvalue child model childmodel get property getproperty assert equals assertequals model get grand children getgrandchildren size assert equals assertequals first grand child value firstgrandchildvalue model get grand children getgrandchildren get property getproperty assert equals assertequals second grand child value secondgrandchildvalue model get grand children getgrandchildren get property getproperty assert equals assertequals model get empty grand children getemptygrandchildren size adapt to child model adapttochildmodel answer child model childmodel override child model childmodel answer invocation on mock invocationonmock invocation throwable factory get adapter getadapter invocation get mock getmock child model childmodel
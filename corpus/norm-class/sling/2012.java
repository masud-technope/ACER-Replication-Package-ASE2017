licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting jsp jasper compiler java input stream inputstream java util hash map hashmap java util iterator javax servlet servlet context servletcontext org apache sling scripting jsp jasper jasper exception jasperexception org apache sling scripting jsp jasper compiler tag plugin tagplugin tag plugin tagplugin org apache sling scripting jsp jasper compiler tag plugin tagplugin tag plugin context tagplugincontext org apache sling scripting jsp jasper xml parser xmlparser parser utils parserutils org apache sling scripting jsp jasper xml parser xmlparser tree node treenode tag plugin manager tagpluginmanager string tag plugins xml web inf tag plugins tagplugins xml string tag plugins root elem tag plugins initialized hash map hashmap tag plugins tagplugins servlet context servletcontext ctxt page info pageinfo page info pageinfo tag plugin manager tagpluginmanager servlet context servletcontext ctxt ctxt ctxt apply node nodes error dispatcher errordispatcher err page info pageinfo page info pageinfo jasper exception jasperexception init err tag plugins tagplugins tag plugins tagplugins size page info pageinfo page info pageinfo visit node visitor visit node custom tag customtag jasper exception jasperexception invoke plugin invokeplugin visit body visitbody init error dispatcher errordispatcher err jasper exception jasperexception initialized input stream inputstream ctxt get resource as stream getresourceasstream tag plugins xml tree node treenode root parser utils parserutils parsexmldocument tag plugins xml root tag plugins root elem equals root get name getname err jsp error jsperror jsp error plugin wrong root element wrongrootelement tag plugins xml tag plugins root elem tag plugins tagplugins hash map hashmap iterator plugin list pluginlist root find children findchildren tag plugin plugin list pluginlist has next hasnext tree node treenode plugin node pluginnode tree node treenode plugin list pluginlist tree node treenode tag class node tagclassnode plugin node pluginnode find child findchild tag tag class node tagclassnode error string tag class tagclass tag class node tagclassnode get body getbody trim tree node treenode plugin class node pluginclassnode plugin node pluginnode find child findchild plugin plugin class node pluginclassnode error string plugin class str pluginclassstr plugin class node pluginclassnode get body getbody tag plugin tagplugin tag plugin tagplugin plugin class pluginclass get class getclass get class loader getclassloader load class loadclass plugin class str pluginclassstr tag plugin tagplugin tag plugin tagplugin plugin class pluginclass new instance newinstance exception jasper exception jasperexception tag plugin tagplugin tag plugins tagplugins tag class tagclass tag plugin tagplugin initialized invoke tag plugin custom tag plugin exists custom tag tag handler custom tag node manipulated plugin invoke plugin invokeplugin node custom tag customtag tag plugin tagplugin tag plugin tagplugin tag plugin tagplugin tag plugins tagplugins get tag handler class gettaghandlerclass get name getname tag plugin tagplugin tag plugin context tagplugincontext tag plugin context tagplugincontext tag plugin context impl tagplugincontextimpl page info pageinfo set tag plugin context settagplugincontext tag plugin context tagplugincontext tag plugin tagplugin do tag dotag tag plugin context tagplugincontext tag plugin context impl tagplugincontextimpl tag plugin context tagplugincontext node custom tag customtag node node nodes cur nodes curnodes page info pageinfo page info pageinfo hash map hashmap plugin attributes pluginattributes tag plugin context impl tagplugincontextimpl node custom tag customtag page info pageinfo page info pageinfo node page info pageinfo page info pageinfo cur nodes curnodes node nodes set at tag setatetag cur nodes curnodes cur nodes curnodes node nodes set at tag setatstag cur nodes curnodes set use tag plugin setusetagplugin plugin attributes pluginattributes hash map hashmap tag plugin context tagplugincontext get parent context getparentcontext node parent node get parent getparent parent node custom tag customtag node custom tag customtag parent get tag plugin context gettagplugincontext set plugin attribute setpluginattribute string key object plugin attributes pluginattributes key object get plugin attribute getpluginattribute string key plugin attributes pluginattributes key is script less isscriptless node get child info getchildinfo is script less isscriptless is constant attribute isconstantattribute string attribute node jsp attribute jspattribute attr get node attribute getnodeattribute attribute attr attr is literal isliteral string get constant attribute getconstantattribute string attribute node jsp attribute jspattribute attr get node attribute getnodeattribute attribute attr attr get value getvalue is attribute specified isattributespecified string attribute get node attribute getnodeattribute attribute string get temporary variable name gettemporaryvariablename jsp util jsputil next temporary variable name nexttemporaryvariablename generate import generateimport string imp page info pageinfo add import addimport imp generate declaration generatedeclaration string string text page info pageinfo is plugin declared isplugindeclared cur nodes curnodes add node declaration text node get start getstart generate java source generatejavasource string source code sourcecode cur nodes curnodes add node script let scriptlet source code sourcecode node get start getstart generate attribute generateattribute string attribute name attributename cur nodes curnodes add node attribute generator attributegenerator node get start getstart attribute name attributename node don t use tag plugin dontusetagplugin node set use tag plugin setusetagplugin generate body generatebody generate body nop fact java sources plugins produce correct order body cur nodes curnodes node get at tag getatetag node jsp attribute jspattribute get node attribute getnodeattribute string attribute node jsp attribute jspattribute attrs node get jsp attributes getjspattributes attrs attrs length attrs get name getname equals attribute attrs
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer core impl java buffered input stream bufferedinputstream java buffered output stream bufferedoutputstream java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java object input stream objectinputstream java object output stream objectoutputstream java util array list arraylist java util collection java util hash map hashmap java util hashtable java util iterator java util list java util map org apache sling installer api installable resource installableresource org apache sling installer api event installation listener installationlistener org apache sling installer api tasks registered resource registeredresource org apache sling installer api tasks transformation result transformationresult org slf logger org slf logger factory loggerfactory persistent list registered resource registeredresource installer track registered resources persistent resource list persistentresourcelist serialization version version entity restart active bundles string restart active bundles type org apache sling installer core restart bundles string restart active bundles org apache sling installer core restart bundles string restart active bundles entity restart active bundles type restart active bundles logger logger logger logger factory loggerfactory get logger getlogger get class getclass map registered resource sets key map entity registered resource registered resources entity resource entity map string entity resource list entityresourcelist data persistence file file data file datafile untransformed resources list registered resource registeredresource untransformed resources untransformedresources installation listener installationlistener listener suppress warnings suppresswarnings unchecked persistent resource list persistentresourcelist file data file datafile installation listener installationlistener listener data file datafile data file datafile listener listener map string entity resource list entityresourcelist restored data restoreddata list registered resource registeredresource unknown list unknownlist data file datafile exists object input stream objectinputstream ois ois object input stream objectinputstream buffered input stream bufferedinputstream file input stream fileinputstream data file datafile version ois read int readint version version version restored data restoreddata map string entity resource list entityresourcelist ois read object readobject version version unknown list unknownlist list registered resource registeredresource ois read object readobject logger warn unknown version persistent resource list version logger debug restore d restored resource list restored data restoreddata logger debug restore d restored unknown resource list unknown list unknownlist exception logger warn unable restore data starting empty list get message getmessage restored data restoreddata unknown list unknownlist ois ois close io exception ioexception ignore data restored data restoreddata restored data restoreddata hash map hashmap string entity resource list entityresourcelist untransformed resources untransformedresources unknown list unknownlist unknown list unknownlist array list arraylist registered resource registeredresource update cache updatecache update resource ids map entry string entity resource list entityresourcelist entry data entry set entryset entity resource list entityresourcelist erl entry get value getvalue erl set resource id setresourceid entry get key getkey erl set listener setlistener listener check special resources get entity resource list getentityresourcelist restart active bundles entity registered resource registeredresource add or update addorupdate internal resource internalresource sling installer restart active bundles hashtable string object installable resource installableresource type properties transformation result transformationresult result transformation result transformationresult result set id setid restart active bundles result set resource type setresourcetype restart active bundles type transform transformation result transformationresult result update url digest cache update cache updatecache entity resource list entityresourcelist group data values registered resource registeredresource group get resources getresources registered resource impl registeredresourceimpl has data file hasdatafile file data store filedatastore shared update digest cache updatedigestcache geturl get digest getdigest registered resource registeredresource untransformed resources untransformedresources registered resource impl registeredresourceimpl has data file hasdatafile file data store filedatastore shared update digest cache updatedigestcache geturl get digest getdigest per sist persist current save object output stream objectoutputstream oos object output stream objectoutputstream buffered output stream bufferedoutputstream file output stream fileoutputstream data file datafile oos write int writeint version oos write object writeobject data oos write object writeobject untransformed resources untransformedresources logger debug per sisted persisted resource list oos close exception logger warn unable save persistent list get message getmessage collection string get entity ids getentityids data key set keyset add update installable resource param input installable resource registered resource registeredresource add or update addorupdate internal resource internalresource input check untransformed resource resources url digest registered resource registeredresource untransformed resources untransformedresources geturl equals input geturl get digest getdigest equals input get digest getdigest resource updating registered resource impl registeredresourceimpl update input installed resources entity resource list entityresourcelist group data values registered resource registeredresource group get resources getresources geturl equals input geturl get digest getdigest equals input get digest getdigest resource updating registered resource impl registeredresourceimpl update input registered resource impl registeredresourceimpl registered resource registeredresource registered resource impl registeredresourceimpl create input check installable checkinstallable registered resource registeredresource registered resource registeredresource io exception ioexception ioe logger warn ignoring resource error processing input geturl ioe check installable resource installable resource type check installable checkinstallable registered resource impl registeredresourceimpl input installable resource installableresource type file equals input get type gettype installable resource installableresource type properties equals input get type gettype entity resource list entityresourcelist data input get entity id getentityid entity resource list entityresourcelist input get entity id getentityid listener data input get entity id getentityid add or update addorupdate input check resource remove untransformed resources untransformedresources input untransformed resources untransformedresources remove input untransformed resources untransformedresources add input list untransformed resources resources resource type list registered resource registeredresource get untransformed resources getuntransformedresources untransformed resources untransformedresources remove resource url check resource groups list untransformed resources param url url remove remove string url url entity resource list entityresourcelist group data values group remove url iter ate iterate untransformed resources remove resource url iterator registered resource registeredresource untransformed resources untransformedresources iterator has next hasnext registered resource registeredresource geturl equals url registered resource impl registeredresourceimpl cleanup remove resource group entity entity resource list entityresourcelist get entity resource list getentityresourcelist string entity id entityid entity resource list entityresourcelist erl data entity id entityid erl entity resource list entityresourcelist group data values entity id entityid equals group get full alias getfullalias erl group erl comp act compact internal remove empty groups code code cycle started compact start new cycle startnewcycle iterator map entry string entity resource list entityresourcelist data entry set entryset iterator has next hasnext map entry string entity resource list entityresourcelist entry start new cycle startnewcycle entry get value getvalue compact entry get value getvalue is empty isempty remove start new cycle startnewcycle transform unknown resource registered transform registered resource registeredresource resource transformation result transformationresult result remove resource unknown list untransformed resources untransformedresources remove resource result length check result transformation result transformationresult result logger warn ignoring result resource get resource type getresourcetype get id getid logger error result resource type unique resource get resource type getresourcetype registered resource impl registeredresourceimpl clone registered resource impl registeredresourceimpl registered resource impl registeredresourceimpl resource clone result check installable checkinstallable clone io exception ioexception ioe logger warn ignoring resource error processing resource ioe check special included info report is special entity id isspecialentityid string restart active bundles entity equals
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery commons providers spi base org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations reference org apache felix scr annotations service org apache sling api resource login exception loginexception org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling api resource value map valuemap org apache sling discovery instance description instancedescription org apache sling discovery commons providers base topology view basetopologyview org apache sling discovery commons providers spi cluster sync service clustersyncservice org apache sling discovery commons providers util resource helper resourcehelper org apache sling settings sling settings service slingsettingsservice sync token synctoken idea instance stores key pair key string id stringid discovery lite sequence number discoverylitesequencenumber discovery oak sync tokens synctokens waits sees token instances cluster sync token synctoken received local instance instances cluster topology changing topology dependent act ivity activity sta lled stalled waiting aware discovery lite discoverylite view component service cluster sync service clustersyncservice sync token service synctokenservice sync token service synctokenservice abstract service with background check abstractservicewithbackgroundcheck cluster sync service clustersyncservice reference discovery lite config discoveryliteconfig commons config commonsconfig reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory reference sling settings service slingsettingsservice settings service settingsservice cluster sync history clustersynchistory cluster sync history clustersynchistory cluster sync history clustersynchistory sync token service synctokenservice test constructor and activate testconstructorandactivate discovery lite config discoveryliteconfig commons config commonsconfig resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory sling settings service slingsettingsservice settings service settingsservice sync token service synctokenservice service test constructor testconstructor commons config commonsconfig resource resolver factory resourceresolverfactory settings service settingsservice service activate service sync token service synctokenservice test constructor testconstructor discovery lite config discoveryliteconfig commons config commonsconfig resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory sling settings service slingsettingsservice settings service settingsservice sync token service synctokenservice service sync token service synctokenservice commons config commonsconfig illegal argument exception illegalargumentexception commons config commonsconfig resource resolver factory resourceresolverfactory illegal argument exception illegalargumentexception resource resolver factory resourceresolverfactory settings service settingsservice illegal argument exception illegalargumentexception settings service settingsservice service commons config commonsconfig commons config commonsconfig service resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory service settings service settingsservice settings service settingsservice service activate activate sling id slingid settings service settingsservice get sling id getslingid logger info activate activated sling id slingid sling id slingid set consistency history setconsistencyhistory cluster sync history clustersynchistory consistency history consistencyhistory cluster sync history clustersynchistory consistency history consistencyhistory cluster sync history clustersynchistory get cluster sync history getclustersynchistory cluster sync history clustersynchistory create resource resolver resourceresolver resource resolver resourceresolver get resource resolver getresourceresolver login exception loginexception resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver override cancel sync cancelsync cancel previous background check cancelpreviousbackgroundcheck override sync base topology view basetopologyview view runnable callback cancel previous background check running cancel previous background check cancelpreviousbackgroundcheck sync token synctoken view callback implementation doesn support wait back log backlog do sync token part dosynctokenpart terminate invoking callback sync token synctoken base topology view basetopologyview view runnable callback start background check startbackgroundcheck sync token service synctokenservice background check backgroundcheck override check storing sync token synctoken string local cluster sync token id localclustersynctokenid view get local cluster sync token id getlocalclustersynctokenid store my sync token storemysynctoken local cluster sync token id localclustersynctokenid wrong wait timeout hits avoid retry storing sync token cluster sync history clustersynchistory add history entry addhistoryentry view storing sync token synctoken local cluster sync token id localclustersynctokenid check see n all sync tokens seenallsynctokens view callback commons config commonsconfig get cluster sync service timeout millis getclustersyncservicetimeoutmillis commons config commonsconfig get cluster sync service interval millis getclustersyncserviceintervalmillis store my sync token storemysynctoken string sync token id synctokenid logger trace store my sync token storemysynctoken start sling id slingid logger info store my sync token storemysynctoken activated sling id slingid resource resolver resourceresolver resource resolver resourceresolver resource resolver resourceresolver get resource resolver getresourceresolver resource resource resource helper resourcehelper get or create resource getorcreateresource resource resolver resourceresolver get sync token path getsynctokenpath modifiable value map modifiablevaluemap sync tokens synctokens resource adapt to adaptto modifiable value map modifiablevaluemap update token updatetoken sync tokens synctokens contains key containskey sling id slingid update token updatetoken object existing token existingtoken sync tokens synctokens sling id slingid existing token existingtoken existing token existingtoken equals sync token id synctokenid update token updatetoken update token updatetoken sync tokens synctokens sling id slingid sync token id synctokenid resource resolver resourceresolver commit logger info store my sync token storemysynctoken stored sync token synctoken sling id slingid sling id slingid sync token id synctokenid logger info store my sync token storemysynctoken sync token synctoken left unchanged sling id slingid sling id slingid sync token id synctokenid login exception loginexception logger error store my sync token storemysynctoken login storing sync token synctoken persistence exception persistenceexception logger error store my sync token storemysynctoken persistence exception persistenceexception storing sync token synctoken logger trace store my sync token storemysynctoken resource resolver resourceresolver resource resolver resourceresolver close string get sync token path getsynctokenpath commons config commonsconfig get sync token path getsynctokenpath see n all sync tokens seenallsynctokens base topology view basetopologyview view logger trace see n all sync tokens seenallsynctokens start resource resolver resourceresolver resource resolver resourceresolver resource resolver resourceresolver get resource resolver getresourceresolver resource resource resource helper resourcehelper get or create resource getorcreateresource resource resolver resourceresolver get sync token path getsynctokenpath value map valuemap sync tokens synctokens resource adapt to adaptto value map valuemap string sync token synctoken view get local cluster sync token id getlocalclustersynctokenid success string buffer stringbuffer history entry historyentry string buffer stringbuffer instance description instancedescription instance view get local instance getlocalinstance get cluster view getclusterview get instances getinstances object current value currentvalue sync tokens synctokens instance get sling id getslingid current value currentvalue string msg sync token synctoken instance get sling id getslingid logger info see n all sync tokens seenallsynctokens msg history entry historyentry length history entry historyentry append history entry historyentry append msg success sync token synctoken equals current value currentvalue string msg sync token synctoken instance get sling id getslingid current value currentvalue waiting sync token synctoken logger info see n all sync tokens seenallsynctokens msg history entry historyentry length history entry historyentry append history entry historyentry append msg success success logger info see n all sync tokens seenallsynctokens expected sync tokens synctokens details cluster sync history clustersynchistory add history entry addhistoryentry view history entry historyentry to string tostring cluster sync history clustersynchistory add history entry addhistoryentry view sync tokens synctokens resource resolver resourceresolver commit logger info see n all sync tokens seenallsynctokens sync tokens synctokens login exception loginexception logger error see n all sync tokens seenallsynctokens login persistence exception persistenceexception logger error see n all sync tokens seenallsynctokens persistence exception persistenceexception logger trace see n all sync tokens seenallsynctokens resource resolver resourceresolver resource resolver resourceresolver close
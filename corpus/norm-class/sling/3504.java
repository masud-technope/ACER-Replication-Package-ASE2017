licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling servlets post java io exception ioexception java util hash map hashmap java util map javax servlet http http servlet response httpservletresponse junit framework test case testcase org apache sling commons json json array jsonarray org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons testing sling mock sling http servlet response mockslinghttpservletresponse json response test jsonresponsetest test case testcase json response jsonresponse res set up setup exception res json response jsonresponse set up setup test on change testonchange exception res on change onchange modified argument argument object prop res get property getproperty json array jsonarray assert instance of assertinstanceof prop json array jsonarray assert equals assertequals length object obj json object jsonobject change assert instance of assertinstanceof obj json object jsonobject assert equals assertequals modified assert property assertproperty change json response jsonresponse prop type string json array jsonarray arguments assert property assertproperty change json response jsonresponse prop argument json array jsonarray assert equals assertequals arguments length test set property testsetproperty exception res set property setproperty prop assert property assertproperty res get json getjson prop string suppress warnings suppresswarnings throwable instance never thrown throwableinstanceneverthrown test set error testseterror io exception ioexception json exception jsonexception string err msg errmsg dummy error res set error seterror error err msg errmsg mock sling http servlet response mockslinghttpservletresponse resp mock sling http servlet response mockslinghttpservletresponse res send resp json object jsonobject json res get json getjson json object jsonobject error assert property assertproperty json error json object jsonobject assert property assertproperty error error get name getname assert property assertproperty error message err msg errmsg test send testsend exception res on change onchange modified argument mock sling http servlet response mockslinghttpservletresponse response mock sling http servlet response mockslinghttpservletresponse res send response json object jsonobject result json object jsonobject response get output getoutput to string tostring assert property assertproperty result html response htmlresponse status code http servlet response httpservletresponse assert equals assertequals json response jsonresponse response content type response get content type getcontenttype assert equals assertequals json response jsonresponse response charset response get character encoding getcharacterencoding test send testsend exception string location http test location res on change onchange modified argument res set status setstatus http servlet response httpservletresponse created created res set location setlocation location mock response with header mockresponsewithheader response mock response with header mockresponsewithheader res send response json object jsonobject result json object jsonobject response get output getoutput to string tostring assert property assertproperty result html response htmlresponse status code http servlet response httpservletresponse created assert equals assertequals location response get header getheader location test send testsend exception string location http test location res on change onchange modified argument status status status res set status setstatus status status res set location setlocation location mock response with header mockresponsewithheader response mock response with header mockresponsewithheader res send response json object jsonobject result json object jsonobject response get output getoutput to string tostring assert property assertproperty result html response htmlresponse status code status assert equals assertequals location response get header getheader location assert property assertproperty json object jsonobject obj string key clazz json exception jsonexception assert true asserttrue json object property key obj key assert instance of assertinstanceof obj key clazz suppress warnings suppresswarnings unchecked assert property assertproperty json object jsonobject obj string key expected json exception jsonexception res assert property assertproperty obj key expected get class getclass assert equals assertequals expected res res suppress warnings suppresswarnings unchecked assert instance of assertinstanceof object obj clazz obj class cast exception classcastexception test case testcase fail object unexpected type expected clazz get name getname actual obj get class getclass get name getname mock response with header mockresponsewithheader mock sling http servlet response mockslinghttpservletresponse map string object headers hash map hashmap string object override set header setheader string string headers string get header getheader string object result headers result string string result result string string result
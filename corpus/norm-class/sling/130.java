licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling resource resolver resourceresolver impl org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue java util array list arraylist java util collections java util dictionary java util hash map hashmap java util hash set hashset java util hashtable java util iterator java util list java util map java util random java util javax servlet http http servlet request httpservletrequest org apache sling api resource login exception loginexception org apache sling api resource resource org apache sling api resource resource metadata resourcemetadata org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling api resource value map valuemap org apache sling api wrappers value map decorator valuemapdecorator org apache sling resource resolver resourceresolver impl observation resource change listener whiteboard resourcechangelistenerwhiteboard org apache sling resource resolver resourceresolver impl providers resource provider handler resourceproviderhandler org apache sling resource resolver resourceresolver impl providers resource provider info resourceproviderinfo org apache sling resource resolver resourceresolver impl providers resource provider storage resourceproviderstorage org apache sling resource resolver resourceresolver impl providers resource provider tracker resourceprovidertracker org apache sling spi resource provider jcr query provider jcrqueryprovider org apache sling spi resource provider resolver context resolvercontext org apache sling spi resource provider resource context resourcecontext org apache sling spi resource provider resource provider resourceprovider org junit org junit org junit org junit test org mockito argument captor argumentcaptor org mockito mock org mockito mockito org mockito mockito annotations mockitoannotations org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service factory servicefactory org osgi framework service reference servicereference org osgi service component component context componentcontext todo stat resource statresource mocked resource resolver impl test mockedresourceresolverimpltest list resource empty resource list array list arraylist resource string fake query language fake string path path resource resolver factory activator resourceresolverfactoryactivator activator list resource provider handler resourceproviderhandler handlers array list arraylist resource provider handler resourceproviderhandler mock component context componentcontext component context componentcontext mock bundle context bundlecontext bundle context bundlecontext mock bundle using bundle usingbundle mock bundle context bundlecontext using bundle context usingbundlecontext mock resource provider tracker resourceprovidertracker resource provider tracker resourceprovidertracker mock resource change listener whiteboard resourcechangelistenerwhiteboard resource change listener whiteboard resourcechangelistenerwhiteboard suppress warnings suppresswarnings rawtypes mock jcr query provider jcrqueryprovider query provider queryprovider map string object services hash map hashmap string object map string object service properties serviceproperties hash map hashmap string object resource resolver factory impl resourceresolverfactoryimpl resource resolver factory resourceresolverfactory mock resource provider resourceprovider resource provider resourceprovider deals resolution mock resource provider resourceprovider mapping resource provider mappingresourceprovider deals apps libs resolution mock resource provider resourceprovider apps resource provider appsresourceprovider queriable resource providers queriableresourceproviders mock resource provider resourceprovider queriable resource provider a queriableresourceprovidera mocked resource resolver impl test mockedresourceresolverimpltest mockito annotations mockitoannotations init mocks initmocks suppress warnings suppresswarnings unchecked login exception loginexception activator resource resolver factory activator resourceresolverfactoryactivator mockito component context componentcontext get properties getproperties then return thenreturn build bundle properties buildbundleproperties mockito component context componentcontext get bundle context getbundlecontext then return thenreturn bundle context bundlecontext activator resource access security tracker resourceaccesssecuritytracker resource access security tracker resourceaccesssecuritytracker activator resource provider tracker resourceprovidertracker resource provider tracker resourceprovidertracker activator change listener whiteboard changelistenerwhiteboard resource change listener whiteboard resourcechangelistenerwhiteboard handlers add createrphandler resource provider resourceprovider org apache sling resource resolver resourceresolver impl dummy test provider dummytestprovider single setup mapping resources map exercise vanity hmm provide resolver ready mapping work properly setup correctly build mapping resource buildmappingresource map mapping resource provider mappingresourceprovider handlers add createrphandler mapping resource provider mappingresourceprovider org apache sling resource resolver resourceresolver impl map provider mapprovider handlers add createrphandler apps resource provider appsresourceprovider org apache sling resource resolver resourceresolver impl apps provider appsprovider libs handlers add createrphandler apps resource provider appsresourceprovider org apache sling resource resolver resourceresolver impl apps provider appsprovider apps handlers add createrphandler queriable resource provider a queriableresourceprovidera org apache sling resource resolver resourceresolver impl queriable resource provider a queriableresourceprovidera search a searcha mockito queriable resource provider a queriableresourceprovidera getjcrqueryprovider then return thenreturn query provider queryprovider resource provider storage resourceproviderstorage storage resource provider storage resourceproviderstorage handlers mockito resource provider tracker resourceprovidertracker get resource provider storage getresourceproviderstorage then return thenreturn storage activate components activator activate component context componentcontext configure bundle mockito using bundle usingbundle get bundle context getbundlecontext then return thenreturn using bundle context usingbundlecontext mockito using bundle context usingbundlecontext get bundle getbundle then return thenreturn using bundle usingbundle extract services registered map argument captor argumentcaptor string classes captor classescaptor argument captor argumentcaptor for class forclass string argument captor argumentcaptor object service captor servicecaptor argument captor argumentcaptor for class forclass object suppress warnings suppresswarnings rawtypes argument captor argumentcaptor dictionary properties captor propertiescaptor argument captor argumentcaptor for class forclass dictionary mockito verify bundle context bundlecontext mockito at least once atleastonce register service registerservice classes captor classescaptor capture service captor servicecaptor capture properties captor propertiescaptor capture list object service list servicelist service captor servicecaptor get all values getallvalues suppress warnings suppresswarnings unused rawtypes list dictionary service properties list servicepropertieslist properties captor propertiescaptor get all values getallvalues string service name servicename classes captor classescaptor get all values getallvalues services service name servicename service list servicelist service properties serviceproperties service name servicename service properties serviceproperties verify resource resolver factory impl resourceresolverfactoryimpl created registered assert not null assertnotnull services resource resolver factory resourceresolverfactory get name getname object rrf services resource resolver factory resourceresolverfactory get name getname rrf service factory servicefactory rrf service factory servicefactory rrf get service getservice using bundle usingbundle assert true asserttrue rrf resource resolver factory impl resourceresolverfactoryimpl resource resolver factory resourceresolverfactory resource resolver factory impl resourceresolverfactoryimpl rrf resource provider handler resourceproviderhandler createrphandler resource provider resourceprovider string pid ranking string path service reference servicereference mockito mock service reference servicereference bundle context bundlecontext mockito mock bundle context bundlecontext mockito get service getservice mockito then return thenreturn mockito get property getproperty mockito constants service then return thenreturn random next long nextlong mockito get property getproperty mockito constants service pid then return thenreturn pid mockito get property getproperty mockito constants service ranking then return thenreturn ranking mockito get property getproperty mockito resource provider resourceprovider property root then return thenreturn path mockito get property getproperty mockito resource provider resourceprovider property mod ifiable modifiable then return thenreturn mockito get property getproperty mockito resource provider resourceprovider property attr ibutable attributable then return thenreturn mockito get property getproperty mockito resource provider resourceprovider property adaptable then return thenreturn resource provider info resourceproviderinfo info resource provider info resourceproviderinfo resource provider handler resourceproviderhandler handler resource provider handler resourceproviderhandler info handler activate handler suppress warnings suppresswarnings unchecked resource build mapping resource buildmappingresource string path resource provider resourceprovider provider resource resolver resourceresolver resource resolver resourceresolver list resource local host any list localhostanylist array list arraylist resource local host any list localhostanylist add build resource buildresource path http cgi bin empty resource list resource resolver resourceresolver provider sling internal redirect internalredirect scripts local host any list localhostanylist add build resource buildresource path http gateway empty resource list resource resolver resourceresolver provider sling internal redirect internalredirect http gbiv local host any list localhostanylist add build resource buildresource path http stories empty resource list resource resolver resourceresolver provider sling internal redirect internalredirect anecdotes list resource mapping children mappingchildren array list arraylist resource mapping children mappingchildren add build resource buildresource path http empty resource list resource resolver resourceresolver provider sling redirect http mapping children mappingchildren add build resource buildresource path http empty resource list resource resolver resourceresolver provider sling internal redirect internalredirect mapping children mappingchildren add build resource buildresource path http empty resource list resource resolver resourceresolver provider sling match sling redirect http mapping children mappingchildren add build resource buildresource path http localhost local host any list localhostanylist resource resolver resourceresolver provider sling match localhost sling internal redirect internalredirect content resource etc map resource etcmapresource build resource buildresource path http mapping children mappingchildren mockito provider get resource getresource mockito resolver context resolvercontext mockito path mockito resource context resourcecontext mockito resource then return thenreturn etc map resource etcmapresource etc map resource etcmapresource handlers clear build child resources iterable resources param parent iterable resource build child resources buildchildresources string parent list resource mapping resources mappingresources array list arraylist resource mapping resources mappingresources add build resource buildresource parent empty resource list mapping resources mappingresources build resource based path children param fullpath param children resource build resource buildresource string fullpath iterable resource children build resource buildresource fullpath children string build list value map valuemap list value map valuemap build value map collection buildvaluemapcollection how many howmany string path prefix pathprefix list value map valuemap result array list arraylist value map valuemap how many howmany map string object hash map hashmap string object path path prefix pathprefix result add value map decorator valuemapdecorator result build resource path children resource resolver param fullpath param children param resource resolver resourceresolver suppress warnings suppresswarnings unchecked resource build resource buildresource string fullpath iterable resource children resource resolver resourceresolver resource resolver resourceresolver resource provider resourceprovider provider string properties resource resource mockito mock resource mockito resource get name getname then return thenreturn get name getname fullpath mockito resource get path getpath then return thenreturn fullpath resource metadata resourcemetadata resource metadata resourcemetadata resource metadata resourcemetadata mockito resource get resource metadata getresourcemetadata then return thenreturn resource metadata resourcemetadata mockito resource list children listchildren then return thenreturn children iterator mockito resource get resource resolver getresourceresolver then return thenreturn resource resolver resourceresolver register resource provider provider mockito provider list children listchildren mockito resolver context resolvercontext mockito resource then return thenreturn children iterator mockito provider get resource getresource mockito resolver context resolvercontext mockito fullpath mockito resource context resourcecontext mockito resource then return thenreturn resource properties value map valuemap simple value map impl simplevaluemapimpl properties length resource metadata resourcemetadata properties properties properties properties mockito resource get value map getvaluemap then return thenreturn mockito resource adapt to adaptto mockito value map valuemap then return thenreturn mockito resource get value map getvaluemap then return thenreturn value map decorator valuemapdecorator empty mockito resource adapt to adaptto mockito value map valuemap then return thenreturn value map decorator valuemapdecorator empty resource extract path param fullpath string get name getname string fullpath fullpath last index of lastindexof fullpath substring build properties resource resolver bundle dictionary string object build bundle properties buildbundleproperties dictionary string object properties hashtable string object properties resource resolver virtual string properties resource resolver mapping string content system doc root docroot content html properties resource resolver allow direct allowdirect properties resource resolver search path searchpath string apps libs properties resource resolver mangle namespaces manglenamespaces properties resource resolver map location map properties resource resolver vanity redirect status properties resource resolver required providers string org apache sling resource resolver resourceresolver impl dummy test provider dummytestprovider properties constants service vendor apache properties constants service description testing properties test resolver login exception loginexception test test get resolver testgetresolver login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver assert not null assertnotnull resource resolver resourceresolver map string object authentication info authenticationinfo hash map hashmap string object resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver authentication info authenticationinfo assert not null assertnotnull resource resolver resourceresolver misc eleneous misceleneous coverage login exception loginexception test test resolver misc testresolvermisc login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver resource resolver resourceresolver get attribute getattribute fail thrown npe null pointer exception nullpointerexception assert array equals assertarrayequals string apps libs resource resolver resourceresolver get search path getsearchpath test admin istrative administrative resource resolve rs resolvers login exception loginexception test test get authenticated resolve testgetauthenticatedresolve login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver assert not null assertnotnull resource resolver resourceresolver map string object authentication info authenticationinfo hash map hashmap string object resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver authentication info authenticationinfo assert not null assertnotnull resource resolver resourceresolver test get resource getresource resource resource provider login exception loginexception test test get resource testgetresource login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver assert not null assertnotnull resource resolver resourceresolver resource single resource singleresource build resource buildresource single test empty resource list resource resolver resourceresolver resource provider resourceprovider resource resource resource resolver resourceresolver get resource getresource single test assert equals assertequals single resource singleresource resource test get resource getresource path int ermediate intermediate verifying sling login exception loginexception test testgetresourcesling login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver assert not null assertnotnull resource resolver resourceresolver resource single resource singleresource build resource buildresource single test extra dots int hepath inthepath empty resource list resource resolver resourceresolver resource provider resourceprovider resource resource resource resolver resourceresolver get resource getresource single test extra dots int hepath inthepath assert equals assertequals single resource singleresource resource test search paths login exception loginexception test test relative resource testrelativeresource login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver assert not null assertnotnull resource resolver resourceresolver resource app resource appresource build resource buildresource apps store inventory empty resource list resource resolver resourceresolver apps resource provider appsresourceprovider resource lib resource libresource build resource buildresource libs store catalog empty resource list resource resolver resourceresolver apps resource provider appsresourceprovider resource test resource testresource resource resolver resourceresolver get resource getresource store inventory assert equals assertequals app resource appresource test resource testresource test resource testresource resource resolver resourceresolver get resource getresource store catalog assert equals assertequals lib resource libresource test resource testresource basic test mapping functionality moment configuration virtual map login exception loginexception test test mapping testmapping login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver build resource buildresource single test empty resource list resource resolver resourceresolver resource provider resourceprovider http servlet request httpservletrequest request mockito mock http servlet request httpservletrequest mockito request get scheme getscheme then return thenreturn http mockito request get server port getserverport then return thenreturn mockito request get server name getservername then return thenreturn localhost string path resource resolver resourceresolver map request single test assert equals assertequals single test path path resource resolver resourceresolver map request single test assert equals assertequals single test path test path mapping request path resource resolver resourceresolver map single test assert equals assertequals single test path build resource buildresource content empty resource list resource resolver resourceresolver resource provider resourceprovider path resource resolver resourceresolver map content html assert equals assertequals content html path tests list children resource doesn test resource resolver valid ates validates unit test login exception loginexception test test list children testlistchildren login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver build resource buildresource single test with children withchildren build child resources buildchildresources single test with children withchildren resource resolver resourceresolver resource provider resourceprovider resource resource resource resolver resourceresolver get resource getresource single test with children withchildren assert not null assertnotnull resource test resource list children tests test iterator resource resource iterator resourceiterator resource list children listchildren assert not null assertnotnull resource resolver resourceresolver resource iterator resourceiterator has next hasnext assert equals assertequals resource iterator resourceiterator get name getname assert equals assertequals test listing children resource resolver list children listchildren call login exception loginexception test test resource resolver list children testresourceresolverlistchildren login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver build resource buildresource single test with children withchildren build child resources buildchildresources single test with children withchildren resource resolver resourceresolver resource provider resourceprovider resource resource resource resolver resourceresolver get resource getresource single test with children withchildren assert not null assertnotnull resource test resource list children tests test iterator resource resource iterator resourceiterator resource resolver resourceresolver list children listchildren resource assert not null assertnotnull resource resolver resourceresolver resource iterator resourceiterator has next hasnext assert equals assertequals resource iterator resourceiterator get name getname assert equals assertequals tests listing children resource resolver get children getchildren call login exception loginexception test test resource resolver get children testresourceresolvergetchildren login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver build resource buildresource single test with children withchildren build child resources buildchildresources single test with children withchildren resource resolver resourceresolver resource provider resourceprovider resource resource resource resolver resourceresolver get resource getresource single test with children withchildren assert not null assertnotnull resource test resource list children tests test iterable resource resource iterator resourceiterator resource resolver resourceresolver get children getchildren resource assert not null assertnotnull resource resolver resourceresolver resource resource iterator resourceiterator assert equals assertequals get name getname assert equals assertequals suppress warnings suppresswarnings unchecked test test query resources testqueryresources login exception loginexception string lang uages languages string fake query language mockito query provider queryprovider get supported lang uages getsupportedlanguages mockito resolver context resolvercontext then return thenreturn lang uages languages mockito query provider queryprovider query resources queryresources mockito resolver context resolvercontext mockito string mockito string then return thenreturn build value map collection buildvaluemapcollection iterator resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver build resource buildresource search test with children withchildren build child resources buildchildresources search test with children withchildren resource provider resourceprovider iterator map string object query resources queryresources search fake query language string to find tofind hash set hashset string to find tofind add assert true asserttrue expecting empty result has next hasnext has next hasnext map string object to find tofind remove path assert true asserttrue expecting left overs leftovers to find tofind to find tofind is empty isempty test test versions login exception loginexception resource resolver resourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver resource resource resource resolver resourceresolver resolve content test html map string string parameters resource get resource metadata getresourcemetadata get parameter map getparametermap assert equals assertequals content test html resource get path getpath assert equals assertequals test html resource get name getname assert equals assertequals collections singleton map singletonmap parameters resource resource resolver resourceresolver resolve content test html parameters resource get resource metadata getresourcemetadata get parameter map getparametermap assert equals assertequals content test html resource get path getpath assert equals assertequals test html resource get name getname assert equals assertequals collections singleton map singletonmap parameters build resource buildresource single test with children withchildren build child resources buildchildresources single test with children withchildren resource resolver resourceresolver resource provider resourceprovider resource resource resolver resourceresolver get resource getresource single test with children withchildren assert not null assertnotnull resource assert equals assertequals single test with children withchildren resource get path getpath assert equals assertequals with children withchildren resource get name getname
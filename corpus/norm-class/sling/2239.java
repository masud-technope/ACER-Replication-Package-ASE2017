licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling commons testing jcr javax jcr node javax jcr repository exception repositoryexception javax jcr session javax jcr observation event javax jcr observation event iterator eventiterator javax jcr observation event listener eventlistener tests wait jcr notification events delivered event helper eventhelper event listener eventlistener session session event count eventcount string wait node folder wait node string wait node node event helper eventhelper get simple name getsimplename node wait node folder waitnodefolder event helper eventhelper session repository exception repositoryexception session event types eventtypes event node event node removed is deep isdeep no local nolocal session get workspace getworkspace get observation manager getobservationmanager add event listener addeventlistener event types eventtypes wait node folder is deep isdeep no local nolocal session get root node getrootnode has node hasnode wait node folder wait node folder waitnodefolder session get root node getrootnode get node getnode wait node folder wait node folder waitnodefolder session get root node getrootnode add node addnode wait node folder unstructured session save on event onevent event iterator eventiterator event count eventcount observation events delivered create delete node wait events received wait for events waitforevents timeout msec timeoutmsec repository exception repositoryexception target event count targeteventcount event count eventcount wait node folder waitnodefolder has node hasnode wait node node wait node folder waitnodefolder get node getnode wait node node remove wait node folder waitnodefolder add node addnode wait node node session save system current time millis currenttimemillis timeout msec timeoutmsec event count eventcount target event count targeteventcount system current time millis currenttimemillis thread sleep interrupted exception interruptedexception event count eventcount target event count targeteventcount illegal state exception illegalstateexception event counter reach target event count targeteventcount waited timeout msec timeoutmsec msec remove event listener observation listener dispose session get workspace getworkspace get observation manager getobservationmanager remove event listener removeeventlistener repository exception repositoryexception
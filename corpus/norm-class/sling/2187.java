licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad base impl java file java file input stream fileinputstream java file not found exception filenotfoundexception java file output stream fileoutputstream java io exception ioexception java input stream inputstream java output stream outputstream java util dictionary java util hash map hashmap java util iterator java util linked list linkedlist java util list java util map java util jar jar file jarfile java util jar manifest org apache felix framework logger org apache sling launchpad api launchpad content provider launchpadcontentprovider org apache sling launchpad api startup mode startupmode org apache sling launchpad base impl bootstrap commands bootstrapcommands bootstrap command file bootstrapcommandfile org apache sling launchpad base shared shared constants sharedconstants org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework bundle exception bundleexception org osgi framework constants org osgi framework service reference servicereference org osgi framework version org osgi service start level startlevel start level startlevel code bootstrap installer bootstrapinstaller code installed osg i osgi framework activator called framework starting startup bundles link path core bundles link path bundles location checked installed installed installed start level started bundle installed installed started bootstrap installer bootstrapinstaller bundle location scheme protocol bundles installed activator sling install slinginstall path bundle location bundles installed path resource bundle installed string scheme sling install slinginstall root location bundles looked installation resources string path resources resources location core bundles resources core bundles corebundles bundles installed start level startlevel link startlevel core bundles location deprecated core bundles located code resources bundles code string path core bundles path resources core bundles corebundles location additional bundles resources bundles bundles installed link path core bundles core bundles string path bundles path resources bundles header bundle modified string bnd modified header bnd last modified lastmodified start level assigned bundles style link path core bundles resources core bundles corebundles location startlevel core bundles start level assigned bundles style link path bundles resources bundles location startlevel bundles marker start level indicating location bundle resolved valid start level startlevel bootstrap commands file string bootstrap cmd filename sling bootstrap txt link logger logging messages installation startup logger logger link launchpad content provider launchpadcontentprovider access bundle files install launchpad content provider launchpadcontentprovider resource provider resourceprovider bundle context bundle context bundlecontext bundle context bundlecontext startup mode startup mode startupmode startup mode startupmode bootstrap installer bootstrapinstaller bundle context bundlecontext bundle context bundlecontext logger logger launchpad content provider launchpadcontentprovider resource provider resourceprovider startup mode startupmode startup mode startupmode startup mode startupmode startup mode startupmode logger logger resource provider resourceprovider resource provider resourceprovider bundle context bundlecontext bundle context bundlecontext https issues apache org jira browse sling handles initial detection installation bundles felix osg i osgi running sling process copy bundles enclosed resources jar war sling startup sling startup existing files replaced files enclosed sling launchpad jar war file newer scan sling startup bundles install today enclosed resources scanned place bundles structure installed requested start level bundle start level install io exception ioexception string launchpad home launchpadhome bundle context bundlecontext get property getproperty shared constants sharedconstants sling launchpad launchpad home launchpadhome launchpad home launchpadhome bundle context bundlecontext get property getproperty shared constants sharedconstants sling file sling startup dir slingstartupdir get sling startup dir getslingstartupdir launchpad home launchpadhome execute bootstrap commands needed bootstrap command file bootstrapcommandfile cmd bootstrap command file bootstrapcommandfile logger file launchpad home launchpadhome bootstrap cmd filename require restart requirerestart cmd execute bundle context bundlecontext should install shouldinstall loading bundles for ced forced string fpbl string fpblstring bundle context bundlecontext get property getproperty shared constants sharedconstants force bundle loading value of valueof fpbl string fpblstring should install shouldinstall should install shouldinstall startup mode startupmode startup mode startupmode restart should install shouldinstall war jar copies war jar changed loading bundles disabled string dpbl string dpblstring bundle context bundlecontext get property getproperty shared constants sharedconstants disable bundle loading disable package bundle loading disablepackagebundleloading value of valueof dpbl string dpblstring disable package bundle loading disablepackagebundleloading logger log logger log info bundle loading disabled bundles installed resources location sling jar war bundles jar war copy startup location iterator string resources resource provider resourceprovider get children getchildren path bundles resources has next hasnext string path resources folders path ends with endswith cut trailing slash path path substring path length calculate start level startlevel bundles contained start level startlevel get start level getstartlevel path start level startlevel startlevel copy bundles copybundles sling startup dir slingstartupdir path start level startlevel copy style core bundles copy bundles copybundles sling startup dir slingstartupdir path core bundles startlevel core bundles copy style bundles copy bundles copybundles sling startup dir slingstartupdir path bundles startlevel bundles copying point existing installed bundles symbolic bundle bundles bundle context bundlecontext get bundles getbundles map string bundle by symbolic name bysymbolicname hash map hashmap string bundle bundles length by symbolic name bysymbolicname bundles get symbolic name getsymbolicname bundles holds bundles install processing list bundle installed linked list linkedlist bundle bundles startup location install require restart requirerestart install bundles installbundles sling startup dir slingstartupdir by symbolic name bysymbolicname installed start newly installed bundles existing bundles started stopped start bundles startbundles installed negative require restart requirerestart logger log logger log info framework extension updated rest arting restarting framework startup completed require restart requirerestart startup folder main tenance maintenance sling startup directory create sling param sling home slinghome path sling sling startup directory illegal state exception illegalstateexception sling startup directories created accessed file get sling startup dir getslingstartupdir string sling home slinghome file sling home dir slinghomedir file sling home slinghome file sling home startup dir slinghomestartupdir get or create directory getorcreatedirectory sling home dir slinghomedir directory util directoryutil path start up startup sling home startup dir slinghomestartupdir create directory existing parent param parent dir parentdir parent directory param sub dir name subdirname directory directory illegal state exception illegalstateexception directory created accessed file get or create directory getorcreatedirectory file parent dir parentdir string sub dir name subdirname file sling home startup dir slinghomestartupdir file parent dir parentdir sub dir name subdirname get absolute file getabsolutefile sling home startup dir slinghomestartupdir exists sling home startup dir slinghomestartupdir is directory isdirectory parent dir parentdir can read canread parent dir parentdir can write canwrite illegal state exception illegalstateexception fatal error bootstrap find accessible existing shared constants sharedconstants sling directory util directoryutil path start up startup directory sling home startup dir slinghomestartupdir sling home startup dir slinghomestartupdir mkdirs illegal state exception illegalstateexception sling sling home startup dir slinghomestartupdir created directory sling home startup dir slinghomestartupdir copies bundles parent location jar war startup directory sling based start level startlevel sling startup start level startlevel copy bundles copybundles file sling startup dir slingstartupdir string parent start level startlevel start level start level startlevel start level startlevel created demand file start up level dir startupleveldir iterator string res resource provider resourceprovider get children getchildren parent res has next hasnext path resource string path res directory util directoryutil is bundle isbundle path access bundle file ignore input stream inputstream ins resource provider resourceprovider get resource as stream getresourceasstream path ins needed start up level dir startupleveldir start up level dir startupleveldir get or create directory getorcreatedirectory sling startup dir slingstartupdir string value of valueof start level startlevel copy bundle based start level startlevel string bundle file name bundlefilename extract file name extractfilename path file bundle file bundlefile file start up level dir startupleveldir bundle file name bundlefilename copy stream to file copystreamtofile ins bundle file bundlefile io exception ioexception runtime exception runtimeexception failure copying file path startup dir start up level dir startupleveldir bundle file name bundlefilename ins close io exception ioexception ignore copies stream resource jar war file param from stream fromstream param to file tofile copy stream to file copystreamtofile input stream inputstream from stream fromstream file to file tofile io exception ioexception from stream fromstream to file tofile illegal argument exception illegalargumentexception from stream fromstream to file tofile to file tofile exists to file tofile create new file createnewfile overwrite output stream outputstream file output stream fileoutputstream to file tofile buf len len from stream fromstream read buf write buf len close install bundles files startup directory level directories install bundles updated skip param context code bundle context bundlecontext code install bundles param current bundles currentbundles installed bundles indexed bundle location param parent path location bundle files install resources ends bundle extensions considered installation param installed list bundles installed method bundle installed list code code system bundle fragment updated requires framework restart install bundles installbundles file sling startup dir slingstartupdir map string bundle current bundles currentbundles list bundle installed start level service initial start level service reference servicereference bundle context bundlecontext get service reference getservicereference start level startlevel get name getname start level startlevel start level service startlevelservice start level startlevel bundle context bundlecontext get service getservice require restart requirerestart file directories sling startup dir slingstartupdir list files listfiles directory util directoryutil directory filter file level dir leveldir directories start level startlevel dir string dir name dirname level dir leveldir get name getname start level startlevel start level startlevel integer decode dir name dirname number format exception numberformatexception start level startlevel iter ate iterate files start level startlevel dir file bundle files bundlefiles level dir leveldir list files listfiles directory util directoryutil bundle file filter file bundle file bundlefile bundle files bundlefiles require restart requirerestart install bundle installbundle bundle file bundlefile start level startlevel current bundles currentbundles installed start level service startlevelservice release start level service bundle context bundlecontext unget service ungetservice require restart requirerestart param bundle jar bundlejar jar file bundle install param start level startlevel start level bundle param context code bundle context bundlecontext code install bundles param current bundles currentbundles installed bundles indexed bundle location param installed list bundles installed method bundle installed list param start level service startlevelservice service sets start level code code system bundle fragment updated requires framework restart install bundle installbundle file bundle jar bundlejar start level startlevel map string bundle current bundles currentbundles list bundle installed start level startlevel start level service startlevelservice manifest bundle manifest manifest get manifest getmanifest bundle jar bundlejar manifest logger log logger log error ignoring bundle jar bundlejar read manifest circuit ensure symbolic jar file string symbolic name symbolicname get bundle symbolic name getbundlesymbolicname manifest symbolic name symbolicname logger log logger log error ignoring bundle jar bundlejar missing constants bundle symbolicname manifest circuit check installed bundle symbolic bundle installed bundle installedbundle current bundles currentbundles symbolic name symbolicname ignore installed bundle installedbundle manifest logger log logger log info ignoring bundle jar bundlejar version installed circuit access jar file ignore input stream inputstream ins ins file input stream fileinputstream bundle jar bundlejar file not found exception filenotfoundexception require restart requirerestart installed bundle installedbundle installed bundle extension fragment restart framework comp leting completing installation upgrade bundles require restart requirerestart is system bundle fragment issystembundlefragment installed bundle installedbundle installed bundle installedbundle update ins logger log logger log info bundle installed bundle installedbundle get symbolic name getsymbolicname updated bundle jar bundlejar bundle exception bundleexception logger log logger log error bundle update bundle jar bundlejar failed restart required bundle installation stage require restart requirerestart install jar file bundle string path bundle jar bundlejar get path getpath string location scheme path substring path last index of lastindexof bundle the bundle thebundle bundle context bundlecontext install bundle installbundle location ins logger log logger log info bundle the bundle thebundle get symbolic name getsymbolicname installed location add bundle list start installed add the bundle thebundle option ally optionally start level start level startlevel start level service startlevelservice set bundle start level setbundlestartlevel the bundle thebundle start level startlevel bundle exception bundleexception logger log logger log error bundle installation location failed require restart requirerestart starts bundles code bundles code list framework active code start level startlevel code service start levels bundles start bundles startbundles list bundle bundles start bundles bundle bundle bundles is fragment isfragment bundle bundle start bundle exception bundleexception logger log logger log error bundle bundle get symbolic name getsymbolicname started get start level getstartlevel string path string path substring path last index of lastindexof level integer parse int parseint level level logger log logger log error illegal run level runlevel path ignoring number format exception numberformatexception nfe logger log logger log info folder path denote start level ignoring valid start level ignore location startlevel is system bundle fragment issystembundlefragment bundle installed bundle installedbundle string fragment header fragmentheader string installed bundle installedbundle get headers getheaders constants fragment host fragment header fragmentheader fragment header fragmentheader index of indexof constants extension directive bundle jar file returns manifest jar file resource resource provider code code resource exists jar file manifest param jar path jarpath path jar file resource provider instance manifest get manifest getmanifest file jar jar file jarfile jar file jarfile jar file jarfile jar file jarfile jar jar file jarfile get manifest getmanifest io exception ioexception logger log logger log warning input stream inputstream file jar jar file jarfile jar file jarfile close io exception ioexception ignore returns bundle symbolic name symbolicname header manifest code code header exists note bundles allowed symbolic bundle symbolic header installed param manifest manifest extract header string get bundle symbolic name getbundlesymbolicname manifest manifest manifest get main attributes getmainattributes get value getvalue constants bundle symbolicname checks installed bundle version bundle manifest param installed bundle installedbundle bundle installed framework param manifest manifest describing bundle version updating installed bundle code code manifest describe bundle higher version number ignore bundle installed bundle installedbundle manifest manifest bundle installed install installed bundle installedbundle string version prop versionprop manifest get main attributes getmainattributes get value getvalue constants bundle version version new version newversion version parse version parseversion version prop versionprop string installed version prop installedversionprop string installed bundle installedbundle get headers getheaders constants bundle version version installed version installedversion version parse version parseversion installed version prop installedversionprop version snapshot new version newversion equals installed version installedversion installed version prop installedversionprop ends with endswith snapshot is newer snapshot isnewersnapshot installed bundle installedbundle manifest logger log logger log info for cing forcing upgrade snapshot bundle installed bundle installedbundle get symbolic name getsymbolicname new version newversion compare to compareto installed version installedversion returns code code bundle assumed fragment code fragment host code header is fragment isfragment bundle bundle dictionary header map headermap bundle get headers getheaders header map headermap constants fragment host determine bundle passed man fiest manfiest newer snapshot installed bundle param installed bundle installedbundle installed bundle param manifest manifest installed bundle installed bundle newer comparison fails reason is newer snapshot isnewersnapshot bundle installed bundle installedbundle manifest manifest string installed date installeddate string installed bundle installedbundle get headers getheaders bnd modified header string to be installed date tobeinstalleddate manifest get main attributes getmainattributes get value getvalue bnd modified header installed date installeddate logger log logger log debug string format installed bundle doesn header installed bundle installedbundle get symbolic name getsymbolicname bnd modified header to be installed date tobeinstalleddate logger log logger log debug string format candidate bundle doesn header installed bundle installedbundle get symbolic name getsymbolicname bnd modified header installed time installedtime to be installed time tobeinstalledtime installed time installedtime value of valueof installed date installeddate number format exception numberformatexception logger log logger log debug string format header installed bundle isn parse able parseable bnd modified header installed bundle installedbundle get symbolic name getsymbolicname to be installed time tobeinstalledtime value of valueof to be installed date tobeinstalleddate number format exception numberformatexception logger log logger log debug string format header candidate bundle isn parse able parseable bnd modified header installed bundle installedbundle get symbolic name getsymbolicname to be installed time tobeinstalledtime installed time installedtime helper simple check string blank string utils stringutils param str string check string empty is blank isblank string str str str length str trim length param path path blank filename path illegal argument exception illegalargumentexception filename string extract file name extractfilename string path is blank isblank path illegal argument exception illegalargumentexception invalid blank path extract filename path ensure slashes path path path replace file separator char separatorchar string slash pos slashpos path last index of lastindexof slash pos slashpos filename directory path included path path length slash pos slashpos split path path substring slash pos slashpos is blank isblank illegal argument exception illegalargumentexception invalid path filename path
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base connectors announcement org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert true asserttrue org junit fail java util list java util uuid javax jcr session org apache sling api resource resource resolver factory resourceresolverfactory org apache sling commons testing jcr repository provider repositoryprovider org apache sling discovery cluster view clusterview org apache sling discovery instance description instancedescription org apache sling discovery base connectors base config baseconfig org apache sling discovery base setup topology helper topologyhelper org apache sling discovery base setup virtual instance helper virtualinstancehelper org apache sling discovery base setup mock mock factory mockfactory org apache sling discovery base setup mock simple connector config simpleconnectorconfig org apache sling discovery commons providers default cluster view defaultclusterview org apache sling discovery commons providers default instance description defaultinstancedescription org apache sling discovery commons providers spi base dummy sling settings service dummyslingsettingsservice org junit org junit test announcement registry impl test announcementregistryimpltest announcement registry impl announcementregistryimpl registry string sling id slingid resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory base config baseconfig config setup exception resource resolver factory resourceresolverfactory mock factory mockfactory mock resource resolver factory mockresourceresolverfactory config simple connector config simpleconnectorconfig get connector ping timeout getconnectorpingtimeout tests apache jenkins sling id slingid uuid randomuuid to string tostring session repository provider repositoryprovider instance get repository getrepository login administrative loginadministrative remove item removeitem save log out logout exception refresh log out logout registry announcement registry impl announcementregistryimpl test constructor and activate testconstructorandactivate resource resolver factory resourceresolverfactory dummy sling settings service dummyslingsettingsservice sling id slingid config test test register unregister testregisterunregister exception registry register announcement registerannouncement fail complain illegal argument exception illegalargumentexception iae registry unregister announcement unregisterannouncement fail complain illegal argument exception illegalargumentexception iae registry unregister announcement unregisterannouncement fail complain illegal argument exception illegalargumentexception iae announcement fail complain illegal argument exception illegalargumentexception iae announcement fail complain illegal argument exception illegalargumentexception iae announcement ann announcement sling id slingid assert false assertfalse ann is valid isvalid assert false assertfalse registry register announcement registerannouncement ann default cluster view defaultclusterview local cluster localcluster default cluster view defaultclusterview uuid randomuuid to string tostring ann set local cluster setlocalcluster local cluster localcluster assert false assertfalse ann is valid isvalid assert false assertfalse registry register announcement registerannouncement ann registry list instances listinstances local cluster localcluster fail get instances getinstances empty cluster illegal state exception illegalstateexception illegal state exception illegalstateexception ise default instance description defaultinstancedescription instance topology helper topologyhelper create instance description createinstancedescription ann get owner id getownerid local cluster localcluster assert equals assertequals instance get sling id getslingid ann get owner id getownerid assert true asserttrue ann is valid isvalid assert true asserttrue registry register announcement registerannouncement ann assert equals assertequals registry list instances listinstances local cluster localcluster size registry check expired announcements checkexpiredannouncements assert equals assertequals registry list instances listinstances local cluster localcluster size registry unregister announcement unregisterannouncement ann get owner id getownerid assert equals assertequals registry list instances listinstances local cluster localcluster size assert true asserttrue ann is valid isvalid assert true asserttrue registry register announcement registerannouncement ann assert equals assertequals registry list instances listinstances local cluster localcluster size thread sleep assert equals assertequals registry list instances listinstances local cluster localcluster size test test lists testlists exception registry list announcements in same cluster listannouncementsinsamecluster fail complain illegal argument exception illegalargumentexception iae registry list announcements in same cluster listannouncementsinsamecluster fail complain illegal argument exception illegalargumentexception iae assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size default cluster view defaultclusterview local cluster localcluster default cluster view defaultclusterview uuid randomuuid to string tostring default instance description defaultinstancedescription instance topology helper topologyhelper create instance description createinstancedescription sling id slingid local cluster localcluster assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size announcement ann announcement sling id slingid ann set local cluster setlocalcluster local cluster localcluster ann set inherited setinherited registry register announcement registerannouncement ann assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size ann set inherited setinherited assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert true asserttrue registry has active announcement hasactiveannouncement sling id slingid assert false assertfalse registry has active announcement hasactiveannouncement uuid randomuuid to string tostring registry unregister announcement unregisterannouncement sling id slingid assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert false assertfalse registry has active announcement hasactiveannouncement sling id slingid assert false assertfalse registry has active announcement hasactiveannouncement uuid randomuuid to string tostring ann set inherited setinherited registry register announcement registerannouncement ann assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert true asserttrue registry has active announcement hasactiveannouncement sling id slingid assert false assertfalse registry has active announcement hasactiveannouncement uuid randomuuid to string tostring registry unregister announcement unregisterannouncement sling id slingid assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert false assertfalse registry has active announcement hasactiveannouncement sling id slingid assert false assertfalse registry has active announcement hasactiveannouncement uuid randomuuid to string tostring assert equals assertequals ann list instances listinstances size registry add all except addallexcept ann local cluster localcluster announcement filter announcementfilter accept string receiving sling id receivingslingid announcement announcement assert not null assertnotnull receiving sling id receivingslingid assert not null assertnotnull announcement assert equals assertequals ann list instances listinstances size registry register announcement registerannouncement create announcement createannouncement create cluster createcluster assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size assert equals assertequals registry list instances listinstances local cluster localcluster size registry add all except addallexcept ann local cluster localcluster announcement filter announcementfilter accept string receiving sling id receivingslingid announcement announcement assert not null assertnotnull receiving sling id receivingslingid assert not null assertnotnull announcement assert equals assertequals ann list instances listinstances size registry register announcement registerannouncement ann assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster local cluster localcluster size cluster view clusterview create cluster createcluster num instances numinstances default cluster view defaultclusterview local cluster localcluster default cluster view defaultclusterview uuid randomuuid to string tostring num instances numinstances default instance description defaultinstancedescription instance topology helper topologyhelper create instance description createinstancedescription uuid randomuuid to string tostring local cluster localcluster local cluster localcluster cluster view clusterview create cluster createcluster string instance ids instanceids default cluster view defaultclusterview local cluster localcluster default cluster view defaultclusterview uuid randomuuid to string tostring instance ids instanceids length default instance description defaultinstancedescription instance topology helper topologyhelper create instance description createinstancedescription instance ids instanceids local cluster localcluster local cluster localcluster announcement create announcement createannouncement cluster view clusterview remote cluster remotecluster owner index ownerindex inherited list instance description instancedescription instances remote cluster remotecluster get instances getinstances announcement ann announcement instances owner index ownerindex get sling id getslingid ann set inherited setinherited inherited ann set local cluster setlocalcluster remote cluster remotecluster ann test test exp iry testexpiry interrupted exception interruptedexception no such field exception nosuchfieldexception cluster view clusterview cluster create cluster createcluster cluster view clusterview cluster create cluster createcluster cluster view clusterview cluster create cluster createcluster cluster view clusterview my cluster mycluster create cluster createcluster sling id slingid announcement ann create announcement createannouncement cluster announcement ann create announcement createannouncement cluster announcement ann create announcement createannouncement cluster assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size announcement test ann testann create announcement createannouncement my cluster mycluster assert equals assertequals test ann testann list instances listinstances size registry add all except addallexcept test ann testann my cluster mycluster assert equals assertequals test ann testann list instances listinstances size thread sleep announcement test ann testann create announcement createannouncement my cluster mycluster assert equals assertequals test ann testann list instances listinstances size registry add all except addallexcept test ann testann my cluster mycluster assert equals assertequals test ann testann list instances listinstances size assert true asserttrue registry register announcement registerannouncement ann announcement test ann testann create announcement createannouncement my cluster mycluster assert equals assertequals test ann testann list instances listinstances size registry add all except addallexcept test ann testann my cluster mycluster assert equals assertequals test ann testann list instances listinstances size registry check expired announcements checkexpiredannouncements assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert false assertfalse registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert false assertfalse registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid announcement test ann testann create announcement createannouncement my cluster mycluster assert equals assertequals test ann testann list instances listinstances size registry add all except addallexcept test ann testann my cluster mycluster assert equals assertequals test ann testann list instances listinstances size test test cluster testcluster exception cluster view clusterview cluster create cluster createcluster cluster view clusterview cluster create cluster createcluster cluster view clusterview cluster create cluster createcluster announcement ann create announcement createannouncement cluster announcement ann create announcement createannouncement cluster announcement ann create announcement createannouncement cluster string instance uuid randomuuid to string tostring string instance uuid randomuuid to string tostring string instance uuid randomuuid to string tostring cluster view clusterview my cluster mycluster create cluster createcluster instance instance instance announcement registry impl announcementregistryimpl registry announcement registry impl announcementregistryimpl test constructor and activate testconstructorandactivate resource resolver factory resourceresolverfactory dummy sling settings service dummyslingsettingsservice instance config announcement registry impl announcementregistryimpl registry announcement registry impl announcementregistryimpl test constructor and activate testconstructorandactivate resource resolver factory resourceresolverfactory dummy sling settings service dummyslingsettingsservice instance config announcement registry impl announcementregistryimpl registry announcement registry impl announcementregistryimpl test constructor and activate testconstructorandactivate resource resolver factory resourceresolverfactory dummy sling settings service dummyslingsettingsservice instance config assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry register announcement registerannouncement ann assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert true asserttrue registry has active announcement hasactiveannouncement cluster get instances getinstances get sling id getslingid assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert announcements assertannouncements registry my cluster mycluster assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert announcements assertannouncements registry my cluster mycluster assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert announcements assertannouncements registry my cluster mycluster my cluster mycluster create cluster createcluster instance instance virtual instance helper virtualinstancehelper dump repo dumprepo resource resolver factory resourceresolverfactory assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert announcements assertannouncements registry my cluster mycluster assert equals assertequals registry list announcements in same cluster listannouncementsinsamecluster my cluster mycluster size assert equals assertequals registry list local announcements listlocalannouncements size assert equals assertequals registry list local incoming announcements listlocalincomingannouncements size assert announcements assertannouncements registry my cluster mycluster thread sleep assert announcements assertannouncements registry my cluster mycluster assert announcements assertannouncements registry my cluster mycluster registry check expired announcements checkexpiredannouncements registry check expired announcements checkexpiredannouncements assert announcements assertannouncements registry my cluster mycluster assert announcements assertannouncements registry my cluster mycluster assert announcements assertannouncements announcement registry impl announcementregistryimpl registry cluster view clusterview my cluster mycluster expected num announcements expectednumannouncements expected num instances expectednuminstances announcement ann create announcement createannouncement my cluster mycluster registry add all except addallexcept ann my cluster mycluster assert equals assertequals expected num instances expectednuminstances ann list instances listinstances size
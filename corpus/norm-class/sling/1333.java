licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad base impl bootstrap commands bootstrapcommands java buffered reader bufferedreader java file java file input stream fileinputstream java file output stream fileoutputstream java io exception ioexception java input stream inputstream java input stream reader inputstreamreader java util array list arraylist java util list org apache felix framework logger org osgi framework bundle context bundlecontext bootstrap command file bootstrapcommandfile file store execution timestamp string data filename bootstrap command file bootstrapcommandfile get simple name getsimplename timestamp txt prefix comments command files string comment prefix file command file commandfile logger logger list command command prototypes commandprototypes array list arraylist command command prototypes commandprototypes add uninstall bundle command uninstallbundlecommand load commands file bootstrap command file bootstrapcommandfile logger logger file cmd file cmdfile logger logger command file commandfile cmd file cmdfile command file executed based file timestamp stored timstamp anything to execute anythingtoexecute bundle context bundlecontext ctx result command file commandfile command file commandfile exists command file commandfile can read canread cmd ts cmdts command file commandfile last modified lastmodified last execution lastexecution last execution lastexecution load timestamp loadtimestamp ctx io exception ioexception ioe logger log logger log info io exception ioexception reading timestamp ioe cmd ts cmdts last execution lastexecution logger log logger log info command file timestamp stored timestamp execute commands command file commandfile get absolute path getabsolutepath result result logger log logger log info command file absent older execution timestamp execute command file commandfile get absolute path getabsolutepath result execute commands needed store execution timestamp system bundle restart execute bundle context bundlecontext ctx io exception ioexception needs restart needsrestart anything to execute anythingtoexecute ctx input stream inputstream file input stream fileinputstream command file commandfile list command cmds parse command cmd cmds logger log logger log debug exec uting executing command cmd needs restart needsrestart cmd execute logger ctx exception logger log logger log warning exception command execution cmd close io exception ioexception ignore store timestamp storetimestamp ctx io exception ioexception ioe logger log logger log warning io exception ioexception storing timestamp ioe needs restart needsrestart parse commands supplied input stream close stream list command parse input stream inputstream io exception ioexception list command result array list arraylist command buffered reader bufferedreader buffered reader bufferedreader input stream reader inputstreamreader string read line readline trim length starts with startswith comment prefix command to add toadd command proto command prototypes commandprototypes to add toadd proto parse to add toadd to add toadd command parse exception parseexception invalid command result add to add toadd result data file timestamp file get timestamp file gettimestampfile bundle context bundlecontext ctx ctx get data file getdatafile data filename stored timestamp load timestamp loadtimestamp bundle context bundlecontext ctx io exception ioexception result file get timestamp file gettimestampfile ctx exists file input stream fileinputstream fis fis file input stream fileinputstream bytes len fis read bytes len result parse long parselong string bytes len fis fis close result store timestamp storetimestamp bundle context bundlecontext ctx io exception ioexception file get timestamp file gettimestampfile ctx file output stream fileoutputstream fos fos file output stream fileoutputstream fos write string value of valueof system current time millis currenttimemillis get bytes getbytes fos fos close
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core javax servlet http http servlet request httpservletrequest junit framework test case testcase org apache sling api resource non existing resource nonexistingresource org apache sling api resource resource resolver resourceresolver org apache sling api resource synthetic resource syntheticresource org apache sling core authentication support authenticationsupport org jmock expectations org jmock mockery org jmock int egration integration junit j mock jmock org jmock int egration integration junit j unit junit mockery org junit test org junit runner run with runwith run with runwith j mock jmock auth util test authutiltest mockery context j unit junit mockery resource resolver resourceresolver resolver context mock resource resolver resourceresolver http servlet request httpservletrequest request context mock http servlet request httpservletrequest test test is redirect valid isredirectvalid empty test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid test test is redirect valid isredirectvalid url test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid http google test test is redirect valid isredirectvalid request test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid relative path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid absolute path test test is redirect valid isredirectvalid normalized test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized slash test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized slash test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized dot test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized dot test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized dot test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request unnormalized dot test test is redirect valid isredirectvalid invalid characters context checking expectations allowing request get context path getcontextpath return value returnvalue allowing request get attribute getattribute string return value returnvalue test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request illegal test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request illegal test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request illegal test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request illegal test test is redirect valid isredirectvalid resource resolver root context context checking expectations allowing request get context path getcontextpath return value returnvalue allowing request get attribute getattribute string return value returnvalue test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request relative path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request absolute path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request test test is redirect valid isredirectvalid resource resolver root context context checking expectations allowing request get context path getcontextpath return value returnvalue ctx allowing request get attribute getattribute string return value returnvalue test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request relative path test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute path test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request ctx relative path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request ctx absolute path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request ctx test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request ctx test test is redirect valid isredirectvalid resource resolver root context context checking expectations allowing resolver resolve http servlet request httpservletrequest equal absolute path return value returnvalue synthetic resource syntheticresource resolver absolute path test allowing resolver resolve http servlet request httpservletrequest equal relative path return value returnvalue non existing resource nonexistingresource resolver relative path allowing resolver resolve http servlet request httpservletrequest string return value returnvalue non existing resource nonexistingresource resolver absolute missing allowing request get attribute getattribute authentication support authenticationsupport request attribute resolver return value returnvalue resolver allowing request get attribute getattribute string return value returnvalue allowing request get context path getcontextpath return value returnvalue test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request relative path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request absolute path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request absolute missing test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request absolute missing valid test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute missing invalid test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute missing invalid test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute missing invalid test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute missing invalid test test is redirect valid isredirectvalid resource resolver root context context checking expectations allowing resolver resolve http servlet request httpservletrequest equal absolute path return value returnvalue synthetic resource syntheticresource resolver absolute path test allowing resolver resolve http servlet request httpservletrequest equal relative path return value returnvalue non existing resource nonexistingresource resolver relative path allowing request get attribute getattribute authentication support authenticationsupport request attribute resolver return value returnvalue resolver allowing request get attribute getattribute string return value returnvalue allowing request get context path getcontextpath return value returnvalue ctx test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request relative path test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request absolute path test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request ctx relative path test case testcase assert true asserttrue auth util authutil is redirect valid isredirectvalid request ctx absolute path test case testcase assert false assertfalse auth util authutil is redirect valid isredirectvalid request ctx relative ctxrelative path test test is browser request isbrowserrequest context checking expectations allowing request get header getheader user agent return value returnvalue test case testcase assert false assertfalse auth util authutil is browser request isbrowserrequest request test test is browser request isbrowserrequest mozilla context checking expectations allowing request get header getheader user agent return value returnvalue fire fox firefox mozilla test case testcase assert true asserttrue auth util authutil is browser request isbrowserrequest request test test is browser request isbrowserrequest o pera opera context checking expectations allowing request get header getheader user agent return value returnvalue opera o pera opera test case testcase assert true asserttrue auth util authutil is browser request isbrowserrequest request test test is browser request isbrowserrequest webdav context checking expectations allowing request get header getheader user agent return value returnvalue webdav client test case testcase assert false assertfalse auth util authutil is browser request isbrowserrequest request
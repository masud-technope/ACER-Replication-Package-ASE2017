licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution queue impl simple javax annotation check for null checkfornull javax annotation nonnull java util array list arraylist java util calendar java util list java util map java util weak hash map weakhashmap java util concurrent blocking queue blockingqueue java util concurrent linked blocking queue linkedblockingqueue java util concurrent time unit timeunit org apache sling distribution queue distribution queue distributionqueue org apache sling distribution queue distribution queue entry distributionqueueentry org apache sling distribution queue distribution queue item distributionqueueitem org apache sling distribution queue distribution queue item state distributionqueueitemstate org apache sling distribution queue distribution queue item status distributionqueueitemstatus org apache sling distribution queue distribution queue state distributionqueuestate org apache sling distribution queue distribution queue status distributionqueuestatus org apache sling distribution queue impl distribution queue utils distributionqueueutils org slf logger org slf logger factory loggerfactory simple implementation link org apache sling distribution queue distribution queue distributionqueue note moment memory queue persisted repository usable product ion production simple distribution queue simpledistributionqueue distribution queue distributionqueue logger log logger factory loggerfactory get logger getlogger get class getclass string blocking queue blockingqueue distribution queue item distributionqueueitem queue map distribution queue item distributionqueueitem distribution queue item status distributionqueueitemstatus status map statusmap simple distribution queue simpledistributionqueue string agent name agentname string log info starting simple queue agent agent name agentname queue linked blocking queue linkedblockingqueue distribution queue item distributionqueueitem status map statusmap weak hash map weakhashmap distribution queue item distributionqueueitem distribution queue item status distributionqueueitemstatus nonnull string get name getname add nonnull distribution queue item distributionqueueitem item distribution queue item state distributionqueueitemstate item state itemstate distribution queue item state distributionqueueitemstate error result result queue offer item time unit timeunit seconds item state itemstate distribution queue item state distributionqueueitemstate queued interrupted exception interruptedexception log error add item queue status map statusmap item distribution queue item status distributionqueueitemstatus calendar get instance getinstance item state itemstate result check for null checkfornull distribution queue entry distributionqueueentry get head gethead distribution queue item distributionqueueitem element queue peek element distribution queue item status distributionqueueitemstatus item state itemstate status map statusmap element status map statusmap element distribution queue item status distributionqueueitemstatus item state itemstate get entered getentered item state itemstate get item state getitemstate item state itemstate get attempts getattempts distribution queue entry distributionqueueentry element item state itemstate nonnull distribution queue state distributionqueuestate get state getstate distribution queue item distributionqueueitem first item firstitem queue peek distribution queue item status distributionqueueitemstatus first item status firstitemstatus first item firstitem status map statusmap first item firstitem distribution queue utils distributionqueueutils calculate state calculatestate first item firstitem first item status firstitemstatus override distribution queue status distributionqueuestatus get status getstatus distribution queue status distributionqueuestatus queue size get state getstate nonnull iterable distribution queue entry distributionqueueentry get items getitems skip limit list distribution queue entry distributionqueueentry result array list arraylist distribution queue entry distributionqueueentry distribution queue item distributionqueueitem item queue result add distribution queue entry distributionqueueentry item status map statusmap item result check for null checkfornull distribution queue entry distributionqueueentry get item getitem nonnull string distribution queue item distributionqueueitem item queue equals item get id getid distribution queue entry distributionqueueentry item status map statusmap item check for null checkfornull distribution queue entry distributionqueueentry remove nonnull string distribution queue entry distributionqueueentry to remove toremove get item getitem removed to remove toremove removed queue remove to remove toremove get item getitem log info item removed queue removed removed to remove toremove
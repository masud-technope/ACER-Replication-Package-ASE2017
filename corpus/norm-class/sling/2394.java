licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling validation impl resource model resourcemodel java util array list arraylist java util collection java util collections java util hash map hashmap java util list java util map java util regex matcher java util regex pattern javax annotation nonnull javax jcr node javax jcr repository exception repositoryexception javax jcr session org apache jackrabbit jcr constants jcrconstants org apache jackrabbit util text org apache sling api resource login exception loginexception org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling jcr resource jcr resource constants jcrresourceconstants org apache sling testing mock jcr mock jcr mockjcr org apache sling testing mock jcr mock query mockquery org apache sling testing mock jcr mock query result mockqueryresult org apache sling testing mock jcr mock query result handler mockqueryresulthandler org apache sling testing mock sling resource resolver type resourceresolvertype org apache sling testing mock sling junit sling context slingcontext org apache sling validation validator org apache sling validation impl constants org apache sling validation impl model child resource impl childresourceimpl org apache sling validation impl model resource property builder resourcepropertybuilder org apache sling validation impl model validation model builder validationmodelbuilder org apache sling validation impl valid ators validators regex validator regexvalidator org apache sling validation model child resource childresource org apache sling validation model parameterized validator parameterizedvalidator org apache sling validation model resource property resourceproperty org apache sling validation model validation model validationmodel org hamcrest matchers org junit org junit org junit org junit rule org junit test resource validation model provider impl test resourcevalidationmodelproviderimpltest prefix and resource type prefixandresourcetype string prefix string resource type resourcetype prefix and resource type prefixandresourcetype string prefix string resource type resourcetype prefix prefix resource type resourcetype resource type resourcetype override hash code hashcode prime result result prime result prefix prefix hash code hashcode result prime result resource type resourcetype resource type resourcetype hash code hashcode result override equals object obj obj obj get class getclass obj get class getclass prefix and resource type prefixandresourcetype prefix and resource type prefixandresourcetype obj prefix prefix prefix equals prefix resource type resourcetype resource type resourcetype resource type resourcetype equals resource type resourcetype assume validation models stored libs apps validation models relative path string validation models relative path sling validation models string apps apps string libs libs resource apps validators root appsvalidatorsroot resource libs validators root libsvalidatorsroot map string object primary type unstructured map primarytypeunstructuredmap resource validation model provider impl resourcevalidationmodelproviderimpl model provider modelprovider resource resolver resourceresolver mock query result handler mockqueryresulthandler prefix based result handler prefixbasedresulthandler map prefix and resource type prefixandresourcetype list node validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype map string validator validator map validatormap map string object regex val didator param etrization regexvaldidatorparametrization validation model builder validationmodelbuilder model builder modelbuilder extract resource type strings jcr root apps validation sling resource type resourcetype sling validation model validated resource type validatedresourcetype resource type pattern resource type pattern pattern compile validated resource type validatedresourcetype rule sling context slingcontext search capability context sling context slingcontext resource resolver type resourceresolvertype jcr mock set up setup login exception loginexception persistence exception persistenceexception repository exception repositoryexception primary type unstructured map primarytypeunstructuredmap hash map hashmap string object primary type unstructured map primarytypeunstructuredmap jcr constants jcrconstants jcr primarytype jcr constants jcrconstants unstructured model provider modelprovider resource validation model provider impl resourcevalidationmodelproviderimpl validator map validatormap hash map hashmap string validator validator map validatormap org apache sling validation impl valid ators validators regex validator regexvalidator regex validator regexvalidator model model builder modelbuilder validation model builder validationmodelbuilder model builder modelbuilder set applicable path setapplicablepath content site resource property builder resourcepropertybuilder property builder propertybuilder resource property builder resourcepropertybuilder property builder propertybuilder validator regex validator regexvalidator regex validator regexvalidator regex param prefix resource property resourceproperty property property builder propertybuilder build field model builder modelbuilder resource property resourceproperty property prefix based result handler prefixbasedresulthandler mock query result handler mockqueryresulthandler override mock query result mockqueryresult execute query executequery mock query mockquery query xpath equals query get language getlanguage string statement query get statement getstatement validated resource type validatedresourcetype resource type statement starts with startswith jcr root statement statement substring jcr root length extract prefix statement string prefix text get absolute parent getabsoluteparent statement extract resource type statement matcher matcher resource type pattern matcher statement matcher matches illegal argument exception illegalargumentexception process query statements validated resource type validatedresourcetype statement statement string resource type resourcetype matcher group prefix and resource type prefixandresourcetype prefix and resource type prefixandresourcetype prefix and resource type prefixandresourcetype prefix resource type resourcetype validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype key set keyset prefix and resource type prefixandresourcetype mock query result mockqueryresult validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype prefix and resource type prefixandresourcetype context resource resolver resourceresolver mock jcr mockjcr add query result handler addqueryresulthandler adapt to adaptto session prefix based result handler prefixbasedresulthandler validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype hash map hashmap prefix and resource type prefixandresourcetype list node apps validators root appsvalidatorsroot resource util resourceutil get or create resource getorcreateresource apps validation models relative path map string object sling folder libs validators root libsvalidatorsroot resource util resourceutil get or create resource getorcreateresource libs validation models relative path map string object sling folder tear down teardown persistence exception persistenceexception apps validators root appsvalidatorsroot delete apps validators root appsvalidatorsroot libs validators root libsvalidatorsroot delete libs validators root libsvalidatorsroot commit test test get validation model testgetvalidationmodel exception build models manually identical applicable path validation model validationmodel model model builder modelbuilder build sling validation test model builder modelbuilder set applicable path setapplicablepath content site validation model validationmodel model model builder modelbuilder build sling validation test build models jcr create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model check models returned collection validation model validationmodel models model provider modelprovider get model getmodel sling validation test validator map validatormap assert that assertthat models matchers contains in any order containsinanyorder model model test test get validation model out side search path testgetvalidationmodeloutsidesearchpath exception build models manually identical applicable path validation model validationmodel model model builder modelbuilder build sling validation test resource content validators root contentvalidatorsroot resource util resourceutil get or create resource getorcreateresource content map string object sling folder build models jcr search path apps libs create validation model resource createvalidationmodelresource content validators root contentvalidatorsroot get path getpath test validation model testvalidationmodel model check model collection validation model validationmodel models model provider modelprovider get model getmodel sling validation test validator map validatormap assert that assertthat model resource resolver search path models matchers empty delete content validators root contentvalidatorsroot test test get validation model with children testgetvalidationmodelwithchildren exception build models manually identical applicable path resource property builder resourcepropertybuilder resource property builder resourcepropertybuilder resource property builder resourcepropertybuilder resource property builder resourcepropertybuilder multiple resource property builder resourcepropertybuilder optional resource property resourceproperty child property childproperty resource property builder resourcepropertybuilder build child property model builder modelbuilder child resource childresource child resource impl childresourceimpl child collections singleton list singletonlist child property childproperty collections child resource childresource empty list emptylist validation model validationmodel model model builder modelbuilder build sling validation test build models jcr create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model compare models collection validation model validationmodel models model provider modelprovider get model getmodel sling validation test validator map validatormap assert that assertthat models matchers model test test get validation model with overlay testgetvalidationmodelwithoverlay exception create models manually identical applicable path validation model validationmodel model model builder modelbuilder build sling validation test model builder modelbuilder set applicable path setapplicablepath content site validation model validationmodel model model builder modelbuilder build sling validation test create models jcr libs apps distinguish able distinguishable applicable path applicablepath create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model create validation model resource createvalidationmodelresource apps validators root appsvalidatorsroot get path getpath test validation model testvalidationmodel model apps model returned collection validation model validationmodel models model provider modelprovider get model getmodel sling validation test validator map validatormap assert that assertthat models matchers model test expected illegal state exception illegalstateexception test get validation model with invalid validator testgetvalidationmodelwithinvalidvalidator exception create model validation model validationmodel model model builder modelbuilder build sling validation test create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model clear validator map referenced validator unknown validator map validatormap clear model provider modelprovider get model getmodel sling validation test validator map validatormap test expected illegal state exception illegalstateexception test get validation model with missing children and properties testgetvalidationmodelwithmissingchildrenandproperties exception create model children properties model builder modelbuilder validation model builder validationmodelbuilder model builder modelbuilder add applicable path addapplicablepath content site validation model validationmodel model model builder modelbuilder build sling validation test create validation model resource createvalidationmodelresource libs validators root libsvalidatorsroot get path getpath test validation model testvalidationmodel model model provider modelprovider get model getmodel sling validation test validator map validatormap resource create validation model resource createvalidationmodelresource resource resolver resourceresolver string root string validation model validationmodel model exception map string object model properties modelproperties hash map hashmap string object model properties modelproperties constants validate d validated resource type model get valid ated resource type getvalidatedresourcetype model properties modelproperties constants app licable applicable paths model get applicable paths getapplicablepaths model properties modelproperties jcr resource constants jcrresourceconstants sling resource type property constants validation model resource type model properties modelproperties jcr constants jcrconstants jcr primarytype jcr constants jcrconstants unstructured resource model resource modelresource resource util resourceutil get or create resource getorcreateresource root model properties modelproperties jcr resource constants jcrresourceconstants sling folder model create validation model properties createvalidationmodelproperties model resource modelresource model get resource properties getresourceproperties child resource childresource child model get children getchildren create validation model child resource createvalidationmodelchildresource model resource modelresource child add search handler root path string prefix text get absolute parent getabsoluteparent root prefix and resource type prefixandresourcetype prefix and resource type prefixandresourcetype prefix and resource type prefixandresourcetype prefix model get valid ated resource type getvalidatedresourcetype list node nodes nodes validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype prefix and resource type prefixandresourcetype nodes nodes array list arraylist node validator model nodes per prefix and resource type validatormodelnodesperprefixandresourcetype prefix and resource type prefixandresourcetype nodes nodes add model resource modelresource adapt to adaptto node model resource modelresource create validation model properties createvalidationmodelproperties resource model nonnull collection resource property resourceproperty properties persistence exception persistenceexception resource resolver resourceresolver model get resource resolver getresourceresolver properties is empty isempty resource properties resource propertiesresource resource util resourceutil get or create resource getorcreateresource model get path getpath constants properties jcr constants jcrconstants unstructured resource property resourceproperty property properties map string object modelpropertyjcrproperties hash map hashmap string object modelpropertyjcrproperties jcr constants jcrconstants jcr primarytype jcr constants jcrconstants unstructured resource property resource propertyresource resource util resourceutil get or create resource getorcreateresource properties resource propertiesresource get path getpath property get name getname modelpropertyjcrproperties property resource propertyresource modifiable value map modifiablevaluemap values property resource propertyresource adapt to adaptto modifiable value map modifiablevaluemap pattern pattern property get name pattern getnamepattern pattern values constants regex pattern pattern values constants property multiple property is multiple ismultiple values constants optional property is required isrequired resource valid ators validators resource util resourceutil get or create resource getorcreateresource property resource propertyresource get path getpath constants val idators validators jcr constants jcrconstants unstructured valid ators validators parameterized validator parameterizedvalidator validator property get validators getvalidators map string object validator properties validatorproperties hash map hashmap string object validator properties validatorproperties jcr constants jcrconstants jcr primarytype jcr constants jcrconstants unstructured map string object parameters validator get parameters getparameters parameters is empty isempty convert format validator properties validatorproperties constants validator arguments convert map to jcr validator arguments convertmaptojcrvalidatorarguments parameters resource util resourceutil get or create resource getorcreateresource valid ators validators get path getpath validator get validator getvalidator get class getclass get name getname validator properties validatorproperties convert format string array key param map string convert map to jcr validator arguments convertmaptojcrvalidatorarguments map string object map list string parameters for jcr parametersforjcr array list arraylist string map entry string object entry map entry set entryset parameters for jcr parametersforjcr add entry get key getkey entry get value getvalue parameters for jcr parametersforjcr to array toarray string resource create validation model child resource createvalidationmodelchildresource resource parent resource parentresource child resource childresource child persistence exception persistenceexception resource resolver resourceresolver parent resource parentresource get resource resolver getresourceresolver resource model children modelchildren create parent resource parentresource constants children primary type unstructured map primarytypeunstructuredmap resource model resource modelresource create model children modelchildren child get name getname primary type unstructured map primarytypeunstructuredmap modifiable value map modifiablevaluemap mvm model resource modelresource adapt to adaptto modifiable value map modifiablevaluemap child get name pattern getnamepattern mvm constants regex child get name pattern getnamepattern mvm constants optional child is required isrequired create validation model properties createvalidationmodelproperties model resource modelresource child get properties getproperties recursion childs child resource childresource grand child grandchild child get children getchildren create validation model child resource createvalidationmodelchildresource model resource modelresource grand child grandchild model resource modelresource
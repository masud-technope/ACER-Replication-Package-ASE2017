licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event impl jobs tasks java util calendar java util iterator org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling event impl jobs config job manager configuration jobmanagerconfiguration org apache sling event impl jobs config topology capabilities topologycapabilities org apache sling event impl jobs scheduling job scheduler impl jobschedulerimpl org slf logger org slf logger factory loggerfactory main tenance maintenance task configuration task runs minute clean up task cleanuptask logger logger logger logger factory loggerfactory get logger getlogger get class getclass job manager configuration job manager configuration jobmanagerconfiguration configuration job scheduler job scheduler impl jobschedulerimpl job scheduler jobscheduler count scheduler runs scheduler runs schedulerruns constructor clean up task cleanuptask job manager configuration jobmanagerconfiguration config job scheduler impl jobschedulerimpl job scheduler jobscheduler configuration config job scheduler jobscheduler job scheduler jobscheduler main tenance maintenance scheduler runs schedulerruns logger debug job manager main tenance maintenance starting scheduler runs schedulerruns topology capabilities topologycapabilities topology capabilities topologycapabilities configuration get topology capabilities gettopologycapabilities topology capabilities topologycapabilities clean string clean up unassigned path cleanupunassignedpath topology capabilities topologycapabilities is leader isleader clean up unassigned path cleanupunassignedpath configuration get unassigned jobs path getunassignedjobspath clean up unassigned path cleanupunassignedpath job scheduler handled scheduler runs schedulerruns job scheduler jobscheduler main tenance maintenance scheduler runs schedulerruns full clean hour full empty folder clean up fullemptyfoldercleanup topology capabilities topologycapabilities configuration get local jobs path getlocaljobspath clean up unassigned path cleanupunassignedpath full empty folder clean up fullemptyfoldercleanup topology capabilities topologycapabilities clean up unassigned path cleanupunassignedpath scheduler runs schedulerruns simple clean minutes simple empty folder clean up simpleemptyfoldercleanup topology capabilities topologycapabilities configuration get local jobs path getlocaljobspath clean up unassigned path cleanupunassignedpath simple empty folder clean up simpleemptyfoldercleanup topology capabilities topologycapabilities clean up unassigned path cleanupunassignedpath logger debug job manager main tenance maintenance finished scheduler runs schedulerruns simple empty folder removes empty folders ten minutes starting minutes folder minute removed check hour folder simple empty folder clean up simpleemptyfoldercleanup topology capabilities topologycapabilities caps string base path basepath logger debug cleaning job resource tree empty folders resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver calendar clean up date cleanupdate calendar get instance getinstance minutes clean up date cleanupdate add calendar minute resource base resource baseresource resolver get resource getresource base path basepath sanity check base resource baseresource iterator resource topic iter topiciter base resource baseresource list children listchildren caps is active isactive topic iter topiciter has next hasnext resource topic resource topicresource topic iter topiciter caps is active isactive string builder stringbuilder string builder stringbuilder topic resource topicresource get path getpath append append clean up date cleanupdate calendar year append append clean up date cleanupdate calendar month append append clean up date cleanupdate calendar day month append append clean up date cleanupdate calendar hour day append append clean up date cleanupdate calendar minute string path to string tostring resource date resource dateresource resolver get resource getresource path date resource dateresource date resource dateresource list children listchildren has next hasnext resolver delete date resource dateresource resolver commit check hour folder path ends with endswith string hour path hourpath path substring path length resource hour resource hourresource resolver get resource getresource hour path hourpath hour resource hourresource hour resource hourresource list children listchildren has next hasnext resolver delete hour resource hourresource resolver commit minute time clean up date cleanupdate add calendar minute persistence exception persistenceexception logger warn exception job resource tree cleanup resolver close full cleanup scans directories full empty folder clean up fullemptyfoldercleanup topology capabilities topologycapabilities caps string base path basepath logger debug cleaning job resource tree removing empty folders resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver resolver resource base resource baseresource resolver get resource getresource base path basepath sanity check base resource baseresource calendar calendar get instance getinstance iterator resource topic iter topiciter base resource baseresource list children listchildren caps is active isactive topic iter topiciter has next hasnext resource topic resource topicresource topic iter topiciter years iterator resource year iter yeariter topic resource topicresource list children listchildren caps is active isactive year iter yeariter has next hasnext resource year resource yearresource year iter yeariter year integer value of valueof year resource yearresource get name getname old year oldyear year calendar year months iterator resource month iter monthiter year resource yearresource list children listchildren caps is active isactive month iter monthiter has next hasnext resource month resource monthresource month iter monthiter month integer value of valueof month resource monthresource get name getname old month oldmonth old year oldyear month calendar month days iterator resource day iter dayiter month resource monthresource list children listchildren caps is active isactive day iter dayiter has next hasnext resource day resource dayresource day iter dayiter day integer value of valueof day resource dayresource get name getname old day oldday old month oldmonth day calendar day month hours iterator resource hour iter houriter day resource dayresource list children listchildren caps is active isactive hour iter houriter has next hasnext resource hour resource hourresource hour iter houriter hour integer value of valueof hour resource hourresource get name getname old hour oldhour old day oldday old month oldmonth calendar hour day hour calendar hour day remove minutes hour old hour oldhour iterator resource minute iter minuteiter hour resource hourresource list children listchildren caps is active isactive minute iter minuteiter has next hasnext resource minute resource minuteresource minute iter minuteiter check delete minute minute resource minuteresource list children listchildren has next hasnext resolver delete minute resource minuteresource resolver commit check delete hour caps is active isactive old hour oldhour hour resource hourresource list children listchildren has next hasnext resolver delete hour resource hourresource resolver commit check delete day caps is active isactive old day oldday day resource dayresource list children listchildren has next hasnext resolver delete day resource dayresource resolver commit check delete month caps is active isactive old month oldmonth month resource monthresource list children listchildren has next hasnext resolver delete month resource monthresource resolver commit check delete year caps is active isactive old year oldyear year resource yearresource list children listchildren has next hasnext resolver delete year resource yearresource resolver commit persistence exception persistenceexception logger warn exception job resource tree cleanup resolver close
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl filter java net uri java net uri syntax exception urisyntaxexception java util array list arraylist java util arrays java util collection java util hash map hashmap java util map java util org apache commons lang string utils stringutils org apache felix scr annotations component org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling api resource resource util resourceutil org apache sling scripting sightly extension runtime extension runtimeextension org apache sling scripting sightly impl compiler expression expression org apache sling scripting sightly impl compiler expression expression node expressionnode org apache sling scripting sightly impl compiler expression node map literal mapliteral org apache sling scripting sightly impl compiler expression node runtime call runtimecall org apache sling scripting sightly impl engine extension extension utils extensionutils org apache sling scripting sightly impl engine runtime render context impl rendercontextimpl org apache sling scripting sightly impl utils path info pathinfo org apache sling scripting sightly impl utils render utils renderutils org apache sling scripting sightly render render context rendercontext code uri manipulation filter urimanipulationfilter support sightly uri manipulation options href https github adobe mark eting marketing cloud sightly spec blob specification language specification component service filter runtime extension runtimeextension properties property runtime extension runtimeextension uri manipulation filter urimanipulationfilter uri manipulation function uri manipulation filter urimanipulationfilter filter component filtercomponent runtime extension runtimeextension string uri manipulation function uri manipulation urimanipulation string scheme scheme string domain domain string path path string append path append path appendpath string prepend path prepend path prependpath string selectors selectors string add selectors add selectors addselectors string remove selectors remove selectors removeselectors string extension extension string suffix suffix string prepend suffix prepend suffix prependsuffix string append suffix append suffix appendsuffix string fragment fragment string query query string add query add query addquery string remove query remove query removequery override expression apply expression expression expression context expressioncontext expression context expressioncontext expression contains option containsoption scheme expression contains option containsoption domain expression contains option containsoption path expression contains option containsoption append path expression contains option containsoption prepend path expression contains option containsoption selectors expression contains option containsoption add selectors expression contains option containsoption remove selectors expression contains option containsoption extension expression contains option containsoption suffix expression contains option containsoption prepend suffix expression contains option containsoption append suffix expression contains option containsoption fragment expression contains option containsoption query expression contains option containsoption add query expression contains option containsoption remove query expression context expressioncontext expression context expressioncontext plugin data sly expression context expressioncontext expression context expressioncontext plugin data sly template expression context expressioncontext expression context expressioncontext plugin data sly call expression context expressioncontext expression context expressioncontext plugin data sly resource map string expression node expressionnode uri options urioptions hash map hashmap string expression node expressionnode collect options collectoptions expression uri options urioptions scheme domain path append path prepend path selectors add selectors remove selectors extension suffix prepend suffix append suffix fragment query add query remove query uri options urioptions size expression node expressionnode translation runtime call runtimecall uri manipulation function expression get root getroot map literal mapliteral uri options urioptions expression with node withnode translation expression override suppress warnings suppresswarnings unchecked object call render context rendercontext render context rendercontext object arguments extension utils extensionutils check argument count checkargumentcount uri manipulation function arguments string uri string uristring render utils renderutils to string tostring arguments map string object options render utils renderutils to map tomap arguments uri string uristring string builder stringbuilder string builder stringbuilder path info pathinfo path info pathinfo path info pathinfo uri string uristring uri appender uriappender scheme options path info pathinfo get scheme getscheme length append append string utils stringutils default if empty defaultifempty path info pathinfo get begin path separator getbeginpathseparator length uri appender uriappender domain options path info pathinfo get host gethost string domain get option getoption domain options path info pathinfo get host gethost string utils stringutils is not empty isnotempty domain append append domain path info pathinfo get port getport append append path info pathinfo get port getport string prepend path prependpath get option getoption prepend path options string utils stringutils empty prepend path prependpath prepend path prependpath string utils stringutils empty string utils stringutils is not empty isnotempty prepend path prependpath length prepend path prependpath starts with startswith prepend path prependpath prepend path prependpath prepend path prependpath ends with endswith prepend path prependpath string path get option getoption path options path info pathinfo get path getpath string utils stringutils is empty isempty path path for ced forced empty don remove path path path info pathinfo get path getpath string append path appendpath get option getoption append path options string utils stringutils empty append path appendpath append path appendpath string utils stringutils empty string utils stringutils is not empty isnotempty append path appendpath append path appendpath starts with startswith append path appendpath append path appendpath string new path newpath new path newpath uri prepend path prependpath path append path appendpath normalize get path getpath uri syntax exception urisyntaxexception new path newpath prepend path prependpath path append path appendpath length last index of lastindexof length string utils stringutils is not empty isnotempty new path newpath new path newpath starts with startswith append append new path newpath string selectors path info pathinfo get selectors getselectors handle selectors handleselectors selectors options string selector selectors string utils stringutils is not blank isnotblank selector selector append empty invalid selectors append append selector string extension get option getoption extension options path info pathinfo get extension getextension string utils stringutils is not empty isnotempty extension append append extension string prepend suffix prependsuffix get option getoption prepend suffix options string utils stringutils empty string utils stringutils is not empty isnotempty prepend suffix prependsuffix prepend suffix prependsuffix starts with startswith prepend suffix prependsuffix prepend suffix prependsuffix prepend suffix prependsuffix ends with endswith prepend suffix prependsuffix string path info suffix pathinfosuffix path info pathinfo get suffix getsuffix string suffix get option getoption suffix options path info suffix pathinfosuffix string utils stringutils empty path info suffix pathinfosuffix suffix suffix string utils stringutils empty string append suffix appendsuffix get option getoption append suffix options string utils stringutils empty string utils stringutils is not empty isnotempty append suffix appendsuffix append suffix appendsuffix append suffix appendsuffix string new suffix newsuffix resource util resourceutil normalize prepend suffix prependsuffix suffix append suffix appendsuffix string utils stringutils is not empty isnotempty new suffix newsuffix new suffix newsuffix starts with startswith append append new suffix newsuffix map string collection string parameters path info pathinfo get parameters getparameters handle parameters handleparameters parameters options parameters is empty isempty append map entry string collection string entry parameters entry set entryset string entry get value getvalue append entry get key getkey append append append delete delete char at deletecharat length string fragment get option getoption fragment options path info pathinfo get fragment getfragment string utils stringutils is not empty isnotempty fragment append append fragment to string tostring collect options collectoptions expression expression map string expression node expressionnode collector string option names optionnames string option name optionname option names optionnames expression contains option containsoption option name optionname collector option name optionname expression get option getoption option name optionname expression remove options removeoptions option names optionnames uri appender uriappender string builder stringbuilder string builder stringbuilder string option map string object options string default value defaultvalue string string options option string utils stringutils is not empty isnotempty string builder stringbuilder append string utils stringutils is not empty isnotempty default value defaultvalue string builder stringbuilder append default value defaultvalue string get option getoption string option map string object options string default value defaultvalue options contains key containskey option string options option default value defaultvalue handle selectors handleselectors string selectors map string object options options contains key containskey selectors object selectors option selectorsoption options selectors selectors option selectorsoption remove selectors selectors clear selectors option selectorsoption string string selector string selectorstring string selectors option selectorsoption string selectors array selectorsarray selector string selectorstring split replace selectors replaceselectors selectors selectors array selectorsarray selectors option selectorsoption object object selectorsuriarray object selectors option selectorsoption string selectors array selectorsarray string selectorsuriarray length object selector selectorsuriarray selectors array selectorsarray render utils renderutils to string tostring selector replace selectors replaceselectors selectors selectors array selectorsarray object add selectors option addselectorsoption options add selectors add selectors option addselectorsoption string string selector string selectorstring string add selectors option addselectorsoption string selectors array selectorsarray selector string selectorstring split add selectors addselectors selectors selectors array selectorsarray add selectors option addselectorsoption object object selectorsuriarray object add selectors option addselectorsoption string selectors array selectorsarray string selectorsuriarray length object selector selectorsuriarray selectors array selectorsarray render utils renderutils to string tostring selector add selectors addselectors selectors selectors array selectorsarray object remove selectors option removeselectorsoption options remove selectors remove selectors option removeselectorsoption string string selector string selectorstring string remove selectors option removeselectorsoption string selectors array selectorsarray selector string selectorstring split remove selectors removeselectors selectors selectors array selectorsarray remove selectors option removeselectorsoption object object selectorsuriarray object remove selectors option removeselectorsoption string selectors array selectorsarray string selectorsuriarray length object selector selectorsuriarray selectors array selectorsarray render utils renderutils to string tostring selector remove selectors removeselectors selectors selectors array selectorsarray replace selectors replaceselectors string selectors string selectors array selectorsarray selectors clear selectors add all addall arrays as list aslist selectors array selectorsarray add selectors addselectors string selectors string selectors array selectorsarray selectors add all addall arrays as list aslist selectors array selectorsarray remove selectors removeselectors string selectors string selectors array selectorsarray selectors remove all removeall arrays as list aslist selectors array selectorsarray suppress warnings suppresswarnings unchecked handle parameters handleparameters map string collection string parameters map string object options options contains key containskey query object query option queryoption options query parameters clear map string object query parameters queryparameters render utils renderutils to map tomap query option queryoption map entry string object entry query parameters queryparameters entry set entryset object entry value entryvalue entry get value getvalue render utils renderutils is collection iscollection entry value entryvalue collection object collection render utils renderutils to collection tocollection entry value entryvalue collection string values array list arraylist string collection size object collection values add render utils renderutils to string tostring parameters entry get key getkey values collection string values array list arraylist string values add render utils renderutils to string tostring entry value entryvalue parameters entry get key getkey values object add query option addqueryoption options add query add query option addqueryoption map string object add params addparams render utils renderutils to map tomap add query option addqueryoption map entry string object entry add params addparams entry set entryset object entry value entryvalue entry get value getvalue render utils renderutils is collection iscollection entry value entryvalue collection object collection render utils renderutils to collection tocollection entry value entryvalue collection string values array list arraylist string collection size object collection values add render utils renderutils to string tostring parameters entry get key getkey values collection string values array list arraylist string values add render utils renderutils to string tostring entry value entryvalue parameters entry get key getkey values object remove query option removequeryoption options remove query remove query option removequeryoption remove query option removequeryoption string parameters remove remove query option removequeryoption remove query option removequeryoption object object remove query param array removequeryparamarray object remove query option removequeryoption object param remove query param array removequeryparamarray string param string paramstring render utils renderutils to string tostring param param string paramstring parameters remove param string paramstring
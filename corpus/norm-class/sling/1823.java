licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event impl jobs scheduling java util calendar java util collection java util hash map hashmap java util list java util map java util concurrent blocking queue blockingqueue java util concurrent linked blocking queue linkedblockingqueue java util concurrent atomic atomic boolean atomicboolean java util concurrent atomic atomic long atomiclong org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling api resource value map valuemap org apache sling event impl jobs config job manager configuration jobmanagerconfiguration org apache sling event impl support environment org apache sling event impl support resource helper resourcehelper org apache sling event impl support schedule info impl scheduleinfoimpl org apache sling event jobs job org apache sling event jobs schedule info scheduleinfo org slf logger org slf logger factory loggerfactory scheduled job handler scheduledjobhandler runnable holder calendar created scheduled job info impl scheduledjobinfoimpl info read logger logger logger logger factory loggerfactory get logger getlogger get class getclass job manager configuration job manager configuration jobmanagerconfiguration configuration job scheduler job scheduler impl jobschedulerimpl job scheduler jobscheduler map scheduled jobs key filtered schedule map string holder scheduled jobs scheduledjobs hash map hashmap string holder atomic long atomiclong last bundle activity lastbundleactivity atomic long atomiclong atomic boolean atomicboolean is running isrunning atomic boolean atomicboolean local queue serial izing serializing event processing blocking queue blockingqueue runnable queue linked blocking queue linkedblockingqueue runnable param configuration current job manager configuration scheduled job handler scheduledjobhandler job manager configuration jobmanagerconfiguration configuration job scheduler impl jobschedulerimpl job scheduler jobscheduler configuration configuration job scheduler jobscheduler job scheduler jobscheduler thread thread apache sling scheduled job handler thread set daemon setdaemon start add full scan addfullscan add task runnable queue add task addtask runnable queue interrupted exception interruptedexception ignore exception ignoreexception thread current thread currentthread int errupt interrupt add full scan task queue add full scan addfullscan add task addtask runnable override scan deactivate is running isrunning queue clear nop runnable wake queue add task addtask runnable override override is running isrunning runnable queue interrupted exception interruptedexception ignore exception ignoreexception thread current thread currentthread int errupt interrupt is running isrunning is running isrunning scan resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver resolver logger debug scan ning scanning scheduled jobs string path configuration get scheduled jobs path getscheduledjobspath resource start resource startresource resolver get resource getresource path start resource startresource map string holder new scheduled jobs newscheduledjobs hash map hashmap string holder scheduled jobs scheduledjobs resource rsrc start resource startresource get children getchildren is running isrunning handle add or update handleaddorupdate new scheduled jobs newscheduledjobs rsrc is running isrunning holder scheduled jobs scheduledjobs values info job scheduler jobscheduler unschedule job unschedulejob info scheduled jobs scheduledjobs clear scheduled jobs scheduledjobs put all putall new scheduled jobs newscheduledjobs logger debug finished scanning scheduled jobs resolver close read scheduled job resource job code code map string object read scheduled job readscheduledjob resource event resource eventresource value map valuemap resource helper resourcehelper get value map getvaluemap event resource eventresource map string object properties resource helper resourcehelper clone value map clonevaluemap suppress warnings suppresswarnings unchecked list exception read error list readerrorlist list exception properties remove resource helper resourcehelper property marker read error list read error list readerrorlist exception read error list readerrorlist logger warn unable read scheduled job event resource eventresource get path getpath properties instantiation exception instantiationexception ignore exception ignoreexception write scheduled job resource tree persistence exception persistenceexception scheduled job info impl scheduledjobinfoimpl add or update job addorupdatejob string job topic jobtopic map string object job properties jobproperties string schedule name schedulename suspend list schedule info impl scheduleinfoimpl schedule infos scheduleinfos persistence exception persistenceexception map string object properties write scheduled job writescheduledjob job topic jobtopic job properties jobproperties schedule name schedulename suspend schedule infos scheduleinfos string key resource helper resourcehelper filter name filtername schedule name schedulename scheduled jobs scheduledjobs holder scheduled jobs scheduledjobs remove key info job scheduler jobscheduler unschedule job unschedulejob info holder holder holder holder created calendar properties job property job created holder read system current time millis currenttimemillis holder info add or update scheduled job addorupdatescheduledjob properties info job scheduler jobscheduler schedule job schedulejob holder info holder info map string object write scheduled job writescheduledjob string job topic jobtopic map string object job properties jobproperties string schedule name schedulename suspend list schedule info impl scheduleinfoimpl schedule infos scheduleinfos persistence exception persistenceexception resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver create properties map string object properties hash map hashmap string object job properties jobproperties map entry string object entry job properties jobproperties entry set entryset string prop name propname entry get key getkey resource helper resourcehelper ignore property ignoreproperty prop name propname properties prop name propname entry get value getvalue properties resource helper resourcehelper property job topic job topic jobtopic properties job property job created calendar get instance getinstance properties job property job created instance environment application scheduler scheduler info properties resource helper resourcehelper property schedule schedule name schedulename string info array infoarray string schedule infos scheduleinfos size schedule info impl scheduleinfoimpl info schedule infos scheduleinfos info array infoarray info get serialized string getserializedstring properties resource helper resourcehelper property schedule info info array infoarray suspend properties resource helper resourcehelper property schedule suspended create path resource properties resource resolver resourceresolver property resource type resource helper resourcehelper resource type schedule d scheduled job string path configuration get scheduled jobs path getscheduledjobspath resource helper resourcehelper filter name filtername schedule name schedulename update existing resource resource existing info existinginfo resolver get resource getresource path existing info existinginfo resolver delete existing info existinginfo logger debug updating scheduled job properties path logger debug storing scheduled job properties path resource helper resourcehelper get or create resource getorcreateresource resolver path properties real schedule infos properties resource helper resourcehelper property schedule info schedule infos scheduleinfos properties resolver close scheduled job info impl scheduledjobinfoimpl add or update scheduled job addorupdatescheduledjob map string object properties scheduled job info impl scheduledjobinfoimpl old info oldinfo properties remove resource resolver resourceresolver property resource type properties remove job property job created properties remove job property job created instance string job topic jobtopic string properties remove resource helper resourcehelper property job topic string scheduler name schedulername string properties remove resource helper resourcehelper property schedule scheduled job info impl scheduledjobinfoimpl info old info oldinfo info scheduled job info impl scheduledjobinfoimpl job scheduler jobscheduler scheduler name schedulername info old info oldinfo info update job topic jobtopic properties info bundle event occurred loading jobs failed missing classes bundle event bundleevent last bundle activity lastbundleactivity system current time millis currenttimemillis add task addtask runnable override map string holder update jobs updatejobs hash map hashmap string scheduled job handler scheduledjobhandler holder scheduled jobs scheduledjobs map entry string holder entry scheduled jobs scheduledjobs entry set entryset entry get value getvalue info entry get value getvalue read last bundle activity lastbundleactivity update jobs updatejobs entry get key getkey entry get value getvalue update jobs updatejobs is empty isempty is running isrunning resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver resolver map entry string holder entry update jobs updatejobs entry set entryset string path configuration get scheduled jobs path getscheduledjobspath entry get key getkey resource rsrc resolver get resource getresource path is running isrunning rsrc scheduled jobs scheduledjobs handle add or update handleaddorupdate scheduled jobs scheduledjobs rsrc resolver close handle observation event removing scheduled job param path path job handle remove handleremove string path add task addtask runnable override is running isrunning string schedule key schedulekey resource helper resourcehelper filter name filtername resource util resourceutil get name getname path schedule key schedulekey scheduled jobs scheduledjobs holder scheduled jobs scheduledjobs remove schedule key schedulekey info job scheduler jobscheduler unschedule job unschedulejob info handle observation event adding updating scheduled job param path path job handle add update handleaddupdate string path add task addtask runnable override is running isrunning resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver resolver resource rsrc resolver get resource getresource path rsrc scheduled jobs scheduledjobs handle add or update handleaddorupdate scheduled jobs scheduledjobs rsrc resolver close handle add update resource param new scheduled jobs newscheduledjobs map store jobs param rsrc resource job handle add or update handleaddorupdate map string holder new scheduled jobs newscheduledjobs resource rsrc string resource helper resourcehelper filter name filtername rsrc get name getname holder scheduled scheduled jobs scheduledjobs remove read scheduled check loading failed retry scheduled info scheduled read last bundle activity lastbundleactivity read check update scheduled info value map valuemap resource util resourceutil get value map getvaluemap rsrc calendar changed calendar job property job created changed scheduled created compare to compareto changed read read new scheduled jobs newscheduledjobs scheduled read read read holder holder holder holder read system current time millis currenttimemillis map string object properties read scheduled job readscheduledjob rsrc properties holder created calendar properties job property job created holder info add or update scheduled job addorupdatescheduledjob properties scheduled scheduled info new scheduled jobs newscheduledjobs holder holder info scheduled scheduled info job scheduler jobscheduler unschedule job unschedulejob scheduled info holder info job scheduler jobscheduler schedule job schedulejob holder info remove scheduled job param info schedule info remove scheduled job info impl scheduledjobinfoimpl info string schedule key schedulekey resource helper resourcehelper filter name filtername info get name getname resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver string builder stringbuilder string builder stringbuilder configuration get scheduled jobs path getscheduledjobspath append schedule key schedulekey string path to string tostring resource event resource eventresource resolver get resource getresource path event resource eventresource resolver delete event resource eventresource resolver commit persistence exception persistenceexception ignore exception ignoreexception resolver close scheduled jobs scheduledjobs holder scheduled jobs scheduledjobs remove schedule key schedulekey info job scheduler jobscheduler unschedule job unschedulejob info update schedule updateschedule string schedule name schedulename collection schedule info scheduleinfo schedule info scheduleinfo resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver string schedule key schedulekey resource helper resourcehelper filter name filtername schedule name schedulename string builder stringbuilder string builder stringbuilder configuration get scheduled jobs path getscheduledjobspath append schedule key schedulekey string path to string tostring resource rsrc resolver get resource getresource path update find resource ignore rsrc calendar calendar get instance getinstance update holder scheduled jobs scheduledjobs holder scheduled jobs scheduledjobs schedule key schedulekey created modifiable value map modifiablevaluemap mvm rsrc adapt to adaptto modifiable value map modifiablevaluemap mvm job property job created string info array infoarray string schedule info scheduleinfo size schedule info scheduleinfo schedule info scheduleinfo info array infoarray schedule info impl scheduleinfoimpl get serialized string getserializedstring mvm resource helper resourcehelper property schedule info info array infoarray resolver commit persistence exception persistenceexception logger warn unable update scheduled job schedule name schedulename resolver close helper method logs exception debug mode param exception ignore exception ignoreexception exception logger is debug enabled isdebugenabled logger debug exception get message getmessage main tenance maintenance add full scan addfullscan
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution serialization impl javax annotation check for null checkfornull javax annotation nonnull java input stream inputstream java util collections java util hash map hashmap java util map java util uuid org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling api resource value map valuemap org apache sling distribution distribution request distributionrequest org apache sling distribution common distribution exception distributionexception org apache sling distribution serialization distribution package distributionpackage org apache sling distribution pack aging packaging impl distribution package utils distributionpackageutils org apache sling distribution serialization distribution package builder distributionpackagebuilder resource shared distribution package builder resourceshareddistributionpackagebuilder distribution package builder distributionpackagebuilder string original original string original request type original request type string original paths original paths string prefix distrpackage string shared packages root sharedpackagesroot string type distribution package builder distributionpackagebuilder distribution package builder distributionpackagebuilder global repolock syncing access shared root todo fine grained finegrained config urable configurable roots object repolock object resource shared distribution package builder resourceshareddistributionpackagebuilder distribution package builder distributionpackagebuilder distribution package exporter distributionpackageexporter distribution package builder distributionpackagebuilder distribution package exporter distributionpackageexporter type distribution package builder distributionpackagebuilder get type gettype shared packages root sharedpackagesroot abstract distribution package abstractdistributionpackage packages root type shared string get type gettype type nonnull distribution package distributionpackage create package createpackage nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull distribution request distributionrequest request distribution exception distributionexception distribution package distributionpackage distribution package distributionpackage distribution package builder distributionpackagebuilder create package createpackage resource resolver resourceresolver request string package name packagename package name packagename generate name from id generatenamefromid resource resolver resourceresolver distribution package distributionpackage persistence exception persistenceexception distribution package utils distributionpackageutils delete safely deletesafely distribution package distributionpackage distribution exception distributionexception string package path packagepath get path from name getpathfromname package name packagename resource shared distribution package resourceshareddistributionpackage repolock resource resolver resourceresolver package name packagename package path packagepath distribution package distributionpackage nonnull check for null checkfornull distribution package distributionpackage read package readpackage nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull input stream inputstream stream distribution exception distributionexception distribution package distributionpackage distribution package distributionpackage distribution package builder distributionpackagebuilder read package readpackage resource resolver resourceresolver stream distribution package distributionpackage string package name packagename package name packagename generate name from id generatenamefromid resource resolver resourceresolver distribution package distributionpackage persistence exception persistenceexception distribution package utils distributionpackageutils delete safely deletesafely distribution package distributionpackage distribution exception distributionexception string package path packagepath get path from name getpathfromname package name packagename resource shared distribution package resourceshareddistributionpackage repolock resource resolver resourceresolver package name packagename package path packagepath distribution package distributionpackage check for null checkfornull distribution package distributionpackage get package getpackage nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull string distribution package id distributionpackageid distribution exception distributionexception string package name packagename distribution package id distributionpackageid string original package id originalpackageid retrieve id from name retrieveidfromname resource resolver resourceresolver package name packagename original package id originalpackageid distribution package distributionpackage distribution package distributionpackage distribution package builder distributionpackagebuilder get package getpackage resource resolver resourceresolver original package id originalpackageid distribution package distributionpackage string package path packagepath get path from name getpathfromname package name packagename resource shared distribution package resourceshareddistributionpackage repolock resource resolver resourceresolver package name packagename package path packagepath distribution package distributionpackage install package installpackage nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull distribution package distributionpackage distribution package distributionpackage distribution exception distributionexception distribution package distributionpackage resource shared distribution package resourceshareddistributionpackage resource shared distribution package resourceshareddistributionpackage shared distribution package shareddistributionpackage resource shared distribution package resourceshareddistributionpackage distribution package distributionpackage distribution package distributionpackage original package originalpackage shared distribution package shareddistributionpackage get package getpackage distribution package builder distributionpackagebuilder install package installpackage resource resolver resourceresolver original package originalpackage string generate name from id generatenamefromid resource resolver resourceresolver resource resolver resourceresolver distribution package distributionpackage distribution package distributionpackage persistence exception persistenceexception string prefix system current time millis currenttimemillis uuid randomuuid map string object properties hash map hashmap string object properties original distribution package distributionpackage get id getid save info debug ging debugging purposes distribution package distributionpackage get info getinfo get request type getrequesttype properties original request type distribution package distributionpackage get info getinfo get request type getrequesttype to string tostring distribution package distributionpackage get info getinfo get paths getpaths properties original paths distribution package distributionpackage get info getinfo get paths getpaths string package path packagepath get path from name getpathfromname resource resource resource util resourceutil get or create resource getorcreateresource resource resolver resourceresolver package path packagepath sling folder sling folder modifiable value map modifiablevaluemap value map valuemap resource adapt to adaptto modifiable value map modifiablevaluemap value map valuemap put all putall properties repolock resource resolver resourceresolver create resource resource shared distribution package resourceshareddistributionpackage reference root node collections singleton map singletonmap resource resolver resourceresolver property resource type object sling folder resource resolver resourceresolver commit string get path from name getpathfromname string string package path packagepath shared packages root sharedpackagesroot package path packagepath string retrieve id from name retrieveidfromname resource resolver resourceresolver resource resolver resourceresolver string string package path packagepath get path from name getpathfromname resource resource resource resolver resourceresolver get resource getresource package path packagepath resource value map valuemap properties resource adapt to adaptto value map valuemap properties properties original
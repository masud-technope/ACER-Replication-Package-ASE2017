licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling startup filter startupfilter impl org junit assert equals assertequals java print writer printwriter java string writer stringwriter java util dictionary java util hashtable java util concurrent atomic atomic integer atomicinteger javax servlet filter javax servlet filter chain filterchain javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache sling startup filter startupfilter startup info provider startupinfoprovider org hamcrest description org jmock expectations org jmock mockery org jmock api action org jmock api invocation org jmock lib action do all action doallaction org junit org junit test org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework service listener servicelistener org osgi framework service reference servicereference org osgi framework service registration serviceregistration org osgi service component component context componentcontext test startup filter impl startupfilterimpl startup filter impl test startupfilterimpltest test provider testprovider startup info provider startupinfoprovider service reference servicereference string info test provider testprovider string info string get progress info getprogressinfo info object get property getproperty string key string get property keys getpropertykeys bundle get bundle getbundle bundle get using bundles getusingbundles is assignable to isassignableto bundle bundle string class name classname compare to compareto object reference test filter impl testfilterimpl startup filter impl startupfilterimpl setup component context componentcontext ctx exception activate ctx change integer changeinteger action increment atomic integer atomicinteger change integer changeinteger atomic integer atomicinteger increment increment increment describe to describeto description append text appendtext increment increment decrement append text appendtext int eger integer object invoke invocation invocation throwable increment increment and get incrementandget decrement and get decrementandget test filter impl testfilterimpl filter mockery mockery http servlet request httpservletrequest request http servlet response httpservletresponse response filter chain filterchain chain last returned status lastreturnedstatus string writer stringwriter message writer messagewriter atomic integer atomicinteger active filter count activefiltercount service registration serviceregistration service registration serviceregistration string request path requestpath string console root test system console setup active filter count activefiltercount atomic integer atomicinteger mockery mockery request mockery mock http servlet request httpservletrequest response mockery mock http servlet response httpservletresponse chain mockery mock filter chain filterchain service registration serviceregistration mockery mock service registration serviceregistration filter test filter impl testfilterimpl request path requestpath path set provider setprovider test provider testprovider provider exception bundle context bundlecontext bundle context bundlecontext mockery mock bundle context bundlecontext component context componentcontext component context componentcontext mockery mock component context componentcontext action store status storestatus action describe to describeto description append text appendtext store http response values object invoke invocation invocation throwable last returned status lastreturnedstatus integer invocation get parameter getparameter message writer messagewriter string writer stringwriter print writer printwriter response writer responsewriter print writer printwriter message writer messagewriter dictionary string object props hashtable string object props startup filter impl startupfilterimpl active prop service reference servicereference provider refs providerrefs provider service reference servicereference provider mockery checking expectations allowing component context componentcontext get bundle context getbundlecontext return value returnvalue bundle context bundlecontext allowing component context componentcontext get properties getproperties return value returnvalue props allowing bundle context bundlecontext create filter createfilter string allowing bundle context bundlecontext add service listener addservicelistener service listener servicelistener allowing bundle context bundlecontext add service listener addservicelistener service listener servicelistener string allowing bundle context bundlecontext get service references getservicereferences startup info provider startupinfoprovider get name getname return value returnvalue provider refs providerrefs allowing bundle context bundlecontext get service getservice service reference servicereference return value returnvalue provider allowing bundle context bundlecontext get property getproperty felix webconsole manager root return value returnvalue console root allowing bundle context bundlecontext register service registerservice filter get name getname object dictionary do all action doallaction change integer changeinteger active filter count activefiltercount return value returnvalue service registration serviceregistration allowing response set status setstatus integer store status storestatus allowing response set content type setcontenttype text plain allowing response get writer getwriter return value returnvalue response writer responsewriter allowing response set character encoding setcharacterencoding string allowing service registration serviceregistration unregister change integer changeinteger active filter count activefiltercount allowing request get path info getpathinfo return value returnvalue get request path getrequestpath allowing chain do filter dofilter servlet request servletrequest servlet response servletresponse filter setup component context componentcontext string get request path getrequestpath request path requestpath assert request assertrequest expected status expectedstatus string expected message expectedmessage exception last returned status lastreturnedstatus filter do filter dofilter request response chain string response text responsetext message writer messagewriter to string tostring status expect request assert equals assertequals expecting status match expected status expectedstatus last returned status lastreturnedstatus assert equals assertequals expecting message match expected message expectedmessage response text responsetext test test initial state testinitialstate exception set provider setprovider assert equals assertequals init ially initially expecting status message active filter count activefiltercount assert request assertrequest startup filter impl startupfilterimpl message test test bypass root testbypassroot exception request path requestpath console root set provider setprovider assert request assertrequest test test bypass sub path testbypasssubpath exception request path requestpath console root set provider setprovider assert request assertrequest test test disabling testdisabling exception set provider setprovider assert equals assertequals init ially initially expecting filter service active filter count activefiltercount filter disable assert equals assertequals expecting filter service active filter count activefiltercount test test providers testproviders exception test provider testprovider test provider testprovider test set provider setprovider assert equals assertequals init ially initially expecting filter service active filter count activefiltercount string expected message expectedmessage startup filter impl startupfilterimpl message ntest assert request assertrequest expected message expectedmessage filter disable assert equals assertequals expecting filter service active filter count activefiltercount
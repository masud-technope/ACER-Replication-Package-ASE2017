licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue java io exception ioexception java net url java util array list arraylist java util list javax servlet http http servlet response httpservletresponse org apache commons http client httpclient credentials org apache commons http client httpclient header org apache commons http client httpclient http method httpmethod org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient username password credentials usernamepasswordcredentials org apache commons http client httpclient auth scope authscope org apache commons http client httpclient methods get method getmethod org apache commons http client httpclient methods post method postmethod org apache sling commons testing int egration integration http test httptest org apache sling testing tools junit remote log dumper remotelogdumper org junit org junit org junit rule org junit test org junit rules test rule testrule test response code authentication request depending request parameters headers including validate ajax detection browser client detection authentication response code test authenticationresponsecodetest rule test rule testrule log rule logrule remote log dumper remotelogdumper http test httptest http test httptest setup exception set up setup cleanup exception tear down teardown test test valid ating correct form credentials testvalidatingcorrectformcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username admin params add name value pair namevaluepair password admin params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse params assert true asserttrue post get response body as string getresponsebodyasstring length list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse params assert true asserttrue post get response body as string getresponsebodyasstring length test test valid ating correct http basic credentials testvalidatingcorrecthttpbasiccredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse params assert true asserttrue post get response body as string getresponsebodyasstring length http method httpmethod assert http status asserthttpstatus http test httptest http base url validate http servlet response httpservletresponse assert true asserttrue get response body as string getresponsebodyasstring length test test valid ating incorrect credentials testvalidatingincorrectcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse forbidden params assert not null assertnotnull post get response header getresponseheader reason test test valid ating incorrect cookie testvalidatingincorrectcookie exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair validate list header headers array list arraylist header headers add header cookie sling form auth formauth garbage http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse forbidden params headers assertxreason post test test valid ating incorrect http basic credentials testvalidatingincorrecthttpbasiccredentials exception assume http webdav host port url url url http test httptest http base url credentials default creds defaultcreds username password credentials usernamepasswordcredentials garbage garbage get http client gethttpclient get state getstate set credentials setcredentials auth scope authscope url get host gethost url get port getport auth scope authscope realm default creds defaultcreds list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse forbidden params assertxreason post http method httpmethod assert http status asserthttpstatus http test httptest http base url validate http servlet response httpservletresponse forbidden assertxreason test test prevent loop incorrect http basic credentials testpreventloopincorrecthttpbasiccredentials exception assume http webdav host port url url url http test httptest http base url credentials default creds defaultcreds username password credentials usernamepasswordcredentials garbage garbage get http client gethttpclient get state getstate set credentials setcredentials auth scope authscope url get host gethost url get port getport auth scope authscope realm default creds defaultcreds string request url requesturl http test httptest http base url junk param http method httpmethod get method getmethod request url requesturl set request header setrequestheader ref erer referer request url requesturl set request header setrequestheader user agent mozilla sling int egration integration test status get http client gethttpclient execute method executemethod assert equals assertequals http servlet response httpservletresponse unauthorized status test test prevent loop incorrect form credentials testpreventloopincorrectformcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage string request url requesturl http test httptest http base url security check list header headers array list arraylist header headers add header ref erer referer request url requesturl headers add header user agent mozilla sling int egration integration test http method httpmethod post assert post status assertpoststatus request url requesturl http servlet response httpservletresponse forbidden params headers assert not null assertnotnull post get response header getresponseheader reason assert equals assertequals username password match post get response header getresponseheader reason get value getvalue test test requested with incorrect credentials testxrequestedwithincorrectcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage list header headers array list arraylist header headers add header requested xml http request xmlhttprequest headers add header user agent mozilla sling int egration integration test http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse forbidden params headers assert not null assertnotnull post get response header getresponseheader reason assert equals assertequals username password match post get response header getresponseheader reason get value getvalue test test without accept header incorrect credentials testwithoutacceptheaderincorrectcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse unauthorized params test test with non html accept header incorrect credentials testwithnonhtmlacceptheaderincorrectcredentials exception list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username garbage params add name value pair namevaluepair password garbage list header headers array list arraylist header headers add header user agent mozilla sling int egration integration test assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse moved temp orarily temporarily params headers todo move method commons testing http method httpmethod assert post status assertpoststatus string url expected status code expectedstatuscode list name value pair namevaluepair post params postparams list header headers string assert message assertmessage io exception ioexception post method postmethod post post method postmethod url post set follow redirects setfollowredirects headers header header headers post add request header addrequestheader header post params postparams name value pair namevaluepair nvp post set request body setrequestbody post params postparams to array toarray nvp status get http client gethttpclient execute method executemethod post assert message assertmessage assert equals assertequals expected status code expectedstatuscode status assert equals assertequals assert message assertmessage expected status code expectedstatuscode status post assertxreason http method httpmethod method io exception ioexception expected reason header header reason method get response header getresponseheader reason assert not null assertnotnull reason expect response reason sling assert equals assertequals reason get value getvalue method get response body as string getresponsebodyasstring trim
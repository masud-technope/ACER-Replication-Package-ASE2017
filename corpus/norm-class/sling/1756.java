licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling adapter internal org apache sling adapter adaption org apache sling adapter mock mock adapter factory mockadapterfactory org apache sling api adapter adapter factory adapterfactory org apache sling api adapter sling adaptable slingadaptable org hamcrest matcher org hamcrest core is any thing isanything org jmock expectations org jmock mockery org jmock int egration integration junit j mock jmock org jmock int egration integration junit j unit junit mockery org junit runner run with runwith org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework filter org osgi framework service listener servicelistener org osgi framework service reference servicereference org osgi service component component context componentcontext org osgi service package admin packageadmin exported package exportedpackage org osgi service package admin packageadmin package admin packageadmin java util dictionary java util map junit x junitx util private accessor privateaccessor org junit assert equals assertequals org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue run with runwith j mock jmock adapter manager test adaptermanagertest adapter manager impl adaptermanagerimpl mockery context j unit junit mockery org junit set up setup exception adapter manager impl adaptermanagerimpl package admin packageadmin context mock package admin packageadmin exported package exportedpackage context mock exported package exportedpackage context checking expectations allowing get exported package getexportedpackage string return value returnvalue private accessor privateaccessor set field setfield package admin packageadmin org junit tear down teardown correct argument unused deactivate helper method create mock bundle bundle create bundle createbundle string bundle bundle context mock bundle context checking expectations allowing bundle get bundle id getbundleid return value returnvalue bundle helper method create mock component context component context componentcontext create component context createcomponentcontext exception bundle context bundlecontext bundle ctx bundlectx context mock bundle context bundlecontext filter filter context mock filter component context componentcontext ctx context mock component context componentcontext context checking expectations allowing ctx locate service locateservice string service reference servicereference return value returnvalue mock adapter factory mockadapterfactory allowing ctx get bundle context getbundlecontext return value returnvalue bundle ctx bundlectx allowing bundle ctx bundlectx create filter createfilter string return value returnvalue filter allowing bundle ctx bundlectx add service listener addservicelistener service listener servicelistener string allowing bundle ctx bundlectx get service references getservicereferences string string return value returnvalue allowing bundle ctx bundlectx remove service listener removeservicelistener service listener servicelistener allowing bundle ctx bundlectx register service registerservice adaption get name getname adaption impl adaptionimpl instance dictionary return value returnvalue ctx helper method create mock component context component context componentcontext create multiple adapters component context createmultipleadapterscomponentcontext service reference servicereference first service reference firstservicereference service reference servicereference second service reference secondservicereference exception bundle context bundlecontext bundle ctx bundlectx context mock bundle context bundlecontext filter filter context mock filter component context componentcontext ctx context mock component context componentcontext context checking expectations allowing ctx locate service locateservice string first service reference firstservicereference return value returnvalue first implementation adapter factory firstimplementationadapterfactory allowing ctx locate service locateservice string second service reference secondservicereference return value returnvalue second implementation adapter factory secondimplementationadapterfactory allowing ctx get bundle context getbundlecontext return value returnvalue bundle ctx bundlectx allowing bundle ctx bundlectx create filter createfilter string return value returnvalue filter allowing bundle ctx bundlectx add service listener addservicelistener service listener servicelistener string allowing bundle ctx bundlectx get service references getservicereferences string string return value returnvalue allowing bundle ctx bundlectx remove service listener removeservicelistener service listener servicelistener allowing bundle ctx bundlectx register service registerservice adaption get name getname adaption impl adaptionimpl instance dictionary return value returnvalue ctx matcher suppress warnings suppresswarnings unused type is any thing isanything helper method create mock service reference service reference servicereference create service reference createservicereference service reference servicereference service reference impl servicereferenceimpl string test sling adaptable testslingadaptable get name getname string i test adapter itestadapter get name getname service reference impl servicereferenceimpl service reference servicereference ranking string adapters string classes service reference impl servicereferenceimpl order string adapters string classes ranking order adapters adapters classes classes is assignable to isassignableto bundle bundle string class name classname todo auto generated method stub bundle get using bundles getusingbundles todo auto generated method stub string get property keys getpropertykeys todo auto generated method stub object get property getproperty string key key equals constants service ranking ranking key equals adapter factory adapterfactory adaptable classes adapters key equals adapter factory adapterfactory adapter classes classes bundle get bundle getbundle todo auto generated method stub compare to compareto object reference integer ranking integer get property getproperty constants service ranking integer ranking integer service reference servicereference reference get property getproperty constants service ranking ranking compare to compareto ranking helper method create mock service reference service reference servicereference create service reference createservicereference service reference servicereference service reference impl servicereferenceimpl string test sling adaptable testslingadaptable get name getname string test adapter testadapter get name getname org junit test test unit ialized testunitialized assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert true asserttrue adapter factory descriptors adapterfactorydescriptors empty get factories getfactories is empty isempty assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty org junit test test initialized testinitialized exception activate create component context createcomponentcontext assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert true asserttrue adapter factory descriptors adapterfactorydescriptors empty get factories getfactories is empty isempty assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty org junit test test bind before activate testbindbeforeactivate exception service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory cache factories assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert true asserttrue adapter factory descriptors adapterfactorydescriptors empty get factories getfactories is empty isempty assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty activate create component context createcomponentcontext expect factory cache empty assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert equals assertequals adapter factory descriptors adapterfactorydescriptors entry get factories getfactories size assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty org junit test test bind after activate testbindafteractivate exception activate create component context createcomponentcontext cache factories assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert true asserttrue adapter factory descriptors adapterfactorydescriptors empty get factories getfactories is empty isempty assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory expect factory cache empty assert not null assertnotnull adapter factory descriptors adapterfactorydescriptors get factories getfactories assert equals assertequals adapter factory descriptors adapterfactorydescriptors entry get factories getfactories size assert true asserttrue adapter factory adapterfactory cache empty get factory cache getfactorycache is empty isempty map string adapter factory descriptor map adapterfactorydescriptormap get factories getfactories adapter factory descriptor map adapterfactorydescriptormap afdm test sling adaptable testslingadaptable get name getname assert not null assertnotnull afdm adapter factory descriptor adapterfactorydescriptor afd afdm assert not null assertnotnull afd assert not null assertnotnull afd get factory getfactory assert not null assertnotnull afd get adapters getadapters assert equals assertequals afd get adapters getadapters length assert equals assertequals i test adapter itestadapter get name getname afd get adapters getadapters assert null assertnull test sling adaptable testslingadaptable get name getname org junit test test adapt base testadaptbase exception activate create component context createcomponentcontext test sling adaptable testslingadaptable data test sling adaptable testslingadaptable assert null assertnull expect adapter get adapter getadapter data i test adapter itestadapter service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory object adapter get adapter getadapter data i test adapter itestadapter assert not null assertnotnull adapter assert true asserttrue adapter i test adapter itestadapter org junit test test adapt extended testadaptextended exception activate create component context createcomponentcontext test sling adaptable testslingadaptable data test sling adaptable testslingadaptable assert null assertnull expect adapter get adapter getadapter data i test adapter itestadapter service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory object adapter get adapter getadapter data i test adapter itestadapter assert not null assertnotnull adapter assert true asserttrue adapter i test adapter itestadapter org junit test test adapt base testadaptbase exception activate create component context createcomponentcontext test sling adaptable testslingadaptable data test sling adaptable testslingadaptable assert null assertnull expect adapter get adapter getadapter data i test adapter itestadapter service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory object adapter get adapter getadapter data i test adapter itestadapter assert not null assertnotnull adapter assert true asserttrue adapter i test adapter itestadapter org junit test test adapt extended testadaptextended exception activate create component context createcomponentcontext service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory service reference servicereference create service reference createservicereference bind adapter factory bindadapterfactory test sling adaptable testslingadaptable data test sling adaptable testslingadaptable object adapter get adapter getadapter data i test adapter itestadapter assert not null assertnotnull adapter assert true asserttrue adapter i test adapter itestadapter adapter get adapter getadapter data test adapter testadapter assert null assertnull adapter test sling adaptable testslingadaptable data test sling adaptable testslingadaptable adapter get adapter getadapter data i test adapter itestadapter assert not null assertnotnull adapter assert true asserttrue adapter i test adapter itestadapter adapter get adapter getadapter data test adapter testadapter assert not null assertnotnull adapter assert true asserttrue adapter test adapter testadapter org junit test test adapt multiple adapter factories testadaptmultipleadapterfactories exception service reference servicereference first adaptable firstadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname first implementation firstimplementation get name getname service reference servicereference second adaptable secondadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname second implementation secondimplementation get name getname activate create multiple adapters component context createmultipleadapterscomponentcontext first adaptable firstadaptable second adaptable secondadaptable adapter object adapterobject adapter object adapterobject impl assert null assertnull expect adapter get adapter getadapter parent interface parentinterface adapter object adapterobject adapter object adapterobject impl assert null assertnull expect adapter get adapter getadapter parent interface parentinterface bind adapter factory bindadapterfactory first adaptable firstadaptable bind adapter factory bindadapterfactory second adaptable secondadaptable object adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation adapter get adapter getadapter first implementation firstimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter second implementation secondimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation org junit test test adapt multiple adapter factories reverse order testadaptmultipleadapterfactoriesreverseorder exception service reference servicereference first adaptable firstadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname service reference servicereference second adaptable secondadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname activate create multiple adapters component context createmultipleadapterscomponentcontext first adaptable firstadaptable second adaptable secondadaptable adapter object adapterobject adapter object adapterobject impl assert null assertnull expect adapter get adapter getadapter parent interface parentinterface adapter object adapterobject adapter object adapterobject impl assert null assertnull expect adapter get adapter getadapter parent interface parentinterface bind adapter factory bindadapterfactory first adaptable firstadaptable bind adapter factory bindadapterfactory second adaptable secondadaptable object adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation org junit test test adapt multiple adapter factories service ranking testadaptmultipleadapterfactoriesserviceranking exception service reference servicereference first adaptable firstadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname first implementation firstimplementation get name getname service reference servicereference second adaptable secondadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname second implementation secondimplementation get name getname activate create multiple adapters component context createmultipleadapterscomponentcontext first adaptable firstadaptable second adaptable secondadaptable adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface bind adapter factory bindadapterfactory first adaptable firstadaptable bind adapter factory bindadapterfactory second adaptable secondadaptable object adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation parent interface parentinterface service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter first implementation firstimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter second implementation secondimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation org junit test test adapt multiple adapter factories service ranking second higher order testadaptmultipleadapterfactoriesservicerankingsecondhigherorder exception service reference servicereference first adaptable firstadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname first implementation firstimplementation get name getname service reference servicereference second adaptable secondadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname second implementation secondimplementation get name getname activate create multiple adapters component context createmultipleadapterscomponentcontext first adaptable firstadaptable second adaptable secondadaptable adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface bind adapter factory bindadapterfactory first adaptable firstadaptable bind adapter factory bindadapterfactory second adaptable secondadaptable object adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation parent interface parentinterface service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation adapter get adapter getadapter first implementation firstimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter second implementation secondimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation org junit test test adapt multiple adapter factories service ranking reverse testadaptmultipleadapterfactoriesservicerankingreverse exception service reference servicereference first adaptable firstadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname first implementation firstimplementation get name getname service reference servicereference second adaptable secondadaptable service reference impl servicereferenceimpl string adapter object adapterobject get name getname string parent interface parentinterface get name getname second implementation secondimplementation get name getname activate create multiple adapters component context createmultipleadapterscomponentcontext first adaptable firstadaptable second adaptable secondadaptable adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface adapter object adapterobject adapter object adapterobject indifferent assert null assertnull expect adapter get adapter getadapter parent interface parentinterface bind reverse order reverse test bind adapter factory bindadapterfactory second adaptable secondadaptable bind adapter factory bindadapterfactory first adaptable firstadaptable object adapter get adapter getadapter parent interface parentinterface assert not null assertnotnull adapter implementation parent interface parentinterface service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter first implementation firstimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter first implementation firstimplementation adapter get adapter getadapter second implementation secondimplementation assert not null assertnotnull adapter implementation service ranking adapter assert true asserttrue correct adaptable implementation service ranking adapter second implementation secondimplementation test sling adaptable testslingadaptable sling adaptable slingadaptable test sling adaptable testslingadaptable test sling adaptable testslingadaptable i test adapter itestadapter test adapter testadapter first implementation adapter factory firstimplementationadapterfactory adapter factory adapterfactory adapter type adaptertype adapter type adaptertype get adapter getadapter object adaptable adapter type adaptertype type adaptable adapter object adapterobject adapter object adapterobject adapter object adapterobject adapter object adapterobject adaptable adapter object adapterobject get what we want getwhatwewant impl indifferent adapter type adaptertype first implementation firstimplementation impl runtime exception runtimeexception pass correct adaptable second implementation adapter factory secondimplementationadapterfactory adapter factory adapterfactory adapter type adaptertype adapter type adaptertype get adapter getadapter object adaptable adapter type adaptertype type adaptable adapter object adapterobject adapter object adapterobject adapter object adapterobject adapter object adapterobject adaptable adapter object adapterobject get what we want getwhatwewant impl indifferent adapter type adaptertype second implementation secondimplementation impl runtime exception runtimeexception pass correct adaptable parent interface parentinterface first implementation firstimplementation parent interface parentinterface second implementation secondimplementation parent interface parentinterface enum def init ively definitively implementation adapter factory execute adapt impl def init ively definitively implementation adapter factory execute adapt impl ind iff erent indifferent factory execute adapt testing service ranking indifferent adapter object adapterobject what we want whatwewant adapter object adapterobject what we want whatwewant what we want whatwewant what we want whatwewant get what we want getwhatwewant what we want whatwewant
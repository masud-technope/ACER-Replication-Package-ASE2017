licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer provider jcr impl java util iterator java util list javax jcr repository exception repositoryexception javax jcr session javax jcr observation event javax jcr observation event iterator eventiterator javax jcr observation event listener eventlistener org slf logger org slf logger factory loggerfactory listen jcr events roots find watched folders watchedfolders created deleted root folder listener rootfolderlistener event listener eventlistener logger logger logger factory loggerfactory get logger getlogger get class getclass res can timer rescantimer timer string watched path watchedpath installer config installerconfig cfg string path with slash pathwithslash root folder listener rootfolderlistener session session string path res can timer rescantimer timer installer config installerconfig cfg repository exception repositoryexception timer timer watched path watchedpath path path with slash pathwithslash path cfg cfg event types eventtypes event node event node removed event property event property changed event property removed is deep isdeep no local nolocal session get workspace getworkspace get observation manager getobservationmanager add event listener addeventlistener event types eventtypes watched path watchedpath is deep isdeep no local nolocal logger info watching detect potential sub folders subfolders watched path watchedpath override string to string tostring get class getclass get simple name getsimplename watched path watchedpath cleanup session session repository exception repositoryexception session get workspace getworkspace get observation manager getobservationmanager remove event listener removeeventlistener schedule scan on event onevent event iterator eventiterator global scan node global scan globalscan copy watched folders remove roots list watched folder watchedfolder check folders checkfolders cfg clone watched folders clonewatchedfolders iterator watched folder watchedfolder check folders checkfolders iterator has next hasnext watched folder watchedfolder get path with slash getpathwithslash starts with startswith path with slash pathwithslash remove has next hasnext event next event nextevent logger debug event get type gettype event node get type gettype event node removed global scan globalscan string path get path getpath iterator watched folder watchedfolder check folders checkfolders iterator has next hasnext watched folder watchedfolder folder path starts with startswith folder get path with slash getpathwithslash folder mark for scan markforscan remove repository exception repositoryexception logger warn error path event global scan globalscan timer schedule scan schedulescan
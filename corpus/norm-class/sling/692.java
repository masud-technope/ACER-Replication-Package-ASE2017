licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer provider jcr impl java util array list arraylist java util collection java util dictionary java util iterator java util linked list linkedlist java util list javax jcr repository exception repositoryexception javax jcr session org apache sling commons osgi properties util propertiesutil org apache sling installer api installable resource installableresource org apache sling installer provider jcr impl jcr installer jcrinstaller node converter nodeconverter org apache sling settings sling settings service slingsettingsservice org osgi framework constants org osgi service component component context componentcontext org slf logger installer config installerconfig write enabled write back writeback node convert ers nodeconverters collection node converter nodeconverter convert ers converters array list arraylist node converter nodeconverter max watched folder depth maxwatchedfolderdepth filter folder names folder name filter foldernamefilter folder name filter foldernamefilter root folders watch string roots path configurations string new config path newconfigpath path pause installation pauseinstallation property string pause scan node path pausescannodepath list watched folders list watched folder watchedfolder watched folders watchedfolders linked list linkedlist watched folder watchedfolder logger logger installer config installerconfig logger logger component context componentcontext ctx dictionary cfg sling settings service slingsettingsservice settings logger logger write back writeback properties util propertiesutil to boolean toboolean get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller prop enable write back writeback jcr installer jcrinstaller enable write back writeback setup convert ers converters convert ers converters add file node converter filenodeconverter convert ers converters add config node converter confignodeconverter config urable configurable max depth system property bundle context overrides object obj get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller prop install folder max depth obj depending coming obj string int eger integer max watched folder depth maxwatchedfolderdepth integer value of valueof string value of valueof obj int value intvalue logger debug configured folder max depth jcr installer jcrinstaller prop install folder max depth max watched folder depth maxwatchedfolderdepth max watched folder depth maxwatchedfolderdepth jcr installer jcrinstaller folder max depth logger debug folder max depth max watched folder depth maxwatchedfolderdepth jcr installer jcrinstaller prop install folder max depth config urable configurable folder regexp system property overrides string folder name regexp foldernameregexp string get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller folder regexp property folder name regexp foldernameregexp folder name regexp foldernameregexp folder name regexp foldernameregexp trim logger debug configured folder regexp jcr installer jcrinstaller folder regexp property folder name regexp foldernameregexp folder name regexp foldernameregexp jcr installer jcrinstaller folder regexp logger debug folder regexp folder name regexp foldernameregexp jcr installer jcrinstaller folder regexp property setup folder filtering watching folder name filter foldernamefilter folder name filter foldernamefilter properties util propertiesutil to string array tostringarray get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller prop search path jcr installer jcrinstaller search path folder name regexp foldernameregexp settings get run modes getrunmodes roots folder name filter foldernamefilter get root paths getrootpaths setup path configurations string new cfg path newcfgpath properties util propertiesutil to string tostring get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller prop config path jcr installer jcrinstaller config path post slash postslash new cfg path newcfgpath ends with endswith post slash postslash new cfg path newcfgpath new cfg path newcfgpath concat pre slash preslash new cfg path newcfgpath starts with startswith pre slash preslash new cfg path newcfgpath folder name filter foldernamefilter get root paths getrootpaths new cfg path newcfgpath new config path newconfigpath new cfg path newcfgpath pause scan node path pausescannodepath properties util propertiesutil to string tostring get property value getpropertyvalue logger ctx cfg jcr installer jcrinstaller prop scan prop path jcr installer jcrinstaller pause scan node path property config component context bundle context object get property value getpropertyvalue logger logger component context componentcontext ctx dictionary old config oldconfig string object result old config oldconfig result old config oldconfig result logger warn configuration obsolete configuration pid property merge configuration configuration pid object jcr installer jcrinstaller pid ctx get properties getproperties constants service pid result result ctx get bundle context getbundlecontext get property getproperty result result ctx get properties getproperties result string get roots getroots roots folder name filter foldernamefilter get folder name filter getfoldernamefilter folder name filter foldernamefilter collection node converter nodeconverter get convert ers getconverters convert ers converters get max watched folder depth getmaxwatchedfolderdepth max watched folder depth maxwatchedfolderdepth string get pause scan node path getpausescannodepath pause scan node path pausescannodepath is write back iswriteback write back writeback string get new config path getnewconfigpath new config path newconfigpath list watched folder watchedfolder clone watched folders clonewatchedfolders watched folders watchedfolders array list arraylist watched folder watchedfolder watched folders watchedfolders scan watched folders watchedfolders install able installable resources list installable resource installableresource scan watched folders scanwatchedfolders repository exception repositoryexception list installable resource installableresource resources linked list linkedlist installable resource installableresource watched folders watchedfolders watched folder watchedfolder watched folders watchedfolders watched folder watchedfolder scan result scanresult scan logger debug startup resources to add toadd resources add all addall to add toadd resources check watched folder watchedfolder deleted list string check for removed watched folders checkforremovedwatchedfolders session session repository exception repositoryexception list string removed resources removedresources linked list linkedlist string watched folders watchedfolders iterator watched folder watchedfolder watched folders watchedfolders iterator has next hasnext watched folder watchedfolder logger debug item exists get path getpath session item exists itemexists get path getpath session item exists itemexists get path getpath logger info deleting path exist removed resources removedresources add all addall scan to remove toremove remove removed resources removedresources add watched folder watchedfolder list doesn exist add watched folder addwatchedfolder watched folder watchedfolder to add toadd watched folders watchedfolders watched folder watchedfolder existing watched folder watchedfolder watched folders watchedfolders get path getpath equals to add toadd get path getpath existing existing watched folders watchedfolders add to add toadd to add toadd start any watch folder needs scan anywatchfolderneedsscan watched folders watchedfolders watched folder watchedfolder watched folders watchedfolders needs scan needsscan
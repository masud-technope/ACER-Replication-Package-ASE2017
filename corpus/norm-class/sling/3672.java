licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest org junit assert false assertfalse org junit assert true asserttrue java i o exception ioexception java util hash map hashmap java util hash set hashset java util map java util org apache commons http client httpclient methods get method getmethod org apache sling commons testing int egration integration http test httptest org apache sling commons testing junit retry org apache sling commons testing junit retry rule retryrule org apache sling servlets post sling post constants slingpostconstants org junit org junit org junit rule org junit test test link script helper scripthelper include functionality jsp include test jspincludetest string node url a nodeurla string test text a testtexta string node url b nodeurlb string test text b testtextb string node url c nodeurlc string node url d nodeurld string node url e nodeurle string node url f nodeurlf string node url g nodeurlg string node url h nodeurlh string node url i nodeurli string for ced resource type forcedresourcetype string to delete todelete hash set hashset string http tests helper http test httptest http test httptest rule retry rule retryrule retry rule retryrule retry rule retryrule set up setup exception set up setup create test nodes path specific collisions string url http test httptest http base url get class getclass get simple name getsimplename system current time millis currenttimemillis sling post constants slingpostconstants create suffix map string string props hash map hashmap string string create test nodes store paths test text a testtexta text system current time millis currenttimemillis props text test text a testtexta node url a nodeurla get test client gettestclient create node createnode url props string path to include pathtoinclude node url a nodeurla substring http test httptest http base url length node stores path test script include rendering test text b testtextb text system current time millis currenttimemillis props text test text b testtextb props path to include pathtoinclude path to include pathtoinclude node url b nodeurlb get test client gettestclient create node createnode url props node extension include path props path to include pathtoinclude path to include pathtoinclude html node url e nodeurle get test client gettestclient create node createnode url props node max calls detection test props test max calls testmaxcalls node url f nodeurlf get test client gettestclient create node createnode url props node infinite loop detection test props remove path to include pathtoinclude props remove test max calls testmaxcalls props test infinite loop testinfiniteloop node url c nodeurlc get test client gettestclient create node createnode url props node force resource type test for ced resource type forcedresourcetype get class getclass get simple name getsimplename system current time millis currenttimemillis props remove test infinite loop testinfiniteloop props force resource type forceresourcetype for ced resource type forcedresourcetype props path to include pathtoinclude path to include pathtoinclude node url d nodeurld get test client gettestclient create node createnode url props node basic call test props remove force resource type forceresourcetype props remove path to include pathtoinclude props test call script testcallscript called test jsp node url g nodeurlg get test client gettestclient create node createnode url props node test props remove force resource type forceresourcetype props remove test call script testcallscript props test var include testvarinclude props path to include pathtoinclude path to include pathtoinclude props include node url i nodeurli get test client gettestclient create node createnode url props script for ced forced resource type set script path setscriptpath apps for ced resource type forcedresourcetype get test client gettestclient mkdirs http test httptest webdav base url get script path getscriptpath to delete todelete add upload test script uploadtestscript get script path getscriptpath include for ced forced jsp html jsp main rendering script apps repository set script path setscriptpath apps unstructured get test client gettestclient mkdirs http test httptest webdav base url get script path getscriptpath to delete todelete add upload test script uploadtestscript get script path getscriptpath include test jsp html jsp to delete todelete add upload test script uploadtestscript get script path getscriptpath called test jsp called test jsp node call test called script inherited supertype string node resource type nodehresourcetype get class getclass get simple name getsimplename system current time millis currenttimemillis string node super resource type nodehsuperresourcetype get class getclass get simple name getsimplename system current time millis currenttimemillis props sling resource type resourcetype node resource type nodehresourcetype props sling resource super type resourcesupertype node super resource type nodehsuperresourcetype node url h nodeurlh get test client gettestclient create node createnode url props set script path setscriptpath apps node resource type nodehresourcetype get test client gettestclient mkdirs http test httptest webdav base url get script path getscriptpath to delete todelete add upload test script uploadtestscript get script path getscriptpath calling test jsp html jsp set script path setscriptpath apps node super resource type nodehsuperresourcetype get test client gettestclient mkdirs http test httptest webdav base url get script path getscriptpath to delete todelete add upload test script uploadtestscript get script path getscriptpath called test jsp called test jsp tear down teardown exception tear down teardown string script to delete todelete get test client gettestclient delete script test retry test without include testwithoutinclude i o exception ioexception string content get content getcontent node url a nodeurla html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue content for matted formatted test text content main test text a testtexta assert false assertfalse included content including test retry test with include testwithinclude i o exception ioexception string content get content getcontent node url b nodeurlb html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue content for matted formatted test text content main test text b testtextb assert true asserttrue include content including assert true asserttrue text node included content content test text a testtexta test retry test with include and extension testwithincludeandextension i o exception ioexception string content get content getcontent node url e nodeurle html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue content for matted formatted test text content main test text b testtextb assert true asserttrue include content including assert true asserttrue text node included content content test text a testtexta test retry test infinite loop detection testinfiniteloopdetection i o exception ioexception node property infinite include loop sling problem response get method getmethod get method getmethod node url c nodeurlc html get http client gethttpclient execute method executemethod string content get response body as string getresponsebodyasstring assert true asserttrue response infinite loop error message content org apache sling api request recursion too deep exception recursiontoodeepexception todo sling status running tests maven build running tests separate instance started mvn jetty status get status code getstatuscode assert equals assertequals status infinite loop http servlet response httpservletresponse internal server error status test retry test max calls detection testmaxcallsdetection i o exception ioexception node property includes sling problem response get method getmethod get method getmethod node url f nodeurlf html get http client gethttpclient execute method executemethod string content get response body as string getresponsebodyasstring assert true asserttrue response infinite loop error message content org apache sling api request too many calls exception toomanycallsexception todo sling status running tests maven build running tests separate instance started mvn jetty status get status code getstatuscode assert equals assertequals status infinite loop http servlet response httpservletresponse internal server error status test retry test for ced resource type testforcedresourcetype i o exception ioexception string content get content getcontent node url d nodeurld html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue content for matted formatted test text content main test text b testtextb assert true asserttrue include content including assert true asserttrue text node included content content test text a testtexta assert true asserttrue resource type for ced forced content content for ced forced resource type for ced resource type forcedresourcetype test retry test call testcall i o exception ioexception string content get content getcontent node url g nodeurlg html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue content for matted formatted test text content main test text b testtextb assert true asserttrue call content calling assert true asserttrue call content called test retry test call to supertype testcalltosupertype i o exception ioexception string content get content getcontent node url h nodeurlh html http test httptest content type html assert true asserttrue content includes jsp marker content jsp template assert true asserttrue call content called test retry test var include testvarinclude i o exception ioexception string content get content getcontent node url i nodeurli html http test httptest content type html assert true asserttrue content includes loaded test content content loaded test content
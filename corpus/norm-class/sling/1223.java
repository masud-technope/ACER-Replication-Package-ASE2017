licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr content loader contentloader internal read ers readers java buffered input stream bufferedinputstream java closeable java file java i o exception ioexception java input stream inputstream java piped input stream pipedinputstream java piped output stream pipedoutputstream java net malformedurlexception java net url java text date format dateformat java text parse exception parseexception java text simple date format simpledateformat java util array list arraylist java util calendar java util hash map hashmap java util list java util map java util java util regex matcher java util regex pattern javax jcr property type propertytype javax jcr repository exception repositoryexception javax xml transform source javax xml transform templates javax xml transform transformer configuration exception transformerconfigurationexception javax xml transform transformer exception transformerexception javax xml transform transformer factory transformerfactory javax xml transform stream stream result streamresult javax xml transform stream stream source streamsource org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling jcr content loader contentloader content creator contentcreator org apache sling jcr content loader contentloader content reader contentreader org kxml k xml parser kxmlparser org slf logger org slf logger factory loggerfactory org xml pull xmlpull xml pull parser xmlpullparser org xml pull xmlpull xml pull parser exception xmlpullparserexception reader reads xml file defining content xml format format pre node node primary node type primarynodetype type primary node type primarynodetype mixin node types mixinnodetypes mixin node type mixinnodetype mixtype mixin node type mixinnodetype mixin node type mixinnodetype mixtype mixin node type mixinnodetype mixin g node types mixingnodetypes properties property prop name propname prop value propvalue values multi properties values type prop type proptype type property properties properties nodes child nodes node node nodes node pre include binary file loaded content link org apache sling jcr content loader contentloader internal read ers readers xml reader xmlreader file description filedescription code file code element component service properties property content reader contentreader property extensions xml property content reader contentreader property types application xml text xml xml reader xmlreader content reader contentreader node primary node type primarynodetype type primary node type primarynodetype mixin node types mixinnodetypes mixin node type mixinnodetype mixtype mixin node type mixinnodetype mixin node type mixinnodetype mixtype mixin node type mixinnodetype mixin node types mixinnodetypes properties property prop name propname prop value propvalue type prop type proptype type property properties node log logger logger logger factory loggerfactory get logger getlogger xml reader xmlreader string elem node node string elem primary node type primary node type primarynodetype string elem mixin node type mixin node type mixinnodetype string elem property property string elem string elem string elem values values string elem type type string xml stylesheet processing instruction xml stylesheet string href attribute href string elem file name space namespace http jcp org jcr string elem file file k xml parser kxmlparser xml parser xmlparser activate activate xml parser xmlparser k xml parser kxmlparser namespace aware xml parser xmlparser set feature setfeature xml pull parser xmlpullparser feature process names paces namespaces xml pull parser exception xmlpullparserexception runtime exception runtimeexception xml content access org apache sling jcr content loader contentloader content reader contentreader parse url org apache sling jcr content loader contentloader content creator contentcreator parse url url content creator contentcreator creator i o exception ioexception repository exception repositoryexception buffered input stream bufferedinputstream buf fered input bufferedinput buffer input reset stream encounter xsl stylesheet reference buf fered input bufferedinput buffered input stream bufferedinputstream url open stream openstream parse internal parseinternal buf fered input bufferedinput creator url xml pull parser exception xmlpullparserexception xppe i o exception ioexception i o exception ioexception xppe get message getmessage init cause initcause xppe close stream closestream buf fered input bufferedinput javadoc org apache sling jcr content loader contentloader content reader contentreader parse java input stream inputstream org apache sling jcr content loader contentloader content creator contentcreator parse input stream inputstream ins content creator contentcreator creator i o exception ioexception repository exception repositoryexception buffered input stream bufferedinputstream buf fered input bufferedinput buffer input reset stream encounter xsl stylesheet reference buf fered input bufferedinput buffered input stream bufferedinputstream ins url xml location xmllocation parse internal parseinternal buf fered input bufferedinput creator xml location xmllocation xml pull parser exception xmlpullparserexception xppe i o exception ioexception i o exception ioexception xppe get message getmessage init cause initcause xppe close stream closestream buf fered input bufferedinput parse internal parseinternal input stream inputstream buf fered input bufferedinput content creator contentcreator creator url xml location xmllocation xml pull parser exception xmlpullparserexception i o exception ioexception repository exception repositoryexception string builder stringbuilder content buffer contentbuffer string builder stringbuilder mark stream assume xsl processing instruction occur gulp sense processing instructions root element xml file buf fered input bufferedinput mark buf fered input bufferedinput parser input encoding force detection xml xml parser xmlparser set input setinput buf fered input bufferedinput node description nodedescription shared clear property description propertydescription shared clear file description filedescription shared clear node description nodedescription current node currentnode property description propertydescription current property currentproperty string current element currentelement event type eventtype xml parser xmlparser get event type geteventtype event type eventtype xml pull parser xmlpullparser document event type eventtype xml pull parser xmlpullparser processing instruction processing instruction processinginstruction processing instruction processinginstruction xml parser xmlparser get text gettext reference xsl stylesheet get name getname equals xml stylesheet processing instruction xml location xmllocation rewind input stream transformed xsl buf fered input bufferedinput reset pipe xml input xsl transformer xsl transformer stream xsltransformerstream transformer stream transformerstream xsl transformer stream xsltransformerstream buf fered input bufferedinput get attribute getattribute href attribute xml location xmllocation start transformer thread transformer stream transformerstream start transform starttransform xml parser transformed xml parse internal parseinternal transformer stream transformerstream creator xml location xmllocation transformer stream transformerstream close event type eventtype xml pull parser xmlpullparser start tag current element currentelement xml parser xmlparser get name getname elem property equals current element currentelement current node currentnode node description nodedescription create current node currentnode creator current property currentproperty property description propertydescription shared elem node equals current element currentelement current node currentnode node description nodedescription create current node currentnode creator current node currentnode node description nodedescription shared elem file equals current element currentelement elem file name space namespace equals xml parser xmlparser get name space getnamespace xml location xmllocation attribute count attributecount xml parser xmlparser get attribute count getattributecount attribute count attributecount attribute count attributecount i o exception ioexception file element attributes url mime type mimetype last modified lastmodified xml location xmllocation attribute map attributemap attributes attribute map attributemap get instance getinstance attributes set values setvalues xml parser xmlparser file description filedescription shared set base location setbaselocation xml location xmllocation file description filedescription shared set values setvalues attributes attributes clear parse exception parseexception i o exception ioexception ioe i o exception ioexception error parsing file description xml location xmllocation ioe init cause initcause ioe file description filedescription shared create creator file description filedescription shared clear logger warn file element encountered xml location isn skip ping skipping event type eventtype xml pull parser xmlpullparser tag string q name qname xml parser xmlparser get name getname string content content buffer contentbuffer to string tostring trim content buffer contentbuffer delete content buffer contentbuffer length elem property equals q name qname current property currentproperty property description propertydescription create current property currentproperty creator elem equals q name qname current property currentproperty current property currentproperty content current node currentnode current node currentnode content elem equals q name qname current property currentproperty i o exception ioexception xml file valid content xml unexpected elem element xml location xmllocation current property currentproperty add value addvalue content elem values equals q name qname current property currentproperty i o exception ioexception xml file valid content xml unexpected elem element xml location xmllocation current property currentproperty is multi value ismultivalue elem type equals q name qname current property currentproperty i o exception ioexception xml file valid content xml unexpected elem element xml location xmllocation current property currentproperty type content elem node equals q name qname current node currentnode node description nodedescription create current node currentnode creator creator finish node finishnode elem primary node type equals q name qname current node currentnode i o exception ioexception element allowed location q name qname xml location xmllocation current node currentnode primary node type primarynodetype content elem mixin node type equals q name qname current node currentnode i o exception ioexception element allowed location q name qname xml location xmllocation current node currentnode add mixin type addmixintype content event type eventtype xml pull parser xmlpullparser text event type eventtype xml pull parser xmlpullparser cdsect content buffer contentbuffer append xml parser xmlparser get text gettext event type eventtype xml parser xmlparser next token nexttoken takes xml input stream pipes xsl transformer callers call link start transform starttransform stream caller wait ind efinately indefinately input xsl transformer stream xsltransformerstream piped input stream pipedinputstream input stream inputstream input xml inputxml string xsl href xslhref thread transformer thread transformerthread piped output stream pipedoutputstream piped out pipedout url xml location xmllocation instantiate xsl transformer stream xsltransformerstream param input xml inputxml xml transformed param xsl href xslhref path xsl stylesheet param xml location xmllocation i o exception ioexception xsl transformer stream xsltransformerstream input stream inputstream input xml inputxml string xsl href xslhref url xml location xmllocation i o exception ioexception input xml inputxml input xml inputxml xsl href xslhref xsl href xslhref transformer thread transformerthread piped out pipedout piped output stream pipedoutputstream xml location xmllocation xml location xmllocation starts xsl transformer thread pipe output code piped input stream pipedinputstream code i o exception ioexception start transform starttransform i o exception ioexception url xsl resource xslresource url xml location xmllocation xsl href xslhref xsl resource xslresource i o exception ioexception find xsl href xslhref transformer thread transformerthread thread runnable source xml stream source streamsource input xml inputxml source xsl stream source streamsource xsl resource xslresource to external form toexternalform stream result streamresult stream result streamresult templates templates transformer factory transformerfactory new instance newinstance new templates newtemplates xsl stream result streamresult stream result streamresult piped out pipedout templates new transformer newtransformer transform xml stream result streamresult transformer configuration exception transformerconfigurationexception runtime exception runtimeexception error initial izing initializing xsl transformer transformer exception transformerexception runtime exception runtimeexception error transforming close stream closestream piped out pipedout xsl transformer thread xsltransformerthread transformer thread transformerthread start utility function close stream open param close able closeable stream close close stream closestream closeable close able closeable close able closeable close able closeable close i o exception ioexception ignore node description nodedescription node description nodedescription shared node description nodedescription string string primary node type primarynodetype list string mixin types mixintypes node description nodedescription create node description nodedescription desc content creator contentcreator creator repository exception repositoryexception desc creator create node createnode desc desc primary node type primarynodetype desc get mixin types getmixintypes desc clear add mixin type addmixintype string mixin types mixintypes mixin types mixintypes array list arraylist string mixin types mixintypes add string get mixin types getmixintypes mixin types mixintypes mixin types mixintypes size mixin types mixintypes to array toarray string mixin types mixintypes size clear primary node type primarynodetype mixin types mixintypes mixin types mixintypes clear property description propertydescription property description propertydescription shared property description propertydescription property description propertydescription create property description propertydescription desc content creator contentcreator creator repository exception repositoryexception type desc type property type propertytype string property type propertytype value from name valuefromname desc type desc is multi value ismultivalue creator create property createproperty desc type desc get property values getpropertyvalues string desc values desc values size desc values creator create property createproperty desc type desc clear string string type list string values is multi value ismultivalue add value addvalue string values values array list arraylist string values add string get property values getpropertyvalues values values size values to array toarray string values size clear type values values clear is multi value ismultivalue represents xml processing instruction processing instruction code xml stylesheet href stylesheet xsl type text css code code code code xml stylesheet code attributes code href code code type code processing instruction processinginstruction map string string attributes hash map hashmap string string pattern attribute pattern pattern compile pattern pattern pattern compile string processing instruction processinginstruction string text i o exception ioexception matcher name matcher namematcher pattern matcher text name matcher namematcher find i o exception ioexception malformed processing instruction text name matcher namematcher group matcher attribute matcher attributematcher attribute pattern matcher text attribute matcher attributematcher find attributes attribute matcher attributematcher group attribute matcher attributematcher group string get name getname string get attribute getattribute string key attributes key represents reference file loaded repository file referenced xml element named code file code attributes code src code code mime type mimetype code code last modified lastmodified code pre file src image png mime type mimetype image png last modified lastmodified pre format code last modified lastmodified code code yyyy ss z ssz code code last modified lastmodified code attribute optional missing modified reported file system filesystem file description filedescription url url string mime type mimetype url base location baselocation last modified lastmodified file description filedescription shared file description filedescription string src attribute src string mime type attribute mime type mimetype string modified attribute last modified lastmodified date format dateformat format simple date format simpledateformat yyyy ss z ssz format set len ient setlenient set values setvalues attribute map attributemap attributes malformedurlexception parse exception parseexception string attribute names attributenames attributes key set keyset string attribute names attributenames string attributes equals src attribute url url base location baselocation equals mime type attribute mime type mimetype equals modified attribute last modified lastmodified format parse get time gettime create content creator contentcreator creator repository exception repositoryexception i o exception ioexception string parts url get path getpath split string parts parts length input stream inputstream stream url open stream openstream last modified lastmodified last modified lastmodified file url touri last modified lastmodified throwable ignore last modified lastmodified calendar get instance getinstance get time in millis gettimeinmillis creator create file and resource node createfileandresourcenode stream mime type mimetype last modified lastmodified close stream closestream stream creator finish node finishnode creator finish node finishnode clear url get url geturl url string get mime type getmimetype mime type mimetype get last modified getlastmodified last modified lastmodified clear url mime type mimetype last modified lastmodified set base location setbaselocation url xml location xmllocation base location baselocation xml location xmllocation utility dealing attributes k xml parser kxmlparser attribute map attributemap hash map hashmap string string serialversionuid attribute map attributemap instance attribute map attributemap attribute map attributemap get instance getinstance instance puts values code attribute map attributemap code extra cting extracting attributes code xml parser xmlparser code param xml parser xmlparser code xml parser xmlparser code extract attributes parser link org xml pull xmlpull xml pull parser xmlpullparser start tag set values setvalues k xml parser kxmlparser xml parser xmlparser count xml parser xmlparser get attribute count getattributecount count xml parser xmlparser get attribute name getattributename xml parser xmlparser get attribute value getattributevalue
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery impl cluster java util dictionary java util hashtable org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations reference org apache sling api sling constants slingconstants org apache sling api resource resource resolver factory resourceresolverfactory org apache sling discovery impl config org apache sling discovery impl discovery service impl discoveryserviceimpl org apache sling settings sling settings service slingsettingsservice org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service registration serviceregistration org osgi service component component context componentcontext org osgi service event event org osgi service event event constants eventconstants org osgi service event event handler eventhandler org slf logger org slf logger factory loggerfactory osgi event handler takes not e note established view repository announcement changed instances component cluster view change listener clusterviewchangelistener event handler eventhandler logger logger logger factory loggerfactory get logger getlogger get class getclass reference sling settings service slingsettingsservice sling settings service slingsettingsservice reference resource resolver factory resourceresolverfactory resolver factory resolverfactory reference discovery service impl discoveryserviceimpl discovery service discoveryservice reference config config sling local instance string sling id slingid component context componentcontext context service registration serviceregistration event handler registration eventhandlerregistration activate activate component context componentcontext context sling id slingid sling settings service slingsettingsservice get sling id getslingid context context logger is debug enabled isdebugenabled logger debug activated sling id slingid sling id slingid discovery service discoveryservice discovery service discoveryservice register event handler registereventhandler register event handler registereventhandler bundle context bundlecontext bundle context bundlecontext context context get bundle context getbundlecontext bundle context bundlecontext logger info register event handler registereventhandler context bundle context bundlecontext register dictionary string object properties hashtable string object properties constants service description cluster view change listener string topics string sling constants slingconstants topic resource sling constants slingconstants topic resource changed sling constants slingconstants topic resource removed properties event constants eventconstants event topic topics string path config get discovery resource path getdiscoveryresourcepath path ends with endswith path path substring path length path path properties event constants eventconstants event filter path path event handler registration eventhandlerregistration bundle context bundlecontext register service registerservice event handler eventhandler get name getname properties logger info register event handler registereventhandler cluster view change handler clusterviewchangehandler registered event handler eventhandler deactivate deactivate event handler registration eventhandlerregistration event handler registration eventhandlerregistration unregister logger info deactivate cluster view change handler clusterviewchangehandler unregistered event handler eventhandler event handler registration eventhandlerregistration logger info deactivate deactivated sling id slingid sling id slingid handle osgi events repository not e note established view properties announcements change info rm inform discovery service impl discoveryserviceimpl cases handle event handleevent event event string resource path resourcepath string event get property getproperty path config string established view path establishedviewpath config get established view path getestablishedviewpath string cluster instances path clusterinstancespath config get cluster instances path getclusterinstancespath resource path resourcepath business event topics resource path resourcepath starts with startswith established view path establishedviewpath logger is debug enabled isdebugenabled logger debug handle event handleevent established view path establishedviewpath resource path resourcepath resource path resourcepath event event handle topology changed handletopologychanged resource path resourcepath starts with startswith cluster instances path clusterinstancespath object resource changed attributes resourcechangedattributes event get property getproperty resource changed attributes resourcechangedattributes resource changed attributes resourcechangedattributes resource changed attributes resourcechangedattributes string string resource changed attributes strings resourcechangedattributesstrings string resource changed attributes resourcechangedattributes resource changed attributes strings resourcechangedattributesstrings length resource changed attributes strings resourcechangedattributesstrings equals last heartbeat lastheartbeat ignore logger is debug enabled isdebugenabled logger debug handle event handleevent cluster instances path clusterinstancespath announcement properties resource path resourcepath resource path resourcepath event event handle topology changed handletopologychanged business info rm inform discovery service impl discoveryserviceimpl topology changed handle topology changed handletopologychanged logger info handle topology changed handletopologychanged detected change established views invoking check for topology change checkfortopologychange discovery service discoveryservice check for topology change checkfortopologychange
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling cassandra resource provider security org apache commons code c codec binary base prettyprint cassandra model cql query cqlquery prettyprint cassandra model cql rows cqlrows prettyprint cassandra serialize rs serializers string serializer stringserializer prettyprint hector api key space keyspace prettyprint hector api beans h column hcolumn prettyprint hector api beans row prettyprint hector api exceptions h invalid request exception hinvalidrequestexception prettyprint hector api query query result queryresult org apache sling cassandra resource provider cassandra resource provider cassandraresourceprovider org apache sling cassandra resource provider util cassandra resource provider util cassandraresourceproviderutil org apache sling commons json json object jsonobject org slf logger org slf logger factory loggerfactory java unsupported encoding exception unsupportedencodingexception java security message digest messagedigest java security no such algorithm exception nosuchalgorithmexception java util hash set hashset java util iterator java util map java util access control util accesscontrolutil logger logger logger factory loggerfactory get logger getlogger access control util accesscontrolutil string acl sling acl string ace separator read write delete string read read string write write string delete delete string system ace cassandra resource provider cassandraresourceprovider provider access control util accesscontrolutil cassandra resource provider cassandraresourceprovider provider provider provider access control util accesscontrolutil main string args exception access control util accesscontrolutil access control util accesscontrolutil access control util accesscontrolutil cassandra resource provider cassandraresourceprovider string path content cassandra string policy dishara read string hash set hashset string add dishara access control util accesscontrolutil addace path policy access control util accesscontrolutil build at level buildatlevel path system println grant system println deny exception print stack trace printstacktrace get privilege from e getprivilegefromace string ace integer decode ace split trim string get principle from e getprinciplefromace string ace ace split trim split ace separator trim isacegrant string ace equals ignore case equalsignorecase ace split trim split ace separator trim is user has principle isuserhasprinciple string principle string pri nciples principles pri nciples principles principle get current level bit maps getcurrentlevelbitmaps string user principles userprinciples string current path currentpath exception grants denies string acl array aclarray getacl current path currentpath acl array aclarray grants denies string ace acl array aclarray is user has principle isuserhasprinciple get principle from e getprinciplefromace ace user principles userprinciples to grant togrant to deny todeny isacegrant ace to grant togrant get privilege from e getprivilegefromace ace to deny todeny get privilege from e getprivilegefromace ace to grant togrant to grant togrant denies to deny todeny to deny todeny grants grants grants to grant togrant denies denies to deny todeny grants denies build at level buildatlevel string user principles userprinciples string path exception parent permission parentpermission permissions equals path parent permission parentpermission build at level buildatlevel user principles userprinciples cassandra resource provider util cassandraresourceproviderutil get parent path getparentpath path permissions get current level bit maps getcurrentlevelbitmaps user principles userprinciples path to grant togrant parent permission parentpermission permissions to deny todeny parent permission parentpermission permissions permissions permissions to grant togrant permissions permissions to deny todeny permissions addace string path string policy exception string rid get row d getrowid path create column family createcolumnfamily acl provider get key space getkeyspace string serializer stringserializer string getallaces select acl key rid query result queryresult cql rows cqlrows string string string cassandra resource provider util cassandraresourceproviderutil execute query executequery getallaces provider get key space getkeyspace string serializer stringserializer cassandra resource provider util cassandraresourceproviderutil record exists recordexists policy updateacl rid policy string serializer stringserializer addacl rid policy string serializer stringserializer string getacl string path exception get cassandra system node l getcassandrasystemnodeacl path get cassandra system node l getcassandrasystemnodeacl path string rid get row d getrowid path create column family createcolumnfamily acl provider get key space getkeyspace string serializer stringserializer string getallaces select acl key rid query result queryresult cql rows cqlrows string string string cassandra resource provider util cassandraresourceproviderutil execute query executequery getallaces provider get key space getkeyspace string serializer stringserializer string policy row string string string row cql rows cqlrows string string string get list getlist h column hcolumn column row get column slice getcolumnslice get columns getcolumns policy equals ignore case equalsignorecase column get name getname to string tostring column get value getvalue policy column get value getvalue to string tostring policy policy split string get cassandra system node l getcassandrasystemnodeacl string path content equals path content cassandra equals path equals path string system ace updateacl string rid string policy string serializer stringserializer query result queryresult cql rows cqlrows string string string string oldacl row string string string row cql rows cqlrows string string string get list getlist h column hcolumn column row get column slice getcolumnslice get columns getcolumns policy equals ignore case equalsignorecase column get name getname to string tostring column get value getvalue oldacl column get value getvalue to string tostring oldacl is empty isempty oldacl oldacl policy addacl rid oldacl string serializer stringserializer addacl string rid string policy string serializer stringserializer cql query cqlquery string string string cql query cqlquery cql query cqlquery string string string provider get key space getkeyspace string data rid policy string query insert acl key policy values data cql query cqlquery set query setquery query query result queryresult cql rows cqlrows string string string result cql query cqlquery execute system println acl string get row d getrowid string path no such algorithm exception nosuchalgorithmexception unsupported encoding exception unsupportedencodingexception message digest messagedigest message digest messagedigest get instance getinstance sha string rowid string base encode base encodebase digest cassandra resource provider util cassandraresourceproviderutil get remaining path getremainingpath path cassandra resource provider util cassandraresourceproviderutil get remaining path getremainingpath path get bytes getbytes utf test get bytes getbytes rowid create column family createcolumnfamily string key space keyspace keys pace keyspace string serializer stringserializer string createcf create column family columnfamily key var char varchar primary key policy var char varchar cql query cqlquery string string string cql query cqlquery cql query cqlquery string string string keys pace keyspace cql query cqlquery set query setquery createcf query result queryresult cql rows cqlrows string string string result cql query cqlquery execute logger info result get list getlist size finished h invalid request exception hinvalidrequestexception ignore logger debug column family exists ignore get message getmessage
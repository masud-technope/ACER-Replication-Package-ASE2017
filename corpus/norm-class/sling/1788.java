licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl engine extension java io exception ioexception java print writer printwriter java string writer stringwriter java util arrays java util hash map hashmap java util linked hash set linkedhashset java util map java util javax script bindings javax servlet request dispatcher requestdispatcher javax servlet servlet exception servletexception org apache commons lang string utils stringutils org apache felix scr annotations component org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling api sling http servlet request slinghttpservletrequest org apache sling api sling http servlet response slinghttpservletresponse org apache sling api request request dispatcher options requestdispatcheroptions org apache sling api resource non existing resource nonexistingresource org apache sling api resource resource org apache sling api resource resource util resourceutil org apache sling api resource synthetic resource syntheticresource org apache sling api scripting sling bindings slingbindings org apache sling scripting sightly sightly exception sightlyexception org apache sling scripting sightly extension runtime extension runtimeextension org apache sling scripting sightly impl plugin resource plugin resourceplugin org apache sling scripting sightly render render context rendercontext org slf logger org slf logger factory loggerfactory runtime support including resources sightly script code data sly resource details check implementation link org apache sling scripting sightly impl plugin resource plugin resourceplugin component service runtime extension runtimeextension properties property runtime extension runtimeextension resource plugin resourceplugin function suppress warnings suppresswarnings unused resource runtime extension resourceruntimeextension runtime extension runtimeextension logger log logger factory loggerfactory get logger getlogger resource runtime extension resourceruntimeextension string option resource type resource type resourcetype string option path path string option prepend path prepend path prependpath string option append path append path appendpath string option selectors selectors string option remove selectors remove selectors removeselectors string option add selectors add selectors addselectors string option replace selectors replace selectors replaceselectors override suppress warnings suppresswarnings unchecked object call render context rendercontext render context rendercontext object arguments extension utils extensionutils check argument count checkargumentcount resource plugin resourceplugin function arguments provide resource provideresource render context rendercontext arguments map string object arguments string provide resource provideresource render context rendercontext render context rendercontext object path obj pathobj map string object options map string object opts hash map hashmap string object options path info pathinfo path info pathinfo path info pathinfo coerce string coercestring path obj pathobj string path path info pathinfo path bindings bindings render context rendercontext get bindings getbindings string final path finalpath build path buildpath path opts resource bindings sling bindings slingbindings resource string resource type resourcetype coerce string coercestring get and remove option getandremoveoption opts option resource type map string string dispatcher options map dispatcheroptionsmap handle selectors handleselectors bindings path info pathinfo selectors opts string dispatcher options dispatcheroptions create dispatcher options createdispatcheroptions dispatcher options map dispatcheroptionsmap string writer stringwriter writer string writer stringwriter print writer printwriter print writer printwriter print writer printwriter writer include resource includeresource bindings print writer printwriter final path finalpath dispatcher options dispatcheroptions resource type resourcetype writer to string tostring map string string handle selectors handleselectors bindings bindings string selectors map string object options selectors is empty isempty sling http servlet request slinghttpservletrequest request sling http servlet request slinghttpservletrequest bindings sling bindings slingbindings request selectors add all addall arrays as list aslist request get request path info getrequestpathinfo get selectors getselectors map string string dispatcher options map dispatcheroptionsmap hash map hashmap string string dispatcher options map dispatcheroptionsmap option add selectors get selector string getselectorstring selectors dispatcher options map dispatcheroptionsmap option replace selectors options contains key containskey option selectors object selectors object selectorsobject get and remove option getandremoveoption options option selectors selectors clear selectors object selectorsobject string string selector string selectorstring string selectors object selectorsobject string parts selector string selectorstring split selectors add all addall arrays as list aslist parts selectors object selectorsobject object object object selectors object selectorsobject string selector coerce string coercestring string utils stringutils is not empty isnotempty selector selectors add selector dispatcher options map dispatcheroptionsmap option add selectors get selector string getselectorstring selectors dispatcher options map dispatcheroptionsmap option replace selectors options contains key containskey option add selectors object selectors object selectorsobject get and remove option getandremoveoption options option add selectors selectors object selectorsobject string string selector string selectorstring string selectors object selectorsobject string parts selector string selectorstring split string parts selectors add selectors object selectorsobject object object object selectors object selectorsobject string selector coerce string coercestring string utils stringutils is not empty isnotempty selector selectors add selector dispatcher options map dispatcheroptionsmap option add selectors get selector string getselectorstring selectors dispatcher options map dispatcheroptionsmap option replace selectors options contains key containskey option remove selectors object selectors object selectorsobject get and remove option getandremoveoption options option remove selectors selectors object selectorsobject string string selector string selectorstring string selectors object selectorsobject string parts selector string selectorstring split string parts selectors remove selectors object selectorsobject object object object selectors object selectorsobject string selector coerce string coercestring string utils stringutils is not empty isnotempty selector selectors remove selector selectors object selectorsobject selectors clear string selector string selectorstring get selector string getselectorstring selectors string utils stringutils is empty isempty selector string selectorstring dispatcher options map dispatcheroptionsmap option replace selectors dispatcher options map dispatcheroptionsmap option add selectors get selector string getselectorstring selectors dispatcher options map dispatcheroptionsmap option replace selectors dispatcher options map dispatcheroptionsmap string build path buildpath object path obj pathobj map string object options resource current resource currentresource string prepend path prependpath get option getoption option prepend path options string utils stringutils empty prepend path prependpath prepend path prependpath string utils stringutils empty string utils stringutils is not empty isnotempty prepend path prependpath prepend path prependpath starts with startswith prepend path prependpath prepend path prependpath prepend path prependpath ends with endswith prepend path prependpath string path coerce string coercestring path obj pathobj path get option getoption option path options string utils stringutils is not empty isnotempty path path string utils stringutils empty string append path appendpath get option getoption option append path options string utils stringutils empty append path appendpath append path appendpath string utils stringutils empty string utils stringutils is not empty isnotempty append path appendpath append path appendpath starts with startswith append path appendpath append path appendpath string final path finalpath prepend path prependpath path append path appendpath final path finalpath starts with startswith final path finalpath current resource currentresource get path getpath final path finalpath resource util resourceutil normalize final path finalpath string create dispatcher options createdispatcheroptions map string string options options options is empty isempty string builder stringbuilder buffer string builder stringbuilder has preceding haspreceding map entry string string option options entry set entryset has preceding haspreceding buffer append string key option get key getkey buffer append key append string str val strval option get value getvalue str val strval str val strval buffer append str val strval has preceding haspreceding buffer to string tostring string coerce string coercestring object obj obj string string obj string get option getoption map string object options string property string options property string get option getoption string option map string object options string default value defaultvalue options contains key containskey option string options option default value defaultvalue object get and remove option getandremoveoption map string object options string property options remove property include resource includeresource bindings bindings print writer printwriter string script string dispatcher options dispatcheroptions string resource type resourcetype string utils stringutils is empty isempty script log error script path empty sling http servlet response slinghttpservletresponse custom response customresponse print writer response wrapper printwriterresponsewrapper sling http servlet response slinghttpservletresponse bindings sling bindings slingbindings response sling http servlet request slinghttpservletrequest request sling http servlet request slinghttpservletrequest bindings sling bindings slingbindings request script normalize path normalizepath request script resource include res includeres request get resource resolver getresourceresolver resolve script include res includeres non existing resource nonexistingresource include res includeres is resource type isresourcetype resource resource type existing include res includeres synthetic resource syntheticresource request get resource resolver getresourceresolver script resource type resourcetype request dispatcher options requestdispatcheroptions opts request dispatcher options requestdispatcheroptions dispatcher options dispatcheroptions string utils stringutils is not empty isnotempty resource type resourcetype opts set force resource type setforceresourcetype resource type resourcetype request dispatcher requestdispatcher dispatcher request get request dispatcher getrequestdispatcher include res includeres opts dispatcher include request custom response customresponse servlet exception servletexception sightly exception sightlyexception failed include resource script io exception ioexception sightly exception sightlyexception failed include resource script string normalize path normalizepath sling http servlet request slinghttpservletrequest request string path path starts with startswith path request get resource getresource get path getpath path resource util resourceutil normalize path path info pathinfo string path string selectors path info pathinfo string path selectors get selectors from path getselectorsfrompath path selectors is empty isempty path path string selector string selectorstring get selector string getselectorstring selectors path path replace selector string selectorstring string get selectors from path getselectorsfrompath string path string selectors linked hash set linkedhashset string path string processing path processingpath path last slash pos lastslashpos path last index of lastindexof last slash pos lastslashpos processing path processingpath path substring last slash pos lastslashpos path length dot pos dotpos processing path processingpath index of indexof dot pos dotpos last dot pos lastdotpos processing path processingpath last index of lastindexof dot extension last dot pos lastdotpos dot pos dotpos string selector string selectorstring processing path processingpath substring dot pos dotpos last dot pos lastdotpos string selector parts selectorparts selector string selectorstring split selectors add all addall arrays as list aslist selector parts selectorparts selectors string get selector string getselectorstring string selectors string builder stringbuilder string builder stringbuilder string selectors append selectors size append to string tostring
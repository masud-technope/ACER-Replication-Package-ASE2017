licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr resource internal java byte array input stream bytearrayinputstream java input stream inputstream java math big decimal bigdecimal java util calendar java util java util iterator javax jcr node javax jcr property javax jcr repository exception repositoryexception javax jcr javax jcr value factory valuefactory org apache commons io utils ioutils org apache jackrabbit util iso org apache jackrabbit util text org apache sling api resource value map valuemap org apache sling commons testing jcr repository test base repositorytestbase org apache sling jcr resource jcr property map jcrpropertymap jcr property map test jcrpropertymaptest repository test base repositorytestbase string prop prop string prop nil prop nil string root path rootpath node root node rootnode override set up setup exception set up setup root path rootpath test system current time millis currenttimemillis root node rootnode get session getsession get root node getrootnode add node addnode root path rootpath substring unstructured session save override tear down teardown exception root node rootnode root node rootnode remove session save tear down teardown testjcrtype exception root node rootnode get session getsession refresh test value testvalue root node rootnode string test value testvalue root node rootnode calendar get instance getinstance test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode big decimal bigdecimal ten test type by class testtypebyclass exception root node rootnode get session getsession refresh test value testvalue root node rootnode string string test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode integer test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode big decimal bigdecimal calendar cal calendar get instance getinstance test value testvalue root node rootnode cal calendar test value testvalue root node rootnode cal test value testvalue root node rootnode cal test value testvalue root node rootnode big decimal bigdecimal ten big decimal bigdecimal test type by default value testtypebydefaultvalue exception root node rootnode get session getsession refresh test value testvalue root node rootnode string test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode test value testvalue root node rootnode big decimal bigdecimal test value testvalue root node rootnode big decimal bigdecimal ten test value testvalue root node rootnode big decimal bigdecimal ten test value testvalue root node rootnode big decimal bigdecimal ten big decimal bigdecimal ten ref time reftime ref date refdate ref time reftime calendar ref cal refcal calendar get instance getinstance ref cal refcal set time in millis settimeinmillis ref time reftime calendar cal calendar get instance getinstance test value testvalue root node rootnode cal ref cal refcal test value testvalue root node rootnode cal ref date refdate test value testvalue root node rootnode cal ref time reftime test value testvalue root node rootnode big decimal bigdecimal ten big decimal bigdecimal test default value testdefaultvalue exception root node rootnode get session getsession refresh test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode test default value testdefaultvalue root node rootnode big decimal bigdecimal ref time reftime ref date refdate ref time reftime calendar ref cal refcal calendar get instance getinstance ref cal refcal set time in millis settimeinmillis ref time reftime test default value testdefaultvalue root node rootnode ref cal refcal test default value testdefaultvalue root node rootnode ref date refdate test default value testdefaultvalue root node rootnode ref time reftime test default value testdefaultvalue root node rootnode big decimal bigdecimal ten test property testproperty exception root node rootnode get session getsession refresh value map valuemap map create property createproperty root node rootnode sample prop property prop root node rootnode get property getproperty prop explicit type property result map prop property assert true asserttrue prop is same issame result type property default value defaultvalue root node rootnode get property getproperty jcr primary type primarytype result map prop default value defaultvalue assert true asserttrue prop is same issame result result map prop nil default value defaultvalue assert same assertsame default value defaultvalue result test input stream testinputstream exception root node rootnode get session getsession refresh input stream inputstream instream byte array input stream bytearrayinputstream pass get bytes getbytes value factory valuefactory value factory valuefactory root node rootnode get session getsession get value factory getvaluefactory root node rootnode set property setproperty bin value factory valuefactory create binary createbinary instream root node rootnode get session getsession save value map valuemap map jcr property map jcrpropertymap root node rootnode instream map bin input stream inputstream assert not null assertnotnull instream string read io utils ioutils to string tostring instream assert equals assertequals stream read pass read instream map bin input stream inputstream assert not null assertnotnull instream read io utils ioutils to string tostring instream assert equals assertequals stream read time pass read internal test value testvalue node node object object default value defaultvalue repository exception repositoryexception value map valuemap map create property createproperty root node rootnode assert value type assertvaluetype map prop default value defaultvalue default value defaultvalue get class getclass test default value testdefaultvalue node node object default value defaultvalue jcr property map jcrpropertymap map create property map createpropertymap root node rootnode assert same assertsame default value defaultvalue map prop nil default value defaultvalue test value testvalue node node object type repository exception repositoryexception value map valuemap map create property createproperty root node rootnode assert value type assertvaluetype map prop type type assert value type assertvaluetype object object result type assert true asserttrue type is instance isinstance result result number assert equals assertequals number long value longvalue number result long value longvalue result number assert equals assertequals number double value doublevalue number result double value doublevalue big decimal bigdecimal result number assert equals assertequals big decimal bigdecimal double value doublevalue number result double value doublevalue calendar result time resulttime result result time resulttime result get time gettime result calendar result time resulttime calendar result get time in millis gettimeinmillis result number result time resulttime number result long value longvalue fail unexpected result type calendar type assert equals assertequals calendar get time in millis gettimeinmillis result time resulttime assert equals assertequals result jcr property map jcrpropertymap create property map createpropertymap node node jcr property map jcrpropertymap node test value testvalue node node object repository exception repositoryexception value map valuemap map create property createproperty node assert equals assertequals map prop value map valuemap create property createproperty node node object repository exception repositoryexception node has property hasproperty prop node get property getproperty prop remove jcr value jcrvalue value factory valuefactory fac session get value factory getvaluefactory string jcr value jcrvalue fac create value createvalue string calendar jcr value jcrvalue fac create value createvalue calendar calendar cal calendar get instance getinstance cal set time settime jcr value jcrvalue fac create value createvalue cal jcr value jcrvalue fac create value createvalue boolean value booleanvalue jcr value jcrvalue fac create value createvalue double value doublevalue jcr value jcrvalue fac create value createvalue long value longvalue big decimal bigdecimal jcr value jcrvalue fac create value createvalue big decimal bigdecimal fail create jcr node set property setproperty prop jcr value jcrvalue node get session getsession save create property map createpropertymap node string test path string string string string title string prop prop string prop prop string prop jcr title string prop prop test names testnames exception root node rootnode get session getsession refresh root node rootnode set property setproperty text escape illegal jcr chars escapeillegaljcrchars test path root node rootnode set property setproperty prop root node rootnode set property setproperty prop root node rootnode set property setproperty prop value map valuemap create property map createpropertymap root node rootnode assert equals assertequals test path assert equals assertequals prop assert equals assertequals prop assert equals assertequals prop prop test colon testcolon exception root node rootnode get session getsession refresh value map valuemap create property map createpropertymap root node rootnode assert null assertnull prop assert null assertnull prop assert null assertnull jcr title assert null assertnull unknown prefix test ierators testierators exception root node rootnode get session getsession refresh root node rootnode set property setproperty text escape illegal jcr chars escapeillegaljcrchars test path root node rootnode set property setproperty prop root node rootnode set property setproperty prop value map valuemap create property map createpropertymap root node rootnode assert true asserttrue contains key containskey test path search key set keyset iterator test path search key set keyset iterator prop search key set keyset iterator prop search values iterator search values iterator search values iterator test contains key empty testcontainskeyempty jcr property map jcrpropertymap map create property map createpropertymap root node rootnode assert false assertfalse map contains key containskey assert null assertnull map test names old testnamesold exception root node rootnode get session getsession refresh root node rootnode set property setproperty iso encode path encodepath test path value map valuemap create property map createpropertymap root node rootnode assert equals assertequals test path test ierators old testieratorsold exception root node rootnode get session getsession refresh root node rootnode set property setproperty iso encode path encodepath test path value map valuemap create property map createpropertymap root node rootnode assert true asserttrue contains key containskey test path search key set keyset iterator test path search values iterator test dot slash testdotslash exception root node rootnode get session getsession refresh string prop my prop myprop string root node rootnode set property setproperty prop value map valuemap create property map createpropertymap root node rootnode assert equals assertequals prop assert equals assertequals prop assert true asserttrue contains key containskey prop search iterator object has next hasnext object current current equals fail iterator
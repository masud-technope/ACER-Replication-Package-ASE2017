licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr jackrabbit access manager accessmanager post java io exception ioexception java util array list arraylist java util list javax jcr repository exception repositoryexception javax jcr session javax jcr security access control list accesscontrollist javax jcr security access control manager accesscontrolmanager javax jcr security access control policy accesscontrolpolicy javax jcr security access control policy iterator accesscontrolpolicyiterator javax servlet servlet exception servletexception javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache sling api sling http servlet request slinghttpservletrequest org apache sling api sling http servlet response slinghttpservletresponse org apache sling api resource resource not found exception resourcenotfoundexception org apache sling api resource resource util resourceutil org apache sling servlets post html response htmlresponse org apache sling api servlets sling all methods servlet slingallmethodsservlet org apache sling api wrappers sling request paths slingrequestpaths org apache sling servlets post abstract post response abstractpostresponse org apache sling servlets post modification org apache sling servlets post sling post constants slingpostconstants org apache sling servlets post json response jsonresponse org slf logger org slf logger factory loggerfactory base post servlets access manager accessmanager operations abstract access post servlet abstractaccesspostservlet sling all methods servlet slingallmethodsservlet serialversionuid log logger log logger factory loggerfactory get logger getlogger get class getclass javadoc org apache sling api servlets sling all methods servlet slingallmethodsservlet do post dopost org apache sling api sling http servlet request slinghttpservletrequest org apache sling api sling http servlet response slinghttpservletresponse override do post dopost sling http servlet request slinghttpservletrequest request sling http servlet response slinghttpservletresponse http response httpresponse servlet exception servletexception io exception ioexception prepare response abstract post response abstractpostresponse response create html response createhtmlresponse request response set ref erer setreferer request get header getheader ref erer referer calculate paths string path get item path getitempath request response set path setpath path location response set location setlocation ext ernalize path externalizepath request path parent location path resource util resourceutil get parent getparent path path response set parent location setparentlocation ext ernalize path externalizepath request path session session request get resource resolver getresourceresolver adapt to adaptto session list modification array list arraylist modification handle operation handleoperation request response html response modification change change get type gettype modify response on modified onmodified change get source getsource delete response on deleted ondeleted change get source getsource move response on moved onmoved change get source getsource change get destination getdestination copy response on copied oncopied change get source getsource change get destination getdestination create response on created oncreated change get source getsource order response on change onchange ordered change get source getsource change get destination getdestination session has pending changes haspendingchanges session save resource not found exception resourcenotfoundexception rnfe response set status setstatus http servlet response httpservletresponse rnfe get message getmessage throwable throwable log debug exception handling post request get resource getresource get path getpath get class getclass get name getname throwable response set error seterror throwable session has pending changes haspendingchanges session refresh repository exception repositoryexception log warn repository exception repositoryexception block get message getmessage check redirect url processing succeeded response is successful issuccessful string redirect get redirect url getredirecturl request response redirect http response httpresponse send redirect sendredirect redirect create html response send unsuccessful redirect response send http response httpresponse is set status issetstatus request creates instance html response htmlresponse param req request service d serviced link org apache sling servlets post impl helper json response jsonresponse conditions response content type application json link org apache sling api servlets html response htmlresponse abstract post response abstractpostresponse create html response createhtmlresponse sling http servlet request slinghttpservletrequest req json response jsonresponse response content type equals req get response content type getresponsecontenttype json response jsonresponse html response htmlresponse ext ending extending servlet implement operation work param request sling http request process param response response param handle operation handleoperation sling http servlet request slinghttpservletrequest request abstract post response abstractpostresponse response list modification repository exception repositoryexception compute redirect url sling param ctx post processor redirect location code code string get redirect url getredirecturl http servlet request httpservletrequest request abstract post response abstractpostresponse ctx redirect param priority magic star string result request get parameter getparameter sling post constants slingpostconstants redirect result ctx get path getpath redirect created modified resource star result index of indexof star string buffer stringbuffer buf string buffer stringbuffer star star buf append result substring star append manipulated node buf append resource util resourceutil get name getname ctx get path getpath star star result length buf append result substring star created path redirect result result buf to string tostring result ends with endswith sling post constants slingpostconstants create suffix redirect trailing slash append modified node result result concat resource util resourceutil get name getname ctx get path getpath log is debug enabled isdebugenabled log debug redirect result result is set status issetstatus sling http servlet request slinghttpservletrequest request string status param statusparam request get parameter getparameter sling post constants slingpostconstants status status param statusparam log debug get status mode getstatusmode parameter assuming standard status code sling post constants slingpostconstants status sling post constants slingpostconstants status browser equals status param statusparam log debug get status mode getstatusmode parameter asks user friendly status code sling post constants slingpostconstants status sling post constants slingpostconstants status standard equals status param statusparam log debug get status mode getstatusmode parameter asks standard status code sling post constants slingpostconstants status log debug get status mode getstatusmode parameter unknown assuming standard status code sling post constants slingpostconstants status methods copied abstract sling post operation abstractslingpostoperation returns path resource request item path method overwritten extension operation requirements path processing string get item path getitempath sling http servlet request slinghttpservletrequest request request get resource getresource get path getpath returns external form path prepending context path app ending appending display extension param path path ext ernalize externalize url string ext ernalize path externalizepath sling http servlet request slinghttpservletrequest request string path string buffer stringbuffer ret string buffer stringbuffer ret append sling request paths slingrequestpaths get context path getcontextpath request ret append request get resource resolver getresourceresolver map path append optional extension string ext request get parameter getparameter sling post constants slingpostconstants display extension ext ext length ext char at charat ret append ret append ext ret to string tostring returns code access control list accesscontrollist code edit node code resource path resourcepath code param access control manager accesscontrolmanager manager providing access control lists param resource path resourcepath node path access control list param may create maycreate code code access control list created node code access control list accesscontrollist code modify control access node repository exception repositoryexception access control manager provide code access control policy accesscontrolpolicy code code access control list accesscontrollist code access control list accesscontrollist get access control list getaccesscontrollist access control manager accesscontrolmanager access control manager accesscontrolmanager string resource path resourcepath may create maycreate repository exception repositoryexception check existing access control list edit access control policy accesscontrolpolicy policies access control manager accesscontrolmanager get policies getpolicies resource path resourcepath access control policy accesscontrolpolicy policy policies policy access control list accesscontrollist access control list accesscontrollist policy existing access control list create allowed may create maycreate access control policy iterator accesscontrolpolicyiterator applicable policies applicablepolicies access control manager accesscontrolmanager get applicable policies getapplicablepolicies resource path resourcepath applicable policies applicablepolicies has next hasnext access control policy accesscontrolpolicy policy applicable policies applicablepolicies next access control policy nextaccesscontrolpolicy policy access control list accesscontrollist access control list accesscontrollist policy existing create access control list accesscontrollist fail repository exception repositoryexception unable find create access control policy update resource path resourcepath
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling osgi obr java file java file input stream fileinputstream java file output stream fileoutputstream java i o exception ioexception java input stream inputstream java output stream outputstream java net malformedurlexception java net url java text date format dateformat java text simple date format simpledateformat java util array list arraylist java util collections java util comparator java util java util iterator java util list java util map java util properties java util java util sorted map sortedmap java util sorted set sortedset java util tree map treemap java util tree set treeset java util jar jar entry jarentry java util jar jar input stream jarinputstream java util jar jar output stream jaroutputstream java util jar manifest java util zip def later deflater org apache commons i o utils ioutils org osgi framework version code repository code represents collection bundles repository initialized location bundle store accessed access ors accessors author fmeschbe version rev feb repository pseudo bundle category bundles belong definition bundles string category bundles bundles pseudo bundle category bundles belong code bundle category code header bundle man ifast manifast string category string repo properties repository properties string prop repo org apache sling osgi obr string prop prefix bundle org apache sling osgi obr bundle date format dateformat repo format simple date format simpledateformat yyyymmddhhmmss sss date format dateformat format simple date format simpledateformat yyyymmddhhmmss file repo location repolocation file repo properties file repopropertiesfile repo last modified repolastmodified string repo name reponame sorted bundle uri s uris sorted set sortedset bundles reload req uird requird ensure loaded ensureloaded need reload needreload map resource sets indexed category sorted map sortedmap resources by category resourcesbycategory list resources list resources map resources indexed file sorted map sortedmap resources by file name resourcesbyfilename repository string default repo name defaultreponame file repo location repolocation i o exception ioexception repo name reponame default repo name defaultreponame default repo name defaultreponame untitled repo location repolocation repo location repolocation repo properties file repopropertiesfile file repo location repolocation repo properties load properties loadproperties need reload needreload string get name getname repo name reponame get last modified getlastmodified repo last modified repolastmodified string get last modified for matted getlastmodifiedformatted repo format repo format format get last modified getlastmodified add resource addresource input stream inputstream bundle stream bundlestream i o exception ioexception file bundle spool bundle invalid bundle spool modified spoolmodified bundle stream bundlestream check bundle read manifest problems returns resource create bundle bundles add bundle touri to string tostring need reload needreload save properties saveproperties i o exception ioexception ioe bundle bundle delete ioe resource get resource getresource string bundle name bundlename ensure loaded ensureloaded bundle name bundlename resource file resource res resource resources by file name resourcesbyfilename bundle name bundlename assume bundle symbolic res iterator get resources by id getresourcesbyid has next hasnext resource test res testres resource bundle name bundlename equals test res testres get symbolic name getsymbolicname res test res testres get version getversion compare to compareto res get version getversion res test res testres match res iterator get resources by id getresourcesbyid ensure loaded ensureloaded resources iterator iterator get resources by category getresourcesbycategory string category name categoryname ensure loaded ensureloaded resources resources by category resourcesbycategory category name categoryname resources resources iterator collections empty iterator remove resource removeresource string bundle name bundlename i o exception ioexception need reload needreload file bundle file bundlefile file repo location repolocation bundle name bundlename bundles remove bundle file bundlefile touri to string tostring bundle file bundlefile delete save properties saveproperties returns sorted list categories bundles stored repository belong list special category link category bundles param comparator code comparator code sort bundle list code code natural ordering sorted list bundle categories bundles list get bundle categories getbundlecategories comparator comparator ensure loaded ensureloaded list list array list arraylist resources by category resourcesbycategory key set keyset comparator collections sort list comparator list ensure loaded ensureloaded need reload needreload load resources resources array list arraylist resources by file name resourcesbyfilename tree map treemap resources by category resourcesbycategory tree map treemap iterator bundles iterator has next hasnext string mapping string url bundle url mapping resource res resource create bundle res set id setid string value of valueof resources add res resources by file name resourcesbyfilename res get resource name getresourcename res register resource by category registerresourcebycategory category bundles res res get categories getcategories is empty isempty register resource by category registerresourcebycategory category res iterator res get categories getcategories iterator has next hasnext register resource by category registerresourcebycategory res malformedurlexception mue i o exception ioexception ioe prevent rel oads reloads change need reload needreload register resource by category registerresourcebycategory object category resource res sorted set sortedset resources sorted set sortedset resources by category resourcesbycategory category resources resources tree set treeset resources by category resourcesbycategory category resources resources add res load properties loadproperties i o exception ioexception properties props properties repo properties file repopropertiesfile exists input stream inputstream ins ins file input stream fileinputstream repo properties file repopropertiesfile props load ins ins ins close i o exception ioexception ioe repo last modified repolastmodified repo properties file repopropertiesfile last modified lastmodified tree set treeset bundles tree set treeset iterator props entry set entryset iterator has next hasnext map entry entry map entry string key string entry get key getkey key starts with startswith prop prefix bundle bundles add entry get value getvalue bundles bundles string repo name reponame props get property getproperty prop repo repo name reponame save properties repository save properties saveproperties configured repository repo name reponame repo name reponame save properties saveproperties i o exception ioexception prepare properties write properties props properties props set property setproperty prop repo repo name reponame iterator bundles iterator has next hasnext props set property setproperty prop prefix bundle string write properties output stream outputstream file output stream fileoutputstream repo properties file repopropertiesfile props store close i o exception ioexception ioe update modified repo last modified repolastmodified repo properties file repopropertiesfile last modified lastmodified spool input stream inputstream ins output stream outputstream i o exception ioexception buf ins read buf write buf file spool modified spoolmodified input stream inputstream ins i o exception ioexception jar input stream jarinputstream jis jar input stream jarinputstream ins handle manifest jar output stream jaroutputstream jos manifest manifest jis get manifest getmanifest manifest i o exception ioexception missing manifest string symbolic name symbolicname manifest get main attributes getmainattributes get value getvalue bundle symbolic name symbolicname symbolic name symbolicname symbolic name symbolicname length i o exception ioexception missing symbolic manifest string version manifest get main attributes getmainattributes get value getvalue bundle version version version parse version parseversion version get qualifier getqualifier index of indexof snapshot string t stamp tstamp format t stamp tstamp format format version get major getmajor get minor getminor get micro getmicro get qualifier getqualifier replace all replaceall snapshot t stamp tstamp manifest get main attributes getmainattributes put value putvalue bundle version version file bundle file repo location repolocation symbolic name symbolicname jar output stream outputstream file output stream fileoutputstream bundle jos jar output stream jaroutputstream manifest jos set method setmethod jar output stream jaroutputstream deflated jos set level setlevel def later deflater compression jar entry jarentry entry in entryin jis get next jar entry getnextjarentry entry in entryin jar entry jarentry entry out entryout jar entry jarentry entry in entryin get name getname entry out entryout set time settime entry in entryin get time gettime entry out entryout set comment setcomment entry in entryin get comment getcomment jos put next entry putnextentry entry out entryout entry in entryin is directory isdirectory spool jis jos jos close entry closeentry jis close entry closeentry entry in entryin jis get next jar entry getnextjarentry close jar file force writing jos close i o utils ioutils close quietly closequietly bundle
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling service user mapping serviceusermapping impl java util array list arraylist java util arrays java util collection java util collections java util dictionary java util hash map hashmap java util hashtable java util list java util map java util sorted map sortedmap java util sorted set sortedset java util tree map treemap java util tree set treeset java util concurrent copy on write array list copyonwritearraylist java util concurrent executor service executorservice java util concurrent executors org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations modified org apache felix scr annotations property org apache felix scr annotations property unbounded propertyunbounded org apache felix scr annotations reference org apache felix scr annotations reference cardinality referencecardinality org apache felix scr annotations reference policy referencepolicy org apache felix scr annotations references org apache felix scr annotations service org apache sling commons osgi properties util propertiesutil org apache sling service user mapping serviceusermapping service user mapped serviceusermapped org apache sling service user mapping serviceusermapping service user mapper serviceusermapper org apache sling service user mapping serviceusermapping service user validator serviceuservalidator org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service registration serviceregistration org slf logger org slf logger factory loggerfactory component metatype label apache sling service user mapper service description configuration service mapping service names names users service service user mapper serviceusermapper service user mapper impl serviceusermapperimpl references reference amendment reference interface referenceinterface mapping config amendment mappingconfigamendment cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic updated update amendment updateamendment reference service user validator serviceuservalidator reference interface referenceinterface service user validator serviceuservalidator bind bind service user validator bindserviceuservalidator unbind unbind service user validator unbindserviceuservalidator cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic service user mapper impl serviceusermapperimpl service user mapper serviceusermapper property label service mappings description mappings service user names entry form bundle id bundleid sub service name subservicename user name username bundle id bundleid sub service name subservicename identify service user name username defines user provide service invalid entries log ged logged unbounded property unbounded propertyunbounded array string prop service user mapping user mapping string prop service user mapping string prop user user property prop user label user description user service mapping applies property missing empty user defined string prop user log logger log logger factory loggerfactory get logger getlogger get class getclass mapping global service user mappings globalserviceusermappings mapping string default user defaultuser map mapping config amendment mappingconfigamendment amendments hash map hashmap mapping config amendment mappingconfigamendment mapping active mappings activemappings mapping list service user validator serviceuservalidator valid ators validators copy on write array list copyonwritearraylist service user validator serviceuservalidator sorted map sortedmap mapping registration active registrations activeregistrations tree map treemap mapping registration bundle context bundlecontext bundle context bundlecontext executor service executorservice executor service executorservice register async registerasync activate modified configure bundle context bundlecontext bundle context bundlecontext map string object config register async registerasync executor service executorservice executor service executorservice executors new single thread executor newsinglethreadexecutor string props properties util propertiesutil to string array tostringarray config prop service user mapping prop service user mapping array list arraylist mapping mappings array list arraylist mapping props length string prop props prop prop trim length mapping mapping mapping prop trim mappings add mapping illegal argument exception illegalargumentexception iae log error configure ignoring prop iae get message getmessage global service user mappings globalserviceusermappings mappings to array toarray mapping mappings size default user defaultuser properties util propertiesutil to string tostring config prop user prop user registration set registrationset registration set registrationset bundle context bundlecontext bundle context bundlecontext registration set registrationset update mappings updatemappings execute service registrations async executeserviceregistrationsasync registration set registrationset deactivate deactivate registration set registrationset registration set registrationset update service registrations updateserviceregistrations mapping bundle context bundlecontext execute service registrations async executeserviceregistrationsasync registration set registrationset executor service executorservice executor service executorservice shutdown executor service executorservice restart all active service user mapped services restartallactiveserviceusermappedservices registration set registrationset registration set registrationset registration set registrationset registration set registrationset removed active registrations activeregistrations values registration set registrationset active registrations activeregistrations values execute service registrations async executeserviceregistrationsasync registration set registrationset bind service user validator serviceuservalidator param service user validator serviceuservalidator bind service user validator bindserviceuservalidator service user validator serviceuservalidator service user validator serviceuservalidator valid ators validators add service user validator serviceuservalidator restart all active service user mapped services restartallactiveserviceusermappedservices unbind service user validator serviceuservalidator param service user validator serviceuservalidator unbind service user validator unbindserviceuservalidator service user validator serviceuservalidator service user validator serviceuservalidator valid ators validators remove service user validator serviceuservalidator restart all active service user mapped services restartallactiveserviceusermappedservices org apache sling service user mapping serviceusermapping service user mapper serviceusermapper get service user d getserviceuserid org osgi framework bundle java lang string override string get service user d getserviceuserid bundle bundle string sub service name subservicename string service name servicename get service name getservicename bundle string user id userid internal get user id internalgetuserid service name servicename sub service name subservicename is valid user isvaliduser user id userid service name servicename sub service name subservicename user id userid bind amendment bindamendment mapping config amendment mappingconfigamendment amendment map string object props key props constants service registration set registrationset registration set registrationset amendments key amendment registration set registrationset update mappings updatemappings execute service registrations async executeserviceregistrationsasync registration set registrationset unbind amendment unbindamendment mapping config amendment mappingconfigamendment amendment map string object props key props constants service registration set registrationset registration set registrationset amendments remove key registration set registrationset update mappings updatemappings execute service registrations async executeserviceregistrationsasync registration set registrationset update amendment updateamendment mapping config amendment mappingconfigamendment amendment map string object props bind amendment bindamendment amendment props registration set registrationset update mappings updatemappings list mapping config amendment mappingconfigamendment sorted mappings sortedmappings array list arraylist mapping config amendment mappingconfigamendment mapping config amendment mappingconfigamendment amendment amendments values sorted mappings sortedmappings add amendment collections sort sorted mappings sortedmappings list mapping mappings array list arraylist mapping mapping global service user mappings globalserviceusermappings mappings add mapping config amendment mappingconfigamendment mca sorted mappings sortedmappings mapping mca get service user mappings getserviceusermappings mappings add active mappings activemappings mappings to array toarray mapping mappings size registration set registrationset registration set registrationset update service registrations updateserviceregistrations active mappings activemappings registration set registrationset registration set registrationset update service registrations updateserviceregistrations mapping new mappings newmappings registration set registrationset result registration set registrationset activated bundle context bundlecontext result sorted set sortedset mapping ordered new mappings orderednewmappings tree set treeset mapping arrays as list aslist new mappings newmappings sorted map sortedmap mapping registration new registrations newregistrations tree map treemap mapping registration mapped map entry mapping registration registration entry registrationentry active registrations activeregistrations entry set entryset keep entry keepentry ordered new mappings orderednewmappings registration entry registrationentry get key getkey registration registration registration entry registrationentry get value getvalue result removed add registration keep entry keepentry keep entry keepentry new registrations newregistrations registration entry registrationentry get key getkey registration entry registrationentry get value getvalue add mapping mapping ordered new mappings orderednewmappings new registrations newregistrations contains key containskey mapping registration registration registration mapping new registrations newregistrations mapping registration result add registration active registrations activeregistrations new registrations newregistrations result execute service registrations async executeserviceregistrationsasync registration set registrationset registration set registrationset executor service executorservice execute service registrations executeserviceregistrations registration set registrationset executor service executorservice sub mit submit runnable override execute service registrations executeserviceregistrations registration set registrationset execute service registrations executeserviceregistrations registration set registrationset registration set registrationset registration set registrationset registration registration registration set registrationset removed service registration serviceregistration service registration serviceregistration registration set service setservice service registration serviceregistration service registration serviceregistration unregister illegal state exception illegalstateexception log error unregister service user mapped serviceusermapped registration mapping bundle context bundlecontext saved bundle context savedbundlecontext bundle context bundlecontext saved bundle context savedbundlecontext registration registration registration set registrationset mapping mapping registration mapping dictionary string object properties hashtable string object mapping get sub service name getsubservicename properties service user mapped serviceusermapped sub service name subservicename mapping get sub service name getsubservicename properties mapping service name servicename mapping get service name getservicename service registration serviceregistration service registration serviceregistration saved bundle context savedbundlecontext register service registerservice service user mapped impl serviceusermappedimpl service user mapped serviceusermapped service user mapped impl serviceusermappedimpl properties service registration serviceregistration old service registration oldserviceregistration registration set service setservice service registration serviceregistration old service registration oldserviceregistration old service registration oldserviceregistration unregister illegal state exception illegalstateexception log error unregister service user mapped serviceusermapped registration mapping string internal get user id internalgetuserid string service name servicename string sub service name subservicename service info serviceinfo mapping mapping active mappings activemappings string user id userid mapping map service name servicename sub service name subservicename user id userid user id userid service info serviceinfo mapping mapping active mappings activemappings string user id userid mapping map service name servicename user id userid user id userid fall user default user defaultuser is valid user isvaliduser string user id userid string service name servicename string sub service name subservicename user id userid valid ators validators is empty isempty service user validator serviceuservalidator validator valid ators validators validator is valid isvalid user id userid service name servicename sub service name subservicename string get service name getservicename bundle bundle bundle get symbolic name getsymbolicname list mapping get active mappings getactivemappings collections unmodifiable list unmodifiablelist arrays as list aslist active mappings activemappings registration mapping mapping service registration serviceregistration service registration serviceregistration registration mapping mapping mapping mapping service registration serviceregistration service registration serviceregistration set service setservice service registration serviceregistration service registration serviceregistration service registration serviceregistration old service registration oldserviceregistration service registration serviceregistration service registration serviceregistration service registration serviceregistration old service registration oldserviceregistration registration set registrationset collection registration array list arraylist registration collection registration removed array list arraylist registration
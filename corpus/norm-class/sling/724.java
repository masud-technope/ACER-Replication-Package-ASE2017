licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling maven bundles upport bundlesupport java file java io exception ioexception java util array list arraylist java util hash map hashmap java util iterator java util list java util map java util jar jar file jarfile java util jar manifest org apache commons httpclient credentials org apache commons httpclient http client httpclient org apache commons httpclient http exception httpexception org apache commons httpclient http status httpstatus org apache commons httpclient name value pair namevaluepair org apache commons httpclient username password credentials usernamepasswordcredentials org apache commons httpclient auth scope authscope org apache commons httpclient methods file request entity filerequestentity org apache commons httpclient methods get method getmethod org apache commons httpclient methods post method postmethod org apache commons httpclient methods put method putmethod org apache commons httpclient methods multipart file part filepart org apache commons httpclient methods multipart file part source filepartsource org apache commons httpclient methods multipart multipart request entity multipartrequestentity org apache commons httpclient methods multipart org apache commons httpclient methods multipart string part stringpart org apache maven model resource org apache maven plugin mojo execution exception mojoexecutionexception org apache maven plugins annotations parameter org apache maven project maven project mavenproject org apache sling commons json json array jsonarray org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons osgi manifest header manifestheader org apache sling commons osgi manifest header manifestheader entry abstract bundle install mojo abstractbundleinstallmojo abstract bundle post mojo abstractbundlepostmojo header sling initial content string header initial content sling initial content resource provider factory string factory org apache sling fsprovider internal fs resource provider fsresourceprovider mime type json response string json mime type application json http header content type string header content type content type url running sling instance parameter property sling url default value defaultvalue http localhost system console required string sling url slingurl optional url suffix appended code sling url code real target url configure target url s urls pom common code sling url code parent pom code sling url http localhost code code sling url suffix urlsuffix project specific path code typically conjunction http code sling use put useput code parameter property sling url suffix urlsuffix string sling url suffix slingurlsuffix simple http standard post felix console code uninstall code goal http delete parameter property sling use put useput default value defaultvalue required use put useput jcr primary type primarytype creating int ermediate intermediate paths http deployment parameter property sling deploy int ermediate path primary type intermediatepathprimarytype default value defaultvalue sling folder string int ermediate path primary type intermediatepathprimarytype content type mime type http code sling use put useput code parameter property sling mime type mimetype default value defaultvalue application java archive required string mime type mimetype user authenticate running sling instance parameter property sling user default value defaultvalue admin required string user password authenticate running sling instance parameter property sling password default value defaultvalue admin required string password start level startlevel uploaded bundle parameter property sling bundle start level startlevel default value defaultvalue required string bundle start level bundlestartlevel start uploaded bundle parameter property sling bundle start default value defaultvalue required bundle start bundlestart refresh packages installing uploaded bundle parameter property sling refresh packages refreshpackages default value defaultvalue required refresh packages refreshpackages add mapping provider parameter property sling mount by s mountbyfs default value defaultvalue required mount by s mountbyfs maven project parameter default value defaultvalue project required read only readonly maven project mavenproject project abstract bundle install mojo abstractbundleinstallmojo string get bundle file name getbundlefilename mojo execution exception mojoexecutionexception returns combination code sling url code code sling url suffix urlsuffix code string gettargeturl string targeturl sling url slingurl sling url suffix slingurlsuffix targeturl sling url suffix slingurlsuffix targeturl returns url delete app ending appending filename targeturl string getputurl string targeturl string file name filename targeturl targeturl ends with endswith file name filename execute mojo execution exception mojoexecutionexception file upload string bundle file name bundlefilename get bundle file name getbundlefilename upload pack aging packaging osgi bundle file bundle file bundlefile file bundle file name bundlefilename bundle file bundlefile exists get log getlog info bundle file bundlefile exist uploading string bundle name bundlename get bundle symbolic name getbundlesymbolicname bundle file bundlefile bundle name bundlename get log getlog info bundle file bundlefile osg i osgi bundle uploading string targeturl gettargeturl get log getlog info ins talling installing bundle bundle name bundlename bundle file bundlefile targeturl use put useput post use put useput targeturl bundle file bundlefile post targeturl bundle file bundlefile mount by s mountbyfs configure targeturl bundle file bundlefile helper method meaningful exception out date d outdated felix web console mojo execution exception mojoexecutionexception throw web console too old exception throwwebconsoletoooldexception mojo execution exception mojoexecutionexception mojo execution exception mojoexecutionexception apache felix web console mount initial content file system provider configs upgrade web console disable feature http client http client httpclient get http client gethttpclient http client httpclient client http client httpclient client get http connection manager gethttpconnectionmanager get params getparams set connection timeout setconnectiontimeout authentication stuff client get params getparams set authentication preemptive setauthenticationpreemptive credentials default creds defaultcreds username password credentials usernamepasswordcredentials user password client get state getstate set credentials setcredentials auth scope authscope default creds defaultcreds client post string targeturl file file mojo execution exception mojoexecutionexception append pseudo path root url redirected post method postmethod file post filepost post method postmethod targeturl install ref errer referrer file post filepost set request header setrequestheader ref erer referer blank list part list partlist array list arraylist part list partlist add string part stringpart action install part list partlist add string part stringpart nor edir noredir nor edir noredir part list partlist add file part filepart bundle file bundlefile file part source filepartsource file get name getname file part list partlist add string part stringpart bundles tar tlevel bundlestartlevel bundle start level bundlestartlevel bundle start bundlestart part list partlist add string part stringpart bundles tar t bundlestart start refresh packages refreshpackages part list partlist add string part stringpart refresh packages refreshpackages parts part list partlist to array toarray part list partlist size file post filepost set request entity setrequestentity multipart request entity multipartrequestentity parts file post filepost get params getparams status get http client gethttpclient execute method executemethod file post filepost status http status httpstatus get log getlog info bundle installed string msg installation failed http status httpstatus get status text getstatustext status fail on error failonerror mojo execution exception mojoexecutionexception msg get log getlog error msg exception mojo execution exception mojoexecutionexception installation targeturl failed get message getmessage file post filepost release connection releaseconnection string targeturl file file mojo execution exception mojoexecutionexception success status status perform put performput targeturl file status status success status http status httpstatus conflict get log getlog debug bundle installed missing parent folders attempting create parent structure create int ermediary paths createintermediarypaths targeturl get log getlog debug attempting bundle install creating parent folders status perform put performput targeturl file status status success success string msg installation failed http status httpstatus get status text getstatustext status fail on error failonerror mojo execution exception mojoexecutionexception msg get log getlog error msg exception mojo execution exception mojoexecutionexception installation targeturl failed get message getmessage perform put performput string targeturl file file http exception httpexception io exception ioexception put method putmethod file put fileput put method putmethod getputurl targeturl file get name getname file put fileput set request entity setrequestentity file request entity filerequestentity file mime type mimetype get http client gethttpclient execute method executemethod file put fileput file put fileput release connection releaseconnection create int ermediary paths createintermediarypaths string targeturl http exception httpexception io exception ioexception mojo execution exception mojoexecutionexception string int ermediate path intermediatepath int ermediate paths extract or intermediatepathsextractor extract int ermediate paths extractintermediatepaths targeturl get log getlog debug creating int ermediate intermediate path int ermediate path intermediatepath verify path exists calling json servlet status exists get method getmethod get method getmethod int ermediate path intermediatepath json result get http client gethttpclient execute method executemethod result http status httpstatus get log getlog debug path int ermediate path intermediatepath exists release connection releaseconnection create path exist post method postmethod post post method postmethod int ermediate path intermediatepath post add parameter addparameter name value pair namevaluepair jcr primary type primarytype int ermediate path primary type intermediatepathprimarytype result get http client gethttpclient execute method executemethod post result http status httpstatus created result http status httpstatus mojo execution exception mojoexecutionexception failed creating int ermediate intermediate path int ermediate path intermediatepath reason http status httpstatus get status text getstatustext result get log getlog info created int ermediate intermediate path int ermediate path intermediatepath int ermediate path primary type intermediatepathprimarytype post release connection releaseconnection add configurations running osg i osgi instance initial content param targeturl web console base url param file artifact bundle mojo execution exception mojoexecutionexception configure string targeturl file file mojo execution exception mojoexecutionexception manifest initial content configured manifest header manifestheader header manifest get manifest getmanifest file string get main attributes getmainattributes get value getvalue header initial content get log getlog debug bundle initial content file system provider config created header manifest header manifestheader parse header header get entries getentries length get log getlog warn unable parse header header empty io exception ioexception ioe mojo execution exception mojoexecutionexception unable read manifest file file ioe setup http client http client httpclient client get http client gethttpclient get log getlog info configure file system provider quick check resources configured list resources project get resources getresources resources resources size mojo execution exception mojoexecutionexception resources configured project current configurations map old configs oldconfigs get current file provider configs getcurrentfileproviderconfigs targeturl client entry entries header get entries getentries entry entry entries string path entry get value getvalue path path ends with endswith path check ignore string ignore value ignorevalue entry get directive value getdirectivevalue maven mount ignore value ignorevalue ignore value ignorevalue equals ignore case equalsignorecase get log getlog debug ignoring path string install path installpath entry get directive value getdirectivevalue path install path installpath install path installpath search path resources resource entry rec onfigured reconfigured file dir iterator resources iterator dir has next hasnext resource rsrc resource string child path resource mapping defines target path remove target path checked resource path string target path targetpath rsrc get target path gettargetpath target path targetpath target path targetpath ends with endswith target path targetpath target path targetpath target path targetpath path starts with startswith target path targetpath child child substring target path targetpath length dir file rsrc get directory getdirectory child dir exists dir dir mojo execution exception mojoexecutionexception resource entry path check root mapping don support atm equals install path installpath mojo execution exception mojoexecutionexception mapping root path supported provider moment adapt initial content configuration get log getlog info mapping dir install path installpath check configured iterator entry iterator entryiterator old configs oldconfigs entry set entryset iterator entry iterator entryiterator has next hasnext map entry current map entry entry iterator entryiterator string string current get value getvalue get log getlog debug comp aring comparing dir get absolute path getabsolutepath dir get absolute path getabsolutepath equals install path installpath equals get log getlog debug existing configuration dir install path installpath remove config get log getlog debug removing configuration remove configuration removeconfiguration client targeturl current get key getkey to string tostring entry iterator entryiterator remove get log getlog debug adding configuration dir install path installpath add configuration addconfiguration client targeturl dir get absolute path getabsolutepath install path installpath remove configs iterator entry iterator entryiterator old configs oldconfigs entry set entryset iterator entry iterator entryiterator has next hasnext map entry current map entry entry iterator entryiterator string string current get value getvalue get log getlog debug removing configuration remove config remove configuration removeconfiguration client targeturl current get key getkey to string tostring remove configuration removeconfiguration http client httpclient client string targeturl string pid mojo execution exception mojoexecutionexception string post url posturl targeturl config mgr configmgr pid post method postmethod post post method postmethod post url posturl post add parameter addparameter apply post add parameter addparameter delete status client execute method executemethod post moved temp orarily temporarily config mgr configmgr plugin status http status httpstatus moved temporarily status http status httpstatus get log getlog debug configuration removed get log getlog error removing configuration failed http status httpstatus get status text getstatustext status http exception httpexception mojo execution exception mojoexecutionexception removing configuration post url posturl failed get message getmessage io exception ioexception mojo execution exception mojoexecutionexception removing configuration post url posturl failed get message getmessage post release connection releaseconnection add configuration file system provider mojo execution exception mojoexecutionexception add configuration addconfiguration http client httpclient client string targeturl string dir string path mojo execution exception mojoexecutionexception string post url posturl targeturl config mgr configmgr factory post method postmethod post post method postmethod post url posturl post add parameter addparameter apply post add parameter addparameter factory pid factorypid factory post add parameter addparameter pid temporary pid replaced real pid save post add parameter addparameter provider file dir post add parameter addparameter provider roots path post add parameter addparameter property list propertylist provider roots provider file status client execute method executemethod post moved temp orarily temporarily config mgr configmgr plugin status http status httpstatus moved temporarily status http status httpstatus get log getlog info configuration created get log getlog error configuration failed http status httpstatus get status text getstatustext status http exception httpexception mojo execution exception mojoexecutionexception configuration post url posturl failed get message getmessage io exception ioexception mojo execution exception mojoexecutionexception configuration post url posturl failed get message getmessage post release connection releaseconnection file provider configs project param targeturl targeturl webconsole param client http client map empty pids string array path root mojo execution exception mojoexecutionexception map get current file provider configs getcurrentfileproviderconfigs string targeturl http client httpclient client mojo execution exception mojoexecutionexception get log getlog debug current file provider configurations map result hash map hashmap string get url geturl targeturl config mgr configmgr service factory pid factorypid factory json get method getmethod get method getmethod get url geturl status client execute method executemethod status string content type contenttype get response header getresponseheader header content type get value getvalue pos content type contenttype index of indexof pos content type contenttype content type contenttype substring pos json mime type equals content type contenttype get log getlog debug response type web console json content type contenttype throw web console too old exception throwwebconsoletoooldexception string json text jsontext get response body as string getresponsebodyasstring json array jsonarray array json array jsonarray json text jsontext array length json object jsonobject obj array getjsonobject string pid obj get string getstring pid json object jsonobject properties obj getjsonobject properties string path properties getjsonobject provider file get string getstring string roots properties getjsonobject provider roots get string getstring path path starts with startswith project get based ir getbasedir get absolute path getabsolutepath get log getlog debug configuration pid pid path path roots roots result pid string path roots json exception jsonexception mojo execution exception mojoexecutionexception reading configuration get url geturl failed get message getmessage http exception httpexception mojo execution exception mojoexecutionexception reading configuration get url geturl failed get message getmessage io exception ioexception mojo execution exception mojoexecutionexception reading configuration get url geturl failed get message getmessage release connection releaseconnection result manifest file param bundle file bundlefile bundle jar manifest io exception ioexception manifest get manifest getmanifest file bundle file bundlefile io exception ioexception jar file jarfile file file jar file jarfile bundle file bundlefile file get manifest getmanifest file file close io exception ioexception ignore version web console version code code version detect able detectable string check web console version checkwebconsoleversion string target url targeturl get log getlog debug checking web console version string bundle url bundleurl target url targeturl bundles org apache felix webconsole json http client httpclient client get http client gethttpclient get method getmethod get method getmethod bundle url bundleurl wrong assume older version status client execute method executemethod status get response content length getresponsecontentlength get log getlog debug response length assuming older version web console string json text jsontext get response body as string getresponsebodyasstring json object jsonobject obj json object jsonobject json text jsontext json array jsonarray props obj getjsonarray props props length json object jsonobject property props getjsonobject version equals property key string version property get string getstring get log getlog debug web console version version version get log getlog debug version property response assuming older version json exception jsonexception get log getlog debug converting response json failed assuming older version get message getmessage get log getlog debug status code web console status http exception httpexception get log getlog debug http exception httpexception get message getmessage io exception ioexception get log getlog debug io exception ioexception get message getmessage get log getlog debug unknown version
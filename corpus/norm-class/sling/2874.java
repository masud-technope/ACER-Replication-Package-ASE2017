licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling bgservlets impl storage java text date format dateformat java text simple date format simpledateformat java util calendar java util java util concurrent atomic atomic integer atomicinteger javax jcr node javax jcr repository exception repositoryexception javax jcr session org apache felix scr annotations component org apache felix scr annotations property org apache felix scr annotations reference org apache felix scr annotations service org apache sling bgservlets background servlet constants backgroundservletconstants org apache sling bgservlets job data jobdata org apache sling bgservlets job storage jobstorage org apache sling bgservlets impl deep node creator deepnodecreator org apache sling settings sling settings service slingsettingsservice org osgi service component component context componentcontext org slf logger org slf logger factory loggerfactory job storage jobstorage implementation component metatype label job storage jobstorage label description job storage jobstorage description service job storage impl jobstorageimpl job storage jobstorage logger log logger factory loggerfactory get logger getlogger get class getclass config urable configurable base path storing job data property jobs string prop job storage path job storage path sling settings instance reference sling settings service slingsettingsservice sling settings slingsettings string path format yyyy string job node type nodetype unstructured string job storage path jobstoragepath atomic integer atomicinteger counter atomic integer atomicinteger date format dateformat path format pathformat simple date format simpledateformat path format string sling instance id slinginstanceid activate component context componentcontext ctx job storage path jobstoragepath string ctx get properties getproperties prop job storage path job storage path jobstoragepath job storage path jobstoragepath length illegal state exception illegalstateexception missing prop job storage path component context componentcontext job storage path jobstoragepath starts with startswith job storage path jobstoragepath job storage path jobstoragepath job storage path jobstoragepath ends with endswith job storage path jobstoragepath job storage path jobstoragepath substring job storage path jobstoragepath length sling instance id slinginstanceid sling settings slingsettings get sling id getslingid log info jobs stored job storage path jobstoragepath sling instance id slinginstanceid job data jobdata create job data createjobdata session get job data getjobdata create new job node createnewjobnode exception job storage exception jobstorageexception unable create job data impl jobdataimpl job data jobdata get job data getjobdata node job data impl jobdataimpl exception job storage exception jobstorageexception unable create job data impl jobdataimpl string get next path getnextpath string builder stringbuilder string builder stringbuilder append job storage path jobstoragepath append append sling instance id slinginstanceid append path format pathformat format append append counter increment and get incrementandget to string tostring node create new job node createnewjobnode session repository exception repositoryexception string path get next path getnextpath node result deep node creator deepnodecreator deep create node deepcreatenode path job node type nodetype result add mixin addmixin job data jobdata job data mixin result set property setproperty background servlet constants backgroundservletconstants creation time property calendar get instance getinstance result get session getsession save log debug job node created result get path getpath result
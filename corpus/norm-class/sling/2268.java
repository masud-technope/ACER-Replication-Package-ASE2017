licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling impl org junit assert equals assertequals org mockito matchers org mockito matchers org mockito mockito times org powermock api mockito power mockito powermockito do return doreturn org powermock api mockito power mockito powermockito spy org powermock api mockito power mockito powermockito verify private verifyprivate java util hashtable java util locale java util resource bundle resourcebundle java util concurrent executor service executorservice java util concurrent executors java util concurrent time unit timeunit org apache sling impl jcr resource bundle provider jcrresourcebundleprovider key org junit org junit test org junit runner run with runwith org mockito mock org mockito mockito org osgi framework bundle context bundlecontext org osgi service component component context componentcontext org powermock api mockito power mockito powermockito org powermock core class loader classloader annotations prepare for test preparefortest org powermock modules junit power mock runner powermockrunner test verify bundle loaded concurrent requests bundle run with runwith power mock runner powermockrunner prepare for test preparefortest jcr resource bundle provider jcrresourcebundleprovider concurrent jcr resource bundle loading test concurrentjcrresourcebundleloadingtest mock jcr resource bundle jcrresourcebundle english mock jcr resource bundle jcrresourcebundle german jcr resource bundle provider jcrresourcebundleprovider provider setup exception provider spy jcr resource bundle provider jcrresourcebundleprovider hashtable string object properties hashtable string object properties locale provider activate create component context createcomponentcontext properties do return doreturn english provider create resource bundle createresourcebundle locale english do return doreturn german provider create resource bundle createresourcebundle locale german mockito german get locale getlocale then return thenreturn locale german mockito english get locale getlocale then return thenreturn locale english mockito german get parent getparent then return thenreturn english test load bundles only once per locale loadbundlesonlyonceperlocale exception assert equals assertequals english provider get resource bundle getresourcebundle locale english assert equals assertequals english provider get resource bundle getresourcebundle locale english assert equals assertequals german provider get resource bundle getresourcebundle locale german assert equals assertequals german provider get resource bundle getresourcebundle locale german verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale test load bundles only once with concurrent requests loadbundlesonlyoncewithconcurrentrequests exception number of threads numberofthreads executor service executorservice executor executors new fixed thread pool newfixedthreadpool number of threads numberofthreads number of threads numberofthreads locale language number of threads numberofthreads locale english locale german executor sub mit submit runnable override provider get resource bundle getresourcebundle language executor shutdown executor await termination awaittermination time unit timeunit seconds verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale english verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale german test new bundle used after reload newbundleusedafterreload exception provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german reloading german reload bundle provider reload bundle reloadbundle key locale german provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale english verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale german test new bundle used as parent after reload newbundleusedasparentafterreload exception provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german reloading english reload german english parent provider reload bundle reloadbundle key locale english provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german provider get resource bundle getresourcebundle locale english provider get resource bundle getresourcebundle locale german verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale english verify private verifyprivate provider times invoke create resource bundle createresourcebundle locale german component context componentcontext create component context createcomponentcontext hashtable string object config component context componentcontext component context componentcontext power mockito powermockito mock component context componentcontext mockito component context componentcontext get bundle context getbundlecontext then return thenreturn power mockito powermockito mock bundle context bundlecontext mockito component context componentcontext get properties getproperties then return thenreturn config component context componentcontext
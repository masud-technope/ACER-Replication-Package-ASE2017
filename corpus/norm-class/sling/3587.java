licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution serialization impl vlt javax annotation nonnull javax jcr node javax jcr property javax jcr repository exception repositoryexception javax jcr session java file java io exception ioexception java input stream inputstream java util properties java util tree map treemap java util uuid org apache commons file utils fileutils org apache commons io utils ioutils org apache jackrabbit commons jcr utils jcrutils org apache jackrabbit vault api import mode importmode org apache jackrabbit vault api path filter set pathfilterset org apache jackrabbit vault api workspace filter workspacefilter org apache jackrabbit vault access control handling accesscontrolhandling org apache jackrabbit vault import options importoptions org apache jackrabbit vault packaging export options exportoptions org apache jackrabbit vault packaging jcr package jcrpackage org apache jackrabbit vault packaging jcr package definition jcrpackagedefinition org apache jackrabbit vault packaging jcr package manager jcrpackagemanager org apache jackrabbit vault packaging package id packageid org apache jackrabbit vault packaging packaging org apache jackrabbit vault packaging vault package vaultpackage org apache sling api resource resource resolver resourceresolver org apache sling distribution distribution request distributionrequest org apache sling distribution common distribution exception distributionexception org apache sling distribution serialization distribution package distributionpackage org apache sling distribution serialization distribution package builder distributionpackagebuilder org apache sling distribution serialization impl abstract distribution package abstractdistributionpackage org apache sling distribution serialization impl abstract distribution package builder abstractdistributionpackagebuilder org slf logger org slf logger factory loggerfactory link org apache sling distribution serialization distribution package builder distributionpackagebuilder â based apache jackrabbit file vault filevault link distribution package distributionpackage â created link jcr vault distribution package builder jcrvaultdistributionpackagebuilder backed link org apache jackrabbit vault packaging jcr package jcrpackage jcr vault distribution package builder jcrvaultdistributionpackagebuilder abstract distribution package builder abstractdistributionpackagebuilder distribution package builder distributionpackagebuilder logger log logger factory loggerfactory get logger getlogger get class getclass string version string group sling distribution packaging packaging import mode importmode import mode importmode access control handling accesscontrolhandling acl handling aclhandling string package roots packageroots string temp packages node temppackagesnode file temp directory tempdirectory tree map treemap string path filter set pathfilterset filters jcr vault distribution package builder jcrvaultdistributionpackagebuilder string type packaging packaging import mode importmode import mode importmode access control handling accesscontrolhandling acl handling aclhandling string package roots packageroots string filter rules filterrules string temp files folder tempfilesfolder type packaging packaging import mode importmode import mode importmode acl handling aclhandling acl handling aclhandling package roots packageroots package roots packageroots temp packages node temppackagesnode abstract distribution package abstractdistributionpackage packages root type data temp directory tempdirectory vlt utils vltutils get temp folder gettempfolder temp files folder tempfilesfolder filters vlt utils vltutils parse filters parsefilters filter rules filterrules override distribution package distributionpackage create package for add createpackageforadd nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull distribution request distributionrequest request distribution exception distributionexception session session vault package vaultpackage vault package vaultpackage jcr package jcrpackage jcr package jcrpackage session get session getsession resource resolver resourceresolver string package group packagegroup group string package name packagename get type gettype system current time millis currenttimemillis uuid randomuuid workspace filter workspacefilter filter vlt utils vltutils create filter createfilter request filters export options exportoptions opts vlt utils vltutils get export options getexportoptions filter package roots packageroots package group packagegroup package name packagename version log debug ass embling assembling user package group packagegroup package name packagename version resource resolver resourceresolver get user d getuserid vault package vaultpackage vlt utils vltutils create package createpackage packaging get package manager getpackagemanager session opts temp directory tempdirectory jcr package jcrpackage upload package uploadpackage session vault package vaultpackage jcr vault distribution package jcrvaultdistributionpackage get type gettype jcr package jcrpackage session throwable vlt utils vltutils delete package deletepackage jcr package jcrpackage distribution exception distributionexception unget session ungetsession session vlt utils vltutils delete package deletepackage vault package vaultpackage override distribution package distributionpackage read package internal readpackageinternal nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull input stream inputstream stream distribution exception distributionexception session session vault package vaultpackage vault package vaultpackage jcr package jcrpackage jcr package jcrpackage session get session getsession resource resolver resourceresolver vault package vaultpackage vlt utils vltutils read package readpackage packaging get package manager getpackagemanager stream temp directory tempdirectory jcr package jcrpackage upload package uploadpackage session vault package vaultpackage jcr vault distribution package jcrvaultdistributionpackage get type gettype jcr package jcrpackage session throwable vlt utils vltutils delete package deletepackage jcr package jcrpackage distribution exception distributionexception unget session ungetsession session vlt utils vltutils delete package deletepackage vault package vaultpackage override install package internal installpackageinternal nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull distribution package distributionpackage distribution package distributionpackage distribution exception distributionexception session session session get session getsession resource resolver resourceresolver string package name packagename distribution package distributionpackage get id getid jcr package jcrpackage jcr package jcrpackage open package openpackage session package name packagename import options importoptions import options importoptions vlt utils vltutils get import options getimportoptions acl handling aclhandling import mode importmode jcr package jcrpackage extract import options importoptions exception distribution exception distributionexception unget session ungetsession session override distribution package distributionpackage get package internal getpackageinternal nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull string session session session get session getsession resource resolver resourceresolver jcr package jcrpackage jcr package jcrpackage open package openpackage session jcr vault distribution package jcrvaultdistributionpackage get type gettype jcr package jcrpackage session repository exception repositoryexception log error unget session ungetsession session jcr package jcrpackage upload package uploadpackage session session vault package vaultpackage pack io exception ioexception repository exception repositoryexception jcr package manager jcrpackagemanager package manager packagemanager packaging get package manager getpackagemanager session node package root packageroot get package root getpackageroot session package id packageid package id packageid get package id getpackageid pack input stream inputstream file utils fileutils open input stream openinputstream pack get file getfile package root packageroot string package name packagename package id packageid get down load name getdownloadname package root packageroot has node hasnode package name packagename package root packageroot get node getnode package name packagename remove jcr package jcrpackage jcr package jcrpackage package manager packagemanager create package root packageroot package name packagename property data jcr package jcrpackage get data getdata data set value setvalue jcr package definition jcrpackagedefinition def jcr package jcrpackage get definition getdefinition def unwrap pack log debug uploaded jcr package jcrpackage get node getnode get path getpath jcr package jcrpackage package manager packagemanager upload io utils ioutils close quietly closequietly jcr package jcrpackage open package openpackage session session string package name packagename repository exception repositoryexception jcr package manager jcrpackagemanager package manager packagemanager packaging get package manager getpackagemanager session node package root packageroot get package root getpackageroot session package id packageid package id packageid package id packageid group package name packagename version package root packageroot node package node packagenode package root packageroot get node getnode package id packageid get down load name getdownloadname package manager packagemanager open package node packagenode package manager packagemanager open package id packageid package id packageid get package id getpackageid vault package vaultpackage vault package vaultpackage properties props vault package vaultpackage get meta inf getmetainf get properties getproperties string version props get property getproperty vault package vaultpackage version string group props get property getproperty vault package vaultpackage group string props get property getproperty vault package vaultpackage package id packageid group version node get package root getpackageroot session session repository exception repositoryexception node package root packageroot temp packages node temppackagesnode package root packageroot jcr utils jcrutils get or create by path getorcreatebypath temp packages node temppackagesnode sling folder sling folder session package root packageroot
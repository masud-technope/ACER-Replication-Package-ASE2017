licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery impl common resource java util collections java util comparator java util iterator java util linked list linkedlist java util list org apache sling api resource resource org apache sling api resource value map valuemap org apache sling discovery instance description instancedescription org apache sling discovery commons providers spi local cluster view localclusterview org apache sling discovery impl config org apache sling discovery impl common view org slf logger org slf logger factory loggerfactory cluster view clusterview represents established view members stored repository location established cluster view establishedclusterview local cluster view localclusterview logger avoid frequent initialization cluster view resource clusterviewresource logger logger logger factory loggerfactory get logger getlogger established cluster view establishedclusterview construct established cluster view established cluster view establishedclusterview config config view view string local id localid view get view id getviewid view get resource getresource get name getname resource view res viewres view get resource getresource view res viewres illegal state exception illegalstateexception view res viewres value map valuemap value map valuemap view res viewres adapt to adaptto value map valuemap value map valuemap illegal state exception illegalstateexception value map valuemap string leader id leaderid value map valuemap leader id leaderid string resource members view res viewres get child getchild members members illegal state exception illegalstateexception members iterator resource members get children getchildren iterator list resource instance ress instanceress linked list linkedlist resource has next hasnext instance ress instanceress add collections sort instance ress instanceress comparator resource compare resource resource get name getname compare to compareto get name getname leader id leaderid leader id leaderid length fallback pre sling choose leader based sling id slingid resource leader instance ress instanceress leader id leaderid leader get name getname instance description instancedescription leader instance leaderinstance iterator resource instance ress instanceress iterator has next hasnext resource resource resource instance resource instanceresource resource get resource resolver getresourceresolver get resource getresource config get cluster instances path getclusterinstancespath resource get name getname string sling id slingid resource get name getname established instance description establishedinstancedescription instance established instance description establishedinstancedescription instance resource instanceresource sling id slingid sling id slingid equals leader id leaderid sling id slingid equals local id localid instance is leader isleader leader instance leaderinstance logger error instance chosen leader overwritten leader leader instance leaderinstance leader instance leader instance leaderinstance instance
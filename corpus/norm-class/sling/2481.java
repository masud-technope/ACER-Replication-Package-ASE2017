licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling mailarchiveserver impl org apache sling mailarchiveserver impl message store impl messagestoreimpl get domain node name getdomainnodename org apache sling mailarchiveserver impl message store impl messagestoreimpl get list node name getlistnodename org apache sling mailarchiveserver impl message store impl messagestoreimpl make jcr friendly makejcrfriendly org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue java file java file not found exception filenotfoundexception java util array list arraylist java util hash map hashmap java util list java util map java util scanner org apache james mime dom header org apache james mime dom message org apache james mime stream field org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource resource org apache sling api resource value map valuemap message store impl repository test util messagestoreimplrepositorytestutil string test file field separator code http svn apache org repos asf sling trunk launchpad test services src main java org apache sling launchpad tests ervices testservices server side tests serversidetests write able resources test writeableresourcestest java assert value map assertvaluemap value map valuemap string key value keyvalue assert not null assertnotnull expecting value map valuemap key value keyvalue length string key key value keyvalue string key value keyvalue assert equals assertequals expecting key key string string read text file readtextfile file body file bodyfile file not found exception filenotfoundexception scanner scanner body file bodyfile string expected body expectedbody has next line hasnextline expected body expectedbody next line nextline expected body expectedbody expected body expectedbody substring expected body expectedbody length expected body expectedbody close string special path from file path specialpathfromfilepath string fpath string suffix string ext dot idx dotidx fpath last index of lastindexof string body path bodypath fpath substring dot idx dotidx suffix ext body path bodypath string special path from file path specialpathfromfilepath string fpath string suffix dot idx dotidx fpath last index of lastindexof special path from file path specialpathfromfilepath fpath suffix fpath substring dot idx dotidx string get resource path getresourcepath message msg message store impl messagestoreimpl store header hdr msg get header getheader string list id raw listidraw hdr get field getfield list get body getbody remove string list id listid list id raw listidraw substring list id raw listidraw length string msg id msgid field msg id field msgidfield hdr get field getfield message msg id field msgidfield msg id msgid msg id field msgidfield get body getbody msg id msgid msg id msgid substring msg id msgid length msg id msgid integer to hex string tohexstring hdr get field getfield hash code hashcode msg id msgid make jcr friendly makejcrfriendly msg id msgid string subject field subject field subjectfield hdr get field getfield subject subject field subjectfield subject subject field subjectfield get body getbody string thread path threadpath store thread key gen threadkeygen get thread key getthreadkey subject string path store archive path archivepath get domain node name getdomainnodename list id listid get list node name getlistnodename list id listid thread path threadpath msg id msgid path assert headers assertheaders file headers file headersfile modifiable value map modifiablevaluemap file not found exception filenotfoundexception map string list string expected headers expectedheaders hash map hashmap string list string scanner scanner headers file headersfile has next line hasnextline string next line nextline starts with startswith string colon split test file field separator string header colon string colon list string values values expected headers expectedheaders header values array list arraylist string expected headers expectedheaders header values values add close assert equals assertequals expecting number headers key set keyset size expected headers expectedheaders key set keyset size string expected header expectedheader expected headers expectedheaders key set keyset assert true asserttrue expecting header expected header expectedheader exist contains key containskey expected header expectedheader string values expected header expectedheader string string expected value expectedvalue expected headers expectedheaders expected header expectedheader assert true asserttrue expecting header expected header expectedheader values expected value expectedvalue assert layer assertlayer resource root list string types depth resource child root get children getchildren modifiable value map modifiablevaluemap child adapt to adaptto modifiable value map modifiablevaluemap key set keyset message store impl repository test messagestoreimplrepositorytest test key string type message store impl repository test messagestoreimplrepositorytest test key string assert equals assertequals string format expecting type child get path getpath types depth types depth type child get children getchildren iterator has next hasnext assert layer assertlayer child types depth
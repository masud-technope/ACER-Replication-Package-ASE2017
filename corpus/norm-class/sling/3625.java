licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core impl executor org apache sling util for matting result log formattingresultlog ms human readable mshumanreadable java util array list arraylist java util collection java util collections java util comparator java util java util hash map hashmap java util hash set hashset java util iterator java util linked list linkedlist java util list java util map java util org apache commons lang time stop watch stopwatch org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations modified org apache felix scr annotations property org apache felix scr annotations reference org apache felix scr annotations service org apache sling commons osgi properties util propertiesutil org apache sling commons threads modifiable thread pool config modifiablethreadpoolconfig org apache sling commons threads thread pool threadpool org apache sling commons threads thread pool manager threadpoolmanager org apache sling api health check healthcheck org apache sling api result org apache sling api execution health check execution options healthcheckexecutionoptions org apache sling api execution health check execution result healthcheckexecutionresult org apache sling api execution health check executor healthcheckexecutor org apache sling util health check filter healthcheckfilter org apache sling util health check metadata healthcheckmetadata org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service event serviceevent org osgi framework service listener servicelistener org osgi framework service reference servicereference org slf logger org slf logger factory loggerfactory runs health checks list tags parallel service health check executor healthcheckexecutor extended health check executor extendedhealthcheckexecutor component label apache sling health check executor description runs health checks list tags parallel metatype cache health check executor impl healthcheckexecutorimpl extended health check executor extendedhealthcheckexecutor service listener servicelistener logger logger logger factory loggerfactory get logger getlogger get class getclass timeout string prop timeout timeout in ms timeoutinms property prop timeout label timeout description timeout check marked timed long value longvalue timeout longrunning threshold critical string prop longrunning threshold critical long running future threshold for critical ms longrunningfuturethresholdforcriticalms property prop longrunning threshold critical label timeout threshold critical description threshold check marked exc eedingly exceedingly timed marked critical warn long value longvalue longrunning threshold critical result cache ttll string prop result cache ttl result cache ttl in ms resultcachettlinms property prop result cache ttl label cache ttl description result cache time live cached time long value longvalue result cache ttll timeout in ms timeoutinms long running future threshold for red ms longrunningfuturethresholdforredms result cache ttl in ms resultcachettlinms health check result cache healthcheckresultcache health check result cache healthcheckresultcache health check result cache healthcheckresultcache map health check metadata healthcheckmetadata health check future healthcheckfuture still running futures stillrunningfutures hash map hashmap health check metadata healthcheckmetadata health check future healthcheckfuture reference async health check executor asynchealthcheckexecutor async health check executor asynchealthcheckexecutor reference thread pool manager threadpoolmanager thread pool manager threadpoolmanager thread pool threadpool hc thread pool hcthreadpool bundle context bundlecontext bundle context bundlecontext activate activate map string object properties bundle context bundlecontext bundle context bundlecontext bundle context bundlecontext bundle context bundlecontext modifiable thread pool config modifiablethreadpoolconfig hc thread pool config hcthreadpoolconfig modifiable thread pool config modifiablethreadpoolconfig hc thread pool config hcthreadpoolconfig set max pool size setmaxpoolsize hc thread pool hcthreadpool thread pool manager threadpoolmanager create hc thread pool config hcthreadpoolconfig health check thread pool modified properties bundle context bundlecontext add service listener addservicelistener constants object class objectclass health check healthcheck get name getname invalid syntax exception invalidsyntaxexception ise runtime exception runtimeexception unexpected exception occured ise modified modified map string object properties timeout in ms timeoutinms properties util propertiesutil to long tolong properties prop timeout timeout timeout in ms timeoutinms timeout in ms timeoutinms timeout long running future threshold for red ms longrunningfuturethresholdforredms properties util propertiesutil to long tolong properties prop longrunning threshold critical longrunning threshold critical long running future threshold for red ms longrunningfuturethresholdforredms long running future threshold for red ms longrunningfuturethresholdforredms longrunning threshold critical result cache ttl in ms resultcachettlinms properties util propertiesutil to long tolong properties prop result cache ttl result cache ttll result cache ttl in ms resultcachettlinms result cache ttl in ms resultcachettlinms result cache ttll deactivate deactivate thread pool manager threadpoolmanager release hc thread pool hcthreadpool bundle context bundlecontext remove service listener removeservicelistener bundle context bundlecontext health check result cache healthcheckresultcache clear override service changed servicechanged service event serviceevent event event get type gettype service event serviceevent unregistering service id serviceid event get service reference getservicereference get property getproperty constants service health check result cache healthcheckresultcache remove cached result removecachedresult service id serviceid org apache sling api execution health check executor healthcheckexecutor execute string override list health check execution result healthcheckexecutionresult execute string tags execute options health check execution options healthcheckexecutionoptions tags org apache sling api execution health check executor healthcheckexecutor execute health check execution options healthcheckexecutionoptions string override list health check execution result healthcheckexecutionresult execute health check execution options healthcheckexecutionoptions options string tags logger debug starting executing checks tags execution options tags tags options health check filter healthcheckfilter filter health check filter healthcheckfilter bundle context bundlecontext service reference servicereference health check references healthcheckreferences filter get tag ged health check service references gettaggedhealthcheckservicereferences options is combine tags with or iscombinetagswithor tags execute health check references healthcheckreferences options filter dispose org apache sling core impl executor extended health check executor extendedhealthcheckexecutor execute org osgi framework service reference servicereference override health check execution result healthcheckexecutionresult execute service reference servicereference health check metadata healthcheckmetadata metadata get health check metadata gethealthcheckmetadata create results for descriptor createresultsfordescriptor metadata list health check execution result healthcheckexecutionresult execute service reference servicereference health check references healthcheckreferences execute health check references healthcheckreferences health check execution options healthcheckexecutionoptions execute health checks list health check execution result healthcheckexecutionresult execute service reference servicereference health check references healthcheckreferences health check execution options healthcheckexecutionoptions options stop watch stopwatch stop watch stopwatch stop watch stopwatch stop watch stopwatch start list health check execution result healthcheckexecutionresult array list arraylist health check execution result healthcheckexecutionresult list health check metadata healthcheckmetadata health check descriptors healthcheckdescriptors get health check metadata gethealthcheckmetadata health check references healthcheckreferences create results for descriptors createresultsfordescriptors health check descriptors healthcheckdescriptors options stop watch stopwatch logger is debug enabled isdebugenabled logger debug time consumed checks ms human readable mshumanreadable stop watch stopwatch get time gettime sort result collections sort comparator health check execution result healthcheckexecutionresult override compare health check execution result healthcheckexecutionresult arg health check execution result healthcheckexecutionresult arg execution result executionresult arg compare to compareto execution result executionresult arg create results for descriptors createresultsfordescriptors list health check metadata healthcheckmetadata health check descriptors healthcheckdescriptors collection health check execution result healthcheckexecutionresult health check execution options healthcheckexecutionoptions options async options is force ins tant execution isforceinstantexecution async health check executor asynchealthcheckexecutor collect async results collectasyncresults health check descriptors healthcheckdescriptors reuse cached options is force ins tant execution isforceinstantexecution health check result cache healthcheckresultcache use valid cache results usevalidcacheresults health check descriptors healthcheckdescriptors result cache ttl in ms resultcachettlinms executed parallel futures list health check future healthcheckfuture futures create or reuse futures createorreusefutures health check descriptors healthcheckdescriptors wait futures timeout earlier futures finished wait for futures res pecting timeout waitforfuturesrespectingtimeout futures options collect results from futures collectresultsfromfutures futures health check execution result healthcheckexecutionresult create results for descriptor createresultsfordescriptor health check metadata healthcheckmetadata metadata methods check transform health check descriptor healthcheckdescriptor result descriptor removed list result reuse cached health check execution result healthcheckexecutionresult result result health check result cache healthcheckresultcache use valid cache results usevalidcacheresults metadata result cache ttl in ms resultcachettlinms result health check future healthcheckfuture still running futures stillrunningfutures create or reuse future createorreusefuture metadata wait futures timeout earlier futures finished wait for futures res pecting timeout waitforfuturesrespectingtimeout collections singleton list singletonlist result collect result from future collectresultfromfuture result create health check meta data list health check metadata healthcheckmetadata get health check metadata gethealthcheckmetadata service reference servicereference health check references healthcheckreferences list health check metadata healthcheckmetadata descriptors linked list linkedlist health check metadata healthcheckmetadata service reference servicereference service reference servicereference health check references healthcheckreferences health check metadata healthcheckmetadata descriptor get health check metadata gethealthcheckmetadata service reference servicereference descriptors add descriptor descriptors create health check meta data health check metadata healthcheckmetadata get health check metadata gethealthcheckmetadata service reference servicereference health check reference healthcheckreference health check metadata healthcheckmetadata descriptor health check metadata healthcheckmetadata health check reference healthcheckreference descriptor create reuse list health checks list health check future healthcheckfuture create or reuse futures createorreusefutures list health check metadata healthcheckmetadata health check descriptors healthcheckdescriptors list health check future healthcheckfuture futures for result of this call futuresforresultofthiscall linked list linkedlist health check future healthcheckfuture still running futures stillrunningfutures health check metadata healthcheckmetadata health check descriptors healthcheckdescriptors futures for result of this call futuresforresultofthiscall add create or reuse future createorreusefuture futures for result of this call futuresforresultofthiscall create reuse health check method caller still running futures stillrunningfutures health check future healthcheckfuture create or reuse future createorreusefuture health check metadata healthcheckmetadata metadata health check future healthcheckfuture still running futures stillrunningfutures metadata logger debug running metadata logger debug creating metadata health check future healthcheckfuture metadata bundle context bundlecontext health check future healthcheckfuture callback override finished health check execution result healthcheckexecutionresult result health check result cache healthcheckresultcache update with updatewith result async health check executor asynchealthcheckexecutor update with updatewith result still running futures stillrunningfutures still running futures stillrunningfutures remove metadata still running futures stillrunningfutures metadata hc thread pool hcthreadpool execute wait futures timeout reached wait for futures res pecting timeout waitforfuturesrespectingtimeout list health check future healthcheckfuture futures for result of this call futuresforresultofthiscall health check execution options healthcheckexecutionoptions options stop watch stopwatch call excution time stop watch callexcutiontimestopwatch stop watch stopwatch call excution time stop watch callexcutiontimestopwatch start all futures done allfuturesdone effective timeout effectivetimeout timeout in ms timeoutinms options options get override global timeout getoverrideglobaltimeout effective timeout effectivetimeout options get override global timeout getoverrideglobaltimeout thread sleep interrupted exception interruptedexception logger warn unexpected interrupted exception interruptedexception waiting health check contributors healthcheckcontributors all futures done allfuturesdone health check future healthcheckfuture health check future healthcheckfuture futures for result of this call futuresforresultofthiscall all futures done allfuturesdone health check future healthcheckfuture is done isdone all futures done allfuturesdone call excution time stop watch callexcutiontimestopwatch get time gettime effective timeout effectivetimeout collect futures param futures for result of this call futuresforresultofthiscall list futures param result collection collect results from futures collectresultsfromfutures list health check future healthcheckfuture futures for result of this call futuresforresultofthiscall collection health check execution result healthcheckexecutionresult health check execution result healthcheckexecutionresult results from futures resultsfromfutures hash set hashset health check execution result healthcheckexecutionresult iterator health check future healthcheckfuture futures it futuresit futures for result of this call futuresforresultofthiscall iterator futures it futuresit has next hasnext health check future healthcheckfuture futures it futuresit health check execution result healthcheckexecutionresult result collect result from future collectresultfromfuture results from futures resultsfromfutures add result futures it futuresit remove logger debug adding futures results from futures resultsfromfutures size add all addall results from futures resultsfromfutures collect result single param execution result result reached timeout health check execution result healthcheckexecutionresult collect result from future collectresultfromfuture health check future healthcheckfuture health check execution result healthcheckexecutionresult result is done isdone logger debug health check get health check metadata gethealthcheckmetadata result exception logger warn unexpected exception future elapsed time ms futureelapsedtimems get time gettime get created time getcreatedtime get time gettime result execution result executionresult get health check metadata gethealthcheckmetadata result status health check error unexpected exception future elapsed time ms futureelapsedtimems logger debug health check timed get health check metadata gethealthcheckmetadata futures can celled cancelled int err upting interrupting health check corrupted repository crx round trip check crxroundtripcheck ugly messages stack traces log file turn check warn normal timeout threshold time critical reached turn result critical future elapsed time ms futureelapsedtimems get time gettime get created time getcreatedtime get time gettime future elapsed time ms futureelapsedtimems long running future threshold for red ms longrunningfuturethresholdforredms result execution result executionresult get health check metadata gethealthcheckmetadata result status warn timeout check running ms human readable mshumanreadable future elapsed time ms futureelapsedtimems future elapsed time ms futureelapsedtimems result execution result executionresult get health check metadata gethealthcheckmetadata result status critical timeout check running ms human readable mshumanreadable future elapsed time ms futureelapsedtimems exc eeding exceeding configured threshold critical ms human readable mshumanreadable long running future threshold for red ms longrunningfuturethresholdforredms future elapsed time ms futureelapsedtimems result set timeout in ms settimeoutinms timeout in ms timeoutinms timeout in ms timeoutinms timeout in ms timeoutinms set long running future threshold for red ms setlongrunningfuturethresholdforredms long running future threshold for red ms longrunningfuturethresholdforredms long running future threshold for red ms longrunningfuturethresholdforredms long running future threshold for red ms longrunningfuturethresholdforredms
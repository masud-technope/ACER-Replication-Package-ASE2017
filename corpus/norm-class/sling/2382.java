licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest login java io exception ioexception java util array list arraylist java util list javax servlet http http servlet response httpservletresponse org apache commons http client httpclient header org apache commons http client httpclient http method httpmethod org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient methods post method postmethod org apache sling commons testing int egration integration http test base httptestbase test sling verify redirect ref erring referring login form login error works redirect on login error test redirectonloginerrortest http test base httptestbase execute post request check status http method httpmethod executed io exception ioexception http method httpmethod assert post status assertpoststatus string url expected status code expectedstatuscode list name value pair namevaluepair post params postparams string assert message assertmessage string ref erer referer io exception ioexception post method postmethod post post method postmethod url post set follow redirects setfollowredirects post set do authentication setdoauthentication ref erer referer post set request header setrequestheader ref erer referer ref erer referer accept header trick sling treating request browser post set request header setrequestheader user agent mozilla sling int egration integration test post params postparams name value pair namevaluepair nvp post set request body setrequestbody post params postparams to array toarray nvp post params postparams name value pair namevaluepair nvp post set request body setrequestbody post params postparams to array toarray nvp status http client httpclient execute method executemethod post assert message assertmessage assert equals assertequals expected status code expectedstatuscode status assert equals assertequals assert message assertmessage expected status code expectedstatuscode status post test sling login error redirect ref errer referrer login exception test redirect to login form after login error testredirecttologinformafterloginerror exception login failure list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username bogus params add name value pair namevaluepair password real user string login page url loginpageurl string format system sling form login http base url post method postmethod post post method postmethod assert post status assertpoststatus http base url security check http servlet response httpservletresponse moved temp orarily temporarily params login page url loginpageurl header location header locationheader post get response header getresponseheader location string location location header locationheader get value getvalue query str start querystrstart location index of indexof query str start querystrstart location location substring query str start querystrstart assert equals assertequals expected remain form login login page url loginpageurl location test sling verify request login result error condition exception test get default login page testgetdefaultloginpage exception string login page url loginpageurl string format system sling login http base url assert http status asserthttpstatus login page url loginpageurl http servlet response httpservletresponse
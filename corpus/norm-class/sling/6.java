licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling hapi client test org hamcrest core is equal isequal equal to equalto java i o exception ioexception java net uri syntax exception urisyntaxexception java util array list arraylist java util list org apache commons i o utils ioutils org apache http http entity httpentity org apache http http exception httpexception org apache http http request httprequest org apache http http response httpresponse org apache http name value pair namevaluepair org apache http entity string entity stringentity org apache http message basic name value pair basicnamevaluepair org apache http protocol http context httpcontext org apache http protocol http request handler httprequesthandler org apache sling hapi client client exception clientexception org apache sling hapi client document org apache sling hapi client items org apache sling hapi client microdata microdata html client microdatahtmlclient org apache sling hapi client test util http server rule httpserverrule org junit org junit class rule classrule org junit test form test formtest string url test string post url test post testpost string response test string fail response test fail class rule classrule http server rule httpserverrule http server httpserver http server rule httpserverrule override register handlers registerhandlers server bootstrap serverbootstrap register handler registerhandler url http request handler httprequesthandler override handle http request httprequest http request httprequest http response httpresponse http response httpresponse http context httpcontext http context httpcontext http exception httpexception i o exception ioexception string html i o utils ioutils to string tostring items test itemstest get resource as stream getresourceasstream items forms html utf http entity httpentity entity string entity stringentity html utf http response httpresponse set entity setentity entity register handler registerhandler post url http request handler httprequesthandler override handle http request httprequest http request httprequest http response httpresponse http response httpresponse http context httpcontext http context httpcontext http exception httpexception i o exception ioexception http request httprequest get request line getrequestline get method getmethod equals post http response httpresponse set entity setentity string entity stringentity fail response http response httpresponse set entity setentity string entity stringentity response http response httpresponse set status code setstatuscode http response httpresponse set header setheader location url test test form testform client exception clientexception uri syntax exception urisyntaxexception microdata html client microdatahtmlclient client microdata html client microdatahtmlclient http server httpserver geturi to string tostring document doc client enter url items items doc items assert that assertthat items length equal to equalto items form doc form test assert that assertthat form length equal to equalto list name value pair namevaluepair data array list arraylist name value pair namevaluepair data add basic name value pair basicnamevaluepair val url encode enctype document doc form sub mit submit data assert that assertthat doc items length equal to equalto multipart enctype document doc form sub mit submit data assert that assertthat doc items length equal to equalto
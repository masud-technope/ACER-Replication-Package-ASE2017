licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling ide test impl org apache sling ide test impl helpers eclipse resource matchers eclipseresourcematchers has file hasfile org apache sling ide test impl helpers eclipse resource matchers eclipseresourcematchers has folder hasfolder org hamcrest core matchers corematchers equal to equalto org hamcrest core matchers corematchers org hamcrest core matchers corematchers null value nullvalue org junit assert that assertthat java byte array input stream bytearrayinputstream java lang reflect invocation target exception invocationtargetexception javax jcr node javax jcr repository exception repositoryexception javax jcr session javax jcr value factory valuefactory org apache sling ide eclipse core internal activator org apache sling ide eclipse internal import repository content action importrepositorycontentaction org apache sling ide serialization serialization exception serializationexception org apache sling ide test impl helpers disable debug status handlers disabledebugstatushandlers org apache sling ide test impl helpers external sling launchpad externalslinglaunchpad org apache sling ide test impl helpers fail on modification events rule failonmodificationeventsrule org apache sling ide test impl helpers fail on unsuccessful events rule failonunsuccessfuleventsrule org apache sling ide test impl helpers launchpad config launchpadconfig org apache sling ide test impl helpers project adapter projectadapter org apache sling ide test impl helpers repository accessor repositoryaccessor org apache sling ide test impl helpers repository accessor repositoryaccessor session runnable sessionrunnable org apache sling ide test impl helpers server adapter serveradapter org apache sling ide test impl helpers sling wst server slingwstserver org apache sling ide test impl helpers temporary project temporaryproject org eclipse core resources i project iproject org eclipse core runtime core exception coreexception org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core runtime path org eclipse jdt core java core javacore org junit org junit org junit rule org junit test org junit rules rule chain rulechain org junit rules test rule testrule content import test contentimporttest launchpad config launchpadconfig config launchpad config launchpadconfig get instance getinstance sling wst server slingwstserver wst server wstserver sling wst server slingwstserver config rule test rule testrule chain rule chain rulechain outer rule outerrule external sling launchpad externalslinglaunchpad config wst server wstserver rule temporary project temporaryproject project rule projectrule temporary project temporaryproject rule disable debug status handlers disabledebugstatushandlers disable debug handlers disabledebughandlers disable debug status handlers disabledebugstatushandlers rule fail on modification events rule failonmodificationeventsrule deh fail on modification events rule failonmodificationeventsrule rule fail on unsuccessful events rule failonunsuccessfuleventsrule fail on events rule failoneventsrule fail on unsuccessful events rule failonunsuccessfuleventsrule test import files and folders importfilesandfolders exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder repo create node createnode content test root files folder repo create file createfile content test root files txt file get bytes getbytes run import runimport content project contentproject assert that assertthat content project contentproject has folder hasfolder jcr root content test root files assert that assertthat content project contentproject has file hasfile jcr root content test root files txt file get bytes getbytes test import files and folders res pects vlt filters importfilesandfoldersrespectsvltfilters exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder repo create node createnode content test root files folder repo create file createfile content test root files txt file get bytes getbytes deh clear unexpected events after set tling clearunexpectedeventsaftersettling run import runimport content project contentproject assert that assertthat content project contentproject find member findmember jcr root content test root null value nullvalue test import files and folders res pects vlt ignore importfilesandfoldersrespectsvltignore exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root vltignore byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder repo create node createnode content test root files folder repo create file createfile content test root files txt file get bytes getbytes run import runimport content project contentproject assert that assertthat content project contentproject find member findmember jcr root content test root null value nullvalue test import files and folders res pects vlt ignore not under import root importfilesandfoldersrespectsvltignorenotunderimportroot exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content txt byte array input stream bytearrayinputstream get bytes getbytes project create or update file createorupdatefile path from portable string fromportablestring jcr root vltignore byte array input stream bytearrayinputstream content test root get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder repo create node createnode content test root files folder repo create file createfile content test root files txt file get bytes getbytes run import runimport content project contentproject assert that assertthat content project contentproject find member findmember jcr root content test root null value nullvalue run import runimport i project iproject content project contentproject serialization exception serializationexception invocation target exception invocationtargetexception interrupted exception interruptedexception core exception coreexception import repository content action importrepositorycontentaction action import repository content action importrepositorycontentaction wst server wstserver get server getserver path from portable string fromportablestring content test root content project contentproject activator get default getdefault get serialization manager getserializationmanager action null progress monitor nullprogressmonitor test import files with extra nodes under jcr content importfileswithextranodesunderjcrcontent exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content create filter xml project create vlt filter with roots createvltfilterwithroots content test root create sling folder content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root content xml get class getclass get resource as stream getresourceasstream sling folder node type nodetype xml wst server wstserver wait for server to start waitforservertostart server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo try delete resource trydeleteresource content test root repo create node createnode content test root sling folder repo create file createfile content test root file txt get bytes getbytes repo do with session dowithsession session runnable sessionrunnable override do with session dowithsession session session repository exception repositoryexception value factory valuefactory value factory valuefactory session get value factory getvaluefactory node content node contentnode session get node getnode content test root file txt jcr content content node contentnode add mixin addmixin sling chunks node chunk node chunknode content node contentnode add node addnode first chunk firstchunk sling chunk chunk node chunknode set property setproperty sling offset value factory valuefactory create value createvalue chunk node chunknode set property setproperty jcr data value factory valuefactory create value createvalue value factory valuefactory create binary createbinary byte array input stream bytearrayinputstream get bytes getbytes session save assert that assertthat repo get node getnode content test root get primary node type getprimarynodetype get name getname equal to equalto sling folder run import runimport content project contentproject assert that assertthat file properly imported content project contentproject has file hasfile jcr root content test root file txt get bytes getbytes assert that assertthat file extra serialization dir imported content project contentproject has folder hasfolder jcr root content test root file txt dir assert that assertthat file jcr content data serialized content xml content project contentproject has file hasfile jcr root content test root file txt dir content xml assert that assertthat file jcr content extra dir serialized jcr content content project contentproject has folder hasfolder jcr root content test root file txt dir jcr content assert that assertthat chunk dir serialized content project contentproject has folder hasfolder jcr root content test root file txt dir jcr content first chunk firstchunk assert that assertthat chunk properties serialized content project contentproject has file hasfile jcr root content test root file txt dir jcr content first chunk firstchunk content xml assert that assertthat sling folder serialization file deleted content project contentproject has file hasfile jcr root content test root content xml test import full coverage node importfullcoveragenode exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo do with session dowithsession session runnable sessionrunnable override do with session dowithsession session session repository exception repositoryexception node config node confignode session get root node getrootnode add node addnode content test root org apache sling component config sling osgi config osgiconfig config node confignode set property setproperty enabled to string tostring session save run import runimport content project contentproject assert that assertthat content project contentproject has file hasfile jcr root content test root org apache sling component config xml test import deletes no longer present file importdeletesnolongerpresentfile exception create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling create server side content repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder repo create node createnode content test root files folder repo create file createfile content test root files txt file get bytes getbytes repo create file createfile content test root files txt file get bytes getbytes delete file deployed module server repo try delete resource trydeleteresource content test root txt initial run import runimport content project contentproject txt txt assert that assertthat content project contentproject has file hasfile jcr root content test root files txt assert that assertthat content project contentproject has file hasfile jcr root content test root files txt txt repo deleted assert that assertthat content project contentproject has file hasfile jcr root content test root txt test import from repository with nt unstructured node with no properties causes spurious local deletion importfromrepositorywithntunstructurednodewithnopropertiescausesspuriouslocaldeletion exception repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content test root folder create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content wst server wstserver wait for server to start waitforservertostart project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling repo create node createnode content test root folder sling folder repo create node createnode content test root folder jcr content unstructured repo create file createfile content test root folder jcr content file txt dummy contents get bytes getbytes repo do with session dowithsession session runnable sessionrunnable override do with session dowithsession session session repository exception repositoryexception session get root node getrootnode get node getnode content test root folder jcr content file txt jcr content set property setproperty jcr mime type mimetype vendor reserved session save initial run import runimport content project contentproject assert that assertthat content project contentproject has file hasfile jcr root content test root folder jcr content file txt dir content xml run import runimport content project contentproject assert that assertthat content project contentproject has file hasfile jcr root content test root folder jcr content file txt dir content xml test import file with namespace d name importfilewithnamespacedname exception repository accessor repositoryaccessor repo repository accessor repositoryaccessor config create faceted project i project iproject content project contentproject project rule projectrule get project getproject project adapter projectadapter project project adapter projectadapter content project contentproject project add natures addnatures java core javacore nature org eclipse wst common project facet core nature install bundle facet project install facet installfacet sling content project create vlt filter with roots createvltfilterwithroots content test root project create or update file createorupdatefile path from portable string fromportablestring jcr root content test root txt byte array input stream bytearrayinputstream get bytes getbytes wst server wstserver wait for server to start waitforservertostart server adapter serveradapter server server adapter serveradapter wst server wstserver get server getserver server install module installmodule content project contentproject deh clear unexpected events after set tling clearunexpectedeventsaftersettling repo create file createfile content test root sling file content get bytes getbytes run import runimport content project contentproject assert that assertthat content project contentproject has file hasfile jcr root content test root sling file set up setup exception repository accessor repositoryaccessor repo repository accessor repositoryaccessor config repo create node createnode content folder repo create node createnode content test root folder clean up cleanup exception repository accessor repositoryaccessor config try delete resource trydeleteresource content test root
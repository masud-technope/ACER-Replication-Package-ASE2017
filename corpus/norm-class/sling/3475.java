licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core impl java i o exception ioexception java util array list arraylist java util collection java util dictionary java util hash map hashmap java util hashtable java util linked hash map linkedhashmap java util list java util map javax jcr simple credentials simplecredentials javax security login acc ount locked exception accountlockedexception javax security login acc ount not found exception accountnotfoundexception javax security login credential expired exception credentialexpiredexception javax servlet servlet request servletrequest javax servlet servlet request event servletrequestevent javax servlet servlet request listener servletrequestlistener javax servlet http cookie javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations modified org apache felix scr annotations property org apache felix scr annotations property option propertyoption org apache felix scr annotations property unbounded propertyunbounded org apache felix scr annotations reference org apache felix scr annotations reference policy referencepolicy org apache felix scr annotations service org apache sling api sling constants slingconstants org apache sling api authenticator org apache sling api no authentication handler exception noauthenticationhandlerexception org apache sling api resource login exception loginexception org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling core auth constants authconstants org apache sling core auth util authutil org apache sling core authentication support authenticationsupport org apache sling core impl engine engine authentication handler holder engineauthenticationhandlerholder org apache sling core spi abstract authentication handler abstractauthenticationhandler org apache sling core spi authentication feedback handler authenticationfeedbackhandler org apache sling core spi authentication handler authenticationhandler org apache sling core spi authentication info authenticationinfo org apache sling core spi authentication info post processor authenticationinfopostprocessor org apache sling core spi default authentication feedback handler defaultauthenticationfeedbackhandler org apache sling commons osgi osgi util osgiutil org osgi framework all service listener allservicelistener org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service event serviceevent org osgi framework service reference servicereference org osgi framework service registration serviceregistration org osgi service event event org osgi service event event admin eventadmin org osgi service http http context httpcontext org osgi util tracker service tracker servicetracker org slf logger org slf logger factory loggerfactory code sling authenticator slingauthenticator code implementation handling authentication supports support login sessions session ids exc hanged exchanged cookies support multiple authentication handlers implement link authentication handler authenticationhandler support multiple handlers request url component org apache sling engine impl sling authenticator slingauthenticator label description description metatype service authenticator authentication support authenticationsupport servlet request listener servletrequestlistener property constants service vendor apache software foundation sling authenticator slingauthenticator authenticator authentication support authenticationsupport servlet request listener servletrequestlistener log logger log logger factory loggerfactory get logger getlogger sling authenticator slingauthenticator property constants service description string description apache sling request authenticator impersonation cookie string impersonation cookie sling sudo property impersonation cookie string par impersonation cookie sudo cookie impersonation parameter string impersonation parameter sudo property impersonation parameter string par impersonation par sudo parameter allowing anonymous access anonymous allowed property bool value boolvalue anonymous allowed string par anonymous allowed anno nymous annonymous property cardinality string par req auth constants authconstants req uirements requirements property string par anonymous user sling anonymous user todo password type property string par anonymous password sling anonymous password link par http property fully enable built http authentication handler enabled string http enabled enabled link par http property completely disable built http authentication handler disabled string http disabled disabled link par http property enable extra cting extracting credentials http basic authentication header preemptive preemptive mode code request credentials requestcredentials code code drop credentials dropcredentials code methods send response string http preemptive preemptive property http preemptive options property option propertyoption http enabled enabled property option propertyoption http preemptive enabled preemptive property option propertyoption http disabled disabled string par http http realm built http basic authentication handler string realm sling development configuration property realm built http basic authentication handler property realm string par realm http realm request uri suffix expect handled authentication handlers expecting link handle security handlesecurity http servlet request httpservletrequest http servlet response httpservletresponse code code string uri suffix security check form sub mission submission parameter providing password user new password newpassword string par password new password newpassword configuration property empty list request uri suffixes intended handled authentication handlers property uri suffix unbounded property unbounded propertyunbounded array string par uri suffix uri suffix link authentication info authenticationinfo property providing option link org apache sling core spi authentication feedback handler authenticationfeedbackhandler handler called login failure success string info prop feedback handler sling authentication feedback handler authenticationfeedbackhandler reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder auth handler cache authhandlercache path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder access path based holder cache pathbasedholdercache authentication requirement holder authenticationrequirementholder auth required cache authrequiredcache path based holder cache pathbasedholdercache authentication requirement holder authenticationrequirementholder impersonation parameter string sudo parameter name sudoparametername impersonation cookie string sudo cookie name sudocookiename cache control flag cache control cachecontrol configured uri suffices indicating authentication requests req uiring requiring redirects returning code code handle security handlesecurity method code code suffices string auth uri suffices authurisuffices user assume anonymous access code code code code credentials system ide ntification identification get anonymous credentials getanonymouscredentials string anon user anonuser password anonymous access property link anon user anonuser field code code get anonymous credentials getanonymouscredentials anon password anonpassword http basic authentication handler http basic authentication handler httpbasicauthenticationhandler http basic handler httpbasichandler web console plugin service registration service registration serviceregistration web console plugin webconsoleplugin listener services registered sling requirements update internal authentication requirements sling authenticator service listener slingauthenticatorservicelistener service listener servicelistener service tracker servicetracker tracking authentication handler authenticationhandler services service tracker servicetracker auth handler tracker authhandlertracker service tracker servicetracker tracking sling engine authentication handler authenticationhandler services service tracker servicetracker engine auth handler tracker engineauthhandlertracker service tracker servicetracker tracking authentication info post processor authenticationinfopostprocessor services service tracker servicetracker auth info post processor tracker authinfopostprocessortracker event admin service reference policy reference policy referencepolicy dynamic event admin eventadmin event admin eventadmin scr int egration integration suppress warnings suppresswarnings unused activate activate bundle context bundlecontext bundle context bundlecontext map string object properties modified properties authenticator web console plugin authenticatorwebconsoleplugin plugin authenticator web console plugin authenticatorwebconsoleplugin hashtable string object props hashtable string object props felix webconsole label plugin get label getlabel props felix webconsole title plugin get title gettitle props felix webconsole category sling props constants service description sling request authenticator web console webconsole plugin props constants service vendor properties constants service vendor web console plugin webconsoleplugin bundle context bundlecontext register service registerservice javax servlet servlet plugin props service listener servicelistener sling authenticator service listener slingauthenticatorservicelistener create listener createlistener bundle context bundlecontext auth handler tracker authhandlertracker authentication handler tracker authenticationhandlertracker bundle context bundlecontext auth handler cache authhandlercache engine auth handler tracker engineauthhandlertracker engine authentication handler tracker engineauthenticationhandlertracker bundle context bundlecontext auth handler cache authhandlercache auth info post processor tracker authinfopostprocessortracker service tracker servicetracker bundle context bundlecontext authentication info post processor authenticationinfopostprocessor service auth info post processor tracker authinfopostprocessortracker open modified modified map string object properties properties properties hash map hashmap string object string new cookie newcookie string properties par impersonation cookie new cookie newcookie new cookie newcookie length new cookie newcookie impersonation cookie new cookie newcookie equals sudo cookie name sudocookiename log info modified setting cookie impersonation new cookie newcookie sudo cookie name sudocookiename sudo cookie name sudocookiename new cookie newcookie string new par newpar string properties par impersonation par new par newpar new par newpar length new par newpar impersonation parameter new par newpar equals sudo parameter name sudoparametername log info modified setting parameter impersonation new par newpar sudo parameter name sudoparametername sudo parameter name sudoparametername new par newpar auth required cache authrequiredcache clear anon allowed anonallowed osgi util osgiutil to boolean toboolean properties par anonymous allowed anonymous allowed auth required cache authrequiredcache add holder addholder authentication requirement holder authenticationrequirementholder anon allowed anonallowed string auth reqs authreqs osgi util osgiutil to string array tostringarray properties par req auth reqs authreqs string auth req authreq auth reqs authreqs auth req authreq auth req authreq length auth required cache authrequiredcache add holder addholder authentication requirement holder authenticationrequirementholder from config fromconfig auth req authreq string anon user anonuser osgi util osgiutil to string tostring properties par anonymous user anon user anonuser length anon user anonuser anon user anonuser anon password anonpassword osgi util osgiutil to string tostring properties par anonymous password to char array tochararray anon user anonuser anon password anonpassword auth uri suffices authurisuffices osgi util osgiutil to string array tostringarray properties par uri suffix string uri suffix don require authentication login log out logout servlets auth required cache authrequiredcache add holder addholder authentication requirement holder authenticationrequirementholder login servlet loginservlet servlet path auth required cache authrequiredcache add holder addholder authentication requirement holder authenticationrequirementholder log out servlet logoutservlet servlet path add registered services service listener servicelistener service listener servicelistener register services registerservices string http anon allowed anonallowed http osgi util osgiutil to string tostring properties par http http preemptive http http enabled log debug modified anonymous access denied http basic authentication fully enabled http disabled equals http http basic handler httpbasichandler string realm osgi util osgiutil to string tostring properties par realm realm http basic handler httpbasichandler http basic authentication handler httpbasicauthenticationhandler realm http enabled equals http suppress warnings suppresswarnings unused deactivate deactivate bundle context bundlecontext bundle context bundlecontext engine auth handler tracker engineauthhandlertracker engine auth handler tracker engineauthhandlertracker close engine auth handler tracker engineauthhandlertracker auth handler tracker authhandlertracker auth handler tracker authhandlertracker close auth handler tracker authhandlertracker service listener servicelistener bundle context bundlecontext remove service listener removeservicelistener service listener servicelistener service listener servicelistener web console plugin webconsoleplugin web console plugin webconsoleplugin unregister web console plugin webconsoleplugin authentication support authenticationsupport checks authentication contained request check based original request object uri translation place param request request object authentication param response response object send request failure user code code request processing assuming successful authentication code code returned assumed response client request terminated handle security handlesecurity http servlet request httpservletrequest request http servlet response httpservletresponse response session request request handled result servlet container include sling request object session attr sessionattr request get attribute getattribute request attribute resolver session attr sessionattr resource resolver resourceresolver log debug handle security handlesecurity request authenticated session attr sessionattr warn remove existing session log warn handle security handlesecurity over writing overwriting existing resource resolver resourceresolver attribute session attr sessionattr request remove attribute removeattribute request attribute resolver process do handle security dohandlesecurity request response process expect authentication handler expectauthenticationhandler request log warn handle security handlesecurity authentication handler authenticationhandler block request access denied request remove attribute removeattribute authentication handler authenticationhandler failure reason request remove attribute removeattribute authentication handler authenticationhandler failure reason code auth util authutil send invalid sendinvalid request response process do handle security dohandlesecurity http servlet request httpservletrequest request http servlet response httpservletresponse response authentication handlers extract credentials authentication info authenticationinfo auth info authinfo get authentication info getauthenticationinfo request response post process postprocess credentials post process postprocess auth info authinfo request response login exception loginexception handle login failure handleloginfailure request response auth info authinfo check credentials auth info authinfo authentication info authenticationinfo log debug do handle security dohandlesecurity ongoing authentication handler auth info authinfo authentication info authenticationinfo fail log debug do handle security dohandlesecurity credentials valid request authentication auth util authutil set login resource attribute setloginresourceattribute request request getrequesturi do login dologin request response auth info authinfo get auth type getauthtype log debug do handle security dohandlesecurity credentials request anonymous get anonymous resolver getanonymousresolver request response auth info authinfo log debug do handle security dohandlesecurity session auth info authinfo get user getuser get resolver getresolver request response auth info authinfo authenticator requests authentication client returns code code requested request processing terminated request requested request terminated forbidden response response handler handled error handler infrastructure param request request object param response response object send request illegal state exception illegalstateexception response committed no authentication handler exception noauthenticationhandlerexception authentication handler cla ims claims resp onsibility responsibility authenticate request login http servlet request httpservletrequest request http servlet response httpservletresponse response ensure response committed response is committed iscommitted illegal state exception illegalstateexception response committed select path authentication handler selection collection abstract authentication handler holder abstractauthenticationhandlerholder holders array holdersarray auth handler cache authhandlercache find applicable holder findapplicableholder request string path get handler selection path gethandlerselectionpath request holders array holdersarray length collection abstract authentication handler holder abstractauthenticationhandlerholder holder list holderlist holders array holdersarray holder list holderlist abstract authentication handler holder abstractauthenticationhandlerholder holder holder list holderlist path starts with startswith holder path log debug login req uesting requesting authentication handler holder holder request credentials requestcredentials request response i o exception ioexception ioe log error login failed sending authentication request handler holder access for bidden forbidden ioe fall http basic handler http basic handler httpbasichandler http basic handler httpbasichandler request credentials requestcredentials request response handler send authentication request size holders array holdersarray length holders array holdersarray size holders array holdersarray size log info login handler request handlers size no authentication handler exception noauthenticationhandlerexception logs user calling applicable link org apache sling core spi authentication handler authenticationhandler authentication handlers log out logout http servlet request httpservletrequest request http servlet response httpservletresponse response ensure response committed response is committed iscommitted illegal state exception illegalstateexception response committed impersonation dropped set sudo cookie setsudocookie request response authentication info authenticationinfo dummy request get remote user getremoteuser string path get handler selection path gethandlerselectionpath request collection abstract authentication handler holder abstractauthenticationhandlerholder holders array holdersarray auth handler cache authhandlercache find applicable holder findapplicableholder request holders array holdersarray length collection abstract authentication handler holder abstractauthenticationhandlerholder holder set holderset holders array holdersarray holder set holderset abstract authentication handler holder abstractauthenticationhandlerholder holder holder set holderset path starts with startswith holder path log debug log out logout dropping authentication handler holder holder drop credentials dropcredentials request response i o exception ioexception ioe log error log out logout failed dropping authentication handler holder ioe http basic handler httpbasichandler http basic handler httpbasichandler drop credentials dropcredentials request response redirect after log out redirectafterlogout request response servlet request listener servletrequestlistener request initialized requestinitialized servlet request event servletrequestevent sre don care request destroyed requestdestroyed servlet request event servletrequestevent sre servlet request servletrequest request sre get servlet request getservletrequest object resolver attr resolverattr request get attribute getattribute request attribute resolver resolver attr resolverattr resource resolver resourceresolver resource resolver resourceresolver resolver attr resolverattr close request remove attribute removeattribute request attribute resolver web console plugin webconsoleplugin support returns list registered authentication handlers map map string list string get authentication handler getauthenticationhandler list abstract authentication handler holder abstractauthenticationhandlerholder registered holders registeredholders auth handler cache authhandlercache get holders getholders linked hash map linkedhashmap string list string handler map handlermap linked hash map linkedhashmap string list string abstract authentication handler holder abstractauthenticationhandlerholder holder registered holders registeredholders list string provider handler map handlermap holder full path fullpath provider provider array list arraylist string handler map handlermap holder full path fullpath provider provider add holder get provider getprovider http basic handler httpbasichandler list string provider handler map handlermap provider provider array list arraylist string handler map handlermap provider provider add http basic handler httpbasichandler to string tostring handler map handlermap list authentication requirement holder authenticationrequirementholder get authentication requirements getauthenticationrequirements auth required cache authrequiredcache get holders getholders returns user assume requests credentials code code configured anonymous user configured password requested string get anon user name getanonusername anon user anonuser string get sudo cookie name getsudocookiename sudo cookie name sudocookiename string get sudo parameter name getsudoparametername sudo parameter name sudoparametername internal string get path getpath http servlet request httpservletrequest request string builder stringbuilder string builder stringbuilder request get servlet path getservletpath append request get servlet path getservletpath request get path info getpathinfo append request get path info getpathinfo to string tostring authentication info authenticationinfo get authentication info getauthenticationinfo http servlet request httpservletrequest request http servlet response httpservletresponse response path select authenticator sling servlet slingservlet requested info empty assume root sling string path get path getpath request path length path collection abstract authentication handler holder abstractauthenticationhandlerholder local array localarray auth handler cache authhandlercache find applicable holder findapplicableholder request local array localarray length collection abstract authentication handler holder abstractauthenticationhandlerholder local local array localarray local abstract authentication handler holder abstractauthenticationhandlerholder holder local path starts with startswith holder path authentication info authenticationinfo auth info authinfo holder extract credentials extractcredentials request response auth info authinfo add feedback handler info auth info authinfo info prop feedback handler holder get feedback handler getfeedbackhandler auth info authinfo check http basic handler extract header http basic handler httpbasichandler authentication info authenticationinfo auth info authinfo http basic handler httpbasichandler extract credentials extractcredentials request response auth info authinfo auth info authinfo info prop feedback handler http basic handler httpbasichandler auth info authinfo handler request log debug get authentication info getauthenticationinfo handler extract credentials assuming anonymous get anonymous credentials getanonymouscredentials post processors post process postprocess authentication info authenticationinfo info http servlet request httpservletrequest request http servlet response httpservletresponse response login exception loginexception object services auth info post processor tracker authinfopostprocessortracker get services getservices services object service obj serviceobj services authentication info post processor authenticationinfopostprocessor service obj serviceobj post process postprocess info request response acquire resource resolver resourceresolver auth info authinfo code code request processing assuming successful authentication code code returned assumed response client request terminated get resolver getresolver http servlet request httpservletrequest request http servlet response httpservletresponse response authentication info authenticationinfo auth info authinfo prepare feedback handler authentication feedback handler authenticationfeedbackhandler feedback handler feedbackhandler authentication feedback handler authenticationfeedbackhandler auth info authinfo remove info prop feedback handler object send login event sendloginevent auth info authinfo remove auth constants authconstants info login connect handle impersonation handleimpersonation request auth info authinfo handle password change handlepasswordchange request auth info authinfo resource resolver resourceresolver resolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver auth info authinfo imp ers changed imperschanged set sudo cookie setsudocookie request response auth info authinfo send login event sendloginevent post login event postloginevent auth info authinfo provide resource resolver feedback handler request set attribute setattribute request attribute resolver resolver process request processrequest custom feedback handler option redirect feedback handler feedbackhandler process request processrequest feedback handler feedbackhandler authentication succeeded authenticationsucceeded request response auth info authinfo process request processrequest auth util authutil is validate request isvalidaterequest request auth util authutil send valid sendvalid response process request processrequest imp ers changed imperschanged feedback handler feedbackhandler process request processrequest default authentication feedback handler defaultauthenticationfeedbackhandler handle redirect handleredirect request response process request processrequest process required attributes set attributes setattributes resolver auth info authinfo get auth type getauthtype request terminate cleanup resolver close process request processrequest login exception loginexception feedback handler feedbackhandler feedback handler feedbackhandler authentication failed authenticationfailed request response auth info authinfo response is committed iscommitted handle login failure handleloginfailure request response auth info authinfo request expect authentication handler expectauthenticationhandler http servlet request httpservletrequest request auth uri suffices authurisuffices string request uri requesturi request getrequesturi string uri suffix urisuffix auth uri suffices authurisuffices request uri requesturi ends with endswith uri suffix urisuffix acquire anonymous resource resolver resourceresolver get anonymous resolver getanonymousresolver http servlet request httpservletrequest request http servlet response httpservletresponse response authentication info authenticationinfo auth info authinfo request login servlet is anon allowed isanonallowed request resource resolver resourceresolver resolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver auth info authinfo authentication impersonation default authentication feedback handler defaultauthenticationfeedbackhandler handle redirect handleredirect request response request terminated close resolver release resources resolver close attributes processing set attributes setattributes resolver request login exception loginexception handle login failure handleloginfailure request response authentication info authenticationinfo anonymous user anonymous access allowed redirect login servlet log info get anonymous resolver getanonymousresolver anonymous access allowed configuration req uesting requesting credentials do login dologin request response fallback session is anon allowed isanonallowed http servlet request httpservletrequest request string path get path getpath request path length path collection authentication requirement holder authenticationrequirementholder holder set array holdersetarray auth required cache authrequiredcache find applicable holder findapplicableholder request holder set array holdersetarray length collection authentication requirement holder authenticationrequirementholder holders holder set array holdersetarray holders authentication requirement holder authenticationrequirementholder holder holders path starts with startswith holder path holder requires authentication requiresauthentication fallback anonymous allowed aka authentication required returns credentials anonymous resource access anonymous user config ued configued returns link authentication info authenticationinfo instance authentication type code code user password link par anonymous user link par anonymous password configurations user password fields code code authentication info authenticationinfo get anonymous credentials getanonymouscredentials authentication info authenticationinfo info authentication info authenticationinfo anon user anonuser info set user setuser anon user anonuser info set password setpassword anon password anonpassword info handle login failure handleloginfailure http servlet request httpservletrequest request http servlet response httpservletresponse response authentication info authenticationinfo auth info authinfo exception reason string user auth info authinfo get user getuser process request processrequest reason get class getclass get name getname too many sessions exception toomanysessionsexception users send service unavailable log info handle login failure handleloginfailure sessions user reason get message getmessage response send error senderror http servlet response httpservletresponse service unavailable sling authenticator slingauthenticator use rs users i o exception ioexception ioe log error handle login failure handleloginfailure send status client ioe reason login exception loginexception log info handle login failure handleloginfailure unable authenticate user reason get message getmessage is anon allowed isanonallowed request expect authentication handler expectauthenticationhandler request auth util authutil is validate request isvalidaterequest request log debug handle login failure handleloginfailure login exception loginexception anonymous resource fallback get anonymous resolver getanonymousresolver process request processrequest get anonymous resolver getanonymousresolver request response authentication info authenticationinfo request authentication send for bidden forbidden handler request authentication authentication handler authenticationhandler failure reason codes code authentication handler authenticationhandler failure reason codes invalid login string message user password match reason get cause getcause credential expired exception credentialexpiredexception force failure attribute handlers react special circumstance object creds auth info authinfo user jcr credentials creds simple credentials simplecredentials simple credentials simplecredentials creds get attribute getattribute password history exception passwordhistoryexception code authentication handler authenticationhandler failure reason codes password expired password history message password expired password password history code authentication handler authenticationhandler failure reason codes password expired message password expired reason get cause getcause acc ount locked exception accountlockedexception code authentication handler authenticationhandler failure reason codes acc ount account locked message acc ount account locked reason get cause getcause acc ount not found exception accountnotfoundexception code authentication handler authenticationhandler failure reason codes acc ount account message acc ount account preset reason login failure request set attribute setattribute authentication handler authenticationhandler failure reason code code ensure attribute ensureattribute request authentication handler authenticationhandler failure reason message do login dologin request response general problem send internal server error log error handle login failure handleloginfailure unable authenticate user reason response send error senderror http servlet response httpservletresponse internal server error sling authenticator slingauthenticator data access error reason reason get class getclass get simple name getsimplename i o exception ioexception ioe log error handle login failure handleloginfailure send status client ioe process request processrequest request credentials client mechanisms implemented method request credentials validation request link abstract authentication handler abstractauthenticationhandler is validate request isvalidaterequest http servlet request httpservletrequest forbidden response request considered link is browser request isbrowserrequest http servlet request httpservletrequest browser request http basic authentication handler enabled preemptive credentials processing unauthorized response helps implementing http basic authentication webdav clients http basic authentication completely switched forbidden response request considered link is ajax request isajaxrequest http servlet request httpservletrequest ajax request forbidden response simply assume ajax requestor properly handle request credentials graciously link login http servlet request httpservletrequest http servlet response httpservletresponse method called find call authentication handler request credentials client request credentials forbidden response client forbidden response link abstract authentication handler abstractauthenticationhandler reason header link authentication handler authenticationhandler failure reason request attribute description describing reason send response link abstract authentication handler abstractauthenticationhandler send invalid sendinvalid http servlet request httpservletrequest http servlet response httpservletresponse method called method called situations request credentials anonymous login allowed request credentials resource resolver credentials fails selected authentication handler presented credentials valid param request current request param response response send credentials request access denial abstract authentication handler abstractauthenticationhandler is validate request isvalidaterequest http servlet request httpservletrequest is browser request isbrowserrequest http servlet request httpservletrequest is ajax request isajaxrequest http servlet request httpservletrequest abstract authentication handler abstractauthenticationhandler send invalid sendinvalid http servlet request httpservletrequest http servlet response httpservletresponse do login dologin http servlet request httpservletrequest request http servlet response httpservletresponse response auth util authutil is validate request isvalidaterequest request auth util authutil is browser request isbrowserrequest request auth util authutil is ajax request isajaxrequest request is login loop isloginloop request login request response illegal state exception illegalstateexception ise log error do login dologin login response committed no authentication handler exception noauthenticationhandlerexception nahe log error do login dologin login authentication handler authenticationhandler handle request switched http basic handler httpbasichandler http basic handler httpbasichandler send unauthorized sendunauthorized response redirect login form xhr request authentication handler request credentials client failed credential validation ensure failure reason ensure attribute ensureattribute request authentication handler authenticationhandler failure reason authentication failed auth util authutil send invalid sendinvalid request response returns code code current request ref erred referred url current request assumed caused loop req uesting requesting credentials client loop request credentials succeed broken param request request check code code request considered loop code code is login loop isloginloop http servlet request httpservletrequest request string ref erer referer request get header getheader ref erer referer ref erer referer string buffer stringbuffer request getrequesturl request get query string getquerystring append append request get query string getquerystring ref erer referer equals to string tostring ref erer referer loop sets request attribute request attribute code code param request request attribute param attribute attribute check param attribute ensure attribute ensureattribute http servlet request httpservletrequest request string attribute object request get attribute getattribute attribute request set attribute setattribute attribute sets request attributes required o sg i osgi http context httpcontext specification code handle security handlesecurity code method add ition addition link sling authenticator slingauthenticator request attribute resolver request attribute resource resolver resourceresolver set attributes setattributes resource resolver resourceresolver resolver string auth type authtype http servlet request httpservletrequest request http service httpservice api required attributes request set attribute setattribute http context httpcontext remote user resolver get user d getuserid request set attribute setattribute http context httpcontext authentication type auth type authtype resource resolver stream request set attribute setattribute request attribute resolver resolver log debug set attributes setattributes resource resolver resourceresolver stored request attribute user resolver get user d getuserid s ends sends session cookie session age seconds sends version cookie param response link http servlet response httpservletresponse send cookie param user user impersonate quoted cookie param max age maxage maximum age cookie seconds positive values persisted browser number seconds setting age cookie deleted browser negative defines temporary cookie deleted browser exits param path cookie path intended web application context path empty code code root path assuming web application registered root context param owner user originally authenticated request imp ersonating impersonating user send sudo cookie sendsudocookie http servlet response httpservletresponse response string user max age maxage string path string owner string quoted user quoteduser quoted user quoteduser quote cookie value quotecookievalue user illegal argument exception illegalargumentexception iae log error send sudo cookie sendsudocookie failed quote cookie object user sudo cookie name sudocookiename iae get message getmessage quoted user quoteduser cookie cookie cookie sudo cookie name sudocookiename quoted user quoteduser cookie set max age setmaxage max age maxage cookie set path setpath path path length path cookie set comment setcomment owner imp ersonates impersonates user illegal argument exception illegalargumentexception iae response add cookie addcookie cookie cookie header cache control cachecontrol response add header addheader cache control cache cookie handles impersonation based request parameter impersonation link sudo parameter name sudoparametername current setting sudo cookie sudo parameter empty missing current cookie setting impersonation parameter code code current cookie impersonation removed impersonation place request parameter assumed user impersonate param req link http servlet request httpservletrequest option ally optionally sudo parameter param auth info authinfo authentication info code sudo user code property imp ersonator impersonator user handle impersonation handleimpersonation http servlet request httpservletrequest req authentication info authenticationinfo auth info authinfo string current sudo currentsudo get sudo cookie value getsudocookievalue req sudo parameter empty missing setting stored session remove impersonation alt ogether altogether session handle user impersonate user string sudo req get parameter getparameter sudo parameter name sudoparametername sudo sudo length sudo current sudo currentsudo equals sudo sudo sudo session needed sudo sudo length auth info authinfo resource resolver factory resourceresolverfactory user impersonation sudo handles password change based request parameter password link new password parameter name newpasswordparametername password request parameter auth info authinfo object transformed simple credentials simplecredentials attributes param req link http servlet request httpservletrequest option ally optionally password parameter param auth info authinfo authentication info code new password newpassword code property handle password change handlepasswordchange http servlet request httpservletrequest req authentication info authenticationinfo auth info authinfo string new password newpassword req get parameter getparameter par password new password newpassword new password newpassword length auth info authinfo user new password newpassword new password newpassword string get sudo cookie value getsudocookievalue http servlet request httpservletrequest req current impersonation string current sudo currentsudo cookie cookies req get cookies getcookies cookies current sudo currentsudo cookies length sudo cookie name sudocookiename equals cookies get name getname current sudo currentsudo unquote cookie value unquotecookievalue cookies get value getvalue current sudo currentsudo sets impersonation cookie response impersonation changed returns cookie cleared current impersonation sudo cookie desired user impersonation property info don match sudo cookie user impersonation property cookie cleared property code code param req providing current sudo cookie param res setting sudo cookie param auth info authinfo providing desired impersonation code code cookie cleared code code cookie modified set sudo cookie setsudocookie http servlet request httpservletrequest req http servlet response httpservletresponse res authentication info authenticationinfo auth info authinfo string sudo string auth info authinfo resource resolver factory resourceresolverfactory user impersonation string current sudo currentsudo get sudo cookie value getsudocookievalue req impersonation set cookie setcookie sudo current sudo currentsudo set cookie setcookie sudo parameter clear impersonation active cookie setting clear impersonation send sudo cookie sendsudocookie res req get context path getcontextpath auth info authinfo get user getuser current sudo currentsudo current sudo currentsudo equals sudo parameter cookie send cookie current sudo impersonation send sudo cookie sendsudocookie res sudo req get context path getcontextpath sudo set cookie setcookie returns path select authentication handler login log out logout method link authenticator login resource request attribute attribute string request path info empty string returned param request request providing request attribute path info path request attribute path info string get handler selection path gethandlerselectionpath http servlet request httpservletrequest request object login path o loginpatho request get attribute getattribute authenticator login resource string path login path o loginpatho string path string login path o loginpatho string ctx path ctxpath request get context path getcontextpath ctx path ctxpath path starts with startswith ctx path ctxpath path path substring ctx path ctxpath length path request get path info getpathinfo path path length path path response committed redirect target requested code resource code request attribute parameter string request redirected context root response reset handler updated http session cookie param request request providing redirect target param response response send redirect redirect after log out redirectafterlogout http servlet request httpservletrequest request http servlet response httpservletresponse response response committed response is committed iscommitted log debug redirect after log out redirectafterlogout response committed redirecting find redirect target resource attribute parameter falling request context path invalid string target auth util authutil get login resource getloginresource request request get context path getcontextpath auth util authutil is redirect valid isredirectvalid request target log warn redirect after log out redirectafterlogout desired redirect target invalid redirecting target target redirect response send redirect sendredirect request get context path getcontextpath target i o exception ioexception log error failed redirect target post login event postloginevent authentication info authenticationinfo auth info authinfo dictionary string object properties hashtable string object properties sling constants slingconstants property user id userid auth info authinfo get user getuser properties authentication info authenticationinfo type auth info authinfo get auth type getauthtype event admin eventadmin localea event admin eventadmin localea localea post event postevent event auth constants authconstants topic login properties ensures cookie properly quoted tra nsmission transmission client problem character cookie values limited rfc defining cookie token quoted string rfc pre token ctl s ctls separators separators quoted string qdtext quoted pair qdtext text quoted pair param cookie quote quoted cookie illegal argument exception illegalargumentexception cookie code code quoted quote sign string quote cookie value quotecookievalue string illegal argument exception illegalargumentexception cookie string builder stringbuilder builder string builder stringbuilder length builder append length char at charat builder append illegal argument exception illegalargumentexception cookie ctl character builder append builder append builder to string tostring removes optional quotes cookie raw cookie param cookie unquote unquoted cookie string unquote cookie value unquotecookievalue string unmodified empty starting quote length char at charat string builder stringbuilder builder string builder stringbuilder length length char at charat builder append builder to string tostring sling authenticator service listener slingauthenticatorservicelistener all service listener allservicelistener sling authenticator slingauthenticator authenticator hash map hashmap object authentication requirement holder authenticationrequirementholder props hash map hashmap object authentication requirement holder authenticationrequirementholder sling authenticator service listener slingauthenticatorservicelistener create listener createlistener bundle context bundlecontext context sling authenticator slingauthenticator authenticator sling authenticator service listener slingauthenticatorservicelistener listener sling authenticator service listener slingauthenticatorservicelistener authenticator string filter auth constants authconstants req uirements requirements context add service listener addservicelistener listener filter service reference servicereference context get all service references getallservicereferences filter service reference servicereference listener add service addservice listener invalid syntax exception invalidsyntaxexception ise sling authenticator service listener slingauthenticatorservicelistener sling authenticator slingauthenticator authenticator authenticator authenticator service changed servicechanged service event serviceevent event props event get type gettype service event serviceevent modified service event serviceevent unregistering remove service removeservice event get service reference getservicereference event get type gettype service event serviceevent registered service event serviceevent modified add service addservice event get service reference getservicereference register services registerservices authentication requirement holder authenticationrequirementholder auth reqs list authreqslist auth reqs list authreqslist props values to array toarray authentication requirement holder authenticationrequirementholder props size authentication requirement holder authenticationrequirementholder auth reqs authreqs auth reqs list authreqslist register service registerservice auth reqs authreqs register service registerservice authentication requirement holder authenticationrequirementholder auth reqs authreqs authentication requirement holder authenticationrequirementholder auth req authreq auth reqs authreqs authenticator auth required cache authrequiredcache add holder addholder auth req authreq add service addservice service reference servicereference string auth req paths authreqpaths osgi util osgiutil to string array tostringarray get property getproperty par req array list arraylist authentication requirement holder authenticationrequirementholder auth req list authreqlist array list arraylist authentication requirement holder authenticationrequirementholder string auth req authreq auth req paths authreqpaths auth req authreq auth req authreq length auth req list authreqlist add authentication requirement holder authenticationrequirementholder from config fromconfig auth req authreq authentication requirement holder authenticationrequirementholder auth reqs authreqs auth req list authreqlist to array toarray authentication requirement holder authenticationrequirementholder auth req list authreqlist size register service registerservice auth reqs authreqs props get property getproperty constants service auth reqs authreqs remove service removeservice service reference servicereference authentication requirement holder authenticationrequirementholder auth reqs authreqs props remove get property getproperty constants service auth reqs authreqs authentication requirement holder authenticationrequirementholder auth req authreq auth reqs authreqs authenticator auth required cache authrequiredcache remove holder removeholder auth req authreq authentication handler tracker authenticationhandlertracker service tracker servicetracker path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder auth handler cache authhandlercache hash map hashmap object abstract authentication handler holder abstractauthenticationhandlerholder handler map handlermap hash map hashmap object abstract authentication handler holder abstractauthenticationhandlerholder authentication handler tracker authenticationhandlertracker bundle context bundlecontext context path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder auth handler cache authhandlercache context authentication handler authenticationhandler service auth handler cache authhandlercache authentication handler tracker authenticationhandlertracker bundle context bundlecontext context string class name classname path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder auth handler cache authhandlercache context class name classname auth handler cache authhandlercache auth handler cache authhandlercache open override object adding service addingservice service reference servicereference reference object service adding service addingservice reference service bind auth handler bindauthhandler service reference service override modified service modifiedservice service reference servicereference reference object service unbind auth handler unbindauthhandler reference service bind auth handler bindauthhandler service reference override removed service removedservice service reference servicereference reference object service unbind auth handler unbindauthhandler reference removed service removedservice reference service abstract authentication handler holder abstractauthenticationhandlerholder create holder createholder string path object handler service reference servicereference service reference servicereference authentication handler holder authenticationhandlerholder path authentication handler authenticationhandler handler service reference servicereference bind auth handler bindauthhandler object handler service reference servicereference string paths osgi util osgiutil to string array tostringarray get property getproperty authentication handler authenticationhandler path property paths paths length array list arraylist abstract authentication handler holder abstractauthenticationhandlerholder holder list holderlist array list arraylist abstract authentication handler holder abstractauthenticationhandlerholder string path paths path path length holder list holderlist add create holder createholder path handler abstract authentication handler holder abstractauthenticationhandlerholder holders holder list holderlist to array toarray abstract authentication handler holder abstractauthenticationhandlerholder holder list holderlist size abstract authentication handler holder abstractauthenticationhandlerholder holder holders auth handler cache authhandlercache add holder addholder holder handler map handlermap handler map handlermap get property getproperty constants service holders unbind auth handler unbindauthhandler service reference servicereference abstract authentication handler holder abstractauthenticationhandlerholder holders handler map handlermap holders handler map handlermap remove get property getproperty constants service holders abstract authentication handler holder abstractauthenticationhandlerholder holder holders auth handler cache authhandlercache remove holder removeholder holder engine authentication handler tracker engineauthenticationhandlertracker authentication handler tracker authenticationhandlertracker engine authentication handler tracker engineauthenticationhandlertracker bundle context bundlecontext context path based holder cache pathbasedholdercache abstract authentication handler holder abstractauthenticationhandlerholder auth handler cache authhandlercache context org apache sling engine authentication handler authenticationhandler auth handler cache authhandlercache suppress warnings suppresswarnings deprecation override abstract authentication handler holder abstractauthenticationhandlerholder create holder createholder string path object handler service reference servicereference service reference servicereference engine authentication handler holder engineauthenticationhandlerholder path org apache sling engine authentication handler authenticationhandler handler service reference servicereference
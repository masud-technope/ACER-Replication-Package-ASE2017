licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr base java util dictionary javax jcr repository org apache sling jcr api sling repository slingrepository org apache sling service user mapping serviceusermapping service user mapper serviceusermapper org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework service factory servicefactory org osgi framework service registration serviceregistration org slf logger org slf logger factory loggerfactory a qute aqute bnd annotation provider type providertype code abstract sling repository manager abstractslingrepositorymanager code basis controlling jcr repository instances sling manager starts stops actual repository instance manages service registration hands code sling repository slingrepository instances consume rs consumers base controls live cycle livecycle repository instance implementations provide actual int egration integration runtime context live cycle livecycle repository instance defined start repository instance impl emetation implemetation calls link start bundle context bundlecontext string method steps ins tantiating instantiating repository setting registering repository osg i osgi service link acquire repository acquirerepository link create bundle link setup bundle context bundlecontext sling repository slingrepository link register service registerservice repository instance implementation calls link method set ps setps unregistering osg i osgi service tearing special settings shutting repository link unregister service unregisterservice service registration serviceregistration link tear down teardown link destroy abstract sling repository abstractslingrepository link dispose repository disposerepository repository instances manage single repository instance backing osg i osgi service instances consuming bundle service instance backed single actual repository instance managed abstract sling repository abstractslingrepository api version bundle version provider type providertype abstract sling repository manager abstractslingrepositorymanager name space mapping support namespacemappingsupport log logger log logger factory loggerfactory get logger getlogger get class getclass bundle context bundlecontext bundle context bundlecontext repository repository sling repository slingrepository instance setup basic stuff setup tear down teardown abstract sling repository abstractslingrepository master sling repository masterslingrepository service registration serviceregistration repository service repositoryservice string default workspace defaultworkspace disable login administrative disableloginadministrative returns workspace code code meaning repository workspace workspace code indicating repository workspace string get default workspace getdefaultworkspace default workspace defaultworkspace returns disable code sling repository slingrepository login administrative loginadministrative method code code sling repository slingrepository login administrative loginadministrative disabled is disable login administrative isdisableloginadministrative disable login administrative disableloginadministrative returns code service user mapper serviceusermapper service map service service user code service user mapper serviceusermapper implement link abstract sling repository abstractslingrepository login service loginservice string string method replace link abstract sling repository abstractslingrepository login administrative loginadministrative string method method returns code code service user mapper service serviceusermapperservice code login service loginservice method login code service user mapper serviceusermapper service code abstract sling repository abstractslingrepository login service loginservice string string service user mapper serviceusermapper get service user mapper getserviceusermapper creates backing jcr repository instances expected method start repository method code throwable code returns code code repository problems acquire repository caught log ged logged acquired jcr code repository code code code repository acquired start bundle context bundlecontext string repository acquire repository acquirerepository registers component osg i osgi service types link get service registration interfaces getserviceregistrationinterfaces method properties link get service registration properties getserviceregistrationproperties method repository registered osg i osgi code service factory servicefactory link create bundle method called create actual link abstract sling repository abstractslingrepository repository instance calling bundle bundle repository instance link destroy abstract sling repository abstractslingrepository method called clean osg i osgi code service registration serviceregistration code object representing registered service start bundle context bundlecontext string get service registration interfaces getserviceregistrationinterfaces get service registration properties getserviceregistrationproperties create bundle destroy abstract sling repository abstractslingrepository service registration serviceregistration register service registerservice dictionary string object props get service registration properties getserviceregistrationproperties string interfaces get service registration interfaces getserviceregistrationinterfaces bundle context bundlecontext register service registerservice interfaces service factory servicefactory override object get service getservice bundle bundle service registration serviceregistration registration abstract sling repository manager abstractslingrepositorymanager create bundle override unget service ungetservice bundle bundle service registration serviceregistration registration object service abstract sling repository manager abstractslingrepositorymanager destroy abstract sling repository abstractslingrepository service props service registration properties register repository service link register service registerservice service registration properties register repository service link register service registerservice register service registerservice dictionary string object get service registration properties getserviceregistrationproperties returns service types register repository service link register service registerservice interfaces returned accessible loader instance method overwritten additional types types returned base implementation code sling repository slingrepository code repository included service types register repository service link register service registerservice register service registerservice string get service registration interfaces getserviceregistrationinterfaces string sling repository slingrepository get name getname repository get name getname creates instance link abstract sling repository abstractslingrepository implementation code using bundle usingbundle method called repository service requested bundle time method expected instance call param using bundle usingbundle bundle providing repository requested link abstract sling repository abstractslingrepository implementation instance code using bundle usingbundle register service registerservice abstract sling repository abstractslingrepository create bundle using bundle usingbundle cleans link abstract sling repository abstractslingrepository instance created link create bundle method param repository service instance repositoryserviceinstance link abstract sling repository abstractslingrepository istance cleanup register service registerservice destroy abstract sling repository abstractslingrepository repository service instance repositoryserviceinstance returns repository underlying instance code code repository repository repository get repository getrepository repository unregisters service represented code service registration serviceregistration code param service registration serviceregistration service unregister unregister service unregisterservice service registration serviceregistration service registration serviceregistration service registration serviceregistration unregister disposes code repository code param repository repository disposed returned link acquire repository acquirerepository dispose repository disposerepository repository repository scr int egration integration method starts backing repository inst ann ce instannce reg isteres registeres repository service multiple subsequent calls method calling link param bundle context bundlecontext code bundle context bundlecontext register repository service option ally optionally services required operate repository param default workspace defaultworkspace workspace login code actual repository instance define param disable login administrative disableloginadministrative disable code sling repository slingrepository login administrative loginadministrative method code repository started service registered start bundle context bundlecontext bundle context bundlecontext string default workspace defaultworkspace disable login administrative disableloginadministrative setup bundle context bundlecontext log debug start repository started registered bundle context bundlecontext bundle context bundlecontext default workspace defaultworkspace default workspace defaultworkspace disable login administrative disableloginadministrative disable login administrative disableloginadministrative log debug start calling acquire repository acquirerepository repository new repo newrepo acquire repository acquirerepository new repo newrepo ensure repository log debug start repository repository new repo newrepo master sling repository masterslingrepository create bundle context bundlecontext get bundle getbundle log debug start setting name space mapping namespacemapping support setup bundle context bundlecontext master sling repository masterslingrepository log debug start calling register service registerservice repository service repositoryservice register service registerservice log debug start register service registerservice successful registration repository service repositoryservice throwable log error start uncaught throwable access repository calling stop repository stoprepository fallback failure start repository method called overwritten implementations ensure repository disposed repository repository service repositoryservice log info repository running for cing forcing shutdown repository service repositoryservice log debug unregistering sling repository slingrepository service registration repository service repositoryservice unregister service unregisterservice repository service repositoryservice throwable log info uncaught problem unregistering repository service repository service repositoryservice repository repository old repo oldrepo repository repository namespace support tear down teardown destroy master sling repository masterslingrepository dispose repository disposerepository old repo oldrepo throwable log info uncaught problem disposing repository throwable log warn unexpected problem stop ping stopping repository repository service repositoryservice repository default workspace defaultworkspace bundle context bundlecontext
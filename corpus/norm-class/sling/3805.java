licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr content loader contentloader internal java text parse exception parseexception java util javax jcr javax jcr node type nodetype node type nodetype junit x junitx util private accessor privateaccessor org apache sling commons testing jcr repository provider repositoryprovider org apache sling jcr api sling repository slingrepository org apache sling jcr content loader contentloader content import listener contentimportlistener org apache sling jcr content loader contentloader content reader contentreader org jmock expectations org jmock mockery org jmock int egration integration junit j unit junit mockery org junit org junit org junit rule org junit test org junit rules expected exception expectedexception org junit default content creator test defaultcontentcreatortest string mockery mockery j unit junit mockery default content creator defaultcontentcreator content creator contentcreator session session node parent node parentnode property prop rule expected exception expectedexception thrown expected exception expectedexception setup exception sling repository slingrepository repo repository provider repositoryprovider instance get repository getrepository session repo login administrative loginadministrative content creator contentcreator default content creator defaultcontentcreator content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader parent node parentnode session get root node getrootnode add node addnode get class getclass get simple name getsimplename add node addnode unique id uniqueid cleanup repository exception repositoryexception session session save session log out logout session test will rewrite undefined property type willrewriteundefinedpropertytype repository exception repositoryexception parent node parentnode mockery mock node prop mockery mock property content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode mockery checking expectations allowing parent node parentnode is node type isnodetype mix version able versionable return value returnvalue allowing parent node parentnode get parent getparent return value returnvalue one of oneof parent node parentnode has property hasproperty foo return value returnvalue one of oneof parent node parentnode set property setproperty equal foo equal bar content creator contentcreator create property createproperty foo property type propertytype undefined bar test will not rewrite undefined property type willnotrewriteundefinedpropertytype repository exception repositoryexception parent node parentnode mockery mock node prop mockery mock property content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode mockery checking expectations one of oneof parent node parentnode has property hasproperty foo return value returnvalue one of oneof parent node parentnode get property getproperty foo return value returnvalue prop one of oneof prop is new isnew return value returnvalue content creator contentcreator create property createproperty foo property type propertytype undefined bar test test does not create property testdoesnotcreateproperty repository exception repositoryexception string property name propertyname foo prop mockery mock property parent node parentnode mockery mock node mockery checking expectations one of oneof parent node parentnode has property hasproperty property name propertyname return value returnvalue one of oneof parent node parentnode get property getproperty property name propertyname return value returnvalue prop one of oneof prop is new isnew return value returnvalue content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode calling method expect returns statement content creator contentcreator create property createproperty foo property type propertytype reference bar checking mockery assert is satisfied assertissatisfied test test create reference property testcreatereferenceproperty repository exception repositoryexception string property name propertyname foo string property value propertyvalue bar string root node name rootnodename unique id uniqueid string uuid session session mockery mock session content import listener contentimportlistener listener mockery mock content import listener contentimportlistener parent node parentnode mockery mock node prop mockery mock property mockery checking expectations one of oneof session item exists itemexists string return value returnvalue one of oneof session get item getitem string return value returnvalue parent node parentnode parent node parentnode get path getpath return value returnvalue root node name rootnodename one of oneof parent node parentnode is node isnode return value returnvalue one of oneof parent node parentnode is node type isnodetype mix reference able referenceable return value returnvalue one of oneof parent node parentnode getuuid return value returnvalue uuid one of oneof parent node parentnode get session getsession return value returnvalue session one of oneof parent node parentnode has property hasproperty string one of oneof parent node parentnode set property setproperty property name propertyname uuid property type propertytype reference one of oneof parent node parentnode get property getproperty string one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty property name propertyname property type propertytype reference property value propertyvalue test method check numbers methods calls mockery assert is satisfied assertissatisfied test test create false checked out preperty testcreatefalsecheckedoutpreperty repository exception repositoryexception parent node parentnode mockery mock node mockery checking expectations one of oneof parent node parentnode has property hasproperty string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode number of version ables nodes numberofversionablesnodes content creator contentcreator get version ables getversionables size content creator contentcreator create property createproperty jcr is checked out ischeckedout property type propertytype undefined checking list version ables versionables changed assert equals assertequals number of version ables nodes numberofversionablesnodes content creator contentcreator get version ables getversionables size mockery assert is satisfied assertissatisfied test test create true checked out preperty testcreatetruecheckedoutpreperty repository exception repositoryexception parent node parentnode mockery mock node mockery checking expectations one of oneof parent node parentnode has property hasproperty string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode number of version ables nodes numberofversionablesnodes content creator contentcreator get version ables getversionables size content creator contentcreator create property createproperty jcr is checked out ischeckedout property type propertytype undefined checking list version ables versionables doesn changed assert equals assertequals number of version ables nodes numberofversionablesnodes content creator contentcreator get version ables getversionables size mockery assert is satisfied assertissatisfied test test create date property testcreatedateproperty repository exception repositoryexception parse exception parseexception string property name propertyname date prop dateprop string property value propertyvalue content import listener contentimportlistener listener mockery mock content import listener contentimportlistener parent node parentnode mockery mock node prop mockery mock property mockery checking expectations one of oneof parent node parentnode has property hasproperty string one of oneof parent node parentnode set property setproperty string calendar one of oneof parent node parentnode get property getproperty string return value returnvalue prop one of oneof prop get path getpath return value returnvalue one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty property name propertyname property type propertytype property value propertyvalue mockery assert is satisfied assertissatisfied test test create property with new property type testcreatepropertywithnewpropertytype repository exception repositoryexception parse exception parseexception string property name propertyname foo string property value propertyvalue bar integer property type propertytype content import listener contentimportlistener listener mockery mock content import listener contentimportlistener parent node parentnode mockery mock node prop mockery mock property mockery checking expectations one of oneof parent node parentnode has property hasproperty string one of oneof parent node parentnode get property getproperty property name propertyname return value returnvalue prop one of oneof parent node parentnode set property setproperty property name propertyname property value propertyvalue property type propertytype one of oneof prop get path getpath return value returnvalue one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty property name propertyname property type propertytype property value propertyvalue mockery assert is satisfied assertissatisfied default content creator defaultcontentcreator create node createnode string string primary node type primarynodetype string mixin node types mixinnodetypes test create node without name and two in stack createnodewithoutnameandtwoinstack repository exception repositoryexception content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader making parent node stack parentnodestack size content creator contentcreator prepare parsing prepareparsing parent node parentnode making parent node stack parentnodestack size content creator contentcreator create node createnode unique id uniqueid thrown expect repository exception repositoryexception content creator contentcreator create node createnode test create node without provided names createnodewithoutprovidednames repository exception repositoryexception no such field exception nosuchfieldexception stack nodes stack nodesstack stack private accessor privateaccessor get field getfield content creator contentcreator parent node stack parentnodestack content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode parent node parentnode assert equals assertequals nodes stack nodesstack size content creator contentcreator create node createnode node created assert equals assertequals nodes stack nodesstack size test create node with overwrite createnodewithoverwrite repository exception repositoryexception string new node name newnodename unique id uniqueid string property name propertyname unique id uniqueid string property value propertyvalue unique id uniqueid content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode node node to overwrite nodetooverwrite parent node parentnode add node addnode new node name newnodename node to overwrite nodetooverwrite set property setproperty property name propertyname property value propertyvalue assert true asserttrue parent node parentnode get node getnode new node name newnodename has property hasproperty property name propertyname content creator contentcreator create node createnode new node name newnodename node overwritten expect property assert false assertfalse parent node parentnode get node getnode new node name newnodename has property hasproperty property name propertyname mockery assert is satisfied assertissatisfied test add mixins to existing node addmixinstoexistingnode repository exception repositoryexception no such field exception nosuchfieldexception string new node name newnodename unique id uniqueid string mixins mix version able versionable list node version ables versionables list node private accessor privateaccessor get field getfield content creator contentcreator version ables versionables content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode node new node newnode parent node parentnode add node addnode new node name newnodename assert equals assertequals version ables versionables size assert false assertfalse new node newnode is node type isnodetype mixins content creator contentcreator create node createnode new node name newnodename mixins assert equals assertequals version ables versionables size assert true asserttrue new node newnode is node type isnodetype mixins test create node with primary type createnodewithprimarytype repository exception repositoryexception string new node name newnodename unique id uniqueid list string created nodes creatednodes array list arraylist string content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader created nodes creatednodes listener content creator contentcreator prepare parsing prepareparsing parent node parentnode created nodes size creatednodessize created nodes creatednodes size content creator contentcreator create node createnode new node name newnodename node type nodetype unstructured assert equals assertequals created nodes size creatednodessize created nodes creatednodes size node created node creatednode parent node parentnode get node getnode new node name newnodename assert not null assertnotnull created node creatednode assert true asserttrue created node creatednode get primary node type getprimarynodetype is node type isnodetype node type nodetype unstructured mockery assert is satisfied assertissatisfied default content creator defaultcontentcreator create property createproperty string property type propertytype string values test property doesn t over written propertydoesntoverwritten repository exception repositoryexception string new property name newpropertyname unique id uniqueid string new property value newpropertyvalue unique id uniqueid content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode parent node parentnode set property setproperty new property name newpropertyname new property value newpropertyvalue session save content creator contentcreator create property createproperty new property name newpropertyname property type propertytype reference string bar bar checking property assert true asserttrue parent node parentnode get property getproperty new property name newpropertyname is new isnew assert equals assertequals new property value newpropertyvalue parent node parentnode get property getproperty new property name newpropertyname get string getstring test create reference property createreferenceproperty repository exception repositoryexception no such field exception nosuchfieldexception string prop name propname unique id uniqueid string prop values propvalues unique id uniqueid unique id uniqueid content import listener contentimportlistener listener mockery mock content import listener contentimportlistener map string string delayed multiple references delayedmultiplereferences map string string private accessor privateaccessor get field getfield content creator contentcreator delayed multiple references delayedmultiplereferences mockery checking expectations one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty prop name propname property type propertytype reference prop values propvalues assert true asserttrue parent node parentnode has property hasproperty prop name propname assert true asserttrue parent node parentnode get property getproperty prop name propname is new isnew string references key referenceskey parent node parentnode get path getpath prop name propname string uuids or paths uuidsorpaths delayed multiple references delayedmultiplereferences references key referenceskey assert not null assertnotnull uuids or paths uuidsorpaths assert equals assertequals prop values propvalues length uuids or paths uuidsorpaths length mockery assert is satisfied assertissatisfied test create date property createdateproperty repository exception repositoryexception parse exception parseexception string prop name propname date prop dateprop string prop values propvalues content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations one of oneof listener on create oncreate string parent node parentnode add mixin addmixin mix version able versionable content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode assert false assertfalse parent node parentnode has property hasproperty prop name propname content creator contentcreator create property createproperty prop name propname property type propertytype prop values propvalues assert true asserttrue parent node parentnode has property hasproperty prop name propname property date prop dateprop parent node parentnode get property getproperty prop name propname assert true asserttrue date prop dateprop is new isnew assert equals assertequals prop values propvalues length date prop dateprop get values getvalues length mockery assert is satisfied assertissatisfied test create undefined property createundefinedproperty repository exception repositoryexception string prop name propname unique id uniqueid content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations one of oneof listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode assert false assertfalse parent node parentnode has property hasproperty prop name propname content creator contentcreator create property createproperty prop name propname property type propertytype undefined string assert true asserttrue parent node parentnode has property hasproperty prop name propname mockery assert is satisfied assertissatisfied test create other property createotherproperty repository exception repositoryexception string prop name propname unique id uniqueid content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode assert false assertfalse parent node parentnode has property hasproperty prop name propname content creator contentcreator create property createproperty prop name propname property type propertytype string string assert true asserttrue parent node parentnode has property hasproperty prop name propname default content creator defaultcontentcreator finish node finishnode test finish node with multiple property finishnodewithmultipleproperty repository exception repositoryexception no such field exception nosuchfieldexception string prop name propname unique id uniqueid string under test node name undertestnodename unique id uniqueid map string list string delayed multiple references delayedmultiplereferences map string list string private accessor privateaccessor get field getfield content creator contentcreator delayed multiple references delayedmultiplereferences content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty prop name propname property type propertytype reference string under test node name undertestnodename content creator contentcreator create node createnode under test node name undertestnodename assert equals assertequals delayed multiple references delayedmultiplereferences size node under test undertest parent node parentnode get node getnode under test node name undertestnodename under test undertest add mixin addmixin mix reference able referenceable content creator contentcreator finish node finishnode assert equals assertequals delayed multiple references delayedmultiplereferences size mockery assert is satisfied assertissatisfied test finish node with single property finishnodewithsingleproperty repository exception repositoryexception no such field exception nosuchfieldexception string prop name propname unique id uniqueid string under test node name undertestnodename unique id uniqueid content import listener contentimportlistener listener mockery mock content import listener contentimportlistener mockery checking expectations listener on create oncreate string content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader listener content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty prop name propname property type propertytype reference under test node name undertestnodename content creator contentcreator create node createnode under test node name undertestnodename node under test undertest parent node parentnode get node getnode under test node name undertestnodename under test undertest add mixin addmixin mix reference able referenceable content creator contentcreator finish node finishnode assert equals assertequals under test undertest getuuid parent node parentnode get property getproperty prop name propname get string getstring mockery assert is satisfied assertissatisfied test finish node without properties finishnodewithoutproperties repository exception repositoryexception no such field exception nosuchfieldexception string prop name propname unique id uniqueid string under test node name undertestnodename unique id uniqueid content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty prop name propname property type propertytype undefined under test node name undertestnodename content creator contentcreator create node createnode under test node name undertestnodename content creator contentcreator finish node finishnode assert equals assertequals under test node name undertestnodename parent node parentnode get property getproperty prop name propname get string getstring test finish not reference able node finishnotreferenceablenode repository exception repositoryexception no such field exception nosuchfieldexception string prop name propname unique id uniqueid string under test node name undertestnodename unique id uniqueid content creator contentcreator init import options factory importoptionsfactory create import options createimportoptions hash map hashmap string content reader contentreader content creator contentcreator prepare parsing prepareparsing parent node parentnode content creator contentcreator create property createproperty prop name propname property type propertytype reference under test node name undertestnodename content creator contentcreator create node createnode under test node name undertestnodename content creator contentcreator finish node finishnode doesn reference able referenceable mixin assert false assertfalse parent node parentnode has property hasproperty prop name propname string unique id uniqueid get class getclass get simple name getsimplename uuid randomuuid
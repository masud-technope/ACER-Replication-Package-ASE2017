licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event impl jobs java util array list arraylist java util calendar java util collection java util hash map hashmap java util iterator java util list java util map org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations reference org apache felix scr annotations service org apache jackrabbit util iso org apache sling api sling constants slingconstants org apache sling api resource login exception loginexception org apache sling api resource persistence exception persistenceexception org apache sling api resource query syntax exception querysyntaxexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling commons scheduler scheduler org apache sling commons threads thread pool manager threadpoolmanager org apache sling event impl jobs config job manager configuration jobmanagerconfiguration org apache sling event impl jobs config queue configuration manager queueconfigurationmanager queue info queueinfo org apache sling event impl jobs config topology capabilities topologycapabilities org apache sling event impl jobs not ifications notifications notification utility notificationutility org apache sling event impl jobs queues job queue impl jobqueueimpl org apache sling event impl jobs queues queue manager queuemanager org apache sling event impl jobs scheduling job scheduler impl jobschedulerimpl org apache sling event impl jobs stats statistics manager statisticsmanager org apache sling event impl jobs tasks clean up task cleanuptask org apache sling event impl support environment org apache sling event impl support resource helper resourcehelper org apache sling event jobs job org apache sling event jobs job job state jobstate org apache sling event jobs job builder jobbuilder org apache sling event jobs job manager jobmanager org apache sling event jobs notification constants notificationconstants org apache sling event jobs queue org apache sling event jobs scheduled job info scheduledjobinfo org apache sling event jobs statistics org apache sling event jobs topic statistics topicstatistics org apache sling event jobs jmx queuesmbean org osgi service event event org osgi service event event admin eventadmin org osgi service event event constants eventconstants org osgi service event event handler eventhandler org slf logger org slf logger factory loggerfactory implementation job manager component service job manager jobmanager event handler eventhandler runnable properties property scheduler period long value longvalue property scheduler concurrent bool value boolvalue property event constants eventconstants event topic sling constants slingconstants topic resource sling constants slingconstants topic resource changed sling constants slingconstants topic resource removed resource helper resourcehelper bundle event started resource helper resourcehelper bundle event updated job manager impl jobmanagerimpl job manager jobmanager event handler eventhandler runnable logger logger logger logger factory loggerfactory get logger getlogger get class getclass reference event admin eventadmin event admin eventadmin reference scheduler scheduler reference job consumer manager jobconsumermanager job consumer manager jobconsumermanager reference queuesmbean queuesmbean reference thread pool manager threadpoolmanager thread pool manager threadpoolmanager job manager configuration reference job manager configuration jobmanagerconfiguration configuration reference statistics manager statisticsmanager statistics manager statisticsmanager reference queue manager queuemanager q manager qmanager clean up task cleanuptask main tenance task maintenancetask job scheduler org apache sling event impl jobs scheduling job scheduler impl jobschedulerimpl job scheduler jobscheduler activate component param props configuration properties activate activate map string object props login exception loginexception job scheduler jobscheduler org apache sling event impl jobs scheduling job scheduler impl jobschedulerimpl configuration scheduler main tenance task maintenancetask clean up task cleanuptask configuration job scheduler jobscheduler logger info apache sling job manager started instance environment application deactivate component deactivate deactivate logger debug apache sling job manager stop ping stopping instance environment application job scheduler jobscheduler deactivate main tenance task maintenancetask logger info apache sling job manager stopped instance environment application method invoked per iodically periodically scheduler configuration minute java lang runnable override invoke main tenance maintenance task clean up task cleanuptask task main tenance task maintenancetask task task org osgi service event event handler eventhandler handle event handleevent org osgi service event event override handle event handleevent event event job scheduler jobscheduler handle event handleevent event internal statistics object org apache sling event jobs job manager jobmanager get statistics getstatistics override statistics get statistics getstatistics statistics manager statisticsmanager get global statistics getglobalstatistics org apache sling event jobs job manager jobmanager get topic statistics gettopicstatistics override iterable topic statistics topicstatistics get topic statistics gettopicstatistics statistics manager statisticsmanager get topic statistics gettopicstatistics values org apache sling event jobs job manager jobmanager get queue getqueue java lang string override queue get queue getqueue string q manager qmanager get queue getqueue resource helper resourcehelper filter queue name filterqueuename org apache sling event jobs job manager jobmanager get queues getqueues override iterable queue get queues getqueues q manager qmanager get queues getqueues remove job job storage area removed moved storage area internal remove job by id internalremovejobbyid string job id jobid force remove forceremove logger debug remove job job id jobid result job impl jobimpl job job impl jobimpl get job by id getjobbyid job id jobid job logger is debug enabled isdebugenabled logger debug removal job utility to string tostring job job impl jobimpl retry job retryjob job impl jobimpl configuration get job from retry list getjobfromretrylist job id jobid retry job retryjob job retry job retryjob running force remove forceremove job get processing started getprocessingstarted logger is debug enabled isdebugenabled logger debug unable remove job job started utility to string tostring job result is history job ishistoryjob configuration is storage path isstoragepath job get resource path getresourcepath history job simply remove move history is history job ishistoryjob resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver resource job resource jobresource resolver get resource getresource job get resource path getresourcepath job resource jobresource resolver delete job resource jobresource resolver commit logger debug removed job job id jobid logger debug unable remove job resource removed job id jobid notification utility notificationutility send notification sendnotification event admin eventadmin notification constants notificationconstants topic job removed job persistence exception persistenceexception logger warn unable remove job job get resource path getresourcepath result resolver close job handler jobhandler job handler jobhandler job configuration finished job job state jobstate dropped configuration get audit logger getauditlogger debug remove job id jobid logger debug job removal exist job id jobid result org apache sling event jobs job manager jobmanager add job addjob java lang string java util map override job add job addjob string topic map string object properties add job addjob topic properties org apache sling event jobs job manager jobmanager get job by id getjobbyid java lang string override job get job by id getjobbyid string logger debug job resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver string builder stringbuilder buf string builder stringbuilder buf append jcr root buf append configuration get jobs base path with slash getjobsbasepathwithslash buf append element buf append resource helper resourcehelper resource type job buf append buf append resource helper resourcehelper property job buf append buf append buf append logger is debug enabled isdebugenabled logger debug exc euting exceuting query buf to string tostring iterator resource result resolver find resources findresources buf to string tostring xpath result has next hasnext resource job resource jobresource result sanity check path configuration is job isjob job resource jobresource get path getpath job impl jobimpl job utility read job readjob logger job resource jobresource job logger is debug enabled isdebugenabled logger debug job utility to string tostring job job query syntax exception querysyntaxexception qse logger warn query syntax wrong buf to string tostring qse resolver close logger debug job org apache sling event jobs job manager jobmanager get job getjob java lang string java util map suppress warnings suppresswarnings unchecked override job get job getjob string topic map string object template iterable job iter template iter find jobs findjobs query type querytype topic map string object iter find jobs findjobs query type querytype topic template iterator job iter iterator has next hasnext org apache sling event jobs job manager jobmanager remove job by id removejobbyid java lang string override remove job by id removejobbyid string job id jobid internal remove job by id internalremovejobbyid job id jobid enum operation equals equals greater equals greater org apache sling event jobs job manager jobmanager find jobs findjobs org apache sling event jobs job manager jobmanager query type querytype java lang string java util map override collection job find jobs findjobs query type querytype type string topic limit map string object templates is history query ishistoryquery type query type querytype history type query type querytype succeeded type query type querytype cancelled type query type querytype dropped type query type querytype error type query type querytype type query type querytype stopped list job result array list arraylist job resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver string builder stringbuilder buf string builder stringbuilder buf append jcr root buf append configuration get jobs base path with slash getjobsbasepathwithslash buf append element buf append resource helper resourcehelper resource type job buf append buf append iso encode resource helper resourcehelper property job topic topic buf append buf append topic buf append rest ricting restricting type history unfinished is history query ishistoryquery buf append buf append iso encode job impl jobimpl property finished type query type querytype succeeded type query type querytype dropped type query type querytype error type query type querytype type query type querytype stopped buf append buf append type buf append type query type querytype cancelled buf append buf append iso encode job impl jobimpl property finished buf append buf append query type querytype dropped buf append buf append iso encode job impl jobimpl property finished buf append buf append query type querytype error buf append buf append iso encode job impl jobimpl property finished buf append buf append query type querytype buf append buf append iso encode job impl jobimpl property finished buf append buf append query type querytype stopped buf append buf append buf append iso encode job impl jobimpl property finished buf append type query type querytype active buf append buf append iso encode job property job started time type query type querytype queued buf append buf append iso encode job property job started time buf append templates templates length map string object template templates skip empty templates template size buf append buf append buf append iterator map entry string object template entry set entryset iterator has next hasnext map entry string object current string key iso encode current get key getkey first char firstchar key length key char at charat string prop name propname operation first char firstchar prop name propname key substring operation equals first char firstchar second char secondchar key length key char at charat second char secondchar operation equals prop name propname key substring operation prop name propname key substring first char firstchar second char secondchar key length key char at charat second char secondchar operation greater equals prop name propname key substring operation greater prop name propname key substring prop name propname key operation equals buf append buf append buf append prop name propname buf append equals buf append buf append equals buf append greater buf append greater equals buf append buf append buf append current get value getvalue buf append buf append buf append buf append order is history query ishistoryquery buf append job impl jobimpl property finished buf append desc ending descending buf append job property job created buf append ascending iterator resource iter resolver find resources findresources buf to string tostring xpath count iter has next hasnext limit count limit resource job resource jobresource iter sanity check path configuration is job isjob job resource jobresource get path getpath job impl jobimpl job utility read job readjob logger job resource jobresource job count result add job query syntax exception querysyntaxexception qse logger warn query syntax wrong buf to string tostring qse resolver close result per sist persist job resource tree param job topic jobtopic required job topic param job name jobname optional job param passed job properties passedjobproperties optional job properties persisted job code code job add job int eral addjobinteral string job topic jobtopic map string object job properties jobproperties list string errors queue info queueinfo info configuration get queue configuration manager getqueueconfigurationmanager get queue info getqueueinfo job topic jobtopic topology capabilities topologycapabilities caps configuration get topology capabilities gettopologycapabilities info target id targetid caps caps detect target detecttarget job topic jobtopic job properties jobproperties info logger is debug enabled isdebugenabled info target id targetid logger debug per sisting persisting job queue target object utility to string tostring job topic jobtopic job properties jobproperties info queue name queuename info target id targetid logger debug per sisting persisting job queue utility to string tostring job topic jobtopic job properties jobproperties info queue name queuename resource resolver resourceresolver resolver configuration create resource resolver createresourceresolver job impl jobimpl job write job writejob resolver job topic jobtopic job properties jobproperties info info target id targetid configuration get audit logger getauditlogger debug assign info target id targetid job get id getid configuration get audit logger getauditlogger debug unassign job get id getid job persistence exception persistenceexception logger error exception per sisting persisting job utility to string tostring job topic jobtopic job properties jobproperties resolver close errors errors add unable persist job write job resource tree param resolver resolver resolver param event event param info queue queue persistence exception persistenceexception job impl jobimpl write job writejob resource resolver resourceresolver resolver string job topic jobtopic map string object job properties jobproperties queue info queueinfo info persistence exception persistenceexception string job id jobid configuration get unique id getuniqueid job topic jobtopic string path configuration get unique path getuniquepath info target id targetid job topic jobtopic job id jobid job properties jobproperties create properties map string object properties hash map hashmap string object job properties jobproperties map entry string object entry job properties jobproperties entry set entryset string prop name propname entry get key getkey resource helper resourcehelper ignore property ignoreproperty prop name propname properties prop name propname entry get value getvalue properties resource helper resourcehelper property job job id jobid properties resource helper resourcehelper property job topic job topic jobtopic properties job property job queue info queue configuration queueconfiguration get name getname properties job property job retry count properties job property job retries info queue configuration queueconfiguration get max retries getmaxretries properties job property job created calendar get instance getinstance properties job impl jobimpl property job queued calendar get instance getinstance properties job property job created instance environment application info target id targetid properties job property job target instance info target id targetid properties remove job property job target instance create path resource properties resource resolver resourceresolver property resource type resource helper resourcehelper resource type job logger is debug enabled isdebugenabled logger debug storing job utility to string tostring job topic jobtopic properties path resource helper resourcehelper get or create resource getorcreateresource resolver path properties update property types priority add path create job properties job impl jobimpl property resource path path job impl jobimpl job topic jobtopic job id jobid properties org apache sling event jobs job manager jobmanager stop job by id stopjobbyid java lang string override stop job by id stopjobbyid string job id jobid stop job by id stopjobbyid job id jobid stop job by id stopjobbyid string job id jobid job impl jobimpl job job impl jobimpl get job by id getjobbyid job id jobid job configuration is storage path isstoragepath job get resource path getresourcepath queue configuration queue info queueinfo queue info queueinfo configuration get queue configuration manager getqueueconfigurationmanager get queue info getqueueinfo job get topic gettopic job queue impl jobqueueimpl queue job queue impl jobqueueimpl q manager qmanager get queue getqueue queue info queueinfo queue name queuename stopped queue stopped queue stop job stopjob job stopped mark job stopped job handler jobhandler job handler jobhandler job configuration finished job state jobstate stopped org apache sling event jobs job manager jobmanager create job createjob java lang string override job builder jobbuilder create job createjob string topic job builder impl jobbuilderimpl topic org apache sling event jobs job manager jobmanager get scheduled jobs getscheduledjobs override collection scheduled job info scheduledjobinfo get scheduled jobs getscheduledjobs job scheduler jobscheduler get scheduled jobs getscheduledjobs map string object org apache sling event jobs job manager jobmanager get scheduled jobs getscheduledjobs override collection scheduled job info scheduledjobinfo get scheduled jobs getscheduledjobs string topic limit map string object templates job scheduler jobscheduler get scheduled jobs getscheduledjobs topic limit templates internal method add job job add job addjob string topic map string object properties list string errors string error message errormessage utility check job checkjob topic properties error message errormessage logger warn error message errormessage errors errors add error message errormessage configuration get audit logger getauditlogger debug add failed topic properties object topic properties error message errormessage list string error list errorlist array list arraylist string job result add job int eral addjobinteral topic properties error list errorlist errors errors add all addall error list errorlist result configuration get audit logger getauditlogger debug add failed topic properties object topic properties error list errorlist configuration get audit logger getauditlogger debug add topic properties object topic properties result get id getid result org apache sling event jobs job manager jobmanager retry job by id retryjobbyid java lang string override job retry job by id retryjobbyid string job id jobid job impl jobimpl job job impl jobimpl get job by id getjobbyid job id jobid job configuration is storage path isstoragepath job get resource path getresourcepath internal remove job by id internalremovejobbyid job id jobid add job addjob job get topic gettopic job get properties getproperties job scheduler impl jobschedulerimpl get job scheduler getjobscheduler job scheduler jobscheduler
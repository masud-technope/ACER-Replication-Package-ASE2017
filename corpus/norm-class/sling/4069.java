licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest org junit assert equals assertequals org junit fail java file java file input stream fileinputstream java net uri java net uri syntax exception urisyntaxexception java net url java util array list arraylist java util collection java util list org apache sling launchpad webapp int egrationtest integrationtest util server side test client serversidetestclient org code haus codehaus plexus util expand org junit org junit org junit test org junit runner run with runwith org junit run ners runners parameterized org junit run ners runners parameterized parameters org slf logger org slf logger factory loggerfactory execute server side test scripts resource folder run with runwith parameterized server side scripts test serversidescriptstest script directory string test script dir scripts sling script directory assumed fail scripting tests string test script dir fail scripts sling expected fail resource type prefix uploaded test script folder string resource type prefix testing sling scr ipted scripted tests logger logger logger logger factory loggerfactory get logger getlogger get class getclass definition file test script file testscriptfile string test name testname string script extension scriptextension will fail willfail definition file file will fail willfail string file get name getname pos last index of lastindexof script extension scriptextension substring pos string prefix will fail willfail fail test name testname prefix substring pos test script file testscriptfile file will fail willfail will fail willfail override string to string tostring test script file testscriptfile get name getname collector list definition tests array list arraylist definition logger logger logger factory loggerfactory get logger getlogger get class getclass collector add scripts addscripts test script dir add scripts addscripts test script dir fail directory resource path param resource path resourcepath resource path pointing script directory file object path points directory file get script directory getscriptdirectory string resource path resourcepath url url server side scripts test serversidescriptstest get class loader getclassloader get resource getresource resource path resourcepath url url get protocol getprotocol equals file uri uri uri url touri file dir file uri dir exists dir is directory isdirectory dir uri syntax exception urisyntaxexception logger info failed scripts url url get protocol getprotocol equals jar string url string urlstring url to string tostring pos url string urlstring index of indexof string jar file path jarfilepath url string urlstring substring pos url jarurl url jar file path jarfilepath uri uri jarurl touri create temp dir file base dir basedir file system get property getproperty java tmp dir tmpdir file temp dir tempdir file base dir basedir system current time millis currenttimemillis dir temp dir tempdir mkdir illegal state exception illegalstateexception failed create temporary directory temp dir tempdir delete on exit deleteonexit expand expander expand expander set dest setdest temp dir tempdir expander set src setsrc file uri expander execute file dir file temp dir tempdir resource path resourcepath dir exists dir is directory isdirectory dir exception logger info script path readable url string urlstring logger info script path unknown url protocol resource path resourcepath url logger info script path resource path resourcepath collect scripts directory resource path param resource path resourcepath resource path pointing script directory param will fail willfail code code test expected succeed code code add scripts addscripts string resource path resourcepath will fail willfail file script dir scriptdir get script directory getscriptdirectory resource path resourcepath script dir scriptdir script dir scriptdir list script dir scriptdir list length file script dir scriptdir list files listfiles is hidden ishidden is file isfile logger info test script get absolute path getabsolutepath definition test definition will fail willfail tests add test logger info test scripts resource path resource path resourcepath list definition get tests gettests tests server side test client serversidetestclient sling client slingclient definition test parameters collection object data list object result array list arraylist object definition collector get tests gettests result add object result server side scripts test serversidescriptstest definition script able test scriptabletest test script able test scriptabletest sling client slingclient server side test client serversidetestclient setup exception sling client slingclient mkdirs apps resource type prefix cleanup exception sling client slingclient delete apps resource type prefix test run scripts runscripts exception string resource type resourcetype resource type prefix test test name testname string script path scriptpath apps resource type resourcetype string to delete todelete create test node sling client slingclient create node createnode script path scriptpath jcr primary type primarytype sling folder jcr mixin types mixintypes sling test sling resource type resourcetype resource type prefix test test name testname to delete todelete script path scriptpath string dest path destpath script path scriptpath test txt test script extension scriptextension logger info setting node dest path destpath test test script file testscriptfile get absolute file getabsolutefile sling client slingclient upload dest path destpath file input stream fileinputstream test test script file testscriptfile sling oak sling j unit junit script able scriptable module test all paths testallpaths script time avoid wait bit thread sleep start time starttime system current time millis currenttimemillis server side test client serversidetestclient test results testresults sling client slingclient run tests runtests org apache sling junit script able scriptable scriptable tests provider scriptabletestsprovider assert equals assertequals expecting script able scriptable test get test count gettestcount failure count failurecount test will fail willfail get failures getfailures size failure count failurecount fail expected failure count failurecount failing tests get failures getfailures size test test script file testscriptfile get absolute path getabsolutepath get failures getfailures logger info execution msec test system current time millis currenttimemillis start time starttime to delete todelete sling client slingclient delete to delete todelete
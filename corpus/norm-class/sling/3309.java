licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling impl org apache sling impl jcr resource bundle jcrresourcebundle prop base name basename org apache sling impl jcr resource bundle jcrresourcebundle prop language java util array list arraylist java util collection java util collections java util java util dictionary java util hash map hashmap java util hash set hashset java util hashtable java util iterator java util locale java util map java util missing resource exception missingresourceexception java util resource bundle resourcebundle java util java util concurrent concurrent hash map concurrenthashmap java util concurrent semaphore org apache felix scr annotations component org apache felix scr annotations property org apache felix scr annotations reference org apache felix scr annotations reference cardinality referencecardinality org apache felix scr annotations reference policy referencepolicy org apache felix scr annotations service org apache sling api sling constants slingconstants org apache sling api resource login exception loginexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling api resource value map valuemap org apache sling commons osgi properties util propertiesutil org apache sling commons scheduler schedule options scheduleoptions org apache sling commons scheduler scheduler org apache sling resource bundle provider resourcebundleprovider org osgi framework bundle context bundlecontext org osgi framework service registration serviceregistration org osgi service component component context componentcontext org osgi service event event constants eventconstants org osgi service event event handler eventhandler org slf logger org slf logger factory loggerfactory code jcr resource bundle provider jcrresourcebundleprovider code code resource bundle provider resourcebundleprovider code creating code resource bundle resourcebundle code instances resources stored repository component metatype label provider description provider description service resource bundle provider resourcebundleprovider event handler eventhandler property event constants eventconstants event topic org apache sling api resource resource property private propertyprivate jcr resource bundle provider jcrresourcebundleprovider resource bundle provider resourcebundleprovider event handler eventhandler preload bundles invalidation delay property string prop user user property string prop pass password property string prop locale locale property bool value boolvalue preload bundles string prop preload bundles preload bundles property long value longvalue invalidation delay string prop invalidation delay invalidation delay reference scheduler scheduler job names scheduled jobs reloading individual bundles collection string scheduled job names scheduledjobnames collections synchronized list synchronizedlist array list arraylist string log logger log logger factory loggerfactory get logger getlogger get class getclass reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory locale configured locale configuration property defaults code locale english code configuration property locale default locale defaultlocale locale english resource resolver access resource bundles object retrieved link resource resolver factory resourceresolverfactory admin istrative administrative session session acquired link repo credentials repocredentials resource resolver resourceresolver resource resolver resourceresolver map cached resource bundles indexed key combined base code locale code load identify code resource bundle resourcebundle code concurrent hash map concurrenthashmap key jcr resource bundle jcrresourcebundle resource bundle cache resourcebundlecache concurrent hash map concurrenthashmap key jcr resource bundle jcrresourcebundle concurrent hash map concurrenthashmap key semaphore loading guards loadingguards concurrent hash map concurrenthashmap key semaphore paths jcr resource bundles loaded string language root paths languagerootpaths collections new set from map newsetfrommap concurrent hash map concurrenthashmap string root resource bundle created demand link get root resource bundle getrootresourcebundle resource bundle resourcebundle root resource bundle rootresourcebundle bundle context bundlecontext bundle context bundlecontext resource bundle resourcebundle registered service registration stored map locale base key map key service registration serviceregistration bundle service registrations bundleserviceregistrations preload bundles preloadbundles invalidation delay invalidationdelay resource bundle provider resourcebundleprovider returns configured code locale code fallback link get resource bundle getresourcebundle locale basis messages requested resource bundles override locale get default locale getdefaultlocale default locale defaultlocale returns code resource bundle resourcebundle code code locale code param locale code locale code resource bundle code code configured link get default locale getdefaultlocale locale assumed code resource bundle resourcebundle code locale missing resource exception missingresourceexception code resource resolver resourceresolver code access resources override resource bundle resourcebundle get resource bundle getresourcebundle locale locale get resource bundle getresourcebundle locale override resource bundle resourcebundle get resource bundle getresourcebundle string base name basename locale locale locale locale default locale defaultlocale get resource bundle internal getresourcebundleinternal base name basename locale event handler eventhandler override handle event handleevent org osgi service event event event string path string event get property getproperty sling constants slingconstants property path path log trace handle event handleevent detecting event path event path invalid ate invalidate language root paths languagerootpaths path log debug handle event handleevent detected change cached language root removing cached resource bundles resourcebundles path schedule reload bundles schedulereloadbundles change root path messages resource bundle string root language root paths languagerootpaths path starts with startswith root figure jcr resource bundle jcrresourcebundle cached jcr resource bundle jcrresourcebundle bundle resource bundle cache resourcebundlecache values bundle get language root paths getlanguagerootpaths root reload log debug handle event handleevent resource reloading resource bundle resourcebundle root bundle schedule reload bundle schedulereloadbundle bundle log debug handle event handleevent cached resource bundle root root completely dictionary is dictionary resource isdictionaryresource path event schedule reload bundles schedulereloadbundles is dictionary resource isdictionaryresource string path org osgi service event event event language node happen frequently https issues apache org jira browse sling sling message entry messageentry json dictionaries string resource type resourcetype string event get property getproperty sling constants slingconstants property resource type resource type resourcetype jcr resource bundle jcrresourcebundle message entry equals resource type resourcetype log debug dictionary entry resource detected jcr resource bundle jcrresourcebundle message entry path value map valuemap resource resolver resourceresolver refresh resource resource resource resolver resourceresolver get resource getresource path resource log trace resource event path event value map valuemap value map valuemap resource adapt to adaptto value map valuemap value map valuemap log trace map event path event fixme derivatives mix message detected has mixin hasmixin value map valuemap jcr resource bundle jcrresourcebundle mixin message log debug dictionary entry resource detected jcr resource bundle jcrresourcebundle mixin message path path ends with endswith json check mixin has mixin hasmixin value map valuemap jcr resource bundle jcrresourcebundle mixin language log debug dictionary resource detected jcr resource bundle jcrresourcebundle mixin language path has mixin hasmixin value map valuemap value map valuemap string mixin string mixins value map valuemap jcr resource bundle jcrresourcebundle prop mixins string mixins string mixins mixin equals schedule reload bundles schedulereloadbundles with delay withdelay cancel reload individual bundle jobs scheduled job names scheduledjobnames string scheduled job name scheduledjobname scheduled job names scheduledjobnames scheduler unschedule scheduled job name scheduledjobname scheduled job names scheduledjobnames clear defer job schedule options scheduleoptions options with delay withdelay options scheduler system current time millis currenttimemillis invalidation delay invalidationdelay options scheduler options jcr resource bundle provider jcrresourcebundleprovider reload resource bundles scheduler schedule runnable override log info reloading resource bundles clear cache clearcache preload bundles preloadbundles options schedule reload bundle schedulereloadbundle jcr resource bundle jcrresourcebundle bundle string base name basename bundle get base name getbasename locale locale bundle get locale getlocale key key key base name basename locale defer job schedule options scheduleoptions options scheduler system current time millis currenttimemillis invalidation delay invalidationdelay string job name jobname jcr resource bundle provider jcrresourcebundleprovider reload bundle key key to string tostring scheduled job names scheduledjobnames add job name jobname options job name jobname scheduler schedule runnable override jcr resource bundle provider jcrresourcebundleprovider reload bundle reloadbundle key scheduled job names scheduledjobnames remove job name jobname options reload bundle reloadbundle key key remove bundle cache resource bundle cache resourcebundlecache remove key log info reloading resource bundle key unregister bundle service registration serviceregistration service registration serviceregistration bundle service registrations bundleserviceregistrations remove key service registration serviceregistration service registration serviceregistration unregister log warn find resource bundle service key collection jcr resource bundle jcrresourcebundle dependent bundles dependentbundles array list arraylist jcr resource bundle jcrresourcebundle bundle parent cached bundle invalid ate invalidate dependent bundles jcr resource bundle jcrresourcebundle bundle resource bundle cache resourcebundlecache values bundle get parent getparent jcr resource bundle jcrresourcebundle jcr resource bundle jcrresourcebundle parent bundle parentbundle jcr resource bundle jcrresourcebundle bundle get parent getparent key parent key parentkey key parent bundle parentbundle get base name getbasename parent bundle parentbundle get locale getlocale parent key parentkey equals key log debug invalid ate invalidate dependent bundle bundle parent bundle parent bundle parentbundle dependent bundles dependentbundles add bundle jcr resource bundle jcrresourcebundle dependent bundle dependentbundle dependent bundles dependentbundles reload bundle reloadbundle key dependent bundle dependentbundle get base name getbasename dependent bundle dependentbundle get locale getlocale preload bundles preloadbundles reload bundle repository fill cache register service get resource bundle getresourcebundle key base name basename key locale scr int egration integration activates config ures configures component repository access details locale login exception loginexception activate component context componentcontext context login exception loginexception dictionary props context get properties getproperties map string object repo credentials repocredentials string user properties util propertiesutil to string tostring props prop user user user length repo credentials repocredentials string pass properties util propertiesutil to string tostring props prop pass pwd pass pass to char array tochararray repo credentials repocredentials hash map hashmap string object repo credentials repocredentials resource resolver factory resourceresolverfactory user user repo credentials repocredentials resource resolver factory resourceresolverfactory password pwd string locale string localestring properties util propertiesutil to string tostring props prop locale default locale defaultlocale to locale tolocale locale string localestring preload bundles preloadbundles properties util propertiesutil to boolean toboolean props prop preload bundles preload bundles bundle context bundlecontext context get bundle context getbundlecontext bundle service registrations bundleserviceregistrations hash map hashmap key service registration serviceregistration invalidation delay invalidationdelay properties util propertiesutil to long tolong props prop invalidation delay invalidation delay resource resolver factory resourceresolverfactory test execution repo credentials repocredentials resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver repo credentials repocredentials schedule reload bundles schedulereloadbundles deactivate clear cache clearcache resource resolver resourceresolver close internal internal implementation link get resource bundle getresourcebundle locale method employing cache resource bundles creates bundle cached missing resource exception missingresourceexception resource bundles created code resource resolver resourceresolver code access resources resource bundle resourcebundle get resource bundle internal getresourcebundleinternal string base name basename locale locale key key key base name basename locale jcr resource bundle jcrresourcebundle resource bundle resourcebundle resource bundle cache resourcebundlecache key resource bundle resourcebundle log debug get resource bundle internal getresourcebundleinternal cache hit key loading guards loadingguards key loading guards loadingguards put if absent putifabsent key semaphore semaphore loading guard loadingguard loading guards loadingguards key loading guard loadingguard acquire resource bundle resourcebundle resource bundle cache resourcebundlecache key resource bundle resourcebundle log debug get resource bundle internal getresourcebundleinternal cache hit key log debug get resource bundle internal getresourcebundleinternal reading repository key resource bundle resourcebundle create resource bundle createresourcebundle key base name basename key locale resource bundle cache resourcebundlecache key resource bundle resourcebundle register resource bundle registerresourcebundle key resource bundle resourcebundle interrupted exception interruptedexception thread int errupted interrupted loading guard loadingguard release log trace get resource bundle internal getresourcebundleinternal key resource bundle resourcebundle resource bundle resourcebundle register resource bundle registerresourcebundle key key jcr resource bundle jcrresourcebundle resource bundle resourcebundle dictionary object object service props serviceprops hashtable object object key base name basename service props serviceprops base name basename key base name basename service props serviceprops locale key locale to string tostring service registration serviceregistration service reg servicereg bundle context bundlecontext register service registerservice resource bundle resourcebundle get name getname resource bundle resourcebundle service props serviceprops bundle service registrations bundleserviceregistrations key service reg servicereg register language root paths string language roots languageroots resource bundle resourcebundle get language root paths getlanguagerootpaths language root paths languagerootpaths add all addall language roots languageroots log debug register resource bundle registerresourcebundle service registration language roots key language roots languageroots log info loaded dictionaries locales language root paths languagerootpaths creates resource bundle locale missing resource exception missingresourceexception code resource resolver resourceresolver code access resources jcr resource bundle jcrresourcebundle create resource bundle createresourcebundle string base name basename locale locale jcr resource bundle jcrresourcebundle bundle jcr resource bundle jcrresourcebundle locale base name basename resource resolver resourceresolver parent resource bundle locale parent locale parentlocale get parent locale getparentlocale locale parent locale parentlocale bundle set parent setparent get resource bundle internal getresourcebundleinternal base name basename parent locale parentlocale bundle set parent setparent get root resource bundle getrootresourcebundle bundle returns parent locale locale parent locale locale locale defined locale variant parent locale locale language country variant locale variant country parent locale locale language country variant locale country variant language language configured locale parent locale configured locale parent locale code code returned locale get parent locale getparentlocale locale locale locale get var iant getvariant length locale locale get language getlanguage locale get country getcountry locale get country getcountry length locale locale get language getlanguage locale get language getlanguage equals default locale defaultlocale get language getlanguage default locale defaultlocale parents returns resource bundle resourcebundle root resource bundle ultimate parent code get locale getlocale code returns locale code handle get object handlegetobject string key code returns code key code code get keys getkeys code returns empty enumeration root resource bundle resource bundle resourcebundle get root resource bundle getrootresourcebundle root resource bundle rootresourcebundle root resource bundle rootresourcebundle root resource bundle rootresourcebundle root resource bundle rootresourcebundle clear cache clearcache resource bundle cache resourcebundlecache clear language root paths languagerootpaths clear service registration serviceregistration service reg servicereg bundle service registrations bundleserviceregistrations values service reg servicereg unregister bundle service registrations bundleserviceregistrations clear preload bundles preloadbundles preload bundles preloadbundles resource resolver resourceresolver refresh iterator map string object bundles resource resolver resourceresolver query resources queryresources jcr resource bundle jcrresourcebundle query language roots xpath key used keys usedkeys hash set hashset key bundles has next hasnext map string object bundle bundles bundle contains key containskey prop language locale locale to locale tolocale bundle prop language to string tostring string base name basename bundle contains key containskey prop base name basename base name basename bundle prop base name basename to string tostring key key key base name basename locale used keys usedkeys add key get resource bundle getresourcebundle base name basename locale converts code locale string localestring code valid code java util locale code locale string code code empty platform locale assumed locale string localestring matches locale platform platform locale returned locale string localestring parsed language country parts compared lang uages languages count ries countries platform unsupported language country replaced platform language country locale to locale tolocale string locale string localestring locale string localestring locale string localestring length locale get default getdefault check language country string parts locale string localestring split parts length locale get default getdefault language string lang parts string langs locale getisolanguages langs length langs equals lang signal lang lang parts locale get default getdefault get language getlanguage language parts length locale parts country string country parts string count ries countries locale getisocountries count ries countries length count ries countries equals lang signal country country parts locale get default getdefault get country getcountry language country parts length locale parts parts language country variant locale parts parts parts code key code encapsulates base locale single object key code hash map hashmap code key string base name basename locale locale precomputed hash code instance key hash map hashmap hash code hashcode key string base name basename locale locale base name basename base name basename hash code hashcode locale locale hash code hashcode base name basename base name basename locale locale hash code hashcode override hash code hashcode hash code hashcode override equals object obj obj obj key key key obj equals base name basename base name basename equals locale locale equals object object equals override string to string tostring key base name basename locale
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling datasource internal java lang management management factory managementfactory java sql sql exception sqlexception java util arrays java util collections java util dictionary java util hash set hashset java util hashtable java util map java util properties java util javax management instance not found exception instancenotfoundexception javax management m bean server mbeanserver javax management object name objectname org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations configuration policy configurationpolicy org apache felix scr annotations deactivate org apache felix scr annotations modified org apache felix scr annotations property org apache felix scr annotations property option propertyoption org apache felix scr annotations reference org apache sling commons osgi properties util propertiesutil org apache tomcat jdbc pool connection pool connectionpool org apache tomcat jdbc pool data source datasource org apache tomcat jdbc pool pool configuration poolconfiguration org apache tomcat jdbc pool pool properties poolproperties org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service registration serviceregistration org slf logger org slf logger factory loggerfactory component data source factory datasourcefactory label datasource component description datasource component description metatype configuration factory configurationfactory policy configuration policy configurationpolicy require data source factory datasourcefactory string org apache sling datasource data source factory datasourcefactory property string prop datasource datasource property prop datasource string prop svc prop datasource svc prop property string prop driverclassname driver class name driverclassname property string prop url url property string prop user name username username property password value passwordvalue string prop password password indicating treated string val property val options property option propertyoption val property option propertyoption property option propertyoption string prop default auto commit defaultautocommit default auto commit defaultautocommit property val options property option propertyoption val property option propertyoption property option propertyoption string prop default read only defaultreadonly default read only defaultreadonly property val options property option propertyoption val property option propertyoption property option propertyoption read committed read committed property option propertyoption read uncommitted read uncommitted property option propertyoption repeatable read repeatable read property option propertyoption serializable serializable string prop default transactionisolation defaulttransactionisolation default transaction isolation defaulttransactionisolation property string prop default cat alog defaultcatalog default catalog defaultcatalog property int value intvalue pool properties poolproperties max active string prop max active maxactive max active maxactive property int value intvalue pool properties poolproperties max active string defaults max active maxactive prop max idle maxidle max idle maxidle property int value intvalue string defaults initial size initialsize prop min idle minidle min idle minidle property int value intvalue string prop initial size initialsize initial size initialsize property int value intvalue string prop max wait maxwait max wait maxwait property int value intvalue string prop max age maxage max age maxage property bool value boolvalue string prop test onborrow testonborrow test on borrow testonborrow property bool value boolvalue string prop test onreturn testonreturn test on return testonreturn property bool value boolvalue string prop test while idle testwhileidle test while idle testwhileidle property string prop val idationquery validationquery validation query validationquery property int value intvalue string prop val idationquery validationquery timeout validation query timeout validationquerytimeout property int value intvalue string prop time between evictionrunsmillis timebetweenevictionrunsmillis time between eviction runs millis timebetweenevictionrunsmillis property int value intvalue string prop min evictableidletimemillis minevictableidletimemillis min evictable idle time millis minevictableidletimemillis property string prop connection properties connectionproperties connection properties connectionproperties property string prop init sql initsql initsql property statement cache statementcache slow query report slowqueryreport threshold connection state connectionstate string prop int erceptors interceptors jdbc int erceptors jdbcinterceptors property int value intvalue string prop valid ationinterval validationinterval validation interval validationinterval property bool value boolvalue string prop log valid ationerrors logvalidationerrors log validation errors logvalidationerrors property cardinality string prop datasource svc props datasource svc properties property names treat string props dfeault collections unmodifiable set unmodifiableset hash set hashset string arrays as list aslist prop default auto commit defaultautocommit prop default read only defaultreadonly prop default transactionisolation defaulttransactionisolation logger log logger factory loggerfactory get logger getlogger get class getclass reference driver registry driverregistry driver registry driverregistry string string svc prop name svcpropname object name objectname jmx name jmxname service registration serviceregistration ds registration dsregistration data source datasource data source datasource bundle context bundlecontext bundle context bundlecontext activate activate bundle context bundlecontext bundle context bundlecontext map string config exception bundle context bundlecontext bundle context bundlecontext get data source name getdatasourcename config check argument checkargument data source datasource property prop datasource data source datasource lazy jmx registering data source lazyjmxregisteringdatasource create pool config createpoolconfig config svc prop name svcpropname get svc prop name getsvcpropname config register data source registerdatasource svc prop name svcpropname log info created data source datasource properties data source datasource get pool properties getpoolproperties to string tostring modified modified map string config exception string get data source name getdatasourcename config string svc prop name svcpropname get svc prop name getsvcpropname config equals svc prop name svcpropname equals svc prop name svcpropname log info change datasource service property detected data source datasource recreated deactivate activate bundle context bundlecontext config modifications applied runtime tomcat connection pool dec oupled decoupled data source datasource closed reset data source datasource set pool properties setpoolproperties create pool config createpoolconfig config close connection pool closeconnectionpool data source datasource create pool createpool log info updated data source datasource properties data source datasource get pool properties getpoolproperties to string tostring deactivate deactivate ds registration dsregistration ds registration dsregistration unregister ds registration dsregistration close connection pool closeconnectionpool data source datasource close connection pool closeconnectionpool unregister jmx unregisterjmx data source datasource close pool configuration poolconfiguration create pool config createpoolconfig map string config properties props properties copy properties map string string other props otherprops properties util propertiesutil to map tomap config prop datasource svc props string map entry string string other props otherprops entry set entryset get key getkey get value getvalue props props set property setproperty org apache tomcat jdbc pool data source factory datasourcefactory object string prop name propname dummy data source factory dummydatasourcefactory get property names getpropertynames string properties util propertiesutil to string tostring config prop name propname prop name propname props data source datasource connection creation logic handled care osg i osgi env pool configuration poolconfiguration pool properties poolproperties org apache tomcat jdbc pool data source factory datasourcefactory parse pool properties parsepoolproperties props pool properties poolproperties set data source setdatasource create driver data source createdriverdatasource pool properties poolproperties pool properties poolproperties driver data source driverdatasource create driver data source createdriverdatasource pool configuration poolconfiguration pool properties poolproperties driver data source driverdatasource pool properties poolproperties driver registry driverregistry bundle context bundlecontext register data source registerdatasource string svc prop name svcpropname dictionary string object svc props svcprops hashtable string object svc props svcprops svc prop name svcpropname svc props svcprops constants service vendor apache software foundation svc props svcprops constants service description data source datasource service based tomcat jdbc ds registration dsregistration bundle context bundlecontext register service registerservice javax sql data source datasource data source datasource svc props svcprops register jmx registerjmx connection pool connectionpool pool sql exception sqlexception org apache tomcat jdbc pool jmx connection pool connectionpool jmx pool jmxpool pool get jmx pool getjmxpool jmx pool jmxpool jmx enabled hashtable string string table hashtable string string table type connection pool connectionpool table javax sql data source datasource get name getname table object name objectname quote jmx name jmxname object name objectname org apache sling table m bean server mbeanserver mbs management factory managementfactory get platform bean server getplatformmbeanserver mbs registermbean jmx pool jmxpool jmx name jmxname exception log warn error occurred registering jmx bean connection pool jmx name jmxname connection pool connectionpool get pool getpool data source datasource get pool getpool unregister jmx unregisterjmx jmx name jmxname m bean server mbeanserver mbs management factory managementfactory get platform bean server getplatformmbeanserver mbs unregistermbean jmx name jmxname instance not found exception instancenotfoundexception ignore exception log error unable unregister jdbc pool jmx config handling string get data source name getdatasourcename map string config properties util propertiesutil to string tostring config prop datasource string get svc prop name getsvcpropname map string config properties util propertiesutil to string tostring config prop svc prop prop datasource string string properties props props dfeault val equals trim is empty isempty props set property setproperty check argument checkargument expression string error message template errormessagetemplate object error message args errormessageargs expression illegal argument exception illegalargumentexception string format error message template errormessagetemplate error message args errormessageargs lazy jmx registering data source lazyjmxregisteringdatasource org apache tomcat jdbc pool data source datasource initialized lazy jmx registering data source lazyjmxregisteringdatasource pool configuration poolconfiguration pool properties poolproperties pool properties poolproperties override connection pool connectionpool create pool createpool sql exception sqlexception connection pool connectionpool pool create pool createpool register jmx lazily registerjmxlazily pool pool override close initialized close register jmx lazily registerjmxlazily connection pool connectionpool pool sql exception sqlexception initialized initialized data source factory datasourcefactory register jmx registerjmx pool initialized dummy impl enable access fields dummy data source factory dummydatasourcefactory org apache tomcat jdbc pool data source factory datasourcefactory string get property names getpropertynames properties
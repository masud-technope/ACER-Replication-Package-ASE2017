licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling testing mock osgi org junit assert array equals assertarrayequals org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert null assertnull org junit assert same assertsame org junit assert true asserttrue org mockito matchers org mockito mockito mock org mockito mockito verify java util dictionary java util hashtable org junit org junit test org junit runner run with runwith org mockito run ners runners mockito unit runner mockitojunitrunner org osgi framework bundle context bundlecontext org osgi framework bundle event bundleevent org osgi framework bundle listener bundlelistener org osgi framework constants org osgi framework filter org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service event serviceevent org osgi framework service listener servicelistener org osgi framework service reference servicereference org osgi framework service registration serviceregistration run with runwith mockito unit runner mockitojunitrunner mock bundle context test mockbundlecontexttest bundle context bundlecontext bundle context bundlecontext set up setup bundle context bundlecontext mock osgi mockosgi new bundle context newbundlecontext test test bundle testbundle assert not null assertnotnull bundle context bundlecontext get bundle getbundle test test service registration testserviceregistration invalid syntax exception invalidsyntaxexception prepare test services string clazz string get name getname object service object dictionary string object properties get service properties getserviceproperties service registration serviceregistration reg bundle context bundlecontext register service registerservice clazz service properties string clazzes string string get name getname integer get name getname object service object dictionary string object properties get service properties getserviceproperties service registration serviceregistration reg bundle context bundlecontext register service registerservice clazzes service properties string clazz integer get name getname object service object dictionary string object properties get service properties getserviceproperties service registration serviceregistration reg bundle context bundlecontext register service registerservice clazz service properties test service references service reference servicereference ref string refstring bundle context bundlecontext get service reference getservicereference string get name getname assert same assertsame reg get reference getreference ref string refstring service reference servicereference ref integer refinteger bundle context bundlecontext get service reference getservicereference integer get name getname assert same assertsame reg get reference getreference ref integer refinteger service reference servicereference refs string refsstring bundle context bundlecontext get service references getservicereferences string get name getname assert equals assertequals refs string refsstring length assert same assertsame reg get reference getreference refs string refsstring assert same assertsame reg get reference getreference refs string refsstring service reference servicereference refs integer refsinteger bundle context bundlecontext get service references getservicereferences integer get name getname assert equals assertequals refs integer refsinteger length assert same assertsame reg get reference getreference refs integer refsinteger assert same assertsame reg get reference getreference refs integer refsinteger service reference servicereference all refs string allrefsstring bundle context bundlecontext get all service references getallservicereferences string get name getname assert array equals assertarrayequals refs string refsstring all refs string allrefsstring test services assert same assertsame service bundle context bundlecontext get service getservice refs string refsstring assert same assertsame service bundle context bundlecontext get service getservice refs string refsstring assert same assertsame service bundle context bundlecontext get service getservice ref integer refinteger unget bundle context bundlecontext unget service ungetservice refs string refsstring bundle context bundlecontext unget service ungetservice refs string refsstring bundle context bundlecontext unget service ungetservice ref integer refinteger test test service unregistration testserviceunregistration prepare test services string clazz string get name getname object service object dictionary string object properties get service properties getserviceproperties service registration serviceregistration reg bundle context bundlecontext register service registerservice clazz service properties assert not null assertnotnull bundle context bundlecontext get service reference getservicereference clazz reg unregister assert null assertnull bundle context bundlecontext get service reference getservicereference clazz dictionary string object get service properties getserviceproperties service ranking serviceranking dictionary string object props hashtable string object service ranking serviceranking props constants service ranking service ranking serviceranking props test test get bundles testgetbundles exception assert equals assertequals bundle context bundlecontext get bundles getbundles length test test service listener testservicelistener exception service listener servicelistener service listener servicelistener mock service listener servicelistener bundle context bundlecontext add service listener addservicelistener service listener servicelistener prepare test services string clazz string get name getname object service object bundle context bundlecontext register service registerservice clazz service verify service listener servicelistener service changed servicechanged service event serviceevent bundle context bundlecontext remove service listener removeservicelistener service listener servicelistener test test bundle listener testbundlelistener exception bundle listener bundlelistener bundle listener bundlelistener mock bundle listener bundlelistener bundle event bundleevent bundle event bundleevent mock bundle event bundleevent bundle context bundlecontext add bundle listener addbundlelistener bundle listener bundlelistener mock osgi mockosgi send bundle event sendbundleevent bundle context bundlecontext bundle event bundleevent verify bundle listener bundlelistener bundle changed bundlechanged bundle event bundleevent bundle context bundlecontext remove bundle listener removebundlelistener bundle listener bundlelistener test test framework listener testframeworklistener exception ensure listeners called expected bundle context bundlecontext add framework listener addframeworklistener bundle context bundlecontext remove framework listener removeframeworklistener test test get property testgetproperty assert null assertnull bundle context bundlecontext get property getproperty any property anyproperty test test object class filter matches testobjectclassfiltermatches invalid syntax exception invalidsyntaxexception filter filter bundle context bundlecontext create filter createfilter constants obj ectclass objectclass integer get name getname service registration serviceregistration service registration serviceregistration bundle context bundlecontext register service registerservice integer get name getname integer value of valueof assert true asserttrue filter match service registration serviceregistration get reference getreference test test object class filter does not match testobjectclassfilterdoesnotmatch invalid syntax exception invalidsyntaxexception filter filter bundle context bundlecontext create filter createfilter constants obj ectclass objectclass integer get name getname service registration serviceregistration service registration serviceregistration bundle context bundlecontext register service registerservice get name getname value of valueof assert false assertfalse filter match service registration serviceregistration get reference getreference
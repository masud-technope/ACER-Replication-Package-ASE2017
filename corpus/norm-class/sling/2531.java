licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling core spi java io exception ioexception java input stream inputstream java input stream reader inputstreamreader java reader javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache sling core auth util authutil code abstract authentication form servlet abstractauthenticationformservlet code basic implementation simple servlet render login form authentication purposes suppress warnings suppresswarnings serial abstract authentication form servlet abstractauthenticationformservlet http servlet httpservlet path login form get default form path getdefaultformpath string form path login html path custom login form get custom form path getcustomformpath string custom form path custom login html raw form link get form getform http servlet request httpservletrequest method fill request data field link get raw form getrawform method loading form string raw form rawform prepares returns login form response utf encoded code text html code cache control headers prevent caching servlet called handle request expected included response committed res ets resets response io exception ioexception error occurs preparing sending login form illegal state exception illegalstateexception response committed response reset override do get doget http servlet request httpservletrequest request http servlet response httpservletresponse response io exception ioexception handle request response prepares returns login form response utf encoded code text html code cache control headers prevent caching servlet called handle request expected included response committed res ets resets response io exception ioexception error occurs preparing sending login form illegal state exception illegalstateexception response committed response reset override do post dopost http servlet request httpservletrequest request http servlet response httpservletresponse response io exception ioexception handle request response handle http servlet request httpservletrequest request http servlet response httpservletresponse response io exception ioexception reset response response reset setup response html cache prevent ion prevention response set content type setcontenttype text html response set character encoding setcharacterencoding utf response set header setheader cache control cache response add header addheader cache control store response set header setheader pragma cache response set header setheader expires send form flush response get writer getwriter print get form getform request response flush buffer flushbuffer returns form client login providing optional info rmational informational message optional target redirect logging param request request providing parameters indicating info rmational informational message redirect ion redirection target login form returned client io exception ioexception login form loaded string get form getform http servlet request httpservletrequest request io exception ioexception string form get raw form getrawform string resource clean se cleanse request get resource getresource request string reason get reason getreason request string resource context path resourcecontextpath clean se cleanse request get context path getcontextpath request string context path contextpath request get context path getcontextpath replace form place hold ers placeholders checked filtered values form form replace resource escape resource form form replace reason escape reason form form replace request context path requestcontextpath escape resource context path resourcecontextpath form form replace context path contextpath escape context path contextpath form code target pointing absolute location code request context target empty string returned method link auth util authutil is redirect valid isredirectvalid http servlet request httpservletrequest string method param request code http servlet request httpservletrequest test code target param target target location url test val idity validity target location pointing current request empty string string clean se cleanse http servlet request httpservletrequest request string target target length auth util authutil is redirect valid isredirectvalid request target target escape output method simple xml escaping escapes single quotes characters occur url encoding fine string escape string input input string builder stringbuilder string builder stringbuilder input length input length input char at charat append amp append append append append append to string tostring returns path resource request redirected comp leting completing form empty string code resource code request parameter param request request providing code resource code parameter target redirect login empty string specific target requested string get resource getresource http servlet request httpservletrequest request auth util authutil get login resource getloginresource request returns info rmational informational message code reason code request parameter supported reasons invalid credentials session timeout param request request providing parameter translated reason render login form empty string specific reason string get reason getreason http servlet request httpservletrequest request returns context path authentication form request path path authenticated resource returned link get resource getresource http servlet request httpservletrequest optional query string contained resource path link get resource getresource http servlet request httpservletrequest empty string servlet context path param request request context path form action consisting resource user authenticate string get context path getcontextpath http servlet request httpservletrequest request string context path contextpath get resource getresource request equals context path contextpath context path contextpath request get context path getcontextpath query context path contextpath index of indexof query context path contextpath context path contextpath substring query remove ending slash removeendingslash context path contextpath string remove ending slash removeendingslash string str str str ends with endswith str substring str length str load raw unmodified form bundle loader raw form string io exception ioexception error occurs reading file loader provide form data string get raw form getrawform io exception ioexception raw form rawform input stream inputstream ins custom login ins get class getclass get resource as stream getresourceasstream get custom form path getcustomformpath ins standard login ins get class getclass get resource as stream getresourceasstream get default form path getdefaultformpath ins string builder stringbuilder builder string builder stringbuilder reader input stream reader inputstreamreader ins utf cbuf read cbuf builder append cbuf raw form rawform builder to string tostring ins ins close io exception ioexception ignore raw form rawform io exception ioexception failed reading form template raw form rawform returns path login form load loader instance code get resource as stream getresourceasstream code form intended included bundle implementing method returns link form path overwritten implementations string get default form path getdefaultformpath form path returns path custom login form load loader instance code get resource as stream getresourceasstream code custom form supplied fragment attaching bundle implementing method returns link custom form path overwritten implementations string get custom form path getcustomformpath custom form path
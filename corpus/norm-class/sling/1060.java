licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling resource resolver resourceresolver impl mapping org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue org mockito matchers any string anystring org mockito matchers org mockito mockito mock org mockito mockito java file java io exception ioexception java lang reflect field java lang reflect method java util array list arraylist java util arrays java util collections java util hash map hashmap java util hash set hashset java util iterator java util list java util map java util java util concurrent callable java util concurrent executor service executorservice java util concurrent executors java util concurrent java util concurrent atomic atomic long atomiclong org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling api resource value map valuemap org apache sling api wrappers value map decorator valuemapdecorator org apache sling resource resolver resourceresolver impl mapping map configuration provider mapconfigurationprovider vanity path config vanitypathconfig org junit org junit org junit test org mockito mock org mockito mockito annotations mockitoannotations org mockito invocation invocation on mock invocationonmock org mockito stub bin g stubbing answer org osgi framework bundle context bundlecontext org osgi service event event admin eventadmin map entries test mapentriestest map entries mapentries map entries mapentries file vanity bloom filter file vanitybloomfilterfile mock map configuration provider mapconfigurationprovider resource resolver factory resourceresolverfactory mock bundle context bundlecontext bundle context bundlecontext mock resource resolver resourceresolver resource resolver resourceresolver mock event admin eventadmin event admin eventadmin suppress warnings suppresswarnings deprecation setup exception mockito annotations mockitoannotations init mocks initmocks list vanity path config vanitypathconfig configs array list arraylist map configuration provider mapconfigurationprovider vanity path config vanitypathconfig configs add vanity path config vanitypathconfig libs configs add vanity path config vanitypathconfig libs denied configs add vanity path config vanitypathconfig foo configs add vanity path config vanitypathconfig baa configs add vanity path config vanitypathconfig just vanity path justvanitypath configs add vanity path config vanitypathconfig just vanity path justvanitypath configs add vanity path config vanitypathconfig bad vanity path badvanitypath configs add vanity path config vanitypathconfig redirecting vanity path redirectingvanitypath configs add vanity path config vanitypathconfig redirecting vanity path redirectingvanitypath configs add vanity path config vanitypathconfig vanity path on jcr content vanitypathonjcrcontent collections sort configs vanity bloom filter file vanitybloomfilterfile file src main resources vanity bloom filter resourcesvanitybloomfilter txt bundle context bundlecontext get data file getdatafile vanity bloom filter vanitybloomfilter txt then return thenreturn vanity bloom filter file vanitybloomfilterfile resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver then return thenreturn resource resolver resourceresolver resource resolver factory resourceresolverfactory is vanity path enabled isvanitypathenabled then return thenreturn resource resolver factory resourceresolverfactory get vanity path config getvanitypathconfig then return thenreturn configs resource resolver factory resourceresolverfactory is optimize alias resolution enabled isoptimizealiasresolutionenabled then return thenreturn resource resolver resourceresolver find resources findresources any string anystring sql then return thenreturn collections resource empty set emptyset iterator map entries mapentries map entries mapentries resource resolver factory resourceresolverfactory bundle context bundlecontext event admin eventadmin field field map entries mapentries get declared field getdeclaredfield map root maproot field set accessible setaccessible field map entries mapentries map entries mapentries map root field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries startup maxcachedvanitypathentriesstartup field set accessible setaccessible field map entries mapentries tear down teardown exception vanity bloom filter file vanitybloomfilterfile delete test test simple alias support resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling alias collections singleton result iterator collections resource empty set emptyset iterator map entries mapentries do init doinit map string string alias map aliasmap map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map aliasmap assert true asserttrue alias map aliasmap contains key containskey alias assert equals assertequals child alias map aliasmap alias test test duplicate alias doesn t doesnt replace alias resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias resource second result secondresult mock resource second result secondresult get parent getparent then return thenreturn parent second result secondresult get path getpath then return thenreturn parent child second result secondresult get name getname then return thenreturn child second result secondresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling alias arrays as list aslist result second result secondresult iterator collections resource empty set emptyset iterator map entries mapentries do init doinit map string string alias map aliasmap map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map aliasmap assert true asserttrue alias map aliasmap contains key containskey alias assert equals assertequals child alias map aliasmap alias test test vanity path registration exception making weird verify configuration vanity status resource resolver factory resourceresolverfactory get default vanity path redirect status getdefaultvanitypathredirectstatus then return thenreturn vanity status list resource resources array list arraylist resource resource just vanity path justvanitypath mock resource just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resources add just vanity path justvanitypath resource bad vanity path badvanitypath mock resource bad vanity path badvanitypath bad vanity path badvanitypath get path getpath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get name getname then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath content mypage resources add bad vanity path badvanitypath resource redirecting vanity path redirectingvanitypath mock resource redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath get path getpath then return thenreturn redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath get name getname then return thenreturn redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target redirecting vanity path redirectingvanitypath sling redirect resources add redirecting vanity path redirectingvanitypath resource redirecting vanity path redirectingvanitypath mock resource redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath get path getpath then return thenreturn redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath get name getname then return thenreturn redirecting vanity path redirectingvanitypath redirecting vanity path redirectingvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target redirecting vanity path redirectingvanitypath sling redirect sling redirect status redirectstatus resources add redirecting vanity path redirectingvanitypath resource vanity path on jcr content parent vanitypathonjcrcontentparent mock resource vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content parent vanitypathonjcrcontentparent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content parent vanitypathonjcrcontentparent get name getname then return thenreturn vanity path on jcr content vanitypathonjcrcontent resource vanity path on jcr content vanitypathonjcrcontent mock resource vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content vanitypathonjcrcontent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent jcr content vanity path on jcr content vanitypathonjcrcontent get name getname then return thenreturn jcr content vanity path on jcr content vanitypathonjcrcontent get parent getparent then return thenreturn vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content vanitypathonjcrcontent resources add vanity path on jcr content vanitypathonjcrcontent resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath resources iterator collections resource empty set emptyset iterator map entries mapentries do init doinit map entries mapentries initialize vanity paths initializevanitypaths list map entry mapentry entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size map entry mapentry entry entries entry get pattern getpattern target redirecting vanity path redirectingvanitypath assert equals assertequals entry get status getstatus assert false assertfalse entry is internal isinternal entry get pattern getpattern target redirecting vanity path redirectingvanitypath assert equals assertequals vanity status entry get status getstatus assert false assertfalse entry is internal isinternal entry get pattern getpattern target just vanity path justvanitypath assert true asserttrue entry is internal isinternal entry get pattern getpattern target vanity path on jcr content vanitypathonjcrcontent string redirect entry get redirect getredirect assert false assertfalse redirect jcr content field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible suppress warnings suppresswarnings unchecked map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size value map valuemap build value map buildvaluemap object string map string object data hash map hashmap string object string length data string string string value map decorator valuemapdecorator data resource get vanity path resource getvanitypathresource string path resource rsrc mock resource rsrc get path getpath then return thenreturn path rsrc get name getname then return thenreturn resource util resourceutil get name getname path rsrc adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath vanity path rsrc test test vanity path registration include exclude io exception ioexception string valid paths validpaths libs libs foo baa string invalid paths invalidpaths libs denied libs denied list resource resources array list arraylist resource string val valid paths validpaths resources add get vanity path resource getvanitypathresource val string val invalid paths invalidpaths resources add get vanity path resource getvanitypathresource val resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath resources iterator collections resource empty set emptyset iterator map entries mapentries do init doinit map entries mapentries initialize vanity paths initializevanitypaths list map entry mapentry entries map entries mapentries get resolve maps getresolvemaps valid resource entries assert equals assertequals valid paths validpaths length entries size string result set resultset hash set hashset string string valid paths validpaths result set resultset add result set resultset add html map entry mapentry entry entries assert true asserttrue result set resultset remove entry get redirect getredirect test test get actual content path getactualcontentpath exception method method map entries mapentries get declared method getdeclaredmethod get actual content path getactualcontentpath string method set accessible setaccessible string actual content actualcontent string method invoke map entries mapentries content assert equals assertequals content actual content actualcontent actual content actualcontent string method invoke map entries mapentries content jcr content assert equals assertequals content actual content actualcontent test test get map entry redirect getmapentryredirect exception method method map entries mapentries get declared method getdeclaredmethod get map entry redirect getmapentryredirect map entry mapentry method set accessible setaccessible map entry mapentry map entry mapentry map entry mapentry content content string actual content actualcontent string method invoke map entries mapentries map entry mapentry assert equals assertequals content actual content actualcontent map entry mapentry map entry mapentry content content actual content actualcontent string method invoke map entries mapentries map entry mapentry assert equals assertequals content actual content actualcontent map entry mapentry map entry mapentry content content html actual content actualcontent string method invoke map entries mapentries map entry mapentry assert equals assertequals content actual content actualcontent suppress warnings suppresswarnings unchecked test test do add vanity doaddvanity exception list map entry mapentry entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size method method map entries mapentries get declared method getdeclaredmethod do add vanity doaddvanity string method set accessible setaccessible resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue bad vanity resource bad vanity path badvanitypath mock resource bad vanity path badvanitypath resource resolver resourceresolver get resource getresource bad vanity path badvanitypath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get path getpath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get name getname then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath content mypage method invoke map entries mapentries bad vanity path badvanitypath assert equals assertequals entries size vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size vanity jcr content resource vanity path on jcr content parent vanitypathonjcrcontentparent mock resource vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content parent vanitypathonjcrcontentparent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content parent vanitypathonjcrcontentparent get name getname then return thenreturn vanity path on jcr content vanitypathonjcrcontent resource vanity path on jcr content vanitypathonjcrcontent mock resource vanity path on jcr content vanitypathonjcrcontent resource resolver resourceresolver get resource getresource vanity path on jcr content vanitypathonjcrcontent jcr content then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content vanitypathonjcrcontent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent jcr content vanity path on jcr content vanitypathonjcrcontent get name getname then return thenreturn jcr content vanity path on jcr content vanitypathonjcrcontent get parent getparent then return thenreturn vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content vanitypathonjcrcontent method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size assert null assertnull vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent jcr content assert not null assertnotnull vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent suppress warnings suppresswarnings unchecked test test do add vanity doaddvanity exception field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries list map entry mapentry entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size method method map entries mapentries get declared method getdeclaredmethod do add vanity doaddvanity string method set accessible setaccessible resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue bad vanity resource bad vanity path badvanitypath mock resource bad vanity path badvanitypath resource resolver resourceresolver get resource getresource bad vanity path badvanitypath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get path getpath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get name getname then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath content mypage method invoke map entries mapentries bad vanity path badvanitypath assert equals assertequals entries size vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size vanity jcr content resource vanity path on jcr content parent vanitypathonjcrcontentparent mock resource vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content parent vanitypathonjcrcontentparent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content parent vanitypathonjcrcontentparent get name getname then return thenreturn vanity path on jcr content vanitypathonjcrcontent resource vanity path on jcr content vanitypathonjcrcontent mock resource vanity path on jcr content vanitypathonjcrcontent resource resolver resourceresolver get resource getresource vanity path on jcr content vanitypathonjcrcontent jcr content then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content vanitypathonjcrcontent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent jcr content vanity path on jcr content vanitypathonjcrcontent get name getname then return thenreturn jcr content vanity path on jcr content vanitypathonjcrcontent get parent getparent then return thenreturn vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content vanitypathonjcrcontent method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size assert null assertnull vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent jcr content assert not null assertnotnull vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent suppress warnings suppresswarnings unchecked test test do update vanity doupdatevanity exception field field map entries mapentries get declared field getdeclaredfield resolve maps map resolvemapsmap field set accessible setaccessible map string list map entry mapentry resolve maps map resolvemapsmap map string list map entry mapentry field map entries mapentries assert equals assertequals resolve maps map resolvemapsmap size field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size method method map entries mapentries get declared method getdeclaredmethod do add vanity doaddvanity string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do update vanity doupdatevanity string method set accessible setaccessible resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert not null assertnotnull resolve maps map resolvemapsmap target just vanity path justvanitypath assert null assertnull resolve maps map resolvemapsmap target just vanity path updated justvanitypathupdated assert equals assertequals vanity targets vanitytargets just vanity path justvanitypath size assert equals assertequals target just vanity path justvanitypath vanity targets vanitytargets just vanity path justvanitypath update vanity path just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path updated justvanitypathupdated method invoke map entries mapentries just vanity path justvanitypath assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert null assertnull resolve maps map resolvemapsmap target just vanity path justvanitypath assert not null assertnotnull resolve maps map resolvemapsmap target just vanity path updated justvanitypathupdated assert equals assertequals vanity targets vanitytargets just vanity path justvanitypath size assert equals assertequals target just vanity path updated justvanitypathupdated vanity targets vanitytargets just vanity path justvanitypath vanity jcr content resource vanity path on jcr content parent vanitypathonjcrcontentparent mock resource vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content parent vanitypathonjcrcontentparent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content parent vanitypathonjcrcontentparent get name getname then return thenreturn vanity path on jcr content vanitypathonjcrcontent resource vanity path on jcr content vanitypathonjcrcontent mock resource vanity path on jcr content vanitypathonjcrcontent resource resolver resourceresolver get resource getresource vanity path on jcr content vanitypathonjcrcontent jcr content then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content vanitypathonjcrcontent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent jcr content vanity path on jcr content vanitypathonjcrcontent get name getname then return thenreturn jcr content vanity path on jcr content vanitypathonjcrcontent get parent getparent then return thenreturn vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content vanitypathonjcrcontent method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert not null assertnotnull resolve maps map resolvemapsmap target vanity path on jcr content vanitypathonjcrcontent assert null assertnull resolve maps map resolvemapsmap target vanity path on jcr content updated vanitypathonjcrcontentupdated assert equals assertequals vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent size assert equals assertequals target vanity path on jcr content vanitypathonjcrcontent vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent update vanity path vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content updated vanitypathonjcrcontentupdated method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert null assertnull resolve maps map resolvemapsmap target vanity path on jcr content vanitypathonjcrcontent assert not null assertnotnull resolve maps map resolvemapsmap target vanity path on jcr content updated vanitypathonjcrcontentupdated assert equals assertequals vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent size assert equals assertequals target vanity path on jcr content updated vanitypathonjcrcontentupdated vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent suppress warnings suppresswarnings unchecked test test do remove vanity doremovevanity exception field field map entries mapentries get declared field getdeclaredfield resolve maps map resolvemapsmap field set accessible setaccessible map string list map entry mapentry resolve maps map resolvemapsmap map string list map entry mapentry field map entries mapentries assert equals assertequals resolve maps map resolvemapsmap size field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size method method map entries mapentries get declared method getdeclaredmethod do add vanity doaddvanity string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove vanity doremovevanity string method set accessible setaccessible resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert not null assertnotnull resolve maps map resolvemapsmap target just vanity path justvanitypath assert equals assertequals vanity targets vanitytargets just vanity path justvanitypath size assert equals assertequals target just vanity path justvanitypath vanity targets vanitytargets just vanity path justvanitypath remove vanity path method invoke map entries mapentries just vanity path justvanitypath counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert null assertnull resolve maps map resolvemapsmap target just vanity path justvanitypath vanity jcr content resource vanity path on jcr content parent vanitypathonjcrcontentparent mock resource vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content parent vanitypathonjcrcontentparent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content parent vanitypathonjcrcontentparent get name getname then return thenreturn vanity path on jcr content vanitypathonjcrcontent resource vanity path on jcr content vanitypathonjcrcontent mock resource vanity path on jcr content vanitypathonjcrcontent resource resolver resourceresolver get resource getresource vanity path on jcr content vanitypathonjcrcontent jcr content then return thenreturn vanity path on jcr content vanitypathonjcrcontent vanity path on jcr content vanitypathonjcrcontent get path getpath then return thenreturn vanity path on jcr content vanitypathonjcrcontent jcr content vanity path on jcr content vanitypathonjcrcontent get name getname then return thenreturn jcr content vanity path on jcr content vanitypathonjcrcontent get parent getparent then return thenreturn vanity path on jcr content parent vanitypathonjcrcontentparent vanity path on jcr content vanitypathonjcrcontent adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target vanity path on jcr content vanitypathonjcrcontent method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert not null assertnotnull resolve maps map resolvemapsmap target vanity path on jcr content vanitypathonjcrcontent assert equals assertequals vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent size assert equals assertequals target vanity path on jcr content vanitypathonjcrcontent vanity targets vanitytargets vanity path on jcr content vanitypathonjcrcontent remove vanity path method invoke map entries mapentries vanity path on jcr content vanitypathonjcrcontent jcr content assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert null assertnull resolve maps map resolvemapsmap target vanity path on jcr content vanitypathonjcrcontent suppress warnings suppresswarnings unchecked test test do update vanity order doupdatevanityorder exception field field map entries mapentries get declared field getdeclaredfield resolve maps map resolvemapsmap field set accessible setaccessible map string list map entry mapentry resolve maps map resolvemapsmap map string list map entry mapentry field map entries mapentries assert equals assertequals resolve maps map resolvemapsmap size field field map entries mapentries get declared field getdeclaredfield vanity targets vanitytargets field set accessible setaccessible map string list string vanity targets vanitytargets map string list string field map entries mapentries assert equals assertequals vanity targets vanitytargets size method method map entries mapentries get declared method getdeclaredmethod do add vanity doaddvanity string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do update vanity order doupdatevanityorder string method set accessible setaccessible resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath sling vanity order vanityorder method invoke map entries mapentries just vanity path justvanitypath assert equals assertequals resolve maps map resolvemapsmap size assert equals assertequals vanity targets vanitytargets size assert not null assertnotnull resolve maps map resolvemapsmap target just vanity path justvanitypath iterator map entry mapentry iterator resolve maps map resolvemapsmap target just vanity path justvanitypath iterator assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert false assertfalse iterator has next hasnext just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath sling vanity order vanityorder method invoke map entries mapentries just vanity path justvanitypath iterator resolve maps map resolvemapsmap target just vanity path justvanitypath iterator assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert false assertfalse iterator has next hasnext just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath method invoke map entries mapentries just vanity path justvanitypath iterator resolve maps map resolvemapsmap target just vanity path justvanitypath iterator assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert equals assertequals just vanity path justvanitypath html iterator get redirect getredirect assert false assertfalse iterator has next hasnext sling test test do add alias attributes with disable alias optimization doaddaliasattributeswithdisablealiasoptimization exception method method map entries mapentries get declared method getdeclaredmethod do add attributes doaddattributes string string method set accessible setaccessible resource resolver factory resourceresolverfactory is optimize alias resolution enabled isoptimizealiasresolutionenabled then return thenreturn map entries mapentries map entries mapentries resource resolver factory resourceresolverfactory bundle context bundlecontext event admin eventadmin field field map entries mapentries get declared field getdeclaredfield map root maproot field set accessible setaccessible field map entries mapentries map entries mapentries map root resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child string sling alias map string string alias map aliasmap map entries mapentries get alias map getaliasmap parent assert null assertnull alias map aliasmap sling test test do update attributes with disable alias optimization doupdateattributeswithdisablealiasoptimization exception method method map entries mapentries get declared method getdeclaredmethod do update attributes doupdateattributes string string method set accessible setaccessible resource resolver factory resourceresolverfactory is optimize alias resolution enabled isoptimizealiasresolutionenabled then return thenreturn map entries mapentries map entries mapentries resource resolver factory resourceresolverfactory bundle context bundlecontext event admin eventadmin field field map entries mapentries get declared field getdeclaredfield map root maproot field set accessible setaccessible field map entries mapentries map entries mapentries map root resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child string sling alias map string string alias map aliasmap map entries mapentries get alias map getaliasmap parent assert null assertnull alias map aliasmap sling test test do remove attribute ss with disable alias optimization doremoveattributesswithdisablealiasoptimization exception method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible resource resolver factory resourceresolverfactory is optimize alias resolution enabled isoptimizealiasresolutionenabled then return thenreturn map entries mapentries map entries mapentries resource resolver factory resourceresolverfactory bundle context bundlecontext event admin eventadmin field field map entries mapentries get declared field getdeclaredfield map root maproot field set accessible setaccessible field map entries mapentries map entries mapentries map root resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child string sling alias map string string alias map aliasmap map entries mapentries get alias map getaliasmap parent assert null assertnull alias map aliasmap suppress warnings suppresswarnings unchecked test test do add alias doaddalias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals child alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size test duplicate alias doesn t doesnt replace alias resource second result secondresult mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn second result secondresult second result secondresult get parent getparent then return thenreturn parent second result secondresult get path getpath then return thenreturn parent child second result secondresult get name getname then return thenreturn child second result secondresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals child alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size testing jcr content node resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent child jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent method invoke map entries mapentries parent child jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do add alias doaddalias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn resource result mock resource resource resolver resourceresolver get resource getresource parent then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent result get name getname then return thenreturn parent result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals parent alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size test duplicate alias doesn t doesnt replace alias resource second result secondresult mock resource resource resolver resourceresolver get resource getresource parent then return thenreturn second result secondresult second result secondresult get parent getparent then return thenreturn parent second result secondresult get path getpath then return thenreturn parent second result secondresult get name getname then return thenreturn parent second result secondresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals parent alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size testing jcr content node resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent method invoke map entries mapentries parent jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals parent alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do update alias doupdatealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do update attributes doupdateattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert false assertfalse alias map entry aliasmapentry contains key containskey alias updated aliasupdated assert equals assertequals child alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias updated aliasupdated method invoke map entries mapentries parent child string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert false assertfalse alias map entry aliasmapentry contains key containskey alias assert true asserttrue alias map entry aliasmapentry contains key containskey alias updated aliasupdated assert equals assertequals child alias map entry aliasmapentry alias updated aliasupdated assert equals assertequals alias map aliasmap size testing jcr content node update resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent child jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent result get child getchild jcr content then return thenreturn jcr content result jcrcontentresult method invoke map entries mapentries parent child jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert false assertfalse alias map entry aliasmapentry contains key containskey alias jcr content updated aliasjcrcontentupdated assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content updated aliasjcrcontentupdated method invoke map entries mapentries parent child jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert false assertfalse alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content updated aliasjcrcontentupdated assert equals assertequals child alias map entry aliasmapentry alias jcr content updated aliasjcrcontentupdated assert equals assertequals alias map aliasmap size update alias method invoke map entries mapentries parent child string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert false assertfalse alias map entry aliasmapentry contains key containskey alias assert true asserttrue alias map entry aliasmapentry contains key containskey alias updated aliasupdated assert equals assertequals child alias map entry aliasmapentry alias updated aliasupdated add node alias check update doesn sling resource second result secondresult mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn second result secondresult second result secondresult get parent getparent then return thenreturn parent second result secondresult get path getpath then return thenreturn parent child second result secondresult get name getname then return thenreturn child second result secondresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content updated aliasjcrcontentupdated method invoke map entries mapentries parent child jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert false assertfalse alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content updated aliasjcrcontentupdated assert equals assertequals child alias map entry aliasmapentry alias jcr content updated aliasjcrcontentupdated assert equals assertequals alias map aliasmap size result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content updated aliasjcrcontentupdated method invoke map entries mapentries parent child jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size assert false assertfalse alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content updated aliasjcrcontentupdated assert equals assertequals child alias map entry aliasmapentry alias jcr content updated aliasjcrcontentupdated assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do remove alias doremovealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals child alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size method invoke map entries mapentries parent child string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size add node test node deletion nodedeletion method invoke map entries mapentries parent child alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals child alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size resource resolver resourceresolver get resource getresource parent child then return thenreturn method invoke map entries mapentries parent child string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do remove alias doremovealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap testing jcr content node removal resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent child jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent result get child getchild jcr content then return thenreturn jcr content result jcrcontentresult method invoke map entries mapentries parent child jcr content map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size method invoke map entries mapentries parent child jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size add node test node deletion nodedeletion method invoke map entries mapentries parent child jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn result get child getchild jcr content then return thenreturn method invoke map entries mapentries parent child jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do remove alias doremovealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn parent resource result mock resource resource resolver resourceresolver get resource getresource parent child then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent child result get name getname then return thenreturn child result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent child resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent child jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent result get child getchild jcr content then return thenreturn jcr content result jcrcontentresult method invoke map entries mapentries parent child jcr content map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent test nodes assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size method invoke map entries mapentries parent child jcr content string sling alias assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size add node test parent child method invoke map entries mapentries parent child jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map entry aliasmapentry size method invoke map entries mapentries parent child string sling alias assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size add node test node removal method invoke map entries mapentries parent child alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map entry aliasmapentry size resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn result get child getchild jcr content then return thenreturn method invoke map entries mapentries parent child jcr content string sling alias assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert equals assertequals alias map entry aliasmapentry size add node test node removal parent child resource resolver resourceresolver get resource getresource parent child jcr content then return thenreturn jcr content result jcrcontentresult result get child getchild jcr content then return thenreturn jcr content result jcrcontentresult method invoke map entries mapentries parent child jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals child alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map entry aliasmapentry size method invoke map entries mapentries parent child string sling alias assert equals assertequals alias map aliasmap size alias map entry aliasmapentry map entries mapentries get alias map getaliasmap parent assert null assertnull alias map entry aliasmapentry suppress warnings suppresswarnings unchecked test test do remove alias doremovealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn resource result mock resource resource resolver resourceresolver get resource getresource parent then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent result get name getname then return thenreturn parent result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias method invoke map entries mapentries parent map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals parent alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size method invoke map entries mapentries parent string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size add node test node deletion nodedeletion method invoke map entries mapentries parent alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias assert equals assertequals parent alias map entry aliasmapentry alias assert equals assertequals alias map aliasmap size resource resolver resourceresolver get resource getresource parent then return thenreturn method invoke map entries mapentries parent string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size suppress warnings suppresswarnings unchecked test test do remove alias doremovealias exception method method map entries mapentries get declared method getdeclaredmethod do add alias doaddalias string method set accessible setaccessible method method map entries mapentries get declared method getdeclaredmethod do remove attributes doremoveattributes string string method set accessible setaccessible field field map entries mapentries get declared field getdeclaredfield alias map aliasmap field set accessible setaccessible map string map string string alias map aliasmap map string map string string field map entries mapentries assert equals assertequals alias map aliasmap size resource parent mock resource parent get path getpath then return thenreturn resource result mock resource resource resolver resourceresolver get resource getresource parent then return thenreturn result result get parent getparent then return thenreturn parent result get path getpath then return thenreturn parent result get name getname then return thenreturn parent result adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap testing jcr content node removal resource jcr content result jcrcontentresult mock resource resource resolver resourceresolver get resource getresource parent jcr content then return thenreturn jcr content result jcrcontentresult jcr content result jcrcontentresult get parent getparent then return thenreturn result jcr content result jcrcontentresult get path getpath then return thenreturn parent jcr content jcr content result jcrcontentresult get name getname then return thenreturn jcr content jcr content result jcrcontentresult adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling alias alias jcr content aliasjcrcontent result get child getchild jcr content then return thenreturn jcr content result jcrcontentresult method invoke map entries mapentries parent jcr content map string string alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals parent alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size method invoke map entries mapentries parent jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size add node test node deletion nodedeletion method invoke map entries mapentries parent jcr content alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert not null assertnotnull alias map entry aliasmapentry assert true asserttrue alias map entry aliasmapentry contains key containskey alias jcr content aliasjcrcontent assert equals assertequals parent alias map entry aliasmapentry alias jcr content aliasjcrcontent assert equals assertequals alias map aliasmap size resource resolver resourceresolver get resource getresource parent jcr content then return thenreturn result get child getchild jcr content then return thenreturn method invoke map entries mapentries parent jcr content string sling alias alias map entry aliasmapentry map entries mapentries get alias map getaliasmap assert null assertnull alias map entry aliasmapentry assert equals assertequals alias map aliasmap size test test is valid vanity path isvalidvanitypath exception method method map entries mapentries get declared method getdeclaredmethod is valid vanity path isvalidvanitypath resource method set accessible setaccessible resource resource mock resource resource get path getpath then return thenreturn jcr system node assert false assertfalse method invoke map entries mapentries resource resource get path getpath then return thenreturn just vanity path justvanitypath assert false assertfalse method invoke map entries mapentries resource resource adapt to adaptto value map valuemap then return thenreturn mock value map valuemap assert true asserttrue method invoke map entries mapentries resource test sling test do node added donodeadded exception method method map entries mapentries get declared method getdeclaredmethod do node added donodeadded string method set accessible setaccessible res freshed resfreshed method invoke map entries mapentries node assert true asserttrue res freshed resfreshed boolean value booleanvalue test sling test get vanity paths getvanitypaths exception field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries method method map entries mapentries get declared method getdeclaredmethod get vanity paths getvanitypaths string method set accessible setaccessible method invoke map entries mapentries not existing notexisting field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test get vanity paths getvanitypaths exception resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries method method map entries mapentries get declared method getdeclaredmethod get vanity paths getvanitypaths string method set accessible setaccessible method invoke map entries mapentries target just vanity path justvanitypath field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath sling vanity order vanityorder resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator method invoke map entries mapentries target just vanity path justvanitypath counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test get vanity paths getvanitypaths exception resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries startup maxcachedvanitypathentriesstartup field set accessible setaccessible field map entries mapentries method method map entries mapentries get declared method getdeclaredmethod get vanity paths getvanitypaths string method set accessible setaccessible method invoke map entries mapentries target just vanity path justvanitypath field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test get vanity paths getvanitypaths exception resource bad vanity path badvanitypath mock resource bad vanity path badvanitypath bad vanity path badvanitypath get path getpath then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath get name getname then return thenreturn bad vanity path badvanitypath bad vanity path badvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath content mypage resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton bad vanity path badvanitypath iterator collections resource empty set emptyset iterator field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries startup maxcachedvanitypathentriesstartup field set accessible setaccessible field map entries mapentries method method map entries mapentries get declared method getdeclaredmethod get vanity paths getvanitypaths string method set accessible setaccessible method invoke map entries mapentries content mypage field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test get vanity paths getvanitypaths exception resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries startup maxcachedvanitypathentriesstartup field set accessible setaccessible field map entries mapentries method method map entries mapentries get declared method getdeclaredmethod get vanity paths getvanitypaths string method set accessible setaccessible method invoke map entries mapentries target just vanity path justvanitypath field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath sling vanity order vanityorder resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator method invoke map entries mapentries target just vanity path justvanitypath counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test load vanity paths loadvanitypaths exception field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator method method map entries mapentries get declared method getdeclaredmethod load vanity paths loadvanitypaths method set accessible setaccessible method invoke map entries mapentries field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test load vanity paths loadvanitypaths exception resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator method method map entries mapentries get declared method getdeclaredmethod load vanity paths loadvanitypaths method set accessible setaccessible method invoke map entries mapentries field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test get map entry list getmapentrylist exception list map entry mapentry entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator method method map entries mapentries get declared method getdeclaredmethod get map entry list getmapentrylist string method set accessible setaccessible method invoke map entries mapentries target just vanity path justvanitypath entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size field vanity counter vanitycounter map entries mapentries get declared field getdeclaredfield vanity counter vanitycounter vanity counter vanitycounter set accessible setaccessible atomic long atomiclong counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue method invoke map entries mapentries target just vanity path justvanitypath entries map entries mapentries get resolve maps getresolvemaps assert equals assertequals entries size counter atomic long atomiclong vanity counter vanitycounter map entries mapentries assert equals assertequals counter long value longvalue test sling test concutrrent get resolve maps iterator getresolvemapsiterator exception executor service executorservice pool executors new fixed thread pool newfixedthreadpool resource just vanity path justvanitypath mock resource just vanity path justvanitypath resource resolver resourceresolver get resource getresource just vanity path justvanitypath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get path getpath then return thenreturn just vanity path justvanitypath just vanity path justvanitypath get name getname then return thenreturn just vanity path justvanitypath just vanity path justvanitypath adapt to adaptto value map valuemap then return thenreturn build value map buildvaluemap sling vanity path vanitypath target just vanity path justvanitypath resource resolver resourceresolver find resources findresources any string anystring sql then answer thenanswer answer iterator resource iterator resource answer invocation on mock invocationonmock invocation throwable invocation get arguments getarguments to string tostring sling vanity path vanitypath collections singleton just vanity path justvanitypath iterator collections resource empty set emptyset iterator field field map entries mapentries get declared field getdeclaredfield max cached vanity path entries maxcachedvanitypathentries field set accessible setaccessible field map entries mapentries array list arraylist data future datafuture list array list arraylist data future datafuture list add create data future createdatafuture pool map entries mapentries data future datafuture list methods data future datafuture create data future createdatafuture executor service executorservice pool map entries mapentries map entries mapentries iterator pool sub mit submit callable iterator override iterator map entry mapentry call exception map entries mapentries get resolve maps iterator getresolvemapsiterator http localhost target just vanity path justvanitypath data future datafuture data future datafuture iterator data future datafuture iterator
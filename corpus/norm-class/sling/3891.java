licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr resource internal helper jcr java byte array input stream bytearrayinputstream java input stream inputstream java util hash set hashset java util map java util javax jcr node javax jcr repository exception repositoryexception javax jcr session org apache jackrabbit jcr constants jcrconstants org apache sling api resource resource org apache sling api resource resource metadata resourcemetadata org apache sling jcr resource jcr resource constants jcrresourceconstants org apache sling jcr resource internal helper data helperdata org apache sling jcr resource internal path mapper impl pathmapperimpl jcr node resource test jcrnoderesourcetest jcr item resource test base jcritemresourcetestbase helper data helperdata get helper data gethelperdata exception helper data helperdata path mapper impl pathmapperimpl test linked file testlinkedfile exception string file name filename file string linked file name linkedfilename linked file linkedfile session session get session getsession node file root node rootnode add node addnode file name filename jcr constants jcrconstants file node res file add node addnode jcr constants jcrconstants jcr content jcr constants jcrconstants resource setup resource setupresource res file add mixin addmixin jcr constants jcrconstants mix reference able referenceable session save node linked file linkedfile root node rootnode add node addnode linked file name linkedfilename jcr constants jcrconstants link edfile linkedfile linked file linkedfile set property setproperty jcr constants jcrconstants jcr content file session save jcr node resource jcrnoderesource linked file resource linkedfileresource jcr node resource jcrnoderesource linked file linkedfile get path getpath linked file linkedfile get helper data gethelperdata assert equals assertequals test data linked file resource linkedfileresource adapt to adaptto input stream inputstream test nt file nt resource testntfilentresource exception string file node file root node rootnode add node addnode jcr constants jcrconstants file node res file add node addnode jcr constants jcrconstants jcr content jcr constants jcrconstants resource setup resource setupresource res get session getsession save file root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource file get path getpath file get helper data gethelperdata assert equals assertequals file get path getpath jnr get path getpath assert resource meta data assertresourcemetadata jnr get resource metadata getresourcemetadata assert equals assertequals test data jnr adapt to adaptto input stream inputstream test nt file nt unstructured testntfilentunstructured exception string file unstructured fileunstructured node file root node rootnode add node addnode jcr constants jcrconstants file node res file add node addnode jcr constants jcrconstants jcr content jcr constants jcrconstants unstructured setup resource setupresource res get session getsession save file root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource file get path getpath file get helper data gethelperdata assert equals assertequals file get path getpath jnr get path getpath assert resource meta data assertresourcemetadata jnr get resource metadata getresourcemetadata assert equals assertequals test data jnr adapt to adaptto input stream inputstream test nt resource testntresource exception string resource node res root node rootnode add node addnode jcr constants jcrconstants resource setup resource setupresource res get session getsession save res root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource res get path getpath res get helper data gethelperdata assert equals assertequals res get path getpath jnr get path getpath assert resource meta data assertresourcemetadata jnr get resource metadata getresourcemetadata assert equals assertequals test data jnr adapt to adaptto input stream inputstream test nt unstructured testntunstructured exception string unstructured node res root node rootnode add node addnode jcr constants jcrconstants unstructured setup resource setupresource res get session getsession save res root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource res get path getpath res get helper data gethelperdata assert equals assertequals res get path getpath jnr get path getpath assert resource meta data assertresourcemetadata jnr get resource metadata getresourcemetadata assert equals assertequals test data jnr adapt to adaptto input stream inputstream test resource type testresourcetype exception string resource type resourcetype node node root node rootnode add node addnode jcr constants jcrconstants unstructured get session getsession save jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource node get path getpath node get helper data gethelperdata assert equals assertequals jcr constants jcrconstants unstructured jnr get resource type getresourcetype string type name typename resource type node set property setproperty jcr resource constants jcrresourceconstants sling resource type property type name typename get session getsession save jnr jcr node resource jcrnoderesource node get path getpath node get helper data gethelperdata assert equals assertequals type name typename jnr get resource type getresourcetype test resource super type testresourcesupertype exception string resource super type resourcesupertype string type node name typenodename resource type string type name typename root path rootpath type node name typenodename node node root node rootnode add node addnode jcr constants jcrconstants unstructured node set property setproperty jcr resource constants jcrresourceconstants sling resource type property type name typename get session getsession save resource jnr jcr node resource jcrnoderesource node get path getpath node get helper data gethelperdata assert equals assertequals type name typename jnr get resource type getresourcetype type assert null assertnull jnr get resource super type getresourcesupertype string super type name supertypename supertype node type node typenode root node rootnode add node addnode type node name typenodename jcr constants jcrconstants unstructured type node typenode set property setproperty jcr resource constants jcrresourceconstants sling resource type property super type name supertypename get session getsession save jnr jcr node resource jcrnoderesource type node typenode get path getpath type node typenode get helper data gethelperdata assert equals assertequals jcr constants jcrconstants unstructured jnr get resource type getresourcetype assert equals assertequals super type name supertypename jnr get resource super type getresourcesupertype overwrite type direct property string other super type name othersupertypename others upertype othersupertype node set property setproperty jcr resource constants jcrresourceconstants sling resource type property other super type name othersupertypename get session getsession save jnr jcr node resource jcrnoderesource node get path getpath node get helper data gethelperdata assert equals assertequals type name typename jnr get resource type getresourcetype assert equals assertequals other super type name othersupertypename jnr get resource super type getresourcesupertype remove direct property supertype node get property getproperty jcr resource constants jcrresourceconstants sling resource type property remove get session getsession save jnr jcr node resource jcrnoderesource node get path getpath node get helper data gethelperdata assert equals assertequals type name typename jnr get resource type getresourcetype assert null assertnull jnr get resource super type getresourcesupertype test adapt to map testadapttomap exception string adaptable node res root node rootnode add node addnode jcr constants jcrconstants unstructured setup resource setupresource res get session getsession save res root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource res get path getpath res get helper data gethelperdata map props jnr adapt to adaptto map properties fails property retrieval fails reason assert not null assertnotnull props assert false assertfalse props is empty isempty properties assert equals assertequals test modified props jcr constants jcrconstants jcr lastmodified assert equals assertequals test type props jcr constants jcrconstants jcr mimetype assert equals assertequals test encoding props jcr constants jcrconstants jcr encoding assert equals assertequals test data input stream inputstream props jcr constants jcrconstants jcr data jcr managed properties assert equals assertequals jcr constants jcrconstants unstructured props jcr constants jcrconstants jcr primarytype left string existing keys existingkeys hash set hashset string existing keys existingkeys add jcr constants jcrconstants jcr lastmodified existing keys existingkeys add jcr constants jcrconstants jcr mimetype existing keys existingkeys add jcr constants jcrconstants jcr encoding existing keys existingkeys add jcr constants jcrconstants jcr data existing keys existingkeys add jcr constants jcrconstants jcr primarytype object cross check crosscheck hash set hashset object props key set keyset cross check crosscheck remove all removeall existing keys existingkeys assert true asserttrue cross check crosscheck is empty isempty call time ensure map data map props second propssecond jnr adapt to adaptto map properties fails property retrieval fails reason assert not null assertnotnull props second propssecond assert false assertfalse props second propssecond is empty isempty properties assert equals assertequals test modified props second propssecond jcr constants jcrconstants jcr lastmodified assert equals assertequals test type props second propssecond jcr constants jcrconstants jcr mimetype assert equals assertequals test encoding props second propssecond jcr constants jcrconstants jcr encoding assert equals assertequals test data input stream inputstream props second propssecond jcr constants jcrconstants jcr data jcr managed properties assert equals assertequals jcr constants jcrconstants unstructured props second propssecond jcr constants jcrconstants jcr primarytype left object cross check crosscheck hash set hashset object props second propssecond key set keyset cross check crosscheck remove all removeall existing keys existingkeys assert true asserttrue cross check crosscheck is empty isempty testcorrectutf byte length bytelength exception utf bytes ãœbersã¤ttigung get bytes getbytes utf string utf file node file root node rootnode add node addnode jcr constants jcrconstants file node res file add node addnode jcr constants jcrconstants jcr content jcr constants jcrconstants resource res set property setproperty jcr constants jcrconstants jcr lastmodified test modified res set property setproperty jcr constants jcrconstants jcr mimetype test type res set property setproperty jcr constants jcrconstants jcr encoding utf res set property setproperty jcr constants jcrconstants jcr data byte array input stream bytearrayinputstream utf bytes get session getsession save file root node rootnode get node getnode jcr node resource jcrnoderesource jnr jcr node resource jcrnoderesource file get path getpath file get helper data gethelperdata assert equals assertequals utf bytes jnr adapt to adaptto input stream inputstream assert equals assertequals utf bytes length jnr get resource metadata getresourcemetadata get content length getcontentlength setup resource setupresource node res repository exception repositoryexception res set property setproperty jcr constants jcrconstants jcr lastmodified test modified res set property setproperty jcr constants jcrconstants jcr mimetype test type res set property setproperty jcr constants jcrconstants jcr encoding test encoding res set property setproperty jcr constants jcrconstants jcr data byte array input stream bytearrayinputstream test data assert resource meta data assertresourcemetadata resource metadata resourcemetadata assert not null assertnotnull assert equals assertequals test modified get modification time getmodificationtime assert equals assertequals test type get content type getcontenttype assert equals assertequals test encoding get character encoding getcharacterencoding
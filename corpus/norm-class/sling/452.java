licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling models impl org junit assert not null assertnotnull org junit assert null assertnull org junit assert same assertsame org mockito matchers org mockito mockito java util hashtable org apache sling api sling http servlet request slinghttpservletrequest org apache sling models impl injectors self injector selfinjector org apache sling models test models testmodels classes direct cyclic self dependency model directcyclicselfdependencymodel org apache sling models test models testmodels classes indirect cyclic self dependency model a indirectcyclicselfdependencymodela org apache sling models test models testmodels classes self dependency model a selfdependencymodela org apache sling models test models testmodels classes self dependency model b selfdependencymodelb org junit org junit test org junit runner run with runwith org mockito mock org mockito invocation invocation on mock invocationonmock org mockito run ners runners mockito unit runner mockitojunitrunner org mockito stub bin g stubbing answer org osgi framework bundle context bundlecontext org osgi service component component context componentcontext run with runwith mockito unit runner mockitojunitrunner self dependency test selfdependencytest mock component context componentcontext component ctx componentctx mock bundle context bundlecontext bundle context bundlecontext model adapter factory modeladapterfactory factory mock sling http servlet request slinghttpservletrequest request suppress warnings suppresswarnings unchecked setup component ctx componentctx get bundle context getbundlecontext then return thenreturn bundle context bundlecontext component ctx componentctx get properties getproperties then return thenreturn hashtable string object request adapt to adaptto answer object override object answer invocation on mock invocationonmock invocation throwable clazz invocation get arguments getarguments factory get adapter getadapter request clazz factory model adapter factory modeladapterfactory factory activate component ctx componentctx factory bind injector bindinjector self injector selfinjector service properties map servicepropertiesmap test test chained self dependency testchainedselfdependency self dependency model a selfdependencymodela object a objecta factory get adapter getadapter request self dependency model a selfdependencymodela assert not null assertnotnull object a objecta self dependency model b selfdependencymodelb object b objectb object a objecta get dependency b getdependencyb assert not null assertnotnull object b objectb assert same assertsame request object b objectb get request getrequest test test direct cyclic self dependency testdirectcyclicselfdependency direct cyclic self dependency model directcyclicselfdependencymodel object factory get adapter getadapter request direct cyclic self dependency model directcyclicselfdependencymodel assert null assertnull object test test ind direct cyclic self dependency testinddirectcyclicselfdependency indirect cyclic self dependency model a indirectcyclicselfdependencymodela object factory get adapter getadapter request indirect cyclic self dependency model a indirectcyclicselfdependencymodela assert null assertnull object
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event impl jobs jmx java util java util dictionary org apache sling event jobs queue org apache sling event jobs statistics org apache sling event jobs jmx statisticsmbean org junit org junit org junit test org mockito argument captor argumentcaptor org mockito captor org mockito mock org mockito mockito org mockito mockito annotations mockitoannotations org osgi framework bundle context bundlecontext org osgi framework service registration serviceregistration org osgi service component component context componentcontext queues bean impl test queuesmbeanimpltest queues bean impl queuesmbeanimpl mbean mock bundle context bundlecontext bundle context bundlecontext mock component context componentcontext component context componentcontext captor argument captor argumentcaptor string service class serviceclass captor argument captor argumentcaptor object service object serviceobject suppress warnings suppresswarnings rawtypes captor argument captor argumentcaptor dictionary service properties serviceproperties mock service registration serviceregistration service registration serviceregistration queues bean impl test queuesmbeanimpltest mockito annotations mockitoannotations init mocks initmocks setup no such field exception nosuchfieldexception mbean queues bean impl queuesmbeanimpl mockito component context componentcontext get bundle context getbundlecontext then return thenreturn bundle context bundlecontext mbean activate component context componentcontext get bundle context getbundlecontext test test add queue testaddqueue add queue addqueue queue add queue addqueue queue queue mockito mock queue mockito with settings withsettings extra interfaces extrainterfaces statistics mock statistics mockstatistics statistics queue mockito queue get name getname then return thenreturn queue mockito bundle context bundlecontext register service registerservice mockito any string anystring mockito statisticsmbean mockito dictionary then return thenreturn service registration serviceregistration mbean send event sendevent queue status event queuestatusevent queue mockito verify bundle context bundlecontext mockito register service registerservice service class serviceclass capture service object serviceobject capture service properties serviceproperties capture assert equals assertequals expected bean register d registerd statisticsmbean statisticsmbean get name getname service class serviceclass get value getvalue assert true asserttrue expected service instance satisticsmbean service object serviceobject get value getvalue statisticsmbean assert not null assertnotnull expected properties jmx object name objectname service properties serviceproperties get value getvalue jmx object name objectname test statistics teststatistics statisticsmbean service object serviceobject get value getvalue queue test update queue updatequeue queue first queue firstqueue add queue addqueue queue queue mockito mock queue mockito with settings withsettings extra interfaces extrainterfaces statistics mockito queue get name getname then return thenreturn queue changed mockito reset bundle context bundlecontext mbean send event sendevent queue status event queuestatusevent queue first queue firstqueue mockito verify bundle context bundlecontext mockito register service registerservice service class serviceclass capture service object serviceobject capture service properties serviceproperties capture test remove queue removequeue queue first queue firstqueue add queue addqueue mbean send event sendevent queue status event queuestatusevent first queue firstqueue mockito verify service registration serviceregistration mockito unregister mock statistics mockstatistics statistics queue mockito queue get start time getstarttime then return thenreturn mockito queue get number of finished jobs getnumberoffinishedjobs then return thenreturn mockito queue get number of cancelled jobs getnumberofcancelledjobs then return thenreturn mockito queue get number of failed jobs getnumberoffailedjobs then return thenreturn mockito queue get number of processed jobs getnumberofprocessedjobs then return thenreturn mockito queue get number of active jobs getnumberofactivejobs then return thenreturn mockito queue get number of queue d jobs getnumberofqueuedjobs then return thenreturn mockito queue get number of jobs getnumberofjobs then return thenreturn mockito queue get last activated job time getlastactivatedjobtime then return thenreturn mockito queue get last finished job time getlastfinishedjobtime then return thenreturn mockito queue get average waiting time getaveragewaitingtime then return thenreturn mockito queue get average processing time getaverageprocessingtime then return thenreturn test statistics teststatistics statisticsmbean statistics mbean statisticsmbean assert equals assertequals statistics mbean statisticsmbean get start time getstarttime assert equals assertequals statistics mbean statisticsmbean get number of finished jobs getnumberoffinishedjobs assert equals assertequals statistics mbean statisticsmbean get number of cancelled jobs getnumberofcancelledjobs assert equals assertequals statistics mbean statisticsmbean get number of failed jobs getnumberoffailedjobs assert equals assertequals statistics mbean statisticsmbean get number of processed jobs getnumberofprocessedjobs assert equals assertequals statistics mbean statisticsmbean get number of active jobs getnumberofactivejobs assert equals assertequals statistics mbean statisticsmbean get number of queue d jobs getnumberofqueuedjobs assert equals assertequals statistics mbean statisticsmbean get number of jobs getnumberofjobs assert equals assertequals statistics mbean statisticsmbean get last activated job time getlastactivatedjobtime assert equals assertequals statistics mbean statisticsmbean get last activated job date getlastactivatedjobdate assert equals assertequals statistics mbean statisticsmbean get last finished job time getlastfinishedjobtime assert equals assertequals statistics mbean statisticsmbean get last finished job date getlastfinishedjobdate assert equals assertequals statistics mbean statisticsmbean get average waiting time getaveragewaitingtime assert equals assertequals statistics mbean statisticsmbean get average processing time getaverageprocessingtime
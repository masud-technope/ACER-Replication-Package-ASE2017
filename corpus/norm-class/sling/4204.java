licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling commons scheduler impl org apache sling testing mock osgi mock osgi mockosgi org junit org junit test org osgi framework bundle context bundlecontext java lang reflect field java util concurrent atomic atomic boolean atomicboolean org junit settings support test settingssupporttest settings support settingssupport listener listener bundle context bundlecontext context set up setup context mock osgi mockosgi new bundle context newbundlecontext listener settings support settingssupport listener context test test activate deactivate testactivatedeactivate no such field exception nosuchfieldexception illegal access exception illegalaccessexception settings support settingssupport support settings support settingssupport support activate context field settings listener private field settingslistenerprivatefield settings support settingssupport get declared field getdeclaredfield settings listener settingslistener settings listener private field settingslistenerprivatefield set accessible setaccessible assert not null assertnotnull settings listener private field settingslistenerprivatefield support support deactivate assert null assertnull settings listener private field settingslistenerprivatefield support test test start and stop teststartandstop no such field exception nosuchfieldexception illegal access exception illegalaccessexception listener start field active field activefield listener get class getclass get declared field getdeclaredfield active active field activefield set accessible setaccessible atomic boolean atomicboolean is active isactive atomic boolean atomicboolean active field activefield listener assert true asserttrue is active isactive listener assert false assertfalse is active isactive
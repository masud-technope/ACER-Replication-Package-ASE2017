licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting java script javascript wrapper java text simple date format simpledateformat java util calendar javax jcr node javax jcr property javax jcr org apache sling commons json jcr json item writer jsonitemwriter org apache sling scripting java script javascript repository scripting test base repositoryscriptingtestbase org apache sling scripting java script javascript internal script engine helper scriptenginehelper test scriptable node scriptablenode live retrieving nodes repository executing java script javascript code scriptable node test scriptablenodetest repository scripting test base repositoryscriptingtestbase node node property text property textproperty string test text testtext property num property numproperty test num testnum property cal property calproperty calendar test cal testcal script engine helper scriptenginehelper data data override set up setup exception set up setup node get new node getnewnode test text testtext test system current time millis currenttimemillis node set property setproperty text test text testtext node set property setproperty other property otherproperty node get path getpath test num testnum system current time millis currenttimemillis node set property setproperty num test num testnum test cal testcal calendar get instance getinstance node set property setproperty cal test cal testcal data script engine helper scriptenginehelper data data node node text property textproperty node get property getproperty text data property text property textproperty num property numproperty node get property getproperty num data num property numproperty num property numproperty cal property calproperty node get property getproperty cal data cal property calproperty cal property calproperty test default value testdefaultvalue exception script engine helper scriptenginehelper data data script engine helper scriptenginehelper data data node get test root node gettestrootnode assert equals assertequals get test root node gettestrootnode get path getpath script eval to string evaltostring print node data test primary node type testprimarynodetype exception script engine helper scriptenginehelper data data script engine helper scriptenginehelper data data node get test root node gettestrootnode assert equals assertequals unstructured script eval to string evaltostring print node get primary node type getprimarynodetype get name getname data test primary node type property testprimarynodetypeproperty exception script engine helper scriptenginehelper data data script engine helper scriptenginehelper data data node get test root node gettestrootnode assert equals assertequals unstructured script eval to string evaltostring print node jcr primary type primarytype data test via property no wrappers testviapropertynowrappers exception assert equals assertequals test text testtext script eval to string evaltostring print property string data test via property with wrappers testviapropertywithwrappers exception assert equals assertequals text property textproperty get string getstring script eval to string evaltostring print property data test via node direct property access testvianodedirectpropertyaccess exception assert equals assertequals test text testtext script eval to string evaltostring print node text data test via property no wrappers num testviapropertynowrappersnum exception assert equals assertequals test num testnum script eval num property numproperty get double getdouble data test via property with wrappers num testviapropertywithwrappersnum exception assert equals assertequals test num testnum script eval num property numproperty data test via node direct property access num testvianodedirectpropertyaccessnum exception assert equals assertequals test num testnum script eval node num data test via property no wrappers cal testviapropertynowrapperscal exception assert equals assertequals test cal testcal get time in millis gettimeinmillis script eval cal property calproperty get date getdate get time in millis gettimeinmillis data test via node direct property access cal testvianodedirectpropertyaccesscal exception simple date format simpledateformat simple date format simpledateformat json item writer jsonitemwriter ecma format json item writer jsonitemwriter format locale string expected format test cal testcal get time gettime assert equals assertequals expected script eval to string evaltostring print node cal data test cal date class testcaldateclass exception assert equals assertequals number script eval to string evaltostring print type of typeof node cal time data test property parent testpropertyparent exception node get property getproperty num scriptable property scriptableproperty node num returns wrapped assert equals assertequals unstructured script eval node get property getproperty num parent jcr primary type primarytype data test property ancestor testpropertyancestor exception call get ancestor getancestor explicitly defined scriptable property scriptableproperty verify property methods correctly wrapped result sling assert equals assertequals rep root script eval node get property getproperty num get ancestor getancestor jcr primary type primarytype data test properties iteration no wrapper testpropertiesiterationnowrapper exception string code props node get properties getproperties props print props print string result script eval to string evaltostring code data string names text other property otherproperty string names assert true asserttrue result result result test add node default type testaddnodedefaulttype exception string path sub dt subdt system current time millis currenttimemillis string code node add node addnode path print jcr primary type primarytype assert equals assertequals unstructured script eval to string evaltostring code data test add node specific type testaddnodespecifictype exception string path subst system current time millis currenttimemillis string code node add node addnode path folder print jcr primary type primarytype assert equals assertequals folder script eval to string evaltostring code data test get node testgetnode exception string path sub gn subgn system current time millis currenttimemillis string code node add node addnode path resource node get node getnode path print jcr primary type primarytype assert equals assertequals resource script eval to string evaltostring code data test get property testgetproperty exception string code print node get property getproperty text assert equals assertequals test text testtext script eval to string evaltostring code data test get nodes no pattern testgetnodesnopattern exception string path sub gnnp subgnnp system current time millis currenttimemillis string code node add node addnode path node add node addnode path nodes node get nodes getnodes nodes print nodes get name getname assert equals assertequals path path script eval to string evaltostring code data test get nodes with pattern testgetnodeswithpattern exception string path sub gnnp subgnnp system current time millis currenttimemillis string code node add node addnode path node add node addnode path node add node addnode path nodes node get nodes getnodes nodes print nodes get name getname assert equals assertequals path path script eval to string evaltostring code data test remove node testremovenode exception string code node add node addnode toremove print node has node hasnode toremove print node get node getnode toremove remove print node has node hasnode toremove assert equals assertequals script eval to string evaltostring code data test sling test for current node testforcurrentnode exception string code node print assert equals assertequals script eval to string evaltostring code data test child node access testchildnodeaccess exception string path sub tcna subtcna system current time millis currenttimemillis string code node add node addnode path node get node getnode path print jcr primary type primarytype print node path print jcr primary type primarytype assert equals assertequals unstructured unstructured script eval to string evaltostring code data verify get ancestor getancestor method explicit ely explicitely defined scriptable node scriptablenode check sling test get ancestor testgetancestor exception string code print node get ancestor getancestor get path getpath assert equals assertequals script eval to string evaltostring code data string code print node get ancestor getancestor jcr primary type primarytype assert equals assertequals rep root script eval to string evaltostring code data test is node type testisnodetype exception string code print node is node type isnodetype unstructured print print node is node type isnodetype file assert equals assertequals script eval to string evaltostring code data test get session testgetsession exception assert equals assertequals root node node session script eval node session get root node getrootnode get path getpath data assert equals assertequals root node node get session getsession script eval node get session getsession get root node getrootnode get path getpath data test reg res sing regressing issue https issues apache org jira browse sling test multi val reference prop lookup testmultivalreferenceproplookup exception node ref node refnode get new node getnewnode ref node refnode add mixin addmixin mix reference able referenceable node ref node refnode get new node getnewnode ref node refnode add mixin addmixin mix reference able referenceable node set property setproperty single ref singleref ref node refnode node set property setproperty multi ref multiref session get value factory getvaluefactory create value createvalue ref node refnode session get value factory getvaluefactory create value createvalue ref node refnode string code node single ref singleref assert true asserttrue script eval code data node code node multi ref multiref assert true asserttrue script eval code data node
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling form impl jaas java util dictionary javax security spi login module loginmodule org apache felix jaas login module factory loginmodulefactory org apache sling form impl form authentication handler formauthenticationhandler org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service registration serviceregistration org slf logger org slf logger factory loggerfactory jaas helper jaashelper logger log logger factory loggerfactory get logger getlogger jaas helper jaashelper form authentication handler formauthenticationhandler auth handler authhandler login module service registration service registration serviceregistration factory registration factoryregistration opens initializes helper registers login module factory lmf service param ctx bundle context param properties properties jaas lmf service properties jaas helper jaashelper form authentication handler formauthenticationhandler auth handler authhandler bundle context bundlecontext ctx dictionary properties auth handler authhandler auth handler authhandler dynamically register login module factory loginmodulefactory detect login module hasssologinmodule ctx factory registration factoryregistration register login module factory registerloginmodulefactory ctx properties factory registration factoryregistration checks jaas support enabled sso login module code jaas support enabled enabled factory registration factoryregistration closes helper unregisters login module factory needed close factory registration factoryregistration factory registration factoryregistration unregister service registration serviceregistration register login module factory registerloginmodulefactory bundle context bundlecontext ctx dictionary properties service registration serviceregistration reg java util properties props java util properties string desc login module loginmodule support form authentication handler formauthenticationhandler props constants service description desc props constants service vendor ctx get bundle getbundle get headers getheaders constants bundle vendor props login module factory loginmodulefactory jaas ranking properties login module factory loginmodulefactory jaas ranking props login module factory loginmodulefactory jaas control flag properties login module factory loginmodulefactory jaas control flag props login module factory loginmodulefactory jaas realm properties login module factory loginmodulefactory jaas realm reg ctx register service registerservice login module factory loginmodulefactory get name getname login module factory loginmodulefactory login module loginmodule create login module createloginmodule form login module formloginmodule auth handler authhandler override string to string tostring desc form login module formloginmodule get name getname props log info registered form login module factory formloginmodulefactory throwable log error unable create register sso login module factory reg checks link org apache sling form impl jaas form login module formloginmodule oak setup note checks login module loaded enabled jaas config code sso login module ssologinmodule hasssologinmodule bundle context bundlecontext ctx ctx get bundle getbundle load class loadclass org apache sling form impl jaas form login module formloginmodule log debug form login module formloginmodule throwable log debug form login module formloginmodule
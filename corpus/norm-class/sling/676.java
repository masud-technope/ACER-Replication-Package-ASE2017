licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling nosql resource impl java util collections java util dictionary java util hash map hashmap java util hash set hashset java util hashtable java util iterator java util linked hash map linkedhashmap java util map java util java util sorted map sortedmap java util tree map treemap java util regex pattern javax servlet http http servlet request httpservletrequest org apache sling api sling constants slingconstants org apache sling api resource modifying resource provider modifyingresourceprovider org apache sling api resource persistence exception persistenceexception org apache sling api resource queriable resource provider queriableresourceprovider org apache sling api resource resource org apache sling api resource resource provider resourceprovider org apache sling api resource resource resolver resourceresolver org apache sling api resource value map valuemap org apache sling nosql adapter no sql adapter nosqladapter org apache sling nosql adapter no sql data nosqldata org osgi service event event org osgi service event event admin eventadmin implementation nosql resource provider mapping nosql database implementation details link no sql adapter nosqladapter no sql resource provider nosqlresourceprovider resource provider resourceprovider modifying resource provider modifyingresourceprovider queriable resource provider queriableresourceprovider string root path no sql data nosqldata root data no sql data nosqldata root path collections string object empty map emptymap no sql adapter nosqladapter adapter event admin eventadmin event admin eventadmin map string no sql data nosqldata changed resources changedresources linked hash map linkedhashmap string no sql data nosqldata string deleted resources deletedresources hash set hashset string no sql resource provider nosqlresourceprovider no sql adapter nosqladapter adapter event admin eventadmin event admin eventadmin adapter value map converting no sql adapter valuemapconvertingnosqladapter adapter event admin eventadmin event admin eventadmin read only readonly access resource get resource getresource resource resolver resourceresolver resource resolver resourceresolver string path root path equals path no sql resource nosqlresource root data resource resolver resourceresolver adapter valid path validpath path deleted resources deletedresources is empty isempty string deleted path deletedpath deleted resources deletedresources pattern deleted path pattern deletedpathpattern path util pathutil get same or desc end ant path pattern getsameordescendantpathpattern deleted path deletedpath deleted path pattern deletedpathpattern matcher path matches changed resources changedresources contains key containskey path no sql resource nosqlresource changed resources changedresources path resource resolver resourceresolver no sql data nosqldata data adapter path data no sql resource nosqlresource data resource resolver resourceresolver resource get resource getresource resource resolver resourceresolver resource resolver resourceresolver http servlet request httpservletrequest request string path get resource getresource resource resolver resourceresolver path iterator resource list children listchildren resource parent map consolidate data adapter deleted changed resources sorty result alphabetically consistent ordering nosql data source support ordering sorted map sortedmap string resource children tree map treemap string resource iterator no sql data nosqldata from adapter fromadapter adapter get children getchildren parent get path getpath from adapter fromadapter has next hasnext no sql data nosqldata item from adapter fromadapter is deleted isdeleted item get path getpath changed resources changedresources contains key containskey item get path getpath children item get path getpath no sql resource nosqlresource item parent get resource resolver getresourceresolver pattern child path pattern childpathpattern path util pathutil get child path pattern getchildpathpattern parent get path getpath no sql data nosqldata item changed resources changedresources values child path pattern childpathpattern matcher item get path getpath matches children item get path getpath no sql resource nosqlresource item parent get resource resolver getresourceresolver children values iterator is deleted isdeleted string path string deleted path deletedpath deleted resources deletedresources path equals deleted path deletedpath path equals deleted path deletedpath write access resource create resource resolver resourceresolver resolver string path map string object properties persistence exception persistenceexception root path equals path adapter valid path validpath path persistence exception persistenceexception illegal path unable create resource path path check exists deleted deleted resources deletedresources remove path exists changed resources changedresources contains key containskey path adapter path deleted exists persistence exception persistenceexception resource exists path path create resource change set changeset map string object writable map writablemap properties hash map hashmap string object properties hash map hashmap string object no sql data nosqldata data no sql data nosqldata path no sql value map nosqlvaluemap convert for write all convertforwriteall writable map writablemap changed resources changedresources path data no sql resource nosqlresource data resolver delete resource resolver resourceresolver resolver string path persistence exception persistenceexception root path equals path adapter valid path validpath path persistence exception persistenceexception unable delete resource path path pattern paths to delete pattern pathstodeletepattern path util pathutil get same or desc end ant path pattern getsameordescendantpathpattern path remove existing path descendant paths list deleted paths iterator string deleted resources iterator deletedresourcesiterator deleted resources deletedresources iterator deleted resources iterator deletedresourcesiterator has next hasnext string deleted path deletedpath deleted resources iterator deletedresourcesiterator paths to delete pattern pathstodeletepattern matcher deleted path deletedpath matches deleted resources iterator deletedresourcesiterator remove remove changed descendant items change set changeset iterator map entry string no sql data nosqldata change resources iterator changeresourcesiterator changed resources changedresources entry set entryset iterator change resources iterator changeresourcesiterator has next hasnext map entry string no sql data nosqldata entry change resources iterator changeresourcesiterator paths to delete pattern pathstodeletepattern matcher entry get key getkey matches change resources iterator changeresourcesiterator remove add path delete deleted resources deletedresources add path revert resource resolver resourceresolver resolver changed resources changedresources clear deleted resources deletedresources clear commit resource resolver resourceresolver resolver persistence exception persistenceexception string path deleted resources deletedresources adapter delete recursive deleterecursive path notify removed notifyremoved path no sql data nosqldata item changed resources changedresources values root path equals item get path getpath persistence exception persistenceexception unable store resource item get path getpath item get path getpath created adapter store item created notify added notifyadded item get path getpath notify updated notifyupdated item get path getpath revert resolver has changes haschanges resource resolver resourceresolver resolver changed resources changedresources is empty isempty deleted resources deletedresources is empty isempty mark as changed markaschanged resource resource changed resources changedresources resource get path getpath no sql data nosqldata resource get path getpath resource get value map getvaluemap notify added notifyadded string path dictionary string object props hashtable string object props sling constants slingconstants property path path event event event sling constants slingconstants topic resource props event admin eventadmin post event postevent event notify updated notifyupdated string path dictionary string object props hashtable string object props sling constants slingconstants property path path event event event sling constants slingconstants topic resource changed props event admin eventadmin post event postevent event notify removed notifyremoved string path dictionary string object props hashtable string object props sling constants slingconstants property path path event event event sling constants slingconstants topic resource removed props event admin eventadmin post event postevent event query access iterator resource find resources findresources resource resolver resourceresolver resolver string query string language iterator no sql data nosqldata result adapter query query language result iterator resource has next hasnext result has next hasnext resource no sql resource nosqlresource result resolver no sql resource provider nosqlresourceprovider remove unsupported operation exception unsupportedoperationexception iterator value map valuemap query resources queryresources resource resolver resourceresolver resolver string query string language iterator resource result find resources findresources resolver query language result iterator value map valuemap has next hasnext result has next hasnext value map valuemap result get value map getvaluemap remove unsupported operation exception unsupportedoperationexception
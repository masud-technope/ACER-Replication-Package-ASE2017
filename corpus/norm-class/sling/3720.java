licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling xss impl org slf logger org slf logger factory loggerfactory capability sec uri ng securing input plain text html output plain text to html content context plaintexttohtmlcontentcontext xss filter rule xssfilterrule logger logger log logger factory loggerfactory get logger getlogger get class getclass xss filter rule xssfilterrule check policy handler policyhandler string check policy handler policyhandler policy string str escaped xss filter rule xssfilterrule filter policy handler policyhandler java lang string string filter policy handler policyhandler policy string str string cleaned escape xml escapexml str log debug protecting plain text html nto str cleaned cleaned string escape xml escapexml string input input string builder stringbuilder string builder stringbuilder input length input length input char at charat append amp append append append to string tostring xss filter rule xssfilterrule supports policy supportspolicy supports policy supportspolicy
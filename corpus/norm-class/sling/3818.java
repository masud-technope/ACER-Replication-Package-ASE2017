licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad base impl java file java file input stream fileinputstream java file output stream fileoutputstream java i o exception ioexception java input stream inputstream java output stream outputstream java lang management management factory managementfactory java net url java util hash map hashmap java util hashtable java util iterator java util map java util map entry java util properties java util java util sorted map sortedmap java util string tokenizer stringtokenizer java util tree map treemap java util tree set treeset javax management attribute javax management attribute list attributelist javax management m bean server mbeanserver javax management object name objectname org apache felix framework logger org apache felix framework util felix constants felixconstants org apache sling launchpad api launchpad content provider launchpadcontentprovider org apache sling launchpad base shared not ifiable notifiable org apache sling launchpad base shared shared constants sharedconstants org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework bundle exception bundleexception org osgi framework constants org osgi framework launch framework org osgi service url url constants urlconstants org osgi service url url stream handler service urlstreamhandlerservice code sling code serves starting point sling link sling not ifiable notifiable logger launchpad content provider launchpadcontentprovider map method launches apache code felix code osg i osgi framework implementation launch configuration apache code felix code framework requires configuration parameters startup servlet builds list parameters locations code sling properties code file read servlet path properties file settings extensions servlet provide additional properties loaded over writing overwriting link load properties override loadpropertiesoverride map method web application init parameters properties overwrite existing properties loading properties variable substitution takes place property values variable code prop code code prop code system configuration property configuration properties override system properties variables nested resolved property code code resolved resolving code code resolving property cat enation catenation code code result resolving code code sling configuration property defining sling directory url sling url property assigned code file sling touri to string tostring code resolving property variables shared constants sharedconstants sling string sling url sling url configuration property defining jcr directory sling repository property system property init param web xml property sling properties sling repository string jcr repo sling repository configuration property defining url existing repository config file repository xml property system property init param web xml property sling properties sling repository repository xml string jcr repo config file url sling repository config file url configuration property defining properties file defining list bundles installed framework launched org apache osgi bundles configuration property gen erally generally web application configuration referenced property files user supplied web application parameters build framework configuration string osgi framework bundles org apache osgi bundles property ignore system properties building felix framework properties sling ignore system properties ignoresystemproperties property code code matter system properties link load config properties loadconfigproperties map string sling ignore system properties sling ignore system properties ignoresystemproperties launcher properties file setup environment code felix code framework sling properties extensions overwrite properties file web application parameters properties files string config properties sling properties string prop system packages org apache sling launcher system packages timeout wait initialized framework reinitialized amp le ample time time passes framework stopped error issued reinit timeout simple logger log messages startup shutdown logger logger launchpad content provider launchpadcontentprovider resource provider resourceprovider code felix code instance loaded link init stopped link destroy framework framework initializes servlet loading framework configuration properties starting osg i osgi framework apache felix exp osing exposing system bundle context code felix code instance servlet context attributes bundle exception bundleexception framework initialized sling not ifiable notifiable not ifiable notifiable logger logger launchpad content provider launchpadcontentprovider resource provider resourceprovider map string string prop overwrite propoverwrite bundle exception bundleexception logger logger resource provider resourceprovider resource provider resourceprovider started at startedat system current time millis currenttimemillis logger log logger log info starting apache sling read parameters map string string props load config properties loadconfigproperties prop overwrite propoverwrite check bootstrap command file copy bootstrap command file copybootstrapcommandfile props check auto start bundles set install bundles setinstallbundles props create framework start init iate initiate startup handler startup manager startupmanager startup manager startupmanager startup manager startupmanager props logger framework tmp framework tmpframework create framework createframework not ifiable notifiable logger props init tmp framework tmpframework restart bootstrap installer bootstrapinstaller tmp framework tmpframework get bundle context getbundlecontext logger resource provider resourceprovider startup manager startupmanager get mode getmode install startup manager startupmanager mark installed markinstalled restart restart tmp framework tmpframework tmp framework tmpframework create framework createframework not ifiable notifiable logger props init tmp framework tmpframework default startup handler defaultstartuphandler tmp framework tmpframework get bundle context getbundlecontext logger startup manager startupmanager started at startedat start tmp framework tmpframework start assign field start succeeds framework tmp framework tmpframework bundle exception bundleexception exception bundle exception bundleexception uncaught instantiation issue log sucess message logger log logger log info apache sling started dest roys destroys servlet shutting osg i osgi framework delegatee servlet destroy framework copy reference remove framework my framework myframework my framework myframework framework framework shutdown felix container my framework myframework logger log logger log info shutting apache sling my framework myframework my framework myframework wait for stop waitforstop bundle exception bundleexception logger log logger log error failure init iating initiating framework shutdown interrupted exception interruptedexception logger log logger log error interrupted waiting framework termination logger log logger log info apache sling stopped bundle activator bundleactivator called osg i osgi framework started implementation registers service listener code javax servlet servlet code calls link do start bundle dostartbundle method implementations execute startup tasks add itionally additionally code context code url protocol handler registered param bundle context bundlecontext code bundle context bundlecontext code system bundle osg i osgi framework bundle exception bundleexception thrown link do start bundle dostartbundle startup bundle context bundlecontext bundle context bundlecontext register context url handler hashtable string object props hashtable string object props url constants urlconstants url handler protocol string context context protocol handler contextprotocolhandler context handler contexthandler context protocol handler contextprotocolhandler resource provider resourceprovider bundle context bundlecontext register service registerservice url stream handler service urlstreamhandlerservice get name getname context handler contexthandler props register platform m bean server mbeanserver m bean server mbeanserver platform bean server platformmbeanserver management factory managementfactory get platform bean server getplatformmbeanserver hashtable string object mbean props mbeanprops hashtable string object object name objectname bean name beanname object name objectname get instance getinstance jm implementation jmimplementation type m bean server delegate mbeanserverdelegate attribute list attributelist attrs platform bean server platformmbeanserver get attributes getattributes bean name beanname string m bean server i d mbeanserverid specification name specificationname specification version specificationversion specification vendor specificationvendor implementation name implementationname implementation version implementationversion implementation vendor implementationvendor object object attrs attribute attr attribute object attr get value getvalue mbean props mbeanprops attr get name getname attr get value getvalue to string tostring exception logger log logger log info start service properties platform m bean server mbeanserver service registering bundle context bundlecontext register service registerservice m bean server mbeanserver get name getname platform bean server platformmbeanserver mbean props mbeanprops bundle context bundlecontext register service registerservice launchpad content provider launchpadcontentprovider get name getname resource provider resourceprovider creating framework instance suppress warnings suppresswarnings unchecked framework create framework createframework not ifiable notifiable not ifiable notifiable logger logger suppress warnings suppresswarnings rawtypes map props exception props felix constants felixconstants log logger prop logger sling felix slingfelix not ifiable notifiable props init framework framework bundle exception bundleexception initialize framework framework init startup setup startup framework get bundle context getbundlecontext restart framework framework bundle exception bundleexception framework get state getstate bundle starting bundle active bundle stopping framework sling felix slingfelix sling felix slingfelix framework restart framework framework wait for stop waitforstop reinit timeout interrupted exception interruptedexception bundle exception bundleexception interrupted waiting framework reinitialization configuration loading loads configuration properties configuration property file framework installation properties accessible framework bundles intended configuration purposes configuration property file located conf directory felix installation directory called config properties installation directory felix assumed parent directory framework jar file system path property precise file load configuration properties initial izing initializing framework config properties system property arbitrary url properties instance error map string string load config properties loadconfigproperties map string string prop overwrite propoverwrite bundle exception bundleexception config properties file system property directory felix jar file load places map string string static props staticprops hash map hashmap string string read embedded properties file load static props staticprops config properties resolve inc lusions inclusions remove property load includes loadincludes static props staticprops overwrite properties initial over writes overwrites prop overwrite propoverwrite static props staticprops put all putall prop overwrite propoverwrite check sling overwritten system property string sling home slinghome static props staticprops shared constants sharedconstants sling sling home slinghome sling home slinghome length bundle exception bundleexception sling property missing start resolve variables ensure sling absolute path sling home slinghome subst vars substvars sling home slinghome shared constants sharedconstants sling static props staticprops file sling home file slinghomefile file sling home slinghome get absolute file getabsolutefile sling home slinghome sling home file slinghomefile get absolute path getabsolutepath overlay sling sling properties logger log logger log info starting apache sling sling home slinghome file prop file propfile get sling properties getslingproperties sling home slinghome static props staticprops load static props staticprops prop file propfile migrate properties properties migrate prop migrateprop static props staticprops framework cache profile dir profiledir constants framework storage migrate prop migrateprop static props staticprops sling osgi core packages osgi core packages migrate prop migrateprop static props staticprops sling osgi comp endium compendium services osgi comp endium compendium services migrate initial start level property felix framework start level startlevel framework moved org osgi framework start level startlevel org osgi framework start level startlevel speced latest draft check int ermediate intermediate felix property initial property allowing older pro bable probable win migrate prop migrateprop static props staticprops org osgi framework start level startlevel constants framework start level startlevel migrate prop migrateprop static props staticprops framework start level startlevel framework constants framework start level startlevel create copy properties perform variable substitution map string string runtime props runtimeprops hash map hashmap string string runtime props runtimeprops put all putall static props staticprops check system properties overrides sling string ignore system properties ignoresystemproperties runtime props runtimeprops sling ignore system properties equals ignore case equalsignorecase ignore system properties ignoresystemproperties string runtime props runtimeprops key set keyset string sys prop sysprop system get property getproperty sys prop sysprop runtime props runtimeprops sys prop sysprop resolve inc lusions inclusions load includes loadincludes runtime props runtimeprops sling home slinghome overwrite properties persisted load properties override loadpropertiesoverride runtime props runtimeprops resolve boot delegation system packages resolve runtime props runtimeprops org osgi framework bootdelegation sling bootdelegation resolve runtime props runtimeprops org osgi framework system packages sling system packages reset sling property overwritten system properties included files sling properties file static props staticprops shared constants sharedconstants sling sling home slinghome runtime props runtimeprops shared constants sharedconstants sling sling home slinghome runtime props runtimeprops sling url sling home file slinghomefile touri to string tostring add property file locations runtime props runtimeprops shared constants sharedconstants sling properties prop file propfile get absolute path getabsolutepath runtime props runtimeprops shared constants sharedconstants sling properties url prop file propfile touri to string tostring perform variable substitution system properties entry string string entry runtime props runtimeprops entry set entryset entry set value setvalue subst vars substvars entry get value getvalue entry get key getkey runtime props runtimeprops context url s urls substitute entry string string entry runtime props runtimeprops entry set entryset string entry get key getkey string entry get value getvalue starts with startswith context string path substring context length input stream inputstream src resource provider resourceprovider get resource as stream getresourceasstream path src file target file sling home slinghome path output stream outputstream dest copy file existing target exists target get parent file getparentfile mkdirs dest file output stream fileoutputstream target buf src read buf dest write buf copying replace property add url property entry set value setvalue target get absolute path getabsolutepath property unsubstituted props static props staticprops sling path i o exception ioexception ioe logger log logger log error copy file target ioe dest dest close i o exception ioexception ignore src close i o exception ioexception ignore write unsubstituted properties overlay file output stream outputstream ensure parent folder prop file propfile get parent file getparentfile mkdirs file output stream fileoutputstream prop file propfile copy values temporary properties structure store properties tmp properties tmp put all putall static props staticprops remove properties overlay sense tmp remove shared constants sharedconstants sling tmp remove shared constants sharedconstants sling launchpad tmp remove shared constants sharedconstants sling properties tmp store overlay properties configuration exception logger log logger log error error loading overlay properties prop file propfile close i o exception ioexception runtime props runtimeprops s cans scans properties properties starting code prefix code code sling bootdelegation code property checked starts code prefix code property assumed fully qualified check visible property appended code osgi prop osgiprop code loaded property property fully qualified property simply appended code osgi prop osgiprop code param props code properties code scanned param osgi prop osgiprop property code props code matching property values appended param prefix prefix properties handle resolve map string string props string osgi prop osgiprop string prefix string prop val propval props osgi prop osgiprop string buffer stringbuffer prop string buffer stringbuffer prop val propval prop val propval mod entry string string p entry pentry props entry set entryset string key p entry pentry get key getkey key starts with startswith prefix key index of indexof prefix length prefix checker string class name classname key substring prefix length length get class getclass get class loader getclassloader load class loadclass class name classname throwable logger log logger log debug class name classname ignoring p entry pentry get value getvalue property osgi prop osgiprop checker logger log logger log debug adding p entry pentry get value getvalue property osgi prop osgiprop prop length prop append prop append p entry pentry get value getvalue mod replace property modified property mod logger log logger log debug setting property osgi prop osgiprop prop to string tostring props osgi prop osgiprop prop to string tostring converts felix framework property standard modified felix framework property property named code old name oldname code exist code props code map map modified property exists removed add map code new name newname code key properties code old name oldname code code new name newname code exist property code new name newname code replaced property code old name oldname code param props map properties property rename param old name oldname key property param new name newname key property migrate prop migrateprop map string string props string old name oldname string new name newname string prop value propvalue props remove old name oldname prop value propvalue string previous new value previousnewvalue props new name newname prop value propvalue previous new value previousnewvalue logger log logger log warning previous new value previousnewvalue property new name newname prop value propvalue logger log logger log info property old name oldname prop value propvalue renamed new name newname logger log logger log debug property old name oldname exist set install bundles setinstallbundles map string string props string prefix sling install string levels tree set treeset string string key props key set keyset key starts with startswith prefix levels add key substring prefix length string buffer stringbuffer buf string buffer stringbuffer string level levels buf length buf append buf append level props prefix bundles buf to string tostring extension support loads additional properties code properties code object implementation overwritten extensions req uiring requiring additional properties method called servlet initialized prepare configuration code felix code impl ementations implementations add properties implementation specific sources properties overwrite properties loaded properties file overwritten parameters web application code properties code object under gone undergone variable subst ition substition properties method values referer ring refererring properties properties method persisted code sling properties code file code sling code directory param properties code properties code object custom properties load properties override loadpropertiesoverride suppress warnings suppresswarnings unused map string string properties returns code bundle context bundlecontext code system bundle osg i osgi framework launched servlet method returns code code object system bundle framework started stopped bundle context bundlecontext get bundle context getbundlecontext framework get bundle context getbundlecontext property file support returns path code sling properties code file file get sling properties getslingproperties string sling home slinghome map string string properties string prop properties shared constants sharedconstants sling properties prop file sling home slinghome config properties file prop file propfile file prop prop file propfile is absolute isabsolute prop file propfile file sling home slinghome prop code sling include code code sling include code properties code props code loads properties form res pective respective locations code sling include code code sling include code property comma separated list resource file names loaded includes loaded alphabetical order property names reasource path loaded link resource provider resourceprovider fails resource path tested file relative code sling home slinghome code parent code code current working directory parent existing resource silently method returns code sling include code code sling include code properties contained code props code param props code properties code code sling include code code sling include code properties destination properties loaded param sling home slinghome parent directory resolve relative path names loading file code code current working directory parent load includes loadincludes map string string props string sling home slinghome build sort map include properties remove include elements properties sorted map sortedmap string string includes tree map treemap string string iterator entry string string props entry set entryset iterator has next hasnext entry string string entry entry get key getkey starts with startswith sling include entry get key getkey equals sling include includes entry get key getkey entry get value getvalue remove iterator entry string string includes entry set entryset iterator has next hasnext map entry string string entry string key entry get key getkey string include entry get value getvalue ensure variable resolution property include subst vars substvars include key props string tokenizer stringtokenizer tokener string tokenizer stringtokenizer include tokener has more tokens hasmoretokens string file tokener next token nexttoken trim input stream inputstream resource provider resourceprovider get resource as stream getresourceasstream file sling home slinghome file res file resfile file file res file resfile is absolute isabsolute res file resfile file sling home slinghome file res file resfile can read canread file input stream fileinputstream res file resfile logging file res file resfile get absolute path getabsolutepath load props i o exception ioexception ioe logger log logger log error error loading config properties file ioe close i o exception ioexception ignore load properties resource file accessed link resource provider resourceprovider resource exist loaded param props code properties code loaded properties loaded param resource resource load resources load map string string props string resource input stream inputstream resource provider resourceprovider get resource as stream getresourceasstream resource load props i o exception ioexception ioe logger log logger log error error loading config properties resource ioe close i o exception ioexception ignore load properties file resource read exist loaded param props code properties code loaded properties loaded param file code file code load properties load map string string props file file file file can read canread load props file input stream fileinputstream file i o exception ioexception ioe logger log logger log error error loading config properties file get absolute path getabsolutepath ioe load map string string props input stream inputstream ins i o exception ioexception properties tmp properties tmp load ins map entry object object entry tmp entry set entryset string string entry get value getvalue props string entry get key getkey trim ins close i o exception ioexception ioe property file variable subst ition substition support starting delimiter variable names string delim start delimiter variable names string delim method performs property variable substitution syntax prop prop ref ers refers configuration property system property property substituted variable placeholder multiple variable place holders placeholders exist nested variable place holders placeholders substituted configuration properties override system properties note verbatim copy named method launchpad webapp sling servlet slingservlet sync param val string perform property substitution param current key currentkey key property eval uated evaluated detect cycles param cycle map cyclemap map variable references detect nested cycles param config props configprops configuration properties string system property substitution illegal argument exception illegalargumentexception syntax error property placeholder syntax recursive variable reference string subst vars substvars string val string current key currentkey map string string cycle map cyclemap map string string config props configprops illegal argument exception illegalargumentexception detecting cycles invocation cycle map cyclemap cycle map cyclemap hash map hashmap string string current key cycle map cycle map cyclemap current key currentkey current key currentkey assume leading foo bar middle baz trailing find variable delimiter correspond deepest nested variable placeholder stop delim stopdelim val index of indexof delim find matching starting variable delimiter looping find start delimiter greater delimiter start delim startdelim val index of indexof delim start stop delim stopdelim idx val index of indexof delim start start delim startdelim delim start length idx idx stop delim stopdelim idx stop delim stopdelim start delim startdelim idx existing start delim startdelim stop delim stopdelim val exception start delim startdelim start delim startdelim stop delim stopdelim stop delim stopdelim illegal argument exception illegalargumentexception delimiter start delimiter val point variable placeholder perform variable substitution start delimiter indices extract deepest nested variable placeholder string variable val substring start delim startdelim delim start length stop delim stopdelim verify recursive variable reference cycle map cyclemap variable illegal argument exception illegalargumentexception recursive variable reference variable deepest nested variable placeholder configuration properties string subst value substvalue config props configprops config props configprops variable subst value substvalue ignore unknown property values subst value substvalue system get property getproperty variable remove variable cycle map don situations recursive reference cycle map cyclemap remove variable append leading characters substituted variable trailing characters val val substring start delim startdelim subst value substvalue val substring stop delim stopdelim delim length val length perform substitution substitutions val subst vars substvars val current key currentkey cycle map cyclemap config props configprops val copy bootstrap command file copybootstrapcommandfile map string string props check modification url url resource provider resourceprovider get resource getresource bootstrap installer bootstrapinstaller bootstrap cmd filename url logger log logger log debug checking modification bootstrap command file input stream inputstream output stream outputstream last modified lastmodified url open connection openconnection get last modified getlastmodified file launchpad home launchpadhome file props shared constants sharedconstants sling launchpad file cmd file cmdfile file launchpad home launchpadhome bootstrap installer bootstrapinstaller bootstrap cmd filename copy file copyfile cmd file cmdfile exists cmd file cmdfile last modified lastmodified last modified lastmodified copy file copyfile copy file copyfile logger log logger log info copying bootstrap command file resource provider resourceprovider get resource as stream getresourceasstream bootstrap installer bootstrapinstaller bootstrap cmd filename file output stream fileoutputstream cmd file cmdfile buffer read buffer buffer length write buffer i o exception ioexception ioe logger log logger log info ignoring exception processing bootstrap command file ioe close i o exception ioexception ignore close i o exception ioexception ignore logger log logger log debug bootstrap command file
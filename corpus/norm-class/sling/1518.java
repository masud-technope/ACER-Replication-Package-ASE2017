licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting java impl java lang reflect array java lang reflect field java lang reflect parameterized type parameterizedtype java lang reflect type java util arrays java util collection java util list javax inject inject javax servlet servlet javax servlet servlet config servletconfig javax servlet servlet exception servletexception javax servlet single thread model singlethreadmodel javax servlet unavailable exception unavailableexception javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache sling api scripting sling script helper slingscripthelper org apache sling commons class loader classloader dynamic class loader dynamicclassloader org apache sling commons compiler compilation result compilationresult org apache sling commons compiler compiler message compilermessage org slf logger org slf logger factory loggerfactory wraps java servlet handles compilation instantiation invocation und dest ruction destruction servlet wrapper servletwrapper logger logger logger logger factory loggerfactory get logger getlogger get class getclass servlet config servlet config servletconfig config sling provider slingioprovider io provider ioprovider generated string class name classname path servlet string source path sourcepath sling script helper slingscripthelper script helper scripthelper compiled instantiated servlet field servlet instance created request servlet the servlet theservlet flag handling unavailable exception exception thrown compilation exception compile exception compileexception wrapper servlets servlet wrapper servletwrapper servlet config servletconfig config slingioprovider io provider ioprovider string servlet path servletpath sling script helper slingscripthelper script helper scripthelper config config io provider ioprovider io provider ioprovider source path sourcepath servlet path servletpath class name classname compiler util compilerutil map source path mapsourcepath source path sourcepath substring replace script helper scripthelper script helper scripthelper call servlet param request current request param response current response exception service http servlet request httpservletrequest request http servlet response httpservletresponse response exception max system current time millis currenttimemillis response set date header setdateheader retry response send error senderror http servlet response httpservletresponse service unavailable servlet unavailable logger error java servlet unavailable source path sourcepath wait period expired reset servlet servlet get servlet getservlet invoke servlet servlet single thread model singlethreadmodel determined servicing servlet service request response servlet service request response unavailable exception unavailableexception unavailable seconds unavailableseconds get unavailable seconds getunavailableseconds unavailable seconds unavailableseconds unavailable seconds unavailableseconds system current time millis currenttimemillis unavailable seconds unavailableseconds response send error senderror http servlet response httpservletresponse service unavailable get message getmessage logger error java servlet unavailable source path sourcepath destroy servlet destroy the servlet theservlet the servlet theservlet destroy the servlet theservlet check class loader classloader valid check reload checkreload the servlet theservlet the servlet theservlet get class getclass get class loader getclassloader dynamic class loader dynamicclassloader dynamic class loader dynamicclassloader the servlet theservlet get class getclass get class loader getclassloader is live islive the servlet theservlet servlet class loader classloader valid reloaded servlet get servlet getservlet exception compile exception compileexception compile exception compileexception check loader alive check reload checkreload check reload checkreload logger debug reloading source path sourcepath compile the servlet theservlet inject fields injectfields servlet servlet field field servlet get class getclass get declared fields getdeclaredfields field is annotation present isannotationpresent inject field set accessible setaccessible type type field get generic type getgenerictype type injected class injectedclass type injected class injectedclass is instance isinstance script helper scripthelper field servlet script helper scripthelper injected class injectedclass is array isarray object services script helper scripthelper get services getservices injected class injectedclass get component type getcomponenttype object arr array new instance newinstance injected class injectedclass get component type getcomponenttype services length services length array arr services field servlet arr field servlet script helper scripthelper get service getservice injected class injectedclass type parameterized type parameterizedtype parameterized type parameterizedtype ptype parameterized type parameterizedtype type ptype get actual type arguments getactualtypearguments length logger warn field type parameter field get name getname source path sourcepath collection type collectiontype ptype get raw type getrawtype collection type collectiontype equals collection collection type collectiontype equals list logger warn field injectable collection type field get name getname source path sourcepath service type servicetype ptype get actual type arguments getactualtypearguments object services script helper scripthelper get services getservices service type servicetype field servlet arrays as list aslist services logger warn field injectable type field get name getname source path sourcepath illegal argument exception illegalargumentexception logger error string format unable inject field field get name getname source path sourcepath illegal access exception illegalaccessexception logger error string format unable inject field field get name getname source path sourcepath field set accessible setaccessible compile servlet java compiled injected fields don create instance compile exception logger debug comp iling compiling source path sourcepath clear exception compile exception compileexception compiler options compileroptions opts io provider ioprovider get force compile options getforcecompileoptions compilation unit compilationunit unit compilation unit compilationunit source path sourcepath class name classname io provider ioprovider compilation result compilationresult result io provider ioprovider get compiler getcompiler compile org apache sling commons compiler compilation unit compilationunit unit opts list compiler message compilermessage errors result get errors geterrors destroy errors errors size compiler exception compilerexception create errors source path sourcepath servlet servlet servlet result load compiled class loadcompiledclass class name classname new instance newinstance servlet init config inject fields injectfields servlet the servlet theservlet servlet exception compile exception compileexception compiler exception compiler exception compilerexception servlet exception servletexception serialversionuid compiler exception compilerexception create list compiler message compilermessage errors string file name filename string builder stringbuilder buffer string builder stringbuilder buffer append compilation errors buffer append file name filename buffer append compiler message compilermessage errors buffer append buffer append get line getline buffer append column buffer append get column getcolumn buffer append buffer append get message getmessage buffer append compiler exception compilerexception buffer to string tostring compiler exception compilerexception string message message
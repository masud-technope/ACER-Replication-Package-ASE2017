licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery impl org junit assert equals assertequals org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling discovery base abstract discovery service test abstractdiscoveryservicetest org apache sling discovery base setup virtual instance virtualinstance org apache sling discovery base setup virtual instance builder virtualinstancebuilder org apache sling discovery commons providers base dummy listener dummylistener org apache sling discovery impl discovery service impl discoveryserviceimpl org apache sling discovery impl common heartbeat heartbeat handler heartbeathandler org apache sling discovery impl setup fulljr virtual instance builder virtualinstancebuilder org junit test org slf logger org slf logger factory loggerfactory discovery service impl test discoveryserviceimpltest abstract discovery service test abstractdiscoveryservicetest logger logger logger factory loggerfactory get logger getlogger get class getclass override virtual instance builder virtualinstancebuilder new builder newbuilder fulljr virtual instance builder virtualinstancebuilder test test local cluster sync token id change testlocalclustersynctokenidchange exception logger info test local cluster sync token id change testlocalclustersynctokenidchange start logger info test local cluster sync token id change testlocalclustersynctokenidchange creating instance fulljr virtual instance builder virtualinstancebuilder builder fulljr virtual instance builder virtualinstancebuilder fulljr virtual instance builder virtualinstancebuilder set debug name setdebugname instance new repository newrepository test local cluster sync token id change testlocalclustersynctokenidchange set connector ping interval setconnectorpinginterval set connector ping timeout setconnectorpingtimeout set min event delay setmineventdelay virtual instance virtualinstance instance builder build logger info test local cluster sync token id change testlocalclustersynctokenidchange creating instance fulljr virtual instance builder virtualinstancebuilder builder fulljr virtual instance builder virtualinstancebuilder fulljr virtual instance builder virtualinstancebuilder set debug name setdebugname instance use repository of userepositoryof instance set connector ping interval setconnectorpinginterval set connector ping timeout setconnectorpingtimeout set min event delay setmineventdelay virtual instance virtualinstance instance builder build logger info test local cluster sync token id change testlocalclustersynctokenidchange registering listener dummy listener dummylistener listener dummy listener dummylistener discovery service impl discoveryserviceimpl discovery service discoveryservice discovery service impl discoveryserviceimpl instance get discovery service getdiscoveryservice discovery service discoveryservice bind topology event listener bindtopologyeventlistener listener assert equals assertequals discovery service discoveryservice get view state manager getviewstatemanager wait for async events waitforasyncevents assert equals assertequals listener count events countevents logger info test local cluster sync token id change testlocalclustersynctokenidchange heartbeating instance heartbeats and check view heartbeatsandcheckview instance heartbeats and check view heartbeatsandcheckview thread sleep instance heartbeats and check view heartbeatsandcheckview instance heartbeats and check view heartbeatsandcheckview thread sleep logger info test local cluster sync token id change testlocalclustersynctokenidchange expecting received init assert equals assertequals discovery service discoveryservice get view state manager getviewstatemanager wait for async events waitforasyncevents assert equals assertequals listener count events countevents resource resolver factory resourceresolverfactory factory instance get resource resolver factory getresourceresolverfactory resource resolver resourceresolver resolver factory get administrative resource resolver getadministrativeresourceresolver instance heartbeats and check view heartbeatsandcheckview instance heartbeats and check view heartbeatsandcheckview thread sleep logger info test local cluster sync token id change testlocalclustersynctokenidchange heartbeat triggered assert equals assertequals discovery service discoveryservice get view state manager getviewstatemanager wait for async events waitforasyncevents assert equals assertequals listener count events countevents simulate change established view establishedview view id viewid achieved triggering revoting result view cos instances changed heartbeat handler heartbeathandler heartbeat handler heartbeathandler heartbeat handler heartbeathandler instance get view checker getviewchecker logger info test local cluster sync token id change testlocalclustersynctokenidchange for cing forcing voting start heartbeat handler heartbeathandler start new voting startnewvoting logger info test local cluster sync token id change testlocalclustersynctokenidchange heartbeats finish voting instance heartbeats and check view heartbeatsandcheckview instance heartbeats and check view heartbeatsandcheckview thread sleep instance heartbeats and check view heartbeatsandcheckview instance heartbeats and check view heartbeatsandcheckview thread sleep logger info test local cluster sync token id change testlocalclustersynctokenidchange changing changed pair add itionally additionally assert equals assertequals discovery service discoveryservice get view state manager getviewstatemanager wait for async events waitforasyncevents assert equals assertequals listener count events countevents
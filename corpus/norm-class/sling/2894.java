licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling jcr resource internal helper jcr org apache sling api resource resource resolver factory resourceresolverfactory password java util iterator java util map javax annotation nonnull javax jcr credentials javax jcr repository exception repositoryexception javax jcr session javax jcr simple credentials simplecredentials org apache sling api resource login exception loginexception org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling jcr api sling repository slingrepository org apache sling jcr resource jcr resource constants jcrresourceconstants org apache sling jcr resource internal helper data helperdata org apache sling spi resource provider resource provider resourceprovider org osgi framework bundle org osgi framework bundle context bundlecontext org osgi framework service reference servicereference org slf logger org slf logger factory loggerfactory jcr provider state factory jcrproviderstatefactory logger log logger factory loggerfactory get logger getlogger jcr provider state factory jcrproviderstatefactory service reference servicereference repository reference repositoryreference sling repository slingrepository repository helper data helperdata helper data helperdata jcr provider state factory jcrproviderstatefactory service reference servicereference repository reference repositoryreference sling repository slingrepository repository helper data helperdata helper data helperdata repository repository repository reference repositoryreference repository reference repositoryreference helper data helperdata helper data helperdata suppress warnings suppresswarnings deprecation jcr provider state jcrproviderstate create provider state createproviderstate nonnull map string object authentication info authenticationinfo login exception loginexception session resource resolver returned closed resource resolver closed logout session logoutsession derive session session session bundle context bundlecontext string workspace get workspace getworkspace authentication info authenticationinfo equals authentication info authenticationinfo resource provider resourceprovider admin session repository login administrative loginadministrative workspace session get session getsession authentication info authenticationinfo session object service bundle object servicebundleobject authentication info authenticationinfo resource provider resourceprovider service bundle service bundle object servicebundleobject bundle string sub service name subservicename authentication info authenticationinfo resource resolver factory resourceresolverfactory subservice string string authentication info authenticationinfo resource resolver factory resourceresolverfactory subservice bundle service bundle object servicebundleobject get bundle context getbundlecontext sling repository slingrepository repo sling repository slingrepository get service getservice repository reference repositoryreference repo log warn get resource provider internal getresourceproviderinternal login service sling repository slingrepository behalf bundle get bundle getbundle get symbolic name getsymbolicname get bundle getbundle get bundle id getbundleid todo correct login exception loginexception session repo login service loginservice sub service name subservicename workspace closed session log ged logged session unget service ungetservice repository reference repositoryreference requested admin session workspace credentials credentials get credentials getcredentials authentication info authenticationinfo session repository login credentials workspace workspace session map requested workspace impersonate change user workspace work around workaround login requested workspace admin session user required session tmp session tmpsession todo deprecated login administrative loginadministrative method bundle configured user service authentication tmp session tmpsession repository login service loginservice workspace login administrative loginadministrative tmp session tmpsession repository login administrative loginadministrative workspace tmp session tmpsession get user d getuserid equals session get user d getuserid session tmp session tmpsession tmp session tmpsession session tmp session tmpsession impersonate simple credentials simplecredentials session get user d getuserid tmp session tmpsession tmp session tmpsession logout session special workspace session log ged logged resolver closed logout session logoutsession repository exception repositoryexception get login exception getloginexception session handle impersonation handleimpersonation session authentication info authenticationinfo logout session logoutsession jcr provider state jcrproviderstate session helper data helperdata logout session logoutsession jcr provider state jcrproviderstate session helper data helperdata logout session logoutsession repository reference repositoryreference handle sudo configured authentication info sudo info method simply returns passed session sudo user info session impersonated impersonated session returned original session closed session closed impersonation fails param session session param authentication info authenticationinfo optional authentication info param logout session logoutsession logout code session code impersonation original session impersonated session login exception loginexception wrong session handle impersonation handleimpersonation session session map string object authentication info authenticationinfo logout session logoutsession login exception loginexception string sudo user sudouser get sudo user getsudouser authentication info authenticationinfo sudo user sudouser session get user d getuserid equals sudo user sudouser simple credentials simplecredentials creds simple credentials simplecredentials sudo user sudouser copy attributes copyattributes creds authentication info authenticationinfo creds set attribute setattribute resource resolver resourceresolver user impersonator session get user d getuserid session impersonate creds repository exception repositoryexception get login exception getloginexception logout session logoutsession session logout session create login exception repository exception repository exception link javax jcr login exception loginexception link login exception loginexception created link login exception loginexception created wraps repository exception param repository exception login exception login exception loginexception get login exception getloginexception repository exception repositoryexception javax jcr login exception loginexception login exception loginexception get message getmessage get cause getcause login exception loginexception unable login get message getmessage create credentials object authentication info map code code returned map credentials object object returned map credentials object user code code returned map user credentials object credentials object created values authentication info attributes param authentication info authenticationinfo optional authentication info credentials object code code credentials get credentials getcredentials map string object authentication info authenticationinfo credentials creds authentication info authenticationinfo object credentials object credentialsobject authentication info authenticationinfo jcr resource constants jcrresourceconstants authentication info credentials credentials object credentialsobject credentials creds credentials credentials object credentialsobject create simple credentials simplecredentials user id userid object user id userid authentication info authenticationinfo resource resolver factory resourceresolverfactory user user id userid string object password authentication info authenticationinfo resource resolver factory resourceresolverfactory password simple credentials simplecredentials credentials simple credentials simplecredentials string user id userid password password add attributes copy attributes copyattributes credentials authentication info authenticationinfo creds credentials creds simple credentials simplecredentials authentication info authenticationinfo password string simple credentials simplecredentials creds set attribute setattribute password authentication info authenticationinfo password creds copies contents source map attributes target code simple credentials simplecredentials code object exception code user jcr credentials code code user password code attributes prevent leaking pass words passwords jcr session attributes attempts param target code simple credentials simplecredentials code object attributes augmented param source map entries listed copied credentials attributes copy attributes copyattributes simple credentials simplecredentials target map string object source iterator map entry string object source entry set entryset iterator has next hasnext map entry string object current is attribute visible isattributevisible current get key getkey target set attribute setattribute current get key getkey current get value getvalue returns code code code user jcr credentials code link jcr resource constants jcrresourceconstants authentication info credentials string code password code code user password code link org apache sling api resource resource resolver factory resourceresolverfactory password param check visible code code assumed visible null pointer exception nullpointerexception code code code code is attribute visible isattributevisible string equals jcr resource constants jcrresourceconstants authentication info credentials password sudo user sudo user info returned code code returned param authentication info authenticationinfo authentication info code configured sudo user code code string get sudo user getsudouser map string object authentication info authenticationinfo object sudo object sudoobject authentication info authenticationinfo resource resolver factory resourceresolverfactory user impersonation sudo object sudoobject string string sudo object sudoobject workspace workspace returned code code returned param authentication info authenticationinfo authentication info code configured workspace code code string get workspace getworkspace map string object authentication info authenticationinfo object workspace object workspaceobject authentication info authenticationinfo jcr resource constants jcrresourceconstants authentication info workspace workspace object workspaceobject string string workspace object workspaceobject returns session user jcr session property code authentication info authenticationinfo code map code code property contained map code javax jcr session code param authentication info authenticationinfo authentication info code user jcr session property code code session get session getsession map string object authentication info authenticationinfo object session object sessionobject authentication info authenticationinfo jcr resource constants jcrresourceconstants authentication info session session object sessionobject session session session object sessionobject
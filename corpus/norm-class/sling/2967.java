licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling bgservlets org junit assert equals assertequals org junit fail java buffered reader bufferedreader java io exception ioexception java string reader stringreader java util iterator java util regex pattern junit framework assertion failed error assertionfailederror org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons testing int egration integration http test httptest org junit org junit test background request t backgroundrequestit http test httptest http test httptest setup exception set up setup find job nodes count stored jobs countstoredjobs io exception ioexception jobs string content content get content getcontent http test httptest http base url tidy json application json assertion failed error assertionfailederror ignore buffered reader bufferedreader buffered reader bufferedreader string reader stringreader content string read line readline sling resource type resourcetype sling job jobs jobs test test tmp request creates job testtmprequestcreatesjob io exception ioexception interrupted exception interruptedexception json exception jsonexception initial jobs initialjobs count stored jobs countstoredjobs get content getcontent http test httptest http base url tmp json sling application json request created job timeout system current time millis currenttimemillis count stored jobs countstoredjobs initial jobs initialjobs system current time millis currenttimemillis timeout fail timeout waiting background job creation thread sleep verify jobs stored path includes sling instance string path jobs tidy json json object jsonobject json json object jsonobject get content getcontent http test httptest http base url path application json matches pattern instance id pattern instanceidpattern pattern compile iterator string json has next hasnext string key instance id pattern instanceidpattern matcher key matches matches matches fail instance node path wait bit jobs created thread sleep assert equals assertequals expecting extra jobs initial jobs initialjobs count stored jobs countstoredjobs
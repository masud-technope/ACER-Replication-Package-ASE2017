licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling maven sling start slingstart java buffered reader bufferedreader java data output stream dataoutputstream java file java file reader filereader java io exception ioexception java input stream reader inputstreamreader java line number reader linenumberreader java lang process builder processbuilder redirect java net inet socket address inetsocketaddress java net socket java util array list arraylist java util list java util concurrent callable org apache commons io utils ioutils org apache maven plugin logging log org apache sling maven sling start slingstart launcher main call able callable launchpad instance launcher callable launchercallable callable process description processdescription launchpad environment launchpadenvironment environment server configuration serverconfiguration configuration log logger launcher callable launchercallable log logger server configuration serverconfiguration configuration launchpad environment launchpadenvironment environment logger logger configuration configuration environment environment java util concurrent callable call override process description processdescription call exception fail launchpad started process description provider processdescriptionprovider get instance getinstance is run configuration available isrunconfigurationavailable configuration get id getid exception launchpad configuration get id getid launchpad jar file launchpad environment prepare configuration get folder getfolder lock launchpad string launchpad key launchpadkey process description provider processdescriptionprovider get instance getinstance get id getid configuration get id getid start launchpad process description processdescription cfg start launchpad add thread hook shutdown launchpad environment is shutdown on exit isshutdownonexit cfg install shutdown hook installshutdownhook add configuration config provider process description provider processdescriptionprovider get instance getinstance add run configuration addrunconfiguration cfg launchpad key launchpadkey started end time endtime system current time millis currenttimemillis environment get ready time out sec getreadytimeoutsec finished started finished system current time millis currenttimemillis end time endtime thread sleep started cfg get control listener getcontrollistener is started isstarted exit process stopped cfg get process getprocess exit value exitvalue finished illegal thread state exception illegalthreadstateexception its e itse finished exception launchpad exit unexpectedly started exception launchpad start environment get ready time out sec getreadytimeoutsec seconds logger info started launchpad configuration get id getid configuration get run mode getrunmode configuration get port getport control port cfg get control listener getcontrollistener call launchpad routine properly started started logger cfg process description provider processdescriptionprovider get instance getinstance remove run configuration removerunconfiguration cfg get id getid cfg cfg is running isrunning get control port file getcontrolportfile configuration get folder getfolder exists add list string args string string single trim split string single trim length args add trim process description processdescription start file jar exception process description processdescription cfg process description processdescription configuration get id getid configuration get folder getfolder process builder processbuilder builder process builder processbuilder list string args array list arraylist string args add java add args configuration get vm opts getvmopts add args configuration get vm debug opts getvmdebugopts environment get debug getdebug args add args add bin args add main get name getname arguments jar listener port verbose args add jar get path getpath args add string value of valueof cfg get control listener getcontrollistener get port getport args add launchpad properties add args configuration get opts getopts string context path contextpath configuration get context path getcontextpath context path contextpath context path contextpath length context path contextpath equals args add args add context path contextpath configuration get port getport args add args add configuration get port getport configuration get control port getcontrolport args add args add configuration get control port getcontrolport configuration get run mode getrunmode configuration get run mode getrunmode length args add dsling modes configuration get run mode getrunmode environment is shutdown on exit isshutdownonexit args add start builder command args to array toarray string args size builder directory configuration get folder getfolder builder redirect error stream redirecterrorstream builder redirect output redirectoutput redirect inherit builder redirect error redirecterror redirect inherit logger info starting launchpad configuration get id getid logger debug launchpad cmd builder command logger debug launchpad dir builder directory cfg set process setprocess builder start io exception ioexception cfg get process getprocess cfg get process getprocess destroy cfg set process setprocess exception start launchpad cfg log log process description processdescription cfg exception is new isnew cfg get process getprocess is new isnew log info stopping launchpad cfg get id getid destroy two min utes twominutes file control port file controlportfile get control port file getcontrolportfile cfg get directory getdirectory log debug control port file control port file controlportfile exists control port file controlportfile exists control port file controlportfile exists reading control port control port controlport string secret key secretkey line number reader linenumberreader lnr string server name servername lnr line number reader linenumberreader file reader filereader control port file controlportfile string port line portline lnr read line readline pos port line portline index of indexof control port controlport integer parse int parseint port line portline substring pos pos server name servername port line portline substring pos secret key secretkey lnr read line readline number format exception numberformatexception ignore log debug error reading control port file control port file controlportfile ignore io exception ioexception ignore log debug error reading control port file control port file controlportfile ignore io utils ioutils close quietly closequietly lnr control port controlport list string hosts array list arraylist string server name servername hosts add server name servername hosts add localhost hosts add log debug control port control port controlport destroy hosts size string host name hostname hosts socket client socket clientsocket data output stream dataoutputstream buffered reader bufferedreader log debug connect host name hostname control port controlport client socket clientsocket socket socket timeout client socket clientsocket connect inet socket address inetsocketaddress host name hostname control port controlport two min utes twominutes read call input stream inputstream socket infinite client socket clientsocket set so timeout setsotimeout two min utes twominutes log debug host name hostname control port controlport connection estabilished sending command data output stream dataoutputstream client socket clientsocket get output stream getoutputstream buffered reader bufferedreader input stream reader inputstreamreader client socket clientsocket get input stream getinputstream secret key secretkey write bytes writebytes secret key secretkey write write bytes writebytes read line readline destroy log debug command host name hostname control port controlport throwable ignore log debug error sending command host name hostname control port controlport ignore get message getmessage io utils ioutils close quietly closequietly io utils ioutils close quietly closequietly io utils ioutils close quietly closequietly client socket clientsocket cfg get process getprocess process process cfg get process getprocess destroy shutdown block timeout system current time millis currenttimemillis two min utes twominutes log debug waiting process is alive isalive process system current time millis currenttimemillis thread sleep interrupted exception interruptedexception is alive isalive process log debug process timeout min utes minutes destroy log debug process stopped destroy log debug dest roying destroying process process destroy log debug process dest royed destroyed cfg set process setprocess log warn launchpad stopped is alive isalive process process process exit value exitvalue illegal thread state exception illegalthreadstateexception file get control port file getcontrolportfile file directory file launchpad dir launchpaddir file directory launchpad environment launchpadenvironment work dir file conf dir confdir file launchpad dir launchpaddir conf file control port file controlportfile file conf dir confdir control port controlport control port file controlportfile
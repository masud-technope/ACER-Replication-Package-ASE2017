licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer provider jcr impl java util array list arraylist java util collection java util hash map hashmap java util hash set hashset java util list java util map java util javax jcr item javax jcr node javax jcr node iterator nodeiterator javax jcr repository exception repositoryexception javax jcr session org apache sling installer api installable resource installableresource org slf logger org slf logger factory loggerfactory watch single folder jcr repository detecting providing installable data installabledata contents watched folder watchedfolder logger logger logger factory loggerfactory get logger getlogger get class getclass string path string path with slash pathwithslash priority session session collection jcr installer jcrinstaller node converter nodeconverter convert ers converters string existing resource urls existingresourceurls hash set hashset string needs scan needsscan scan result scanresult list installable resource installableresource to add toadd array list arraylist installable resource installableresource list string to remove toremove array list arraylist string store digests returned resources keyed path detect map string string digests hash map hashmap string string watched folder watchedfolder session session string path priority collection jcr installer jcrinstaller node converter nodeconverter convert ers converters repository exception repositoryexception priority illegal argument exception illegalargumentexception watch folder priority path path path path with slash pathwithslash path concat convert ers converters convert ers converters priority priority session session start logger info watching folder priority path priority needs scan needsscan override string to string tostring get class getclass get simple name getsimplename path string get path getpath path string get path with slash getpathwithslash path with slash pathwithslash update scan flag observation event occurs mark for scan markforscan logger debug jcr events received path path needs scan needsscan observation event occur needs scan needsscan needs scan needsscan scan contents folder code scan result scanresult code code installable resource installableresource code scan result scanresult scan repository exception repositoryexception logger debug scan ning scanning path needs scan needsscan node folder session item exists itemexists path item session get item getitem path is node isnode folder node installable resource installableresource child nodes node converter nodeconverter scan result scanresult result scan result scanresult string resources seen resourcesseen hash set hashset string folder scan node scannode folder result resources seen resourcesseen unregistered osgi installer osgiinstaller string url existing resource urls existingresourceurls resources seen resourcesseen url result to remove toremove add url string result to remove toremove existing resource urls existingresourceurls remove digests remove update saved digests resources returning installable resource installableresource result to add toadd existing resource urls existingresourceurls add get id getid digests get id getid get digest getdigest result scan node scannode node folder scan result scanresult result string resources seen resourcesseen repository exception repositoryexception node iterator nodeiterator folder get nodes getnodes has next hasnext node next node nextnode processed jcr installer jcrinstaller node converter nodeconverter convert ers converters installable resource installableresource convert node convertnode priority processed resources seen resourcesseen add get id getid string old digest olddigest digests get id getid get digest getdigest equals old digest olddigest logger debug digest didn change ignoring result to add toadd add processed scan node scannode result resources seen resourcesseen
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base connectors ping java io exception ioexception java print writer printwriter java util array list arraylist java util hash set hashset java util iterator java util list java util java util string tokenizer stringtokenizer java util zip gzip output stream gzipoutputstream javax servlet servlet exception servletexception javax servlet http http servlet httpservlet javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations reference org apache felix scr annotations service org apache sling commons json json exception jsonexception org apache sling discovery cluster view clusterview org apache sling discovery base commons cluster view helper clusterviewhelper org apache sling discovery base commons cluster view service clusterviewservice org apache sling discovery base commons undefined cluster view exception undefinedclusterviewexception org apache sling discovery base connectors base config baseconfig org apache sling discovery base connectors announcement announcement org apache sling discovery base connectors announcement announcement filter announcementfilter org apache sling discovery base connectors announcement announcement registry announcementregistry org apache sling discovery base connectors ping sub net whitelist entry subnetwhitelistentry org apache sling discovery base connectors ping whitelist entry whitelistentry org apache sling discovery base connectors ping wildcard whitelist entry wildcardwhitelistentry org osgi service component component context componentcontext org osgi service http http service httpservice org osgi service http name space exception namespaceexception org slf logger org slf logger factory loggerfactory servlet receives topology announcements libs sling topology connector authorization authorization handled hmac signature shared key flexible whitelist suppress warnings suppresswarnings serial component service topology connector servlet topologyconnectorservlet topology connector servlet topologyconnectorservlet http servlet httpservlet prefix topology connector servlet registered url consist prefix connector sling id slingid json string topology connector prefix libs sling topology logger logger logger factory loggerfactory get logger getlogger get class getclass reference announcement registry announcementregistry announcement registry announcementregistry reference cluster view service clusterviewservice cluster view service clusterviewservice reference http service httpservice http service httpservice reference base config baseconfig config list whitelist entry whitelistentry ips host names hostnames cidr wildcards filtering host name hostname add res ses addresses allowed connect servlet list whitelist entry whitelistentry whitelist array list arraylist whitelist entry whitelistentry plaintext whitelist entries faster look ups lookups string plaintext whitelist plaintextwhitelist hash set hashset string topology request validator topologyrequestvalidator request validator requestvalidator activate activate component context componentcontext context whitelist clear config is hmac enabled ishmacenabled string whitelist config whitelistconfig config get topology connector whitelist gettopologyconnectorwhitelist init whitelist initwhitelist whitelist config whitelistconfig request validator requestvalidator topology request validator topologyrequestvalidator config http service httpservice register servlet registerservlet topology connector servlet topologyconnectorservlet topology connector prefix logger info activate connector servlet registered topology connector servlet topologyconnectorservlet topology connector prefix servlet exception servletexception logger error activate servlet exception servletexception registering topology connector servlet name space exception namespaceexception logger error activate name space exception namespaceexception registering topology connector servlet deactivate deactivate http service httpservice unregister topology connector prefix init whitelist initwhitelist string whitelist config whitelistconfig whitelist config whitelistconfig whitelist config whitelistconfig length string a whitelist entry awhitelistentry whitelist config whitelistconfig whitelist entry whitelistentry whitelist entry whitelistentry a whitelist entry awhitelistentry a whitelist entry awhitelistentry cidr notation whitelist entry whitelistentry sub net whitelist entry subnetwhitelistentry a whitelist entry awhitelistentry exception logger error activate wrongly for matted formatted cidr sub net subnet definition expected ignoring a whitelist entry awhitelistentry a whitelist entry awhitelistentry a whitelist entry awhitelistentry sub net subnet mask notation string tokenizer stringtokenizer string tokenizer stringtokenizer a whitelist entry awhitelistentry string next token nexttoken has more tokens hasmoretokens string mask next token nexttoken has more tokens hasmoretokens logger error activate wrongly for matted formatted sub net subnet definition expected ignoring a whitelist entry awhitelistentry whitelist entry whitelistentry sub net whitelist entry subnetwhitelistentry mask exception logger error activate wrongly for matted formatted sub net subnet definition expected ignoring a whitelist entry awhitelistentry whitelist entry whitelistentry a whitelist entry awhitelistentry a whitelist entry awhitelistentry whitelist entry whitelistentry wildcard whitelist entry wildcardwhitelistentry a whitelist entry awhitelistentry plaintext whitelist plaintextwhitelist add a whitelist entry awhitelistentry logger info activate adding whitelist entry a whitelist entry awhitelistentry whitelist entry whitelistentry whitelist add whitelist entry whitelistentry override do delete dodelete http servlet request httpservletrequest request http servlet response httpservletresponse response servlet exception servletexception io exception ioexception is white listed iswhitelisted request theory for bidden forbidden reveal resource exist place response send error senderror http servlet response httpservletresponse string path info pathinfo request get path info getpathinfo split string extension path info pathinfo length path info pathinfo json equals extension response send error senderror http servlet response httpservletresponse string selector path info pathinfo length path info pathinfo announcement registry announcementregistry unregister announcement unregisterannouncement selector override do put doput http servlet request httpservletrequest request http servlet response httpservletresponse response servlet exception servletexception io exception ioexception is white listed iswhitelisted request theory for bidden forbidden reveal resource exist place response send error senderror http servlet response httpservletresponse string path info pathinfo request get path info getpathinfo split string extension path info pathinfo length path info pathinfo json equals extension response send error senderror http servlet response httpservletresponse string selector path info pathinfo length path info pathinfo string topologyannouncementjson request validator requestvalidator decode message decodemessage request logger is debug enabled isdebugenabled logger debug do post dopost incoming topology announcement topologyannouncementjson announcement incoming topology announcement incomingtopologyannouncement incoming topology announcement incomingtopologyannouncement announcement fromjson topologyannouncementjson incoming topology announcement incomingtopologyannouncement get owner id getownerid equals selector response send error senderror http servlet response httpservletresponse bad request string sling id slingid cluster view service clusterviewservice get sling id getslingid sling id slingid response send error senderror http servlet response httpservletresponse internal server error logger info do put doput sling id slingid service ready expected moment incoming topology announcement incomingtopologyannouncement remove inherited removeinherited sling id slingid announcement reply announcement replyannouncement announcement sling id slingid backoff interval backoffinterval cluster view clusterview cluster view clusterview cluster view service clusterviewservice get local cluster view getlocalclusterview incoming topology announcement incomingtopologyannouncement is correct version iscorrectversion logger warn do post dopost rejecting announcement incompatible connector protocol version incoming topology announcement incomingtopologyannouncement response send error senderror http servlet response httpservletresponse bad request cluster view helper clusterviewhelper cluster view clusterview incoming topology announcement incomingtopologyannouncement get owner id getownerid logger is debug enabled isdebugenabled logger debug do post dopost rejecting announcement instance cluster incoming topology announcement incomingtopologyannouncement marking loop reply announcement replyannouncement set loop setloop backoff interval backoffinterval config get backoff standby interval getbackoffstandbyinterval cluster view helper clusterviewhelper contains any containsany cluster view clusterview incoming topology announcement incomingtopologyannouncement list instances listinstances logger is debug enabled isdebugenabled logger debug do post dopost rejecting announcement instance cluster incoming topology announcement incomingtopologyannouncement marking loop reply announcement replyannouncement set loop setloop backoff interval backoffinterval config get backoff standby interval getbackoffstandbyinterval backoff interval backoffinterval announcement registry announcementregistry register announcement registerannouncement incoming topology announcement incomingtopologyannouncement logger is debug enabled isdebugenabled logger debug do post dopost backoff interval backoffinterval registration backoff interval backoffinterval backoff interval backoffinterval logger is debug enabled isdebugenabled logger debug do post dopost rejecting announcement instance topology incoming topology announcement incomingtopologyannouncement marking loop reply announcement replyannouncement set loop setloop backoff interval backoffinterval config get backoff standby interval getbackoffstandbyinterval normal successful rep lying replying topology instance sees reply announcement replyannouncement set local cluster setlocalcluster cluster view clusterview announcement registry announcementregistry add all except addallexcept reply announcement replyannouncement cluster view clusterview announcement filter announcementfilter accept string receiving sling id receivingslingid announcement announcement announcement get primary key getprimarykey equals incoming topology announcement incomingtopologyannouncement get primary key getprimarykey backoff interval backoffinterval reply announcement replyannouncement set backoff interval setbackoffinterval backoff interval backoffinterval logger is debug enabled isdebugenabled logger debug do post dopost backoff interval backoffinterval client reply announcement replyannouncement get backoff interval getbackoffinterval string request validator requestvalidator encode message encodemessage reply announcement replyannouncement asjson request validator requestvalidator trust message trustmessage response request gzip response client accepts string accept encoding header acceptencodingheader request get header getheader accept encoding accept encoding header acceptencodingheader accept encoding header acceptencodingheader gzip client content gzipped response set header setheader content encoding gzip gzip body gzip output stream gzipoutputstream gzip out gzipout gzip output stream gzipoutputstream response get output stream getoutputstream gzip out gzipout write get bytes getbytes utf gzip out gzipout close plaintext print writer printwriter response get writer getwriter print flush json exception jsonexception logger error do post dopost json exception jsonexception response send error senderror undefined cluster view exception undefinedclusterviewexception logger warn do post dopost cluster view clusterview moment handle connectors response send error senderror checks request remote server white listed whitelisted is white listed iswhitelisted http servlet request httpservletrequest request config is hmac enabled ishmacenabled is trusted istrusted request validator requestvalidator is trusted istrusted request is trusted istrusted logger info is white listed iswhitelisted rejecting distrusted request get remote addr getremoteaddr request get remote host getremotehost is trusted istrusted plaintext whitelist plaintextwhitelist request get remote host getremotehost plaintext whitelist plaintextwhitelist request get remote addr getremoteaddr iterator whitelist entry whitelistentry whitelist iterator has next hasnext whitelist entry whitelistentry whitelist entry whitelistentry whitelist entry whitelistentry accepts request logger info is white listed iswhitelisted rejecting request get remote addr getremoteaddr request get remote host getremotehost
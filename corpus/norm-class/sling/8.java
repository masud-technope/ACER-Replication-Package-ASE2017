licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling maven sling start slingstart java buffered reader bufferedreader java file java file output stream fileoutputstream java file writer filewriter java io exception ioexception java input stream inputstream java string reader stringreader java nio file files java util hash map hashmap java util map java util properties java util java util tree set treeset java util concurrent atomic atomic integer atomicinteger java util jar attributes java util jar jar output stream jaroutputstream java util jar manifest java util zip zip entry zipentry java util zip zip output stream zipoutputstream org apache commons io utils ioutils org apache felix file configuration handler configurationhandler org apache maven maven execution exception mavenexecutionexception org apache maven artifact artifact org apache maven artifact handler manager artifact handler manager artifacthandlermanager org apache maven artifact resolver artifact resolver artifactresolver org apache maven plugin mojo execution exception mojoexecutionexception org apache maven plugin mojo failure exception mojofailureexception org apache maven plugins annotations component org apache maven plugins annotations lifecycle p has e lifecyclephase org apache maven plugins annotations mojo org apache maven plugins annotations resolution scope resolutionscope org apache sling provisioning model artifact group artifactgroup org apache sling provisioning model configuration org apache sling provisioning model feature org apache sling provisioning model feature types featuretypes org apache sling provisioning model model org apache sling provisioning model model constants modelconstants org apache sling provisioning model run mode runmode org apache sling provisioning model org code haus codehaus plexus archiver archiver exception archiverexception org code haus codehaus plexus archiver un archiver unarchiver org code haus codehaus plexus archiver manager archiver manager archivermanager org code haus codehaus plexus archiver manager no such archiver exception nosucharchiverexception org code haus codehaus plexus util file utils fileutils prepare sling start applications mojo prepare default p has e defaultphase lifecycle p has e lifecyclephase process sources requires dependency resolution requiresdependencyresolution resolution scope resolutionscope test thread safe threadsafe prepare package mojo preparepackagemojo abstract sling start mojo abstractslingstartmojo string run modes runmodes key string base destination resources string boot directory bundles string artifacts directory install string config directory config string bootstrap file sling bootstrap txt string properties file sling install properties archiver un archiver unarchiver implementations component archiver manager archivermanager archiver manager archivermanager component artifact handler manager artifacthandlermanager artifact handler manager artifacthandlermanager artifacts remote repository component artifact resolver artifactresolver resolver override execute mojo execution exception mojoexecutionexception mojo failure exception mojofailureexception model model project helper projecthelper get effective model geteffectivemodel project get resolver options getresolveroptions execute model execute model model mojo execution exception mojoexecutionexception prepare global prepareglobal model prepare standalone app preparestandaloneapp model prepare webapp preparewebapp model file get standalone output directory getstandaloneoutputdirectory file project get build getbuild get output directory getoutputdirectory prepare global map artifacts prepare global prepareglobal model model mojo execution exception mojoexecutionexception map string file global contents map globalcontentsmap hash map hashmap string file build contents map buildcontentsmap model string global contents map globalcontentsmap project set context value setcontextvalue build constants buildconstants context global global contents map globalcontentsmap prepare standalone application prepare standalone app preparestandaloneapp model model mojo execution exception mojoexecutionexception map string file contents map contentsmap hash map hashmap string file project set context value setcontextvalue build constants buildconstants context standalone contents map contentsmap unpack base artifact create settings file output dir outputdir get standalone output directory getstandaloneoutputdirectory unpack base artifact unpackbaseartifact model output dir outputdir model constants modelconstants mode standalone build settings buildsettings model model constants modelconstants mode standalone output dir outputdir build bootstrap file buildbootstrapfile model model constants modelconstants mode standalone output dir outputdir build contents map buildcontentsmap model model constants modelconstants mode standalone contents map contentsmap prepare web application prepare webapp preparewebapp model model mojo execution exception mojoexecutionexception create webapp createwebapp map string file contents map contentsmap hash map hashmap string file project set context value setcontextvalue build constants buildconstants context webapp contents map contentsmap unpack base artifact create settings file output dir outputdir file project get build getbuild get directory getdirectory build constants buildconstants webapp out dir outdir file webapp dir webappdir file output dir outputdir web inf unpack base artifact unpackbaseartifact model output dir outputdir model constants modelconstants mode webapp check web xml feature webapp f webappf model get feature getfeature model constants modelconstants feature launchpad webapp f webappf run mode runmode webapprm webapp f webappf get run mode getrunmode webapprm configuration web config webconfig webapprm get configuration getconfiguration model constants modelconstants cfg launchpad web xml web config webconfig file webxml file webapp dir webappdir web xml file utils fileutils file write filewrite webxml web config webconfig get properties getproperties model constants modelconstants cfg launchpad web xml to string tostring io exception ioexception mojo execution exception mojoexecutionexception unable write configuration webxml build settings buildsettings model model constants modelconstants mode webapp webapp dir webappdir build bootstrap file buildbootstrapfile model model constants modelconstants mode webapp webapp dir webappdir build contents map buildcontentsmap model model constants modelconstants mode webapp contents map contentsmap build list artifacts build contents map buildcontentsmap model model string package run mode packagerunmode map string file contents map contentsmap mojo execution exception mojoexecutionexception package run mode packagerunmode add base jar artifact artifact get base artifact getbaseartifact model build constants buildconstants type jar contents map contentsmap base destination artifact get artifact id getartifactid artifact get artifact handler getartifacthandler get extension getextension artifact get file getfile feature feature model get features getfeatures feature is special isspecial feature get name getname equals model constants modelconstants feature boot feature types featuretypes subsystem application equals feature get type gettype feature types featuretypes subsystem composite equals feature get type gettype feature types featuretypes subsystem feature equals feature get type gettype build subsystem base buildsubsystembase contents map contentsmap feature run mode runmode run mode runmode feature get run modes getrunmodes package run mode packagerunmode run mode runmode is special isspecial build contents map buildcontentsmap model run mode runmode contents map contentsmap feature get name getname equals model constants modelconstants feature boot run mode runmode is run mode isrunmode package run mode packagerunmode build contents map buildcontentsmap model run mode runmode contents map contentsmap feature get name getname equals model constants modelconstants feature boot build subsystem base buildsubsystembase map string file contents map contentsmap feature feature mojo execution exception mojoexecutionexception output argument atomic integer atomicinteger start level holder startlevelholder atomic integer atomicinteger file subsystem file subsystemfile create subsystem base file createsubsystembasefile feature start level holder startlevelholder subsystem file subsystemfile contents map contentsmap get path for artifact getpathforartifact start level holder startlevelholder subsystem file subsystemfile get name getname subsystem file subsystemfile build list artifacts mode build contents map buildcontentsmap model model run mode runmode run mode runmode map string file contents map contentsmap is boot isboot mojo execution exception mojoexecutionexception artifact group artifactgroup group run mode runmode get artifact groups getartifactgroups org apache sling provisioning model artifact group artifact artifact model utils modelutils get artifact getartifact project maven session mavensession artifact handler manager artifacthandlermanager resolver get group id getgroupid get artifact id getartifactid get version getversion get type gettype get class ifier getclassifier file artifact file artifactfile artifact get file getfile contents map contentsmap get path for artifact getpathforartifact group get start level getstartlevel artifact file artifactfile get name getname run mode runmode is boot isboot artifact file artifactfile file root conf dir rootconfdir file get tmp dir gettmpdir global config has config hasconfig configuration config run mode runmode get configurations getconfigurations skip special configurations config is special isspecial string config path configpath get path for configuration getpathforconfiguration config run mode runmode file config file configfile file root conf dir rootconfdir config path configpath get log getlog debug string format creating configuration config file configfile get path getpath config file configfile get parent file getparentfile mkdirs file output stream fileoutputstream file output stream fileoutputstream config file configfile configuration handler configurationhandler write config get properties getproperties close io exception ioexception mojo execution exception mojoexecutionexception unable write configuration config file configfile has config hasconfig has config hasconfig contents map contentsmap base destination root conf dir rootconfdir file create subsystem base file createsubsystembasefile feature feature atomic integer atomicinteger start level holder startlevelholder mojo execution exception mojoexecutionexception file subsystem file subsystemfile file get tmp dir gettmpdir feature get name getname subsystem base subsystem file subsystemfile exists todo avoid calling multiple times start level holder startlevelholder run modes runmodes item archive archive processed reason jar file guaranteed store manifest manifest run modes manifest runmodesmanifest get run modes manifest getrunmodesmanifest feature get log getlog info creating subsystem base file subsystem file subsystemfile get name getname subsystem file subsystemfile get parent file getparentfile mkdirs jar output stream jaroutputstream jar output stream jaroutputstream file output stream fileoutputstream subsystem file subsystemfile run modes manifest runmodesmanifest map string integer bsn start order map bsnstartordermap hash map hashmap run mode runmode feature get run modes getrunmodes artifact group artifactgroup get artifact groups getartifactgroups sub systems subsystems start level artifact group start order start order startorder get start level getstartlevel org apache sling provisioning model artifact artifact artifact model utils modelutils get artifact getartifact project maven session mavensession artifact handler manager artifacthandlermanager resolver get group id getgroupid get artifact id getartifactid get version getversion get type gettype get class ifier getclassifier file artifact file artifactfile artifact get file getfile string entry name entryname get entry name getentryname artifact file artifactfile start order startorder zip entry zipentry zip entry zipentry entry name entryname put next entry putnextentry files copy artifact file artifactfile to path topath close entry closeentry create subsystem manifest createsubsystemmanifest feature bsn start order map bsnstartordermap start level holder startlevelholder add read me addreadme io exception ioexception ioe mojo execution exception mojoexecutionexception problem creating subsystem esa file subsystem file subsystemfile ioe subsystem file subsystemfile manifest get run modes manifest getrunmodesmanifest feature feature mojo execution exception mojoexecutionexception map string string builder stringbuilder run modes runmodes hash map hashmap run mode runmode feature get run modes getrunmodes artifact group artifactgroup get artifact groups getartifactgroups sub systems subsystems start level artifact group start order start order startorder get start level getstartlevel org apache sling provisioning model artifact artifact artifact model utils modelutils get artifact getartifact project maven session mavensession artifact handler manager artifacthandlermanager resolver get group id getgroupid get artifact id getartifactid get version getversion get type gettype get class ifier getclassifier file artifact file artifactfile artifact get file getfile string entry name entryname get entry name getentryname artifact file artifactfile start order startorder string run mode names runmodenames get names getnames run mode names runmodenames run mode names runmodenames string run modes runmodes key string run mode name runmodename run mode names runmodenames string builder stringbuilder run modes runmodes run mode name runmodename string builder stringbuilder run modes runmodes run mode name runmodename append append entry name entryname manifest manifest attributes attrs get main attributes getmainattributes manifest work attrs put value putvalue manifest version attrs put value putvalue manifest real manifest archive transformed real subsystem esa file map entry string string builder stringbuilder entry run modes runmodes entry set entryset attrs put value putvalue entry get key getkey entry get value getvalue to string tostring string get entry name getentryname file artifact file artifactfile start order startorder potential bundles start order startorder artifact file artifactfile get name getname manifest basis osgi inf subsystem file real esa file generated contents file depend actual run mode runmode executed additional subsystem file startup time finalize d finalized subsystem content create subsystem manifest createsubsystemmanifest feature feature map string integer start order map startordermap zip output stream zipoutputstream io exception ioexception subsystem start level subsystemstartlevel zip entry zipentry zip entry zipentry subsystem manifest base put next entry putnextentry manifest manifest attributes attributes get main attributes getmainattributes manifest work attributes put value putvalue manifest version attributes put value putvalue subsystem symbolic name symbolicname feature get name getname version int eger integer todo idea attributes put value putvalue subsystem version attributes put value putvalue subsystem type feature get type gettype feature get additional sections getadditionalsections subsystem manifest string get attributes getattributes start level startlevel subsystem start level subsystemstartlevel integer parse int parseint number format exception numberformatexception nfe buffered reader bufferedreader buffered reader bufferedreader string reader stringreader get contents getcontents string read line readline idx index of indexof idx string key substring idx string idx length idx substring idx attributes put value putvalue key trim trim write close entry closeentry subsystem start level subsystemstartlevel add read me addreadme zip output stream zipoutputstream io exception ioexception zip entry zipentry zip entry zipentry read me readme txt input stream inputstream get class getclass get resource as stream getresourceasstream subsystem base read me readme txt put next entry putnextentry io utils ioutils copy close entry closeentry build settings pack aging packaging mode build settings buildsettings model model string package run mode packagerunmode file output dir outputdir mojo execution exception mojoexecutionexception properties settings properties feature launchpad feature launchpadfeature model get feature getfeature model constants modelconstants feature launchpad launchpad feature launchpadfeature run mode runmode launchpad run mode launchpadrunmode launchpad feature launchpadfeature get run mode getrunmode launchpad run mode launchpadrunmode map entry string string entry launchpad run mode launchpadrunmode get settings getsettings settings entry get key getkey deescape variable placeholders deescapevariableplaceholders entry get value getvalue feature boot feature bootfeature model get feature getfeature model constants modelconstants feature boot boot feature bootfeature run mode runmode boot run mode bootrunmode boot feature bootfeature get run mode getrunmode boot run mode bootrunmode map entry string string entry boot run mode bootrunmode get settings getsettings settings entry get key getkey deescape variable placeholders deescapevariableplaceholders entry get value getvalue feature model get features getfeatures run mode runmode packagerm get run mode getrunmode string package run mode packagerunmode packagerm map entry string string entry packagerm get settings getsettings settings entry get key getkey deescape variable placeholders deescapevariableplaceholders entry get value getvalue settings size file settings file settingsfile file output dir outputdir properties file get log getlog debug string format creating settings settings file settingsfile get path getpath file writer filewriter writer writer file writer filewriter settings file settingsfile settings store writer io exception ioexception ioe mojo execution exception mojoexecutionexception unable write properties file ioe io utils ioutils close quietly closequietly writer build bootstrap file pack aging packaging mode build bootstrap file buildbootstrapfile model model string package run mode packagerunmode file output dir outputdir mojo execution exception mojoexecutionexception string builder stringbuilder string builder stringbuilder feature launchpad feature launchpadfeature model get feature getfeature model constants modelconstants feature launchpad launchpad feature launchpadfeature run mode runmode launchpad run mode launchpadrunmode launchpad feature launchpadfeature get run mode getrunmode launchpad run mode launchpadrunmode configuration launchpad run mode launchpadrunmode get configuration getconfiguration model constants modelconstants cfg launchpad bootstrap append get properties getproperties get pid getpid append run mode runmode packagerm launchpad feature launchpadfeature get run mode getrunmode string package run mode packagerunmode packagerm configuration packagerm get configuration getconfiguration model constants modelconstants cfg launchpad bootstrap append get properties getproperties get pid getpid append length file file file output dir outputdir bootstrap file get log getlog debug string format creating bootstrap file file get path getpath file utils fileutils file write filewrite file to string tostring io exception ioexception ioe mojo execution exception mojoexecutionexception unable write bootstrap file ioe base artifact artifact get base artifact getbaseartifact model model string class ifier classifier string type mojo execution exception mojoexecutionexception org apache sling provisioning model artifact base artifact baseartifact model utils modelutils find base artifact findbaseartifact model artifact model utils modelutils get artifact getartifact project maven session mavensession artifact handler manager artifacthandlermanager resolver base artifact baseartifact get group id getgroupid base artifact baseartifact get artifact id getartifactid base artifact baseartifact get version getversion type class ifier classifier mojo execution exception mojoexecutionexception string format project doesn base dependency group id groupid artifact id artifactid base artifact baseartifact get group id getgroupid base artifact baseartifact get artifact id getartifactid maven execution exception mavenexecutionexception mee mojo execution exception mojoexecutionexception mee get message getmessage mee get cause getcause unpack base artifact unpack base artifact unpackbaseartifact model model file output directory outputdirectory string package run mode packagerunmode mojo execution exception mojoexecutionexception string class ifier classifier string type model constants modelconstants mode standalone equals package run mode packagerunmode class ifier classifier build constants buildconstants class ifier classifier app type build constants buildconstants type jar class ifier classifier build constants buildconstants class ifier classifier webapp type build constants buildconstants type war artifact artifact get base artifact getbaseartifact model class ifier classifier type unpack artifact get file getfile output directory outputdirectory unpack file unpack file source file destination mojo execution exception mojoexecutionexception get log getlog debug unpacking source get path getpath destination get path getpath destination mkdirs un archiver unarchiver un archiver unarchiver archiver manager archivermanager get un archiver getunarchiver source un archiver unarchiver set source file setsourcefile source un archiver unarchiver set dest directory setdestdirectory destination un archiver unarchiver extract no such archiver exception nosucharchiverexception mojo execution exception mojoexecutionexception unable find archiver source get path getpath archiver exception archiverexception mojo execution exception mojoexecutionexception unable unpack source get path getpath string get path for artifact getpathforartifact start level startlevel string artifact name artifactname get path for artifact getpathforartifact start level startlevel artifact name artifactname relative path artifact string get path for artifact getpathforartifact start level startlevel string artifact name artifactname run mode runmode is boot isboot string run modes list runmodeslist tree set treeset string get names getnames string mode get names getnames run modes list runmodeslist add mode string run mode ext runmodeext run modes list runmodeslist size is special isspecial run mode ext runmodeext string builder stringbuilder string builder stringbuilder string run modes list runmodeslist append append run mode ext runmodeext to string tostring is boot isboot string format base destination boot directory artifact name artifactname string format base destination artifacts directory run mode ext runmodeext start level startlevel start level startlevel artifact name artifactname relative path configuration string get path for configuration getpathforconfiguration configuration config run mode runmode string run modes list runmodeslist tree set treeset string get names getnames string mode get names getnames run modes list runmodeslist add mode string run mode ext runmodeext run modes list runmodeslist size is special isspecial run mode ext runmodeext string builder stringbuilder string builder stringbuilder string run modes list runmodeslist append append append run mode ext runmodeext to string tostring string main name mainname config get factory pid getfactorypid config get factory pid getfactorypid config get pid getpid string alias config get factory pid getfactorypid config get pid getpid string format config base destination config directory run mode ext runmodeext main name mainname alias replace param text string escaped variables string deescaped variables string deescape variable placeholders deescapevariableplaceholders string text text text replace all replaceall
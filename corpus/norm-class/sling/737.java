licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling testing mock sling resource org apache sling jcr resource jcr resource constants jcrresourceconstants sling ordered folder org apache sling jcr resource jcr resource constants jcrresourceconstants sling resource type property org junit assert array equals assertarrayequals org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert true asserttrue java byte array input stream bytearrayinputstream java io exception ioexception java input stream inputstream java util calendar java util java util list javax jcr node javax jcr repository exception repositoryexception javax jcr session org apache commons io utils ioutils org apache commons lang time date utils dateutils org apache jackrabbit jcr constants jcrconstants org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource util resourceutil org apache sling api resource value map valuemap org apache sling testing mock sling resource resolver type resourceresolvertype org apache sling testing mock sling junit sling context slingcontext org junit org junit org junit rule org junit test google common collect immutable list immutablelist google common collect immutable map immutablemap simple write read resource values test jcr api create test data abstract jcr resource resolver test abstractjcrresourceresolvertest rule sling context slingcontext context sling context slingcontext get resource resolver type getresourceresolvertype string string string string array string integer calendar calendar calendar get instance getinstance binary session session node test root testroot resource resolver type resourceresolvertype get resource resolver type getresourceresolvertype set up setup repository exception repositoryexception session context resource resolver resourceresolver adapt to adaptto session prepare test data jcr api node root node rootnode get test root node gettestrootnode node node root node rootnode add node addnode node jcr constants jcrconstants unstructured node set property setproperty string prop stringprop string node set property setproperty string array prop stringarrayprop string array node set property setproperty int eger prop integerprop integer node set property setproperty double prop doubleprop node set property setproperty boolean prop booleanprop node set property setproperty date prop dateprop date utils dateutils to calendar tocalendar node set property setproperty calendar prop calendarprop calendar node set property setproperty binary prop binaryprop session get value factory getvaluefactory create binary createbinary byte array input stream bytearrayinputstream binary node add node addnode node jcr constants jcrconstants unstructured node add node addnode node jcr constants jcrconstants unstructured session save tear down teardown test root testroot test root node created demand unique path node get test root node gettestrootnode repository exception repositoryexception test root testroot test root testroot context resource resolver resourceresolver get resource getresource context unique root uniqueroot content adapt to adaptto node test root testroot test test get resources and values testgetresourcesandvalues io exception ioexception repository exception repositoryexception resource resource context resource resolver resourceresolver get resource getresource get test root node gettestrootnode get path getpath node assert not null assertnotnull resource assert equals assertequals node resource get name getname value map valuemap props resource util resourceutil get value map getvaluemap resource assert equals assertequals string props string prop stringprop string assert array equals assertarrayequals string array props string array prop stringarrayprop string assert equals assertequals integer integer props int eger prop integerprop integer assert equals assertequals props double prop doubleprop assert equals assertequals props boolean prop booleanprop assert equals assertequals props date prop dateprop assert equals assertequals calendar get time gettime props calendar prop calendarprop calendar get time gettime resource binary prop resource binarypropresource resource get child getchild binary prop binaryprop input stream inputstream binary prop resource binarypropresource adapt to adaptto input stream inputstream data from resource datafromresource io utils ioutils to byte array tobytearray close assert array equals assertarrayequals binary data from resource datafromresource read time ensure original input stream returned input stream inputstream binary prop resource binarypropresource adapt to adaptto input stream inputstream data from resource datafromresource io utils ioutils to byte array tobytearray close assert array equals assertarrayequals binary data from resource datafromresource list resource children immutable list immutablelist copy of copyof resource list children listchildren assert equals assertequals children size assert equals assertequals node children get name getname assert equals assertequals node children get name getname test test create node with primary type testcreatenodewithprimarytype repository exception repositoryexception persistence exception persistenceexception resource parent context resource resolver resourceresolver get resource getresource get test root node gettestrootnode get path getpath resource child context resource resolver resourceresolver create parent node type resource nodetyperesource immutable map immutablemap string object builder sling resource type property jcr constants jcrconstants unstructured build assert not null assertnotnull child assert equals assertequals jcr constants jcrconstants unstructured child get resource type getresourcetype assert equals assertequals jcr constants jcrconstants unstructured child adapt to adaptto node get primary node type getprimarynodetype get name getname test test create node with resource type testcreatenodewithresourcetype repository exception repositoryexception persistence exception persistenceexception resource parent context resource resolver resourceresolver get resource getresource get test root node gettestrootnode get path getpath resource child resource util resourceutil get or create resource getorcreateresource context resource resolver resourceresolver parent get path getpath int ermediate intermediate child sling resource type jcr constants jcrconstants unstructured assert not null assertnotnull child assert equals assertequals sling ordered folder parent get resource type getresourcetype assert equals assertequals sling resource type child get resource type getresourcetype test test pending changes commit testpendingchangescommit exception skip test jcr mock track pending get resource resolver type getresourceresolvertype resource resolver type resourceresolvertype jcr mock resource test root resource testrootresource context resource resolver resourceresolver get resource getresource get test root node gettestrootnode get path getpath context resource resolver resourceresolver delete test root resource testrootresource assert true asserttrue session has pending changes haspendingchanges context resource resolver resourceresolver commit assert false assertfalse session has pending changes haspendingchanges
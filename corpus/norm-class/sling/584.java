licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest user manager usermanager org junit assert equals assertequals org junit assert not null assertnotnull org junit assert null assertnull java io exception ioexception java util array list arraylist java util list javax servlet http http servlet response httpservletresponse org apache commons http client httpclient credentials org apache commons http client httpclient http method httpmethod org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient username password credentials usernamepasswordcredentials org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons testing int egration integration http test httptest org junit org junit org junit test tests update authorizable updateauthorizable change password changepassword sling post operations user resource update user test updateusertest string test user id testuserid user manager test util usermanagertestutil user manager test util usermanagertestutil setup exception set up setup cleanup exception test user id testuserid remove test user exists string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams tear down teardown test test update user testupdateuser io exception ioexception json exception jsonexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid update html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair display name displayname updated test user post params postparams add name value pair namevaluepair url http apache org updated credentials creds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams fetch user profile json verify settings string get url geturl http test httptest http base url system user manager usermanager user test user id testuserid json profile request returns data assert authenticated http status assertauthenticatedhttpstatus creds get url geturl http servlet response httpservletresponse string json get authenticated content getauthenticatedcontent creds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals updated test user json obj jsonobj get string getstring display name displayname assert equals assertequals http apache org updated json obj jsonobj get string getstring url test test change user password testchangeuserpassword io exception ioexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid change password changepassword html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair old pwd oldpwd test pwd testpwd post params postparams add name value pair namevaluepair new pwd newpwd test new pwd testnewpwd post params postparams add name value pair namevaluepair new pwd confirm newpwdconfirm test new pwd testnewpwd credentials creds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams test test change user password wrong old pwd testchangeuserpasswordwrongoldpwd io exception ioexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid change password changepassword html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair old pwd oldpwd wrong test pwd wrongtestpwd post params postparams add name value pair namevaluepair new pwd newpwd test new pwd testnewpwd post params postparams add name value pair namevaluepair new pwd confirm newpwdconfirm test new pwd testnewpwd credentials creds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams test test change user password wrong confirm pwd testchangeuserpasswordwrongconfirmpwd io exception ioexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid change password changepassword html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair old pwd oldpwd test pwd testpwd post params postparams add name value pair namevaluepair new pwd newpwd test new pwd testnewpwd post params postparams add name value pair namevaluepair new pwd confirm newpwdconfirm wrong test new pwd wrongtestnewpwd credentials creds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse internal server error post params postparams test sling test test update user response as n testupdateuserresponseasjson io exception ioexception json exception jsonexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid update json list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair display name displayname updated test user post params postparams add name value pair namevaluepair url http apache org updated credentials creds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated post content getauthenticatedpostcontent creds post url posturl http test httptest content type json post params postparams http servlet response httpservletresponse json response parsed json object json object jsonobject json obj jsonobj json object jsonobject json assert not null assertnotnull json obj jsonobj test sling io exception ioexception test test change user password as admin istrator without old pwd testchangeuserpasswordasadministratorwithoutoldpwd io exception ioexception test user id testuserid create test user createtestuser string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid change password changepassword html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair new pwd newpwd test new pwd testnewpwd post params postparams add name value pair namevaluepair new pwd confirm newpwdconfirm test new pwd testnewpwd credentials creds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams test sling io exception ioexception test test disable user testdisableuser io exception ioexception test user id testuserid create test user createtestuser login user disabled login work list name value pair namevaluepair params array list arraylist name value pair namevaluepair params add name value pair namevaluepair username test user id testuserid params add name value pair namevaluepair password test pwd testpwd params add name value pair namevaluepair validate http method httpmethod post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse params assert null assertnull post get response header getresponseheader reason get http client gethttpclient get state getstate clear credentials clearcredentials get http client gethttpclient get state getstate clear cookies clearcookies update user disable string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid update html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair disabled post params postparams add name value pair namevaluepair disabled reason disabledreason testing assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams user disabled login fail post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse forbidden params assert not null assertnotnull post get response header getresponseheader reason get http client gethttpclient get state getstate clear credentials clearcredentials get http client gethttpclient get state getstate clear cookies clearcookies enable user post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair disabled assert authenticated admin post status assertauthenticatedadminpoststatus post url posturl http servlet response httpservletresponse post params postparams login user enabled login work post assert post status assertpoststatus http test httptest http base url security check http servlet response httpservletresponse params assert null assertnull post get response header getresponseheader reason get http client gethttpclient get state getstate clear credentials clearcredentials get http client gethttpclient get state getstate clear cookies clearcookies
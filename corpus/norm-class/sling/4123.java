licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer core impl java io exception ioexception java serializable java util array list arraylist java util collection java util collections java util hash set hashset java util iterator java util list java util org apache sling installer api installable resource installableresource org apache sling installer api event installation event installationevent org apache sling installer api event installation listener installationlistener org apache sling installer api tasks registered resource registeredresource org apache sling installer api tasks resource state resourcestate org apache sling installer api tasks task resource taskresource org apache sling installer api tasks task resource group taskresourcegroup org slf logger org slf logger factory loggerfactory persistent list registered resource registeredresource installer track registered resources entity resource list entityresourcelist serializable task resource group taskresourcegroup serial version control serialization serialversionuid serialization version version logger logger logger logger factory loggerfactory get logger getlogger entity resource list entityresourcelist list registered resources entity list registered resource impl registeredresourceimpl resources array list arraylist registered resource impl registeredresourceimpl alias string alias resource group string resource id resourceid listener installation listener installationlistener listener entity resource list entityresourcelist string resource id resourceid installation listener installationlistener listener resource id resourceid resource id resourceid listener listener serialize object write version serialize entry resources list param object output stream io exception ioexception write object writeobject java object output stream objectoutputstream io exception ioexception write int writeint version write int writeint resources size registered resource registeredresource resources write object writeobject write object writeobject alias write object writeobject resource id resourceid deserialize object read version deserialize entry resources list read object readobject java object input stream objectinputstream io exception ioexception class not found exception classnotfoundexception version read int readint version version version class not found exception classnotfoundexception get class getclass get name getname util set field setfield resources array list arraylist registered resource impl registeredresourceimpl size read int readint size registered resource impl registeredresourceimpl registered resource impl registeredresourceimpl read object readobject resources add version alias string read object readobject resource id resourceid string read object readobject resource list empty resources is empty isempty resources is empty isempty org apache sling installer api tasks task resource group taskresourcegroup get active resource getactiveresource task resource taskresource get active resource getactiveresource resources is empty isempty collections sort resources task resource taskresource resources get state getstate resource state resourcestate install get state getstate resource state resourcestate uninstall org apache sling installer api tasks task resource group taskresourcegroup get next active resource getnextactiveresource task resource taskresource get next active resource getnextactiveresource get active resource getactiveresource resources size collections sort resources item iterator iterator registered resource impl registeredresourceimpl resources iterator skip resource task resource taskresource get first resource getfirstresource resources is empty isempty collections sort resources resources alias group string get alias getalias alias alias group string get full alias getfullalias alias pos resource id resourceid index of indexof resource id resourceid substring pos alias resource string get resource id getresourceid resource id resourceid resource set resource id setresourceid string resource id resourceid listener set listener setlistener installation listener installationlistener listener listener listener force set force finish state setforcefinishstate resource state resourcestate resource install set finish state setfinishstate work cases registered resource impl registeredresourceimpl get first resource getfirstresource set state setstate resource state resourcestate install set finish state setfinishstate org apache sling installer api tasks task resource group taskresourcegroup set finish state setfinishstate org apache sling installer api tasks resource state resourcestate set finish state setfinishstate resource state resourcestate task resource taskresource to activate toactivate get active resource getactiveresource to activate toactivate to activate toactivate get state getstate resource state resourcestate uninstall resources size task resource taskresource get next active resource getnextactiveresource check template get dictionary getdictionary get dictionary getdictionary installable resource installableresource resource template resource template install registered resource impl registeredresourceimpl set state setstate resource state resourcestate resource state resourcestate uninstalled resource uninstalled get state getstate resource state resourcestate get state getstate resource state resourcestate installed logger debug reactivating cycle registered resource impl registeredresourceimpl set state setstate resource state resourcestate install don install uninstalled get state getstate resource state resourcestate install registered resource impl registeredresourceimpl set state setstate resource state resourcestate resource uninstalled resource state resourcestate uninstalled resource state resourcestate installed resource installed resources size item iterator iterator registered resource impl registeredresourceimpl resources iterator skip has next hasnext task resource taskresource rsrc rsrc get state getstate resource state resourcestate installed registered resource impl registeredresourceimpl rsrc set state setstate resource state resourcestate install registered resource impl registeredresourceimpl to activate toactivate set state setstate resource state resourcestate installed remove install info attributes resource installed to activate toactivate set attribute setattribute task resource taskresource attr install excluded to activate toactivate set attribute setattribute task resource taskresource attr install info remove install info attributes resources group iterator registered resource impl registeredresourceimpl tri resources iterator skip tri tri has next hasnext task resource taskresource rsrc tri rsrc set attribute setattribute task resource taskresource attr install excluded rsrc set attribute setattribute task resource taskresource attr install info listener on event onevent installation event installationevent type get type gettype type proc essed processed object get source getsource to activate toactivate resource state resourcestate uninstalled cleanup to activate toactivate org apache sling installer api tasks task resource group taskresourcegroup set finish state setfinishstate org apache sling installer api tasks resource state resourcestate java lang string set finish state setfinishstate resource state resourcestate string alias alias alias set finish state setfinishstate cleanup registered resource registeredresource registered resource impl registeredresourceimpl registered resource impl registeredresourceimpl cleanup collection registered resource impl registeredresourceimpl get resources getresources collections sort resources resources add or update addorupdate registered resource impl registeredresourceimpl logger debug adding resource collections sort resources object url replace attributes add iterator registered resource impl registeredresourceimpl task iter taskiter resources iterator task iter taskiter has next hasnext task resource taskresource task iter taskiter geturl equals geturl registered resource impl registeredresourceimpl is same resource issameresource registered resource impl registeredresourceimpl get digest getdigest equals get digest getdigest resource digest remove file logger debug clean up cleanup duplicate resource cleanup resource ignore add get state getstate resource state resourcestate installed installed uninstall registered resource impl registeredresourceimpl set state setstate resource state resourcestate uninstall logger debug clean up cleanup obsolete resource task iter taskiter remove cleanup add resources add remove string url collections sort resources iterator registered resource impl registeredresourceimpl resources iterator has next hasnext task resource taskresource geturl equals url get state getstate resource state resourcestate installed get state getstate resource state resourcestate install logger debug marking uninstalling registered resource impl registeredresourceimpl set state setstate resource state resourcestate uninstall logger debug removing unused remove cleanup comp act compact resource group removing uninstalled entries code code cycle started compact collections sort resources start new cycle startnewcycle list task resource taskresource to delete todelete array list arraylist task resource taskresource task resource taskresource resources get state getstate resource state resourcestate uninstalled get state getstate resource state resourcestate uninstall to delete todelete add to delete todelete is empty isempty avoid resources remove resource changed compare diff erently differently trip tree set treeset remove search registered resource impl registeredresourceimpl copy hash set hashset registered resource impl registeredresourceimpl resources registered resource registeredresource to delete todelete copy remove cleanup logger debug removing uninstalled list resources clear resources add all addall copy is empty isempty start new cycle startnewcycle start new cycle startnewcycle
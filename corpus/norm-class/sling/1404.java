licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling form impl jaas java util collections java util javax jcr credentials javax jcr simple credentials simplecredentials javax security login login exception loginexception org apache jackrabbit oak spi security authentication abstract login module abstractloginmodule org apache jackrabbit oak spi security authentication pre authenticated login preauthenticatedlogin org apache sling form impl form authentication handler formauthenticationhandler org slf logger org slf logger factory loggerfactory form login module formloginmodule abstract login module abstractloginmodule logger log logger factory loggerfactory get logger getlogger form login module formloginmodule supported credentials required link org apache jackrabbit oak spi security authentication abstract login module abstractloginmodule supported credentials collections singleton form credentials formcredentials empty pwd extra cted extracted user id userid login call string user id userid override get supported credentials getsupportedcredentials supported credentials link org apache sling form impl form authentication handler formauthenticationhandler validate credentials contents form authentication handler formauthenticationhandler auth handler authhandler form login module formloginmodule form authentication handler formauthenticationhandler auth handler authhandler auth handler authhandler auth handler authhandler suppress warnings suppresswarnings unchecked login login exception loginexception credentials credentials get credentials getcredentials credentials form credentials formcredentials form credentials formcredentials cred form credentials formcredentials credentials user id userid cred get user id getuserid auth handler authhandler is valid isvalid cred log debug invalid credentials user id userid log debug extract user id userid credentials login rely login modules populate subject shared state sharedstate shared key pre login pre authenticated login preauthenticatedlogin user id userid shared state sharedstate shared key credentials simple credentials simplecredentials user id userid empty pwd shared state sharedstate shared key login user id userid log debug login succeeded trusted user user id userid commit login exception loginexception user id userid login attempt login module successful clear state clearstate override clear state clearstate user id userid clear state clearstate
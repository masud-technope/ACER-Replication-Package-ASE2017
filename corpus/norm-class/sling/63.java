licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event impl jobs java util array list arraylist java util collections java util dictionary java util hash map hashmap java util hashtable java util list java util map java util concurrent atomic atomic boolean atomicboolean org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations modified org apache felix scr annotations property org apache felix scr annotations property unbounded propertyunbounded org apache felix scr annotations reference org apache felix scr annotations reference cardinality referencecardinality org apache felix scr annotations reference policy referencepolicy org apache felix scr annotations references org apache felix scr annotations service org apache sling commons osgi properties util propertiesutil org apache sling discovery property provider propertyprovider org apache sling event impl jobs config topology capabilities topologycapabilities org apache sling event impl support topic matcher topicmatcher org apache sling event impl support topic matcher helper topicmatcherhelper org apache sling event jobs job org apache sling event jobs consumer job consumer jobconsumer org apache sling event jobs consumer job consumer jobconsumer job result jobresult org apache sling event jobs consumer job execution context jobexecutioncontext org apache sling event jobs consumer job execution result jobexecutionresult org apache sling event jobs consumer job executor jobexecutor org osgi framework bundle context bundlecontext org osgi framework constants org osgi framework service reference servicereference org osgi framework service registration serviceregistration org slf logger org slf logger factory loggerfactory component manages track job consumer services component label apache sling job consumer manager description consumer manager controls job consumer processors temp orarily temporarily disable job processing current instance instances cluster metatype service job consumer manager jobconsumermanager references reference reference interface referenceinterface job consumer jobconsumer cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic reference reference interface referenceinterface job executor jobexecutor cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic property org apache sling installer configuration persist bool value boolvalue label distribute config description disabled configuration persisted save cluster current instance option disabled job consumer manager jobconsumermanager logger logger logger factory loggerfactory get logger getlogger get class getclass property unbounded property unbounded propertyunbounded array label topic whitelist description list topics processed instance leaving empty job consumers disabled put ting putting entry enables job consumers adding separate topics enables job consumers topic string property whitelist job consumer manager consumermanager whitelist property unbounded property unbounded propertyunbounded array label topic black list blacklist description list topics should n shouldn processed instance leaving empty job consumers enabled put ting putting entry disables job consumers adding separate topics disables job consumers topic string property blacklist job consumer manager consumermanager blacklist map consumers keyed topic sorted service ranking map string list consumer info consumerinfo topic to consumer map topictoconsumermap hash map hashmap string list consumer info consumerinfo service registration serviceregistration propagation service registration serviceregistration propagation service propagationservice string topics topic matcher topicmatcher whitelist matchers whitelistmatchers topic matcher topicmatcher blacklist matchers blacklistmatchers change count changecount bundle context bundlecontext bundle context bundlecontext map string object listener map listenermap hash map hashmap string object dictionary string object get registration properties getregistrationproperties dictionary string object service props serviceprops hashtable string object service props serviceprops property provider propertyprovider property properties topology capabilities topologycapabilities property topics modification event service props serviceprops change count changecount change count changecount service props serviceprops activate activate bundle context bundlecontext map string object props bundle context bundlecontext modified props modified modified bundle context bundlecontext map string object props was enabled wasenabled propagation service propagationservice whitelist matchers whitelistmatchers topic matcher helper topicmatcherhelper build matchers buildmatchers properties util propertiesutil to string array tostringarray props property whitelist blacklist matchers blacklistmatchers topic matcher helper topicmatcherhelper build matchers buildmatchers properties util propertiesutil to string array tostringarray props property blacklist enable whitelist matchers whitelistmatchers blacklist matchers blacklistmatchers topic matcher helper topicmatcherhelper match was enabled wasenabled enable topic to consumer map topictoconsumermap calculate topics calculatetopics enable enable logger debug registering property provider topics propagation service propagationservice register service registerservice property provider propertyprovider get name getname property provider propertyprovider override string get property getproperty string topology capabilities topologycapabilities property topics equals topics get registration properties getregistrationproperties logger debug unregistering property provider propagation service propagationservice unregister propagation service propagationservice enable update properties topic to consumer map topictoconsumermap calculate topics calculatetopics logger debug updating property provider topics propagation service propagationservice set properties setproperties get registration properties getregistrationproperties deactivate deactivate propagation service propagationservice propagation service propagationservice unregister propagation service propagationservice bundle context bundlecontext topic to consumer map topictoconsumermap topic to consumer map topictoconsumermap clear listener map listenermap clear executor topic param topic job topic consumer code code job executor jobexecutor get executor getexecutor string topic topic to consumer map topictoconsumermap list consumer info consumerinfo consumers topic to consumer map topictoconsumermap topic consumers consumers get executor getexecutor bundle context bundlecontext pos topic last index of lastindexof pos string category topic substring pos concat list consumer info consumerinfo category consumers categoryconsumers topic to consumer map topictoconsumermap category category consumers categoryconsumers category consumers categoryconsumers get executor getexecutor bundle context bundlecontext search deep consumers consumer string sub category subcategory topic substring pos concat list consumer info consumerinfo sub category consumers subcategoryconsumers topic to consumer map topictoconsumermap sub category subcategory sub category consumers subcategoryconsumers sub category consumers subcategoryconsumers get executor getexecutor bundle context bundlecontext pos topic last index of lastindexof pos pos register listener registerlistener string key job executor jobexecutor consumer job execution context jobexecutioncontext handler topic to consumer map topictoconsumermap listener map listenermap key object consumer handler unregister listener unregisterlistener string key topic to consumer map topictoconsumermap listener map listenermap remove key topics instance string get topics gettopics topics bind consumer param service reference servicereference service reference consumer bind job consumer bindjobconsumer service reference servicereference service reference servicereference bind service bindservice service reference servicereference unbind consumer param service reference servicereference service reference consumer unbind job consumer unbindjobconsumer service reference servicereference service reference servicereference unbind service unbindservice service reference servicereference bind executor param service reference servicereference service reference executor bind job executor bindjobexecutor service reference servicereference service reference servicereference bind service bindservice service reference servicereference unbind executor param service reference servicereference service reference executor unbind job executor unbindjobexecutor service reference servicereference service reference servicereference unbind service unbindservice service reference servicereference bind consumer executor param service reference servicereference service reference consumer executor param is consumer isconsumer indicating job consumer jobconsumer job executor jobexecutor bind service bindservice service reference servicereference service reference servicereference is consumer isconsumer string topics properties util propertiesutil to string array tostringarray service reference servicereference get property getproperty job consumer jobconsumer property topics topics topics length consumer info consumerinfo info consumer info consumerinfo service reference servicereference is consumer isconsumer changed topic to consumer map topictoconsumermap string topics string topic trim topic length list consumer info consumerinfo consumers topic to consumer map topictoconsumermap topic consumers consumers array list arraylist job consumer manager jobconsumermanager consumer info consumerinfo topic to consumer map topictoconsumermap topic consumers changed consumers add info collections sort consumers changed calculate topics calculatetopics propagation service propagationservice changed propagation service propagationservice logger debug updating property provider topics propagation service propagationservice set properties setproperties get registration properties getregistrationproperties unbind consumer executor param service reference servicereference service reference consumer executor param is consumer isconsumer indicating job consumer jobconsumer job executor jobexecutor unbind service unbindservice service reference servicereference service reference servicereference is consumer isconsumer string topics properties util propertiesutil to string array tostringarray service reference servicereference get property getproperty job consumer jobconsumer property topics topics topics length consumer info consumerinfo info consumer info consumerinfo service reference servicereference is consumer isconsumer changed topic to consumer map topictoconsumermap string topics string topic trim topic length list consumer info consumerinfo consumers topic to consumer map topictoconsumermap topic consumers sanity check consumer info consumerinfo old consumer oldconsumer consumers old consumer oldconsumer equals info old consumer oldconsumer executor notify listener object listener objects listenerobjects listener map listenermap values listener objects listenerobjects old consumer oldconsumer executor job execution context jobexecutioncontext context job execution context jobexecutioncontext listener objects listenerobjects context async processing finished asyncprocessingfinished context result failed consumers remove info consumers size topic to consumer map topictoconsumermap remove topic changed changed calculate topics calculatetopics propagation service propagationservice changed propagation service propagationservice logger debug updating property provider topics propagation service propagationservice set properties setproperties get registration properties getregistrationproperties match string topic topic matcher topicmatcher match ers matchers topic matcher topicmatcher match ers matchers match topic calculate topics calculatetopics enabled enabled create sorted list ensures property topics list string topic list topiclist array list arraylist string string topic topic to consumer map topictoconsumermap key set keyset check whitelist match topic whitelist matchers whitelistmatchers blacklist blacklist matchers blacklistmatchers match topic blacklist matchers blacklistmatchers topic list topiclist add topic collections sort topic list topiclist string builder stringbuilder string builder stringbuilder string topic topic list topiclist append append topic topics to string tostring topics internal caching consumer infos service ranking consumer info consumerinfo comparable consumer info consumerinfo service reference servicereference service reference servicereference is consumer isconsumer job executor jobexecutor executor ranking service id serviceid consumer info consumerinfo service reference servicereference service reference servicereference is consumer isconsumer service reference servicereference service reference servicereference is consumer isconsumer is consumer isconsumer object service reference servicereference get property getproperty constants service ranking integer ranking ranking integer service id serviceid service reference servicereference get property getproperty constants service override compare to compareto consumer info consumerinfo ranking ranking ranking ranking ranks equal sort service desc ending descending order service id serviceid service id serviceid override equals object obj obj consumer info consumerinfo consumer info consumerinfo obj service id serviceid service id serviceid override hash code hashcode service reference servicereference hash code hashcode job executor jobexecutor get executor getexecutor bundle context bundlecontext bundle context bundlecontext executor is consumer isconsumer executor job consumer wrapper jobconsumerwrapper job consumer jobconsumer bundle context bundlecontext get service getservice service reference servicereference executor job executor jobexecutor bundle context bundlecontext get service getservice service reference servicereference executor job consumer wrapper jobconsumerwrapper job executor jobexecutor job consumer jobconsumer consumer job consumer wrapper jobconsumerwrapper job consumer jobconsumer consumer consumer consumer override job execution result jobexecutionresult process job job job execution context jobexecutioncontext context job consumer jobconsumer async handler asynchandler async handler asynchandler job consumer jobconsumer async handler asynchandler object async lock asynclock object atomic boolean atomicboolean async done asyncdone atomic boolean atomicboolean check job execution result jobexecutionresult result async lock asynclock async done asyncdone async done asyncdone context async processing finished asyncprocessingfinished result illegal state exception illegalstateexception job marked processed override check context result succeeded override failed check context result failed override cancel check context result can celled cancelled job impl jobimpl job set property setproperty job consumer jobconsumer property job async handler async handler asynchandler job consumer jobconsumer job result jobresult result consumer process job result job result jobresult async result job result jobresult failed context result failed result job result jobresult context result succeeded context result can celled cancelled
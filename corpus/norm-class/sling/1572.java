licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery impl standalone java util array list arraylist java util arrays java util collection java util collections java util hash map hashmap java util hash set hashset java util iterator java util linked list linkedlist java util list java util map java util org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations reference org apache felix scr annotations reference cardinality referencecardinality org apache felix scr annotations reference policy referencepolicy org apache felix scr annotations service org apache sling discovery cluster view clusterview org apache sling discovery discovery service discoveryservice org apache sling discovery instance description instancedescription org apache sling discovery instance filter instancefilter org apache sling discovery property provider propertyprovider org apache sling discovery topology event topologyevent org apache sling discovery topology event topologyevent type org apache sling discovery topology event listener topologyeventlistener org apache sling discovery topology view topologyview org apache sling settings sling settings service slingsettingsservice org osgi framework constants org slf logger org slf logger factory loggerfactory simple implementation discovery service cluster installation single instance disabled enabled osg i osgi configuration component service discovery service discoveryservice no cluster discovery service noclusterdiscoveryservice discovery service discoveryservice logger logger logger logger factory loggerfactory get logger getlogger get class getclass sling settings service sling modes reference sling settings service slingsettingsservice settings service settingsservice topology event listeners reference cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic topology event listener topologyeventlistener listeners topology event listener topologyeventlistener property providers reference cardinality reference cardinality referencecardinality optional multiple policy reference policy referencepolicy dynamic reference interface referenceinterface property provider propertyprovider updated updated property provider updatedpropertyprovider list provider info providerinfo provider infos providerinfos array list arraylist provider info providerinfo special lock object sync data structure access object lock object current topology view topology view topologyview topology view topologyview map string string cached properties cachedproperties hash map hashmap string string activate service create description activate activate logger debug no cluster discovery service noclusterdiscoveryservice started instance description instancedescription my description mydescription instance description instancedescription is local islocal is leader isleader string get sling id getslingid settings service settingsservice get sling id getslingid string get property getproperty string lock cached properties cachedproperties map string string get properties getproperties lock collections unmodifiable map unmodifiablemap cached properties cachedproperties cluster view clusterview get cluster view getclusterview collection cluster view clusterview clusters topology view topologyview get cluster views getclusterviews clusters clusters size clusters iterator instance description instancedescription instances hash set hashset instance description instancedescription instances add my description mydescription topology event listener topologyeventlistener registered services registeredservices lock registered services registeredservices listeners cluster view clusterview cluster view clusterview cluster view clusterview instance description instancedescription get leader getleader my description mydescription list instance description instancedescription get instances getinstances linked list linkedlist instance description instancedescription instances string get id getid topology view topologyview topology view topologyview instance description instancedescription get local instance getlocalinstance my description mydescription is current iscurrent instance description instancedescription get instances getinstances instances instance description instancedescription find instances findinstances instance filter instancefilter picker instance description instancedescription result hash set hashset instance description instancedescription iterator instance description instancedescription get topology gettopology get instances getinstances iterator has next hasnext instance description instancedescription instance picker accept instance result add instance result cluster view clusterview get cluster views getclusterviews cluster view clusterview clusters hash set hashset cluster view clusterview clusters add cluster view clusterview clusters topology event listener topologyeventlistener registered services registeredservices handle topology event handletopologyevent topology event topologyevent type topology init topology view topologyview deactivate service deactivate deactivate logger debug no cluster discovery service noclusterdiscoveryservice stopped topology view topologyview bind property provider suppress warnings suppresswarnings unused bind property provider bindpropertyprovider property provider propertyprovider property provider propertyprovider map string object props logger debug bind property provider bindpropertyprovider binding property provider propertyprovider property provider propertyprovider topology event listener topologyeventlistener awares lock provider info providerinfo info provider info providerinfo property provider propertyprovider props provider infos providerinfos add info collections sort provider infos providerinfos update properties cache updatepropertiescache topology view topologyview awares awares listeners awares topology event listener topologyeventlistener awares handle topology event handletopologyevent topology event topologyevent type properties changed topology view topologyview topology view topologyview update property provider suppress warnings suppresswarnings unused updated property provider updatedpropertyprovider property provider propertyprovider property provider propertyprovider map string object props logger debug bind property provider bindpropertyprovider updating property provider propertyprovider property provider propertyprovider unbind property provider unbindpropertyprovider property provider propertyprovider props bind property provider bindpropertyprovider property provider propertyprovider props unbind property provider suppress warnings suppresswarnings unused unbind property provider unbindpropertyprovider property provider propertyprovider property provider propertyprovider map string object props unbind property provider unbindpropertyprovider property provider propertyprovider props unbind property provider suppress warnings suppresswarnings unused unbind property provider unbindpropertyprovider property provider propertyprovider property provider propertyprovider map string object props info rm inform logger debug unbind property provider unbindpropertyprovider releasing property provider propertyprovider property provider propertyprovider topology event listener topologyeventlistener awares lock provider info providerinfo info provider info providerinfo property provider propertyprovider props provider infos providerinfos remove info update properties cache updatepropertiescache topology view topologyview awares awares listeners info rm inform awares topology event listener topologyeventlistener awares handle topology event handletopologyevent topology event topologyevent type properties changed topology view topologyview topology view topologyview update properties cache updatepropertiescache map string string new props newprops hash map hashmap string string provider info providerinfo info provider infos providerinfos new props newprops put all putall info properties cached properties cachedproperties new props newprops logger is debug enabled isdebugenabled logger debug properties cached properties cachedproperties suppress warnings suppresswarnings unused bind topology event listener bindtopologyeventlistener topology event listener topologyeventlistener cluster aware clusteraware logger debug bind topology event listener bindtopologyeventlistener binding topology event listener topologyeventlistener cluster aware clusteraware info rm inform lock list topology event listener topologyeventlistener current list currentlist array list arraylist topology event listener topologyeventlistener arrays as list aslist listeners current list currentlist add cluster aware clusteraware listeners current list currentlist to array toarray topology event listener topologyeventlistener current list currentlist size topology view topologyview info rm inform info rm inform cluster aware clusteraware handle topology event handletopologyevent topology event topologyevent type topology init topology view topologyview suppress warnings suppresswarnings unused unbind topology event listener unbindtopologyeventlistener topology event listener topologyeventlistener cluster aware clusteraware logger debug unbind topology event listener unbindtopologyeventlistener releasing topology event listener topologyeventlistener cluster aware clusteraware lock list topology event listener topologyeventlistener current list currentlist array list arraylist topology event listener topologyeventlistener arrays as list aslist listeners current list currentlist remove cluster aware clusteraware listeners current list currentlist to array toarray topology event listener topologyeventlistener current list currentlist size discovery service discoveryservice get topology gettopology topology view topologyview get topology gettopology topology view topologyview internal caching provider infos service ranking provider info providerinfo comparable provider info providerinfo property provider propertyprovider provider ranking service id serviceid map string string properties hash map hashmap string string provider info providerinfo property provider propertyprovider provider map string object service props serviceprops provider provider object service props serviceprops constants service ranking integer ranking ranking integer service id serviceid service props serviceprops constants service object names obj namesobj service props serviceprops property provider propertyprovider property properties names obj namesobj string string val provider get property getproperty string names obj namesobj val properties string names obj namesobj val names obj namesobj string string string names obj namesobj string val provider get property getproperty val properties val java lang comparable compare to compareto java lang object compare to compareto provider info providerinfo sort rank ascending order ranking ranking rank ranking ranking higher rank ranks equal sort service desc ending descending order service id serviceid service id serviceid override equals object obj obj provider info providerinfo provider info providerinfo obj service id serviceid service id serviceid override hash code hashcode provider hash code hashcode
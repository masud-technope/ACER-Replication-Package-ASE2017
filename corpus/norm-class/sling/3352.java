licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling event dea impl org junit assert equals assertequals org junit assert null assertnull java util array list arraylist java util collections java util dictionary java util hashtable java util list org apache sling api sling constants slingconstants org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling event dea dea constants deaconstants org apache sling settings sling settings service slingsettingsservice org apache sling testing resource resolver resourceresolver mock resource resolver factory mockresourceresolverfactory org apache sling testing resource resolver resourceresolver mock resource resolver factory options mockresourceresolverfactoryoptions org junit org junit org mockito mockito org osgi framework bundle context bundlecontext org osgi service event event org osgi service event event admin eventadmin distributing event handler test distributingeventhandlertest string topic prefix write distributed event receiver distributedeventreceiver receiver distributed event sender distributedeventsender sender string app string app list event events collections synchronized list synchronizedlist array list arraylist event suppress warnings suppresswarnings unchecked setup exception bundle context bundlecontext mockito mock bundle context bundlecontext mockito register service registerservice mockito string mockito mockito dictionary then return thenreturn sling settings service slingsettingsservice other settings othersettings mockito mock sling settings service slingsettingsservice mockito other settings othersettings get sling id getslingid then return thenreturn app event admin eventadmin event admin eventadmin override send event sendevent event event post event postevent event override post event postevent event event string topic event get topic gettopic topic equals sling constants slingconstants topic resource sender handle event handleevent event topic starts with startswith topic prefix events add event mock resource resolver factory options mockresourceresolverfactoryoptions opts mock resource resolver factory options mockresourceresolverfactoryoptions opts set event admin seteventadmin resource resolver factory resourceresolverfactory factory mock resource resolver factory mockresourceresolverfactory opts sender distributed event sender distributedeventsender distributed event admin impl distributedeventadminimpl repository path distributed event admin impl distributedeventadminimpl repository path app factory receiver distributed event receiver distributedeventreceiver distributed event admin impl distributedeventadminimpl repository path distributed event admin impl distributedeventadminimpl repository path app factory other settings othersettings cleanup sender sender sender receiver receiver receiver org junit test timeout test send event testsendevent exception events clear string string topic topic prefix event test dictionary string object props hashtable string object props property event event topic props receiver handle event handleevent events size thread sleep event received event receivedevent events assert equals assertequals topic received event receivedevent get topic gettopic assert equals assertequals app received event receivedevent get property getproperty dea constants deaconstants property application assert equals assertequals received event receivedevent get property getproperty property assert null assertnull received event receivedevent get property getproperty resource resolver resourceresolver property resource type events clear org junit test timeout test send event plus app id testsendeventplusappid exception events clear string string topic topic prefix event test dictionary string object props hashtable string object props property check application handled correctly props dea constants deaconstants property application foo event event topic props receiver handle event handleevent events size thread sleep event received event receivedevent events assert equals assertequals topic received event receivedevent get topic gettopic assert equals assertequals app received event receivedevent get property getproperty dea constants deaconstants property application assert equals assertequals received event receivedevent get property getproperty property assert null assertnull received event receivedevent get property getproperty resource resolver resourceresolver property resource type events clear org junit test timeout test send event with resource type testsendeventwithresourcetype exception events clear string topic topic prefix event test string resource type resourcetype dictionary string object props hashtable string object props resource resolver resourceresolver property resource type event event topic props receiver handle event handleevent events size thread sleep event received event receivedevent events assert equals assertequals topic received event receivedevent get topic gettopic assert equals assertequals app received event receivedevent get property getproperty dea constants deaconstants property application assert equals assertequals received event receivedevent get property getproperty resource resolver resourceresolver property resource type assert null assertnull received event receivedevent get property getproperty event dea resource resolver resourceresolver property resource type events clear
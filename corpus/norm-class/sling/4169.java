licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base commons java util collection java util collections java util hash set hashset java util iterator java util list java util org apache sling discovery cluster view clusterview org apache sling discovery instance description instancedescription org apache sling discovery instance filter instancefilter org apache sling discovery topology event topologyevent type org apache sling discovery commons providers base topology view basetopologyview org apache sling discovery commons providers spi local cluster view localclusterview org slf logger org slf logger factory loggerfactory implementation topology view default topology view defaulttopologyview base topology view basetopologyview logger logger logger factory loggerfactory get logger getlogger get class getclass instances topology instance description instancedescription instances hash set hashset instance description instancedescription string local cluster sync token id localclustersynctokenid create empty topology default topology view defaulttopologyview initialized create topology filled list instances default topology view defaulttopologyview collection instance description instancedescription instances instances instances add all addall instances compare topology determine compare param topology compare type describing compare type type compare topology comparetopology default topology view defaulttopologyview illegal argument exception illegalargumentexception local cluster sync token id localclustersynctokenid local cluster sync token id localclustersynctokenid local cluster sync token id localclustersynctokenid local cluster sync token id localclustersynctokenid local cluster sync token id localclustersynctokenid local cluster sync token id localclustersynctokenid equals local cluster sync token id localclustersynctokenid logger debug compare topology comparetopology local cluster sync token id localclustersynctokenid type topology changed instances size instances size logger debug compare topology comparetopology number instances type topology changed properties changed propertieschanged instance description instancedescription instance instances iterator instance description instancedescription instances iterator instance description instancedescription matching instance matchinginstance has next hasnext instance description instancedescription other instance otherinstance instance get sling id getslingid equals other instance otherinstance get sling id getslingid matching instance matchinginstance other instance otherinstance matching instance matchinginstance logger is debug enabled isdebugenabled logger debug compare topology comparetopology matching instance instance type topology changed instance get cluster view getclusterview get id getid equals matching instance matchinginstance get cluster view getclusterview get id getid logger debug compare topology comparetopology cluster view match type topology changed instance is leader isleader matching instance matchinginstance is leader isleader logger debug compare topology comparetopology lead ers leaders differ type topology changed instance get properties getproperties equals matching instance matchinginstance get properties getproperties properties changed propertieschanged properties changed propertieschanged type properties changed override equals object obj obj obj default topology view defaulttopologyview default topology view defaulttopologyview default topology view defaulttopologyview obj is current iscurrent is current iscurrent type diff compare topology comparetopology diff override hash code hashcode code iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription instance code instance hash code hashcode code org apache sling discovery topology view topologyview get local instance getlocalinstance instance description instancedescription get local instance getlocalinstance iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription instance instance is local islocal instance org apache sling discovery topology view topologyview get instances getinstances instance description instancedescription get instances getinstances collections unmodifiable set unmodifiableset instances adds instances cluster view clusterview topology set local cluster view setlocalclusterview local cluster view localclusterview local cluster view localclusterview local cluster view localclusterview illegal argument exception illegalargumentexception local cluster view localclusterview list instance description instancedescription instances local cluster view localclusterview get instances getinstances add instances addinstances instances local cluster sync token id localclustersynctokenid local cluster view localclusterview get local cluster sync token id getlocalclustersynctokenid adds instances topology add instances addinstances collection instance description instancedescription instances instances outer loop outerloop iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription instance description instancedescription iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription existing instance existinginstance existing instance existinginstance get sling id getslingid equals instance description instancedescription get sling id getslingid sling normal duplicate instances filtered correctly hidden duplicate instances instance description instancedescription cluster caught simple reason inconsistent discovery impl stale announcements sling man ualy manualy copying data cluster cleaned sling avoiding duplicate instances sling logger info add instance addinstance add instance instance description instancedescription outer loop outerloop instances add instance description instancedescription org apache sling discovery topology view topologyview find instances findinstances org apache sling discovery instance filter instancefilter instance description instancedescription find instances findinstances instance filter instancefilter picker picker illegal argument exception illegalargumentexception picker instance description instancedescription result hash set hashset instance description instancedescription iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription instance picker accept instance result add instance result org apache sling discovery topology view topologyview get cluster views getclusterviews cluster view clusterview get cluster views getclusterviews cluster view clusterview result hash set hashset cluster view clusterview iterator instance description instancedescription instances iterator has next hasnext instance description instancedescription instance cluster view clusterview cluster instance get cluster view getclusterview cluster result add cluster hash set hashset cluster view clusterview result override string to string tostring default topology view defaulttopologyview current is current iscurrent num instances size instances instances override string get local cluster sync token id getlocalclustersynctokenid local cluster sync token id localclustersynctokenid illegal state exception illegalstateexception sync token synctoken local cluster sync token id localclustersynctokenid
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution serialization impl vlt javax jcr session javax jcr workspace javax jcr observation observation manager observationmanager java byte array input stream bytearrayinputstream java file java input stream inputstream org apache jackrabbit vault api import mode importmode org apache jackrabbit vault config meta inf metainf org apache jackrabbit vault access control handling accesscontrolhandling org apache jackrabbit vault packaging export options exportoptions org apache jackrabbit vault packaging package manager packagemanager org apache jackrabbit vault packaging packaging org apache jackrabbit vault packaging vault package vaultpackage org apache sling api resource resource resolver resourceresolver org apache sling distribution distribution request distributionrequest org apache sling distribution distribution request type distributionrequesttype org apache sling distribution simple distribution request simpledistributionrequest org apache sling distribution serialization distribution package distributionpackage org apache sling distribution serialization distribution package info distributionpackageinfo org junit test org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue org mockito matchers org mockito mockito mock org mockito mockito test case testcase link file vault distribution package builder filevaultdistributionpackagebuilder file vault distribution package builder test filevaultdistributionpackagebuildertest test test create package for add testcreatepackageforadd exception packaging packaging mock packaging package manager packagemanager package manager packagemanager mock package manager packagemanager vault package vaultpackage vault package vaultpackage mock vault package vaultpackage file file mock file file get absolute path getabsolutepath then return thenreturn path file vault package vaultpackage get file getfile then return thenreturn file meta inf metainf inf mock meta inf metainf vault package vaultpackage get meta inf getmetainf then return thenreturn inf package manager packagemanager assemble session export options exportoptions file then return thenreturn vault package vaultpackage packaging get package manager getpackagemanager then return thenreturn package manager packagemanager resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver session session mock session workspace workspace mock workspace observation manager observationmanager observation manager observationmanager mock observation manager observationmanager workspace get observation manager getobservationmanager then return thenreturn observation manager observationmanager session get workspace getworkspace then return thenreturn workspace resource resolver resourceresolver adapt to adaptto session then return thenreturn session file vault distribution package builder filevaultdistributionpackagebuilder file vaultdistribution package builder filevaultdistributionpackagebuilder file vault distribution package builder filevaultdistributionpackagebuilder file vlt filevlt packaging distribution request distributionrequest request simple distribution request simpledistributionrequest distribution request type distributionrequesttype add distribution package distributionpackage distribution package distributionpackage file vaultdistribution package builder filevaultdistributionpackagebuilder create package for add createpackageforadd resource resolver resourceresolver request assert not null assertnotnull distribution package distributionpackage test test read dummy package internal testreaddummypackageinternal exception packaging packaging mock packaging package manager packagemanager package manager packagemanager mock package manager packagemanager packaging get package manager getpackagemanager then return thenreturn package manager packagemanager file vault distribution package builder filevaultdistributionpackagebuilder file vaultdistribution package builder filevaultdistributionpackagebuilder file vault distribution package builder filevaultdistributionpackagebuilder file vlt filevlt packaging resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver input stream inputstream stream byte array input stream bytearrayinputstream binary get bytes getbytes utf throws exception throwsexception distribution package distributionpackage distribution package distributionpackage file vaultdistribution package builder filevaultdistributionpackagebuilder read package internal readpackageinternal resource resolver resourceresolver stream exception throws exception throwsexception assert true asserttrue throws exception throwsexception test test get package internal with non existing id testgetpackageinternalwithnonexistingid exception packaging packaging mock packaging package manager packagemanager package manager packagemanager mock package manager packagemanager packaging get package manager getpackagemanager then return thenreturn package manager packagemanager file vault distribution package builder filevaultdistributionpackagebuilder file vaultdistribution package builder filevaultdistributionpackagebuilder file vault distribution package builder filevaultdistributionpackagebuilder file vlt filevlt packaging resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver string distribution package distributionpackage package internal packageinternal file vaultdistribution package builder filevaultdistributionpackagebuilder get package internal getpackageinternal resource resolver resourceresolver assert null assertnull package internal packageinternal test test install package internal testinstallpackageinternal exception file temp file tempfile file create temp file createtempfile test install package internal testinstallpackageinternal txt packaging packaging mock packaging package manager packagemanager package manager packagemanager mock package manager packagemanager vault package vaultpackage vault package vaultpackage mock vault package vaultpackage package manager packagemanager open temp file tempfile then return thenreturn vault package vaultpackage packaging get package manager getpackagemanager then return thenreturn package manager packagemanager file vault distribution package builder filevaultdistributionpackagebuilder file vaultdistribution package builder filevaultdistributionpackagebuilder file vault distribution package builder filevaultdistributionpackagebuilder file vlt filevlt packaging resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver session session mock session workspace workspace mock workspace observation manager observationmanager observation manager observationmanager mock observation manager observationmanager workspace get observation manager getobservationmanager then return thenreturn observation manager observationmanager session get workspace getworkspace then return thenreturn workspace resource resolver resourceresolver adapt to adaptto session then return thenreturn session distribution package distributionpackage distribution package distributionpackage mock distribution package distributionpackage distribution package distributionpackage get id getid then return thenreturn temp file tempfile get absolute path getabsolutepath distribution package distributionpackage get type gettype then return thenreturn file vlt filevlt distribution package info distributionpackageinfo info distribution package info distributionpackageinfo file vlt filevlt info distribution package info distributionpackageinfo property request type distribution request type distributionrequesttype add info distribution package info distributionpackageinfo property request paths string distribution package distributionpackage get info getinfo then return thenreturn info success file vaultdistribution package builder filevaultdistributionpackagebuilder install package installpackage resource resolver resourceresolver distribution package distributionpackage assert true asserttrue success test test install with custom import mode and handling testinstallwithcustomimportmodeandaclhandling exception file temp file tempfile file create temp file createtempfile test install package internal testinstallpackageinternal txt packaging packaging mock packaging package manager packagemanager package manager packagemanager mock package manager packagemanager vault package vaultpackage vault package vaultpackage mock vault package vaultpackage package manager packagemanager open temp file tempfile then return thenreturn vault package vaultpackage packaging get package manager getpackagemanager then return thenreturn package manager packagemanager file vault distribution package builder filevaultdistributionpackagebuilder file vaultdistribution package builder filevaultdistributionpackagebuilder file vault distribution package builder filevaultdistributionpackagebuilder file vlt filevlt packaging import mode importmode merge access control handling accesscontrolhandling merge resource resolver resourceresolver resource resolver resourceresolver mock resource resolver resourceresolver session session mock session workspace workspace mock workspace observation manager observationmanager observation manager observationmanager mock observation manager observationmanager workspace get observation manager getobservationmanager then return thenreturn observation manager observationmanager session get workspace getworkspace then return thenreturn workspace resource resolver resourceresolver adapt to adaptto session then return thenreturn session distribution package distributionpackage distribution package distributionpackage mock distribution package distributionpackage distribution package distributionpackage get id getid then return thenreturn temp file tempfile get absolute path getabsolutepath distribution package distributionpackage get type gettype then return thenreturn file vlt filevlt distribution package info distributionpackageinfo info distribution package info distributionpackageinfo file vlt filevlt info distribution package info distributionpackageinfo property request type distribution request type distributionrequesttype add info distribution package info distributionpackageinfo property request paths string distribution package distributionpackage get info getinfo then return thenreturn info success file vaultdistribution package builder filevaultdistributionpackagebuilder install package installpackage resource resolver resourceresolver distribution package distributionpackage assert true asserttrue success
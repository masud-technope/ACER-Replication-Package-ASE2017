licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling form impl org easymock easy mock easymock cmp eq cmpeq org easymock easy mock easymock create mock createmock org easymock easy mock easymock expect org easymock easy mock easymock expect last call expectlastcall org easymock easy mock easymock replay org easymock easy mock easymock verify org junit assert equals assertequals java file java lang reflect method javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache sling api authenticator org apache sling core spi authentication info authenticationinfo org apache sling core spi default authentication feedback handler defaultauthenticationfeedbackhandler org hamcrest description org hamcrest text string starts with stringstartswith org jmock expectations org jmock mockery org jmock api action org jmock api invocation org junit test org junit runner run with runwith org osgi framework bundle context bundlecontext org powermock api easymock power mock powermock org powermock api support member modification membermodification member matcher membermatcher org powermock core class loader classloader annotations prepare for test preparefortest org powermock modules junit power mock runner powermockrunner run with runwith power mock runner powermockrunner prepare for test preparefortest form authentication handler formauthenticationhandler form authentication handler test formauthenticationhandlertest test test get token file gettokenfile file root file bundle get absolute file getabsolutefile sling home action slinghomeaction sling home slinghome sling home action slinghomeaction sling home slinghome set sling home setslinghome file sling get absolute path getabsolutepath mockery context mockery bundle context bundlecontext bundle context bundlecontext context mock bundle context bundlecontext context checking expectations mock access sling framework property allowing bundle context bundlecontext get property getproperty sling sling home slinghome mock data file support file names starting allowing bundle context bundlecontext get data file getdatafile string starts with stringstartswith return value returnvalue mock data file support allowing bundle context bundlecontext get data file getdatafile string rva root form authentication handler formauthenticationhandler handler form authentication handler formauthenticationhandler test files relative bundle context file rel file relfile handler get token file gettokenfile bundle context bundlecontext assert equals assertequals root rel file relfile string rel name relname rel path file rel file relfile handler get token file gettokenfile rel name relname bundle context bundlecontext assert equals assertequals file root rel name relname rel file relfile test file relative sling data file support string rel name relname rel sling file rel file relfile handler get token file gettokenfile rel name relname bundle context bundlecontext assert equals assertequals file sling home slinghome get sling home getslinghome rel name relname rel file relfile test file relative current working directory string rel name relname test sling home slinghome set sling home setslinghome file rel file relfile handler get token file gettokenfile rel name relname bundle context bundlecontext assert equals assertequals file rel name relname get absolute file getabsolutefile rel file relfile test absolute file file abs file absfile file test get absolute file getabsolutefile file abs file absfile handler get token file gettokenfile abs file absfile get path getpath bundle context bundlecontext assert equals assertequals abs file absfile abs file absfile test test get user id getuserid form authentication handler formauthenticationhandler handler form authentication handler formauthenticationhandler assert equals assertequals handler get user id getuserid assert equals assertequals handler get user id getuserid assert equals assertequals handler get user id getuserid field assert equals assertequals handler get user id getuserid field field assert equals assertequals field handler get user id getuserid field field field assert equals assertequals field field handler get user id getuserid field field field field test sling parameter based redirect ion redirection handle relative paths exception power mock powermock expect private expectprivate exception url encoder urlencoder encode unsupported encoding exception unsupportedencodingexception test test redirect ion after login testredirectionafterlogin exception create mocks http servlet request httpservletrequest request create mock createmock http servlet request httpservletrequest http servlet response httpservletresponse response create mock createmock http servlet response httpservletresponse authentication info authenticationinfo authentication info authenticationinfo create mock createmock authentication info authenticationinfo power mock powermock mock method string method name methodname refresh auth data refreshauthdata form authentication handler formauthenticationhandler authentication handler authenticationhandler power mock powermock create partial mock createpartialmock form authentication handler formauthenticationhandler method name methodname method methods member matcher membermatcher methods form authentication handler formauthenticationhandler method name methodname power mock powermock expect private expectprivate authentication handler authenticationhandler methods request response authentication info authenticationinfo mock method unit testing authentication succeeded flow power mock powermock mock static mockstatic default authentication feedback handler defaultauthenticationfeedbackhandler expect default authentication feedback handler defaultauthenticationfeedbackhandler handle redirect handleredirect request response and return andreturn mocks authenticator login resource attribute string url http blah expect request get attribute getattribute authenticator login resource and return andreturn url mocks http servlet request httpservletrequest http servlet response httpservletresponse object expect request get method getmethod and return andreturn post expect request getrequesturi and return andreturn http blah blah security check string context path contextpath blah expect request get context path getcontextpath and return andreturn context path contextpath any times anytimes expect response is committed iscommitted and return andreturn mocking method type response reset buffer resetbuffer expect last call expectlastcall request redirected context root passing parameter response send redirect sendredirect cmp eq cmpeq context path contextpath rep lay replay mocks replay request replay response replay authentication info authenticationinfo replay authentication handler authenticationhandler test method authentication handler authenticationhandler authentication succeeded authenticationsucceeded request response authentication info authenticationinfo verify mocks verify request response authentication info authenticationinfo authentication handler authenticationhandler code rva code action returns file relative root file requested parameter invocation expecting parameter string rva action file root rva file root root root object invoke invocation invocation throwable string data string invocation get parameter getparameter data starts with startswith data data substring file root data describe to describeto description description description append text appendtext returns file root arg code sling home action slinghomeaction code action returns current code sling home slinghome code field invocations sling home action slinghomeaction action string sling home slinghome set sling home setslinghome string sling home slinghome sling home slinghome sling home slinghome string get sling home getslinghome sling home slinghome object invoke invocation invocation throwable sling home slinghome describe to describeto description description description append text appendtext returns sling home slinghome
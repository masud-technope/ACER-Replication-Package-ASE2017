licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling mailarchiveserver util java print stream printstream org apache felix scr annotations component org apache felix scr annotations reference org apache sling api resource login exception loginexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling api resource value map valuemap component subject letters entropy subjectlettersentropy sample length alphabet length threshold max the or theor entropy math log alphabet length reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory resource resolver resourceresolver resolver subject letters entropy subjectlettersentropy instance subject letters entropy subjectlettersentropy instance instance count sample length alphabet length entropy sample length messages calculate entropy and print calculateentropyandprint print stream printstream resource resolver factory resourceresolverfactory system println resource resolver factory resourceresolverfactory resolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver domain project list thread message string root content mailarchiveserver archive resource main resolver get resource getresource root iterate main sum sample length sum length alphabet length sum count sum length alphabet length count num count sum entropy num math log num system println string format char at charat entropy sum sum length entropy max the or theor entropy threshold sum messages threshold system println string format entropy sum println messages messages login exception loginexception print stack trace printstacktrace count letters countletters resource messages value map valuemap properties adapt to adaptto value map valuemap string sub j subj properties subject string math min sub j subj length sample length character character to lower case tolowercase sub j subj char at charat to string tostring matches count iterate resource lvl resource child get children getchildren lvl count letters countletters child iterate child lvl
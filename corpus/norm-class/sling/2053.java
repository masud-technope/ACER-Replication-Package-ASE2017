licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling servlets post java util array list arraylist java util enumeration java util iterator java util linked hash set linkedhashset java util list java util no such element exception nosuchelementexception java util javax jcr item javax jcr item not found exception itemnotfoundexception javax jcr node javax jcr node iterator nodeiterator javax jcr repository exception repositoryexception javax jcr session org apache sling api sling http servlet request slinghttpservletrequest org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling api wrappers sling request paths slingrequestpaths org slf logger org slf logger factory loggerfactory code abstract post operation abstractpostoperation code base implementation link post operation postoperation service providing actual implementations tooling common functionality preparing change logs saving ref res hing refreshing jcr session abstract post operation abstractpostoperation post operation postoperation log logger log logger factory loggerfactory get logger getlogger get class getclass prepares final izes finalizes actual operation preparation enc ompasses encompasses absolute path item operate calling link get item path getitempath sling http servlet request slinghttpservletrequest method setting location parent location response operation link do run dorun sling http servlet request slinghttpservletrequest post response postresponse list method session saved unsaved modifications error rs errorrs unsaved session rolled param request request operate param response code post response postresponse code record execution progress sling http servlet request slinghttpservletrequest request post response postresponse response sling post processor slingpostprocessor processors session session request get resource resolver getresourceresolver adapt to adaptto session versioning configuration versioningconfiguration version able configuration versionableconfiguration get versioning configuration getversioningconfiguration request calculate paths string path get item path getitempath request path remove and validate workspace removeandvalidateworkspace path session response set path setpath path location response set location setlocation ext ernalize path externalizepath request path parent location path resource util resourceutil get parent getparent path path response set parent location setparentlocation ext ernalize path externalizepath request path list modification array list arraylist modification do run dorun request response invoke processors processors sling post processor slingpostprocessor processor processors processor process request string nodes to check in nodestocheckin linked hash set linkedhashset string html response modification change change get type gettype modify response on modified onmodified change get source getsource delete response on deleted ondeleted change get source getsource move response on moved onmoved change get source getsource change get destination getdestination copy response on copied oncopied change get source getsource change get destination getdestination create response on created oncreated change get source getsource version able configuration versionableconfiguration is check in on new version able node ischeckinonnewversionablenode nodes to check in nodestocheckin add change get source getsource order response on change onchange ordered change get source getsource change get destination getdestination check out checkout response on change onchange check out checkout change get source getsource nodes to check in nodestocheckin add change get source getsource check in checkin response on change onchange check in checkin change get source getsource nodes to check in nodestocheckin remove change get source getsource is session save required issessionsaverequired session request request get resource resolver getresourceresolver commit is skip check in isskipcheckin request check ins checkins string check in path checkinpath nodes to check in nodestocheckin check in checkin request get resource resolver getresourceresolver check in path checkinpath response on change onchange check in checkin check in path checkinpath exception log error exception response processing response set error seterror is session save required issessionsaverequired session request request get resource resolver getresourceresolver revert repository exception repositoryexception log warn repository exception repositoryexception block get message getmessage performs desired operation filling progress code code list preparing code response code code response code prepared path location parent location properties expected implementation param request code sling http servlet request slinghttpservletrequest code providing input terms request parameters operation param response link post response postresponse fill response param container add link modification instances representing operations repository exception repositoryexception thrown error occurrs accessing repository do run dorun sling http servlet request slinghttpservletrequest request post response postresponse response list modification repository exception repositoryexception versioning configuration versioning configuration versioningconfiguration get versioning configuration getversioningconfiguration sling http servlet request slinghttpservletrequest request versioning configuration versioningconfiguration version able configuration versionableconfiguration versioning configuration versioningconfiguration request get attribute getattribute versioning configuration versioningconfiguration get name getname version able configuration versionableconfiguration version able configuration versionableconfiguration versioning configuration versioningconfiguration check check in checkin skipped is skip check in isskipcheckin sling http servlet request slinghttpservletrequest request get versioning configuration getversioningconfiguration request is auto check in isautocheckin check written is skip session handling isskipsessionhandling sling http servlet request slinghttpservletrequest request parse boolean parseboolean string request get attribute getattribute sling post constants slingpostconstants attr skip session handling check commit resource resolver called is session save required issessionsaverequired session session sling http servlet request slinghttpservletrequest request repository exception repositoryexception is skip session handling isskipsessionhandling request request get resource resolver getresourceresolver has changes haschanges remove workspace start path validate session workspace matches path workspace string remove and validate workspace removeandvalidateworkspace string path session session repository exception repositoryexception ws sep pos wsseppos path index of indexof ws sep pos wsseppos string workspace name workspacename path substring ws sep pos wsseppos workspace name workspacename equals session get workspace getworkspace get name getname repository exception repositoryexception incorrect workspace expecting workspace name workspacename received session get workspace getworkspace get name getname path substring ws sep pos wsseppos path returns path resource request item path method overwritten extension operation requirements path processing string get item path getitempath sling http servlet request slinghttpservletrequest request request get resource getresource get path getpath returns iterator code resource code instances add res sed addressed link sling post constants slingpostconstants apply request parameter request parameter code code returned parameter valid resources empty iterator returned resources add res sed addressed link sling post constants slingpostconstants apply parameter param request code sling http servlet request slinghttpservletrequest code object link sling post constants slingpostconstants apply parameter iterator resources listed parameter code code parameter request iterator resource get apply to resources getapplytoresources sling http servlet request slinghttpservletrequest request string apply to applyto request get parameter values getparametervalues sling post constants slingpostconstants apply apply to applyto apply to iterator applytoiterator request apply to applyto returns external form path prepending context path app ending appending display extension param path path ext ernalize externalize url string ext ernalize path externalizepath sling http servlet request slinghttpservletrequest request string path string builder stringbuilder ret string builder stringbuilder ret append sling request paths slingrequestpaths get context path getcontextpath request ret append request get resource resolver getresourceresolver map path append optional extension string ext request get parameter getparameter sling post constants slingpostconstants display extension ext ext length ext char at charat ret append ret append ext ret to string tostring resolves path resp ect respect current root path param rel path relpath path resolve path starts resolved path string resolve path resolvepath string abs path abspath string rel path relpath rel path relpath starts with startswith rel path relpath abs path abspath rel path relpath returns request parameters starts link sling post constants slingpostconstants item prefix relative current code code parameters starting prefixes link sling post constants slingpostconstants item prefix relative current code code link sling post constants slingpostconstants item prefix relative parent code code link sling post constants slingpostconstants item prefix absolute code code considered providing content stored parameters starting command prefix code code considered parameters stored require item path prefix requireitempathprefix sling http servlet request slinghttpservletrequest request require prefix requireprefix enumeration names request get parameter names getparameternames names has more elements hasmoreelements require prefix requireprefix string string names next element nextelement require prefix requireprefix starts with startswith sling post constants slingpostconstants item prefix relative current require prefix requireprefix returns code code code code starts prefixes link sling post constants slingpostconstants item prefix relative current code code link sling post constants slingpostconstants item prefix relative parent code code link sling post constants slingpostconstants item prefix absolute code code has item path prefix hasitempathprefix string starts with startswith sling post constants slingpostconstants item prefix absolute starts with startswith sling post constants slingpostconstants item prefix relative current starts with startswith sling post constants slingpostconstants item prefix relative parent orders node command syntax supported xmp child nodes child node child node nodes specific position int eger integer xmp param item node order repository exception repositoryexception error occurs order node ordernode sling http servlet request slinghttpservletrequest request item item list modification repository exception repositoryexception string command request get parameter getparameter sling post constants slingpostconstants order command command length item is node isnode node parent item get parent getparent string command equals sling post constants slingpostconstants order parent get nodes getnodes next node nextnode get name getname command equals sling post constants slingpostconstants order command starts with startswith sling post constants slingpostconstants order command substring sling post constants slingpostconstants order length command starts with startswith sling post constants slingpostconstants order string command substring sling post constants slingpostconstants order length node iterator nodeiterator iter parent get nodes getnodes iter has next hasnext node iter next node nextnode get name getname equals iter has next hasnext iter next node nextnode get name getname check int eger integer abc de abcde move bcade move bacde new pos newpos integer parse int parseint command node iterator nodeiterator iter parent get nodes getnodes iter has next hasnext new pos newpos node iter next node nextnode get name getname equals item get name getname node new pos newpos new pos newpos get name getname new pos newpos number format exception numberformatexception illegal argument exception illegalargumentexception node ordering command invalid command equals parent order before orderbefore item get name getname add modification on order onorder item get path getpath log is debug enabled isdebugenabled log debug node moved item get path getpath command illegal argument exception illegalargumentexception node ordering command invalid command node find version able ancestor findversionableancestor node node repository exception repositoryexception is version able isversionable node node node node get parent getparent find version able ancestor findversionableancestor node item not found exception itemnotfoundexception is version able isversionable node node repository exception repositoryexception node is node type isnodetype mix version able versionable check out if necessary checkoutifnecessary node node list modification versioning configuration versioningconfiguration versioning configuration versioningconfiguration repository exception repositoryexception versioning configuration versioningconfiguration is auto check out isautocheckout node version able node versionablenode find version able ancestor findversionableancestor node version able node versionablenode version able node versionablenode is checked out ischeckedout version able node versionablenode check out checkout add modification on check out oncheckout version able node versionablenode get path getpath check in checkin resource resolver resourceresolver resolver string path repository exception repositoryexception resource rsrc resolver get resource getresource path node node rsrc rsrc adapt to adaptto node node node is checked out ischeckedout is version able isversionable node node check in checkin apply to iterator applytoiterator iterator resource resource resolver resourceresolver resolver resource base resource baseresource string paths path index pathindex resource next resource nextresource iterator resource resource iterator resourceiterator apply to iterator applytoiterator sling http servlet request slinghttpservletrequest request string paths resolver request get resource resolver getresourceresolver base resource baseresource request get resource getresource paths paths path index pathindex next resource nextresource see k seek has next hasnext next resource nextresource resource has next hasnext no such element exception nosuchelementexception resource result next resource nextresource next resource nextresource see k seek result remove unsupported operation exception unsupportedoperationexception resource see k seek resource iterator resourceiterator resource iterator resourceiterator has next hasnext resource iterator resource res resource iterator resourceiterator res resource iterator resourceiterator path index pathindex paths length string path paths path index pathindex path index pathindex sling support wildcard segment apply to applyto path path ends with endswith path length resource iterator resourceiterator base resource baseresource list children listchildren path ends with endswith path path substring path length path length resource iterator resourceiterator base resource baseresource list children listchildren resource res resolver get resource getresource base resource baseresource path res resource iterator resourceiterator res list children listchildren resource iterator resourceiterator resource iterator resource iterator resourceiterator has next hasnext resource res resource iterator resourceiterator res resource iterator resourceiterator resource res resolver get resource getresource base resource baseresource path res res elements array
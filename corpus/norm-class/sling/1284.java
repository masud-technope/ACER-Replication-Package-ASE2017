licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling nosql resource impl org junit assert equals assertequals org junit assert false assertfalse org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue java util iterator org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling testing mock sling resource resolver type resourceresolvertype org apache sling testing mock sling junit sling context slingcontext org junit org junit org junit rule org junit test google common collect immutable map immutablemap test basic resource resolver resourceresolver value map valuemap data types abstract no sql resource provider transactional test abstractnosqlresourceprovidertransactionaltest rule sling context slingcontext context sling context slingcontext resource resolver type resourceresolvertype jcr mock register resource provider factory registerresourceproviderfactory resource test root testroot set up setup exception register resource provider factory registerresourceproviderfactory tear down teardown context resource resolver resourceresolver revert context resource resolver resourceresolver delete test root testroot context resource resolver resourceresolver commit persistence exception persistenceexception test test root node testrootnode assert true asserttrue test root testroot no sql resource nosqlresource test test add delete nodes partial commit testadddeletenodespartialcommit persistence exception persistenceexception context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver commit assert false assertfalse context resource resolver resourceresolver has changes haschanges context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object assert true asserttrue context resource resolver resourceresolver has changes haschanges assert not null assertnotnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node context resource resolver resourceresolver delete test root testroot get child getchild node context resource resolver resourceresolver delete test root testroot get child getchild node assert null assertnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node iterator resource children test root testroot list children listchildren assert equals assertequals node children get name getname assert equals assertequals node children get name getname assert false assertfalse children has next hasnext assert true asserttrue context resource resolver resourceresolver has changes haschanges context resource resolver resourceresolver revert assert false assertfalse context resource resolver resourceresolver has changes haschanges assert not null assertnotnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node children test root testroot list children listchildren assert equals assertequals node children get name getname assert equals assertequals node children get name getname assert false assertfalse children has next hasnext test test recursive delete without commit testrecursivedeletewithoutcommit persistence exception persistenceexception resource node context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object resource node context resource resolver resourceresolver create node node immutable map immutablemap string object context resource resolver resourceresolver create node node immutable map immutablemap string object assert not null assertnotnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node node assert not null assertnotnull test root testroot get child getchild node node node context resource resolver resourceresolver delete node assert null assertnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node node assert null assertnull test root testroot get child getchild node node node test test recursive delete with commit testrecursivedeletewithcommit persistence exception persistenceexception resource node context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object resource node context resource resolver resourceresolver create node node immutable map immutablemap string object context resource resolver resourceresolver create node node immutable map immutablemap string object assert true asserttrue context resource resolver resourceresolver has changes haschanges context resource resolver resourceresolver commit assert false assertfalse context resource resolver resourceresolver has changes haschanges assert not null assertnotnull test root testroot get child getchild node assert not null assertnotnull test root testroot get child getchild node node assert not null assertnotnull test root testroot get child getchild node node node context resource resolver resourceresolver delete node assert null assertnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node node assert null assertnull test root testroot get child getchild node node node assert true asserttrue context resource resolver resourceresolver has changes haschanges context resource resolver resourceresolver commit assert false assertfalse context resource resolver resourceresolver has changes haschanges assert null assertnull test root testroot get child getchild node assert null assertnull test root testroot get child getchild node node assert null assertnull test root testroot get child getchild node node node test expected persistence exception persistenceexception test create already exist without commit testcreatealreadyexistwithoutcommit persistence exception persistenceexception context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object test expected persistence exception persistenceexception test create already exist with commit testcreatealreadyexistwithcommit persistence exception persistenceexception context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver commit context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object test test create already exist deleted without commit testcreatealreadyexistdeletedwithoutcommit persistence exception persistenceexception context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver delete test root testroot get child getchild node context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object test test create already exist deleted with commit testcreatealreadyexistdeletedwithcommit persistence exception persistenceexception context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object context resource resolver resourceresolver commit context resource resolver resourceresolver delete test root testroot get child getchild node context resource resolver resourceresolver commit context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object test test update without commit testupdatewithoutcommit persistence exception persistenceexception resource node context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object prop assert equals assertequals node get value map getvaluemap prop string modifiable value map modifiablevaluemap props node adapt to adaptto modifiable value map modifiablevaluemap props prop node test root testroot get child getchild node assert equals assertequals node get value map getvaluemap prop string test test update with commit testupdatewithcommit persistence exception persistenceexception resource node context resource resolver resourceresolver create test root testroot node immutable map immutablemap string object prop assert equals assertequals node get value map getvaluemap prop string context resource resolver resourceresolver commit modifiable value map modifiablevaluemap props node adapt to adaptto modifiable value map modifiablevaluemap props prop context resource resolver resourceresolver commit node test root testroot get child getchild node assert equals assertequals node get value map getvaluemap prop string
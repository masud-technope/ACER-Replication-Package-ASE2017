licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling security impl org mockito mockito java util dictionary java util hashtable javax servlet http http servlet request httpservletrequest org junit org junit org junit test org osgi framework bundle context bundlecontext org osgi framework service registration serviceregistration org osgi service component component context componentcontext ref errer filter test referrerfiltertest ref errer filter referrerfilter filter setup filter ref errer filter referrerfilter component context componentcontext ctx mock component context componentcontext bundle context bundlecontext bundle ctx bundlectx mock bundle context bundlecontext service registration serviceregistration reg mock service registration serviceregistration dictionary string object props hashtable string object hosts string rel host relhost hosts regexp string http abshost do return doreturn props ctx get properties getproperties do return doreturn bundle ctx bundlectx ctx get bundle context getbundlecontext do return doreturn reg bundle ctx bundlectx register service registerservice string dictionary do not hing donothing reg unregister filter activate ctx test test host name testhostname assert equals assertequals somehost filter get host gethost http somehost host assert equals assertequals somehost filter get host gethost http somehost host assert equals assertequals somehost filter get host gethost http somehost host assert equals assertequals somehost filter get host gethost http admin somehost host assert equals assertequals somehost filter get host gethost http admin somehost inv ald invald gagga host assert equals assertequals somehost filter get host gethost http admin somehost host assert equals assertequals somehost filter get host gethost http admin admin somehost host assert equals assertequals somehost filter get host gethost http admin admin somehost host assert equals assertequals localhost filter get host gethost http localhost host assert equals assertequals filter get host gethost http host assert equals assertequals localhost filter get host gethost http localhost host assert equals assertequals filter get host gethost http host assert equals assertequals localhost filter get host gethost http localhost etewteq host assert equals assertequals filter get host gethost http wetew qerq host assert equals assertequals filter get host gethost http admin admin somehost http servlet request httpservletrequest get request getrequest string ref errer referrer http servlet request httpservletrequest request mock http servlet request httpservletrequest request get method getmethod then return thenreturn post request getrequesturi then return thenreturn http somehost request get header getheader ref erer referer then return thenreturn ref errer referrer request test test valid request testvalidrequest assert equals assertequals filter is valid request isvalidrequest get request getrequest assert equals assertequals filter is valid request isvalidrequest get request getrequest relative assert equals assertequals filter is valid request isvalidrequest get request getrequest relative assert equals assertequals filter is valid request isvalidrequest get request getrequest relative illegal assert equals assertequals filter is valid request isvalidrequest get request getrequest http somehost assert equals assertequals filter is valid request isvalidrequest get request getrequest http localhost assert equals assertequals filter is valid request isvalidrequest get request getrequest http assert equals assertequals filter is valid request isvalidrequest get request getrequest http somehost illegal assert equals assertequals filter is valid request isvalidrequest get request getrequest http rel host relhost assert equals assertequals filter is valid request isvalidrequest get request getrequest http rel host relhost assert equals assertequals filter is valid request isvalidrequest get request getrequest http abshost assert equals assertequals filter is valid request isvalidrequest get request getrequest https abshost assert equals assertequals filter is valid request isvalidrequest get request getrequest http abshost assert equals assertequals filter is valid request isvalidrequest get request getrequest http abshost assert equals assertequals filter is valid request isvalidrequest get request getrequest http abshost assert equals assertequals filter is valid request isvalidrequest get request getrequest http abshost
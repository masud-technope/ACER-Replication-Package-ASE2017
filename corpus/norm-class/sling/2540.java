licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling mailarchive stats impl java text date format dateformat java text simple date format simpledateformat java util abstract list abstractlist java util array list arraylist java util java util hash map hashmap java util list java util map org apache felix scr annotations component org apache felix scr annotations reference org apache felix scr annotations service org apache james mime dom message org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling api resource resource util resourceutil org apache sling mailarchive stats mail stats processor mailstatsprocessor org apache sling mailarchive stats org mapper orgmapper org apache sling mailarchiveserver api message processor messageprocessor org slf logger org slf logger factory loggerfactory component service mail stats processor impl mailstatsprocessorimpl computes stats org anization organization writes time period defined formatter formatter year month yields month data mail stats processor mailstatsprocessor message processor messageprocessor logger log logger factory loggerfactory get logger getlogger get class getclass reference org mapper orgmapper org mapper orgmapper reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory todo config urable configurable format date format dateformat date format dateformat simple date format simpledateformat yyyy todo config urable configurable root path string root path content mailarchiveserver stats string resource type mailserver stats string destination resource type mailserver stats destination string data resource type mailserver stats data string period prop period string empty string array string string source prop prefix count number messages destination for matted formatted timestamp source map string data record datarecord data hash map hashmap string data record datarecord data record datarecord string destination map string integer source counts sourcecounts hash map hashmap string integer string timestamp path timestamppath data record datarecord string destination destination org mapper orgmapper map to org maptoorg destination date format dateformat timestamp path timestamppath date format dateformat format map string integer get source counts getsourcecounts source counts sourcecounts increment string source source source prop prefix org mapper orgmapper map to org maptoorg source integer count source counts sourcecounts source count count count count int value intvalue source counts sourcecounts source count string get org path getorgpath root path destination string get path getpath get org path getorgpath timestamp path timestamppath override string to string tostring string builder stringbuilder append get class getclass get simple name getsimplename append append timestamp path timestamppath append append destination append append source counts sourcecounts to string tostring string get key getkey string builder stringbuilder append timestamp path timestamppath append append destination to string tostring compute stats computestats string string string string dest add record addrecord dest string dest add record addrecord dest add record addrecord string string data record datarecord data record datarecord data data record datarecord existing data get key getkey existing increment data get key getkey existing increment called mail archive server store storing messages hook compute stats override process message processmessage message log debug processing string to array toarray get to getto string to array toarray get cc getcc string mail stats processor impl mailstatsprocessorimpl to array toarray get from getfrom compute stats computestats get date getdate to string tostring todo call async flush flush memory data per manent permanent storage flush resource resolver resourceresolver resolver resolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver data record datarecord data values org resource root log info storing path get path getpath resource util resourceutil get or create resource getorcreateresource resolver root path resource type resource type resource util resourceutil get or create resource getorcreateresource resolver get org path getorgpath destination resource type resource type properties message counts source destination map string object data hash map hashmap string object map entry string integer get source counts getsourcecounts entry set entryset data get key getkey get value getvalue data period prop timestamp path timestamppath data sling resource type resourcetype data resource type todo over writes overwrites existing values combine existing resource util resourceutil get or create resource getorcreateresource resolver get path getpath data resource type data clear resolver resolver commit resolver close exception log warn exception flush todo don utility string make jcr friendly makejcrfriendly string replace all replaceall replace all replaceall replace all replaceall trim replace all replaceall string to array toarray abstract list abstractlist list list list string result array list arraylist string object list result add to string tostring result to array toarray empty string array
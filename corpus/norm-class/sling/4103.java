licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer core impl util org junit assert false assertfalse org junit assert true asserttrue java util array list arraylist java util hash map hashmap java util list java util map org jmock expectations org jmock mockery org junit org junit test org osgi framework bundle org osgi service package admin packageadmin exported package exportedpackage org osgi service package admin packageadmin package admin packageadmin refresh dependencies util test refreshdependenciesutiltest mockery jmock bundle target bundle bundle bundle bundle bundle bundle package admin packageadmin refresh dependencies util refreshdependenciesutil rdu counter map string list bundle importing bundles importingbundles hash map hashmap string list bundle bundle setup bundle setupbundle string mock name mockname string import packages importpackages string exports packages exportspackages bundle result jmock mock bundle mock name mockname jmock checking expectations allowing result get bundle id getbundleid return value returnvalue counter import packages importpackages string pack import packages importpackages split list bundle list importing bundles importingbundles pack list list array list arraylist bundle importing bundles importingbundles pack list list add result list exported package exportedpackage eps array list arraylist exported package exportedpackage exports packages exportspackages string pack exports packages exportspackages split exported package exportedpackage jmock mock exported package exportedpackage exported package exportedpackage pack mock name mockname eps add jmock checking expectations allowing get importing bundles getimportingbundles return value returnvalue get importing bundles getimportingbundles pack allowing get name getname return value returnvalue pack jmock checking expectations allowing get exported packages getexportedpackages result return value returnvalue eps to array toarray exported package exportedpackage result bundle get importing bundles getimportingbundles string package name packagename list bundle list importing bundles importingbundles package name packagename list list to array toarray bundle setup jmock mockery jmock mock package admin packageadmin rdu refresh dependencies util refreshdependenciesutil test bundle depends depend target setup bundle setupbundle test bundle testbundle target imports one targetimportsone target imports two targetimportstwo setup bundle setupbundle target imports one targetimportsone setup bundle setupbundle export test bundle depends turns depends setup bundle setupbundle c imports one cimportsone target imports two targetimportstwo setup bundle setupbundle c imports one cimportsone setup bundle setupbundle imports exports packages setup bundle setupbundle foo foo test test target depends on self testtargetdependsonself list bundle bundles array list arraylist bundle bundles add assert true asserttrue rdu is bundle affected isbundleaffected bundles test test target depends on bundle a testtargetdependsonbundlea list bundle bundles array list arraylist bundle bundles add assert true asserttrue rdu is bundle affected isbundleaffected target bundles test test target does not dep end on bundle b testtargetdoesnotdependonbundleb list bundle bundles array list arraylist bundle bundles add assert false assertfalse rdu is bundle affected isbundleaffected target bundles test test target does not dep end on bundle bor e testtargetdoesnotdependonbundlebore list bundle bundles array list arraylist bundle bundles add bundles add assert false assertfalse rdu is bundle affected isbundleaffected target bundles test test target depends on bundle c testtargetdependsonbundlec list bundle bundles array list arraylist bundle bundles add assert true asserttrue rdu is bundle affected isbundleaffected target bundles test test target depends on bundle d testtargetdependsonbundled list bundle bundles array list arraylist bundle bundles add assert true asserttrue rdu is bundle affected isbundleaffected target bundles test test all bundles in list testallbundlesinlist list bundle bundles array list arraylist bundle bundles add bundles add bundles add bundles add bundles add bundles add target assert true asserttrue rdu is bundle affected isbundleaffected target bundles
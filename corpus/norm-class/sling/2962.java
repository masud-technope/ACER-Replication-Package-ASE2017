licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling util java util array list arraylist java util arrays java util collections java util hash set hashset java util list java util org apache sling api health check healthcheck org osgi framework bundle context bundlecontext org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service reference servicereference org slf logger org slf logger factory loggerfactory select link health check healthcheck services filter object returned health check services longer link dispose called free service references thread safe instances should n shouldn concurrently threads health check filter healthcheckfilter logger log logger factory loggerfactory get logger getlogger get class getclass bundle context bundlecontext bundle context bundlecontext string omit prefix service reference servicereference used references usedreferences hash set hashset service reference servicereference create filter object health check filter healthcheckfilter bundle context bundlecontext bundle context bundlecontext health check services supplied tags list services empty list matches suppress warnings suppresswarnings unchecked list health check healthcheck get tag ged health checks gettaggedhealthchecks string tags service reference servicereference get tag ged health check service references gettaggedhealthcheckservicereferences tags list health check healthcheck result array list arraylist health check healthcheck list service reference servicereference sorted refs sortedrefs arrays as list aslist collections sort sorted refs sortedrefs service reference servicereference sorted refs sortedrefs health check healthcheck health check healthcheck bundle context bundlecontext get service getservice log debug selected health check healthcheck service used references usedreferences add result add result service references health check services supplied tags logical combine tags array service references empty error matches service reference servicereference get tag ged health check service references gettaggedhealthcheckservicereferences string tags get tag ged health check service references gettaggedhealthcheckservicereferences tags service references health check services supplied tags param combine with or combinewithor health checks tags health checks tags assigned param tags tags array service references empty error matches service reference servicereference get tag ged health check service references gettaggedhealthcheckservicereferences combine with or combinewithor string tags build service filter string builder stringbuilder filter builder filterbuilder string builder stringbuilder filter builder filterbuilder append object class objectclass append health check healthcheck get name getname append prefix len prefixlen omit prefix length filters string builder stringbuilder filter builder for or operator filterbuilderfororoperator string builder stringbuilder string tag tags tag tag trim tag length tag starts with startswith omit prefix ommit tags clause filter builder filterbuilder append append health check healthcheck tags append append tag substring prefix len prefixlen append add regular tags list clause clause combine with or combinewithor filter builder for or operator filterbuilderfororoperator append append health check healthcheck tags append append tag append filter builder filterbuilder append append health check healthcheck tags append append tag append add clause accumulated filter builder for or operator filterbuilderfororoperator length filter builder filterbuilder append append filter builder for or operator filterbuilderfororoperator append filter builder filterbuilder append log debug osg i osgi service filter get tag ged health check service references gettaggedhealthcheckservicereferences filter builder filterbuilder string filter string filterstring filter builder filterbuilder length filter builder filterbuilder to string tostring check syntax early bundle context bundlecontext create filter createfilter filter string filterstring service reference servicereference bundle context bundlecontext get service references getservicereferences health check healthcheck get name getname filter string filterstring log debug health check healthcheck services filter filter string filterstring service reference servicereference log debug health check healthcheck services filter length filter string filterstring invalid syntax exception invalidsyntaxexception ise log error invalid osg i osgi filter syntax filter builder filterbuilder ise service reference servicereference dispose service references dispose service reference servicereference used references usedreferences bundle context bundlecontext unget service ungetservice used references usedreferences clear
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling distribution agent impl javax annotation nonnull javax annotation nullable javax jcr repository exception repositoryexception javax jcr session javax jcr simple credentials simplecredentials java util arrays java util collection java util hash map hashmap java util linked list linkedlist java util list java util map java util java util tree set treeset org apache sling api resource login exception loginexception org apache sling api resource persistence exception persistenceexception org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling distribution distribution request distributionrequest org apache sling distribution distribution request state distributionrequeststate org apache sling distribution distribution request type distributionrequesttype org apache sling distribution distribution response distributionresponse org apache sling distribution agent distribution agent distributionagent org apache sling distribution agent distribution agent state distributionagentstate org apache sling distribution component impl distribution component kind distributioncomponentkind org apache sling distribution component impl settings utils settingsutils org apache sling distribution event distribution event topics distributioneventtopics org apache sling distribution event impl distribution event factory distributioneventfactory org apache sling distribution impl composite distribution response compositedistributionresponse org apache sling distribution common distribution exception distributionexception org apache sling distribution impl simple distribution response simpledistributionresponse org apache sling distribution log distribution log distributionlog org apache sling distribution log impl default distribution log defaultdistributionlog org apache sling distribution serialization distribution package distributionpackage org apache sling distribution pack aging packaging distribution package exporter distributionpackageexporter org apache sling distribution pack aging packaging distribution package importer distributionpackageimporter org apache sling distribution pack aging packaging impl distribution package utils distributionpackageutils org apache sling distribution queue distribution queue distributionqueue org apache sling distribution queue distribution queue entry distributionqueueentry org apache sling distribution queue distribution queue item distributionqueueitem org apache sling distribution queue distribution queue item state distributionqueueitemstate org apache sling distribution queue distribution queue item status distributionqueueitemstatus org apache sling distribution queue distribution queue processor distributionqueueprocessor org apache sling distribution queue distribution queue provider distributionqueueprovider org apache sling distribution queue distribution queue state distributionqueuestate org apache sling distribution queue impl distribution queue dispatching strategy distributionqueuedispatchingstrategy org apache sling distribution trigger distribution request handler distributionrequesthandler org apache sling distribution trigger distribution trigger distributiontrigger org apache sling distribution util impl distribution utils distributionutils org apache sling jcr api sling repository slingrepository org apache sling jcr resource jcr resource constants jcrresourceconstants basic implementation link org apache sling distribution agent distribution agent distributionagent simple distribution agent simpledistributionagent distribution agent distributionagent string agent service default agent service defaultagentservice distribution queue provider distributionqueueprovider queue provider queueprovider queue processing enabled queueprocessingenabled distribution package importer distributionpackageimporter distribution package importer distributionpackageimporter distribution package exporter distributionpackageexporter distribution package exporter distributionpackageexporter distribution queue dispatching strategy distributionqueuedispatchingstrategy schedule queue strategy schedulequeuestrategy distribution queue dispatching strategy distributionqueuedispatchingstrategy error queue strategy errorqueuestrategy distribution event factory distributioneventfactory distribution event factory distributioneventfactory string distribution request authorization strategy distributionrequestauthorizationstrategy distribution request authorization strategy distributionrequestauthorizationstrategy resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory string sub service name subservicename agent based request handler agentbasedrequesthandler agent based request handler agentbasedrequesthandler active string processing queues processingqueues retry attempts retryattempts impersonate user impersonateuser sling repository slingrepository sling repository slingrepository default distribution log defaultdistributionlog log distribution request type distributionrequesttype allowed requests allowedrequests string allowed roots allowedroots simple distribution agent simpledistributionagent string queue processing enabled queueprocessingenabled string processing queues processingqueues string sub service name subservicename distribution package importer distributionpackageimporter distribution package importer distributionpackageimporter distribution package exporter distributionpackageexporter distribution package exporter distributionpackageexporter distribution request authorization strategy distributionrequestauthorizationstrategy distribution request authorization strategy distributionrequestauthorizationstrategy distribution queue provider distributionqueueprovider queue provider queueprovider distribution queue dispatching strategy distributionqueuedispatchingstrategy schedule queue strategy schedulequeuestrategy distribution queue dispatching strategy distributionqueuedispatchingstrategy error queue strategy errorqueuestrategy distribution event factory distributioneventfactory distribution event factory distributioneventfactory resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory sling repository slingrepository sling repository slingrepository default distribution log defaultdistributionlog log distribution request type distributionrequesttype allowed requests allowedrequests string allowed roots allowedroots retry attempts retryattempts sling repository slingrepository sling repository slingrepository log log allowed requests allowedrequests allowed requests allowedrequests processing queues processingqueues processing queues processingqueues retry attempts retryattempts retry attempts retryattempts check configuration valid queue processing enabled queueprocessingenabled distribution package importer distributionpackageimporter distribution package exporter distributionpackageexporter distribution request authorization strategy distributionrequestauthorizationstrategy queue provider queueprovider schedule queue strategy schedulequeuestrategy distribution event factory distributioneventfactory resource resolver factory resourceresolverfactory string error message errormessage arrays to string tostring object distribution package importer distributionpackageimporter distribution package exporter distributionpackageexporter sub service name subservicename distribution request authorization strategy distributionrequestauthorizationstrategy queue provider queueprovider schedule queue strategy schedulequeuestrategy distribution event factory distributioneventfactory resource resolver factory resourceresolverfactory illegal argument exception illegalargumentexception arguments required error message errormessage allowed roots allowedroots settings utils settingsutils remove empty entries removeemptyentries allowed roots allowedroots sub service name subservicename settings utils settingsutils remove empty entry removeemptyentry sub service name subservicename impersonate user impersonateuser sub service name subservicename distribution request authorization strategy distributionrequestauthorizationstrategy distribution request authorization strategy distributionrequestauthorizationstrategy resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory settings utils settingsutils remove empty entry removeemptyentry queue processing enabled queueprocessingenabled queue processing enabled queueprocessingenabled distribution package importer distributionpackageimporter distribution package importer distributionpackageimporter distribution package exporter distributionpackageexporter distribution package exporter distributionpackageexporter queue provider queueprovider queue provider queueprovider schedule queue strategy schedulequeuestrategy schedule queue strategy schedulequeuestrategy error queue strategy errorqueuestrategy error queue strategy errorqueuestrategy distribution event factory distributioneventfactory distribution event factory distributioneventfactory nonnull distribution response distributionresponse execute nonnull resource resolver resourceresolver resource resolver resourceresolver nonnull distribution request distributionrequest distribution request distributionrequest distribution exception distributionexception resource resolver resourceresolver agent resource resolver agentresourceresolver is accepted request type isacceptedrequesttype distribution request distributionrequest log debug request type accepted distribution request distributionrequest get request type getrequesttype simple distribution response simpledistributionresponse distribution request state distributionrequeststate dropped request type accepted is accepted request root isacceptedrequestroot distribution request distributionrequest log debug request paths accepted arrays to string tostring distribution request distributionrequest get paths getpaths simple distribution response simpledistributionresponse distribution request state distributionrequeststate dropped request paths accepted silent distribution request type distributionrequesttype pull equals distribution request distributionrequest get request type getrequesttype string calling user callinguser resource resolver resourceresolver get user d getuserid log info starting request user distribution request distributionrequest calling user callinguser distribution request authorization strategy distributionrequestauthorizationstrategy check permission checkpermission resource resolver resourceresolver distribution request distributionrequest agent resource resolver agentresourceresolver get agent resource resolver getagentresourceresolver calling user callinguser list distribution package distributionpackage distribution packages distributionpackages export packages exportpackages agent resource resolver agentresourceresolver distribution request distributionrequest log debug exported packages distribution packages distributionpackages size distribution response distributionresponse distribution response distributionresponse schedule import packages scheduleimportpackages distribution packages distributionpackages calling user callinguser log info silent returning response distribution response distributionresponse distribution response distributionresponse unget agent resource resolver ungetagentresourceresolver agent resource resolver agentresourceresolver is passive ispassive queue processing enabled queueprocessingenabled list distribution package distributionpackage export packages exportpackages resource resolver resourceresolver agent resource resolver agentresourceresolver distribution request distributionrequest distribution request distributionrequest distribution exception distributionexception log info exporting packages user agent resource resolver agentresourceresolver agent resource resolver agentresourceresolver get user d getuserid dummy list distribution package distributionpackage distribution packages distributionpackages distribution package exporter distributionpackageexporter export packages exportpackages agent resource resolver agentresourceresolver distribution request distributionrequest generate package event generatepackageevent distribution event topics distributioneventtopics agent created distribution packages distributionpackages distribution response distributionresponse schedule import packages scheduleimportpackages list distribution package distributionpackage distribution packages distributionpackages string calling user callinguser list distribution response distributionresponse distribution responses distributionresponses linked list linkedlist distribution response distributionresponse distribution package distributionpackage distribution package distributionpackage distribution packages distributionpackages collection simple distribution response simpledistributionresponse distribution responses for package distributionresponsesforpackage schedule import package scheduleimportpackage distribution package distributionpackage calling user callinguser distribution responses distributionresponses add all addall distribution responses for package distributionresponsesforpackage distribution responses distributionresponses size distribution responses distributionresponses composite distribution response compositedistributionresponse distribution responses distributionresponses collection simple distribution response simpledistributionresponse schedule import package scheduleimportpackage distribution package distributionpackage distribution package distributionpackage string calling user callinguser collection simple distribution response simpledistributionresponse distribution responses distributionresponses linked list linkedlist simple distribution response simpledistributionresponse dispatch distribution queue distribution handler distribution package distributionpackage get info getinfo distribution package utils distributionpackageutils info property request user calling user callinguser iterable distribution queue item status distributionqueueitemstatus schedule queue strategy schedulequeuestrategy add distribution package distributionpackage queue provider queueprovider distribution queue item status distributionqueueitemstatus distribution request state distributionrequeststate request state requeststate get request state from queue state getrequeststatefromqueuestate get item state getitemstate distribution responses distributionresponses add simple distribution response simpledistributionresponse request state requeststate get item state getitemstate to string tostring generate package event generatepackageevent distribution event topics distributioneventtopics agent queued distribution package distributionpackage distribution exception distributionexception log error error happened dispatching items queue distribution responses distributionresponses add simple distribution response simpledistributionresponse distribution request state distributionrequeststate dropped to string tostring distribution package distributionpackage close log info scheduled info distribution package distributionpackage get id getid distribution package distributionpackage get info getinfo distribution responses distributionresponses nonnull string get queue names getqueuenames string queue names queuenames tree set treeset string queue names queuenames add all addall schedule queue strategy schedulequeuestrategy get queue names getqueuenames error queue strategy errorqueuestrategy queue names queuenames add all addall error queue strategy errorqueuestrategy get queue names getqueuenames queue names queuenames distribution queue distributionqueue get queue getqueue nonnull string queue name queuename queue name queuename queue name queuename length queue name queuename distribution queue dispatching strategy distributionqueuedispatchingstrategy queue string queues get queue names getqueuenames queues queue name queuename distribution queue distributionqueue queue queue queue provider queueprovider get queue getqueue queue name queuename distribution exception distributionexception log error queue queue nonnull distribution log distributionlog get log getlog log nonnull distribution agent state distributionagentstate get state getstate distribution agent state distributionagentstate agent state agentstate distribution agent state distributionagentstate idle passive queueing agent is passive ispassive distribution package importer distributionpackageimporter distribution agent state distributionagentstate paused string queue name queuename get queue names getqueuenames distribution queue distributionqueue queue get queue getqueue queue name queuename distribution queue state distributionqueuestate queue get status getstatus get state getstate distribution queue state distributionqueuestate blocked equals distribution agent state distributionagentstate blocked distribution queue state distributionqueuestate running equals agent state agentstate distribution agent state distributionagentstate running agent state agentstate enable log info enabling agent register triggers agent based request handler agentbasedrequesthandler agent based request handler agentbasedrequesthandler is passive ispassive queue provider queueprovider enable queue processing enablequeueprocessing package queue processor packagequeueprocessor processing queues processingqueues to array toarray string processing queues processingqueues size distribution exception distributionexception log error enable queue processing active enable trigger enabletrigger distribution trigger distributiontrigger trigger active agent based request handler agentbasedrequesthandler log info enabling trigger trigger trigger register agent based request handler agentbasedrequesthandler distribution exception distributionexception log error register handler trigger trigger disable trigger disabletrigger distribution trigger distributiontrigger trigger active agent based request handler agentbasedrequesthandler log info disabling trigger trigger trigger unregister agent based request handler agentbasedrequesthandler distribution exception distributionexception log error unregister handler trigger trigger disable log info disabling agent active agent based request handler agentbasedrequesthandler is passive ispassive queue provider queueprovider disable queue processing disablequeueprocessing distribution exception distributionexception log error disable queue processing process queue item processqueueitem string queue name queuename distribution queue entry distributionqueueentry queue entry queueentry distribution exception distributionexception success resource resolver resourceresolver agent resource resolver agentresourceresolver distribution package distributionpackage distribution package distributionpackage distribution queue item distributionqueueitem queue item queueitem queue entry queueentry get item getitem distribution queue item status distributionqueueitemstatus queue item status queueitemstatus queue entry queueentry get status getstatus string calling user callinguser queue item queueitem distribution package utils distributionpackageutils info property request user string agent resource resolver agentresourceresolver get agent resource resolver getagentresourceresolver calling user callinguser distribution package distributionpackage distribution package exporter distributionpackageexporter get package getpackage agent resource resolver agentresourceresolver queue item queueitem get id getid distribution package distributionpackage distribution package utils distributionpackageutils merge queue entry mergequeueentry distribution package distributionpackage get info getinfo queue entry queueentry process package processpackage agent resource resolver agentresourceresolver distribution package distributionpackage success distribution package utils distributionpackageutils release or delete releaseordelete distribution package distributionpackage queue name queuename generate package event generatepackageevent distribution event topics distributioneventtopics agent distributed distribution package distributionpackage error queue strategy errorqueuestrategy queue item status queueitemstatus get attempts getattempts retry attempts retryattempts success re enqueue package reenqueuepackage distribution package distributionpackage distribution package utils distributionpackageutils release or delete releaseordelete distribution package distributionpackage queue name queuename log info processed queue info queue name queuename distribution package distributionpackage get id getid distribution package distributionpackage get info getinfo success exist order clear queue success log error distribution exist skipped queue item queueitem get id getid unget agent resource resolver ungetagentresourceresolver agent resource resolver agentresourceresolver distribution package distributionpackage distribution package distributionpackage close success process package processpackage resource resolver resourceresolver resource resolver resourceresolver distribution package distributionpackage distribution package distributionpackage distribution package importer distributionpackageimporter import package importpackage resource resolver resourceresolver distribution package distributionpackage distribution exception distributionexception log error deliver distribution package distributionpackage get id getid log debug distribution delivered distribution package distributionpackage get id getid re enqueue package reenqueuepackage distribution package distributionpackage distribution package distributionpackage error queue strategy errorqueuestrategy error queue strategy errorqueuestrategy add distribution package distributionpackage queue provider queueprovider distribution exception distributionexception log error reenqueue distribution package distributionpackage get id getid log info distribution reenqueued distribution package distributionpackage get id getid resource resolver resourceresolver get agent resource resolver getagentresourceresolver string user distribution exception distributionexception resource resolver resourceresolver resource resolver resourceresolver map string object authentication info authenticationinfo hash map hashmap string object impersonate user impersonateuser user session session sling repository slingrepository impersonate from service impersonatefromservice agent service simple credentials simplecredentials user authentication info authenticationinfo jcr resource constants jcrresourceconstants authentication info session session resource resolver resourceresolver resource resolver factory resourceresolverfactory get resource resolver getresourceresolver authentication info authenticationinfo authentication info authenticationinfo resource resolver factory resourceresolverfactory subservice sub service name subservicename resource resolver resourceresolver resource resolver factory resourceresolverfactory get service resource resolver getserviceresourceresolver authentication info authenticationinfo resource resolver resourceresolver login exception loginexception distribution exception distributionexception repository exception repositoryexception distribution exception distributionexception unget agent resource resolver ungetagentresourceresolver resource resolver resourceresolver resource resolver resourceresolver resource resolver resourceresolver resource resolver resourceresolver commit persistence exception persistenceexception log error commit resource resolver distribution utils distributionutils safely log out safelylogout resource resolver resourceresolver generate package event generatepackageevent string topic distribution package distributionpackage distribution packages distributionpackages distribution package distributionpackage distribution package distributionpackage distribution packages distributionpackages distribution event factory distributioneventfactory generate package event generatepackageevent topic distribution component kind distributioncomponentkind agent distribution package distributionpackage get info getinfo is accepted request type isacceptedrequesttype distribution request distributionrequest request allowed requests allowedrequests distribution request type distributionrequesttype test equals request get request type getrequesttype distribution request type distributionrequesttype request type requesttype allowed requests allowedrequests request type requesttype equals request get request type getrequesttype is accepted request root isacceptedrequestroot distribution request distributionrequest request allowed roots allowedroots allowed roots allowedroots length distribution request type distributionrequesttype add equals request get request type getrequesttype distribution request type distributionrequesttype delete equals request get request type getrequesttype string path request get paths getpaths allowed string allowed root allowedroot allowed roots allowedroots allowed root allowedroot allowed root allowedroot trim length path starts with startswith allowed root allowedroot allowed allowed package queue processor packagequeueprocessor distribution queue processor distributionqueueprocessor process nonnull string queue name queuename nonnull distribution queue entry distributionqueueentry queue entry queueentry distribution queue item distributionqueueitem queue item queueitem queue entry queueentry get item getitem log debug queue processing item queue name queuename queue item queueitem success process queue item processqueueitem queue name queuename queue entry queueentry log debug queue processing item ended status queue name queuename queue item queueitem success success throwable log error queue error processing item object queue name queuename queue item queueitem agent based request handler agentbasedrequesthandler distribution request handler distributionrequesthandler distribution agent distributionagent agent agent based request handler agentbasedrequesthandler distribution agent distributionagent agent agent agent handle nullable resource resolver resourceresolver resource resolver resourceresolver nonnull distribution request distributionrequest request active log warn skip ping skipping agent handler agent disabled resource resolver resourceresolver agent execute resource resolver resourceresolver request throwable log error error executing handler resource resolver resourceresolver agent resource resolver agentresourceresolver agent resource resolver agentresourceresolver get agent resource resolver getagentresourceresolver agent execute agent resource resolver agentresourceresolver request throwable log error error executing handler unget agent resource resolver ungetagentresourceresolver agent resource resolver agentresourceresolver convert item queue request distribution request state distributionrequeststate get request state from queue state getrequeststatefromqueuestate distribution queue item state distributionqueueitemstate item state itemstate distribution request state distributionrequeststate request state requeststate item state itemstate queued request state requeststate distribution request state distributionrequeststate accepted error request state requeststate distribution request state distributionrequeststate dropped request state requeststate distribution request state distributionrequeststate dropped request state requeststate
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer core impl org junit assert equals assertequals org junit assert not null assertnotnull org junit assert null assertnull org junit assert true asserttrue java byte array input stream bytearrayinputstream java file java file input stream fileinputstream java io exception ioexception java input stream inputstream java util collections java util dictionary java util hashtable org apache sling installer api installable resource installableresource org apache sling installer api tasks registered resource registeredresource org apache sling installer api tasks task resource taskresource org apache sling installer api tasks transformation result transformationresult org junit test org osgi framework bundle context bundlecontext org osgi framework constants registered resource test registeredresourcetest string test url test url file get test bundle gettestbundle string file system get property getproperty osgi installer base dir org apache sling installer core system get property getproperty osgi installer pom version org junit test test resource type testresourcetype exception input stream inputstream file input stream fileinputstream get test bundle gettestbundle test bundle testbundle jar registered resource registeredresource create installable resource installableresource test jar digest assert equals assertequals jar url creates bundle resource installable resource installableresource type bundle get type gettype input stream inputstream get input stream getinputstream assert not null assertnotnull bundle resource input stream inputstream close assert null assertnull bundle resource provide dictionary get dictionary getdictionary assert equals assertequals registered resource registeredresource entity match bundle osgi installer test bundle testbundle get entity id getentityid hashtable string object data hashtable string object data foo bar data task resource taskresource create installable resource installableresource configuration data assert equals assertequals extension url dictionary creates config resource installable resource installableresource type config get type gettype input stream inputstream get input stream getinputstream assert null assertnull config resource provide input stream inputstream dictionary string object get dictionary getdictionary assert not null assertnotnull config resource dictionary assert equals assertequals config resource dictionary properties size assert not null assertnotnull config resource pid attribute get attribute getattribute constants service pid org junit test test local file copy testlocalfilecopy exception file local file localfile file create temp file createtempfile test local file copy testlocalfilecopy data local file localfile delete on exit deleteonexit bundle context bundlecontext mock bundle context mockbundlecontext file get test bundle gettestbundle test bundle testbundle jar input stream inputstream file input stream fileinputstream file data store filedatastore shared file data store filedatastore override file create new data file createnewdatafile input stream inputstream stream string url string digest string hint io exception ioexception copy to local storage copytolocalstorage stream local file localfile local file localfile internal resource internalresource create test installable resource installableresource test jar some digest somedigest assert true asserttrue local file exists local file localfile exists assert equals assertequals local file length matches data length local file localfile length org junit test test missing digest testmissingdigest exception string data data input stream inputstream byte array input stream bytearrayinputstream data get bytes getbytes create installable resource installableresource test jar assert not null assertnotnull create installable resource installableresource test jar get digest getdigest org junit test test bundle manifest testbundlemanifest exception file get test bundle gettestbundle test bundle testbundle jar installable resource installableresource installable resource installableresource test get absolute path getabsolutepath file input stream fileinputstream get name getname task resource taskresource create assert not null assertnotnull registered resource registeredresource bundle symbolic get attribute getattribute constants bundle symbolicname assert equals assertequals registered resource registeredresource entity match bundle osgi installer test bundle testbundle get entity id getentityid org junit test test config entity testconfigentity exception installable resource installableresource installable resource installableresource test foo some config someconfig hashtable string object task resource taskresource create assert null assertnull registered resource registeredresource bundle symbolic get attribute getattribute constants bundle symbolicname assert equals assertequals registered resource registeredresource entity match config some config someconfig get entity id getentityid org junit test test config digest includes url testconfigdigestincludesurl exception dictionary string object data hashtable string object installable resource installableresource installable resource installableresource test url a urla data installable resource installableresource installable resource installableresource test url b urlb data assert true asserttrue expecting configs data url s urls digests create get digest getdigest equals create get digest getdigest test test dictionary digest testdictionarydigest io exception ioexception dictionary string object hashtable string object installable resource installableresource installable resource installableresource url assert not null assertnotnull expected registered resource registeredresource compute digest create get digest getdigest org junit test test dictionary digest from dictionaries testdictionarydigestfromdictionaries exception hashtable string object hashtable string object hashtable string object hashtable string object string foo bar length length installable resource installableresource installable resource installableresource test url installable resource installableresource installable resource installableresource test url assert equals assertequals installable resource installableresource dictionary values key order ings orderings key create get digest getdigest create get digest getdigest task resource taskresource create installable resource installableresource io exception ioexception file data store filedatastore mock bundle context mockbundlecontext internal resource internalresource internal internal resource internalresource create test registered resource impl registeredresourceimpl registered resource impl registeredresourceimpl create internal transformation result transformationresult default transformer defaulttransformer transform clone get id getid starts with startswith configuration transformation result transformationresult result transformation result transformationresult result set id setid get id getid substring result set resource type setresourcetype installable resource installableresource type config result set attributes setattributes collections singleton map singletonmap constants service pid object result get id getid clone result
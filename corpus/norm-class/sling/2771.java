licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling scripting sightly impl engine extension java util hash set hashset java util java util regex pattern javax script bindings org apache felix scr annotations component org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling api sling http servlet request slinghttpservletrequest org apache sling scripting sightly sightly exception sightlyexception org apache sling scripting sightly extension runtime extension runtimeextension org apache sling scripting sightly impl compiler compiler exception compilerexception org apache sling scripting sightly impl filter xss filter xssfilter org apache sling scripting sightly impl html markup utils markuputils org apache sling scripting sightly impl plugin markup context markupcontext org apache sling scripting sightly impl utils render utils renderutils org apache sling scripting sightly render render context rendercontext org apache sling xss xssapi org slf logger org slf logger factory loggerfactory runtime support xss filtering component service runtime extension runtimeextension properties property runtime extension runtimeextension xss filter xssfilter function xss runtime extension xssruntimeextension runtime extension runtimeextension string element name white list elementnamewhitelist hash set hashset string logger log logger factory loggerfactory get logger getlogger xss runtime extension xssruntimeextension pattern valid attribute pattern compile override object call render context rendercontext render context rendercontext object arguments arguments length sightly exception sightlyexception string format extension requires arguments xss filter xssfilter function object original arguments object option arguments object hint arguments length hint arguments markup context markupcontext markup context markupcontext option option string string string option markup context markupcontext markup context markupcontext lookup markup context markupcontext markup context markupcontext unsafe original markup context markupcontext log warn expression context invalid expression replaced empty string option string text render utils renderutils to string tostring original xssapi xssapi obtainapi render context rendercontext get bindings getbindings applyxssfilter xssapi text hint markup context markupcontext string applyxssfilter xssapi xssapi string text object hint markup context markupcontext xss context xsscontext xss context xsscontext equals markup context markupcontext attribute hint string string attribute name attributename string hint markup context markupcontext attr markup context attrmarkupcontext get attribute markup context getattributemarkupcontext attribute name attributename applyxssfilter xssapi text attr markup context attrmarkupcontext applyxssfilter xssapi text xss context xsscontext string applyxssfilter xssapi xssapi string text markup context markupcontext xss context xsscontext xss context xsscontext attribute xssapi encodeforhtmlattr text comment text xssapi encodeforhtml text attribute escape attribute name escapeattributename text number xssapi get valid long getvalidlong text to string tostring uri xssapi get valid href getvalidhref text script token xssapi getvalidjstoken text style token xssapi get valid style token getvalidstyletoken text script string xssapi encodeforjsstring text style string xssapi encodeforcssstring text script comment style comment xssapi get valid multi line comment getvalidmultilinecomment text element escape element name escapeelementname text html xssapi filterhtml text todo apply xss filters text string escape element name escapeelementname string original original original trim element name white list elementnamewhitelist original to lower case tolowercase original xssapi obtainapi bindings bindings sling http servlet request slinghttpservletrequest request sling http servlet request slinghttpservletrequest bindings request request compiler exception compilerexception request bindings request adapt to adaptto xssapi markup context markupcontext get attribute markup context getattributemarkupcontext string attribute name attributename src equals ignore case equalsignorecase attribute name attributename href equals ignore case equalsignorecase attribute name attributename markup context markupcontext uri markup context markupcontext attribute string escape attribute name escapeattributename string attribute name attributename attribute name attributename attribute name attributename attribute name attributename trim match pattern matchpattern valid attribute attribute name attributename markup utils markuputils is sensitive attribute issensitiveattribute attribute name attributename attribute name attributename match pattern matchpattern pattern pattern string str pattern matcher str matches element name white list elementnamewhitelist add element name white list elementnamewhitelist add nav element name white list elementnamewhitelist add article element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add header element name white list elementnamewhitelist add foo ter footer element name white list elementnamewhitelist add add ress address element name white list elementnamewhitelist add main element name white list elementnamewhitelist add element name white list elementnamewhitelist add pre element name white list elementnamewhitelist add block quote blockquote element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add figure element name white list elementnamewhitelist add figcaption element name white list elementnamewhitelist add div element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add strong element name white list elementnamewhitelist add small element name white list elementnamewhitelist add element name white list elementnamewhitelist add cite element name white list elementnamewhitelist add element name white list elementnamewhitelist add dfn element name white list elementnamewhitelist add abbbr element name white list elementnamewhitelist add data element name white list elementnamewhitelist add time element name white list elementnamewhitelist add code element name white list elementnamewhitelist add element name white list elementnamewhitelist add samp element name white list elementnamewhitelist add kbd element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add mark element name white list elementnamewhitelist add ruby element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add bdi element name white list elementnamewhitelist add bdo element name white list elementnamewhitelist add span element name white list elementnamewhitelist add element name white list elementnamewhitelist add wbr element name white list elementnamewhitelist add ins element name white list elementnamewhitelist add del element name white list elementnamewhitelist add table element name white list elementnamewhitelist add element name white list elementnamewhitelist add colgroup element name white list elementnamewhitelist add col element name white list elementnamewhitelist add tbody element name white list elementnamewhitelist add the ad thead element name white list elementnamewhitelist add tfoot element name white list elementnamewhitelist add element name white list elementnamewhitelist add element name white list elementnamewhitelist add
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling xss impl java util list org owasp validator html clean results cleanresults org owasp validator html policy exception policyexception org owasp validator html scan exception scanexception org slf logger org slf logger factory loggerfactory escaping rule cleaning existing html content output html cleanup performed anti samy antisamy library href http owasp org php anti samy antisamy http owasp org php anti samy antisamy html to html content context htmltohtmlcontentcontext xss filter rule xssfilterrule logger logger log logger factory loggerfactory get logger getlogger get class getclass xss filter rule xssfilterrule check policy handler policyhandler string check policy handler policyhandler policy handler policyhandler string str policy handler policyhandler get anti samy getantisamy scan str get number of errors getnumberoferrors scan exception scanexception runtime exception runtimeexception unable scan input policy exception policyexception xss filter rule xssfilterrule filter policy handler policyhandler java lang string string filter policy handler policyhandler policy handler policyhandler string str log debug protecting html html str clean results cleanresults policy handler policyhandler get anti samy getantisamy scan str string cleaned getcleanhtml suppress warnings suppresswarnings unchecked list string errors get error messages geterrormessages string error errors log info anti samy antisamy warning error log debug html html cleaned cleaned scan exception scanexception runtime exception runtimeexception unable scan input policy exception policyexception runtime exception runtimeexception unable scan input xss filter rule xssfilterrule supports policy supportspolicy supports policy supportspolicy
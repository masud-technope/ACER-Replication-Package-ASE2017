licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling mailarchiveserver impl org apache sling mailarchiveserver impl message store impl repository test util messagestoreimplrepositorytestutil get resource path getresourcepath org apache sling mailarchiveserver util message field name messagefieldname content org apache sling mailarchiveserver util message field name messagefieldname list org junit assert equals assertequals org junit assert not null assertnotnull org junit assert true asserttrue org junit fail java byte array input stream bytearrayinputstream java byte array output stream bytearrayoutputstream java io exception ioexception java util java util linked list linkedlist java util list java util queue java util random org apache james mime dom binary body binarybody org apache james mime dom body org apache james mime dom entity org apache james mime dom message org apache james mime dom multipart org apache james mime dom text body textbody org apache james mime message body part bodypart org apache james mime message message impl messageimpl org apache james mime message multipart impl multipartimpl org apache james mime storage storage body factory storagebodyfactory org apache james mime stream field org apache james mime stream raw field rawfield org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling discovery impl setup mocked resource resolver mockedresourceresolver org apache sling mailarchiveserver util mail archive server constants mailarchiveserverconstants org junit org junit org junit test message store impl attachments test messagestoreimplattachmentstest resource resolver resourceresolver resolver resource test root testroot message store impl messagestoreimpl store code http svn apache org repos asf sling trunk launchpad test services src main java org apache sling launchpad tests ervices testservices server side tests serversidetests write able resources test writeableresourcestest java setup exception resolver mocked resource resolver mockedresourceresolver assert not null assertnotnull expecting resource resolver resourceresolver resolver resource root resolver get resource getresource assert not null assertnotnull expecting root resource root string path get class getclass get simple name getsimplename system current time millis currenttimemillis test root testroot resolver create root path resolver commit store message store impl messagestoreimpl resource resolver resourceresolver get resource resolver getresourceresolver resolver store thread key gen threadkeygen thread key generator impl threadkeygeneratorimpl store attachment filter attachmentfilter attachment filter impl attachmentfilterimpl store archive path archivepath test root testroot get path getpath store resource type key resourcetypekey message store impl repository test messagestoreimplrepositorytest test key cleanup exception resolver close resolver test root testroot store test simple multipart message test simplemultipartmessagetest io exception ioexception multipart multipart multipart impl multipartimpl mixed body part bodypart att create text body createtextbody template plain multipart add body part addbodypart att body part bodypart att create random binary attachment createrandombinaryattachment multipart add body part addbodypart att body part bodypart att create random binary attachment createrandombinaryattachment multipart add body part addbodypart att body part bodypart att create text body createtextbody sample text html multipart add body part addbodypart att body part bodypart att create random binary attachment createrandombinaryattachment multipart add body part addbodypart att body part bodypart att create text body createtextbody text plain multipart add body part addbodypart att message impl messageimpl message message impl messageimpl message set multipart setmultipart multipart message set subject setsubject template message message set date setdate message get header getheader set field setfield raw field rawfield list list assert save message with attachments assertsavemessagewithattachments message test recursive multipart message test recursivemultipartmessagetest io exception ioexception multipart multipart multipart impl multipartimpl mixed body part bodypart att create random binary attachment createrandombinaryattachment multipart add body part addbodypart att body part bodypart att create random binary attachment createrandombinaryattachment multipart add body part addbodypart att multipart nested multipart nestedmultipart multipart impl multipartimpl mixed body part bodypart n body nbody create text body createtextbody sample text plain nested multipart nestedmultipart add body part addbodypart n body nbody body part bodypart n att natt create random binary attachment createrandombinaryattachment nested multipart nestedmultipart add body part addbodypart n att natt body part bodypart n att natt create random binary attachment createrandombinaryattachment nested multipart nestedmultipart add body part addbodypart n att natt body part bodypart n att natt create text body createtextbody text html nested multipart nestedmultipart add body part addbodypart n att natt body part bodypart nested message nestedmessage body part bodypart nested message nestedmessage set multipart setmultipart nested multipart nestedmultipart multipart add body part addbodypart nested message nestedmessage message impl messageimpl message message impl messageimpl message set multipart setmultipart multipart message set subject setsubject template message message set date setdate message get header getheader set field setfield raw field rawfield list list assert save message with attachments assertsavemessagewithattachments message assert save message with attachments assertsavemessagewithattachments message msg num io exception ioexception store save msg list body part bodypart att list attlist linked list linkedlist body part bodypart message store impl messagestoreimpl recursive multipart processing recursivemultipartprocessing multipart msg get body getbody string builder stringbuilder string builder stringbuilder att list attlist suppress warnings suppresswarnings unchecked queue body part bodypart attachments msg attachmentsmsg queue body part bodypart att list attlist assert true asserttrue attachments attachments msg attachmentsmsg size assert equals assertequals num attachments msg attachmentsmsg size resource resolver get resource getresource get resource path getresourcepath msg store assert not null assertnotnull expecting resource resource a res ares get children getchildren modifiable value map modifiablevaluemap a map amap a res ares adapt to adaptto modifiable value map modifiablevaluemap body part bodypart a msg amsg attachments msg attachmentsmsg poll assert not null assertnotnull jcr attachments a msg amsg field a msg amsg get header getheader get fields getfields string get name getname assert equals assertequals field a map amap string get body getbody a msg amsg get body getbody text body textbody assert equals assertequals content message store impl messagestoreimpl get text part gettextpart a msg amsg a map amap content string a msg amsg get body getbody binary body binarybody assert equals assertequals content get bin part getbinpart a msg amsg a map amap content string fail unknown type attachment body assert equals assertequals message attachments attachments msg attachmentsmsg poll string get bin part getbinpart entity io exception ioexception binary body binarybody binary body binarybody get body getbody byte array output stream bytearrayoutputstream baos byte array output stream bytearrayoutputstream write to writeto baos string baos to byte array tobytearray http svn apache org repos asf james mime trunk examples src main java org apache james mime samples transform transform message transformmessage java body part bodypart create text body createtextbody string text string subtype is attachment isattachment text body textbody body storage body factory storagebodyfactory text body textbody text mail archive server constants mailarchiveserverconstants encoder charset body part bodypart body part bodypart body part bodypart is attachment isattachment body part bodypart set content disposition setcontentdisposition attachment file math random body part bodypart set text settext body subtype body part bodypart http svn apache org repos asf james mime trunk examples src main java org apache james mime samples transform transform message transformmessage java body part bodypart create random binary attachment createrandombinaryattachment number of bytes numberofbytes io exception ioexception data number of bytes numberofbytes random next bytes nextbytes data body body storage body factory storagebodyfactory binary body binarybody byte array input stream bytearrayinputstream data body part bodypart body part bodypart body part bodypart body part bodypart set content disposition setcontentdisposition attachment file math random body part bodypart set body setbody body application octet stream body part bodypart
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling resource collection impl java text message format messageformat java util array list arraylist java util hash map hashmap java util iterator java util list java util map org apache commons lang array utils arrayutils org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource persistence exception persistenceexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource util resourceutil org apache sling api resource value map valuemap org apache sling jcr resource jcr resource constants jcrresourceconstants org slf logger org slf logger factory loggerfactory org apache sling resource collection resource collection resourcecollection code resource collection resourcecollection code resource collection impl resourcecollectionimpl resource collection resourcecollection logger log logger factory loggerfactory get logger getlogger resource collection impl resourcecollectionimpl defines resource type property string resource type jcr resource constants jcrresourceconstants sling resource type property underlying resource resource resource resource resolver resource resource resolver resourceresolver resolver resource members resource membersresource creates collection resource param resource resource resource collection impl resourcecollectionimpl resource resource resource resource resolver resource get resource resolver getresourceresolver members resource membersresource resource get child getchild resource collection constants resourcecollectionconstants members node inherit doc inheritdoc string get name getname resource get name getname inherit doc inheritdoc string get path getpath resource get path getpath inherit doc inheritdoc add resource res map string object properties persistence exception persistenceexception res res modifiable value map modifiablevaluemap members resource membersresource adapt to adaptto modifiable value map modifiablevaluemap string order resource collection constants resourcecollectionconstants references prop string order string array utils arrayutils add order res get path getpath resource collection constants resourcecollectionconstants references prop order properties properties hash map hashmap string object properties resource collection constants resourcecollectionconstants property res get path getpath resolver create members resource membersresource resource util resourceutil create unique child name createuniquechildname members resource membersresource res get name getname properties log debug member resource collection string res get path getpath resource get path getpath inherit doc inheritdoc add resource res persistence exception persistenceexception res res modifiable value map modifiablevaluemap members resource membersresource adapt to adaptto modifiable value map modifiablevaluemap string order resource collection constants resourcecollectionconstants references prop string order string array utils arrayutils add order res get path getpath resource collection constants resourcecollectionconstants references prop order map string object properties hash map hashmap string object properties resource collection constants resourcecollectionconstants property res get path getpath resolver create members resource membersresource resource util resourceutil create unique child name createuniquechildname members resource membersresource res get name getname properties log debug member resource collection string res get path getpath resource get path getpath inherit doc inheritdoc iterator resource get resources getresources value map valuemap members resource membersresource adapt to adaptto value map valuemap string references resource collection constants resourcecollectionconstants references prop string list resource resources array list arraylist resource string path references resource resource resolver get resource getresource path resource resources add resource resources iterator returns sling resource type content node collection param code sling resource type resourcetype code collection resource string get type gettype resource get resource type getresourcetype inherit doc inheritdoc resource res res value map valuemap members resource membersresource adapt to adaptto value map valuemap string order resource collection constants resourcecollectionconstants references prop string array utils arrayutils index of indexof order res get path getpath inherit doc inheritdoc remove resource res persistence exception persistenceexception remove resource resource tobe removed res toberemovedres find res findres res tobe removed res toberemovedres resolver delete tobe removed res toberemovedres remove order array modifiable value map modifiablevaluemap members resource membersresource adapt to adaptto modifiable value map modifiablevaluemap string order resource collection constants resourcecollectionconstants references prop string array utils arrayutils index of indexof order res get path getpath order string array utils arrayutils remove order resource collection constants resourcecollectionconstants references prop order sets sling resource type content node collection param type code sling resource type resourcetype code content node set type settype string type persistence exception persistenceexception modifiable value map modifiablevaluemap mvp resource adapt to adaptto modifiable value map modifiablevaluemap mvp resource type type resource find res findres resource res res string res name resname res get name getname members resource membersresource get child getchild res name resname res get path getpath equals resource util resourceutil get value map getvaluemap members resource membersresource get child getchild res name resname resource collection constants resourcecollectionconstants property members resource membersresource get child getchild res name resname handle multiple res paths iterator resource children members resource membersresource list children listchildren children has next hasnext resource children resource util resourceutil get value map getvaluemap resource collection constants resourcecollectionconstants property equals res get path getpath order before orderbefore resource src resource srcresource resource dest resource destresource src resource srcresource illegal argument exception illegalargumentexception source resource modifiable value map modifiablevaluemap members resource membersresource adapt to adaptto modifiable value map modifiablevaluemap string order resource collection constants resourcecollectionconstants references prop string string src path srcpath src resource srcresource get path getpath src index srcindex array utils arrayutils index of indexof order src path srcpath src index srcindex log warn collection ordering failed resource collection dest resource destresource src path srcpath get path getpath dest resource destresource add order string array utils arrayutils remove order src index srcindex order string array utils arrayutils add order src path srcpath string dest path destpath dest resource destresource get path getpath dest path destpath equals src path srcpath string message message format messageformat format collection ordering failed source destination src path srcpath dest path destpath log error message illegal argument exception illegalargumentexception message dest index destindex array utils arrayutils index of indexof order dest path destpath dest index destindex log warn collection ordering failed resource collection dest resource destresource dest path destpath get path getpath order string array utils arrayutils remove order src index srcindex rec alculate recalculate dest src index srcindex dest index destindex dest index destindex array utils arrayutils index of indexof order dest path destpath order string array utils arrayutils add order dest index destindex src path srcpath resource collection constants resourcecollectionconstants references prop order modifiable value map modifiablevaluemap get properties getproperties resource resource iterator resource entries members resource membersresource list children listchildren entries has next hasnext resource entry entries string path resource util resourceutil get value map getvaluemap entry resource collection constants resourcecollectionconstants property resource get path getpath equals path entry adapt to adaptto modifiable value map modifiablevaluemap
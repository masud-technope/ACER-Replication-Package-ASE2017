licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling ftpserver impl java file java file input stream fileinputstream java file output stream fileoutputstream java filter output stream filteroutputstream java io exception ioexception java input stream inputstream org apache ftpserver util io utils ioutils org apache sling api resource modifiable value map modifiablevaluemap org apache sling api resource resource sling ftp output stream slingftpoutputstream filter output stream filteroutputstream resource content file tmp file tmpfile sling ftp output stream slingftpoutputstream resource content io exception ioexception content sling ftp output stream slingftpoutputstream resource content append io exception ioexception content content tmp file tmpfile file create temp file createtempfile sling ftp slingftp upload tmp uploadtmp file output stream fileoutputstream tmp file tmpfile append input stream inputstream source content adapt to adaptto input stream inputstream source io utils ioutils copy source source close source close io exception ioexception failed preparing existing file data override close io exception ioexception input stream inputstream ins close modifiable value map modifiablevaluemap map content adapt to adaptto modifiable value map modifiablevaluemap map ins file input stream fileinputstream tmp file tmpfile map jcr last modified lastmodified system current time millis currenttimemillis map jcr data ins content get resource resolver getresourceresolver commit ins ins close io exception ioexception ignore tmp file tmpfile delete
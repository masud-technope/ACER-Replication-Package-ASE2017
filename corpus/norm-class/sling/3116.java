licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling api servlets java i o exception ioexception java output stream writer outputstreamwriter java print writer printwriter java unsupported encoding exception unsupportedencodingexception java lang reflect method java lang reflect modifier java util enumeration java util hash map hashmap java util map javax annotation nonnull javax servlet generic servlet genericservlet javax servlet servlet exception servletexception javax servlet servlet output stream servletoutputstream javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet response httpservletresponse org apache sling api sling http servlet request slinghttpservletrequest org apache sling api sling http servlet response slinghttpservletresponse org apache sling api wrappers sling http servlet response wrapper slinghttpservletresponsewrapper helper base read servlets sling base implementation servlet api http servlet httpservlet accounts ext ensibility extensibility extensions great control methods overwrite http methods implemented overwrite res pective respective doxxx method additional methods supported implement doxxx methods overwrite link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method dispatch doxxx methods overwrite link get allowed request methods getallowedrequestmethods map add method names not e note base intended applications data read servlet support post delete methods extensions overwrite doxxx methods add support read methods app lications applications wishing support data modification extend link sling all methods servlet slingallmethodsservlet support post delete methods overwritten add support http methods modifying data impl ementors implementors not e note methods declared exceptions int entions intentions servlet api throwing sling runtime exception runtimeexception counter parts ease int egration integration traditional servlets sling all methods servlet slingallmethodsservlet sling safe methods servlet slingsafemethodsservlet generic servlet genericservlet serialversionuid handles head method base implementation calls link do get doget sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method dropping output impl ementations implementations overwrite method performing implementation base implementation param request http request param response http response headers servlet exception servletexception for warded forwarded link do get doget sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method called implementation i o exception ioexception for warded forwarded link do get doget sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method called implementation do head dohead nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception output wrapper no body response nobodyresponse wrapped response wrappedresponse no body response nobodyresponse response normal request dropping output do get doget request wrapped response wrappedresponse ensure content length gathered output wrapped response wrappedresponse set content length setcontentlength called link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method handle http request implementation reports client method supported impl ementations implementations overwrite method implementation http method support param request http request param response http response servlet exception servletexception thrown implementation i o exception ioexception error status reported client suppress warnings suppresswarnings unused do get doget nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception handle method not impl emented handlemethodnotimplemented request response handles options method setting http code code header response depending methods declared extensions generally overwrite method link get allowed request methods getallowedrequestmethods map method method gathers declared methods concrete upto including calls link get allowed request methods getallowedrequestmethods map method methods gathered returned code code header param request http request object param response http response object header servlet exception servletexception thrown implementation i o exception ioexception thrown implementation suppress warnings suppresswarnings unused do options dooptions nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception map string method methods get all declared methods getalldeclaredmethods get class getclass string buffer stringbuffer allow buf allowbuf get allowed request methods getallowedrequestmethods methods response set header setheader allow buf allowbuf to string tostring handles trace method returning list header values response body extensions generally overwrite method trace method param request http request headers returned param response http response request headers written servlet exception servletexception thrown implementation i o exception ioexception thrown problem sending request headers response stream suppress warnings suppresswarnings unused do trace dotrace nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception string crlf string buffer stringbuffer response string responsestring string buffer stringbuffer response string responsestring append trace append request getrequesturi response string responsestring append append request get protocol getprotocol enumeration req header enum reqheaderenum request get header names getheadernames req header enum reqheaderenum has more elements hasmoreelements string header name headername string req header enum reqheaderenum next element nextelement enumeration req header val enum reqheadervalenum request get headers getheaders header name headername req header val enum reqheadervalenum has more elements hasmoreelements response string responsestring append crlf response string responsestring append header name headername append response string responsestring append req header val enum reqheadervalenum next element nextelement response string responsestring append crlf string charset utf raw response rawresponse response string responsestring to string tostring get bytes getbytes charset response length responselength raw response rawresponse length response set content type setcontenttype message http response set character encoding setcharacterencoding charset response set content length setcontentlength response length responselength servlet output stream servletoutputstream response get output stream getoutputstream write raw response rawresponse called link service sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method handle request http method handled extension implementation reports client method supported method overwritten great care overwrite link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method add support extension http methods additional doxxx method param request http request param response http response servlet exception servletexception thrown implementation i o exception ioexception error status reported client suppress warnings suppresswarnings unused do generic dogeneric nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception handle method not impl emented handlemethodnotimplemented request response handle request calling java method implemented res pective respective http request method base impl entation implentation dispatches head options trace res pective respective doxxx methods returns code code methods requested code code returned impl ementations implementations overwrite method call base implementation code code returned add handling method requested method param request http request param response http response code code requested method code request get method getmethod code code code returned servlet exception servletexception for warded forwarded dispatched methods i o exception ioexception for warded forwarded dispatched methods may service mayservice nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception assume method method known methodknown string method request get method getmethod http constants httpconstants method head equals method do head dohead request response http constants httpconstants method equals method do get doget request response http constants httpconstants method options equals method do options dooptions request response http constants httpconstants method trace equals method do trace dotrace request response method method known methodknown knew request method method known methodknown helper method http response unhandled http request method http status code method allowed returned status bad request returned param request http request method protocol values extracted build message param response http response error status i o exception ioexception thrown status client handle method not impl emented handlemethodnotimplemented nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response i o exception ioexception string protocol request get protocol getprotocol string msg method request get method getmethod supported protocol ends with endswith http method allowed response send error senderror http servlet response httpservletresponse method all owed allowed msg bad request response send error senderror http servlet response httpservletresponse bad request msg called link service servlet request servletrequest servlet response servletresponse method handle http request implementation calls link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method dep edending depedending call link do generic dogeneric sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method handle request link do generic dogeneric sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method called called impl ementations implementations generally overwrite method link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method overwritten add support http methods param request http request param response http response servlet exception servletexception for warded forwarded link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse link do generic dogeneric sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse methods i o exception ioexception for warded forwarded link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse link do generic dogeneric sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse methods service nonnull sling http servlet request slinghttpservletrequest request nonnull sling http servlet response slinghttpservletresponse response servlet exception servletexception i o exception ioexception handle request methods method known methodknown may service mayservice request response handle method known methodknown do generic dogeneric request response for war ds forwards request link service sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method request http request impl ementations implementations generally overwrite method param req servlet request param res servlet response servlet exception servletexception request http request for warded forwarded link service sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse called i o exception ioexception for warded forwarded link service sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse called service nonnull servlet request servletrequest req nonnull servlet response servletresponse res servlet exception servletexception i o exception ioexception req sling http servlet request slinghttpservletrequest res sling http servlet response slinghttpservletresponse service sling http servlet request slinghttpservletrequest req sling http servlet response slinghttpservletresponse res servlet exception servletexception sling http request response returns simple servlet extensions overwrite specific nonnull string get servlet info getservletinfo get class getclass get simple name getsimplename helper method called link do options dooptions sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse calculate header response http options request base implementation checks doxxx methods exist head returns list methods supported list returned includes http options trace methods impl ementations implementations overwrite method check methods supported extension generally list link may service mayservice sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method base implementation called http methods included list param declared methods declaredmethods methods declared extension code string buffer stringbuffer code list http methods supported string buffer stringbuffer get allowed request methods getallowedrequestmethods map string method declared methods declaredmethods string buffer stringbuffer allow buf allowbuf string buffer stringbuffer options trace supported servlet allow buf allowbuf append http constants httpconstants method options allow buf allowbuf append append http constants httpconstants method trace add method names depending methods declared methods declaredmethods contains key containskey do head dohead declared methods declaredmethods contains key containskey do get doget allow buf allowbuf append append http constants httpconstants method head declared methods declaredmethods contains key containskey do get doget allow buf allowbuf append append http constants httpconstants method allow buf allowbuf append append http constants httpconstants method head allow buf allowbuf returns map methods declared indexed method method called link do options dooptions sling http servlet request slinghttpservletrequest sling http servlet response slinghttpservletresponse method find methods checked link get allowed request methods getallowedrequestmethods map method note extension classes considered account implementations doxxx methods param code code declared methods map methods considered support checking map string method get all declared methods getalldeclaredmethods include abstract sling servlet class abstractslingservletclass get name getname equals sling safe methods servlet slingsafemethodsservlet get name getname hash map hashmap string method declared methods base map string method method set methodset get all declared methods getalldeclaredmethods get superclass getsuperclass add declared methods overwrite base methods method declared methods declaredmethods get declared methods getdeclaredmethods method method declared methods declaredmethods methods modifier is protected isprotected method get modifiers getmodifiers modifier is public ispublic method get modifiers getmodifiers method set methodset method get name getname method method set methodset response includes body dumb head support swallows body counting bytes order content length app ropriately appropriately no body response nobodyresponse sling http servlet response wrapper slinghttpservletresponsewrapper sink counter no body output stream nobodyoutputstream optional writer sink print writer printwriter writer request processor content length did set content length didsetcontentlength no body response nobodyresponse sling http servlet response slinghttpservletresponse wrapped response wrappedresponse wrapped response wrappedresponse no body output stream nobodyoutputstream called request processing ensure content length processor length method number bytes written output response set content length setcontentlength did set content length didsetcontentlength set content length setcontentlength get content length getcontentlength overwrite prevent setting content length request link set content length setcontentlength set content length setcontentlength len set content length setcontentlength len did set content length didsetcontentlength output stream don check writer acquired servlet output stream servletoutputstream get output stream getoutputstream writer output stream don check output str am stram acquired print writer printwriter get writer getwriter unsupported encoding exception unsupportedencodingexception writer output stream writer outputstreamwriter output stream writer outputstreamwriter get character encoding getcharacterencoding writer print writer printwriter writer simple servlet output stream servletoutputstream write counts bytes written no body response nobodyresponse no body output stream nobodyoutputstream servlet output stream servletoutputstream content length contentlength number bytes written stream get content length getcontentlength content length contentlength write content length contentlength write buf offset len len content length contentlength len index out of bounds exception indexoutofboundsexception
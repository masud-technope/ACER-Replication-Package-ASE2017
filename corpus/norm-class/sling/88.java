licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling rewriter impl java io exception ioexception java print writer printwriter java util array list arraylist java util collections java util comparator java util dictionary java util hash map hashmap java util hashtable java util iterator java util list java util map org apache felix scr annotations component org apache felix scr annotations reference org apache felix scr annotations service org apache sling api sling constants slingconstants org apache sling api sling exception slingexception org apache sling api resource login exception loginexception org apache sling api resource resource org apache sling api resource resource resolver resourceresolver org apache sling api resource resource resolver factory resourceresolverfactory org apache sling rewriter pipeline configuration pipelineconfiguration org apache sling rewriter processing context processingcontext org apache sling rewriter processor org apache sling rewriter processor configuration processorconfiguration org apache sling rewriter processor manager processormanager org osgi framework bundle context bundlecontext org osgi framework invalid syntax exception invalidsyntaxexception org osgi framework service registration serviceregistration org osgi service component component context componentcontext org osgi service event event handler eventhandler org slf logger org slf logger factory loggerfactory manager track configured processors component service processor manager processormanager processor manager impl processormanagerimpl processor manager processormanager event handler eventhandler string config rel path config rewriter string config path config rel path string mime type html text html logger logger log logger factory loggerfactory get logger getlogger get class getclass bundle context bundle context bundlecontext bundle context bundlecontext reference resource resolver factory resourceresolverfactory resource resolver factory resourceresolverfactory resource resolver resource resolver resourceresolver resource resolver resourceresolver loaded processor configuration ss configurationss map string config entry configentry processors hash map hashmap string config entry configentry ordered processor configs list processor configuration processorconfiguration ordered processors orderedprocessors array list arraylist processor configuration processorconfiguration event handler registration service registration serviceregistration event handler registration eventhandlerregistration search paths string search paths searchpaths factory cache factory cache factorycache factory cache factorycache activate component param ctx activate component context componentcontext ctx login exception loginexception invalid syntax exception invalidsyntaxexception bundle context bundlecontext ctx get bundle context getbundlecontext factory cache factorycache factory cache factorycache bundle context bundlecontext create array search paths actions constraints resource resolver resourceresolver resource resolver factory resourceresolverfactory get administrative resource resolver getadministrativeresourceresolver search paths searchpaths resource resolver resourceresolver get search path getsearchpath init processors initprocessors register event handler dictionary string object props hashtable string object props event topics string org apache sling api resource resource org apache sling api resource resource provider resourceprovider props service description processor configuration modification handler props service vendor apache software foundation event handler registration eventhandlerregistration ctx get bundle context getbundlecontext register service registerservice event handler eventhandler get name getname props factory cache factorycache start web console config printer webconsoleconfigprinter register bundle context bundlecontext deactivate component param ctx deactivate component context componentcontext ctx event handler registration eventhandlerregistration event handler registration eventhandlerregistration unregister event handler registration eventhandlerregistration factory cache factorycache factory cache factorycache resource resolver resourceresolver resource resolver resourceresolver close resource resolver resourceresolver web console config printer webconsoleconfigprinter unregister bundle context bundlecontext org osgi service event event handler eventhandler handle event handleevent org osgi service event event handle event handleevent org osgi service event event event check event handles search paths string path string event get property getproperty sling constants slingconstants property path found pos foundpos string s path spath search paths searchpaths path starts with startswith s path spath found pos foundpos s path spath length found pos foundpos check rewriter config relative path search path first slash firstslash path index of indexof found pos foundpos pattern path index of indexof config path found pos foundpos first slash firstslash pattern position migt rewriter config first slash firstslash pattern first slash firstslash node child config path path length pattern config path length path char at charat pattern config path length child resource changed correct path slash pos slashpos path index of indexof pattern config path length slash pos slashpos path path substring slash pos slashpos update async don block event delivery string config path configpath path thread thread event get topic gettopic equals sling constants slingconstants topic resource removed remove processor removeprocessor config path configpath update processor updateprocessor config path configpath start initializes current processors init processors initprocessors string path search paths searchpaths check search path exists resource sp resource spresource resource resolver resourceresolver get resource getresource path substring path length sp resource spresource iter ate iterate child nodes iterator resource sp iter spiter sp resource spresource list children listchildren sp iter spiter has next hasnext check node rewriter config resource app resource appresource sp iter spiter resource parent resource parentresource resource resolver resourceresolver get resource getresource app resource appresource get path getpath config path parent resource parentresource read configs iterator resource iter parent resource parentresource list children listchildren iter has next hasnext resource config resource configresource iter string key config resource configresource get name getname processor configuration impl processorconfigurationimpl config get processor configuration getprocessorconfiguration config resource configresource log debug processor configuration config add processor addprocessor key config resource configresource get path getpath config read configuration processor repository processor configuration impl processorconfigurationimpl get processor configuration getprocessorconfiguration resource config resource configresource processor configuration impl processorconfigurationimpl config processor configuration impl processorconfigurationimpl config resource configresource config adds processor configuration add processor addprocessor string key string config path configpath processor configuration impl processorconfigurationimpl config config entry configentry configs processors key configs configs config entry configentry configs config entry configentry config path configpath config config entry configentry new configs newconfigs config entry configentry configs length system arraycopy configs new configs newconfigs configs length new configs newconfigs configs length config entry configentry config path configpath config processors key configs add active configurations config is active isactive ordered processors orderedprocessors add config collections sort ordered processors orderedprocessors processor configurator comparator processorconfiguratorcomparator print configuration printconfiguration print writer printwriter config entry configentry entry entry config processor configuration impl processorconfigurationimpl processor configuration impl processorconfigurationimpl entry config print configuration printconfiguration println entry config to string tostring print resource path println entry path print configuration printconfiguration print writer printwriter println current apache sling rewriter configuration println println active configurations println process configs order processor configuration processorconfiguration config ordered processors orderedprocessors search full config map entry string config entry configentry entry processors entry set entryset entry get value getvalue length entry get value getvalue config config print configuration println entry get key getkey println print configuration printconfiguration entry get value getvalue entry get value getvalue length println overriding configurations resource paths entry get value getvalue length print println entry get value getvalue path println println updates processor update processor updateprocessor string path pos path last index of lastindexof string key path substring pos key index keyindex search search path string search path searchpath search paths searchpaths path starts with startswith search path searchpath key index keyindex resource config resource configresource resource resolver resourceresolver get resource getresource path config resource configresource processor configuration impl processorconfigurationimpl config get processor configuration getprocessorconfiguration config resource configresource config entry configentry configs processors key configs search path configs length configs path equals path array remove add ordered processors orderedprocessors remove configs config configs config entry configentry path config config is active isactive ordered processors orderedprocessors add config collections sort ordered processors orderedprocessors processor configurator comparator processorconfiguratorcomparator simply exc hange exchange configs config entry configentry path config insert config correct place insert index insertindex insert index insertindex configs length config entry configentry current configs insert index insertindex current index currentindex search paths searchpaths length current path starts with startswith search paths searchpaths current index currentindex current index currentindex key index keyindex insert index insertindex current index currentindex append add processor addprocessor key path config config entry configentry new array newarray config entry configentry configs length config entry configentry current configs insert index insertindex new array newarray config entry configentry path config new array newarray current processors key new array newarray insert index insertindex remove add ordered processors orderedprocessors remove configs config config is active isactive ordered processors orderedprocessors add config collections sort ordered processors orderedprocessors processor configurator comparator processorconfiguratorcomparator comp letly completly add add processor addprocessor key path config removes pipeline remove processor removeprocessor string path pos path last index of lastindexof string key path substring pos search config config entry configentry configs processors key configs search path config entry configentry config entry configentry current configs current path equals path current ordered processors orderedprocessors remove config configs length processors remove key configs ordered processors orderedprocessors add configs config collections sort ordered processors orderedprocessors processor configurator comparator processorconfiguratorcomparator config entry configentry new array newarray config entry configentry configs length config entry configentry current configs current new array newarray current processors key new array newarray org apache sling rewriter processor manager processormanager get processor getprocessor org apache sling rewriter processor configuration processorconfiguration org apache sling rewriter processing context processingcontext processor get processor getprocessor processor configuration processorconfiguration configuration processing context processingcontext context configuration illegal argument exception illegalargumentexception processor configuration missing context illegal argument exception illegalargumentexception processor context missing is pipeline ispipeline configuration processor configuration impl processorconfigurationimpl is pipeline ispipeline processor configuration impl processorconfigurationimpl configuration is pipeline ispipeline is pipeline ispipeline configuration pipeline configuration pipelineconfiguration is pipeline ispipeline pipeline impl pipelineimpl pipeline pipeline impl pipelineimpl factory cache factorycache pipeline init context configuration pipeline processor processor processor wrapper processorwrapper configuration factory cache factorycache processor init context configuration processor io exception ioexception ioe sling exception slingexception unable setup processor ioe get message getmessage ioe org apache sling rewriter processor manager processormanager get processor configurations getprocessorconfigurations list processor configuration processorconfiguration get processor configurations getprocessorconfigurations ordered processors orderedprocessors processor configurator comparator processorconfiguratorcomparator comparator processor configuration processorconfiguration java util comparator compare java lang object java lang object compare processor configuration processorconfiguration config processor configuration processorconfiguration config processor configuration impl processorconfigurationimpl config get order getorder processor configuration impl processorconfigurationimpl config get order getorder config entry configentry string path processor configuration processorconfiguration config config entry configentry string processor configuration processorconfiguration path config
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling xss impl java string reader stringreader java util regex matcher java util regex pattern javax annotation nonnull javax xml parsers sax parser saxparser javax xml parsers sax parser factory saxparserfactory org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations deactivate org apache felix scr annotations reference org apache felix scr annotations service org apache sling api sling http servlet request slinghttpservletrequest org apache sling api resource resource resolver resourceresolver org apache sling commons json json array jsonarray org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling xss protection context protectioncontext org apache sling xss xssapi org apache sling xss xss filter xssfilter org owasp encoder encode org owasp esapi esapi org owasp esapi validator org slf logger org slf logger factory loggerfactory org xml sax input source inputsource org xml sax xml reader xmlreader component service xssapi xssapi impl xssapiimpl xssapi logger logger logger factory loggerfactory get logger getlogger xssapi impl xssapiimpl reference xss filter xssfilter xss filter xssfilter validator validator esapi validator pattern pattern auto dimension pattern compile auto sax parser factory saxparserfactory factory activate suppress warnings suppresswarnings unused activate factory sax parser factory saxparserfactory new instance newinstance factory set valid ating setvalidating factory set name space aware setnamespaceaware deactivate suppress warnings suppresswarnings unused deactivate factory valid ators validators org apache sling xss xssapi get valid integer getvalidinteger string override integer get valid integer getvalidinteger string int eger integer default value defaultvalue int eger integer int eger integer length validator get valid integer getvalidinteger xss int eger integer exception fall empty validation failure default value defaultvalue org apache sling xss xssapi get valid long getvalidlong string override get valid long getvalidlong string source default value defaultvalue source source length long validation rule longvalidationrule ivr long validation rule longvalidationrule number esapi encoder ivr set allow null setallownull ivr get valid getvalid xss source exception fall empty validation failure default value defaultvalue org apache sling xss xssapi get valid dimension getvaliddimension string string override string get valid dimension getvaliddimension string dimension string default value defaultvalue dimension dimension length pattern auto dimension matcher dimension matches auto validator get valid integer getvalidinteger xss dimension to string tostring exception fall empty validation failure default value defaultvalue string link prefix href string link suffix string mangle name space namespace suffix string mangle name space namespace pattern mangle name space namespace pattern pattern compile mangle name space namespace string mangle name space namespace suffix string mangle name space namespace prefix string scheme pattern string mangle names paces manglenamespaces string abs path abspath abs path abspath check absolute urls scheme index schemeindex abs path abspath index of indexof scheme pattern string mangle path manglepath string prefix scheme index schemeindex path index pathindex abs path abspath index of indexof scheme index schemeindex path index pathindex prefix abs path abspath substring path index pathindex mangle path manglepath abs path abspath substring path index pathindex prefix abs path abspath mangle path manglepath prefix mangle path manglepath abs path abspath mangle path manglepath mangle name space namespace suffix matcher mangle name space namespace pattern matcher mangle path manglepath string buffer stringbuffer buf string buffer stringbuffer find string replacement mangle name space namespace prefix group mangle name space namespace suffix append replacement appendreplacement buf replacement append tail appendtail buf abs path abspath prefix buf to string tostring abs path abspath org apache sling xss xssapi get valid href getvalidhref string override nonnull string get valid href getvalidhref string url url url length per cent percent encode characters allowed unquoted html attributes space don encode links query parameters string encoded url encodedurl url replace all replaceall replace all replaceall replace all replaceall replace all replaceall replace all replaceall replace all replaceall q mark ix qmarkix encoded url encodedurl index of indexof q mark ix qmarkix encoded url encodedurl encoded url encodedurl substring q mark ix qmarkix encoded url encodedurl substring q mark ix qmarkix replace all replaceall encoded url encodedurl mangle names paces manglenamespaces encoded url encodedurl xss filter xssfilter is valid href isvalidhref encoded url encodedurl encoded url encodedurl fall empty string org apache sling xss xssapi getvalidjstoken string string override string getvalidjstoken string token string default value defaultvalue token token length token token trim string token substring matches token ends with endswith string literal token substring token length encodeforjsstring literal token matches token fall default value defaultvalue string ascii http org css syntax number token diagram string number http org css syntax hex digit diagram string hex digits http org css syntax ident token diagram string identifier ascii ascii http org css syntax string token diagram string string java script javascript java script javascript http org css syntax dimension token diagram string dimension number identifier http org css syntax per centage percentage token diagram string per cent percent number http org css syntax function token diagram string function identifier number identifier http org css syntax url unquoted diagram string url unquoted ascii http org css syntax url token diagram string url url url unquoted string composite regular expression style token validation string css token insensitive number dimension per cent percent hex digits identifier string function url org apache sling xss xssapi get valid style token getvalidstyletoken string string override string get valid style token getvalidstyletoken string token string default value defaultvalue token token length token matches css token token default value defaultvalue org apache sling xss xssapi getvalidcsscolor string string override string getvalidcsscolor string color string default color defaultcolor color color length color color trim avoid security impl ications implications including characters required colors hex functional notation critical characters disallowed expression url semi colon escaping context color color matches fghlrs color named color values color matches color default color defaultcolor org apache sling xss xssapi get valid multi line comment getvalidmultilinecomment string string override string get valid multi line comment getvalidmultilinecomment string comment string default comment defaultcomment comment comment comment default comment defaultcomment org apache sling xss xssapi getvalidjson string string override string getvalidjson string json string default json defaultjson json getvalidjson default json defaultjson json json trim equals json curly ix curlyix json index of indexof str aight ix straightix json index of indexof curly ix curlyix curly ix curlyix str aight ix straightix str aight ix straightix json object jsonobject obj json object jsonobject json obj to string tostring json exception jsonexception logger debug json validation failed get message getmessage json array jsonarray arr json array jsonarray json arr to string tostring json exception jsonexception logger debug json validation failed get message getmessage getvalidjson default json defaultjson org apache sling xss xssapi getvalidxml string string override string getvalidxml string xml string default xml defaultxml xml getvalidxml default xml defaultxml xml xml trim equals xml sax parser saxparser parser factory newsaxparser xml reader xmlreader reader parser getxmlreader reader parse input source inputsource string reader stringreader xml xml exception logger debug xml validation failed get message getmessage getvalidxml default xml defaultxml encoders org apache sling xss xssapi encodeforhtml string override string encodeforhtml string source source encode for html forhtml source org apache sling xss xssapi encodeforhtmlattr string override string encodeforhtmlattr string source source encode for html attribute forhtmlattribute source org apache sling xss xssapi encodeforxml string override string encodeforxml string source source encode for xml forxml source org apache sling xss xssapi encodeforxmlattr string override string encodeforxmlattr string source source encode for xml attribute forxmlattribute source org apache sling xss xssapi encodeforjsstring string override string encodeforjsstring string source source encode for java script forjavascript source org apache sling xss xssapi encodeforcssstring string override string encodeforcssstring string source source encode for css string forcssstring source filters org apache sling xss xssapi filterhtml string override nonnull string filterhtml string source xss filter xssfilter filter protection context protectioncontext html html content source jcr name space namespace mangling org apache sling xss xssapi get request specific i getrequestspecificapi org apache sling api sling http servlet request slinghttpservletrequest override xssapi get request specific i getrequestspecificapi sling http servlet request slinghttpservletrequest request org apache sling xss xssapi get resource resolver specific i getresourceresolverspecificapi org apache sling api resource resource resolver resourceresolver override xssapi get resource resolver specific i getresourceresolverspecificapi resource resolver resourceresolver resource resolver resourceresolver
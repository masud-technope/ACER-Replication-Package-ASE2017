licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling launchpad webapp int egrationtest integrationtest access manager accessmanager org junit assert equals assertequals org junit assert not null assertnotnull java io exception ioexception java util array list arraylist java util hash set hashset java util list java util random java util javax servlet http http servlet response httpservletresponse org apache commons http client httpclient credentials org apache commons http client httpclient name value pair namevaluepair org apache commons http client httpclient username password credentials usernamepasswordcredentials org apache sling commons json json exception jsonexception org apache sling commons json json object jsonobject org apache sling commons testing int egration integration http test httptest org apache sling servlets post sling post constants slingpostconstants org junit org junit org junit test access privileges info test accessprivilegesinfotest random random random system current time millis currenttimemillis string test user id testuserid string test group id testgroupid string test folder url testfolderurl string to delete todelete hash set hashset string access manager test util accessmanagertestutil access manager test util accessmanagertestutil setup exception set up setup script server side privilege info privilegeinfo cal culations calculations string script path scriptpath apps unstructured get test client gettestclient mkdirs http test httptest webdav base url script path scriptpath to delete todelete add upload test script uploadtestscript script path scriptpath access manager accessmanager privileges info json esp privileges info json esp cleanup exception tear down teardown credentials creds username password credentials usernamepasswordcredentials admin admin test folder url testfolderurl remove test user exists string post url posturl test folder url testfolderurl list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair operation delete assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams test group id testgroupid remove test user exists string post url posturl http test httptest http base url system user manager usermanager group test group id testgroupid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams test user id testuserid remove test user exists string post url posturl http test httptest http base url system user manager usermanager user test user id testuserid delete html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair assert authenticated post status assertauthenticatedpoststatus creds post url posturl http servlet response httpservletresponse post params postparams string script to delete todelete get test client gettestclient delete script test user testuser granted read denied write test test denied write for user testdeniedwriteforuser io exception ioexception json exception jsonexception test user id testuserid create test user createtestuser test folder url testfolderurl create test folder createtestfolder assign privileges string post url posturl test folder url testfolderurl modify ace modifyace html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test user id testuserid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr read access control readaccesscontrol granted post params postparams add name value pair namevaluepair privilege jcr write denied credentials admin creds admincreds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus admin creds admincreds post url posturl http servlet response httpservletresponse post params postparams string get url geturl test folder url testfolderurl privileges info json fetch json test verify settings credentials test user creds testusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated content getauthenticatedcontent test user creds testusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals json obj jsonobj get boolean getboolean can add children canaddchildren assert equals assertequals json obj jsonobj get boolean getboolean can delete children candeletechildren assert equals assertequals json obj jsonobj get boolean getboolean can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can modify properties canmodifyproperties assert equals assertequals json obj jsonobj get boolean getboolean can read access control canreadaccesscontrol assert equals assertequals json obj jsonobj get boolean getboolean can modify access control canmodifyaccesscontrol test user testuser granted read granted write test test granted write for user testgrantedwriteforuser io exception ioexception json exception jsonexception test user id testuserid create test user createtestuser test folder url testfolderurl create test folder createtestfolder assign privileges string post url posturl test folder url testfolderurl modify ace modifyace html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test user id testuserid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr write granted post params postparams add name value pair namevaluepair privilege jcr read access control readaccesscontrol granted post params postparams add name value pair namevaluepair privilege jcr modify access control modifyaccesscontrol granted credentials admin creds admincreds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus admin creds admincreds post url posturl http servlet response httpservletresponse post params postparams string get url geturl test folder url testfolderurl privileges info json fetch json test verify settings credentials test user creds testusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated content getauthenticatedcontent test user creds testusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals json obj jsonobj get boolean getboolean can add children canaddchildren assert equals assertequals json obj jsonobj get boolean getboolean can delete children candeletechildren parent node jcr remove children removechildren granted can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can modify properties canmodifyproperties assert equals assertequals json obj jsonobj get boolean getboolean can read access control canreadaccesscontrol assert equals assertequals json obj jsonobj get boolean getboolean can modify access control canmodifyaccesscontrol add child node verify can delete candelete string child folder url childfolderurl get test client gettestclient create node createnode test folder url testfolderurl test folder testfolder random next int nextint sling post constants slingpostconstants create suffix string child post url childposturl child folder url childfolderurl modify ace modifyace html post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test user id testuserid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr remove node removenode granted assert authenticated post status assertauthenticatedpoststatus admin creds admincreds child post url childposturl http servlet response httpservletresponse post params postparams string child get url childgeturl child folder url childfolderurl privileges info json string child json childjson get authenticated content getauthenticatedcontent test user creds testusercreds child get url childgeturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull child json childjson json object jsonobject child json obj childjsonobj json object jsonobject child json childjson assert equals assertequals child json obj childjsonobj get boolean getboolean can delete candelete group test user testuser granted read denied write test test denied write for group testdeniedwriteforgroup io exception ioexception json exception jsonexception test group id testgroupid create test group createtestgroup test user id testuserid create test user createtestuser test folder url testfolderurl create test folder createtestfolder credentials admin creds admincreds username password credentials usernamepasswordcredentials admin admin add test user id testuserid test group testgroup string group post url groupposturl http test httptest http base url system user manager usermanager group test group id testgroupid update html list name value pair namevaluepair group post params grouppostparams array list arraylist name value pair namevaluepair group post params grouppostparams add name value pair namevaluepair member test user id testuserid assert authenticated post status assertauthenticatedpoststatus admin creds admincreds group post url groupposturl http servlet response httpservletresponse group post params grouppostparams assign privileges string post url posturl test folder url testfolderurl modify ace modifyace html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test group id testgroupid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr read access control readaccesscontrol granted post params postparams add name value pair namevaluepair privilege jcr write denied assert authenticated post status assertauthenticatedpoststatus admin creds admincreds post url posturl http servlet response httpservletresponse post params postparams string get url geturl test folder url testfolderurl privileges info json fetch json test verify settings credentials test user creds testusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated content getauthenticatedcontent test user creds testusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals json obj jsonobj get boolean getboolean can add children canaddchildren assert equals assertequals json obj jsonobj get boolean getboolean can delete children candeletechildren assert equals assertequals json obj jsonobj get boolean getboolean can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can modify properties canmodifyproperties assert equals assertequals json obj jsonobj get boolean getboolean can read access control canreadaccesscontrol assert equals assertequals json obj jsonobj get boolean getboolean can modify access control canmodifyaccesscontrol group test user testuser granted read granted write test test granted write for group testgrantedwriteforgroup io exception ioexception json exception jsonexception test group id testgroupid create test group createtestgroup test user id testuserid create test user createtestuser test folder url testfolderurl create test folder createtestfolder credentials admin creds admincreds username password credentials usernamepasswordcredentials admin admin add test user id testuserid test group testgroup string group post url groupposturl http test httptest http base url system user manager usermanager group test group id testgroupid update html list name value pair namevaluepair group post params grouppostparams array list arraylist name value pair namevaluepair group post params grouppostparams add name value pair namevaluepair member test user id testuserid assert authenticated post status assertauthenticatedpoststatus admin creds admincreds group post url groupposturl http servlet response httpservletresponse group post params grouppostparams assign privileges string post url posturl test folder url testfolderurl modify ace modifyace html list name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test group id testgroupid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr write granted post params postparams add name value pair namevaluepair privilege jcr read access control readaccesscontrol granted post params postparams add name value pair namevaluepair privilege jcr modify access control modifyaccesscontrol granted assert authenticated post status assertauthenticatedpoststatus admin creds admincreds post url posturl http servlet response httpservletresponse post params postparams string get url geturl test folder url testfolderurl privileges info json fetch json test verify settings credentials test user creds testusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated content getauthenticatedcontent test user creds testusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals json obj jsonobj get boolean getboolean can add children canaddchildren assert equals assertequals json obj jsonobj get boolean getboolean can delete children candeletechildren parent node jcr remove children removechildren granted can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can delete candelete assert equals assertequals json obj jsonobj get boolean getboolean can modify properties canmodifyproperties assert equals assertequals json obj jsonobj get boolean getboolean can read access control canreadaccesscontrol assert equals assertequals json obj jsonobj get boolean getboolean can modify access control canmodifyaccesscontrol add child node verify can delete candelete string child folder url childfolderurl get test client gettestclient create node createnode test folder url testfolderurl test folder testfolder random next int nextint sling post constants slingpostconstants create suffix string child post url childposturl child folder url childfolderurl modify ace modifyace html post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test group id testgroupid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr remove node removenode granted assert authenticated post status assertauthenticatedpoststatus admin creds admincreds child post url childposturl http servlet response httpservletresponse post params postparams string child get url childgeturl child folder url childfolderurl privileges info json string child json childjson get authenticated content getauthenticatedcontent test user creds testusercreds child get url childgeturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull child json childjson json object jsonobject child json obj childjsonobj json object jsonobject child json childjson assert equals assertequals child json obj childjsonobj get boolean getboolean can delete candelete test sling test testsling exception test user id testuserid create test user createtestuser grant jcr remove child nodes removechildnodes root node array list arraylist name value pair namevaluepair post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test user id testuserid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr remove child nodes removechildnodes granted credentials admin creds admincreds username password credentials usernamepasswordcredentials admin admin assert authenticated post status assertauthenticatedpoststatus admin creds admincreds http test httptest http base url modify ace modifyace html http servlet response httpservletresponse post params postparams create node child root folder test folder url testfolderurl get test client gettestclient create node createnode http test httptest http base url test folder testfolder random next int nextint sling post constants slingpostconstants create suffix string post url posturl test folder url testfolderurl modify ace modifyace html grant jcr remove node removenode test node post params postparams array list arraylist name value pair namevaluepair post params postparams add name value pair namevaluepair principal id principalid test user id testuserid post params postparams add name value pair namevaluepair privilege jcr read granted post params postparams add name value pair namevaluepair privilege jcr remove node removenode granted assert authenticated post status assertauthenticatedpoststatus admin creds admincreds post url posturl http servlet response httpservletresponse post params postparams fetch json test verify settings string get url geturl test folder url testfolderurl privileges info json credentials test user creds testusercreds username password credentials usernamepasswordcredentials test user id testuserid test pwd testpwd string json get authenticated content getauthenticatedcontent test user creds testusercreds get url geturl http test httptest content type json http servlet response httpservletresponse assert not null assertnotnull json json object jsonobject json obj jsonobj json object jsonobject json assert equals assertequals json obj jsonobj get boolean getboolean can delete candelete
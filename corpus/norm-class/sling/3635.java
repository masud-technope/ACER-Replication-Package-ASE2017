licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling discovery base commons java util array list arraylist java util collection java util java util hash map hashmap java util list java util map java util uuid org apache felix scr annotations activate org apache felix scr annotations deactivate org apache sling api resource resource resolver factory resourceresolverfactory org apache sling commons scheduler scheduler org apache sling discovery base connectors base config baseconfig org apache sling discovery base connectors announcement announcement registry announcementregistry org apache sling discovery base connectors ping connector registry connectorregistry org apache sling launchpad api startup listener startuplistener org apache sling launchpad api startup mode startupmode org apache sling settings sling settings service slingsettingsservice org osgi framework constants org osgi framework service reference servicereference org osgi service component component context componentcontext org slf logger org slf logger factory loggerfactory heartbeat handler responsible capable issuing local remote heartbeats registers periodic job scheduler local heartbeats stored repository remote heartbeats post s posts remote topology connector servlets topologyconnectorservlets base view checker baseviewchecker view checker viewchecker runnable startup listener startuplistener logger logger logger factory loggerfactory get logger getlogger get class getclass endpoint service registration property rfc string reg property end points endpoints osgi http service end points endpoints string property end points endpoints end points endpoints string property sling path sling home path slinghomepath string property runtime runtime id runtimeid period job scheduler string discovery impl heartbeat runner sling local instance string sling id slingid sling runtime id runtimeid unique activation robust duplicate sling detection string runtime id runtimeid lock object sync hronizing synchronizing method object lock object sling avoid heartbeats deactivation activated reference component context component context componentcontext context sling start issuing remote heartbeats startup finished startup finished startupfinished sling force ping inst ructs instructs servlet start backoff scr atch scratch force ping forceping sling store end points endpoints cluster instances clusterinstances verbose duplicate sling id slingid ghost detection map string end points endpoints hash map hashmap string per iodic background job periodicbackgroundjob periodic ping job periodicpingjob info rm inform startup mode startupmode mode finished finished startup finished startupfinished mode sling settings service slingsettingsservice get sling settings service getslingsettingsservice resource resolver factory resourceresolverfactory get resource resolver factory getresourceresolverfactory connector registry connectorregistry get connector registry getconnectorregistry announcement registry announcementregistry get announcement registry getannouncementregistry scheduler get scheduler getscheduler base config baseconfig get connector config getconnectorconfig startup finished startupfinished startup mode startupmode mode lock startup finished startupfinished issue heartbeat issueheartbeat startup progress startupprogress ratio don t dont care activate activate component context componentcontext context lock context context sling id slingid get sling settings service getslingsettingsservice get sling id getslingid discovery connectors common runner sling id slingid do activate doactivate activated do activate doactivate int erval interval get connector config getconnectorconfig get connector ping interval getconnectorpinginterval logger info do activate doactivate starting periodic connector ping connectorping job sling id slingid int erval interval int erval interval periodic ping job periodicpingjob per iodic background job periodicbackgroundjob int erval interval exception logger error do activate doactivate start connector ping connectorping runner logger info do activate doactivate activated sling id slingid sling id slingid deactivate deactivate sling don t dont synchronize deactivate activated logger info deactivate deactivated sling id slingid sling id slingid periodic ping job periodicpingjob periodic ping job periodicpingjob periodic ping job periodicpingjob testing override check view checkview lock do check view docheckview heartbeat and check view heartbeatandcheckview override heartbeat and check view heartbeatandcheckview logger debug heartbeat and check view heartbeatandcheckview start sling id slingid sling id slingid lock activated sling avoid heartbeats activated logger debug heartbeat and check view heartbeatandcheckview activated issue heartbeat issue heartbeat issueheartbeat check view do check view docheckview logger debug heartbeat and check view heartbeatandcheckview sling id slingid sling id slingid trigger iss uance issuance heartbeat asap heartbeat int erval interval trigger async connector ping triggerasyncconnectorping force ping forceping fire job fire job at firejobat fire job firejob job triggered fire job firejob checks job job exist fire job at firejobat pass job unique conflict exist logger info trigger async connector ping triggerasyncconnectorping firing job trigger heartbeat get scheduler getscheduler fire job at firejobat uuid randomuuid system current time millis currenttimemillis exception logger info trigger async connector ping triggerasyncconnectorping trigger heartbeat issue heartbeat action consists updating local properties issuing cluster local heartbeat repository remote heartbeat topology connectors topology issue heartbeat issueheartbeat update properties updateproperties issue connector pings issueconnectorpings update properties updateproperties issue remote heartbeat topology connectors issue connector pings issueconnectorpings get connector registry getconnectorregistry logger error issue connector pings issueconnectorpings connector registry connectorregistry startup finished startupfinished logger debug issue connector pings issueconnectorpings issuing remote heartbeat startup finished logger is debug enabled isdebugenabled logger debug issue connector pings issueconnectorpings pinging out going outgoing topology connectors sling id slingid get connector registry getconnectorregistry ping out going connectors pingoutgoingconnectors force ping forceping force ping forceping check established view matches reality matches heartbeats do check view docheckview check remotes get announcement registry getannouncementregistry logger error announcement registry announcementregistry get announcement registry getannouncementregistry check expired announcements checkexpiredannouncements bind http service bind http service bindhttpservice service reference servicereference reference string endpoint urls endpointurls to string array tostringarray reference get property getproperty reg property end points endpoints endpoint urls endpointurls lock end points endpoints reference get property getproperty constants service endpoint urls endpointurls unbind http service unbind http service unbindhttpservice service reference servicereference reference lock end points endpoints remove reference get property getproperty constants service string to string array tostringarray object prop value propvalue prop value propvalue prop value propvalue string single string string string prop value propvalue prop value propvalue string string string prop value propvalue prop value propvalue get class getclass is array isarray array object value array valuearray object prop value propvalue list string values array list arraylist string value array valuearray length object value array valuearray values add to string tostring values to array toarray string values size prop value propvalue collection collection collection value collection valuecollection collection prop value propvalue list string value list valuelist array list arraylist string value collection valuecollection size object value collection valuecollection value list valuelist add to string tostring value list valuelist to array toarray string value list valuelist size string get end points as string getendpointsasstring string builder stringbuilder string builder stringbuilder string points end points endpoints values string point points append append point to string tostring
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling selector java io exception ioexception java util hash map hashmap java util map javax servlet http http servlet request httpservletrequest javax servlet http http servlet response httpservletresponse org apache felix scr annotations activate org apache felix scr annotations component org apache felix scr annotations modified org apache felix scr annotations properties org apache felix scr annotations property org apache felix scr annotations service org apache sling api authenticator org apache sling core auth util authutil org apache sling core spi abstract authentication handler abstractauthenticationhandler org apache sling core spi authentication info authenticationinfo org apache sling commons osgi osgi util osgiutil org slf logger org slf logger factory loggerfactory code selector authentication handler selectorauthenticationhandler code pseudo authentication handler link request credentials requestcredentials http servlet request httpservletrequest http servlet response httpservletresponse method input form rendered client provide credentials form handler client choose form based openid authentication component org apache sling selector selector authentication handler selectorauthenticationhandler properties property service description apache sling selector form handler property service vendor apache software foundation property org apache sling core spi authentication handler authenticationhandler path property property service ranking int value intvalue service selector authentication handler selectorauthenticationhandler abstract authentication handler abstractauthenticationhandler request parameter indicating authentication type selected user form login fails string par selected type selected auth type selectedauthtype parameter providing login form url property selector form servlet selectorformservlet servlet path string par login form form login form log logger log logger factory loggerfactory get logger getlogger get class getclass string login form loginform returns code code handler provide credentials request authentication info authenticationinfo extract credentials extractcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response request credentials requestcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response check ref erer referer request handler auth util authutil check ref erer checkreferer request login form loginform handler hash map hashmap string string params hash map hashmap string string params authenticator login resource get login resource getloginresource request append indication previous login failure request get attribute getattribute failure reason object j reason jreason request get attribute getattribute failure reason suppress warnings suppresswarnings rawtypes string reason j reason jreason enum enum j reason jreason j reason jreason to string tostring params failure reason reason append selected authentication type previous request request get parameter getparameter par selected type params par selected type request get parameter getparameter par selected type send redirect sendredirect request response login form loginform params io exception ioexception log error failed redirect login form login form loginform handler manage concrete credentials drop credentials dropcredentials http servlet request httpservletrequest request http servlet response httpservletresponse response scr int egration integration suppress warnings suppresswarnings unused activate modified configure map string properties login form loginform osgi util osgiutil to string tostring properties par login form selector form servlet selectorformservlet servlet path log info login form url login form loginform
licensed apache software foundation asf contributor license agreements notice file distributed work additional copyright ownership asf licenses file apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org apache sling installer org junit fail java file java io exception ioexception java util array list arraylist java util linked list linkedlist java util list java util random org apache sling installer api installable resource installableresource org junit org junit org junit test org junit runner run with runwith org ops pax exam option org ops pax exam junit pax exam paxexam org osgi service log log service logservice rep eatedly repeatedly install remove reinstall semi random sets bundles stress test installer framework ran domly randomly sel ects selects bundles remove reinstall folder bundles sup plying supplying folder bundles inc reasing increasing number cycles executed system properties pom xml test turned running stress test run with runwith pax exam paxexam bundle install stress test bundleinstallstresstest osgi installer test base osgiinstallertestbase string prop bundles folder osgi installer bundle install stress test bundleinstallstresstest bundles folder string prop cycle count osgi installer bundle install stress test bundleinstallstresstest cycle count string prop expect timeout seconds osgi installer bundle install stress test bundleinstallstresstest expect timeout seconds min test bundles folder test bundles file bundles folder bundlesfolder cycles cycle count cyclecount list test bundles list file test bundles testbundles random sequence random random timeout expect bundles expectbundles expect bundles timeout msec expectbundlestimeoutmsec synchronize osg i osgi operations fair events detector eventsdetector events detector eventsdetector msec events org ops pax exam configuration option config default configuration defaultconfiguration set up setup setup installer setupinstaller string system get property getproperty prop bundles folder fail missing system property prop bundles folder bundles folder bundlesfolder file bundles folder bundlesfolder is directory isdirectory fail bundles folder bundles folder bundlesfolder get absolute path getabsolutepath string system get property getproperty prop cycle count fail missing system property prop cycle count cycle count cyclecount integer parse int parseint string system get property getproperty prop expect timeout seconds fail missing system property prop expect timeout seconds expect bundles timeout msec expectbundlestimeoutmsec integer parse int parseint log log service logservice log info get class getclass get simple name getsimplename cycle count cycle count cyclecount expect timeout msec expect bundles timeout msec expectbundlestimeoutmsec test bundles folder bundles folder bundlesfolder get absolute path getabsolutepath test bundles testbundles linked list linkedlist file string files bundles folder bundlesfolder list string filename files filename ends with endswith jar test bundles testbundles add file bundles folder bundlesfolder filename test bundles testbundles size min test bundles fail test bundles testbundles size bundles test folder expected min test bundles test folder bundles folder bundlesfolder get absolute path getabsolutepath random random cycle count cyclecount events detector eventsdetector events detector eventsdetector bundle context bundlecontext override tear down teardown tear down teardown events detector eventsdetector close test test semi random install testsemirandominstall exception cycle count cyclecount fail cycle count cycle count cyclecount initial bundle count initialbundlecount bundle context bundlecontext get bundles getbundles length log log service logservice log info initial bundle count initial bundle count initialbundlecount log installed bundles loginstalledbundles start installing bundles object listener start observing bundle events startobservingbundleevents log log service logservice log info registering test bundles test bundles testbundles size resources install test bundles testbundles bundle event bundleevent installed events installedevents bundle event bundleevent test bundles testbundles size installed events installedevents length installed events installedevents bundle event bundleevent org osgi framework bundle event bundleevent installed wait for bundle events waitforbundleevents bundles installed listener expect bundles timeout msec expectbundlestimeoutmsec installed events installedevents expect bundle count expectbundlecount installing test bundles initial bundle count initialbundlecount test bundles testbundles size number cycles randomly selected bundles removed reinstalled list file current installation currentinstallation array list arraylist file test bundles testbundles cycle count cyclecount start system current time millis currenttimemillis log log service logservice log info test cycle semi randomly sel ecting selecting sub set subset test bundles file current installation currentinstallation log log service logservice log debug installed bundle list file to install toinstall select random bundles selectrandombundles log log service logservice log info registering to install toinstall size randomly selected resources test bundles uninstalled file to install toinstall log log service logservice log debug registering bundle updates installs file to install toinstall current installation currentinstallation updates installs removes current installation currentinstallation size updates installed events installedevents bundle event bundleevent removes installs installed events installedevents length removes installed events installedevents bundle event bundleevent org osgi framework bundle event bundleevent uninstalled installed events installedevents bundle event bundleevent org osgi framework bundle event bundleevent installed log log service logservice log debug cycle removes removed bundles updates updated bundles installs installed bundles listener start observing bundle events startobservingbundleevents install to install toinstall wait for bundle events waitforbundleevents bundles installed cycle listener expect bundles timeout msec expectbundlestimeoutmsec installed events installedevents events detector eventsdetector wait for no events waitfornoevents msec events expect bundles timeout msec expectbundlestimeoutmsec expect bundle count expectbundlecount cycle initial bundle count initialbundlecount to install toinstall size log log service logservice log info test cycle successful to install toinstall size bundles system current time millis currenttimemillis start msec update cycle current installation currentinstallation clear current installation currentinstallation add all addall to install toinstall thread sleep interrupted exception interruptedexception install list file bundles io exception ioexception list installable resource installableresource to install toinstall linked list linkedlist installable resource installableresource file bundles to install toinstall add get installable resource getinstallableresource get absolute path getabsolutepath last modified lastmodified installer register resources registerresources url scheme to install toinstall to array toarray installable resource installableresource to install toinstall size expect bundle count expectbundlecount string info n bundles nbundles exception log log service logservice log info expecting n bundles nbundles bundles installed condition condition actual count actualcount override is true istrue exception actual count actualcount bundle context bundlecontext get bundles getbundles length actual count actualcount n bundles nbundles override string additional info additionalinfo expected n bundles nbundles installed bundles actual count actualcount override on failure onfailure log log service logservice log info failure additional info additionalinfo log installed bundles loginstalledbundles override get msec between eval uations getmsecbetweenevaluations wait for condition waitforcondition info expect bundles timeout msec expectbundlestimeoutmsec list file select random bundles selectrandombundles list file result linked list linkedlist file file test bundles testbundles random next boolean nextboolean log log service logservice log debug test bundle selected get name getname result add result size result add test bundles testbundles result
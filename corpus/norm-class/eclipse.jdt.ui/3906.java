copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation samrat dhillon sam rat samrat dhillon gmail int roduce introduce factory introduce factory adds statement create instance https bugs eclipse org bugs bug cgi org eclipse jdt tests refactoring java io exception ioexception java util hash map hashmap java util hash set hashset java util iterator java util map java util org eclipse jdt test plugin testplugin java project helper javaprojecthelper org eclipse core runtime core exception coreexception org eclipse core runtime null progress monitor nullprogressmonitor org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java project ijavaproject org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core i package fragment root ipackagefragmentroot org eclipse jdt core i source range isourcerange org eclipse jdt core java model exception javamodelexception org eclipse jdt core source range sourcerange org eclipse jdt internal corext refactoring code introduce factory refactoring introducefactoryrefactoring junit framework test junit framework test suite testsuite author rfuhrer watson ibm introduce factory tests introducefactorytests refactoring test refactoringtest introduce factory tests introducefactorytests clazz introduce factory tests introducefactorytests string refactoring path introduce factory introducefactory introduce factory tests introducefactorytests string override string get refactoring path getrefactoringpath refactoring path test suite java setup test suite testsuite clazz test set u p test setuptest test some test sometest java setup some test sometest produces test file based j unit junit test case testcase input files trims trailing test rid options single suite input file out puts outputs dependent option settings param input iff requested file input file test file trailing java input file trailing xxx java output file test options xxx string get simple test file name getsimpletestfilename input string test name testname get name getname us idx usidx test name testname index of indexof end idx endidx us idx usidx us idx usidx test name testname length string file name filename input test name testname substring end idx endidx test name testname substring file name filename java produces test file based j unit junit test case testcase get simple test file name getsimpletestfilename prepends version resource path depending code positive code test files assumed located resources directory param positive iff requested file positive unit test param input iff requested file input file test file string get test file name gettestfilename positive input string path test path prefix get refactoring path getrefactoringpath path positive positive negative path get simple test file name getsimpletestfilename input produces compilation unit input source file based test case testcase test files assumed located resources directory param pack param positive param input i compilation unit icompilationunit created test file exception i compilation unit icompilationunit create for simple test createcuforsimpletest i package fragment ipackagefragment pack positive input exception string file name filename get test file name gettestfilename positive input string cu name cuname get simple test file name getsimpletestfilename input createcu pack cu name cuname get file contents getfilecontents file name filename produces test file based j unit junit test case testcase get simple test file name getsimpletestfilename prepends version resource path depending code positive code test files assumed located resources directory param project project param pack fragment param file name filename file param input iff requested file input file test file string get bug test file name getbugtestfilename i java project ijavaproject project i package fragment ipackagefragment pack string file name filename input string test name testname get name getname nls string test number testnumber test name testname substring test length string path test path prefix get refactoring path getrefactoringpath bug zilla bugzilla test number testnumber project project get element name getelementname pack get package p getpackagep pack get element name getelementname nls nls nls path file name filename input java produces compilation unit input source file path based test case testcase base name basename supplied caller test files assumed located resources directory param project project exists test workspace param pack param base name basename param input i compilation unit icompilationunit created test file exception i compilation unit icompilationunit create for bug test case createcuforbugtestcase i java project ijavaproject project i package fragment ipackagefragment pack string base name basename input exception string file name filename get bug test file name getbugtestfilename project pack base name basename input string cu name cuname base name basename input java createcu pack cu name cuname get file contents getfilecontents file name filename string selection start herald string selection herald finds returns selection markers source string occurrences code selection start herald code code selection herald code fails assert ion assertion markers source string param source i source range isourcerange representing marked selection exception i source range isourcerange find selection in source findselectioninsource string source exception source index of indexof selection start herald selection start herald length source index of indexof selection herald selection start herald length assert true asserttrue selection start comment input source file assert true asserttrue selection comment input source file source range sourcerange do single unit test dosingleunittest protect constructor protectconstructor i compilation unit icompilationunit string output file name outputfilename exception java model exception javamodelexception io exception ioexception i source range isourcerange selection find selection in source findselectioninsource get source getsource introduce factory refactoring introducefactoryrefactoring introduce factory refactoring introducefactoryrefactoring selection get offset getoffset selection get length getlength set protect constructor setprotectconstructor protect constructor protectconstructor refactoring status refactoringstatus activation result activationresult check initial conditions checkinitialconditions null progress monitor nullprogressmonitor assert true asserttrue activation supposed successful activation result activationresult isok refactoring status refactoringstatus check input result checkinputresult check final conditions checkfinalconditions null progress monitor nullprogressmonitor check input result checkinputresult isok perform change performchange string new source newsource get source getsource system err println precondition failed get name getname system err println compile time error check input result checkinputresult to string tostring system err println off ending offending source system err print new source newsource assert true asserttrue precondition supposed pass check input result checkinputresult to string tostring perform change performchange string new source newsource get source getsource assert equal lines assertequallines get name getname get file contents getfilecontents output file name outputfilename new source newsource do single unit test with warning dosingleunittestwithwarning protect constructor protectconstructor i compilation unit icompilationunit string output file name outputfilename exception java model exception javamodelexception io exception ioexception i source range isourcerange selection find selection in source findselectioninsource get source getsource introduce factory refactoring introducefactoryrefactoring introduce factory refactoring introducefactoryrefactoring selection get offset getoffset selection get length getlength set protect constructor setprotectconstructor protect constructor protectconstructor refactoring status refactoringstatus activation result activationresult check initial conditions checkinitialconditions null progress monitor nullprogressmonitor assert true asserttrue activation supposed successful activation result activationresult isok refactoring status refactoringstatus check input result checkinputresult check final conditions checkfinalconditions null progress monitor nullprogressmonitor assert equals assertequals refactoring status refactoringstatus warning check input result checkinputresult get severity getseverity perform change performchange string new source newsource get source getsource assert equal lines assertequallines get name getname get file contents getfilecontents output file name outputfilename new source newsource tests introduce factory refactoring introducefactoryrefactoring refactoring single input source file test test prefix trailing options indicator fff comp ares compares transformed code source file test test prefix test files assumed located resources directory param protect constructor protectconstructor iff introduce factory refactoring introducefactoryrefactoring constructor exception single unit helper singleunithelper protect constructor protectconstructor exception i compilation unit icompilationunit create for simple test createcuforsimpletest get package p getpackagep do single unit test dosingleunittest protect constructor protectconstructor get test file name gettestfilename tests introduce factory refactoring introducefactoryrefactoring refactoring single input source file test test prefix trailing options indicator fff comp ares compares transformed code source file test test prefix test files assumed located resources directory param base file name basefilename base file param protect constructor protectconstructor iff introduce factory refactoring introducefactoryrefactoring constructor exception single unit bug helper singleunitbughelper string base file name basefilename protect constructor protectconstructor exception i compilation unit icompilationunit create for bug test case createcuforbugtestcase get package p getpackagep base file name basefilename do single unit test dosingleunittest protect constructor protectconstructor get bug test file name getbugtestfilename get package p getpackagep base file name basefilename single unit bug helper with warning singleunitbughelperwithwarning string base file name basefilename protect constructor protectconstructor exception i compilation unit icompilationunit create for bug test case createcuforbugtestcase get package p getpackagep base file name basefilename do single unit test with warning dosingleunittestwithwarning protect constructor protectconstructor get bug test file name getbugtestfilename get package p getpackagep base file name basefilename single unit helper singleunithelper specification names generated factory method param factory method name factorymethodname generated factory method param factory class name factoryclassname factory exception names helper nameshelper string factory method name factorymethodname string factory class name factoryclassname exception i compilation unit icompilationunit create for simple test createcuforsimpletest get package p getpackagep i source range isourcerange selection find selection in source findselectioninsource get source getsource introduce factory refactoring introducefactoryrefactoring introduce factory refactoring introducefactoryrefactoring selection get offset getoffset selection get length getlength refactoring status refactoringstatus activation result activationresult check initial conditions checkinitialconditions null progress monitor nullprogressmonitor assert true asserttrue activation supposed successful activation result activationresult isok factory method name factorymethodname set new method name setnewmethodname factory method name factorymethodname factory class name factoryclassname set factory class setfactoryclass factory class name factoryclassname refactoring status refactoringstatus check input result checkinputresult check final conditions checkfinalconditions null progress monitor nullprogressmonitor assert true asserttrue precondition supposed pass check input result checkinputresult to string tostring check input result checkinputresult isok perform change performchange string new source newsource get source getsource assert equal lines assertequallines get name getname get file contents getfilecontents get test file name gettestfilename new source newsource creates compilation unit source file base suffix source file assumed located test resources directory handles positive tests param file name filename base source file suffix param pack i package fragment ipackagefragment i compilation unit icompilationunit newly created unit exception i compilation unit icompilationunit create from file name createcufromfilename string file name filename i package fragment ipackagefragment pack exception string full name fullname test path prefix get refactoring path getrefactoringpath positive file name filename java createcu pack file name filename java get file contents getfilecontents full name fullname do multi unit test domultiunittest i compilation unit icompilationunit c us cus string test path testpath string output file base names outputfilebasenames string factory class name factoryclassname exception java model exception javamodelexception io exception ioexception i source range isourcerange selection find selection in source findselectioninsource c us cus get source getsource introduce factory refactoring introducefactoryrefactoring introduce factory refactoring introducefactoryrefactoring c us cus selection get offset getoffset selection get length getlength refactoring status refactoringstatus activation result activationresult check initial conditions checkinitialconditions null progress monitor nullprogressmonitor assert true asserttrue activation supposed successful activation result activationresult isok factory class name factoryclassname set factory class setfactoryclass factory class name factoryclassname refactoring status refactoringstatus check input result checkinputresult check final conditions checkfinalconditions null progress monitor nullprogressmonitor assert true asserttrue precondition supposed pass check input result checkinputresult to string tostring check input result checkinputresult isok perform change performchange string test name testname get name getname c us cus length opt idx optidx test name testname index of indexof string test options testoptions opt idx optidx test name testname substring opt idx optidx string out file name outfilename test path testpath output file base names outputfilebasenames test options testoptions java string xformed src xformedsrc c us cus get source getsource string expected src expectedsrc get file contents getfilecontents out file name outfilename assert equal lines assertequallines get name getname expected src expectedsrc xformed src xformedsrc tests introduce factory refactoring introducefactoryrefactoring refactoring input source files names supplied code file base names filebasenames code argument comp ares compares transformed code source files names input base names options suffix fff test files assumed located resources directory param static factory method staticfactorymethod iff introduce factory refactoring introducefactoryrefactoring factory method param input file base names inputfilebasenames array input source file base names exception multi unit helper multiunithelper static factory method staticfactorymethod string input file base names inputfilebasenames exception i package fragment ipackagefragment pkg get package p getpackagep i compilation unit icompilationunit c us cus i compilation unit icompilationunit input file base names inputfilebasenames length input file base names inputfilebasenames length c us cus create from file name createcufromfilename input file base names inputfilebasenames pkg string test path testpath test path prefix get refactoring path getrefactoringpath positive do multi unit test domultiunittest c us cus test path testpath input file base names inputfilebasenames tests introduce factory refactoring introducefactoryrefactoring refactoring input source files names supplied code file base names filebasenames code argument comp ares compares transformed code source files names input base names options suffix fff test files assumed located resources directory param static factory method staticfactorymethod iff introduce factory refactoring introducefactoryrefactoring factory method param input file base names inputfilebasenames array input source file base names param factory class name factoryclassname fully qualified receive factory method factory method defining constructor exception multi unit bug helper multiunitbughelper static factory method staticfactorymethod string input file base names inputfilebasenames string factory class name factoryclassname exception i compilation unit icompilationunit c us cus i compilation unit icompilationunit input file base names inputfilebasenames length input file base names inputfilebasenames length pkg end pkgend input file base names inputfilebasenames last index of lastindexof explicit pkg explicitpkg pkg end pkgend i package fragment ipackagefragment pkg explicit pkg explicitpkg get root getroot create package fragment createpackagefragment input file base names inputfilebasenames substring pkg end pkgend null progress monitor nullprogressmonitor get package p getpackagep c us cus create for bug test case createcuforbugtestcase pkg input file base names inputfilebasenames substring pkg end pkgend string test name testname get name getname string test number testnumber test name testname substring test length string test path testpath test path prefix get refactoring path getrefactoringpath bug zilla bugzilla test number testnumber do multi unit test domultiunittest c us cus test path testpath input file base names inputfilebasenames factory class name factoryclassname multi project bug helper multiprojectbughelper string input file base names inputfilebasenames string dependencies exception map string string proj name projname pkg names pkgnames collect project packages collectprojectpackages input file base names inputfilebasenames map string i java project ijavaproject proj name projname project hash map hashmap map i java project ijavaproject i package fragment root ipackagefragmentroot proj pkg root pkgroot hash map hashmap create project package structure createprojectpackagestructure proj name projname pkg names pkgnames proj name projname project proj pkg root pkgroot i compilation unit icompilationunit c us cus createcus input file base names inputfilebasenames proj name projname project proj pkg root pkgroot add project dependencies addprojectdependencies dependencies proj name projname project string test name testname get name getname string test number testnumber test name testname substring test length string test path testpath test path prefix get refactoring path getrefactoringpath bug zilla bugzilla test number testnumber do multi unit test domultiunittest c us cus test path testpath input file base names inputfilebasenames iterator i java project ijavaproject iter proj pkg root pkgroot key set keyset iterator iter has next hasnext i java project ijavaproject project iter project exists project get project getproject delete core exception coreexception print stack trace printstacktrace i compilation unit icompilationunit createcus string input file base names inputfilebasenames map string i java project ijavaproject proj name projname project map i java project ijavaproject i package fragment root ipackagefragmentroot proj pkg root pkgroot exception i compilation unit icompilationunit c us cus i compilation unit icompilationunit input file base names inputfilebasenames length input file base names inputfilebasenames length string file path filepath input file base names inputfilebasenames proj end projend file path filepath index of indexof pkg end pkgend file path filepath last index of lastindexof file begin filebegin pkg end pkgend string proj name projname file path filepath substring proj end projend string pkg name pkgname file path filepath substring proj end projend pkg end pkgend replace i java project ijavaproject project proj name projname project proj name projname i package fragment root ipackagefragmentroot root proj pkg root pkgroot project i package fragment ipackagefragment pkg root get package fragment getpackagefragment pkg name pkgname c us cus create for bug test case createcuforbugtestcase project pkg file path filepath substring file begin filebegin c us cus add project dependencies addprojectdependencies string dependencies map string i java project ijavaproject proj name projname project java model exception javamodelexception dependencies length dependent provider string dependency dependencies colon idx colonidx dependency index of indexof string dep name depname dependency substring colon idx colonidx string prov name provname dependency substring colon idx colonidx i java project ijavaproject dep proj depproj proj name projname project dep name depname i java project ijavaproject prov proj provproj proj name projname project prov name provname java project helper javaprojecthelper add required project addrequiredproject dep proj depproj prov proj provproj create project package structure createprojectpackagestructure map string string proj name projname pkg names pkgnames map string i java project ijavaproject proj name projname project map i java project ijavaproject i package fragment root ipackagefragmentroot proj pkg root pkgroot core exception coreexception java model exception javamodelexception iterator string iter proj name projname pkg names pkgnames key set keyset iterator iter has next hasnext string proj name projname iter string proj pkg names projpkgnames proj name projname pkg names pkgnames proj name projname i java project ijavaproject project java project helper javaprojecthelper create java project createjavaproject proj name projname bin i package fragment root ipackagefragmentroot root java project helper javaprojecthelper add source container addsourcecontainer project container java project helper javaprojecthelper addrtjar project i package fragment ipackagefragment pkgs hash set hashset proj name projname project proj name projname project proj pkg root pkgroot project root iterator string pkg iter pkgiter proj pkg names projpkgnames iterator pkg iter pkgiter has next hasnext string pkg name pkgname pkg iter pkgiter pkgs add root create package fragment createpackagefragment pkg name pkgname map string string collect project packages collectprojectpackages string input file base names inputfilebasenames map string string proj pkgs hash map hashmap input file base names inputfilebasenames length string file path filepath input file base names inputfilebasenames proj end projend file path filepath index of indexof string proj name projname file path filepath substring proj end projend string pkg name pkgname file path filepath substring proj end projend file path filepath last index of lastindexof string proj pkgs projpkgs proj pkgs proj name projname proj pkgs projpkgs proj pkgs proj name projname proj pkgs projpkgs hash set hashset proj pkgs projpkgs add pkg name pkgname proj pkgs fail helper failhelper expected status expectedstatus exception i compilation unit icompilationunit create for simple test createcuforsimpletest get package p getpackagep i source range isourcerange selection find selection in source findselectioninsource get source getsource introduce factory refactoring introducefactoryrefactoring introduce factory refactoring introducefactoryrefactoring selection get offset getoffset selection get length getlength refactoring status refactoringstatus result perform refactoring performrefactoring assert not null assertnotnull precondition supposed fail result assert equals assertequals status expected status expectedstatus result get severity getseverity tests test static context teststaticcontext fff exception single unit helper singleunithelper test instance context testinstancecontext fff exception single unit helper singleunithelper string names create thing creatething thing factory thingfactory i thing factory ithingfactory test names testnames fff exception names helper nameshelper names test multiple callers testmultiplecallers fff exception single unit helper singleunithelper test select constructor testselectconstructor exception single unit helper singleunithelper test different sigs testdifferentsigs exception single unit helper singleunithelper test different args testdifferentargs exception single unit helper singleunithelper test different args testdifferentargs exception single unit helper singleunithelper test different args testdifferentargs exception single unit helper singleunithelper test unmovable arg testunmovablearg exception single unit helper singleunithelper test unmovable arg testunmovablearg exception single unit helper singleunithelper test dont move args testdontmoveargs exception single unit helper singleunithelper test dont move args testdontmoveargs exception single unit helper singleunithelper test protect constructor testprotectconstructor exception single unit helper singleunithelper test protect constructor testprotectconstructor exception single unit helper singleunithelper test static instance teststaticinstance exception single unit helper singleunithelper test ctor throws testctorthrows exception single unit helper singleunithelper test javadoc ref testjavadocref exception single unit helper singleunithelper test nested class testnestedclass exception fail helper failhelper refactoring status refactoringstatus fatal generics tests test type param testtypeparam exception single unit helper singleunithelper test two type params testtwotypeparams exception single unit helper singleunithelper test bounded type param testboundedtypeparam exception single unit helper singleunithelper test two bounded type params testtwoboundedtypeparams exception single unit helper singleunithelper test wildcard param testwildcardparam exception single unit helper singleunithelper test type param testtypeparam exception names helper nameshelper factory tests test enum testenum exception fail helper failhelper refactoring status refactoringstatus fatal test annotation testannotation exception single unit helper singleunithelper test annotation testannotation exception single unit helper singleunithelper test annotation testannotation exception single unit helper singleunithelper test var args ctor testvarargsctor exception rmf search engine doesn rel iably reliably find call sites varargs methods single unit helper singleunithelper test multiple units testmultipleunits fff exception multi unit helper multiunithelper string multi unit multiunit multi unit multiunit multi unit multiunit bug zilla bugzilla bug regression tests test exception multi unit bug helper multiunitbughelper string test class testclass use test class usetestclass test exception single unit bug helper singleunitbughelper test class testclass test exception single unit bug helper singleunitbughelper test class testclass test exception single unit bug helper singleunitbughelper implicit ctor implicitctor test exception single unit bug helper singleunitbughelper qualified name qualifiedname test exception multi unit bug helper multiunitbughelper string test exception single unit bug helper singleunitbughelper arg type import argtypeimport test exception single unit bug helper singleunitbughelper explicit super ctor call explicitsuperctorcall test exception multi unit bug helper multiunitbughelper string test exception single unit bug helper singleunitbughelper implicit super ctor call implicitsuperctorcall test exception multi project bug helper multiprojectbughelper string proj proj string proj proj test exception single unit bug helper singleunitbughelper ctor of param type ctorofparamtype test exception single unit bug helper singleunitbughelper varargs test exception single unit bug helper singleunitbughelper ctor type arg bounds ctortypeargbounds test exception single unit bug helper singleunitbughelper has anonymous hasanonymous test exception single unit bug helper singleunitbughelper test test exception single unit bug helper singleunitbughelper test exception single unit bug helper with warning singleunitbughelperwithwarning abstract class abstractclass test exception single unit bug helper with warning singleunitbughelperwithwarning abstract method abstractmethod test factory clash testfactoryclash exception fail helper failhelper refactoring status refactoringstatus error
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation tom eicher avaloq evolution block selection mode org eclipse jdt internal actions java util array list arraylist java util iterator java util resource bundle resourcebundle org eclipse swt custom busy indicator busyindicator org eclipse swt widgets display org eclipse core runtime org eclipse core runtime i status istatus org eclipse core runtime status org eclipse text edits multi text edit multitextedit org eclipse text edits replace edit replaceedit org eclipse text edits text edit textedit org eclipse jface viewers i selection iselection org eclipse jface viewers i selection provider iselectionprovider org eclipse jface text bad location exception badlocationexception org eclipse jface text i document idocument org eclipse jface text i region iregion org eclipse jface text i rewrite target irewritetarget org eclipse jface text i text selection itextselection org eclipse jface text i type d region itypedregion org eclipse jface text position org eclipse jface text text selection textselection org eclipse jface text text utilities textutilities org eclipse jface text source i source viewer isourceviewer org eclipse i editor input ieditorinput org eclipse texteditor i document provider idocumentprovider org eclipse texteditor i text editor itexteditor org eclipse texteditor i text editor extension itexteditorextension org eclipse texteditor text editor action texteditoraction org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java project ijavaproject org eclipse jdt core java core javacore org eclipse jdt core formatter default code formatter constants defaultcodeformatterconstants org eclipse jdt text i java partitions ijavapartitions org eclipse jdt internal java plugin javaplugin org eclipse jdt internal java editor javaeditor java editor javaeditor org eclipse jdt internal text java heuristic scanner javaheuristicscanner org eclipse jdt internal text java indenter javaindenter indents range lines java document correct position complete ast indentation computed heuristics algorithm fast single lines store efficient large ranges org eclipse jdt internal text java heuristic scanner javaheuristicscanner org eclipse jdt internal text java indenter javaindenter indent action indentaction text editor action texteditoraction replace data replacedata replacement string indent start replacement offset replacement replace string document offset indent param offset start replacement param replacement param indent replacement replace data replacedata offset string indent indent indent offset offset caret offset indent operation f c are t offset fcaretoffset action invoked tab code code indentation behaves diff erently differently accommodate normal tab operation f is tab action fistabaction creates instance param bundle resource bundle param prefix prefix code bundle code param editor text editor param is tab action istabaction action insert tabs indentation indent action indentaction resource bundle resourcebundle bundle string prefix i text editor itexteditor editor is tab action istabaction bundle prefix editor f is tab action fistabaction is tab action istabaction org eclipse jface action action override update called framework is enabled isenabled validate editor input state validateeditorinputstate i text selection itextselection selection get selection getselection i document idocument document get document getdocument document offset selection get offset getoffset length selection get length getlength position position offset length first line firstline n lines nlines f c are t offset fcaretoffset document add position addposition first line firstline selection get start line getstartline n lines nlines selection get end line getendline first line firstline bad location exception badlocationexception java plugin javaplugin log status i status istatus error java plugin javaplugin get plugin id getpluginid i status istatus runnable runnable runnable override i rewrite target irewritetarget target get text editor gettexteditor get adapter getadapter i rewrite target irewritetarget target target begin compound change begincompoundchange java heuristic scanner javaheuristicscanner scanner java heuristic scanner javaheuristicscanner document java indenter javaindenter indenter java indenter javaindenter document scanner get java project getjavaproject multi line multiline n lines nlines has changed haschanged n lines nlines has changed haschanged indent line indentline document first line firstline offset indenter scanner multi line multiline update caret position move position indenting selection indenting multiple new offset newoffset new length newlength f is tab action fistabaction multi line multiline new offset newoffset offset new length newlength get offset getoffset offset new offset newoffset f c are t offset fcaretoffset new length newlength single tab invocation new offset newoffset has changed haschanged new offset newoffset offset new length newlength length select and reveal selectandreveal new offset newoffset new length newlength document remove position removeposition bad location exception badlocationexception java plugin javaplugin log status i status istatus error java plugin javaplugin get plugin id getpluginid i status istatus concurrent modification concurrentmodification indent action indentaction target target end compound change endcompoundchange n lines nlines display display get text editor gettexteditor get editor site geteditorsite get workbench window getworkbenchwindow get shell getshell get display getdisplay busy indicator busyindicator show while showwhile display runnable runnable selects range editor param new offset newoffset selection offset param new length newlength selection range select and reveal selectandreveal new offset newoffset new length newlength is true istrue new offset newoffset is true istrue new length newlength i text editor itexteditor editor get text editor gettexteditor editor java editor javaeditor i source viewer isourceviewer viewer java editor javaeditor editor get viewer getviewer viewer viewer set selected range setselectedrange new offset newoffset new length newlength int rusive intrusive called get text editor gettexteditor select and reveal selectandreveal new offset newoffset new length newlength indent code document code based code project code settings text edit describing applied document returns applied warning method change content document method internal called param document document indent java partitioning installed param project project retrieve indentation settings workspace settings text edit describing required bad location exception badlocationexception document modified concurrently text edit textedit indent i document idocument document i java project ijavaproject project bad location exception badlocationexception offset length document get length getlength java heuristic scanner javaheuristicscanner scanner java heuristic scanner javaheuristicscanner document java indenter javaindenter indenter java indenter javaindenter document scanner project array list arraylist replace edit replaceedit edits array list arraylist first line firstline document get line of offset getlineofoffset offset check marginal length lines minus one minusone length number of lines numberoflines document get line of offset getlineofoffset offset length minus one minusone first line firstline shift number of lines numberoflines replace data replacedata data compute replace data computereplacedata document first line firstline indenter scanner number of lines numberoflines project replace length replacelength data data offset string current indent currentindent document data offset replace length replacelength change document real change data indent equals current indent currentindent edits add replace edit replaceedit data offset shift replace length replacelength data indent change document indenter depends document replace data offset replace length replacelength data indent shift data indent length replace length replacelength edits size edits size edits multi text edit multitextedit result multi text edit multitextedit iterator replace edit replaceedit iterator edits iterator iterator has next hasnext text edit textedit edit iterator result add child addchild edit result indents single java heuristic scanner javadoc multiline comments indented code java doc auto indent strategy javadocautoindentstrategy code param document document param indented param indenter java indenter param scanner heuristic scanner param multi line multiline code code indented param is tab action istabaction code code action invoked tab param project project retrieve indentation settings workspace settings code code code document code modified code code bad location exception badlocationexception document changed concurrently replace data replacedata compute replace data computereplacedata i document idocument document java indenter javaindenter indenter java heuristic scanner javaheuristicscanner scanner multi line multiline is tab action istabaction i java project ijavaproject project bad location exception badlocationexception i region iregion current line currentline document get line information getlineinformation offset current line currentline get offset getoffset start searching single comments ws start wsstart offset string indent offset document get length getlength i type d region itypedregion partition text utilities textutilities get partition getpartition document i java partitions ijavapartitions java partitioning offset string type partition get type gettype i type d region itypedregion starting partition startingpartition text utilities textutilities get partition getpartition document i java partitions ijavapartitions java partitioning offset string starting type startingtype starting partition startingpartition get type gettype is comment start iscommentstart starting partition startingpartition get offset getoffset offset is dont indent multi line comment on first column isdontindentmultilinecommentonfirstcolumn project is comment start iscommentstart i java partitions ijavapartitions java multi comment equals starting type startingtype nls indent i java partitions ijavapartitions java doc equals type i java partitions ijavapartitions java multi comment equals type indent compute javadoc indent computejavadocindent document scanner starting partition startingpartition is tab action istabaction is comment start iscommentstart i java partitions ijavapartitions java single comment equals starting type startingtype comment starting position multi line multiline formatter is dont indent single line comment on first column isdontindentsinglelinecommentonfirstcolumn project nls indent indent add remove indent user start typing correct position slashes count leading slash pairs countleadingslashpairs document offset ws start wsstart offset slashes string buffer stringbuffer computed indenter compute indentation computeindentation offset computed computed string buffer stringbuffer remove indent ations removeindentations slashes get tab size gettabsize project computed indent document offset ws start wsstart offset computed standard java indentation indent string buffer stringbuffer computed indenter compute indentation computeindentation offset computed indent computed to string tostring nls indent change document current white space line length linelength current line currentline get length getlength scanner find non whitespace for ward in any partition findnonwhitespaceforwardinanypartition ws start wsstart offset line length linelength java heuristic scanner javaheuristicscanner empty offset line length linelength multi line multiline indent empty lines indentemptylines project nls indent replace data replacedata offset indent removes code count code indent ations indentations start code buffer code size space character size tab character code tab size tabsize code param count number indent ations indentations remove param tab size tabsize size tab character param buffer buffer modify remove indent ations removeindentations count tab size tabsize string buffer stringbuffer buffer count buffer length buffer char at charat count tab size tabsize count tab size tabsize count buffer delete char at deletecharat returns number cont inuous continuous slashes pairs starting code offset code code document code param document document inspect param offset offset start slash pairs number slash pairs bad location exception badlocationexception count leading slash pairs countleadingslashpairs i document idocument document offset bad location exception badlocationexception i region iregion line info lineinfo document get line information of offset getlineinformationofoffset offset max line info lineinfo get offset getoffset line info lineinfo get length getlength pair count paircount nls offset max document offset equals pair count paircount offset offset pair count paircount indents single java heuristic scanner javadoc multiline comments indented code java doc auto indent strategy javadocautoindentstrategy code param document document param indented param caret caret position param indenter java indenter param scanner heuristic scanner param multi line multiline code code indented code code code document code modified code code bad location exception badlocationexception document changed concurrently indent line indentline i document idocument document caret java indenter javaindenter indenter java heuristic scanner javaheuristicscanner scanner multi line multiline bad location exception badlocationexception i java project ijavaproject project get java project getjavaproject replace data replacedata data compute replace data computereplacedata document indenter scanner multi line multiline f is tab action fistabaction project string indent data indent data offset data offset length offset string current indent currentindent document offset length insert tab f is tab action fistabaction caret white space length whitespacelength current indent currentindent project white space length whitespacelength indent project string tab get tab equivalent gettabequivalent project document replace caret tab f c are t offset fcaretoffset caret tab length caret offset setting selection caret offset caret f c are t offset fcaretoffset offset indent length f c are t offset fcaretoffset change document real change indent equals current indent currentindent document replace offset length indent computes returns indentation javadoc javadoc comment param document document param document param scanner scanner param partition javadoc partition indent code code comp utable computable bad location exception badlocationexception string compute javadoc indent computejavadocindent i document idocument document java heuristic scanner javaheuristicscanner scanner i type d region itypedregion partition bad location exception badlocationexception impossible javadoc comment don assumptions start commented code don change indent i region iregion line info lineinfo document get line information getlineinformation line start linestart line info lineinfo get offset getoffset line length linelength line info lineinfo get length getlength line end lineend line start linestart line length linelength nonws scanner find non whitespace for ward in any partition findnonwhitespaceforwardinanypartition line start linestart line end lineend nonws java heuristic scanner javaheuristicscanner document get char getchar nonws nonws java heuristic scanner javaheuristicscanner document line start linestart line length linelength document line start linestart nonws line start linestart indent previous reuse i region iregion previous line previousline document get line information getlineinformation previous line start previouslinestart previous line previousline get offset getoffset previous line length previouslinelength previous line previousline get length getlength previous line end previouslineend previous line start previouslinestart previous line length previouslinelength string buffer stringbuffer buf string buffer stringbuffer previous line non s previouslinenonws scanner find non whitespace for ward in any partition findnonwhitespaceforwardinanypartition previous line start previouslinestart previous line end previouslineend previous line non s previouslinenonws java heuristic scanner javaheuristicscanner document get char getchar previous line non s previouslinenonws align comment start previous ast erisked asterisked previous line previousline document get line information of offset getlineinformationofoffset partition get offset getoffset previous line start previouslinestart previous line previousline get offset getoffset previous line length previouslinelength previous line previousline get length getlength previous line end previouslineend previous line start previouslinestart previous line length previouslinelength previous line non s previouslinenonws scanner find non whitespace for ward in any partition findnonwhitespaceforwardinanypartition previous line start previouslinestart previous line end previouslineend previous line non s previouslinenonws java heuristic scanner javaheuristicscanner previous line non s previouslinenonws previous line end previouslineend add initial space todo control led controlled formatter preference buf append string indentation document previous line start previouslinestart previous line non s previouslinenonws previous line start previouslinestart buf insert indentation buf to string tostring returns size characters string characters count tabs count editor preference tab display param indent string measured param project project retrieve indentation settings workspace settings size characters string white space length whitespacelength string indent i java project ijavaproject project indent size indent length tab size tabsize get tab size gettabsize project size indent char at charat tab size tabsize size returns tab equivalent tab character spaces depending editor formatter preferences param project project retrieve indentation settings workspace settings string representing tab editor code code string get tab equivalent gettabequivalent i java project ijavaproject project string tab java core javacore space equals get core formatter option getcoreformatteroption default code formatter constants defaultcodeformatterconstants formatter tab project size get tab size gettabsize project string buffer stringbuffer buf string buffer stringbuffer size buf append tab buf to string tostring nls tab tab returns tab size java editor deduced formatter preferences param project project retrieve indentation settings workspace settings tab size defined current formatter preferences get tab size gettabsize i java project ijavaproject project get core formatter option getcoreformatteroption default code formatter constants defaultcodeformatterconstants formatter tab size project returns code code empty lines indented code code param project project retrieve indentation settings workspace settings code code empty lines indented code code indent empty lines indentemptylines i java project ijavaproject project default code formatter constants defaultcodeformatterconstants equals get core formatter option getcoreformatteroption default code formatter constants defaultcodeformatterconstants formatter indent empty lines project returns code code multi comments start column indented code code param project project retrieve indentation settings workspace settings code code multi comments indented code code is dont indent multi line comment on first column isdontindentmultilinecommentonfirstcolumn i java project ijavaproject project default code formatter constants defaultcodeformatterconstants equals get core formatter option getcoreformatteroption default code formatter constants defaultcodeformatterconstants formatter indent block comments column project returns code code single comments start column indented code code param project project retrieve indentation settings workspace settings code code single comments indented code code is dont indent single line comment on first column isdontindentsinglelinecommentonfirstcolumn i java project ijavaproject project default code formatter constants defaultcodeformatterconstants equals get core formatter option getcoreformatteroption default code formatter constants defaultcodeformatterconstants formatter indent comments column project returns project specific core preference defined code key code param key key preference param project project retrieve indentation settings workspace settings preference string get core formatter option getcoreformatteroption string key i java project ijavaproject project project java core javacore get option getoption key project get option getoption key returns project specific core preference defined code key code code def code int eger integer param key key preference param def param project project retrieve indentation settings workspace settings preference get core formatter option getcoreformatteroption string key def i java project ijavaproject project integer parse int parseint get core formatter option getcoreformatteroption key project number format exception numberformatexception def returns code i java project ijavaproject code current editor input code code code i java project ijavaproject code current editor input code code i java project ijavaproject get java project getjavaproject i text editor itexteditor editor get text editor gettexteditor editor i compilation unit icompilationunit java plugin javaplugin get default getdefault get working copy manager getworkingcopymanager get working copy getworkingcopy editor get editor input geteditorinput get java project getjavaproject returns editor selection provider editor selection provider code code i selection provider iselectionprovider get selection provider getselectionprovider i text editor itexteditor editor get text editor gettexteditor editor editor get selection provider getselectionprovider org eclipse texteditor i update iupdate update override update update is enabled isenabled f is tab action fistabaction set enabled setenabled can modify editor canmodifyeditor is smart mode issmartmode is valid selection isvalidselection set enabled setenabled can modify editor canmodifyeditor get selection getselection is empty isempty returns current selection valid empty caret whitespace start covers multiple lines code code selection valid indent operation is valid selection isvalidselection i text selection itextselection selection get selection getselection selection is empty isempty offset selection get offset getoffset length selection get length getlength i document idocument document get document getdocument document i region iregion first line firstline document get line information of offset getlineinformationofoffset offset line offset lineoffset first line firstline get offset getoffset selection extend multiple lines length document line offset lineoffset offset line offset lineoffset trim length line offset lineoffset first line firstline get length getlength offset length enable empty select ions selections bad location exception badlocationexception returns smart preference code code smart mode code code is smart mode issmartmode i text editor itexteditor editor get text editor gettexteditor editor i text editor extension itexteditorextension i text editor extension itexteditorextension editor get insert mode getinsertmode i text editor extension itexteditorextension smart insert returns document displayed editor code code current document code code i document idocument get document getdocument i text editor itexteditor editor get text editor gettexteditor editor i document provider idocumentprovider provider editor get document provider getdocumentprovider i editor input ieditorinput input editor get editor input geteditorinput provider input provider get document getdocument input returns selection editor invalid selection returns code code current selection code code i text selection itextselection get selection getselection i selection provider iselectionprovider provider get selection provider getselectionprovider provider i selection iselection selection provider get selection getselection selection i text selection itextselection i text selection itextselection selection object text selection textselection empty selection emptyselection
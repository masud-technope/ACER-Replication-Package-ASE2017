copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal corext java util array list arraylist java util hash map hashmap java util hash set hashset java util iterator java util linked list linkedlist java util map java util org eclipse swt swt org eclipse swt events selection adapter selectionadapter org eclipse swt events selection event selectionevent org eclipse swt graphics text layout textlayout org eclipse swt layout grid data griddata org eclipse swt layout grid layout gridlayout org eclipse swt widgets composite org eclipse swt widgets control org eclipse swt widgets display org eclipse swt widgets label org eclipse swt widgets link org eclipse swt widgets shell org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core runtime i path ipath org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime i status istatus org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core runtime status org eclipse core runtime sub progress monitor subprogressmonitor org eclipse core runtime preferences default scope defaultscope org eclipse core runtime preferences i eclipse preferences ieclipsepreferences org eclipse core runtime preferences instance scope instancescope org eclipse core resources i file ifile org eclipse core resources i project iproject org eclipse core resources project scope projectscope org eclipse core file buf fers filebuffers file buffers filebuffers org eclipse core file buf fers filebuffers i text file buffer itextfilebuffer org eclipse core file buf fers filebuffers i text file buffer manager itextfilebuffermanager org eclipse core file buf fers filebuffers location kind locationkind org eclipse text edits malformed tree exception malformedtreeexception org eclipse text edits text edit textedit org eclipse text edits undo edit undoedit org eclipse jface dialogs dialog org eclipse jface dialogs i dialog constants idialogconstants org eclipse jface dialogs message dialog messagedialog org eclipse jface window window org eclipse jface text bad location exception badlocationexception org eclipse jface text bad position category exception badpositioncategoryexception org eclipse jface text default position updater defaultpositionupdater org eclipse jface text i document idocument org eclipse jface text i document extension idocumentextension org eclipse jface text i region iregion org eclipse jface text position org eclipse jface text region org eclipse platformui org eclipse dialogs preferences util preferencesutil org eclipse ltk core refactoring change org eclipse ltk core refactoring composite change compositechange org eclipse ltk core refactoring i refactoring core status codes irefactoringcorestatuscodes org eclipse ltk core refactoring i undo manager iundomanager org eclipse ltk core refactoring null change nullchange org eclipse ltk core refactoring perform change operation performchangeoperation org eclipse ltk core refactoring refactoring core refactoringcore org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse ltk core refactoring text file change textfilechange org eclipse ltk refactoring refactoringui org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java project ijavaproject org eclipse jdt core dom ast parser astparser org eclipse jdt core dom compilation unit compilationunit org eclipse jdt internal corext clean up refactoring cleanuprefactoring clean up change cleanupchange org eclipse jdt internal corext refactoring util refactoringastparser org eclipse jdt internal corext util messages org eclipse jdt javaui org eclipse jdt sharedastprovider org eclipse jdt cleanup clean up context cleanupcontext org eclipse jdt cleanup clean up options cleanupoptions org eclipse jdt cleanup clean up requirements cleanuprequirements org eclipse jdt cleanup i clean up icleanup org eclipse jdt internal java plugin javaplugin org eclipse jdt internal actions action util actionutil org eclipse jdt internal dialogs optional message dialog optionalmessagedialog org eclipse jdt internal i multi line clean up imultilinecleanup multi line clean up context multilinecleanupcontext org eclipse jdt internal map clean up options mapcleanupoptions org eclipse jdt internal java editor javaeditor save participant saveparticipant i post save listener ipostsavelistener org eclipse jdt internal preferences bullet list block bulletlistblock org eclipse jdt internal preferences save participant preference page saveparticipantpreferencepage clean up post save listener cleanuppostsavelistener i post save listener ipostsavelistener clean up save undo cleanupsaveundo text file change textfilechange i file ifile f file ffile undo edit undoedit f undos fundos f document stamp fdocumentstamp f file stamp ffilestamp clean up save undo cleanupsaveundo string i file ifile file undo edit undoedit undos document stamp documentstamp file stamp filestamp file is not null isnotnull undos f document stamp fdocumentstamp document stamp documentstamp f file stamp ffilestamp file stamp filestamp f file ffile file f undos fundos undos override needs saving needssaving override change perform i progress monitor iprogressmonitor core exception coreexception is valid isvalid has fatal error hasfatalerror null change nullchange null progress monitor nullprogressmonitor i text file buffer manager itextfilebuffermanager manager file buffers filebuffers get text file buffer manager gettextfilebuffermanager nls begin task begintask i text file buffer itextfilebuffer buffer manager connect f file ffile get full path getfullpath location kind locationkind ifile sub progress monitor subprogressmonitor buffer manager get text file buffer gettextfilebuffer f file ffile get full path getfullpath location kind locationkind ifile i document idocument document buffer get document getdocument old file value oldfilevalue f file ffile get modification stamp getmodificationstamp linked list linkedlist undo edit undoedit undo edit collector undoeditcollector linked list linkedlist old doc value olddocvalue set content stamp success setcontentstampsuccess buffer is synchronization context requested issynchronizationcontextrequested perform edit performedit document old file value oldfilevalue undo edit collector undoeditcollector old doc value olddocvalue set content stamp success setcontentstampsuccess i text file buffer manager itextfilebuffermanager file buffer manager filebuffermanager file buffers filebuffers get text file buffer manager gettextfilebuffermanager ui runnable uirunnable runnable f done fdone exception f exception fexception override perform edit performedit document old file value oldfilevalue undo edit collector undoeditcollector old doc value olddocvalue set content stamp success setcontentstampsuccess bad location exception badlocationexception f exception fexception malformed tree exception malformedtreeexception f exception fexception core exception coreexception f exception fexception f done fdone notify all notifyall ui runnable uirunnable runnable ui runnable uirunnable runnable file buffer manager filebuffermanager execute runnable runnable f done fdone runnable wait interrupted exception interruptedexception runnable f exception fexception runnable f exception fexception bad location exception badlocationexception bad location exception badlocationexception runnable f exception fexception runnable f exception fexception malformed tree exception malformedtreeexception malformed tree exception malformedtreeexception runnable f exception fexception runnable f exception fexception core exception coreexception core exception coreexception runnable f exception fexception buffer commit set content stamp success setcontentstampsuccess f file ffile revert modification stamp revertmodificationstamp f file stamp ffilestamp clean up save undo cleanupsaveundo get name getname f file ffile undo edit collector undoeditcollector to array toarray undo edit undoedit undo edit collector undoeditcollector size old doc value olddocvalue old file value oldfilevalue bad location exception badlocationexception wrap bad location exception wrapbadlocationexception buffer manager disconnect f file ffile get full path getfullpath location kind locationkind ifile sub progress monitor subprogressmonitor perform edit performedit i document idocument document old file value oldfilevalue linked list linkedlist undo edit undoedit edit collector editcollector old doc value olddocvalue set content stamp success setcontentstampsuccess malformed tree exception malformedtreeexception bad location exception badlocationexception core exception coreexception document i document extension idocumentextension old doc value olddocvalue i document extension idocumentextension document get modification stamp getmodificationstamp old doc value olddocvalue old file value oldfilevalue perform f undos fundos length undo edit undoedit edit f undos fundos undo edit undoedit redo edit apply document text edit textedit create undo edit collector editcollector add first addfirst redo document i document extension idocumentextension f document stamp fdocumentstamp i document extension idocumentextension unknown modification stamp nls i document extension idocumentextension document replace nls nls nls nls f document stamp fdocumentstamp set content stamp success setcontentstampsuccess bad location exception badlocationexception wrap bad location exception wrapbadlocationexception slow clean up warning dialog slowcleanupwarningdialog optional message dialog optionalmessagedialog nls string save actions saveactions slow warning dialog slowwarningdialog string f clean up names fcleanupnames slow clean up warning dialog slowcleanupwarningdialog shell parent string title string clean up names cleanupnames parent title message dialog messagedialog warning string i dialog constants idialogconstants label i dialog constants idialogconstants cancel label f clean up names fcleanupnames clean up names cleanupnames override control create message area createmessagearea composite parent initialize dialog units initializedialogunits parent composite message composite messagecomposite composite parent swt message composite messagecomposite set font setfont parent get font getfont grid layout gridlayout layout grid layout gridlayout layout num columns numcolumns layout margin height marginheight layout margin width marginwidth layout vertical spacing verticalspacing convert vertical us to pixels convertverticaldlustopixels i dialog constants idialogconstants vertical spacing layout horizontal spacing horizontalspacing convert horizontal us to pixels converthorizontaldlustopixels i dialog constants idialogconstants horizontal spacing message composite messagecomposite set layout setlayout layout message composite messagecomposite set layout data setlayoutdata grid data griddata swt fill swt fill label explain label message composite messagecomposite swt wrap explain set layout data setlayoutdata grid data griddata swt swt center explain set text settext fix messages fixmessages clean up post save listener cleanuppostsavelistener slow clean up warning dialog slowcleanupwarningdialog explain bullet list block bulletlistblock clean up list block cleanuplistblock bullet list block bulletlistblock message composite messagecomposite swt grid data griddata grid data griddata grid data griddata swt fill swt fill clean up list block cleanuplistblock set layout data setlayoutdata grid data griddata clean up list block cleanuplistblock set text settext f clean up names fcleanupnames text layout textlayout text layout textlayout text layout textlayout message composite messagecomposite get display getdisplay text layout textlayout set text settext f clean up names fcleanupnames line count linecount text layout textlayout get line count getlinecount line count linecount grid data griddata height hint heighthint text layout textlayout get line bounds getlinebounds height text layout textlayout dispose link link link message composite messagecomposite swt link set layout data setlayoutdata grid data griddata swt swt center link set text settext fix messages fixmessages clean up post save listener cleanuppostsavelistener slow clean up dialog slowcleanupdialog link link add selection listener addselectionlistener selection adapter selectionadapter org eclipse swt events selection adapter selectionadapter widget selected widgetselected org eclipse swt events selection event selectionevent override widget selected widgetselected selection event selectionevent preferences util preferencesutil create preference dialog on createpreferencedialogon get shell getshell save participant preference page saveparticipantpreferencepage preference open message composite messagecomposite nls string post save list ener postsavelistener org eclipse jdt post save listener postsavelistener cleanup nls string warning warning nls string error error nls string changed region position category changed region position category call call override needs changed regions needschangedregions i compilation unit icompilationunit unit core exception coreexception i clean up icleanup clean ups cleanups get clean ups getcleanups unit get java project getjavaproject get project getproject requires changed regions requireschangedregions clean ups cleanups override saved i compilation unit icompilationunit unit i region iregion changed regions changedregions i progress monitor iprogressmonitor monitor core exception coreexception monitor monitor null progress monitor nullprogressmonitor monitor begin task begintask get name getname i progress monitor iprogressmonitor unknown action util actionutil is on build path isonbuildpath unit i clean up icleanup clean ups cleanups get clean ups getcleanups unit get java project getjavaproject get project getproject old file value oldfilevalue unit get resource getresource get modification stamp getmodificationstamp old doc value olddocvalue get document stamp getdocumentstamp i file ifile unit get resource getresource sub progress monitor subprogressmonitor monitor composite change compositechange result composite change compositechange fix messages fixmessages clean up post save listener cleanuppostsavelistener save action saveaction change name changename linked list linkedlist undo edit undoedit undo edits undoedits linked list linkedlist call call call call call hash set hashset i clean up icleanup slow clean ups slowcleanups call slow clean ups slowcleanups hash set hashset slow clean ups slowcleanups i undo manager iundomanager manager refactoring core refactoringcore get undo manager getundomanager success manager about to perform change abouttoperformchange result refactoring status refactoringstatus pre condition precondition refactoring status refactoringstatus clean ups cleanups length refactoring status refactoringstatus conditions clean ups cleanups check pre conditions checkpreconditions unit get java project getjavaproject i compilation unit icompilationunit unit sub progress monitor subprogressmonitor monitor pre condition precondition merge conditions show status showstatus pre condition precondition window map string string options hash map hashmap clean ups cleanups length map string string map clean ups cleanups get requirements getrequirements get compiler options getcompileroptions map options put all putall map compilation unit compilationunit ast requiresast clean ups cleanups ast create ast createast unit options sub progress monitor subprogressmonitor monitor clean up context cleanupcontext context changed regions changedregions context clean up context cleanupcontext unit ast context multi line clean up context multilinecleanupcontext unit ast changed regions changedregions array list arraylist i clean up icleanup undo ne clean ups undonecleanups array list arraylist clean up change cleanupchange change clean up refactoring cleanuprefactoring calculate change calculatechange context clean ups cleanups undo ne clean ups undonecleanups slow clean ups slowcleanups refactoring status refactoringstatus post condition postcondition refactoring status refactoringstatus clean ups cleanups length refactoring status refactoringstatus conditions clean ups cleanups check post conditions checkpostconditions sub progress monitor subprogressmonitor monitor post condition postcondition merge conditions show status showstatus post condition postcondition window clean ups cleanups undo ne clean ups undonecleanups to array toarray i clean up icleanup undo ne clean ups undonecleanups size change result add change change set save mode setsavemode text file change textfilechange leave dirty change initialize validation data initializevalidationdata null progress monitor nullprogressmonitor perform change operation performchangeoperation perform change operation performchangeoperation perform change operation performchangeoperation change perform change operation performchangeoperation set scheduling rule setschedulingrule unit get scheduling rule getschedulingrule changed regions changedregions changed regions changedregions length requires changed regions requireschangedregions clean ups cleanups changed regions changedregions perform with changed region update performwithchangedregionupdate perform change operation performchangeoperation changed regions changedregions unit sub progress monitor subprogressmonitor monitor perform change operation performchangeoperation sub progress monitor subprogressmonitor monitor perform change operation performchangeoperation get undo change getundochange undo edits undoedits add first addfirst change get undo edit getundoedit clean ups cleanups length success manager change performed changeperformed result success undo edits undoedits size undo edit undoedit undo edit array undoeditarray undo edits undoedits to array toarray undo edit undoedit undo edits undoedits size clean up save undo cleanupsaveundo undo clean up save undo cleanupsaveundo result get name getname i file ifile unit get resource getresource undo edit array undoeditarray old doc value olddocvalue old file value oldfilevalue undo initialize validation data initializevalidationdata null progress monitor nullprogressmonitor manager add undo addundo result get name getname undo slow clean ups slowcleanups slow clean ups slowcleanups size show slow clean ups warning showslowcleanupswarning slow clean ups slowcleanups monitor i clean up icleanup get clean ups getcleanups i project iproject project core exception coreexception i clean up icleanup clean ups cleanups map string string settings clean up preference util cleanuppreferenceutil load save participant options loadsaveparticipantoptions project scope projectscope project settings i eclipse preferences ieclipsepreferences context node contextnode instance scope instancescope instance get node getnode javaui plugin string context node contextnode clean up constants cleanupconstants cleanup save profile default scope defaultscope instance get node getnode javaui plugin clean up constants cleanupconstants cleanup save profile clean up constants cleanupconstants save participant profile core exception coreexception status i status istatus error javaui plugin messages format fix messages fixmessages clean up post save listener cleanuppostsavelistener unknown profile error message clean up options cleanupoptions equals settings clean up constants cleanupconstants cleanup save add itional additional options clean ups cleanups get clean ups getcleanups settings hash map hashmap string string filtered set tins filteredsettins hash map hashmap filtered set tins filteredsettins clean up constants cleanupconstants format source code settings clean up constants cleanupconstants format source code filtered set tins filteredsettins clean up constants cleanupconstants format source code settings clean up constants cleanupconstants format source code filtered set tins filteredsettins clean up constants cleanupconstants organize imports settings clean up constants cleanupconstants organize imports string ids hash set hashset nls ids add org eclipse jdt cleanup format nls ids add org eclipse jdt cleanup imports clean ups cleanups get clean ups getcleanups filtered set tins filteredsettins ids clean ups cleanups i clean up icleanup get clean ups getcleanups map string string settings string ids i clean up icleanup result java plugin javaplugin get default getdefault get clean up registry getcleanupregistry create clean ups createcleanups ids result length result set options setoptions map clean up options mapcleanupoptions settings result show status showstatus refactoring status refactoringstatus status status has error haserror window shell shell platformui get workbench getworkbench get active workbench window getactiveworkbenchwindow get shell getshell nls dialog dialog refactoringui create refactoring status dialog createrefactoringstatusdialog status shell dialog open get document stamp getdocumentstamp i file ifile file i progress monitor iprogressmonitor monitor core exception coreexception i text file buffer manager itextfilebuffermanager manager file buffers filebuffers get text file buffer manager gettextfilebuffermanager i path ipath path file get full path getfullpath nls monitor begin task begintask i text file buffer itextfilebuffer buffer manager connect path location kind locationkind ifile sub progress monitor subprogressmonitor monitor buffer manager get text file buffer gettextfilebuffer path location kind locationkind ifile i document idocument document buffer get document getdocument document i document extension idocumentextension i document extension idocumentextension document get modification stamp getmodificationstamp file get modification stamp getmodificationstamp buffer manager disconnect path location kind locationkind ifile sub progress monitor subprogressmonitor monitor monitor i region iregion perform with changed region update performwithchangedregionupdate perform change operation performchangeoperation perform change operation performchangeoperation i region iregion changed regions changedregions i compilation unit icompilationunit unit i progress monitor iprogressmonitor monitor core exception coreexception i text file buffer manager itextfilebuffermanager manager file buffers filebuffers get text file buffer manager gettextfilebuffermanager i path ipath path unit get resource getresource get full path getfullpath nls monitor begin task begintask i text file buffer itextfilebuffer buffer manager connect path location kind locationkind ifile sub progress monitor subprogressmonitor monitor buffer manager get text file buffer gettextfilebuffer path location kind locationkind ifile i document idocument document buffer get document getdocument document add position category addpositioncategory changed region position category default position updater defaultpositionupdater update r updater default position updater defaultpositionupdater changed region position category document add position updater addpositionupdater update r updater position positions position changed regions changedregions length changed regions changedregions length position position position changed regions changedregions get offset getoffset changed regions changedregions get length getlength document add position addposition changed region position category position positions position bad location exception badlocationexception wrap bad location exception wrapbadlocationexception bad position category exception badpositioncategoryexception wrap bad position category exception wrapbadpositioncategoryexception perform change operation performchangeoperation sub progress monitor subprogressmonitor monitor array list arraylist region result array list arraylist positions length position position positions position is deleted isdeleted result add region position get offset getoffset position get length getlength result to array toarray i region iregion result size document remove position updater removepositionupdater update r updater document remove position category removepositioncategory changed region position category bad position category exception badpositioncategoryexception wrap bad position category exception wrapbadpositioncategoryexception buffer manager disconnect path location kind locationkind ifile sub progress monitor subprogressmonitor monitor monitor requiresast i clean up icleanup clean ups cleanups clean ups cleanups length clean ups cleanups get requirements getrequirements requiresast requires changed regions requireschangedregions i clean up icleanup clean ups cleanups clean ups cleanups length clean up requirements cleanuprequirements requirements clean ups cleanups get requirements getrequirements requirements requires changed regions requireschangedregions compilation unit compilationunit create ast createast i compilation unit icompilationunit unit map string string clean up options cleanupoptions i progress monitor iprogressmonitor monitor i java project ijavaproject project unit get java project getjavaproject compatible options compatibleoptions project clean up options cleanupoptions compilation unit compilationunit ast sharedastprovider getast unit sharedastprovider wait monitor ast ast ast parser astparser parser clean up refactoring cleanuprefactoring createcleanupastparser parser set source setsource unit map string string compiler options compileroptions refactoringastparser get compiler options getcompileroptions unit get java project getjavaproject compiler options compileroptions put all putall clean up options cleanupoptions parser set compiler options setcompileroptions compiler options compileroptions compilation unit compilationunit parser createast monitor compatible options compatibleoptions i java project ijavaproject project map string string clean up options cleanupoptions clean up options cleanupoptions size map string string project options projectoptions project get options getoptions iterator string iterator clean up options cleanupoptions key set keyset iterator iterator has next hasnext string key iterator string project option projectoption project options projectoptions key string clean up option cleanupoption clean up options cleanupoptions key str onger equals strongerequals project option projectoption clean up option cleanupoption str onger equals strongerequals string project option projectoption string clean up option cleanupoption project option projectoption error equals clean up option cleanupoption error equals project option projectoption warning equals clean up option cleanupoption error equals project option projectoption warning equals project option projectoption override string get name getname fix messages fixmessages clean up post save listener cleanuppostsavelistener override string get i d getid post save list ener postsavelistener core exception coreexception wrap bad location exception wrapbadlocationexception bad location exception badlocationexception string message get message getmessage message nls message bad location exception badlocationexception core exception coreexception status i status istatus error javaui plugin i refactoring core status codes irefactoringcorestatuscodes bad location message core exception coreexception wrap bad position category exception wrapbadpositioncategoryexception bad position category exception badpositioncategoryexception string message get message getmessage message nls message bad position category exception badpositioncategoryexception core exception coreexception status i status istatus error javaui plugin message show slow clean ups warning showslowcleanupswarning hash set hashset i clean up icleanup slow clean ups slowcleanups string buffer stringbuffer clean up names cleanupnames string buffer stringbuffer iterator i clean up icleanup iterator slow clean ups slowcleanups iterator iterator has next hasnext i clean up icleanup clean up cleanup iterator string descriptions clean up cleanup get step descriptions getstepdescriptions descriptions descriptions length clean up names cleanupnames length clean up names cleanupnames append clean up names cleanupnames append descriptions display get current getcurrent show slow clean up dialog showslowcleanupdialog clean up names cleanupnames display get default getdefault async exec asyncexec runnable override show slow clean up dialog showslowcleanupdialog clean up names cleanupnames show slow clean up dialog showslowcleanupdialog string buffer stringbuffer clean up names cleanupnames optional message dialog optionalmessagedialog is dialog enabled isdialogenabled slow clean up warning dialog slowcleanupwarningdialog shell shell platformui get workbench getworkbench get active workbench window getactiveworkbenchwindow get shell getshell slow clean up warning dialog slowcleanupwarningdialog shell fix messages fixmessages clean up post save listener cleanuppostsavelistener slow clean up dialog slowcleanupdialog title clean up names cleanupnames to string tostring open
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation nina rinskaya https bugs eclipse org bugs bug cgi stephan herrmann contribution annotate proposals adding external annotations library classes https bugs eclipse org org eclipse jdt tests quickfix java file java file output stream fileoutputstream java file name filter filenamefilter java io exception ioexception java print writer printwriter java util array list arraylist java util hash map hashmap java util locale java util map java util string tokenizer stringtokenizer java util zip zip entry zipentry java util zip zip output stream zipoutputstream org eclipse jdt internal compiler class file classfile org eclipse jdt internal compiler compilation result compilationresult org eclipse jdt internal compiler compiler org eclipse jdt internal compiler i compiler requestor icompilerrequestor org eclipse jdt internal compiler i error handling policy ierrorhandlingpolicy org eclipse jdt internal compiler i problem factory iproblemfactory org eclipse jdt internal compiler batch compilation unit compilationunit org eclipse jdt internal compiler batch file system filesystem org eclipse jdt internal compiler env i name environment inameenvironment org eclipse jdt internal compiler impl compiler options compileroptions org eclipse jdt internal compiler problem default problem factory defaultproblemfactory reduced margin ally marginally adjusted copy org eclipse jdt core tests util util suppress warnings suppresswarnings javadoc jar util jarutil trace delete operation maximum time was ted wasted repeating delete operations running jdt core tests delete max time trace deletion operations running jdt core tests delete debug maximum time wait deletion operation running jdt core tests seconds number exc eed exceed minute avoid loops waiting ten waiting repeating ten loops waiting loops waiting delete max wait init ially initially output directory located system get property getproperty java tmpdir comp test comptest user compiler tests time main output directory located directory comp test comptest code system current millis econds currentmilliseconds code delay clean previous string output directory user delay hours output directories removed file system starting test hours note time hour negative previous directories removed output directory string delay clean previous system get property getproperty delay initializer clean directories created running previous test suites delay cleaning directories milliseconds per hour millisecondsperhour previous directories hours delay milliseconds per hour millisecondsperhour delay clean previous hours parse float parsefloat delay clean previous delay milliseconds per hour millisecondsperhour hours number format exception numberformatexception nfe output directory root system properties string container system get property getproperty jdt test output directory container container system get property getproperty java tmpdir container current directory container file root directory character is lower case islowercase container char at charat container char at charat container character to upper case touppercase container char at charat container substring file dir file file container comp test comptest root directory exists clean dir exists system current time millis currenttimemillis dir last modified lastmodified delay remove directory content flush directory content flushdirectorycontent dir remove dirs file test dirs testdirs dir list files listfiles test dirs testdirs length test dirs testdirs is directory isdirectory test dirs testdirs last modified lastmodified delay delete test dirs testdirs computed test directory based current time file date dir datedir file dir system current time millis currenttimemillis string path dir pathdir path dir pathdir date dir datedir get canonical path getcanonicalpath io exception ioexception path dir pathdir date dir datedir get absolute path getabsolutepath output directory path dir pathdir compilation unit compilationunit compilation units compilationunits string test files testfiles length test files testfiles length compilation unit compilationunit result compilation unit compilationunit length length result compilation unit compilationunit test files testfiles to char array tochararray test files testfiles result event ually eventually replaced java util function predicate compilation result compilationresult class file filter classfilefilter include compilation result compilationresult unit result unitresult inlined simplified modified jdt requestor i compiler requestor icompilerrequestor has errors haserrors string output path outputpath string problem log problemlog class file filter classfilefilter class file filter classfilefilter requestor class file filter classfilefilter class file filter classfilefilter class file filter classfilefilter class file filter classfilefilter class file filter classfilefilter errors class file filter classfilefilter class file filter classfilefilter override include compilation result compilationresult unit result unitresult unit result unitresult unit result unitresult has errors haserrors override accept result acceptresult compilation result compilationresult compilation result compilationresult has errors haserrors compilation result compilationresult has errors haserrors problem log problemlog compilation result compilationresult to string tostring output class files outputclassfiles compilation result compilationresult output class files outputclassfiles compilation result compilationresult unit result unitresult class file filter classfilefilter include unit result unitresult class file classfile class files classfiles unit result unitresult get class files getclassfiles output path outputpath file count filecount class files classfiles length file count filecount retrieve key class file classfile class file classfile class file classfile class files classfiles string relative name relativename string class file classfile file name filename replace file separator char separatorchar org eclipse jdt internal compiler util util write to disk writetodisk output path outputpath relative name relativename class file classfile io exception ioexception print stack trace printstacktrace compile string paths and contents pathsandcontents map string string options string classpath string output path outputpath class file filter classfilefilter class file filter classfilefilter i problem factory iproblemfactory problem factory problemfactory default problem factory defaultproblemfactory locale get default getdefault requestor requestor requestor class file filter classfilefilter requestor output path outputpath output path outputpath ends with endswith file separator output path outputpath output path outputpath file separator string class libs classlibs get java class libs getjavaclasslibs classpath length classpath length class libs length classlibslength class libs classlibs length system arraycopy classpath classpath string length class libs length classlibslength length system arraycopy class libs classlibs classpath length class libs length classlibslength classpath class libs classlibs i name environment inameenvironment name environment nameenvironment file system filesystem classpath string i error handling policy ierrorhandlingpolicy error handling policy errorhandlingpolicy i error handling policy ierrorhandlingpolicy override proceed on errors proceedonerrors override stop on first error stoponfirsterror override ignore all errors ignoreallerrors compiler options compileroptions compiler options compileroptions compiler options compileroptions options compiler options compileroptions perform methods full recovery performmethodsfullrecovery compiler options compileroptions perform statements recovery performstatementsrecovery compiler batch compiler batchcompiler compiler name environment nameenvironment error handling policy errorhandlingpolicy compiler options compileroptions requestor problem factory problemfactory batch compiler batchcompiler options produce reference info producereferenceinfo compile files batch compiler batchcompiler compile compilation units compilationunits paths and contents pathsandcontents cleanup name environment nameenvironment cleanup requestor has errors haserrors problem log empty problems system err print requestor problem log problemlog create file createfile string path string contents io exception ioexception file output stream fileoutputstream output file output stream fileoutputstream path output write contents get bytes getbytes output close create jar createjar string paths and contents pathsandcontents string extra paths and contents extrapathsandcontents map string string options class file filter classfilefilter class file filter classfilefilter string classpath string jar path jarpath io exception ioexception string classes path classespath get output directory getoutputdirectory file separator classes file classes dir classesdir file classes path classespath flush directory content flushdirectorycontent classes dir classesdir paths and contents pathsandcontents compile paths and contents pathsandcontents options classpath classes path classespath class file filter classfilefilter extra paths and contents extrapathsandcontents extra paths and contents extrapathsandcontents length loop file output file outputfile file classes path classespath extra paths and contents extrapathsandcontents output file outputfile get parent file getparentfile mkdirs jar util jarutil write to file writetofile extra paths and contents extrapathsandcontents output file outputfile get absolute path getabsolutepath zip classes dir classesdir jar path jarpath create jar createjar string java paths and contents javapathsandcontents string extra paths and contents extrapathsandcontents string jar path jarpath string classpath string compliance map string string options class file filter classfilefilter class file filter classfilefilter io exception ioexception map string string compile options compileoptions get compile options getcompileoptions compliance options compile options compileoptions put all putall options create jar createjar java paths and contents javapathsandcontents extra paths and contents extrapathsandcontents compile options compileoptions class file filter classfilefilter classpath jar path jarpath create source zip createsourcezip string paths and contents pathsandcontents string zip path zippath io exception ioexception string sources path sourcespath get output directory getoutputdirectory file separator sources create source dir createsourcedir paths and contents pathsandcontents sources path sourcespath zip file sources path sourcespath zip path zippath create source dir createsourcedir string paths and contents pathsandcontents string sources path sourcespath io exception ioexception flush directory content flushdirectorycontent file sources path sourcespath length paths and contents pathsandcontents length length string source path sourcepath sources path sourcespath file separator paths and contents pathsandcontents file source file sourcefile file source path sourcepath source file sourcefile get parent file getparentfile mkdirs create file createfile source path sourcepath paths and contents pathsandcontents delete file directory insure file longer file system directory delete hierarchy param file file directory delete iff file delete delete file file flush directory content file is directory isdirectory flush directory content flushdirectorycontent file remove file file delete is file deleted isfiledeleted file wait until file deleted waituntilfiledeleted file flush content directory leaving empty directory flush directory content flushdirectorycontent file dir file files dir list files listfiles files max files length max delete files map string string get compile options getcompileoptions string compliance map string string options hash map hashmap options compiler options compileroptions option compliance compliance options compiler options compileroptions option source compliance options compiler options compileroptions option target platform targetplatform compliance options search user hard drive java library returns string get java class libs getjavaclasslibs check bootclasspath properties sun j rock it jrockit harmony vm s vms nls string bootclasspath property bootclasspathproperty system get property getproperty sun boot path bootclasspath property bootclasspathproperty bootclasspath property bootclasspathproperty length ibm vm s vms nls bootclasspath property bootclasspathproperty system get property getproperty boot path bootclasspath property bootclasspathproperty bootclasspath property bootclasspathproperty length harmony ibm vme nls bootclasspath property bootclasspathproperty system get property getproperty org apache harmony boot path string jars bootclasspath property bootclasspathproperty bootclasspath property bootclasspathproperty length string tokenizer stringtokenizer tokenizer string tokenizer stringtokenizer bootclasspath property bootclasspathproperty file path separator pathseparator size tokenizer count tokens counttokens jars string size tokenizer has more tokens hasmoretokens string file name filename to native path tonativepath tokenizer next token nexttoken file file name filename exists jars file name filename size resize system arraycopy jars jars string string jre dir jredir getjredirectory string os name osname system get property getproperty jre dir jredir string os name osname starts with startswith mac string to native path tonativepath jre dir jredir classes classes jar string vm name vmname system get property getproperty java equals vm name vmname string to native path tonativepath jre dir jredir lib jcl max jclmax classes zip string jars names jarsnames array list arraylist string paths array list arraylist drlvm equals vm name vmname file name filter filenamefilter jar filter jarfilter file name filter filenamefilter override accept file dir string ends with endswith jar ends with endswith src jar jars names jarsnames file jre dir jredir lib boot list jar filter jarfilter add jar entries addjarentries jre dir jredir lib boot jars names jarsnames paths jars names jarsnames string lib jar lib jar lib core jar lib security jar lib xml jar lib graphics jar add jar entries addjarentries jre dir jredir jars names jarsnames paths jars string paths size paths to array toarray jars jars add jar entries addjarentries string jre dir jredir string jar names jarnames array list arraylist string paths max jar names jarnames length max string current name currentname jre dir jredir jar names jarnames file file current name currentname exists paths add to native path tonativepath current name currentname returns jre directory tests running returns org eclipse jdt core tests util util getjredirectory string getjredirectory system get property getproperty java search user hard drive output directory returns org eclipse jdt core tests util util get output directory getoutputdirectory string get output directory getoutputdirectory output directory returns parent child file matching file param file searched file parent parent child matching file file get parent child file getparentchildfile file file file parent file get parent file getparentfile parent parent exists file files parent list files listfiles length files files length length length files file files files equals file files files get path getpath equals file get path getpath files returns test stack elements info test running string get test name gettestname stack trace element stacktraceelement elements exception get stack trace getstacktrace idx length elements length idx length elements idx get class name getclassname starts with startswith org eclipse jdt loop jdt core appears stack idx length stack trace element stacktraceelement test element testelement idx length elements idx get class name getclassname starts with startswith org eclipse jdt test element testelement elements idx test element testelement test element testelement get class name getclassname test element testelement get method name getmethodname returns file deleted rely link file exists method parent children link get parent child file getparentchildfile file param file file test deleted file exist parent children is file deleted isfiledeleted file file file exists get parent child file getparentchildfile file print file indentation read link file can read canread write link file can write canwrite exists link file exists file link file is file isfile directory link file is directory isdirectory hidden link file is hidden ishidden recurse level parents hierarchy display children rec usre recusre parent hierarchy avoid infinite loop param file file display param indent number tab print param recurse display code recurse code parents hierarchy negative display children print file info printfileinfo file file indent recurse string tab indent tab system print tab file get name getname file info string sep file can read canread system print read sep file can write canwrite system print sep write sep file exists system print sep exist sep file is directory isdirectory system print sep dir sep file is file isfile system print sep file sep file is hidden ishidden system print sep hidden sep system println file files file list files listfiles length files files length length children recurse system print tab children children system println length children display children print file info printfileinfo files indent system print system print files get name getname files is directory isdirectory system print dir files is file isfile system print file system print children system println recurse file parent file get parent file getparentfile parent print file info printfileinfo parent indent recurse print stack trace jdt elements param exception exception stack trace fake exception param indent number tab display stack elements display print jdt stack trace printjdtstacktrace exception exception indent string tab indent tab stack trace element stacktraceelement elements exception exception exception get stack trace getstacktrace idx length elements length idx length elements idx get class name getclassname starts with startswith org eclipse jdt loop jdt core appears stack idx length system print tab stack trace exception system println system println exception exception idx length elements idx get class name getclassname starts with startswith org eclipse jdt stack trace element stacktraceelement test element testelement elements idx system println tab test element testelement exception print stack trace printstacktrace system path path path separators returned file get path getpath trim min g trimming extra slash string to native path tonativepath string path string native path nativepath path replace file separator char separatorchar replace file separator char separatorchar native path nativepath ends with endswith native path nativepath ends with endswith native path nativepath substring native path nativepath length native path nativepath wait at least waitatleast time start system current time millis currenttimemillis thread sleep time interrupted exception interruptedexception system current time millis currenttimemillis start time wait until file deleted waituntilfiledeleted file file delete debug system println system println warning test get test name gettestname system println problems occured deleting file print jdt stack trace printjdtstacktrace print file info printfileinfo file get parent file getparentfile system print wait delete max wait max count delay max retry maxretry delete max wait delay time count max retry maxretry count thread sleep delay time delay time delete max time delete max time time delete debug system print file exists file delete delete debug system println system println file removed time max delete max time system println is file deleted isfiledeleted file delete debug system println system println file disappeared time max delete max time system println count delay count delay max retry maxretry delete max wait delay delete max wait delay max retry maxretry interrupted exception interruptedexception delete debug system println system println warning test get test name gettestname system println problems occured deleting file print jdt stack trace printjdtstacktrace print file info printfileinfo file get parent file getparentfile system println system println error file deleted waited delete max time system println write to file writetofile string contents string destination file path destinationfilepath file dest file destfile file destination file path destinationfilepath file output stream fileoutputstream output print writer printwriter writer output file output stream fileoutputstream dest file destfile writer print writer printwriter output writer print contents writer flush io exception ioexception print stack trace printstacktrace writer writer close zip file root dir rootdir string zip path zippath io exception ioexception zip output stream zipoutputstream zip file zip file zipfile file zip path zippath zip file zipfile exists delete zip file zipfile io exception ioexception delete zip path zippath time to wait timetowait wait at least waitatleast time to wait timetowait zip file zipfile get parent file getparentfile mkdirs zip zip output stream zipoutputstream file output stream fileoutputstream zip file zipfile zip root dir rootdir zip root dir rootdir get path getpath length zip zip close zip file dir zip output stream zipoutputstream zip root path length rootpathlength io exception ioexception file files dir list files listfiles files length files length length file file files file is file isfile string path file get path getpath path path substring root path length rootpathlength zip entry zipentry entry zip entry zipentry path replace zip put next entry putnextentry entry zip write org eclipse jdt internal compiler util util get file byte content getfilebytecontent file zip close entry closeentry zip file zip root path length rootpathlength
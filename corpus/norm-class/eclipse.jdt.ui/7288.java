copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt tests refactoring java buffered reader bufferedreader java byte array input stream bytearrayinputstream java io exception ioexception java input stream inputstream java input stream reader inputstreamreader java util array list arraylist java util arrays java util hash set hashset java util list java util junit framework test case testcase org eclipse jdt test plugin testplugin java project helper javaprojecthelper org eclipse core runtime core exception coreexception org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core resources i file ifile org eclipse core resources i resource iresource org eclipse core resources i resource change event iresourcechangeevent org eclipse core resources i resource change listener iresourcechangelistener org eclipse core resources i workspace iworkspace org eclipse core resources resources plugin resourcesplugin org eclipse ltk core refactoring change org eclipse ltk core refactoring change descriptor changedescriptor org eclipse ltk core refactoring check conditions operation checkconditionsoperation org eclipse ltk core refactoring create change operation createchangeoperation org eclipse ltk core refactoring i undo manager iundomanager org eclipse ltk core refactoring perform change operation performchangeoperation org eclipse ltk core refactoring refactoring org eclipse ltk core refactoring refactoring change descriptor refactoringchangedescriptor org eclipse ltk core refactoring refactoring contribution refactoringcontribution org eclipse ltk core refactoring refactoring core refactoringcore org eclipse ltk core refactoring refactoring descriptor refactoringdescriptor org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse jdt core i classpath entry iclasspathentry org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i field ifield org eclipse jdt core i java element ijavaelement org eclipse jdt core i java project ijavaproject org eclipse jdt core i member imember org eclipse jdt core i method imethod org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core i package fragment root ipackagefragmentroot org eclipse jdt core i source manipulation isourcemanipulation org eclipse jdt core i type itype org eclipse jdt core java model exception javamodelexception org eclipse jdt core refactoring descriptors java refactoring descriptor javarefactoringdescriptor org eclipse jdt internal corext refactoring util java element util javaelementutil org eclipse jdt internal corext util strings org eclipse jdt tests refactoring infra refactoring test plugin refactoringtestplugin refactoring test refactoringtest test case testcase code code descriptor created change descriptor create refactoring refactoring time consuming code code descriptor test i package fragment root ipackagefragmentroot f root froot i package fragment ipackagefragment f package p fpackagep f is verbose fisverbose f is pre delta test fispredeltatest string test path prefix string test input infix string test output infix string container src list string project resource children arrays as list aslist string project classpath settings refactoring test refactoringtest string override set up setup exception f root froot refactoring test setup refactoringtestsetup get default source folder getdefaultsourcefolder f package p fpackagep refactoring test setup refactoringtestsetup get package p getpackagep f is pre delta test fispredeltatest f is verbose fisverbose system println system println n test ntest get class getclass get name getname refactoring core refactoringcore get undo manager getundomanager flush must perform dummy search mustperformdummysearch exception java project helper javaprojecthelper must perform dummy search mustperformdummysearch get package p getpackagep perform dummy search performdummysearch exception java project helper javaprojecthelper perform dummy search performdummysearch get package p getpackagep removes contents link get package p getpackagep link get root getroot java project src jre library exception errors override tear down teardown exception refresh from local refreshfromlocal perform dummy search performdummysearch p exists pexists get package p getpackagep exists p exists pexists try deleting all java children trydeletingalljavachildren get package p getpackagep try deleting all non java child resources trydeletingallnonjavachildresources get package p getpackagep get root getroot exists i java element ijavaelement packages get root getroot get children getchildren packages length i package fragment ipackagefragment pack i package fragment ipackagefragment packages pack equals get package p getpackagep pack exists pack is read only isreadonly pack is default package isdefaultpackage delete packages sub packages subpackages java project helper javaprojecthelper delete package deletepackage pack delete packages sub packages subpackages java project helper javaprojecthelper delete pack get resource getresource restore p exists pexists get root getroot create package fragment createpackagefragment try deleting all non java child resources trydeletingallnonjavachildresources get root getroot restore test project restoretestproject restore test project restoretestproject exception i java project ijavaproject java project javaproject get root getroot get java project getjavaproject java project javaproject exists i classpath entry iclasspathentry src entry srcentry get root getroot get raw classpath entry getrawclasspathentry i classpath entry iclasspathentry jre entry jreentry refactoring test setup refactoringtestsetup getjrelibrary get raw classpath entry getrawclasspathentry i classpath entry iclasspathentry cpes java project javaproject get raw classpath getrawclasspath array list arraylist i classpath entry iclasspathentry newcpes array list arraylist cp changed cpchanged cpes length i classpath entry iclasspathentry cpe cpes cpe equals src entry srcentry cpe equals jre entry jreentry newcpes add cpe cp changed cpchanged cp changed cpchanged i classpath entry iclasspathentry newcpesarray newcpes to array toarray i classpath entry iclasspathentry newcpes size java project javaproject set raw classpath setrawclasspath newcpesarray object non java resources nonjavaresources java project javaproject get non java resources getnonjavaresources non java resources nonjavaresources length object kid non java resources nonjavaresources kid i resource iresource i resource iresource resource i resource iresource kid project resource children resource get name getname java project helper javaprojecthelper delete resource refresh from local refreshfromlocal core exception coreexception get root getroot exists get root getroot get resource getresource refresh local refreshlocal i resource iresource depth infinite don refresh root ref res hed refreshed get package p getpackagep exists get package p getpackagep get resource getresource refresh local refreshlocal i resource iresource depth infinite try deleting all non java child resources trydeletingallnonjavachildresources i package fragment ipackagefragment pack core exception coreexception object non java kids nonjavakids pack get non java resources getnonjavaresources non java kids nonjavakids length non java kids nonjavakids i resource iresource i resource iresource resource i resource iresource non java kids nonjavakids java project helper javaprojecthelper delete resource try deleting all non java child resources trydeletingallnonjavachildresources i package fragment root ipackagefragmentroot root core exception coreexception object non java kids nonjavakids root get non java resources getnonjavaresources non java kids nonjavakids length non java kids nonjavakids i resource iresource i resource iresource resource i resource iresource non java kids nonjavakids java project helper javaprojecthelper delete resource try deleting all java children trydeletingalljavachildren i package fragment ipackagefragment pack core exception coreexception i java element ijavaelement kids pack get children getchildren kids length kids i source manipulation isourcemanipulation kids exists kids is read only isreadonly java project helper javaprojecthelper delete kids i package fragment root ipackagefragmentroot get root getroot f root froot i package fragment ipackagefragment get package p getpackagep f package p fpackagep refactoring status refactoringstatus perform refactoring performrefactoring refactoring descriptor refactoringdescriptor descriptor exception perform refactoring performrefactoring descriptor refactoring status refactoringstatus perform refactoring performrefactoring refactoring descriptor refactoringdescriptor descriptor provides undo providesundo exception refactoring refactoring create refactoring createrefactoring descriptor perform refactoring performrefactoring refactoring provides undo providesundo refactoring create refactoring createrefactoring refactoring descriptor refactoringdescriptor descriptor core exception coreexception refactoring status refactoringstatus status refactoring status refactoringstatus refactoring refactoring descriptor create refactoring createrefactoring status assert not null assertnotnull refactoring refactoring assert true asserttrue status status isok refactoring refactoring status refactoringstatus perform refactoring performrefactoring refactoring exception perform refactoring performrefactoring refactoring status refactoringstatus perform refactoring performrefactoring refactoring provides undo providesundo exception perform dummy search performdummysearch i undo manager iundomanager undo manager undomanager get undo manager getundomanager descriptor test create change operation createchangeoperation create create change operation createchangeoperation check conditions operation checkconditionsoperation check conditions operation checkconditionsoperation conditions refactoring status refactoringstatus fatal create null progress monitor nullprogressmonitor refactoring status refactoringstatus checking status checkingstatus create get condition checking status getconditioncheckingstatus checking status checkingstatus isok checking status checkingstatus change change create get change getchange change descriptor changedescriptor descriptor change get descriptor getdescriptor descriptor refactoring change descriptor refactoringchangedescriptor refactoring change descriptor refactoringchangedescriptor rcd refactoring change descriptor refactoringchangedescriptor descriptor refactoring descriptor refactoringdescriptor refactoring descriptor refactoringdescriptor rcd get refactoring descriptor getrefactoringdescriptor refactoring descriptor refactoringdescriptor java refactoring descriptor javarefactoringdescriptor java refactoring descriptor javarefactoringdescriptor jrd java refactoring descriptor javarefactoringdescriptor refactoring descriptor refactoringdescriptor refactoring status refactoringstatus validation jrd validate descriptor validatedescriptor validation isok validation refactoring status refactoringstatus refactoring status refactoringstatus refactoring status refactoringstatus java refactoring descriptor javarefactoringdescriptor expected jrd get class getclass refactoring contribution refactoringcontribution contribution refactoring core refactoringcore get refactoring contribution getrefactoringcontribution jrd getid jrd java refactoring descriptor javarefactoringdescriptor contribution create descriptor createdescriptor jrd getid jrd get project getproject jrd get description getdescription jrd get comment getcomment contribution retrieve argument map retrieveargumentmap jrd jrd get flags getflags assert equals assertequals expected jrd get class getclass jrd create refactoring createrefactoring refactoring status refactoringstatus refactoring status refactoringstatus isok refactoring status refactoringstatus test rename participant single testrenameparticipantsingle reset test create participant single testcreateparticipantsingle reset test move participant single testmoveparticipantsingle reset test delete participant single testdeleteparticipantsingle reset create change operation createchangeoperation create create change operation createchangeoperation check conditions operation checkconditionsoperation check conditions operation checkconditionsoperation conditions refactoring status refactoringstatus fatal perform change operation performchangeoperation perform perform change operation performchangeoperation create perform set undo manager setundomanager undo manager undomanager get name getname i workspace iworkspace workspace resources plugin resourcesplugin get workspace getworkspace f is pre delta test fispredeltatest i resource change listener iresourcechangelistener listener i resource change listener iresourcechangelistener override resource changed resourcechanged i resource change event iresourcechangeevent event create get condition checking status getconditioncheckingstatus isok perform change executed changeexecuted test model provider testmodelprovider assert true asserttrue event get delta getdelta test model provider testmodelprovider clear delta cleardelta workspace check point checkpoint workspace add resource change listener addresourcechangelistener listener execute perform operation executeperformoperation perform workspace workspace remove resource change listener removeresourcechangelistener listener execute perform operation executeperformoperation perform workspace refactoring status refactoringstatus status create get condition checking status getconditioncheckingstatus status isok status assert true asserttrue change was n wasn executed perform change executed changeexecuted change undo perform get undo change getundochange provides undo providesundo assert not null assertnotnull undo doesn exist undo assert true asserttrue undo manager empty undo manager undomanager anything to undo anythingtoundo assert null assertnull undo manager undo should n shouldn undo execute perform operation executeperformoperation perform change operation performchangeoperation perform i workspace iworkspace workspace core exception coreexception workspace perform null progress monitor nullprogressmonitor refactoring status refactoringstatus perform refactoring with status performrefactoringwithstatus refactoring exception core exception coreexception refactoring status refactoringstatus status perform refactoring performrefactoring status refactoring status refactoringstatus status change perform change performchange refactoring refactoring store undo storeundo exception create change operation createchangeoperation create create change operation createchangeoperation refactoring perform change operation performchangeoperation perform perform change operation performchangeoperation create store undo storeundo perform set undo manager setundomanager get undo manager getundomanager refactoring get name getname resources plugin resourcesplugin get workspace getworkspace perform null progress monitor nullprogressmonitor assert true asserttrue change was n wasn executed perform change executed changeexecuted perform get undo change getundochange change perform change performchange change change exception perform change operation performchangeoperation perform perform change operation performchangeoperation change resources plugin resourcesplugin get workspace getworkspace perform null progress monitor nullprogressmonitor assert true asserttrue change was n wasn executed perform change executed changeexecuted perform get undo change getundochange i undo manager iundomanager get undo manager getundomanager i undo manager iundomanager undo manager undomanager refactoring core refactoringcore get undo manager getundomanager undo manager undomanager flush undo manager undomanager helpers i type itype get type gettype i compilation unit icompilationunit string java model exception javamodelexception i type itype types get all types getalltypes types length types get type qualified name gettypequalifiedname equals types get element name getelementname equals types subclasses override info rm inform location test cases string get refactoring path getrefactoringpath rename type renametype string get test path gettestpath test path prefix get refactoring path getrefactoringpath string create test file name createtestfilename string cu name cuname string infix get test path gettestpath get name getname infix cu name cuname java string get input test file name getinputtestfilename string cu name cuname create test file name createtestfilename cu name cuname test input infix param sub dir name subdirname org eclipse jdt string get input test file name getinputtestfilename string cu name cuname string sub dir name subdirname create test file name createtestfilename cu name cuname test input infix sub dir name subdirname string get output test file name getoutputtestfilename string cu name cuname create test file name createtestfilename cu name cuname test output infix param sub dir name subdirname org eclipse jdt string get output test file name getoutputtestfilename string cu name cuname string sub dir name subdirname create test file name createtestfilename cu name cuname test output infix sub dir name subdirname i compilation unit icompilationunit create ufrom test file createcufromtestfile i package fragment ipackagefragment pack string cu name cuname exception create ufrom test file createcufromtestfile pack cu name cuname i compilation unit icompilationunit create ufrom test file createcufromtestfile i package fragment ipackagefragment pack string cu name cuname string sub dir name subdirname exception create ufrom test file createcufromtestfile pack cu name cuname sub dir name subdirname i compilation unit icompilationunit create ufrom test file createcufromtestfile i package fragment ipackagefragment pack string cu name cuname input exception string contents input get file contents getfilecontents get input test file name getinputtestfilename cu name cuname get file contents getfilecontents get output test file name getoutputtestfilename cu name cuname createcu pack cu name cuname java contents i compilation unit icompilationunit create ufrom test file createcufromtestfile i package fragment ipackagefragment pack string cu name cuname string sub dir name subdirname input exception string contents input get file contents getfilecontents get input test file name getinputtestfilename cu name cuname sub dir name subdirname get file contents getfilecontents get output test file name getoutputtestfilename cu name cuname sub dir name subdirname createcu pack cu name cuname java contents print test disabled message printtestdisabledmessage string explanation system println get class getclass get name getname get name getname disabled explanation input stream inputstream get stream getstream string content byte array input stream bytearrayinputstream content get bytes getbytes i package fragment root ipackagefragmentroot get source folder getsourcefolder i java project ijavaproject java project javaproject string java model exception javamodelexception i package fragment root ipackagefragmentroot roots java project javaproject get package fragment roots getpackagefragmentroots roots length roots is archive isarchive roots get element name getelementname equals roots string get file contents getfilecontents string file name filename io exception ioexception get contents getcontents get file input stream getfileinputstream file name filename string get contents getcontents i file ifile file io exception ioexception core exception coreexception get contents getcontents file get contents getcontents i compilation unit icompilationunit createcu i package fragment ipackagefragment pack string string contents exception assert true asserttrue pack get compilation unit getcompilationunit exists i compilation unit icompilationunit pack create compilation unit createcompilationunit contents save string get contents getcontents input stream inputstream io exception ioexception buffered reader bufferedreader buffered reader bufferedreader input stream reader inputstreamreader string buffer stringbuffer string buffer stringbuffer read read read append read close to string tostring input stream inputstream get file input stream getfileinputstream string file name filename io exception ioexception refactoring test plugin refactoringtestplugin get default getdefault get test resource stream gettestresourcestream file name filename string remove extension removeextension string file name filename file name filename substring file name filename last index of lastindexof i member imember merge i member imember i member imember i member imember java element util javaelementutil merge java element util javaelementutil merge i member imember merge i member imember i member imember java element util javaelementutil merge i field ifield get fields getfields i type itype type string names names i field ifield i field ifield fields hash set hashset names length i field ifield field type get field getfield names assert true asserttrue field field get element name getelementname exist field exists fields add field fields to array toarray i field ifield fields size i type itype get member types getmembertypes i type itype type string names names i type itype i type itype member types membertypes hash set hashset names length i type itype member type membertype names index of indexof string path names split member type membertype type get type gettype path path length member type membertype member type membertype get type gettype path member type membertype type get type gettype names assert true asserttrue member type member type membertype get element name getelementname exist member type membertype exists member types membertypes add member type membertype member types membertypes to array toarray i type itype member types membertypes size i method imethod get methods getmethods i type itype type string names string signatures names signatures i method imethod list i method imethod methods array list arraylist names length names length i method imethod method type get method getmethod names signatures assert true asserttrue method method get element name getelementname exist method exists methods method methods add method methods to array toarray i method imethod methods size i type itype find types findtypes i type itype types string names of types to pull up namesoftypestopullup list i type itype array list arraylist types length types length i type itype type types names of types to pull up namesoftypestopullup length string names of types to pull up namesoftypestopullup type get element name getelementname equals add type to array toarray i type itype size i field ifield find fields findfields i field ifield fields string names of fields to pull up namesoffieldstopullup list i field ifield array list arraylist fields length fields length i field ifield field fields names of fields to pull up namesoffieldstopullup length string names of fields to pull up namesoffieldstopullup field get element name getelementname equals add field to array toarray i field ifield size i method imethod find methods findmethods i method imethod selected methods selectedmethods string names of methods namesofmethods string signatures of methods signaturesofmethods list i method imethod array list arraylist selected methods selectedmethods length selected methods selectedmethods length i method imethod method selected methods selectedmethods string param types paramtypes method get parameter types getparametertypes names of methods namesofmethods length string method name methodname names of methods namesofmethods method name methodname equals method get element name getelementname string method sig methodsig signatures of methods signaturesofmethods are same signatures aresamesignatures param types paramtypes method sig methodsig add method to array toarray i method imethod size are same signatures aresamesignatures string string length length length equals based version junit framework assert equals assertequals string string delimiters param expected expected param actual actual assert equal lines assertequallines string expected string actual assert equal lines assertequallines expected actual based version junit framework assert equals assertequals string string string delimiters param message message param expected expected param actual actual assert equal lines assertequallines string message string expected string actual string expected lines expectedlines strings convert into lines convertintolines expected string actual lines actuallines strings convert into lines convertintolines actual string expected expected lines expectedlines strings concatenate expected lines expectedlines string actual actual lines actuallines strings concatenate actual lines actuallines assert equals assertequals message expected actual
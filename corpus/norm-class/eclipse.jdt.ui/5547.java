copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt text folding java util array list arraylist java util arrays java util collection java util collections java util comparator java util hash map hashmap java util hash set hashset java util iterator java util linked hash map linkedhashmap java util list java util map java util org eclipse core runtime org eclipse jface preference i preference store ipreferencestore org eclipse jface text bad location exception badlocationexception org eclipse jface text i document idocument org eclipse jface text i region iregion org eclipse jface text position org eclipse jface text region org eclipse jface text text selection textselection org eclipse jface text source annotation org eclipse jface text source projection i projection listener iprojectionlistener org eclipse jface text source projection i projection position iprojectionposition org eclipse jface text source projection projection annotation projectionannotation org eclipse jface text source projection projection annotation model projectionannotationmodel org eclipse jface text source projection projection viewer projectionviewer org eclipse texteditor i document provider idocumentprovider org eclipse texteditor i text editor itexteditor org eclipse jdt core element changed event elementchangedevent org eclipse jdt core i class file iclassfile org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i element changed listener ielementchangedlistener org eclipse jdt core i import container iimportcontainer org eclipse jdt core i import declaration iimportdeclaration org eclipse jdt core i java element ijavaelement org eclipse jdt core i java element delta ijavaelementdelta org eclipse jdt core i member imember org eclipse jdt core i parent iparent org eclipse jdt core i source range isourcerange org eclipse jdt core i source reference isourcereference org eclipse jdt core i type itype org eclipse jdt core java core javacore org eclipse jdt core java model exception javamodelexception org eclipse jdt core source range sourcerange org eclipse jdt core tool factory toolfactory org eclipse jdt core compiler i problem iproblem org eclipse jdt core compiler i scanner iscanner org eclipse jdt core compiler i terminal symbols iterminalsymbols org eclipse jdt core compiler invalid input exception invalidinputexception org eclipse jdt core dom compilation unit compilationunit org eclipse jdt preference constants preferenceconstants org eclipse jdt internal java plugin javaplugin org eclipse jdt internal actions selection converter selectionconverter org eclipse jdt internal java editor javaeditor editor utility editorutility org eclipse jdt internal java editor javaeditor java editor javaeditor org eclipse jdt internal text document character iterator documentcharacteriterator updates projection model file compilation unit clients instantiate subclass subclasses call superclass code overriding methods marked subclasses extend internal api default java folding structure provider defaultjavafoldingstructureprovider i java folding structure provider ijavafoldingstructureprovider i java folding structure provider extension ijavafoldingstructureproviderextension context needed compute folding structure link i compilation unit icompilationunit link i class file iclassfile computed folding regions collected link plain linkplain add projection range addprojectionrange default java folding structure provider defaultjavafoldingstructureprovider java projection annotation javaprojectionannotation position add projection range addprojectionrange folding structure computation context foldingstructurecomputationcontext projection annotation model projectionannotationmodel f model fmodel i document idocument f document fdocument f allow collapsing fallowcollapsing i type itype f first type ffirsttype f has header comment fhasheadercomment linked hash map linkedhashmap java projection annotation javaprojectionannotation position f map fmap linked hash map linkedhashmap i scanner iscanner f scanner fscanner folding structure computation context foldingstructurecomputationcontext i document idocument document projection annotation model projectionannotationmodel model allow collapsing allowcollapsing i scanner iscanner scanner is not null isnotnull document is not null isnotnull model f document fdocument document f model fmodel model f allow collapsing fallowcollapsing allow collapsing allowcollapsing f scanner fscanner scanner set first type setfirsttype i type itype type has first type hasfirsttype illegal state exception illegalstateexception f first type ffirsttype type has first type hasfirsttype f first type ffirsttype i type itype get first type getfirsttype f first type ffirsttype has header comment hasheadercomment f has header comment fhasheadercomment set has header comment sethasheadercomment f has header comment fhasheadercomment returns code code newly created folding regions collapsed code code code code updating folding structure typing code code computing res toring restoring initial folding structure code code newly created folding regions collapsed code code allow collapsing allowcollapsing f allow collapsing fallowcollapsing returns document code folded document code folded i document idocument get document getdocument f document fdocument projection annotation model projectionannotationmodel get model getmodel f model fmodel i scanner iscanner get scanner getscanner f scanner fscanner f scanner fscanner tool factory toolfactory create scanner createscanner f scanner fscanner adds projection folding region context created annotation position pair link projection annotation model projectionannotationmodel link projection viewer projectionviewer editor param annotation annotation add param position position add projection range addprojectionrange java projection annotation javaprojectionannotation annotation position position f map fmap annotation position returns code code header comments collapsed code code header comments collapsed collapse header comments collapseheadercomments f allow collapsing fallowcollapsing f collapse header comments fcollapseheadercomments returns code code containers collapsed code code containers collapsed collapse import container collapseimportcontainer f allow collapsing fallowcollapsing f collapse import container fcollapseimportcontainer returns code code types collapsed code code types collapsed collapse inner types collapseinnertypes f allow collapsing fallowcollapsing f collapse inner types fcollapseinnertypes returns code code javadoc comments collapsed code code javadoc comments collapsed collapse javadoc collapsejavadoc f allow collapsing fallowcollapsing f collapse javadoc fcollapsejavadoc returns code code methods collapsed code code methods collapsed collapse members collapsemembers f allow collapsing fallowcollapsing f collapse members fcollapsemembers link projection annotation projectionannotation java code java projection annotation javaprojectionannotation projection annotation projectionannotation i java element ijavaelement f java element fjavaelement f is comment fiscomment creates projection annotation param is collapsed iscollapsed code code initial collapsed code code expanded param element java element annotation ref ers refers param is comment iscomment code code foldable comment code code foldable code element java projection annotation javaprojectionannotation is collapsed iscollapsed i java element ijavaelement element is comment iscomment is collapsed iscollapsed f java element fjavaelement element f is comment fiscomment is comment iscomment i java element ijavaelement get element getelement f java element fjavaelement set element setelement i java element ijavaelement element f java element fjavaelement element is comment iscomment f is comment fiscomment set is comment setiscomment is comment iscomment f is comment fiscomment is comment iscomment java lang object to string tostring override string to string tostring nls java projection annotation javaprojectionannotation telement f java element fjavaelement to string tostring nls nls tcollapsed is collapsed iscollapsed nls nls tcomment is comment iscomment nls nls tuple java projection annotation javaprojectionannotation annotation position position tuple java projection annotation javaprojectionannotation annotation position position annotation annotation position position filter annotations filter match java projection annotation javaprojectionannotation annotation matches comments comment filter commentfilter filter override match java projection annotation javaprojectionannotation annotation annotation is comment iscomment annotation is marked deleted ismarkeddeleted matches members member filter memberfilter filter override match java projection annotation javaprojectionannotation annotation annotation is comment iscomment annotation is marked deleted ismarkeddeleted i java element ijavaelement element annotation get element getelement element i member imember element get element type getelementtype i java element ijavaelement type i member imember element get declaring type getdeclaringtype matches java elements contained java element set filter javaelementsetfilter filter i java element ijavaelement f set fset f match collapsed fmatchcollapsed java element set filter javaelementsetfilter i java element ijavaelement match collapsed matchcollapsed f set fset f match collapsed fmatchcollapsed match collapsed matchcollapsed override match java projection annotation javaprojectionannotation annotation state match statematch f match collapsed fmatchcollapsed annotation is collapsed iscollapsed state match statematch annotation is comment iscomment annotation is marked deleted ismarkeddeleted i java element ijavaelement element annotation get element getelement f set fset element element changed listener elementchangedlistener i element changed listener ielementchangedlistener org eclipse jdt core i element changed listener ielementchangedlistener element changed elementchanged org eclipse jdt core element changed event elementchangedevent override element changed elementchanged element changed event elementchangedevent i java element delta ijavaelementdelta delta find element findelement f input finput get delta getdelta delta delta get flags getflags i java element delta ijavaelementdelta content i java element delta ijavaelementdelta children should ignore delta shouldignoredelta get delta getdelta get compilation unit t getcompilationunitast delta f updating count fupdatingcount update create context createcontext f updating count fupdatingcount ignore delta errors caret don ignore delta caret isn container param ast compilation unit ast param delta java element delta ast element code code delta should ignore delta shouldignoredelta compilation unit compilationunit ast i java element delta ijavaelementdelta delta ast compute i document idocument document get document getdocument document compute java editor javaeditor editor f editor feditor editor editor get cached selected range getcachedselectedrange compute delta get affected children getaffectedchildren length delta get affected children getaffectedchildren get element getelement i import container iimportcontainer i java element ijavaelement elem selection converter selectionconverter get element at offset getelementatoffset ast get type root gettyperoot text selection textselection editor get cached selected range getcachedselectedrange editor get cached selected range getcachedselectedrange elem i import declaration iimportdeclaration java model exception javamodelexception caret line caretline caret line caretline document get line of offset getlineofoffset editor get cached selected range getcachedselectedrange bad location exception badlocationexception caret line caretline i problem iproblem problems ast get problems getproblems problems length problems is error iserror caret line caretline problems get source line number getsourcelinenumber i java element delta ijavaelementdelta find element findelement i java element ijavaelement target i java element delta ijavaelementdelta delta delta target i java element ijavaelement element delta get element getelement element get element type getelementtype i java element ijavaelement file target equals element delta i java element delta ijavaelementdelta children delta get affected children getaffectedchildren children length i java element delta ijavaelementdelta find element findelement target children projection position foldable regions folding region content content comment comment position commentposition position i projection position iprojectionposition comment position commentposition offset length offset length org eclipse jface text source projection i projection position iprojectionposition compute folding regions computefoldingregions org eclipse jface text i document idocument override i region iregion compute projection regions computeprojectionregions i document idocument document bad location exception badlocationexception document character iterator documentcharacteriterator sequence document character iterator documentcharacteriterator document offset offset length prefix end prefixend content start contentstart find first content findfirstcontent sequence prefix end prefixend first line firstline document get line of offset getlineofoffset offset prefix end prefixend caption line captionline document get line of offset getlineofoffset offset content start contentstart last line lastline document get line of offset getlineofoffset offset length nls is true istrue first line firstline caption line captionline folded greater nls is true istrue caption line captionline last line lastline greater folded i region iregion pre region preregion first line firstline caption line captionline pre region preregion region offset prefix end prefixend content start contentstart prefix end prefixend pre offset preoffset document get line offset getlineoffset first line firstline i region iregion pre end line info preendlineinfo document get line information getlineinformation caption line captionline pre end preend pre end line info preendlineinfo get offset getoffset pre region preregion region pre offset preoffset pre end preend pre offset preoffset pre region preregion caption line captionline last line lastline post offset postoffset document get line offset getlineoffset caption line captionline post length postlength offset length post offset postoffset post length postlength i region iregion post region postregion region post offset postoffset post length postlength pre region preregion i region iregion post region postregion i region iregion pre region preregion post region postregion pre region preregion i region iregion pre region preregion finds offset identifier code content code returns param content content search param prefix end prefixend prefix unicode identifier find first content findfirstcontent char sequence charsequence content prefix end prefixend len ght lenght content length prefix end prefixend len ght lenght character is unicode identifier part isunicodeidentifierpart content char at charat finds offset identifier code content code returns param content content search unicode identifier find prefix end findprefixend char sequence charsequence content leading len content length len is white space iswhitespace content char at charat len content char at charat content char at charat len content char at charat is white space iswhitespace org eclipse jface text source projection i projection position iprojectionposition compute caption offset computecaptionoffset org eclipse jface text i document idocument override compute caption offset computecaptionoffset i document idocument document bad location exception badlocationexception document character iterator documentcharacteriterator sequence document character iterator documentcharacteriterator document offset offset length find first content findfirstcontent sequence projection position foldable regions folding lines simple java element folding lines java element position javaelementposition position i projection position iprojectionposition i member imember f member fmember java element position javaelementposition offset length i member imember member offset length is not null isnotnull member f member fmember member set member setmember i member imember member is not null isnotnull member f member fmember member org eclipse jface text source projection i projection position iprojectionposition compute folding regions computefoldingregions org eclipse jface text i document idocument override i region iregion compute projection regions computeprojectionregions i document idocument document bad location exception badlocationexception name start namestart offset member range correct reconciling trigger element delta lead reentrant situations opt imistically optimistically assume range correct check received lines i source range isourcerange name range namerange f member fmember get name range getnamerange name range namerange name start namestart name range namerange get offset getoffset java model exception javamodelexception first line firstline document get line of offset getlineofoffset offset caption line captionline document get line of offset getlineofoffset name start namestart last line lastline document get line of offset getlineofoffset offset length comment adjust entire folded region rely element deltas correct range caption line captionline first line firstline caption line captionline first line firstline caption line captionline last line lastline caption line captionline last line lastline i region iregion pre region preregion first line firstline caption line captionline pre offset preoffset document get line offset getlineoffset first line firstline i region iregion pre end line info preendlineinfo document get line information getlineinformation caption line captionline pre end preend pre end line info preendlineinfo get offset getoffset pre region preregion region pre offset preoffset pre end preend pre offset preoffset pre region preregion caption line captionline last line lastline post offset postoffset document get line offset getlineoffset caption line captionline post length postlength offset length post offset postoffset post length postlength i region iregion post region postregion region post offset postoffset post length postlength pre region preregion i region iregion post region postregion i region iregion pre region preregion post region postregion pre region preregion i region iregion pre region preregion org eclipse jface text source projection i projection position iprojectionposition compute caption offset computecaptionoffset org eclipse jface text i document idocument override compute caption offset computecaptionoffset i document idocument document bad location exception badlocationexception name start namestart offset reconcile i source range isourcerange name range namerange f member fmember get name range getnamerange name range namerange name start namestart name range namerange get offset getoffset java model exception javamodelexception name start namestart offset internal projection listener projection listener projectionlistener i projection listener iprojectionlistener projection viewer projectionviewer f viewer fviewer registers listener viewer param viewer viewer register listener projection listener projectionlistener projection viewer projectionviewer viewer is legal islegal viewer f viewer fviewer viewer f viewer fviewer add projection listener addprojectionlistener disposes listener removes projection listener viewer dispose f viewer fviewer f viewer fviewer remove projection listener removeprojectionlistener f viewer fviewer org eclipse jface text source projection i projection listener iprojectionlistener projection enabled projectionenabled override projection enabled projectionenabled handle projection enabled handleprojectionenabled org eclipse jface text source projection i projection listener iprojectionlistener projection disabled projectiondisabled override projection disabled projectiondisabled handle projection disabled handleprojectiondisabled context listeners java editor javaeditor f editor feditor projection listener projectionlistener f projection listener fprojectionlistener i java element ijavaelement f input finput i element changed listener ielementchangedlistener f element listener felementlistener preferences f collapse javadoc fcollapsejavadoc f collapse import container fcollapseimportcontainer f collapse inner types fcollapseinnertypes f collapse members fcollapsemembers f collapse header comments fcollapseheadercomments filters member filter matches nested members top level types filter f member filter fmemberfilter member filter memberfilter comment filter matches comments filter f comment filter fcommentfilter comment filter commentfilter reusable scanner i scanner iscanner f shared scanner fsharedscanner tool factory toolfactory create scanner createscanner f updating count fupdatingcount creates folding provider link install i text editor itexteditor projection viewer projectionviewer installed editor viewer pair link uninstall uninstalled longer projection reset calling link initialize default java folding structure provider defaultjavafoldingstructureprovider inherit doc inheritdoc subclasses extend param editor inherit doc inheritdoc param viewer inherit doc inheritdoc override install i text editor itexteditor editor projection viewer projectionviewer viewer is legal islegal editor is legal islegal viewer internal uninstall internaluninstall editor java editor javaeditor f projection listener fprojectionlistener projection listener projectionlistener viewer f editor feditor java editor javaeditor editor inherit doc inheritdoc subclasses extend override uninstall internal uninstall internaluninstall internal implementation link uninstall internal uninstall internaluninstall is installed isinstalled handle projection disabled handleprojectiondisabled f projection listener fprojectionlistener dispose f projection listener fprojectionlistener f editor feditor returns code code provider installed code code code code provider installed code code is installed isinstalled f editor feditor called projection enabled viewer issues link i projection listener iprojectionlistener projection enabled projectionenabled projection enabled projectionenabled message provider enabled method called link handle projection disabled handleprojectiondisabled disabled subclasses extend handle projection enabled handleprojectionenabled http ott oti teams wswb anon vms html projection enabled projectionenabled messages paired projection disabled projectiondisabled multiple enabled messages disable enable message handle projection disabled handleprojectiondisabled is installed isinstalled initialize f element listener felementlistener element changed listener elementchangedlistener java core javacore add element changed listener addelementchangedlistener f element listener felementlistener called projection disabled provider link uninstall uninstalled viewer issues link i projection listener iprojectionlistener projection disabled projectiondisabled projection disabled projectiondisabled message link handle projection enabled handleprojectionenabled enabling provider impl ementations implementations prepared handle multiple calls method provider disabled subclasses extend handle projection disabled handleprojectiondisabled f element listener felementlistener java core javacore remove element changed listener removeelementchangedlistener f element listener felementlistener f element listener felementlistener org eclipse jdt text folding i java folding structure provider ijavafoldingstructureprovider initialize override initialize f updating count fupdatingcount update create initial context createinitialcontext f updating count fupdatingcount folding structure computation context foldingstructurecomputationcontext create initial context createinitialcontext initialize preferences initializepreferences f input finput get input element getinputelement f input finput create context createcontext folding structure computation context foldingstructurecomputationcontext create context createcontext allow collapse allowcollapse is installed isinstalled projection annotation model projectionannotationmodel model get model getmodel model i document idocument doc get document getdocument doc i scanner iscanner scanner f updating count fupdatingcount reuse scanner scanner f shared scanner fsharedscanner folding structure computation context foldingstructurecomputationcontext doc model allow collapse allowcollapse scanner i java element ijavaelement get input element getinputelement f editor feditor editor utility editorutility get editor input java element geteditorinputjavaelement f editor feditor initialize preferences initializepreferences i preference store ipreferencestore store java plugin javaplugin get default getdefault get preference store getpreferencestore f collapse inner types fcollapseinnertypes store get boolean getboolean preference constants preferenceconstants editor folding inner types innertypes f collapse import container fcollapseimportcontainer store get boolean getboolean preference constants preferenceconstants editor folding imports f collapse javadoc fcollapsejavadoc store get boolean getboolean preference constants preferenceconstants editor folding javadoc f collapse members fcollapsemembers store get boolean getboolean preference constants preferenceconstants editor folding methods f collapse header comments fcollapseheadercomments store get boolean getboolean preference constants preferenceconstants editor folding headers update folding structure computation context foldingstructurecomputationcontext ctx ctx map java projection annotation javaprojectionannotation position add itions additions hash map hashmap list java projection annotation javaprojectionannotation deletions array list arraylist list java projection annotation javaprojectionannotation updates array list arraylist compute folding structure computefoldingstructure ctx map java projection annotation javaprojectionannotation position new structure newstructure ctx f map fmap map i java element ijavaelement list tuple old structure oldstructure compute current structure computecurrentstructure ctx iterator java projection annotation javaprojectionannotation new structure newstructure key set keyset iterator has next hasnext java projection annotation javaprojectionannotation new annotation newannotation position new position newposition new structure newstructure new annotation newannotation i java element ijavaelement element new annotation newannotation get element getelement https bugs eclipse org bugs bug cgi https bugs eclipse org bugs bug cgi presence syntax errors anonymous types source range offset situation encountered ignore proposed folding range folding range exists silently matching folding range ignore position update range order folding structure stable is malformed anonymous type ismalformedanonymoustype new position newposition get offset getoffset element get element type getelementtype i java element ijavaelement type is inner type isinnertype i type itype element list tuple annotations old structure oldstructure element annotations is malformed anonymous type ismalformedanonymoustype add itions additions new annotation newannotation new position newposition iterator tuple annotations iterator matched has next hasnext tuple tuple java projection annotation javaprojectionannotation existing annotation existingannotation tuple annotation position existing position existingposition tuple position new annotation newannotation is comment iscomment existing annotation existingannotation is comment iscomment update collapsed state updatecollapsedstate ctx allow collapsing allowcollapsing existing annotation existingannotation is collapsed iscollapsed new annotation newannotation is collapsed iscollapsed is malformed anonymous type ismalformedanonymoustype existing position existingposition new position newposition equals existing position existingposition update collapsed state updatecollapsedstate existing position existingposition set offset setoffset new position newposition get offset getoffset existing position existingposition set length setlength new position newposition get length getlength update collapsed state updatecollapsedstate new annotation newannotation is collapsed iscollapsed existing annotation existingannotation mark collapsed markcollapsed existing annotation existingannotation mark expanded markexpanded updates add existing annotation existingannotation matched remove matched add itions additions new annotation newannotation new position newposition annotations is empty isempty old structure oldstructure remove element iterator list tuple iter old structure oldstructure values iterator iter has next hasnext list tuple list iter size list size size deletions add list annotation match deletions add itions additions updates ctx annotation deleted array deletedarray deletions to array toarray annotation deletions size annotation changed array changedarray updates to array toarray annotation updates size ctx get model getmodel modify annotations modifyannotations deleted array deletedarray add itions additions changed array changedarray ctx f scanner fscanner set source setsource compute folding structure computefoldingstructure folding structure computation context foldingstructurecomputationcontext ctx i parent iparent parent i parent iparent f input finput f input finput i source reference isourcereference string source i source reference isourcereference f input finput get source getsource source ctx get scanner getscanner set source setsource source to char array tochararray compute folding structure computefoldingstructure parent get children getchildren ctx java model exception javamodelexception compute folding structure computefoldingstructure i java element ijavaelement elements folding structure computation context foldingstructurecomputationcontext ctx java model exception javamodelexception elements length i java element ijavaelement element elements compute folding structure computefoldingstructure element ctx element i parent iparent i parent iparent parent i parent iparent element compute folding structure computefoldingstructure parent get children getchildren ctx computes folding structure link i java element ijavaelement java element computed projection annotations link default java folding structure provider defaultjavafoldingstructureprovider folding structure computation context foldingstructurecomputationcontext add projection range addprojectionrange default java folding structure provider defaultjavafoldingstructureprovider java projection annotation javaprojectionannotation position computation context subclasses extend replace implementation creates projection annotations elements members top level types javadoc comments member header comments javadoc multi comments app earing appearing type javadoc declarations param element java element compute folding structure param ctx computation context compute folding structure computefoldingstructure i java element ijavaelement element folding structure computation context foldingstructurecomputationcontext ctx collapse collapse code collapsecode element get element type getelementtype i java element ijavaelement container collapse ctx collapse import container collapseimportcontainer i java element ijavaelement type collapse code collapsecode is inner type isinnertype i type itype element is anonymous enum isanonymousenum i type itype element collapse ctx collapse inner types collapseinnertypes collapse code collapsecode i java element ijavaelement method i java element ijavaelement field i java element ijavaelement initializer collapse ctx collapse members collapsemembers i region iregion regions compute projection ranges computeprojectionranges i source reference isourcereference element ctx regions length comments regions length i region iregion normalized align region alignregion regions ctx normalized position position create comment position createcommentposition normalized position comment collapse commentcollapse regions length ctx has header comment hasheadercomment element ctx get first type getfirsttype comment collapse commentcollapse ctx collapse header comments collapseheadercomments comment collapse commentcollapse ctx collapse javadoc collapsejavadoc ctx add projection range addprojectionrange java projection annotation javaprojectionannotation comment collapse commentcollapse element position code collapse code collapsecode i region iregion normalized align region alignregion regions regions length ctx normalized position position element i member imember create member position creatememberposition normalized i member imember element create comment position createcommentposition normalized position ctx add projection range addprojectionrange java projection annotation javaprojectionannotation collapse element position returns code code code type code anonymous enum declaration code code https bugs eclipse org bugs bug cgi param type type test code code code type code anonymous enum declaration is anonymous enum isanonymousenum i type itype type type is enum isenum type is anonymous isanonymous java model exception javamodelexception returns code code code type code top level type code code param type type test code code code type code type is inner type isinnertype i type itype type type get declaring type getdeclaringtype computes projection ranges code i source reference isourcereference code range returned foldable regions empty array returned region returned array empty describes region java element source reference preceding regions describe javadoc comments java element param reference java element source reference param ctx folding context regions folded i region iregion compute projection ranges computeprojectionranges i source reference isourcereference reference folding structure computation context foldingstructurecomputationcontext ctx i source range isourcerange range reference get source range getsourcerange source range sourcerange is available isavailable range i region iregion string contents reference get source getsource contents i region iregion list i region iregion regions array list arraylist ctx has first type hasfirsttype reference i type itype ctx set first type setfirsttype i type itype reference i region iregion header comment headercomment compute header comment computeheadercomment ctx header comment headercomment regions add header comment headercomment ctx set has header comment sethasheadercomment shift range get offset getoffset i scanner iscanner scanner ctx get scanner getscanner scanner reset to resetto shift shift range get length getlength start shift token scanner get next token getnexttoken start scanner get current token start position getcurrenttokenstartposition token i terminal symbols iterminalsymbols tokennamecomment javadoc i terminal symbols iterminalsymbols tokennamecomment block scanner get current token end position getcurrenttokenendposition regions add region start start i terminal symbols iterminalsymbols tokennamecomment regions add region start shift range get length getlength start i region iregion result i region iregion regions size regions to array toarray result result java model exception javamodelexception invalid input exception invalidinputexception i region iregion i region iregion compute header comment computeheadercomment folding structure computation context foldingstructurecomputationcontext ctx java model exception javamodelexception search type i source range isourcerange range ctx get first type getfirsttype get source range getsourcerange range start range get offset getoffset code adapted comment for matting strategy commentformattingstrategy scan header content type comment accumulate additional comments condition condition reaching declaration container input i scanner iscanner scanner ctx get scanner getscanner scanner reset to resetto start header start headerstart header end headerend found comment foundcomment terminal scanner get next token getnexttoken terminal i terminal symbols iterminalsymbols tokennameeof terminal i terminal symbols iterminalsymbols token name class tokennameclass terminal i terminal symbols iterminalsymbols token name interface tokennameinterface terminal i terminal symbols iterminalsymbols token name enum tokennameenum found comment foundcomment terminal i terminal symbols iterminalsymbols token name import tokennameimport terminal i terminal symbols iterminalsymbols token name package tokennamepackage terminal i terminal symbols iterminalsymbols tokennamecomment javadoc terminal i terminal symbols iterminalsymbols tokennamecomment block terminal i terminal symbols iterminalsymbols tokennamecomment found comment foundcomment header start headerstart scanner get current token start position getcurrenttokenstartposition header end headerend scanner get current token end position getcurrenttokenendposition found comment foundcomment terminal scanner get next token getnexttoken invalid input exception invalidinputexception header end headerend region header start headerstart header end headerend header start headerstart creates comment folding position link align region alignregion i region iregion default java folding structure provider defaultjavafoldingstructureprovider folding structure computation context foldingstructurecomputationcontext aligned region param aligned aligned region folding position code aligned code position create comment position createcommentposition i region iregion aligned comment position commentposition aligned get offset getoffset aligned get length getlength creates folding position remembers member link align region alignregion i region iregion default java folding structure provider defaultjavafoldingstructureprovider folding structure computation context foldingstructurecomputationcontext aligned region param aligned aligned region param member member remember folding position code aligned code position create member position creatememberposition i region iregion aligned i member imember member java element position javaelementposition aligned get offset getoffset aligned get length getlength member aligns code region code start offset region start dec reased decreased offset offset inc reased increased start document code code returned code region code code code comp ris e comprise delimiter single folded param region region align code code param ctx folding context region equal greater code region code aligned offsets code code region small foldable covers i region iregion align region alignregion i region iregion region folding structure computation context foldingstructurecomputationcontext ctx region i document idocument document ctx get document getdocument start document get line of offset getlineofoffset region get offset getoffset document get line of offset getlineofoffset region get offset getoffset region get length getlength start offset document get line offset getlineoffset start end offset endoffset document get number of lines getnumberoflines end offset endoffset document get line offset getlineoffset end offset endoffset document get line offset getlineoffset document get line length getlinelength region offset end offset endoffset offset bad location exception badlocationexception projection annotation model projectionannotationmodel get model getmodel f editor feditor get adapter getadapter projection annotation model projectionannotationmodel i document idocument get document getdocument java editor javaeditor editor f editor feditor editor i document provider idocumentprovider provider editor get document provider getdocumentprovider provider provider get document getdocument editor get editor input geteditorinput matches deleted annotations changed deleted annotation position tuple matching add ition addition change updated marked changed matching tuple add itions additions marked deletion result annotations changed deleted param deletions list deleted annotations param add itions additions map position annotation mappings param list changed annotations param ctx context match list java projection annotation javaprojectionannotation deletions map java projection annotation javaprojectionannotation position add itions additions list java projection annotation javaprojectionannotation folding structure computation context foldingstructurecomputationcontext ctx deletions is empty isempty add itions additions is empty isempty is empty isempty list java projection annotation javaprojectionannotation new deletions newdeletions array list arraylist list java projection annotation javaprojectionannotation new changes newchanges array list arraylist iterator java projection annotation javaprojectionannotation deletion iterator deletioniterator deletions iterator deletion iterator deletioniterator has next hasnext java projection annotation javaprojectionannotation deleted deletion iterator deletioniterator position deleted position deletedposition ctx get model getmodel get position getposition deleted deleted position deletedposition tuple deleted tuple deletedtuple tuple deleted deleted position deletedposition tuple match find match findmatch deleted tuple deletedtuple ctx add to deletions addtodeletions match match find match findmatch deleted tuple deletedtuple add itions additions key set keyset add itions additions ctx add to deletions addtodeletions match i java element ijavaelement element match annotation get element getelement deleted set element setelement element deleted position deletedposition set length setlength match position get length getlength deleted position deletedposition java element position javaelementposition element i member imember java element position javaelementposition jep java element position javaelementposition deleted position deletedposition jep set member setmember i member imember element deletion iterator deletioniterator remove new changes newchanges add deleted add to deletions addtodeletions new deletions newdeletions add match annotation deletions add all addall new deletions newdeletions add all addall new changes newchanges finds match code tuple code collection annotations positions code java projection annotation javaprojectionannotation code instances code annotations code passed code position map positionmap code code f cached model fcachedmodel code code position map positionmap code code code tuple match annotations comment flag position offsets equal match annotation removed code annotations code param tuple tuple find match param annotations collection code java projection annotation javaprojectionannotation code param position map positionmap code map annotation position code code code param ctx context matching tuple code code match tuple find match findmatch tuple tuple collection java projection annotation javaprojectionannotation annotations map java projection annotation javaprojectionannotation position position map positionmap folding structure computation context foldingstructurecomputationcontext ctx iterator java projection annotation javaprojectionannotation annotations iterator has next hasnext java projection annotation javaprojectionannotation annotation tuple annotation is comment iscomment annotation is comment iscomment position position position map positionmap ctx get model getmodel get position getposition annotation position map positionmap annotation position tuple position get offset getoffset position get offset getoffset remove tuple annotation position map i java element ijavaelement list tuple compute current structure computecurrentstructure folding structure computation context foldingstructurecomputationcontext ctx map i java element ijavaelement list tuple map hash map hashmap projection annotation model projectionannotationmodel model ctx get model getmodel iterator annotation model get annotation iterator getannotationiterator has next hasnext object annotation annotation java projection annotation javaprojectionannotation java projection annotation javaprojectionannotation java java projection annotation javaprojectionannotation annotation position position model get position getposition java is not null isnotnull position list tuple list map java get element getelement list list array list arraylist map java get element getelement list list add tuple java position comparator tuple comparator comparator tuple override compare tuple tuple position get offset getoffset position get offset getoffset iterator list tuple map values iterator has next hasnext list tuple list collections sort list comparator map i java folding structure provider extension ijavafoldingstructureproviderextension collapse members collapsemembers override collapse members collapsemembers modify filtered modifyfiltered f member filter fmemberfilter i java folding structure provider extension ijavafoldingstructureproviderextension collapse comments collapsecomments override collapse comments collapsecomments modify filtered modifyfiltered f comment filter fcommentfilter org eclipse jdt text folding i java folding structure provider extension ijavafoldingstructureproviderextension collapse elements collapseelements org eclipse jdt core i java element ijavaelement override collapse elements collapseelements i java element ijavaelement elements i java element ijavaelement hash set hashset arrays as list aslist elements modify filtered modifyfiltered java element set filter javaelementsetfilter org eclipse jdt text folding i java folding structure provider extension ijavafoldingstructureproviderextension expand elements expandelements org eclipse jdt core i java element ijavaelement override expand elements expandelements i java element ijavaelement elements i java element ijavaelement hash set hashset arrays as list aslist elements modify filtered modifyfiltered java element set filter javaelementsetfilter collapses exp ands expands annotations matched passed filter param filter filter select annotations collapse param expand code code expand matched annotations code code collapse modify filtered modifyfiltered filter filter expand is installed isinstalled projection annotation model projectionannotationmodel model get model getmodel model list java projection annotation javaprojectionannotation modified array list arraylist iterator annotation iter model get annotation iterator getannotationiterator iter has next hasnext object annotation iter annotation java projection annotation javaprojectionannotation java projection annotation javaprojectionannotation java java projection annotation javaprojectionannotation annotation expand java is collapsed iscollapsed filter match java expand java mark expanded markexpanded java mark collapsed markcollapsed modified add java model modify annotations modifyannotations modified to array toarray annotation modified size
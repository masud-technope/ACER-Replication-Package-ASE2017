copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal corext refactoring rename java util array list arraylist java util arrays java util collection java util hash map hashmap java util hash set hashset java util iterator java util map java util map entry org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core runtime sub progress monitor subprogressmonitor org eclipse core resources i resource iresource org eclipse text edits text edit textedit org eclipse jface text i region iregion org eclipse jface text region org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse ltk core refactoring refactoring status context refactoringstatuscontext org eclipse ltk core refactoring refactoring status entry refactoringstatusentry org eclipse ltk core refactoring text change textchange org eclipse ltk core refactoring text edit change group texteditchangegroup org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java element ijavaelement org eclipse jdt core i source range isourcerange org eclipse jdt core i source reference isourcereference org eclipse jdt core java model exception javamodelexception org eclipse jdt core source range sourcerange org eclipse jdt core working copy owner workingcopyowner org eclipse jdt core compiler i problem iproblem org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom compilation unit compilationunit org eclipse jdt core dom i binding ibinding org eclipse jdt core dom i variable binding ivariablebinding org eclipse jdt core dom org eclipse jdt core dom node finder nodefinder org eclipse jdt core dom simple name simplename org eclipse jdt core dom variable declaration variabledeclaration org eclipse jdt core search field declaration match fielddeclarationmatch org eclipse jdt core search method declaration match methoddeclarationmatch org eclipse jdt core search search match searchmatch org eclipse jdt internal corext source range factory sourcerangefactory org eclipse jdt internal corext dom ast nodes astnodes org eclipse jdt internal corext refactoring refactoring core messages refactoringcoremessages org eclipse jdt internal corext refactoring search result group searchresultgroup org eclipse jdt internal corext refactoring base java status context javastatuscontext org eclipse jdt internal corext refactoring base java string status context javastringstatuscontext org eclipse jdt internal corext refactoring util refactoringastparser org eclipse jdt internal corext refactoring util text change manager textchangemanager org eclipse jdt internal corext util messages org eclipse jdt internal corext util search utils searchutils org eclipse jdt internal java editor javaeditor ast provider astprovider org eclipse jdt internal viewsupport basic element labels basicelementlabels rename analyze util renameanalyzeutil problem node finder problemnodefinder problem node finder problemnodefinder simple name simplename get problem nodes getproblemnodes ast node astnode method node methodnode variable declaration variabledeclaration variable node variablenode text edit textedit edits text change textchange change string key variable node variablenode resolve binding resolvebinding get key getkey name node visitor namenodevisitor visitor name node visitor namenodevisitor edits change key method node methodnode accept visitor visitor get problem nodes getproblemnodes name node visitor namenodevisitor ast visitor astvisitor collection i region iregion f ranges franges collection simple name simplename f problem nodes fproblemnodes string f key fkey name node visitor namenodevisitor text edit textedit edits text change textchange change string key is not null isnotnull edits is not null isnotnull key f ranges franges hash set hashset arrays as list aslist refactoring analyze util refactoringanalyzeutil get new ranges getnewranges edits change f problem nodes fproblemnodes array list arraylist f key fkey key simple name simplename get problem nodes getproblemnodes f problem nodes fproblemnodes to array toarray simple name simplename f problem nodes fproblemnodes size visit methods override visit simple name simplename node variable declaration variabledeclaration decl get variable declaration getvariabledeclaration node decl visit node i variable binding ivariablebinding binding decl resolve binding resolvebinding binding visit node keys equal keysequal f key fkey equals binding get key getkey range in set rangeinset f ranges franges region node get start position getstartposition node get length getlength keys equal keysequal range in set rangeinset f problem nodes fproblemnodes add node keys equal keysequal range in set rangeinset f problem nodes fproblemnodes add node visit node local analyze package localanalyzepackage text edit textedit f declaration edit fdeclarationedit text edit textedit f occurence edits foccurenceedits local analyze package localanalyzepackage text edit textedit declaration edit declarationedit text edit textedit occurence edits occurenceedits f declaration edit fdeclarationedit declaration edit declarationedit f occurence edits foccurenceedits occurence edits occurenceedits rename analyze util renameanalyzeutil instance refactoring status refactoringstatus analyze rename changes analyzerenamechanges text change manager textchangemanager manager search result group searchresultgroup old occurrences oldoccurrences search result group searchresultgroup new occurrences newoccurrences refactoring status refactoringstatus result refactoring status refactoringstatus old occurrences oldoccurrences length search result group searchresultgroup old group oldgroup old occurrences oldoccurrences search match searchmatch old search results oldsearchresults old group oldgroup get search results getsearchresults i compilation unit icompilationunit cunit old group oldgroup get compilation unit getcompilationunit cunit old search results oldsearchresults length search match searchmatch old search result oldsearchresult old search results oldsearchresults rename analyze util renameanalyzeutil exists in new occurrences existsinnewoccurrences old search result oldsearchresult new occurrences newoccurrences manager add shadows error addshadowserror cunit old search result oldsearchresult result result i compilation unit icompilationunit find working copy for cu findworkingcopyforcu i compilation unit icompilationunit new working copies newworkingcopies i compilation unit icompilationunit i compilation unit icompilationunit original get primary getprimary new working copies newworkingcopies length new working copies newworkingcopies get primary getprimary equals original new working copies newworkingcopies i compilation unit icompilationunit create new working copies createnewworkingcopies i compilation unit icompilationunit compilation units to modify compilationunitstomodify text change manager textchangemanager manager working copy owner workingcopyowner owner sub progress monitor subprogressmonitor core exception coreexception nls begin task begintask compilation units to modify compilationunitstomodify length i compilation unit icompilationunit new working copies newworkingcopies i compilation unit icompilationunit compilation units to modify compilationunitstomodify length compilation units to modify compilationunitstomodify length i compilation unit icompilationunit compilation units to modify compilationunitstomodify new working copies newworkingcopies create new working copy createnewworkingcopy manager owner sub progress monitor subprogressmonitor new working copies newworkingcopies i compilation unit icompilationunit create new working copy createnewworkingcopy i compilation unit icompilationunit text change manager textchangemanager manager working copy owner workingcopyowner owner sub progress monitor subprogressmonitor core exception coreexception i compilation unit icompilationunit new wc newwc get working copy getworkingcopy owner string preview content previewcontent manager get preview content getpreviewcontent null progress monitor nullprogressmonitor new wc newwc get buffer getbuffer set contents setcontents preview content previewcontent new wc newwc reconcile i compilation unit icompilationunit ast owner new wc newwc exists in new occurrences existsinnewoccurrences search match searchmatch search result searchresult search result group searchresultgroup new occurrences newoccurrences text change manager textchangemanager manager search result group searchresultgroup new group newgroup find occurrence group findoccurrencegroup search result searchresult get resource getresource new occurrences newoccurrences new group newgroup i region iregion old edit range oldeditrange get corresponding edit change range getcorrespondingeditchangerange search result searchresult manager old edit range oldeditrange search match searchmatch new search results newsearchresults new group newgroup get search results getsearchresults old range offset oldrangeoffset old edit range oldeditrange get offset getoffset new search results newsearchresults length new search results newsearchresults get offset getoffset old range offset oldrangeoffset i region iregion get corresponding edit change range getcorrespondingeditchangerange search match searchmatch search result searchresult text change manager textchangemanager manager text change textchange change get text change gettextchange search result searchresult manager change i region iregion old match range oldmatchrange create text range createtextrange search result searchresult text edit change group texteditchangegroup edit changes editchanges change get text edit change groups gettexteditchangegroups edit changes editchanges length old match range oldmatchrange equals edit changes editchanges get region getregion text edit textedit get coverage getcoverage change get preview edits getpreviewedits edit changes editchanges get text edits gettextedits text change textchange get text change gettextchange search match searchmatch search result searchresult text change manager textchangemanager manager i compilation unit icompilationunit search utils searchutils get compilation unit getcompilationunit search result searchresult manager i region iregion create text range createtextrange search match searchmatch search result searchresult region search result searchresult get offset getoffset search result searchresult get length getlength search result group searchresultgroup find occurrence group findoccurrencegroup i resource iresource resource search result group searchresultgroup new occurrences newoccurrences new occurrences newoccurrences length new occurrences newoccurrences get resource getresource equals resource new occurrences newoccurrences find missing direct ions directions todo filters declarations method declaration match methoddeclarationmatch field declaration match fielddeclarationmatch term solution pass reference search refactoring status refactoringstatus analyze rename changes analyzerenamechanges text change manager textchangemanager manager search result group searchresultgroup old references oldreferences search result group searchresultgroup new references newreferences string new element name newelementname refactoring status refactoringstatus result refactoring status refactoringstatus hash map hashmap i compilation unit icompilationunit search match searchmatch cu to new results cutonewresults hash map hashmap new references newreferences length new references newreferences length i compilation unit icompilationunit new references newreferences get compilation unit getcompilationunit cu to new results cutonewresults get primary getprimary new references newreferences get search results getsearchresults old references oldreferences length search result group searchresultgroup old group oldgroup old references oldreferences search match searchmatch old matches oldmatches old group oldgroup get search results getsearchresults i compilation unit icompilationunit old group oldgroup get compilation unit getcompilationunit search match searchmatch new search matches newsearchmatches cu to new results cutonewresults remove new search matches newsearchmatches old matches oldmatches length search match searchmatch old match oldmatch old matches oldmatches add shadows error addshadowserror old match oldmatch result analyze changes analyzechanges manager old matches oldmatches new search matches newsearchmatches new element name newelementname result iterator entry i compilation unit icompilationunit search match searchmatch iter cu to new results cutonewresults entry set entryset iterator iter has next hasnext entry i compilation unit icompilationunit search match searchmatch entry iter i compilation unit icompilationunit entry get key getkey search match searchmatch new search matches newsearchmatches entry get value getvalue new search matches newsearchmatches length search match searchmatch new match newmatch new search matches newsearchmatches add reference shadowed error addreferenceshadowederror new match newmatch new element name newelementname result result analyze changes analyzechanges i compilation unit icompilationunit text change textchange change search match searchmatch old matches oldmatches search match searchmatch new matches newmatches string new element name newelementname refactoring status refactoringstatus result map integer search match searchmatch updated old offsets updatedoldoffsets get updated change offsets getupdatedchangeoffsets change old matches oldmatches new matches newmatches length search match searchmatch new match newmatch new matches newmatches integer offset in new offsetinnew integer new match newmatch get offset getoffset search match searchmatch old match oldmatch updated old offsets updatedoldoffsets remove offset in new offsetinnew old match oldmatch add reference shadowed error addreferenceshadowederror new match newmatch new element name newelementname result iterator search match searchmatch iter updated old offsets updatedoldoffsets values iterator iter has next hasnext remaining matches shadowed search match searchmatch old match oldmatch iter add shadows error addshadowserror old match oldmatch result param change param old matches oldmatches map integer updated offset updatedoffset search match searchmatch old match oldmatch map integer search match searchmatch get updated change offsets getupdatedchangeoffsets text change textchange change search match searchmatch old matches oldmatches map integer search match searchmatch updated offsets updatedoffsets hash map hashmap map integer integer old to updated offsets oldtoupdatedoffsets get edit change offset updates geteditchangeoffsetupdates change old matches oldmatches length search match searchmatch old match oldmatch old matches oldmatches integer updated offset updatedoffset old to updated offsets oldtoupdatedoffsets integer old match oldmatch get offset getoffset updated offset updatedoffset match updated updated offset updatedoffset integer updated offsets updatedoffsets updated offset updatedoffset old match oldmatch updated offsets updatedoffsets param change map integer old offset oldoffset integer updated offset updatedoffset map integer integer get edit change offset updates geteditchangeoffsetupdates text change textchange change text edit change group texteditchangegroup edit changes editchanges change get text edit change groups gettexteditchangegroups map integer integer offset updates offsetupdates hash map hashmap edit changes editchanges length edit changes editchanges length text edit change group texteditchangegroup edit change editchange edit changes editchanges i region iregion old region oldregion edit change editchange get region getregion old region oldregion i region iregion updated region updatedregion text edit textedit get coverage getcoverage change get preview edits getpreviewedits edit change editchange get text edits gettextedits updated region updatedregion offset updates offsetupdates integer old region oldregion get offset getoffset integer updated region updatedregion get offset getoffset offset updates offsetupdates add reference shadowed error addreferenceshadowederror i compilation unit icompilationunit search match searchmatch new match newmatch string new element name newelementname refactoring status refactoringstatus result todo filter declarations new match newmatch method declaration match methoddeclarationmatch new match newmatch field declaration match fielddeclarationmatch i source range isourcerange range get old source range getoldsourcerange new match newmatch refactoring status context refactoringstatuscontext context java status context javastatuscontext create range string message messages format refactoring core messages refactoringcoremessages rename analyze util renameanalyzeutil reference shadowed string basic element labels basicelementlabels get file name getfilename basic element labels basicelementlabels get java element name getjavaelementname new element name newelementname result add error adderror message context i source range isourcerange get old source range getoldsourcerange search match searchmatch new match newmatch tra nsfom transfom offset preview offset original enclosing method i java element ijavaelement new match element newmatchelement i java element ijavaelement new match newmatch get element getelement i java element ijavaelement primary element primaryelement new match element newmatchelement get primary element getprimaryelement i source range isourcerange range primary element primaryelement exists primary element primaryelement i source reference isourcereference range i source reference isourcereference primary element primaryelement get source range getsourcerange java model exception javamodelexception range add shadows error addshadowserror i compilation unit icompilationunit search match searchmatch old match oldmatch refactoring status refactoringstatus result todo filter declarations old match oldmatch method declaration match methoddeclarationmatch old match oldmatch field declaration match fielddeclarationmatch i source range isourcerange range source range sourcerange old match oldmatch get offset getoffset old match oldmatch get length getlength refactoring status context refactoringstatuscontext context java status context javastatuscontext create range string message messages format refactoring core messages refactoringcoremessages rename analyze util renameanalyzeutil shadows basic element labels basicelementlabels get file name getfilename result add error adderror message context method analyzes local variable renames checks compile errors int roduced introduced rename correct node renamed param analyze packages analyzepackages local analyze packages localanalyzepackages local renames param cu change cuchange text change textchange local variable applied param oldcunode fully inc l incl bindings resolved ast node original compilation unit param recovery statements bindings recovery performed parsing changed refactoring status refactoringstatus errors compile errors wrongly renamed nodes core exception coreexception thrown error greating preview content change refactoring status refactoringstatus analyze local renames analyzelocalrenames local analyze package localanalyzepackage analyze packages analyzepackages text change textchange cu change cuchange compilation unit compilationunit oldcunode recovery core exception coreexception refactoring status refactoringstatus result refactoring status refactoringstatus i compilation unit icompilationunit compilation unit compilationunit i compilation unit icompilationunit oldcunode get java element getjavaelement string new cu source newcusource cu change cuchange get preview content getpreviewcontent null progress monitor nullprogressmonitor compilation unit compilationunit newcunode refactoringastparser ast provider astprovider shared ast level parse new cu source newcusource compilation unit compilationunit recovery result merge analyze compile errors analyzecompileerrors new cu source newcusource newcunode oldcunode result has error haserror result analyze packages analyzepackages length ast node astnode enclosing get enclosing block or method or lambda getenclosingblockormethodorlambda analyze packages analyzepackages f declaration edit fdeclarationedit cu change cuchange newcunode declaration i region iregion new region newregion refactoring analyze util refactoringanalyzeutil get new text range getnewtextrange analyze packages analyzepackages f declaration edit fdeclarationedit cu change cuchange ast node astnode new declaration newdeclaration node finder nodefinder perform newcunode new region newregion get offset getoffset new region newregion get length getlength is true istrue new declaration newdeclaration variable declaration variabledeclaration declaration get variable declaration getvariabledeclaration new declaration newdeclaration is not null isnotnull declaration simple name simplename problem nodes problemnodes problem node finder problemnodefinder get problem nodes getproblemnodes enclosing declaration analyze packages analyzepackages f occurence edits foccurenceedits cu change cuchange result merge refactoring analyze util refactoringanalyzeutil report problem nodes reportproblemnodes new cu source newcusource problem nodes problemnodes result variable declaration variabledeclaration get variable declaration getvariabledeclaration node i binding ibinding binding node resolve binding resolvebinding binding node get parent getparent variable declaration variabledeclaration variable declaration variabledeclaration node get parent getparent binding binding get kind getkind i binding ibinding variable compilation unit compilationunit compilation unit compilationunit ast nodes astnodes get parent getparent node compilation unit compilationunit ast nodes astnodes find variable declaration findvariabledeclaration i variable binding ivariablebinding binding ast node astnode get enclosing block or method or lambda getenclosingblockormethodorlambda text edit textedit declaration edit declarationedit text change textchange change compilation unit compilationunit newcunode ast node astnode enclosing refactoring analyze util refactoringanalyzeutil get block getblock declaration edit declarationedit change newcunode enclosing enclosing refactoring analyze util refactoringanalyzeutil get method declaration getmethoddeclaration declaration edit declarationedit change newcunode enclosing enclosing refactoring analyze util refactoringanalyzeutil get lambda expression getlambdaexpression declaration edit declarationedit change newcunode enclosing refactoring status refactoringstatus analyze compile errors analyzecompileerrors string new cu source newcusource compilation unit compilationunit newcunode compilation unit compilationunit oldcunode refactoring status refactoringstatus result refactoring status refactoringstatus i problem iproblem new problems newproblems refactoring analyze util refactoringanalyzeutil get introduce d compile problems getintroducedcompileproblems newcunode oldcunode new problems newproblems length i problem iproblem problem new problems newproblems problem is error iserror result add entry addentry refactoring status entry refactoringstatusentry problem is error iserror refactoring status refactoringstatus error refactoring status refactoringstatus warning problem get message getmessage java string status context javastringstatuscontext new cu source newcusource source range factory sourcerangefactory create problem result
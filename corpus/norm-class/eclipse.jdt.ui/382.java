copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation dmitry stalnov dst alnov dstalnov f usionone fusionone contributed fixes bug inline refactoring bogus error bug zilla bugzilla https bugs eclipse org bugs bug cgi constructor inlined https bugs eclipse org bugs bug cgi org eclipse jdt internal corext refactoring code java util array list arraylist java util collection java util hash map hashmap java util iterator java util list java util map org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse jdt core i type root ityperoot org eclipse jdt core java model exception javamodelexception org eclipse jdt core compiler i problem iproblem org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom abstract type declaration abstracttypedeclaration org eclipse jdt core dom annotation type declaration annotationtypedeclaration org eclipse jdt core dom anonymous class declaration anonymousclassdeclaration org eclipse jdt core dom array access arrayaccess org eclipse jdt core dom block org eclipse jdt core dom class instance creation classinstancecreation org eclipse jdt core dom enum declaration enumdeclaration org eclipse jdt core dom expression org eclipse jdt core dom field access fieldaccess org eclipse jdt core dom i binding ibinding org eclipse jdt core dom i method binding imethodbinding org eclipse jdt core dom i type binding itypebinding org eclipse jdt core dom i variable binding ivariablebinding org eclipse jdt core dom lambda expression lambdaexpression org eclipse jdt core dom method declaration methoddeclaration org eclipse jdt core dom method invocation methodinvocation org eclipse jdt core dom modifier org eclipse jdt core dom org eclipse jdt core dom return statement returnstatement org eclipse jdt core dom simple name simplename org eclipse jdt core dom single variable declaration singlevariabledeclaration org eclipse jdt core dom statement org eclipse jdt core dom structural property descriptor structuralpropertydescriptor org eclipse jdt core dom super constructor invocation superconstructorinvocation org eclipse jdt core dom super method invocation supermethodinvocation org eclipse jdt core dom this expression thisexpression org eclipse jdt core dom type declaration typedeclaration org eclipse jdt core dom variable declaration fragment variabledeclarationfragment org eclipse jdt internal corext code manipulation codemanipulation import references collector importreferencescollector org eclipse jdt internal corext dom ast nodes astnodes org eclipse jdt internal corext dom local variable index localvariableindex org eclipse jdt internal corext refactoring refactoring core messages refactoringcoremessages org eclipse jdt internal corext refactoring base java status context javastatuscontext org eclipse jdt internal corext refactoring code flow flow context flowcontext org eclipse jdt internal corext refactoring code flow flow info flowinfo org eclipse jdt internal corext refactoring code flow in out flow analyzer inoutflowanalyzer source analyzer sourceanalyzer name data namedata string f name fname list simple name simplename f references freferences name data namedata string f name fname f references freferences array list arraylist string get name getname f name fname add reference addreference simple name simplename f references freferences add list simple name simplename references f references freferences activation analyzer activationanalyzer ast visitor astvisitor refactoring status refactoringstatus status refactoring status refactoringstatus ast node astnode f last node flastnode get last node getlastnode i method binding imethodbinding f binding fbinding get binding getbinding override visit return statement returnstatement node node f last node flastnode f interrupted execution flow finterruptedexecutionflow override visit enum declaration enumdeclaration node override visit annotation type declaration annotationtypedeclaration node override visit type declaration typedeclaration node override visit anonymous class declaration anonymousclassdeclaration node override visit lambda expression lambdaexpression node override visit method invocation methodinvocation node i method binding imethodbinding method binding methodbinding node resolve method binding resolvemethodbinding method binding methodbinding method binding methodbinding get method declaration getmethoddeclaration f binding fbinding method binding methodbinding f binding fbinding is equal to isequalto method binding methodbinding status has fatal error hasfatalerror status add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer recursive call override visit simple name simplename node i binding ibinding binding node resolve binding resolvebinding binding status has fatal error hasfatalerror fixes bug ast nodes astnodes is label islabel node status add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer declaration errors java status context javastatuscontext create f type root ftyperoot f declaration fdeclaration override visit this expression thisexpression node node get qualifier getqualifier status add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer qualified expressions java status context javastatuscontext create f type root ftyperoot node ast node astnode get last node getlastnode list statement statements f declaration fdeclaration get body getbody statements statements size statements statements size i method binding imethodbinding get binding getbinding i method binding imethodbinding result f declaration fdeclaration resolve binding resolvebinding result result get method declaration getmethoddeclaration result update collector updatecollector ast visitor astvisitor f type counter ftypecounter override visit type declaration typedeclaration node visit type visittype node override end visit endvisit type declaration typedeclaration node f type counter ftypecounter override visit enum declaration enumdeclaration node visit type visittype node override end visit endvisit enum declaration enumdeclaration node f type counter ftypecounter override visit annotation type declaration annotationtypedeclaration node visit type visittype node override end visit endvisit annotation type declaration annotationtypedeclaration node f type counter ftypecounter visit type visittype abstract type declaration abstracttypedeclaration node f type counter ftypecounter add name reference addnamereference node get name getname override visit anonymous class declaration anonymousclassdeclaration node f type counter ftypecounter override end visit endvisit anonymous class declaration anonymousclassdeclaration node f type counter ftypecounter override visit field access fieldaccess node visit expression simple node get expression getexpression accept add references to name addreferencestoname node get name getname override visit method declaration methoddeclaration node node is constructor isconstructor abstract type declaration abstracttypedeclaration decl abstract type declaration abstracttypedeclaration ast nodes astnodes get parent getparent node abstract type declaration abstracttypedeclaration name data namedata f names fnames decl get name getname resolve binding resolvebinding add reference addreference node get name getname override visit method invocation methodinvocation node f type counter ftypecounter expression receiver node get expression getexpression receiver is static ally imported isstaticallyimported node get name getname f implicit receivers fimplicitreceivers add node override visit super method invocation supermethodinvocation node f type counter ftypecounter f has super method invocation fhassupermethodinvocation override visit super constructor invocation superconstructorinvocation node f type counter ftypecounter f has super method invocation fhassupermethodinvocation override visit class instance creation classinstancecreation node f type counter ftypecounter expression receiver node get expression getexpression receiver node resolve type binding resolvetypebinding is local islocal f implicit receivers fimplicitreceivers add node override visit single variable declaration singlevariabledeclaration node f type counter ftypecounter add name reference addnamereference node get name getname override visit variable declaration fragment variabledeclarationfragment node f type counter ftypecounter add name reference addnamereference node get name getname override visit simple name simplename node add references to name addreferencestoname node i binding ibinding binding node resolve binding resolvebinding binding i type binding itypebinding i type binding itypebinding type i type binding itypebinding binding type is type variable istypevariable add type variable reference addtypevariablereference type node binding i variable binding ivariablebinding i variable binding ivariablebinding i variable binding ivariablebinding binding is field isfield is static ally imported isstaticallyimported node top name topname ast nodes astnodes get top most name gettopmostname node node top name topname node ast nodes astnodes get left most simple name getleftmostsimplename top name topname structural property descriptor structuralpropertydescriptor location node get location in parent getlocationinparent location single variable declaration singlevariabledeclaration property location variable declaration fragment variabledeclarationfragment property f implicit receivers fimplicitreceivers add node is field isfield local check parameter parameter data parameterdata data f parameters fparameters binding data ast node astnode parent node get parent getparent parent expression precedence operator precedence operatorprecedence get expression precedence getexpressionprecedence expression parent precedence integer max data set operator precedence setoperatorprecedence precedence override visit this expression thisexpression node f type counter ftypecounter f implicit receivers fimplicitreceivers add node add references to name addreferencestoname simple name simplename node i binding ibinding binding node resolve binding resolvebinding parameter data parameterdata data f parameters fparameters binding data data add reference addreference node name data namedata f names fnames binding add reference addreference node add name reference addnamereference simple name simplename f names fnames resolve binding resolvebinding name data namedata get identifier getidentifier add type variable reference addtypevariablereference i type binding itypebinding variable simple name simplename name data namedata data f type parameter mapping ftypeparametermapping variable data data f method type parameter mapping fmethodtypeparametermapping variable data add reference addreference is static ally imported isstaticallyimported f statics to import fstaticstoimport var arg analyzer vararganalyzer ast visitor astvisitor i binding ibinding f parameter fparameter var arg analyzer vararganalyzer i binding ibinding parameter f parameter fparameter parameter override visit array access arrayaccess node expression array node get array getarray array simple name simplename f parameter fparameter is equal to isequalto simple name simplename array resolve binding resolvebinding f array access farrayaccess i type root ityperoot f type root ftyperoot method declaration methoddeclaration f declaration fdeclaration map i variable binding ivariablebinding parameter data parameterdata f parameters fparameters map i binding ibinding name data namedata f names fnames list expression f implicit receivers fimplicitreceivers f array access farrayaccess f has super method invocation fhassupermethodinvocation list simple name simplename f types to import ftypestoimport list simple name simplename f statics to import fstaticstoimport list name data namedata f type parameter references ftypeparameterreferences map i type binding itypebinding name data namedata f type parameter mapping ftypeparametermapping list name data namedata f method type parameter references fmethodtypeparameterreferences map i type binding itypebinding name data namedata f method type parameter mapping fmethodtypeparametermapping f interrupted execution flow finterruptedexecutionflow source analyzer sourceanalyzer i type root ityperoot type root typeroot method declaration methoddeclaration declaration f type root ftyperoot type root typeroot f declaration fdeclaration declaration is execution flow interrupted isexecutionflowinterrupted f interrupted execution flow finterruptedexecutionflow refactoring status refactoringstatus check activation checkactivation java model exception javamodelexception refactoring status refactoringstatus result refactoring status refactoringstatus f type root ftyperoot is structure known isstructureknown result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer syntax errors java status context javastatuscontext create f type root ftyperoot result i problem iproblem problems ast nodes astnodes get problems getproblems f declaration fdeclaration ast nodes astnodes node ast nodes astnodes error problems length result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer declaration errors java status context javastatuscontext create f type root ftyperoot f declaration fdeclaration result i method binding imethodbinding declaration binding declarationbinding f declaration fdeclaration resolve binding resolvebinding declaration binding declarationbinding modifiers declaration binding declarationbinding get modifiers getmodifiers modifier is abstract isabstract modifiers result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer methods java status context javastatuscontext create f type root ftyperoot f declaration fdeclaration result modifier is native isnative modifiers result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer methods java status context javastatuscontext create f type root ftyperoot f declaration fdeclaration result result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer method declaration methoddeclaration errors java status context javastatuscontext create f type root ftyperoot result activation analyzer activationanalyzer analyzer activation analyzer activationanalyzer f declaration fdeclaration accept analyzer result merge analyzer status result has fatal error hasfatalerror list single variable declaration singlevariabledeclaration parameters f declaration fdeclaration parameters f parameters fparameters hash map hashmap parameters size iterator single variable declaration singlevariabledeclaration iter parameters iterator iter has next hasnext single variable declaration singlevariabledeclaration element iter i variable binding ivariablebinding binding element resolve binding resolvebinding binding result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer declaration errors java status context javastatuscontext create f type root ftyperoot f declaration fdeclaration result f parameters fparameters binding parameter data parameterdata element get property getproperty parameter data parameterdata property f names fnames hash map hashmap f implicit receivers fimplicitreceivers array list arraylist f type parameter references ftypeparameterreferences array list arraylist f type parameter mapping ftypeparametermapping hash map hashmap i type binding itypebinding declaring type declaringtype declaration binding declarationbinding get declaring class getdeclaringclass declaring type declaringtype result add fatal error addfatalerror refactoring core messages refactoringcoremessages inline method refactoring inlinemethodrefactoring source analyzer sourceanalyzer type declaration typedeclaration errors java status context javastatuscontext create f type root ftyperoot result i type binding itypebinding type parameters typeparameters declaring type declaringtype get type parameters gettypeparameters type parameters typeparameters length name data namedata data name data namedata type parameters typeparameters get name getname f type parameter references ftypeparameterreferences add data f type parameter mapping ftypeparametermapping type parameters typeparameters data f method type parameter references fmethodtypeparameterreferences array list arraylist f method type parameter mapping fmethodtypeparametermapping hash map hashmap i method binding imethodbinding method declaration binding declarationbinding type parameters typeparameters method get type parameters gettypeparameters type parameters typeparameters length name data namedata data name data namedata type parameters typeparameters get name getname f method type parameter references fmethodtypeparameterreferences add data f method type parameter mapping fmethodtypeparametermapping type parameters typeparameters data f declaration fdeclaration is varargs isvarargs list single variable declaration singlevariabledeclaration parameters f declaration fdeclaration parameters var arg analyzer vararganalyzer v analyzer vanalyzer var arg analyzer vararganalyzer parameters parameters size get name getname resolve binding resolvebinding f declaration fdeclaration get body getbody accept v analyzer vanalyzer result initialize block body f declaration fdeclaration get body getbody collect imports mark imported fields methods implicit visible f types to import ftypestoimport array list arraylist f statics to import fstaticstoimport array list arraylist import references collector importreferencescollector collect body f type root ftyperoot get java project getjavaproject f types to import ftypestoimport f statics to import fstaticstoimport collect implicit references references body accept update collector updatecollector number of locals numberoflocals local variable index localvariableindex perform f declaration fdeclaration flow context flowcontext context flow context flowcontext number of locals numberoflocals context set consider access mode setconsideraccessmode context set compute mode setcomputemode flow context flowcontext merge in out flow analyzer inoutflowanalyzer flow analyzer flowanalyzer in out flow analyzer inoutflowanalyzer context flow info flowinfo info flow analyzer flowanalyzer perform get statements getstatements iterator single variable declaration singlevariabledeclaration iter f declaration fdeclaration parameters iterator iter has next hasnext single variable declaration singlevariabledeclaration element iter i variable binding ivariablebinding binding element resolve binding resolvebinding parameter data parameterdata data parameter data parameterdata element get property getproperty parameter data parameterdata property data set access mode setaccessmode info get access mode getaccessmode context binding collection name data namedata get used names getusednames f names fnames values list expression get implicit receivers getimplicitreceivers f implicit receivers fimplicitreceivers list simple name simplename get types to import gettypestoimport f types to import ftypestoimport list simple name simplename get statics to import getstaticstoimport f statics to import fstaticstoimport list name data namedata get type parameter references gettypeparameterreferences f type parameter references ftypeparameterreferences list name data namedata get method type parameter references getmethodtypeparameterreferences f method type parameter references fmethodtypeparameterreferences has array access hasarrayaccess f array access farrayaccess has super method invocation hassupermethodinvocation f has super method invocation fhassupermethodinvocation ast node astnode get statements getstatements list statement statements f declaration fdeclaration get body getbody statements statements to array toarray ast node astnode statements size
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt tests core java lang reflect invocation target exception invocationtargetexception java lang reflect method java util hash set hashset java util iterator java util org eclipse core runtime org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom abstract type declaration abstracttypedeclaration org eclipse jdt core dom annotatable type annotatabletype org eclipse jdt core dom annotation org eclipse jdt core dom body declaration bodydeclaration org eclipse jdt core dom comment org eclipse jdt core dom expression org eclipse jdt core dom method reference methodreference org eclipse jdt core dom org eclipse jdt core dom statement org eclipse jdt core dom type org eclipse jdt core dom variable declaration variabledeclaration org eclipse jdt internal corext dom hierarchicalastvisitor junit framework test junit framework test case testcase junit framework test suite testsuite suppress warnings suppresswarnings javadoc hierarchicalastvisitortest test case testcase testhierarchicalastvisitor hierarchicalastvisitor region updated response ast node astnode hierarchy parts test portion file main tained maintained response occur ast node astnode hierarchy ast visitor astvisitor include add ition addition removal node types hierarchy superclass subclass relation ships relationships node classes necessitate hierarchicalastvisitor structure behaviour test verifies file response ast node astnode hierarchy local ized localized limited main tenance maintenance visit node super visit supervisit node end visit endvisit node super end visit superendvisit node implementations quadruple leaf ast node astnode descendant including ast node astnode leaf ast node astnode descendant visit method overridden call register call registercall super visit supervisit node method simply calls visit end visit endvisit super end visit superendvisit override visit ast node astnode node register call registercall ast node astnode super visit supervisit ast node astnode node visit node override end visit endvisit ast node astnode node register call registercall ast node astnode super end visit superendvisit ast node astnode node visit node override visit expression node register call registercall expression super visit supervisit expression node visit node override end visit endvisit expression node register call registercall expression super end visit superendvisit expression node visit node override visit annotatable type annotatabletype node register call registercall annotatable type annotatabletype super visit supervisit annotatable type annotatabletype node visit node override end visit endvisit annotatable type annotatabletype node register call registercall annotatable type annotatabletype super end visit superendvisit annotatable type annotatabletype node visit node override visit annotation node register call registercall annotation super visit supervisit annotation node visit node override end visit endvisit annotation node register call registercall annotation super end visit superendvisit annotation node visit node override visit method reference methodreference node register call registercall method reference methodreference super visit supervisit method reference methodreference node visit node override end visit endvisit method reference methodreference node register call registercall method reference methodreference super end visit superendvisit method reference methodreference node visit node override visit node register call registercall super visit supervisit node visit node override end visit endvisit node register call registercall super end visit superendvisit node visit node override visit body declaration bodydeclaration node register call registercall body declaration bodydeclaration super visit supervisit body declaration bodydeclaration node visit node override end visit endvisit body declaration bodydeclaration node register call registercall body declaration bodydeclaration super end visit superendvisit body declaration bodydeclaration node visit node override visit abstract type declaration abstracttypedeclaration node register call registercall abstract type declaration abstracttypedeclaration super visit supervisit abstract type declaration abstracttypedeclaration node visit node override end visit endvisit abstract type declaration abstracttypedeclaration node register call registercall abstract type declaration abstracttypedeclaration super end visit superendvisit abstract type declaration abstracttypedeclaration node visit node override visit comment node register call registercall comment super visit supervisit comment node visit node override end visit endvisit comment node register call registercall comment super end visit superendvisit comment node visit node override visit type node register call registercall type super visit supervisit type node visit node override end visit endvisit type node register call registercall type super end visit superendvisit type node visit node override visit statement node register call registercall statement super visit supervisit statement node visit node override end visit endvisit statement node register call registercall statement super end visit superendvisit statement node visit node override visit variable declaration variabledeclaration node register call registercall variable declaration variabledeclaration super visit supervisit variable declaration variabledeclaration node visit node override end visit endvisit variable declaration variabledeclaration node register call registercall variable declaration variabledeclaration super end visit superendvisit variable declaration variabledeclaration node visit node region updated response ast node astnode hierarchy verifies visit method hierarchicalastvisitor calls visit code clazz code superclass clazz code clazz code proper descendant ast node astnode code clazz code ast node astnode check method calls superclass method checkmethodcallssuperclassmethod ast node astnode clazz is leaf isleaf is end visit isendvisit is true istrue ast node astnode is assignable from isassignablefrom clazz is true istrue ast node astnode equals clazz testhierarchicalastvisitor visitor testhierarchicalastvisitor visitor check method calls superclass method checkmethodcallssuperclassmethod clazz is leaf isleaf is end visit isendvisit methods ast node astnode descendant code clazz code method reflect ively reflectively verifies check required methods for non leaf checkrequiredmethodsfornonleaf ast node astnode clazz is end visit isendvisit is true istrue ast node astnode is assignable from isassignablefrom clazz testhierarchicalastvisitor get declared method getdeclaredmethod get visit method name getvisitmethodname is end visit isendvisit clazz no such method exception nosuchmethodexception fail test updated testhierarchicalastvisitor declared test missing method leaf node get simple name getsimplename clazz testhierarchicalastvisitor get declared method getdeclaredmethod get super visit name getsupervisitname is end visit isendvisit clazz no such method exception nosuchmethodexception fail test updated testhierarchicalastvisitor declared test missing method leaf node get simple name getsimplename clazz ast node astnode f node class for called method fnodeclassforcalledmethod check method calls superclass method checkmethodcallssuperclassmethod ast node astnode clazz is leaf isleaf is end visit isendvisit invoke method result execution hierarchicalastvisitor implementation visit clazz clazz leaf invoke visit invoke super visit supervisit calls visit visit overridden parameter passed visit super visit supervisit req uirement requirement parameter visit methods simply reflect ively reflectively instantiate app ropriately appropriately type d typed node method method testhierarchicalastvisitor get method getmethod is leaf isleaf get visit method name getvisitmethodname is end visit isendvisit super visit supervisit clazz method invoke object no such method exception nosuchmethodexception print stack trace printstacktrace is true istrue illegal access exception illegalaccessexception print stack trace printstacktrace is true istrue invocation target exception invocationtargetexception print stack trace printstacktrace is true istrue verify method invokation caused call visit superclass clazz verify visit method called check superclass method called checksuperclassmethodcalled clazz is end visit isendvisit check superclass method called checksuperclassmethodcalled ast node astnode clazz is end visit isendvisit is not null isnotnull clazz get superclass getsuperclass implementations visit methods leaf f node class for called method fnodeclassforcalledmethod implementation executed visit implementation hierarchicalastvisitor calls visit method superclass check f node class for called method fnodeclassforcalledmethod superclass clazz assert true asserttrue get super method not called message for getsupermethodnotcalledmessagefor clazz is end visit isendvisit clazz get superclass getsuperclass equals f node class for called method fnodeclassforcalledmethod string get super method not called message for getsupermethodnotcalledmessagefor ast node astnode clazz is end visit isendvisit get method signature for getmethodsignaturefor clazz is end visit isendvisit hierarchicalastvisitor call get method signature for getmethodsignaturefor clazz get superclass getsuperclass is end visit isendvisit visitor method superclass register call registercall ast node astnode node class for method nodeclassformethod assert null assertnull invocation visit method hierarchicalastvisitor caused visit method called visit method hierarchicalastvisitor visit ast node astnode simply call visit superclass f node class for called method fnodeclassforcalledmethod f node class for called method fnodeclassforcalledmethod node class for method nodeclassformethod testhierarchicalastvisitor boolean value booleanvalue call super visit to avoid unused methods warning callsupervisittoavoidunusedmethodswarning use less useless method calls super visit supervisit super end visit superendvisit methods test calls methods reflect ively reflectively compiler doesn wrongly reports unused explicit references satisfy compiler call super visit to avoid unused methods warning callsupervisittoavoidunusedmethodswarning super visit supervisit ast node astnode super end visit superendvisit ast node astnode super visit supervisit expression super end visit superendvisit expression super visit supervisit annotation super end visit superendvisit annotation super visit supervisit annotatable type annotatabletype super end visit superendvisit annotatable type annotatabletype super visit supervisit method reference methodreference super end visit superendvisit method reference methodreference super visit supervisit super end visit superendvisit super visit supervisit body declaration bodydeclaration super end visit superendvisit body declaration bodydeclaration super visit supervisit abstract type declaration abstracttypedeclaration super end visit superendvisit abstract type declaration abstracttypedeclaration super visit supervisit comment super end visit superendvisit comment super visit supervisit type super end visit superendvisit type super visit supervisit statement super end visit superendvisit statement super visit supervisit variable declaration variabledeclaration super end visit superendvisit variable declaration variabledeclaration hierarchicalastvisitortest hierarchicalastvisitortest ast node astnode f leaves fleaves hierarchicalastvisitortest string test suite test suite testsuite test f leaves fleaves getleafastnodedescendants ast node astnode allastnodedescendants compute all descendants from leaves computealldescendantsfromleaves f leaves fleaves iterator ast node astnode check all methods for hierarchy exist checkallmethodsforhierarchyexist allastnodedescendants iterator check all methods for hierarchy exist checkallmethodsforhierarchyexist allastnodedescendants iterator check methods call superclass method checkmethodscallsuperclassmethod allastnodedescendants iterator check methods call superclass method checkmethodscallsuperclassmethod allastnodedescendants iterator is leaf isleaf ast node astnode clazz f leaves fleaves clazz hierarchicalastvisitor subsequent test correct hierarchicalastvisitor testhierarchicalastvisitor declare methods ast node astnode hierarchy hierarchicalastvisitor declare method hierarchy testhierarchicalastvisitor declare pair methods leaf ast node astnode hierarchy method verifies required methods exist suggests updates needed properly main tain maintain methods check all methods for hierarchy exist checkallmethodsforhierarchyexist iterator ast node astnode hierarchy classes hierarchyclasses is end visit isendvisit hierarchy classes hierarchyclasses has next hasnext ast node astnode descendant hierarchy classes hierarchyclasses check hierarchical visitor method exists for checkhierarchicalastvisitormethodexistsfor descendant is end visit isendvisit is leaf isleaf descendant testhierarchicalastvisitor check required methods for non leaf checkrequiredmethodsfornonleaf descendant is end visit isendvisit visit implementations hierarchicalastvisitor call visit superclass ast node astnode method verifies ref lection reflection contrived subclass hierarchicalastvisitor testhierarchicalastvisitor check methods call superclass method checkmethodscallsuperclassmethod iterator ast node astnode hierarchy classes hierarchyclasses is end visit isendvisit hierarchy classes hierarchyclasses has next hasnext ast node astnode descendant hierarchy classes hierarchyclasses ast node astnode equals descendant testhierarchicalastvisitor check method calls superclass method checkmethodcallssuperclassmethod descendant is leaf isleaf descendant is end visit isendvisit check hierarchical visitor method exists for checkhierarchicalastvisitormethodexistsfor ast node astnode node class nodeclass is end visit isendvisit is true istrue ast node astnode is assignable from isassignablefrom node class nodeclass hierarchicalastvisitor get declared method getdeclaredmethod get visit method name getvisitmethodname is end visit isendvisit node class nodeclass no such method exception nosuchmethodexception string signature get visit method name getvisitmethodname is end visit isendvisit get simple name getsimplename node class nodeclass assert true asserttrue hierarchicalastvisitor updated reflect change ast node astnode hierarchy method signature hierarchicalastvisitor string get visit method name getvisitmethodname is end visit isendvisit is end visit isendvisit end visit endvisit visit string get super visit name getsupervisitname is end visit isendvisit is end visit isendvisit super end visit superendvisit super visit supervisit string get simple name getsimplename clazz string qualified clazz get name getname qualified substring qualified last index of lastindexof string get method signature for getmethodsignaturefor clazz is end visit isendvisit get visit method name getvisitmethodname is end visit isendvisit get simple name getsimplename clazz finds desc end ants descendants code root code proper desc end ants descendants sequence code leaves code include code root code elements code leaves code ast node astnode compute all descendants from leaves computealldescendantsfromleaves iterator ast node astnode leaves ast node astnode root ast node astnode hash set hashset leaves has next hasnext ast node astnode leaf leaves add all ancestors inclusive addallancestorsinclusive leaf root add all ancestors inclusive addallancestorsinclusive ast node astnode ast node astnode ast node astnode is true istrue is assignable from isassignablefrom is true istrue is interface isinterface is true istrue is interface isinterface ancestor ancestor equals suppress warnings suppresswarnings unchecked ast node astnode node type nodetype ast node astnode ancestor add node type nodetype ancestor ancestor get superclass getsuperclass ancestor is true istrue expected assert ions assertions passed add returns leaf node classes classes subclasses ast node astnode leaf ast node astnode descendant inc l incl ast node astnode leaf ast node astnode desc end ants descendants concrete ast node astnode desc end ants descendants ast visitor astvisitor main tained maintained classes ast visitor astvisitor visit methods property compute ast visitor astvisitor require hierarchicalastvisitor semantically provide ast node astnode getleafastnodedescendants ast node astnode result hash set hashset method methods ast visitor astvisitor get methods getmethods methods length method method methods is visit method isvisitmethod method suppress warnings suppresswarnings unchecked ast node astnode node type nodetype ast node astnode method get parameter types getparametertypes result add node type nodetype result is visit method isvisitmethod method method visit equals method get name getname parameters method get parameter types getparametertypes parameters length ast node astnode is assignable from isassignablefrom parameters
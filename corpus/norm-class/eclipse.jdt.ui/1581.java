copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation ferenc hechler ferenc hechler users source for ge sourceforge net jar exporter create ant build file current settings ferenc hechler ferenc hechler users source for ge sourceforge net jar application ant build file create path entry manifest ferenc hechler ferenc hechler users source for ge sourceforge net jar application add jar jar class loader classloader option ferenc hechler ferenc hechler users source for ge sourceforge net jar exporter ant file jar jar option relative path jar rsrc loader zip ferenc hechler ferenc hechler users source for ge sourceforge net jar exporter ant file produced export runnable jar abs olut absolut paths relative workspace org eclipse jdt internal jar package rfat jarpackagerfat java file java file not found exception filenotfoundexception java i o exception ioexception java util array list arraylist java util hash map hashmap java util map org dom document org dom element org dom node org eclipse core runtime core exception coreexception org eclipse core runtime i path ipath org eclipse core runtime i status istatus org eclipse core runtime multi status multistatus org eclipse core runtime path org eclipse core runtime status org eclipse core resources resources plugin resourcesplugin org eclipse debug core i launch configuration ilaunchconfiguration org eclipse jdt internal corext util messages org eclipse jdt launching i java launch configuration constants ijavalaunchconfigurationconstants org eclipse jdt launching i runtime classpath entry iruntimeclasspathentry org eclipse jdt launching java runtime javaruntime org eclipse jdt javaui org eclipse jdt internal java plugin javaplugin org eclipse jdt internal viewsupport basic element labels basicelementlabels create ant script runnable jar script generated based classpath selected launch configuration fat jar ant exporter fatjarantexporter nls string ant property name propertyname dir buildfile dir build file buildfile nls string ant property name propertyname dir workspace dir workspace nls string ant property name propertyname dir jar file jarfile dir jar file jarfile nls nls string ant property dir buildfile ant property name propertyname dir buildfile nls nls string ant property dir workspace ant property name propertyname dir workspace nls nls string ant property dir jar file jarfile ant property name propertyname dir jar file jarfile source info sourceinfo is jar isjar string abs path abspath string rel jar path reljarpath source info sourceinfo is jar isjar string abs path abspath string rel jar path reljarpath is jar isjar is jar isjar abs path abspath abs path abspath rel jar path reljarpath rel jar path reljarpath helper path substitutions manages path substitutions apply longest substitution chosen path sub stituter pathsubstituter map string string path substitutions pathsubstitutions hash map hashmap path sub stituter pathsubstituter add substitution addsubstitution string base path basepath string base replacement basereplacement path substitutions pathsubstitutions base path basepath base replacement basereplacement string substitute string path len string result path string base path basepath path substitutions pathsubstitutions key set keyset base path basepath length len path equals base path basepath result path substitutions pathsubstitutions base path basepath path starts with startswith base path basepath file separator len base path basepath length result path substitutions pathsubstitutions base path basepath path substring len result i launch configuration ilaunchconfiguration f launch configuration flaunchconfiguration i path ipath f abs jar file fabsjarfile i path ipath f ant script location fantscriptlocation string f build file dir fbuildfiledir string f workspace dir fworkspacedir string f jar file dir fjarfiledir path sub stituter pathsubstituter path sub stituter pathsubstituter create instance ant exporter ant exporter generate ant script ant script location launch configuration param ant script location antscriptlocation location ant script generate param jar location jarlocation location jar file ant script generate param launch configuration launchconfiguration launch configuration generate ant script fat jar ant exporter fatjarantexporter i path ipath ant script location antscriptlocation i path ipath jar location jarlocation i launch configuration ilaunchconfiguration launch configuration launchconfiguration f launch configuration flaunchconfiguration launch configuration launchconfiguration f abs jar file fabsjarfile jar location jarlocation f ant script location fantscriptlocation ant script location antscriptlocation path sub stituter pathsubstituter path sub stituter pathsubstituter f build file dir fbuildfiledir ant script location antscriptlocation to file tofile get parent file getparentfile get canonical path getcanonicalpath path sub stituter pathsubstituter add substitution addsubstitution f build file dir fbuildfiledir ant property dir buildfile exception java plugin javaplugin log f build file dir fbuildfiledir f jar file dir fjarfiledir jar location jarlocation to file tofile get parent file getparentfile get canonical path getcanonicalpath path sub stituter pathsubstituter add substitution addsubstitution f jar file dir fjarfiledir ant property dir jar file jarfile exception java plugin javaplugin log f jar file dir fjarfiledir f workspace dir fworkspacedir resources plugin resourcesplugin get workspace getworkspace get root getroot get location getlocation to file tofile get canonical path getcanonicalpath path sub stituter pathsubstituter add substitution addsubstitution f workspace dir fworkspacedir ant property dir workspace exception java plugin javaplugin log f workspace dir fworkspacedir create ant script based constructor param status report warnings core exception coreexception wrong generating ant script multi status multistatus status core exception coreexception i path ipath classpath get classpath getclasspath f launch configuration flaunchconfiguration string main class mainclass get main class getmainclass f launch configuration flaunchconfiguration status nls string project name projectname f launch configuration flaunchconfiguration get attribute getattribute i java launch configuration constants ijavalaunchconfigurationconstants attr project buildantscript f ant script location fantscriptlocation project name projectname f abs jar file fabsjarfile main class mainclass convert classpath file not found exception filenotfoundexception core exception coreexception status i status istatus error javaui plugin messages format fat jar package r messages fatjarpackagermessages fat jar package wizard fatjarpackagewizard ant script antscript error reading output file readingoutputfile object basic element labels basicelementlabels get path label getpathlabel f ant script location fantscriptlocation get local ized message getlocalizedmessage i o exception ioexception core exception coreexception status i status istatus error javaui plugin messages format fat jar package r messages fatjarpackagermessages fat jar package wizard fatjarpackagewizard ant script antscript error writing output file writingoutputfile object basic element labels basicelementlabels get path label getpathlabel f ant script location fantscriptlocation get local ized message getlocalizedmessage i path ipath get classpath getclasspath i launch configuration ilaunchconfiguration configuration core exception coreexception i runtime classpath entry iruntimeclasspathentry entries java runtime javaruntime compute unresolved runtime classpath computeunresolvedruntimeclasspath configuration entries java runtime javaruntime resolve runtime classpath resolveruntimeclasspath entries configuration array list arraylist i path ipath user entries userentries array list arraylist entries length entries length entries get classpath property getclasspathproperty i runtime classpath entry iruntimeclasspathentry user classes string location entries get location getlocation location i path ipath entry path fromosstring location user entries userentries entry user entries userentries add entry user entries userentries to array toarray i path ipath user entries userentries size string get main class getmainclass i launch configuration ilaunchconfiguration launch config launchconfig multi status multistatus status string result launch config launchconfig result launch config launchconfig get attribute getattribute i java launch configuration constants ijavalaunchconfigurationconstants attr main type string core exception coreexception java plugin javaplugin log result status add status i status istatus warning javaui plugin fat jar package r messages fatjarpackagermessages fat jar package wizard page fatjarpackagewizardpage launch configuration without main type launchconfigurationwithoutmaintype warning nls result result source info sourceinfo convert i path ipath classpath source info sourceinfo result source info sourceinfo classpath length classpath length i path ipath path classpath path path to file tofile is directory isdirectory result nls source info sourceinfo nls nls path to string tostring nls path to file tofile is file isfile todo check jar extension result nls source info sourceinfo nls nls path to string tostring nls result adds dir properties ant build file buildfile property dir build file buildfile property dir workspace dir build file buildfile property dir jar file jarfile temp param document dom document ant build script param project project tag add base dir properties addbasedirproperties document document element project nls node comment document create comment createcomment define folder properties project append child appendchild comment nls element property document create element createelement property nls property set attribute setattribute ant property name propertyname dir buildfile nls nls property set attribute setattribute project append child appendchild property nls property document create element createelement property nls property set attribute setattribute ant property name propertyname dir workspace nls property set attribute setattribute get workspace relative dir getworkspacerelativedir project append child appendchild property nls property document create element createelement property nls property set attribute setattribute ant property name propertyname dir jar file jarfile nls property set attribute setattribute get jar file relative dir getjarfilerelativedir project append child appendchild property converts filename relative ant property dirs buidfile dir ant script workspace dir eclipse workspace dir jar file jarfile dir jar written param abs file name absfilename filename base dir substituted original filename relative path base dirs string substitute base dirs substitutebasedirs string abs file name absfilename string can onicle file name canoniclefilename can onicle file name canoniclefilename file abs file name absfilename get canonical path getcanonicalpath i o exception ioexception print stack trace printstacktrace abs file name absfilename string result path sub stituter pathsubstituter substitute can onicle file name canoniclefilename result result replace file separator char separatorchar result returns workspace dir path relative build file buildfile dir relative path workspace dir string get workspace relative dir getworkspacerelativedir string result f build file dir fbuildfiledir starts with startswith f workspace dir fworkspacedir file separator last slash lastslash f workspace dir fworkspacedir length nls nls result dir build file buildfile file separator last slash lastslash f build file dir fbuildfiledir index of indexof file separator last slash lastslash last slash lastslash result nls file separator nls last slash lastslash f build file dir fbuildfiledir index of indexof file separator last slash lastslash result path sub stituter pathsubstituter add substitution addsubstitution f build file dir fbuildfiledir ant property dir buildfile substitute f workspace dir fworkspacedir result result replace file separator char separatorchar result returns jar file jarfile dir path relative build file buildfile dir workspace dir relative path jar file jarfile dir string get jar file relative dir getjarfilerelativedir string result path sub stituter pathsubstituter add substitution addsubstitution f build file dir fbuildfiledir ant property dir buildfile add substitution addsubstitution f workspace dir fworkspacedir ant property dir workspace substitute f jar file dir fjarfiledir result result replace file separator char separatorchar result create ant script location param ant script location antscriptlocation write ant script param project name projectname base project info rmational informational purpose param abs jar file absjarfile path destination param main class mainclass optional main param source infos sourceinfos array sources i o exception ioexception exception occurred writing stream buildantscript i path ipath ant script location antscriptlocation string project name projectname i path ipath abs jar file absjarfile string main class mainclass source info sourceinfo source infos sourceinfos i o exception ioexception
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal text java java util arrays org eclipse core runtime org eclipse text edits delete edit deleteedit org eclipse text edits malformed tree exception malformedtreeexception org eclipse text edits replace edit replaceedit org eclipse text edits text edit textedit org eclipse jface preference i preference store ipreferencestore org eclipse jface text bad location exception badlocationexception org eclipse jface text document command documentcommand org eclipse jface text i auto edit strategy iautoeditstrategy org eclipse jface text i document idocument org eclipse jface text i region iregion org eclipse jface text i text selection itextselection org eclipse jface text i type d region itypedregion org eclipse jface text region org eclipse jface text text selection textselection org eclipse jface text text utilities textutilities org eclipse i editor part ieditorpart org eclipse i workbench page iworkbenchpage org eclipse texteditor i text editor extension itexteditorextension org eclipse texteditor i text editor extension itexteditorextension org eclipse jdt preference constants preferenceconstants org eclipse jdt text i java partitions ijavapartitions org eclipse jdt internal java plugin javaplugin org eclipse jdt internal java editor javaeditor compilation unit editor compilationuniteditor org eclipse jdt internal text smart backspace manager smartbackspacemanager org eclipse jdt internal text smart backspace manager smartbackspacemanager undo spec undospec modifies code document command documentcommand code inserting semicolons opening braces place smartly moving user expects practice semicolons braces caret moved type d typed semicolons code code statements definition semicolon brace current caret position cursor moved org eclipse jface text document command documentcommand smart semicolon auto edit strategy smartsemicolonautoeditstrategy i auto edit strategy iautoeditstrategy string representation semicolon nls string semicolon representation semicolon semichar string rep res enattion represenattion opening brace nls string brace representation opening brace brace char bracechar f character fcharacter string f partitioning fpartitioning creates smart semicolon auto edit strategy smartsemicolonautoeditstrategy param partitioning document partitioning smart semicolon auto edit strategy smartsemicolonautoeditstrategy string partitioning f partitioning fpartitioning partitioning org eclipse jface text i auto edit strategy iautoeditstrategy customize document command customizedocumentcommand org eclipse jface text i document idocument org eclipse jface text document command documentcommand override customize document command customizedocumentcommand i document idocument document document command documentcommand command command text command text equals semicolon f character fcharacter semichar command text equals brace f character fcharacter brace char bracechar i preference store ipreferencestore store java plugin javaplugin get default getdefault get preference store getpreferencestore f character fcharacter semichar store get boolean getboolean preference constants preferenceconstants editor smart semicolon f character fcharacter brace char bracechar store get boolean getboolean preference constants preferenceconstants editor smart opening brace i workbench page iworkbenchpage java plugin javaplugin get active page getactivepage i editor part ieditorpart get active editor getactiveeditor compilation unit editor compilationuniteditor compilation unit editor compilationuniteditor editor compilation unit editor compilationuniteditor editor get insert mode getinsertmode i text editor extension itexteditorextension smart insert editor is editable iseditable i text editor extension itexteditorextension extension editor get adapter getadapter i text editor extension itexteditorextension extension extension validate editor input state validateeditorinputstate is multiline selection ismultilineselection document command find concerned position java code location statement pos command offset i text selection itextselection i region iregion document get line information of offset getlineinformationofoffset pos text selection textselection document get offset getoffset get length getlength bad location exception badlocationexception choose action based find ings findings statement compute position insert character position in line positioninline compute character position computecharacterposition document pos get offset getoffset f character fcharacter f partitioning fpartitioning position position in line positioninline get offset getoffset position current position position pos existing content already present alreadypresent document f character fcharacter position don special processing normal behaviour string insertion adjust spacing adjustspacing document position f character fcharacter command offset position insertion equals command text smart backspace manager smartbackspacemanager manager editor get adapter getadapter smart backspace manager smartbackspacemanager manager java plugin javaplugin get default getdefault get preference store getpreferencestore get boolean getboolean preference constants preferenceconstants editor smart backspace text edit textedit replace edit replaceedit command offset command text length document command offset command length undo spec undospec undo spec undospec command offset command text length region command offset text edit textedit delete edit deleteedit smart delete edit deleteedit position insertion length replace edit replaceedit raw replace edit replaceedit command offset command length command text undo spec undospec undo spec undospec position insertion length region command offset command text length text edit textedit smart raw manager register modify command command offset position command length command caret offset caretoffset position command text insertion command doit command owner malformed tree exception malformedtreeexception java plugin javaplugin log bad location exception badlocationexception java plugin javaplugin log returns code code document command applied multi selection code code param document document param command command code code code command code multiline command is multiline selection ismultilineselection i document idocument document document command documentcommand command document get number of lines getnumberoflines command offset command length bad location exception badlocationexception adds space brace inserted parenthesis equal sign key words keywords code code param doc document working param position insert position code character code param character character inserted code string code consisting code character code additional spacing string adjust spacing adjustspacing i document idocument doc position character character brace char bracechar position position doc get length getlength pos position looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls looks like lookslike doc pos looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls looks like lookslike nls doc nls pos nls string character string character checks character inserted insert location separated whitespace code position code param document document working param position insert position code code param character inserted code code code code code location code code code already present alreadypresent i document idocument document position pos first non whitespace for ward firstnonwhitespaceforward document position f partitioning fpartitioning document get length getlength pos document get char getchar pos bad location exception badlocationexception computes insert position character current param document document working param change param offset position caret code character code type d typed param character character param partitioning document partitioning position code character code inserted replaced compute character position computecharacterposition i document idocument document i text selection itextselection offset character string partitioning string text get text gettext text insert pos insertpos character brace char bracechar insert pos insertpos compute array initialization pos computearrayinitializationpos document offset partitioning insert pos insertpos insert pos insertpos compute after try do else computeaftertrydoelse document offset insert pos insertpos insert pos insertpos compute after parent hesis computeafterparenthesis document offset partitioning character semichar is for statement isforstatement text offset don statements semis vital insert pos insertpos next partition pos nextpartitionpos next partition or line end nextpartitionorlineend document offset partitioning insert pos insertpos start of whitespace before offset startofwhitespacebeforeoffset text next partition pos nextpartitionpos semi location already present alreadypresent insert pos insertpos text char at charat insert pos insertpos character insert pos insertpos insert pos insertpos insert pos insertpos text char at charat insert pos insertpos opening scan backward scanbackward document insert pos insertpos get offset getoffset partitioning opening opening offset get offset getoffset compute array initialization pos computearrayinitializationpos document opening get offset getoffset partitioning insert pos insertpos offset is true istrue insert pos insertpos computes insert position opening brace code offset code maps position code document code rhs assignment array definition param document document modified param current investigation param offset offset caret position relative start param partitioning document partitioning insert position relative start code code array initialization code offset code compute array initialization pos computearrayinitializationpos i document idocument document i text selection itextselection offset string partitioning search find partition pos offset get offset getoffset pos first non whitespace backward firstnonwhitespacebackward document pos partitioning document get char getchar offset first non whitespace backward firstnonwhitespacebackward document partitioning document get char getchar character is java identifier part isjavaidentifierpart offset bad location exception badlocationexception computes insert position opening brace code offset code maps position code doc code involving keyword block code code code code code code code code code code code code param doc document modified param current investigation param offset offset caret position relative start insert position relative start code code key words keywords code offset code compute after try do else computeaftertrydoelse i document idocument doc i text selection itextselection offset search find partition offset get offset getoffset first whitespace to right firstwhitespacetoright doc nls looks like lookslike doc looks like lookslike nls doc nls nls looks like lookslike nls doc nls nls looks like lookslike nls doc nls nls looks like lookslike nls doc nls nls nls looks like lookslike doc get offset getoffset computes insert position opening brace code offset code maps position code document code expression parenthesis block closing parenthesis param document document modified param current investigation param offset offset caret position relative start param partitioning document partitioning insert position relative start code code parenthesized expression block compute after parent hesis computeafterparenthesis i document idocument document i text selection itextselection offset string partitioning find opening parenthesis closing parenthesis current offset position closing parenthesis method declaration expression statement pos offset get offset getoffset length get offset getoffset get length getlength scan to scanto scan for ward scanforward document pos partitioning length scan to scanto scan to scanto length closing paren closingparen find closing paren to left findclosingparentoleft document pos partitioning start scan startscan closing paren closingparen closing paren closingparen scan for ward scanforward document start scan startscan partitioning scan to scanto closing paren closingparen opening paren openingparen find opening paren match findopeningparenmatch document closing paren closingparen partitioning expression document opening paren openingparen select insert positions parenthesis embracing caret opening paren openingparen pos looks like anonymous class def lookslikeanonymousclassdef document opening paren openingparen partitioning closing paren closingparen get offset getoffset looks like if while for catch lookslikeifwhileforcatch document opening paren openingparen partitioning closing paren closingparen get offset getoffset looks like method decl lookslikemethoddecl document opening paren openingparen partitioning closing paren closingparen get offset getoffset finds closing parenthesis left code position code document parenthesis separated whitespace code position code parenthesis code position code returned param document document modified param position character position code document code considered param partitioning document partitioning position closing parenthesis left code position code separated whitespace code position code parenthesis find closing paren to left findclosingparentoleft i document idocument document position string partitioning closing paren position position nonws first non whitespace backward firstnonwhitespacebackward document position partitioning nonws document get char getchar nonws closing paren nonws bad location exception badlocationexception position finds whitespace character position including code position code param document document modified param position character position code document code considered position whitespace character greater equal code position code separated whitespace first whitespace to right firstwhitespacetoright i document idocument document position length document get length getlength is true istrue position is true istrue position length position length document get char getchar position character is whitespace iswhitespace position position position bad location exception badlocationexception finds highest position code document code position code position code code bound code code character is whitespace iswhitespace document get char getchar pos code eval uates evaluates code code position partition param document document modified param position character position code document code considered param partitioning document partitioning param bound position code document code code bound code code position code highest position element code chars code code position code code scan to scanto code res ides resides java partition code code first non whitespace backward firstnonwhitespacebackward i document idocument document position string partitioning bound is true istrue position document get length getlength is true istrue bound position bound document get char getchar position character is whitespace iswhitespace is default partition isdefaultpartition document position partitioning position position bad location exception badlocationexception finds smallest position code document code position code position code code bound code code character is whitespace iswhitespace document get char getchar pos code eval uates evaluates code code position partition param document document modified param position character position code document code considered param partitioning document partitioning param bound position code document code code bound code code position code smallest position element code chars code code position code code scan to scanto code res ides resides java partition code code first non whitespace for ward firstnonwhitespaceforward i document idocument document position string partitioning bound is true istrue position is true istrue bound document get length getlength position bound document get char getchar position character is whitespace iswhitespace is default partition isdefaultpartition document position partitioning position position bad location exception badlocationexception finds highest position code document code position code position code code bound code code document get char getchar position code eval uates evaluates code code code chars code position partition param document document modified param position character position code document code considered param partitioning document partitioning param bound position code document code code scan to scanto code code position code param chars array code code search highest position element code chars code code bound code code position code res ides resides java partition code code scan backward scanbackward i document idocument document position string partitioning bound chars is true istrue bound is true istrue position document get length getlength arrays sort chars position bound arrays binary search binarysearch chars document get char getchar position is default partition isdefaultpartition document position partitioning position position bad location exception badlocationexception finds highest position code document code position code position code code bound code code document get char getchar position code eval uates evaluates code code position partition param document document modified param position character position code document code considered param bound position code document code code scan to scanto code code position code param chars array code code search highest position element code chars code code position code code scan to scanto code res ides resides java partition code code scan backward scanbackward i document idocument document position bound scan backward scanbackward document position bound finds lowest position code document code position code position code code bound code code document get char getchar position code eval uates evaluates code code code chars code position partition param document document modified param position character position code document code considered param partitioning document partitioning param bound position code document code code scan to scanto code code position code param chars array code code search lowest position element code chars code code position code code bound code res ides resides java partition code code scan for ward scanforward i document idocument document position string partitioning bound chars is true istrue position is true istrue bound document get length getlength arrays sort chars position bound arrays binary search binarysearch chars document get char getchar position is default partition isdefaultpartition document position partitioning position position bad location exception badlocationexception finds lowest position code document code position code position code code bound code code document get char getchar position code eval uates evaluates code code position partition param document document modified param position character position code document code considered param partitioning document partitioning param bound position code document code code scan to scanto code code position code param code code search lowest position element code chars code code position code code bound code res ides resides java partition code code scan for ward scanforward i document idocument document position string partitioning bound scan for ward scanforward document position partitioning bound checks content code document code range code offset code code length code code code keyword param document document modified param offset character position code document code considered param length length character range considered param partitioning document partitioning code code character range code code keyword code code is new match isnewmatch i document idocument document offset length string partitioning is true istrue length is true istrue offset is true istrue offset length document get length getlength string text document offset length nls pos text index of indexof pos is default partition isdefaultpartition document pos offset partitioning pos nls text index of indexof nls nls pos pos pos character is java identifier part isjavaidentifierpart text char at charat pos pos length character is java identifier part isjavaidentifierpart text char at charat pos bad location exception badlocationexception checks content code document code code position code anonymous definition code position code left opening parenthesis definition parameter list param document document modified param position character position code document code considered param partitioning document partitioning code code content code document code anonymous definition code code looks like anonymous class def lookslikeanonymousclassdef i document idocument document position string partitioning previous comma paren equal previouscommaparenequal scan backward scanbackward document position partitioning borders previous comma paren equal previouscommaparenequal position previous comma paren equal previouscommaparenequal is new match isnewmatch document previous comma paren equal previouscommaparenequal position previous comma paren equal previouscommaparenequal partitioning checks code position code res ides resides java partition code document code param document document modified param position position checked param partitioning document partitioning code code code position code partition code document code code code is default partition isdefaultpartition i document idocument document position string partitioning is true istrue position is true istrue position document get length getlength don get partition getpartition int erested interested scanned character partition i type d region itypedregion region text utilities textutilities get partition getpartition document partitioning position region get type gettype equals i document idocument content type bad location exception badlocationexception finds position parenthesis matching closing parenthesis code position code param document document modified param position position code document code closing parenthesis param partitioning document partitioning position code document code matching parenthesis find opening paren match findopeningparenmatch i document idocument document position string partitioning closing paren opening paren is true istrue position document get length getlength is true istrue position is true istrue is default partition isdefaultpartition document position partitioning is true istrue document get char getchar position closing paren depth position scan backward scanbackward document position partitioning closing paren opening paren position document get char getchar position closing paren depth depth depth position bad location exception badlocationexception checks left code position code separated whitespace code document code keyword parameter list block code code code code code code code code code code code code param document document modified param position character position code document code considered param partitioning document partitioning code code code document code key words keywords left code position code code code looks like if while for catch lookslikeifwhileforcatch i document idocument document position string partitioning position first non whitespace backward firstnonwhitespacebackward document position partitioning position nls looks like lookslike document position looks like lookslike nls document nls position nls looks like lookslike nls document nls position nls looks like lookslike document position looks like lookslike nls document nls position nls looks like lookslike nls document nls position nls checks code document code code string code code code character code position code code code starts identifier determined link character is java identifier part isjavaidentifierpart code code preceded identifier character stands document start param document document modified param position character position code document code considered param code string code code code code document code code code ends code position code code code looks like lookslike i document idocument document position string length length position length equals document position length length position length character is java identifier part isjavaidentifierpart char at charat character is java identifier part isjavaidentifierpart document get char getchar position length bad location exception badlocationexception checks content code document code code position code method declaration header type method code position code left opening parenthesis parameter list param document document modified param position character position code document code considered param partitioning document partitioning code code content code document code method definition code code looks like method decl lookslikemethoddecl i document idocument document position string partitioning method position eat ident to left eatidenttoleft document position partitioning position position eat brackets eatbrackets document position partitioning position position eat ident to left eatidenttoleft document position partitioning position code position code left eats whitespace pair brackets declare array type pre string pre position opening bracket code position code pair brackets parsed param document document modified param position character position code document code considered param partitioning document partitioning smallest character position bracket pair code position code eat brackets eatbrackets i document idocument document position string partitioning accept array type pos first non whitespace backward firstnonwhitespacebackward document position partitioning pos document get char getchar pos pos first non whitespace backward firstnonwhitespacebackward document pos partitioning pos document get char getchar pos pos bad location exception badlocationexception position code position code left eats whitespace identifier returning position identifier character normal read order called document content code string code position ition positionition letter code string code param document document modified param position character position code document code considered param partitioning document partitioning smallest character position identifier code position code eat ident to left eatidenttoleft i document idocument document position string partitioning position is true istrue position document get length getlength first non whitespace backward firstnonwhitespacebackward document position partitioning document get char getchar character is java identifier part isjavaidentifierpart length character is whitespace iswhitespace position start document reached bad location exception badlocationexception returns position java partition empty comment partition whitespace returned position partition contained param document document modified param investigation param offset caret offset code code param partitioning document partitioning position java partition code code next partition or line end nextpartitionorlineend i document idocument document i text selection itextselection offset string partitioning relative document doc offset docoffset offset get offset getoffset eol get offset getoffset get length getlength init next partition pos nextpartitionpos eol valid position validposition doc offset docoffset i type d region itypedregion partition text utilities textutilities get partition getpartition document partitioning next partition pos nextpartitionpos valid position validposition get valid position for partition getvalidpositionforpartition document partition eol valid position validposition next partition pos nextpartitionpos partition get offset getoffset next partition pos nextpartitionpos doc offset docoffset valid position validposition doc offset docoffset partition text utilities textutilities get partition getpartition document partitioning next partition pos nextpartitionpos valid position validposition get valid position for partition getvalidpositionforpartition document partition eol bad location exception badlocationexception valid position validposition math max valid position validposition doc offset docoffset relative valid position validposition get offset getoffset valid position validposition returns valid insert location whitespace code partition code valid insert location valid insert location java string character partition java partition code max offset maxoffset code comment part itions partitions empty java part itions partitions yield valid insert positions param doc document modified param partition current partition param max offset maxoffset maximum offset valid insert location code partition code valid insert location get valid position for partition getvalidpositionforpartition i document idocument doc i type d region itypedregion partition max offset maxoffset invalid i java partitions ijavapartitions java doc equals partition get type gettype invalid i java partitions ijavapartitions java multi comment equals partition get type gettype invalid i java partitions ijavapartitions java single comment equals partition get type gettype invalid end offset endoffset math min max offset maxoffset partition get offset getoffset partition get length getlength i java partitions ijavapartitions java character equals partition get type gettype end offset endoffset i java partitions ijavapartitions java string equals partition get type gettype end offset endoffset i document idocument content type equals partition get type gettype doc partition get offset getoffset end offset endoffset partition get offset getoffset trim length invalid end offset endoffset bad location exception badlocationexception invalid don partition assume valid end offset endoffset determines current statement algorithm word positive contained string literal produce positive param change param offset position caret code code code code code code code code is for statement isforstatement string offset searching nls for pos forpos index of indexof for pos forpos for pos forpos character is java identifier part isjavaidentifierpart char at charat for pos forpos length for pos forpos character is java identifier part isjavaidentifierpart char at charat for pos forpos returns position code text code whitespace code offset code param text text searched param offset maximum offset search smallest code code code text substring offset trim code start of whitespace before offset startofwhitespacebeforeoffset string text offset math min offset text length character is whitespace iswhitespace text char at charat
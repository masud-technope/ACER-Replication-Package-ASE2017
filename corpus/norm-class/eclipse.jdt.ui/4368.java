copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation ferenc hechler ferenc hechler users source for ge sourceforge net jar exporter deploy java application executable jar ferenc hechler ferenc hechler users source for ge sourceforge net jar exporter export directory entries runnable jar file https bugs eclipse org bugs bug cgi org eclipse jdt jar package r jarpackager java buffered input stream bufferedinputstream java buffered output stream bufferedoutputstream java file java file input stream fileinputstream java file not found exception filenotfoundexception java file output stream fileoutputstream java i o exception ioexception java input stream inputstream java output stream outputstream java net uri java util array list arraylist java util arrays java util comparator java util hash set hashset java util list java util java util jar jar entry jarentry java util jar jar output stream jaroutputstream java util jar manifest java util zip zip entry zipentry org eclipse swt widgets shell org eclipse core file system filesystem efs org eclipse core file system filesystem i file info ifileinfo org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core runtime i path ipath org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core runtime operation canceled exception operationcanceledexception org eclipse core runtime path org eclipse core resources i container icontainer org eclipse core resources i file ifile org eclipse core resources i project iproject org eclipse core resources i resource iresource org eclipse core resources resources plugin resourcesplugin org eclipse ltk core refactoring refactoring core refactoringcore org eclipse ltk core refactoring refactoring descriptor refactoringdescriptor org eclipse ltk core refactoring refactoring descriptor proxy refactoringdescriptorproxy org eclipse jdt internal corext util messages org eclipse jdt internal java plugin javaplugin org eclipse jdt internal jar package r jarpackager jar packager messages jarpackagermessages org eclipse jdt internal jar package r jarpackager jar packager util jarpackagerutil org eclipse jdt internal viewsupport basic element labels basicelementlabels creates jar file jar data clients subclass org eclipse jdt jar package r jarpackager jar package data jarpackagedata jar writer jarwriter string f dir ectories fdirectories hash set hashset jar output stream jaroutputstream f jar output stream fjaroutputstream jar package data jarpackagedata f jar package fjarpackage creates instance create jar based jar package jarpackage param jar package jarpackage jar specification param parent shell display question dialogs code code cancel answer dialog core exception coreexception signal unusual termination status object jar writer jarwriter jar package data jarpackagedata jar package jarpackage shell parent core exception coreexception nls is not null isnotnull jar package jarpackage jar specification f jar package fjarpackage jar package jarpackage nls is true istrue f jar package fjarpackage is valid isvalid jar specification invalid can create jar cancreatejar parent operation canceled exception operationcanceledexception f jar package fjarpackage uses manifest usesmanifest f jar package fjarpackage are generated files exported aregeneratedfilesexported manifest manifest f jar package fjarpackage get manifest provider getmanifestprovider create f jar package fjarpackage f jar output stream fjaroutputstream jar output stream jaroutputstream buffered output stream bufferedoutputstream file output stream fileoutputstream f jar package fjarpackage get absolute jar location getabsolutejarlocation to file tofile manifest f jar output stream fjaroutputstream jar output stream jaroutputstream buffered output stream bufferedoutputstream file output stream fileoutputstream f jar package fjarpackage get absolute jar location getabsolutejarlocation to file tofile string comment jar package jarpackage get comment getcomment comment f jar output stream fjaroutputstream set comment setcomment comment f jar package fjarpackage is refactoring aware isrefactoringaware is true istrue f jar package fjarpackage are directory entries included aredirectoryentriesincluded i path ipath meta path metapath path jar packager util jarpackagerutil get meta entry getmetaentry add dir ectories adddirectories meta path metapath add history addhistory f jar package fjarpackage path jar packager util jarpackagerutil get refactorings entry getrefactoringsentry null progress monitor nullprogressmonitor i o exception ioexception exception jar packager util jarpackagerutil create core exception createcoreexception exception get local ized message getlocalizedmessage exception creates directory entries path writes current archive param destination path destinationpath path add i o exception ioexception error occurred add dir ectories adddirectories i path ipath destination path destinationpath i o exception ioexception add dir ectories adddirectories destination path destinationpath to string tostring creates directory entries path writes current archive param dest path destpath path add i o exception ioexception error occurred add dir ectories adddirectories string dest path destpath i o exception ioexception string path dest path destpath replace file separator char separatorchar last slash lastslash path last index of lastindexof list jar entry jarentry directories array list arraylist last slash lastslash path path substring last slash lastslash f dir ectories fdirectories add path jar entry jarentry new entry newentry jar entry jarentry path new entry newentry set method setmethod zip entry zipentry stored new entry newentry set size setsize new entry newentry set crc setcrc new entry newentry set time settime system current time millis currenttimemillis directories add new entry newentry last slash lastslash path last index of lastindexof last slash lastslash directories size f jar output stream fjaroutputstream put next entry putnextentry directories creates directory entries path writes current archive param resource resource parent directories param destination path destinationpath path add i o exception ioexception error occurred core exception coreexception accessing resource f ailes failes add dir ectories adddirectories i resource iresource resource i path ipath destination path destinationpath i o exception ioexception core exception coreexception i container icontainer parent string path destination path destinationpath to string tostring replace file separator char separatorchar last slash lastslash path last index of lastindexof list jar entry jarentry directories array list arraylist last slash lastslash path path substring last slash lastslash f dir ectories fdirectories add path parent resource get parent getparent time stamp timestamp system current time millis currenttimemillis uri location parent getlocationuri location i file info ifileinfo info efs get store getstore location fetch info fetchinfo info exists time stamp timestamp info get last modified getlastmodified jar entry jarentry new entry newentry jar entry jarentry path new entry newentry set method setmethod zip entry zipentry stored new entry newentry set size setsize new entry newentry set crc setcrc new entry newentry set time settime time stamp timestamp directories add new entry newentry last slash lastslash path last index of lastindexof last slash lastslash directories size f jar output stream fjaroutputstream put next entry putnextentry directories creates jar entry jarentry passed path contents writes current archive param resource file write param path path archive i o exception ioexception error occurred core exception coreexception resource accessed add file addfile i file ifile resource i path ipath path i o exception ioexception core exception coreexception jar entry jarentry new entry newentry jar entry jarentry path to string tostring replace file separator char separatorchar read buffer readbuffer f jar package fjarpackage is comp res sed iscompressed new entry newentry set method setmethod zip entry zipentry deflated entry filled automatically new entry newentry set method setmethod zip entry zipentry stored jar packager util jarpackagerutil calculate crc and size calculatecrcandsize new entry newentry resource get contents getcontents read buffer readbuffer last modified lastmodified system current time millis currenttimemillis uri locationuri resource getlocationuri locationuri i file info ifileinfo info efs get store getstore locationuri fetch info fetchinfo info exists last modified lastmodified info get last modified getlastmodified modification time new entry newentry set time settime last modified lastmodified input stream inputstream content stream contentstream resource get contents getcontents add entry addentry new entry newentry content stream contentstream write entry describing content current archive param entry entry write param content content write i o exception ioexception error occurred add entry addentry jar entry jarentry entry input stream inputstream content i o exception ioexception read buffer readbuffer f jar output stream fjaroutputstream put next entry putnextentry entry count count content read read buffer readbuffer read buffer readbuffer length f jar output stream fjaroutputstream write read buffer readbuffer count content content close commented jre s jres npe stream closed works put next entry putnextentry closes previous entry closing stream closes entry f jar output stream fjaroutputstream close entry closeentry creates jar file entry refactoring history param data jar data param path path refactoring history file archive param monitor progress monitor i o exception ioexception temp file written core exception coreexception error occurs transforming ref actorings refactorings add history addhistory jar package data jarpackagedata data i path ipath path i progress monitor iprogressmonitor monitor i o exception ioexception core exception coreexception is not null isnotnull data is not null isnotnull path is not null isnotnull monitor refactoring descriptor proxy refactoringdescriptorproxy proxies data get refactoring descriptors getrefactoringdescriptors arrays sort proxies comparator refactoring descriptor proxy refactoringdescriptorproxy override compare refactoring descriptor proxy refactoringdescriptorproxy refactoring descriptor proxy refactoringdescriptorproxy delta get time stamp gettimestamp get time stamp gettimestamp delta delta file file output stream outputstream output nls file file create temp file createtempfile history output buffered output stream bufferedoutputstream file output stream fileoutputstream file refactoring core refactoringcore get history service gethistoryservice write refactoring descriptors writerefactoringdescriptors proxies output refactoring descriptor refactoringdescriptor monitor output close output i o exception ioexception exception write meta data writemetadata data file path output output close i o exception ioexception exception file file delete checks jar file overwritten jar setting overwrite jar dialog user param parent parent dialog code code dialog presented code code create jar can create jar cancreatejar shell parent file file f jar package fjarpackage get absolute jar location getabsolutejarlocation to file tofile file exists file can write canwrite f jar package fjarpackage allow overwrite allowoverwrite parent jar packager util jarpackagerutil ask for overwrite permission askforoverwritepermission parent f jar package fjarpackage get absolute jar location getabsolutejarlocation test directory exists string path file get absolute path getabsolutepath separator index separatorindex path last index of lastindexof file separator directory fine separator index separatorindex file directory file path substring separator index separatorindex directory exists jar packager util jarpackagerutil ask to create directory asktocreatedirectory parent directory directory mkdirs closes archive required cleanup core exception coreexception signal unusual termination status object close core exception coreexception f jar output stream fjaroutputstream f jar output stream fjaroutputstream close register i n workspace i f needed registerinworkspaceifneeded i o exception ioexception jar packager util jarpackagerutil create core exception createcoreexception get local ized message getlocalizedmessage register i n workspace i f needed registerinworkspaceifneeded i path ipath jar path jarpath f jar package fjarpackage get absolute jar location getabsolutejarlocation i project iproject projects resources plugin resourcesplugin get workspace getworkspace get root getroot get projects getprojects projects length i project iproject project projects jar local file system project project local get location getlocation save i path ipath project location projectlocation project get location getlocation project location projectlocation project location projectlocation is prefix of isprefixof jar path jarpath jar path jarpath jar path jarpath remove first segments removefirstsegments project location projectlocation segment count segmentcount jar path jarpath jar path jarpath remove last segments removelastsegments i resource iresource containing folder containingfolder project find member findmember jar path jarpath containing folder containingfolder containing folder containingfolder is accessible isaccessible containing folder containingfolder refresh local refreshlocal i resource iresource depth core exception coreexception java plugin javaplugin log writes passed resource current archive param resource file written param destination path destinationpath path file archive core exception coreexception signal unusual termination status object write i file ifile resource i path ipath destination path destinationpath core exception coreexception f jar package fjarpackage are directory entries included aredirectoryentriesincluded add dir ectories adddirectories resource destination path destinationpath add file addfile resource destination path destinationpath i o exception ioexception string message get local ized message getlocalizedmessage message messages format jar packager messages jarpackagermessages jar writer jarwriter write problem with message writeproblemwithmessage object basic element labels basicelementlabels get path label getpathlabel resource get full path getfullpath get local ized message getlocalizedmessage message messages format jar packager messages jarpackagermessages jar writer jarwriter write problem writeproblem basic element labels basicelementlabels get path label getpathlabel resource get full path getfullpath jar packager util jarpackagerutil create core exception createcoreexception message writes meta file jar file param data jar data param file file meta data param path path meta file archive file not found exception filenotfoundexception meta file i o exception ioexception input output error occurs write meta data writemetadata jar package data jarpackagedata data file file i path ipath path file not found exception filenotfoundexception i o exception ioexception is not null isnotnull data is not null isnotnull file is not null isnotnull path jar entry jarentry entry jar entry jarentry path to string tostring replace file separator char separatorchar buffer data is comp res sed iscompressed entry set method setmethod zip entry zipentry deflated entry set method setmethod zip entry zipentry stored jar packager util jarpackagerutil calculate crc and size calculatecrcandsize entry buffered input stream bufferedinputstream file input stream fileinputstream file buffer entry set time settime system current time millis currenttimemillis input stream inputstream stream buffered input stream bufferedinputstream file input stream fileinputstream file f jar output stream fjaroutputstream put next entry putnextentry entry count count stream read buffer buffer length f jar output stream fjaroutputstream write buffer count stream close i o exception ioexception exception
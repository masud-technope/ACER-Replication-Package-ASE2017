copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal corext refactoring reorg java util array list arraylist java util arrays java util hash map hashmap java util iterator java util list java util map org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime operation canceled exception operationcanceledexception org eclipse core runtime sub progress monitor subprogressmonitor org eclipse core resources i resource iresource org eclipse text edits replace edit replaceedit org eclipse text edits text edit textedit org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse ltk core refactoring text change textchange org eclipse jdt core flags org eclipse jdt core i buffer ibuffer org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i import declaration iimportdeclaration org eclipse jdt core i java element ijavaelement org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core i type itype org eclipse jdt core java model exception javamodelexception org eclipse jdt core tool factory toolfactory org eclipse jdt core compiler i scanner iscanner org eclipse jdt core compiler i terminal symbols iterminalsymbols org eclipse jdt core compiler invalid input exception invalidinputexception org eclipse jdt core dom rewrite import rewrite importrewrite org eclipse jdt core search i java search constants ijavasearchconstants org eclipse jdt core search i java search scope ijavasearchscope org eclipse jdt core search search engine searchengine org eclipse jdt core search search match searchmatch org eclipse jdt core search search pattern searchpattern org eclipse jdt core search type reference match typereferencematch org eclipse jdt internal corext code manipulation codemanipulation stub utility stubutility org eclipse jdt internal corext refactoring collecting search requestor collectingsearchrequestor org eclipse jdt internal corext refactoring refactoring core messages refactoringcoremessages org eclipse jdt internal corext refactoring refactoring scope factory refactoringscopefactory org eclipse jdt internal corext refactoring refactoring search engine refactoringsearchengine org eclipse jdt internal corext refactoring search result group searchresultgroup org eclipse jdt internal corext refactoring base references in binary context referencesinbinarycontext org eclipse jdt internal corext refactoring text change compatibility textchangecompatibility org eclipse jdt internal corext refactoring structure reference finder util referencefinderutil org eclipse jdt internal corext refactoring util text change manager textchangemanager org eclipse jdt internal corext util java model util javamodelutil org eclipse jdt internal corext util messages org eclipse jdt internal corext util search utils searchutils org eclipse jdt internal java plugin javaplugin org eclipse jdt internal viewsupport basic element labels basicelementlabels move cu update creator movecuupdatecreator string f new package fnewpackage i compilation unit icompilationunit f cus fcus i package fragment ipackagefragment f destination fdestination i compilation unit icompilationunit import edit importedit map i compilation unit icompilationunit import rewrite importrewrite f import rewrites fimportrewrites move cu update creator movecuupdatecreator i compilation unit icompilationunit i package fragment ipackagefragment pack i compilation unit icompilationunit pack move cu update creator movecuupdatecreator i compilation unit icompilationunit cus i package fragment ipackagefragment pack is not null isnotnull cus is not null isnotnull pack f cus fcus cus f destination fdestination pack f import rewrites fimportrewrites hash map hashmap nls f new package fnewpackage f destination fdestination is default package isdefaultpackage f destination fdestination get element name getelementname text change manager textchangemanager create change manager createchangemanager i progress monitor iprogressmonitor refactoring status refactoringstatus status java model exception javamodelexception nls begin task begintask text change manager textchangemanager change manager changemanager text change manager textchangemanager add updates addupdates change manager changemanager sub progress monitor subprogressmonitor status add import rewrite updates addimportrewriteupdates change manager changemanager change manager changemanager java model exception javamodelexception core exception coreexception java model exception javamodelexception add import rewrite updates addimportrewriteupdates text change manager textchangemanager change manager changemanager core exception coreexception iterator i compilation unit icompilationunit iter f import rewrites fimportrewrites key set keyset iterator iter has next hasnext i compilation unit icompilationunit iter import rewrite importrewrite import rewrite importrewrite f import rewrites fimportrewrites import rewrite importrewrite import rewrite importrewrite has recorded changes hasrecordedchanges text change compatibility textchangecompatibility add text edit addtextedit change manager changemanager refactoring core messages refactoringcoremessages move cu update creator movecuupdatecreator update imports import rewrite importrewrite rewrite imports rewriteimports add updates addupdates text change manager textchangemanager change manager changemanager i progress monitor iprogressmonitor refactoring status refactoringstatus status core exception coreexception nls begin task begintask f cus fcus length f cus fcus length is canceled iscanceled operation canceled exception operationcanceledexception add updates addupdates change manager changemanager f cus fcus sub progress monitor subprogressmonitor status add updates addupdates text change manager textchangemanager change manager changemanager i compilation unit icompilationunit moved unit movedunit i progress monitor iprogressmonitor refactoring status refactoringstatus status core exception coreexception nls begin task begintask sub task subtask messages format refactoring core messages refactoringcoremessages move cu update creator movecuupdatecreator searching basic element labels basicelementlabels get file name getfilename moved unit movedunit is in another fragment of same package isinanotherfragmentofsamepackage moved unit movedunit f destination fdestination worked add import to source package types addimporttosourcepackagetypes moved unit movedunit sub progress monitor subprogressmonitor remove imports to destination package types removeimportstodestinationpackagetypes moved unit movedunit add reference updates addreferenceupdates change manager changemanager moved unit movedunit sub progress monitor subprogressmonitor status add reference updates addreferenceupdates text change manager textchangemanager change manager changemanager i compilation unit icompilationunit moved unit movedunit i progress monitor iprogressmonitor refactoring status refactoringstatus status java model exception javamodelexception core exception coreexception list i compilation unit icompilationunit cu list culist arrays as list aslist f cus fcus search result group searchresultgroup references get references getreferences moved unit movedunit status references length search result group searchresultgroup search result group searchresultgroup references i compilation unit icompilationunit referencing cu referencingcu search result group searchresultgroup get compilation unit getcompilationunit referencing cu referencingcu simple references need new import simplereferencesneednewimport simple references need new import simplereferencesneednewimport moved unit movedunit referencing cu referencingcu cu list culist search match searchmatch search result group searchresultgroup get search results getsearchresults length todo update type references add import addimport type reference typereference reference type reference typereference reference is import declaration isimportdeclaration import rewrite importrewrite rewrite get import rewrite getimportrewrite referencing cu referencingcu i import declaration iimportdeclaration import decl importdecl i import declaration iimportdeclaration search utils searchutils get enclosing java element getenclosingjavaelement flags is static isstatic import decl importdecl get flags getflags rewrite remove static import removestaticimport import decl importdecl get element name getelementname add static import addstaticimport moved unit movedunit import decl importdecl rewrite rewrite remove import removeimport import decl importdecl get element name getelementname rewrite add import addimport create string for new import createstringfornewimport moved unit movedunit import decl importdecl reference is qualified isqualified text change textchange text change textchange change manager changemanager referencing cu referencingcu string change name changename refactoring core messages refactoringcoremessages move cu update creator movecuupdatecreator update references text edit textedit replace edit replaceedit replace edit replaceedit reference get offset getoffset reference get simple name start getsimplenamestart reference get offset getoffset f new package fnewpackage text change compatibility textchangecompatibility add text edit addtextedit text change textchange change name changename replace edit replaceedit simple references need new import simplereferencesneednewimport import rewrite importrewrite import edit importedit get import rewrite getimportrewrite referencing cu referencingcu string type name typename reference get simple name getsimplename import edit importedit add import addimport get qualified type getqualifiedtype f destination fdestination get element name getelementname type name typename add static import addstaticimport i compilation unit icompilationunit moved unit movedunit i import declaration iimportdeclaration import decl importdecl import rewrite importrewrite rewrite string import decl importdecl get element name getelementname old pack length oldpacklength moved unit movedunit get parent getparent get element name getelementname length string buffer stringbuffer result string buffer stringbuffer f destination fdestination get element name getelementname move old pack length oldpacklength result append append move result length cut result append substring old pack length oldpacklength result append substring old pack length oldpacklength nls result last index of lastindexof result length rewrite add static import addstaticimport result substring result substring result length string get qualified type getqualifiedtype string package name packagename string type name typename package name packagename length type name typename package name packagename type name typename string create string for new import createstringfornewimport i compilation unit icompilationunit moved unit movedunit i import declaration iimportdeclaration import decl importdecl string import decl importdecl get element name getelementname old pack length oldpacklength moved unit movedunit get parent getparent get element name getelementname length string buffer stringbuffer result string buffer stringbuffer f destination fdestination get element name getelementname move old pack length oldpacklength result append append move result length cut result append substring old pack length oldpacklength result append substring old pack length oldpacklength result to string tostring remove imports to destination package types removeimportstodestinationpackagetypes i compilation unit icompilationunit moved unit movedunit core exception coreexception import rewrite importrewrite import edit importedit get import rewrite getimportrewrite moved unit movedunit i type itype destination types destinationtypes get destination package types getdestinationpackagetypes destination types destinationtypes length import edit importedit remove import removeimport destination types destinationtypes get fully qualified name getfullyqualifiedname i type itype get destination package types getdestinationpackagetypes java model exception javamodelexception list i type itype types array list arraylist f destination fdestination exists i compilation unit icompilationunit cus f destination fdestination get compilation units getcompilationunits cus length types add all addall arrays as list aslist cus get all types getalltypes types to array toarray i type itype types size add import to source package types addimporttosourcepackagetypes i compilation unit icompilationunit moved unit movedunit i progress monitor iprogressmonitor core exception coreexception list i compilation unit icompilationunit cu list culist arrays as list aslist f cus fcus i type itype all cu types allcutypes moved unit movedunit get all types getalltypes i type itype referenced types referencedtypes reference finder util referencefinderutil get types referenced in gettypesreferencedin all cu types allcutypes import rewrite importrewrite import edit importedit get import rewrite getimportrewrite moved unit movedunit import edit importedit set filter implicit imports setfilterimplicitimports i package fragment ipackagefragment src pack srcpack i package fragment ipackagefragment moved unit movedunit get parent getparent referenced types referencedtypes length i type itype i type itype referenced types referencedtypes i type itype exists java model util javamodelutil is same package issamepackage i type itype get package fragment getpackagefragment src pack srcpack cu list culist i type itype get compilation unit getcompilationunit import edit importedit add import addimport i type itype get fully qualified name getfullyqualifiedname import rewrite importrewrite get import rewrite getimportrewrite i compilation unit icompilationunit core exception coreexception f import rewrites fimportrewrites contains key containskey f import rewrites fimportrewrites import rewrite importrewrite import edit importedit stub utility stubutility create import rewrite createimportrewrite f import rewrites fimportrewrites import edit importedit import edit importedit simple references need new import simplereferencesneednewimport i compilation unit icompilationunit moved unit movedunit i compilation unit icompilationunit referencing cu referencingcu list i compilation unit icompilationunit cu list culist referencing cu referencingcu equals moved unit movedunit cu list culist referencing cu referencingcu is reference in another fragment of same package isreferenceinanotherfragmentofsamepackage referencing cu referencingcu moved unit movedunit destination source is destination another fragment of same package isdestinationanotherfragmentofsamepackage moved unit movedunit add updates addupdates heuristic nls referencing cu referencingcu get import getimport moved unit movedunit get parent getparent get element name getelementname exists star referencing cu referencingcu get parent getparent equals moved unit movedunit get parent getparent moved is reference in another fragment of same package isreferenceinanotherfragmentofsamepackage i compilation unit icompilationunit referencing cu referencingcu i compilation unit icompilationunit moved unit movedunit referencing cu referencingcu referencing cu referencingcu get parent getparent i package fragment ipackagefragment i package fragment ipackagefragment pack i package fragment ipackagefragment referencing cu referencingcu get parent getparent is in another fragment of same package isinanotherfragmentofsamepackage moved unit movedunit pack is in another fragment of same package isinanotherfragmentofsamepackage i compilation unit icompilationunit i package fragment ipackagefragment pack get parent getparent i package fragment ipackagefragment i package fragment ipackagefragment cu pack cupack i package fragment ipackagefragment get parent getparent cu pack cupack equals pack java model util javamodelutil is same package issamepackage cu pack cupack pack search result group searchresultgroup get references getreferences i compilation unit icompilationunit unit i progress monitor iprogressmonitor refactoring status refactoringstatus status core exception coreexception search pattern searchpattern pattern refactoring search engine refactoringsearchengine create or pattern createorpattern unit get types gettypes i java search constants ijavasearchconstants references pattern string binary refs description binaryrefsdescription messages format refactoring core messages refactoringcoremessages references in binary context referencesinbinarycontext bin aries binaries description basic element labels basicelementlabels get file name getfilename unit references in binary context referencesinbinarycontext binary refs binaryrefs references in binary context referencesinbinarycontext binary refs description binaryrefsdescription collector requestor collector i package fragment ipackagefragment unit get parent getparent binary refs binaryrefs i java search scope ijavasearchscope scope refactoring scope factory refactoringscopefactory create unit search result group searchresultgroup result refactoring search engine refactoringsearchengine search pattern scope requestor sub progress monitor subprogressmonitor status binary refs binaryrefs add error if necessary adderrorifnecessary status result search result group searchresultgroup collector collecting search requestor collectingsearchrequestor i package fragment ipackagefragment f source fsource i scanner iscanner f scanner fscanner collector i package fragment ipackagefragment source references in binary context referencesinbinarycontext binary refs binaryrefs binary refs binaryrefs f source fsource source f scanner fscanner tool factory toolfactory create scanner createscanner override accept search match acceptsearchmatch search match searchmatch match core exception coreexception filter match filtermatch match processing collector reuse buffer required search engine locate matches start include qualification i java element ijavaelement element search utils searchutils get enclosing java element getenclosingjavaelement match accuracy match get acc uracy getaccuracy start match get offset getoffset length match get length getlength inside doc comment insidedoccomment match is inside doc comment isinsidedoccomment i resource iresource res match get resource getresource element get ancestor getancestor i java element ijavaelement declaration collect match collectmatch type reference typereference create import reference createimportreference element accuracy start length inside doc comment insidedoccomment res i compilation unit icompilationunit unit i compilation unit icompilationunit element get ancestor getancestor i java element ijavaelement compilation unit unit i buffer ibuffer buffer unit get buffer getbuffer string match text matchtext buffer get text gettext start length f source fsource is default package isdefaultpackage collect match collectmatch type reference typereference create simple reference createsimplereference element accuracy start length inside doc comment insidedoccomment res match text matchtext match text matchtext doesn start comment simple name start simplenamestart get last simple name start getlastsimplenamestart match text matchtext simple name start simplenamestart collect match collectmatch type reference typereference create qualified reference createqualifiedreference element accuracy start length inside doc comment insidedoccomment res start simple name start simplenamestart collect match collectmatch type reference typereference create simple reference createsimplereference element accuracy start length inside doc comment insidedoccomment res match text matchtext get last simple name start getlastsimplenamestart string reference f scanner fscanner set source setsource reference to char array tochararray last identifier start lastidentifierstart token type tokentype f scanner fscanner get next token getnexttoken token type tokentype i terminal symbols iterminalsymbols tokennameeof token type tokentype i terminal symbols iterminalsymbols token name identifier tokennameidentifier last identifier start lastidentifierstart f scanner fscanner get current token start position getcurrenttokenstartposition token type tokentype f scanner fscanner get next token getnexttoken invalid input exception invalidinputexception java plugin javaplugin log last identifier start lastidentifierstart type reference typereference type reference match typereferencematch string f simple type name fsimpletypename f simple name start fsimplenamestart type reference typereference i java element ijavaelement enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment i resource iresource resource simple name start simplenamestart string simple name simplename enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment search engine searchengine get default search participant getdefaultsearchparticipant resource f simple name start fsimplenamestart simple name start simplenamestart f simple type name fsimpletypename simple name simplename type reference typereference create qualified reference createqualifiedreference i java element ijavaelement enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment i resource iresource resource simple name start simplenamestart is true istrue start simple name start simplenamestart simple name start simplenamestart start length type reference typereference enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment resource simple name start simplenamestart type reference typereference create import reference createimportreference i java element ijavaelement enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment i resource iresource resource type reference typereference enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment resource type reference typereference create simple reference createsimplereference i java element ijavaelement enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment i resource iresource resource string simple name simplename type reference typereference enclosing element enclosingelement accuracy start length inside doc comment insidedoccomment resource simple name simplename is import declaration isimportdeclaration search utils searchutils get enclosing java element getenclosingjavaelement get ancestor getancestor i java element ijavaelement declaration is qualified isqualified f simple name start fsimplenamestart start offset simple type iff is qualified isqualified get simple name start getsimplenamestart f simple name start fsimplenamestart simple type iff is simple name issimplename string get simple name getsimplename f simple type name fsimpletypename
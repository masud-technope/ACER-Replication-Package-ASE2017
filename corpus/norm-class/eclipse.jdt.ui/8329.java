copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt tests refactoring type constraints typeconstraints java io exception ioexception java input stream inputstream java util array list arraylist java util iterator java util list org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java project ijavaproject org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast parser astparser org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom assignment org eclipse jdt core dom compilation unit compilationunit org eclipse jdt core dom expression org eclipse jdt core dom field declaration fielddeclaration org eclipse jdt core dom i binding ibinding org eclipse jdt core dom i type binding itypebinding org eclipse jdt core dom simple name simplename org eclipse jdt core dom variable declaration fragment variabledeclarationfragment org eclipse jdt internal corext dom hierarchicalastvisitor org eclipse jdt internal corext refactoring type constraints typeconstraints types t type ttype org eclipse jdt internal corext refactoring type constraints typeconstraints types type environment typeenvironment org eclipse jdt tests refactoring refactoring test setup refactoringtestsetup org eclipse jdt tests refactoring infra abstractcutestcase org eclipse jdt tests refactoring infra refactoring test plugin refactoringtestplugin org eclipse jdt internal java editor javaeditor ast provider astprovider junit framework test junit framework test suite testsuite type environment tests typeenvironmenttests abstractcutestcase bug core wildcard assignments my test setup mytestsetup refactoring test setup refactoringtestsetup i package fragment ipackagefragment f signature package fsignaturepackage i package fragment ipackagefragment f generic package fgenericpackage my test setup mytestsetup test test test override set up setup exception set up setup f signature package fsignaturepackage get default source folder getdefaultsourcefolder create package fragment createpackagefragment signature f generic package fgenericpackage get default source folder getdefaultsourcefolder create package fragment createpackagefragment i package fragment ipackagefragment get signature package getsignaturepackage f signature package fsignaturepackage i package fragment ipackagefragment get generic package getgenericpackage f generic package fgenericpackage creation checker creationchecker hierarchicalastvisitor type environment typeenvironment f type environment ftypeenvironment creation checker creationchecker f type environment ftypeenvironment type environment typeenvironment override visit simple name simplename node i binding ibinding binding node resolve binding resolvebinding binding i type binding itypebinding check type binding checktypebinding binding check type binding checktypebinding i binding ibinding binding i type binding itypebinding type i type binding itypebinding binding type is primitive isprimitive type get name getname equals t type ttype ref type reftype f type environment ftypeenvironment create type assert not null assertnotnull refactoring type ref type reftype assert equals assertequals type get name getname ref type reftype get name getname assert equals assertequals signature pretty signatures prettysignatures type ref type reftype get pretty signature getprettysignature assert true asserttrue type ref type reftype f type environment ftypeenvironment create type override visit org eclipse jdt core dom type node check type binding checktypebinding node resolve binding resolvebinding type binding collector typebindingcollector ast visitor astvisitor list i type binding itypebinding f result fresult array list arraylist list i type binding itypebinding f wildcards fwildcards array list arraylist override visit field declaration fielddeclaration node list variable declaration fragment variabledeclarationfragment fragments node fragments variable declaration fragment variabledeclarationfragment fragment fragments fragment get name getname get identifier getidentifier equals null type nulltype f result fresult add fragment get initializer getinitializer resolve type binding resolvetypebinding f result fresult add fragment resolve binding resolvebinding get type gettype override end visit endvisit compilation unit compilationunit node iterator i type binding itypebinding iter f result fresult iterator iter has next hasnext i type binding itypebinding binding iter binding is parameterized type isparameterizedtype i type binding itypebinding args binding get type arguments gettypearguments args length args is wildcard type iswildcardtype f wildcards fwildcards add args i type binding itypebinding get result getresult f result fresult to array toarray i type binding itypebinding f result fresult size i type binding itypebinding get wildcards getwildcards f wildcards fwildcards to array toarray i type binding itypebinding f wildcards fwildcards size capture type binding collector capturetypebindingcollector ast visitor astvisitor list i type binding itypebinding f result fresult array list arraylist override visit assignment node expression expression node get right hand side getrighthandside i type binding itypebinding type binding typebinding expression resolve type binding resolvetypebinding f result fresult add type binding typebinding collect type argument bindings collecttypeargumentbindings type binding typebinding f result fresult collect type argument bindings collecttypeargumentbindings i type binding itypebinding type binding typebinding list i type binding itypebinding result type binding typebinding is parameterized type isparameterizedtype i type binding itypebinding type arguments typearguments type binding typebinding get type arguments gettypearguments type arguments typearguments length i type binding itypebinding type argument typeargument type arguments typearguments bug core wildcard assignments type argument typeargument is parameterized type isparameterizedtype type argument typeargument get type arguments gettypearguments is wildcard type iswildcardtype result add type argument typeargument collect type argument bindings collecttypeargumentbindings type argument typeargument result i type binding itypebinding get result getresult f result fresult to array toarray i type binding itypebinding f result fresult size type environment tests typeenvironmenttests string test suite my test setup mytestsetup test suite testsuite type environment tests typeenvironmenttests test set up test setuptest test some test sometest my test setup mytestsetup some test sometest override input stream inputstream get file input stream getfileinputstream string file name filename io exception ioexception refactoring test plugin refactoringtestplugin get default getdefault get test resource stream gettestresourcestream file name filename override string get resource location getresourcelocation type environment typeenvironment test project testproject override string adapt name adaptname string character to upper case touppercase char at charat substring java ast node astnode createast i package fragment ipackagefragment pack exception i java project ijavaproject project pack get java project getjavaproject ast parser astparser parser ast parser astparser new parser newparser ast provider astprovider shared ast level parser set project setproject project parser set resolve bindings setresolvebindings i compilation unit icompilationunit unit createcu pack get name getname parser set source setsource unit parser createast creation perform creation test performcreationtest exception createast my test setup mytestsetup get signature package getsignaturepackage accept creation checker creationchecker test arrays testarrays exception perform creation test performcreationtest test standard types teststandardtypes exception perform creation test performcreationtest test raw types testrawtypes exception perform creation test performcreationtest test generic types testgenerictypes exception perform creation test performcreationtest test wildcard types testwildcardtypes exception perform creation test performcreationtest test primitive types testprimitivetypes exception perform creation test performcreationtest test type variables testtypevariables exception perform creation test performcreationtest assigment test perform generic assignment test performgenericassignmenttest exception ast node astnode node createast my test setup mytestsetup get generic package getgenericpackage type binding collector typebindingcollector collector type binding collector typebindingcollector node accept collector test bindings testbindings collector get result getresult test assignment testassignment collector get wildcards getwildcards test bindings testbindings i type binding itypebinding bindings exception t type ttype types t type ttype bindings length type environment typeenvironment environment type environment typeenvironment bindings length types environment create bindings assert equals assertequals bindings get name getname types get name getname assert equals assertequals signature pretty signatures prettysignatures bindings types get pretty signature getprettysignature assert equals assertequals modifiers bindings get modifiers getmodifiers types get modifiers getmodifiers test flags testflags bindings types assert true asserttrue erasure types get erasure geterasure is equal to isequalto bindings get erasure geterasure assert true asserttrue type declaration types get type declaration gettypedeclaration is equal to isequalto bindings get type declaration gettypedeclaration assert true asserttrue type types environment create bindings bindings length bindings length check can assign to checkcanassignto bindings bindings types types type environment typeenvironment second environment secondenvironment type environment typeenvironment bindings length assert true asserttrue equal environment types equals second environment secondenvironment create bindings i type binding itypebinding restored bindings restoredbindings type environment typeenvironment create type bindings createtypebindings types refactoring test setup refactoringtestsetup get project getproject assert equals assertequals length restored bindings restoredbindings length bindings length restored bindings restoredbindings length assert true asserttrue binding bindings is equal to isequalto restored bindings restoredbindings check can assign to checkcanassignto i type binding itypebinding rhs binding rhsbinding i type binding itypebinding lhs binding lhsbinding t type ttype rhs t type ttype lhs core result coreresult rhs binding rhsbinding is assignment compatible isassignmentcompatible lhs binding lhsbinding ui result uiresult rhs can assign to canassignto lhs assert equals assertequals assignment rule pretty signatures prettysignatures lhs binding lhsbinding pretty signatures prettysignatures rhs binding rhsbinding core result coreresult ui result uiresult test assignment testassignment i type binding itypebinding bindings t type ttype types t type ttype bindings length type environment typeenvironment environment type environment typeenvironment bindings length types environment create bindings bindings length bindings length i type binding itypebinding o binding obinding bindings i type binding itypebinding i binding ibinding bindings core result coreresult o binding obinding is assignment compatible isassignmentcompatible i binding ibinding t type ttype o type otype types t type ttype i type itype types ui result uiresult o type otype can assign to canassignto i type itype bug core wildcard assignments core result coreresult ui result uiresult o type otype is wildcard type iswildcardtype system println assignment rule pretty signatures prettysignatures i binding ibinding pretty signatures prettysignatures o binding obinding bindings core result coreresult t type ttype ui result uiresult test flags testflags i type binding itypebinding binding t type ttype type assert equals assertequals flag binding is class isclass type is class isclass assert equals assertequals enum flag binding is enum isenum type is enum isenum assert equals assertequals flag binding is interface isinterface type is interface isinterface assert equals assertequals annotation flag binding is annotation isannotation type is annotation isannotation assert equals assertequals top level flag binding is top level istoplevel type is top level istoplevel assert equals assertequals nested flag binding is nested isnested type is nested isnested assert equals assertequals local flag binding is local islocal type is local islocal assert equals assertequals member flag binding is member ismember type is member ismember assert equals assertequals anonymous flag binding is anonymous isanonymous type is anonymous isanonymous test standard assignments teststandardassignments exception perform generic assignment test performgenericassignmenttest test wildcard assignments testwildcardassignments exception perform generic assignment test performgenericassignmenttest test type variable assignments testtypevariableassignments exception perform generic assignment test performgenericassignmenttest test capture assignments testcaptureassignments exception ast node astnode node createast my test setup mytestsetup get generic package getgenericpackage capture type binding collector capturetypebindingcollector collector capture type binding collector capturetypebindingcollector node accept collector test bindings testbindings collector get result getresult test assignment testassignment exception ast node astnode node createast my test setup mytestsetup get generic package getgenericpackage type binding collector typebindingcollector collector type binding collector typebindingcollector node accept collector i type binding itypebinding bindings collector get result getresult t type ttype types t type ttype bindings length type environment typeenvironment environment type environment typeenvironment bindings length types environment create bindings system println pretty signatures prettysignatures bindings pretty signatures prettysignatures bindings bindings is assignment compatible isassignmentcompatible bindings types can assign to canassignto types test parameterized to generic testparameterizedtogeneric exception ast node astnode node createast my test setup mytestsetup get generic package getgenericpackage type binding collector typebindingcollector collector type binding collector typebindingcollector node accept collector i type binding itypebinding bindings collector get result getresult bindings bindings get type declaration gettypedeclaration system println pretty signatures prettysignatures bindings pretty signatures prettysignatures bindings bindings is assignment compatible isassignmentcompatible bindings system println pretty signatures prettysignatures bindings pretty signatures prettysignatures bindings bindings is assignment compatible isassignmentcompatible bindings bindings bindings get type declaration gettypedeclaration system println pretty signatures prettysignatures bindings pretty signatures prettysignatures bindings bindings is assignment compatible isassignmentcompatible bindings
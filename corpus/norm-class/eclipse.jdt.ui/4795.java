copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation nikolay metchev nikolaymetchev gmail extract local extract local variable replacing multiple occurrences statement https bugs eclipse org nicolaj hoess nicohoess gmail extract local puts declaration wrong position https bugs eclipse org org eclipse jdt internal corext refactoring code java util array list arraylist java util arrays java util collection java util collections java util comparator java util hash map hashmap java util hash set hashset java util iterator java util list java util map java util string tokenizer stringtokenizer org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime null progress monitor nullprogressmonitor org eclipse core runtime sub progress monitor subprogressmonitor org eclipse text edits text edit group texteditgroup org eclipse ltk core refactoring change org eclipse ltk core refactoring refactoring org eclipse ltk core refactoring refactoring change descriptor refactoringchangedescriptor org eclipse ltk core refactoring refactoring descriptor refactoringdescriptor org eclipse ltk core refactoring refactoring status refactoringstatus org eclipse ltk core refactoring refactoring status entry refactoringstatusentry org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java element ijavaelement org eclipse jdt core i java project ijavaproject org eclipse jdt core java model exception javamodelexception org eclipse jdt core naming conventions namingconventions org eclipse jdt core source range sourcerange org eclipse jdt core compiler i problem iproblem org eclipse jdt core dom ast org eclipse jdt core dom ast node astnode org eclipse jdt core dom ast visitor astvisitor org eclipse jdt core dom annotation org eclipse jdt core dom array initializer arrayinitializer org eclipse jdt core dom assignment org eclipse jdt core dom block org eclipse jdt core dom body declaration bodydeclaration org eclipse jdt core dom cast expression castexpression org eclipse jdt core dom catch clause catchclause org eclipse jdt core dom child list property descriptor childlistpropertydescriptor org eclipse jdt core dom class instance creation classinstancecreation org eclipse jdt core dom compilation unit compilationunit org eclipse jdt core dom constructor invocation constructorinvocation org eclipse jdt core dom do statement dostatement org eclipse jdt core dom enhanced for statement enhancedforstatement org eclipse jdt core dom expression org eclipse jdt core dom expression statement expressionstatement org eclipse jdt core dom field access fieldaccess org eclipse jdt core dom for statement forstatement org eclipse jdt core dom i binding ibinding org eclipse jdt core dom i method binding imethodbinding org eclipse jdt core dom i type binding itypebinding org eclipse jdt core dom i variable binding ivariablebinding org eclipse jdt core dom if statement ifstatement org eclipse jdt core dom initializer org eclipse jdt core dom lambda expression lambdaexpression org eclipse jdt core dom method declaration methoddeclaration org eclipse jdt core dom modifier modifier keyword modifierkeyword org eclipse jdt core dom org eclipse jdt core dom null literal nullliteral org eclipse jdt core dom parenthesized expression parenthesizedexpression org eclipse jdt core dom postfix expression postfixexpression org eclipse jdt core dom prefix expression prefixexpression org eclipse jdt core dom qualified name qualifiedname org eclipse jdt core dom return statement returnstatement org eclipse jdt core dom simple name simplename org eclipse jdt core dom single variable declaration singlevariabledeclaration org eclipse jdt core dom statement org eclipse jdt core dom structural property descriptor structuralpropertydescriptor org eclipse jdt core dom super constructor invocation superconstructorinvocation org eclipse jdt core dom switch case switchcase org eclipse jdt core dom switch statement switchstatement org eclipse jdt core dom try statement trystatement org eclipse jdt core dom type org eclipse jdt core dom variable declaration expression variabledeclarationexpression org eclipse jdt core dom variable declaration fragment variabledeclarationfragment org eclipse jdt core dom variable declaration statement variabledeclarationstatement org eclipse jdt core dom while statement whilestatement org eclipse jdt core dom rewrite ast rewrite astrewrite org eclipse jdt core dom rewrite import rewrite importrewrite org eclipse jdt core dom rewrite import rewrite importrewrite import rewrite context importrewritecontext org eclipse jdt core dom rewrite list rewrite listrewrite org eclipse jdt core refactoring compilation unit change compilationunitchange org eclipse jdt core refactoring i java refactorings ijavarefactorings org eclipse jdt core refactoring descriptors extract local descriptor extractlocaldescriptor org eclipse jdt internal core refactoring descriptors refactoring signature descriptor factory refactoringsignaturedescriptorfactory org eclipse jdt internal corext core xt corext org eclipse jdt internal corext source range factory sourcerangefactory org eclipse jdt internal corext code manipulation codemanipulation context sensitive import rewrite context contextsensitiveimportrewritecontext org eclipse jdt internal corext code manipulation codemanipulation stub utility stubutility org eclipse jdt internal corext dom ast nodes astnodes org eclipse jdt internal corext dom bindings org eclipse jdt internal corext dom scope analyzer scopeanalyzer org eclipse jdt internal corext dom fragments ast fragment factory astfragmentfactory org eclipse jdt internal corext dom fragments iast fragment iastfragment org eclipse jdt internal corext dom fragments i expression fragment iexpressionfragment org eclipse jdt internal corext linked proposal model linkedproposalmodel org eclipse jdt internal corext linked proposal position group linkedproposalpositiongroup org eclipse jdt internal corext refactoring checks org eclipse jdt internal corext refactoring jdt refactoring descriptor comment jdtrefactoringdescriptorcomment org eclipse jdt internal corext refactoring java refactoring arguments javarefactoringarguments org eclipse jdt internal corext refactoring java refactoring descriptor util javarefactoringdescriptorutil org eclipse jdt internal corext refactoring refactoring core messages refactoringcoremessages org eclipse jdt internal corext refactoring base java status context javastatuscontext org eclipse jdt internal corext refactoring base java string status context javastringstatuscontext org eclipse jdt internal corext refactoring base refactoring status codes refactoringstatuscodes org eclipse jdt internal corext refactoring rename refactoring analyze util refactoringanalyzeutil org eclipse jdt internal corext refactoring structure compilation unit rewrite compilationunitrewrite org eclipse jdt internal corext refactoring util no comment source range computer nocommentsourcerangecomputer org eclipse jdt internal corext refactoring util refactoringastparser org eclipse jdt internal corext refactoring util resource util resourceutil org eclipse jdt internal corext util messages org eclipse jdt java element labels javaelementlabels org eclipse jdt internal java plugin javaplugin org eclipse jdt internal java editor javaeditor ast provider astprovider org eclipse jdt internal text correction ast res olving astresolving org eclipse jdt internal viewsupport basic element labels basicelementlabels org eclipse jdt internal viewsupport binding label provider bindinglabelprovider extract local variable selected expression method initializer extract temp refactoring extracttemprefactoring refactoring nls string attribute replace replace nls string attribute for statement checker forstatementchecker ast visitor astvisitor collection i variable binding ivariablebinding f for initializer variables fforinitializervariables f ref erring to for variable freferringtoforvariable for statement checker forstatementchecker collection i variable binding ivariablebinding for initializer variables forinitializervariables is not null isnotnull for initializer variables forinitializervariables f for initializer variables fforinitializervariables for initializer variables forinitializervariables is ref erring to for variable isreferringtoforvariable f ref erring to for variable freferringtoforvariable override visit simple name simplename node i binding ibinding binding node resolve binding resolvebinding binding f for initializer variables fforinitializervariables binding f ref erring to for variable freferringtoforvariable all arrays equal allarraysequal ast node astnode arrays position object element arrays position arrays length object array arrays element equals array position can replace canreplace iast fragment iastfragment fragment ast node astnode node fragment get associated node getassociatednode ast node astnode parent node get parent getparent parent variable declaration fragment variabledeclarationfragment variable declaration fragment variabledeclarationfragment vdf variable declaration fragment variabledeclarationfragment parent node equals vdf get name getname is method parameter ismethodparameter node is throwable in catch block isthrowableincatchblock node parent expression statement expressionstatement parent lambda expression lambdaexpression is left value isleftvalue node is ref erring to local variable from for isreferringtolocalvariablefromfor expression node is used in for initializer or updater isusedinforinitializerorupdater expression node parent switch case switchcase ast node astnode get array prefix getarrayprefix ast node astnode array prefix length prefixlength is true istrue prefix length prefixlength array length is true istrue prefix length prefixlength ast node astnode prefix ast node astnode prefix length prefixlength prefix length prefix array prefix list i variable binding ivariablebinding list i variable binding ivariablebinding get for initialized variables getforinitializedvariables variable declaration expression variabledeclarationexpression variable declarations variabledeclarations list i variable binding ivariablebinding for initializer variables forinitializervariables array list arraylist iterator variable declaration fragment variabledeclarationfragment iter variable declarations variabledeclarations fragments iterator iter has next hasnext variable declaration fragment variabledeclarationfragment fragment iter i variable binding ivariablebinding binding fragment resolve binding resolvebinding binding for initializer variables forinitializervariables add binding for initializer variables forinitializervariables ast node astnode get longest array prefix getlongestarrayprefix ast node astnode arrays length arrays length ast node astnode min array length minarraylength arrays length arrays length min array length minarraylength math min min array length minarraylength arrays length min array length minarraylength all arrays equal allarraysequal arrays length length ast node astnode get array prefix getarrayprefix arrays length ast node astnode get parents getparents ast node astnode node ast node astnode current node list ast node astnode parents array list arraylist parents add current get parent getparent current current get parent getparent current get parent getparent collections reverse parents parents to array toarray ast node astnode parents size is left value isleftvalue ast node astnode node ast node astnode parent node get parent getparent parent assignment assignment assignment assignment parent assignment get left hand side getlefthandside node parent postfix expression postfixexpression parent prefix expression prefixexpression prefix expression prefixexpression prefix expression prefixexpression parent get operator getoperator equals prefix expression prefixexpression decrement equals prefix expression prefixexpression increment is method parameter ismethodparameter ast node astnode node node simple name simplename node get parent getparent single variable declaration singlevariabledeclaration node get parent getparent get parent getparent method declaration methoddeclaration is ref erring to local variable from for isreferringtolocalvariablefromfor expression expression ast node astnode current expression ast node astnode parent current get parent getparent parent parent body declaration bodydeclaration parent for statement forstatement for statement forstatement for stmt forstmt for statement forstatement parent for stmt forstmt initializers current for stmt forstmt update rs updaters current for stmt forstmt get expression getexpression current list expression initializers for stmt forstmt initializers initializers size initializers variable declaration expression variabledeclarationexpression list i variable binding ivariablebinding for initializer variables forinitializervariables get for initialized variables getforinitializedvariables variable declaration expression variabledeclarationexpression initializers for statement checker forstatementchecker checker for statement checker forstatementchecker for initializer variables forinitializervariables expression accept checker checker is ref erring to for variable isreferringtoforvariable current parent parent current get parent getparent is throwable in catch block isthrowableincatchblock ast node astnode node node simple name simplename node get parent getparent single variable declaration singlevariabledeclaration node get parent getparent get parent getparent catch clause catchclause is used in for initializer or updater isusedinforinitializerorupdater expression expression ast node astnode parent expression get parent getparent parent for statement forstatement for statement forstatement for stmt forstmt for statement forstatement parent for stmt forstmt initializers expression for stmt forstmt update rs updaters expression iast fragment iastfragment retain only replacable matches retainonlyreplacablematches iast fragment iastfragment all matches allmatches list iast fragment iastfragment result array list arraylist all matches allmatches length all matches allmatches length can replace canreplace all matches allmatches result add all matches allmatches result to array toarray iast fragment iastfragment result size compilation unit compilationunit f compilation unit node fcompilationunitnode compilation unit rewrite compilationunitrewrite fcurewrite i compilation unit icompilationunit f cu fcu f declare final fdeclarefinal string f excluded variable names fexcludedvariablenames f replace all occurrences freplacealloccurrences caches i expression fragment iexpressionfragment f selected expression fselectedexpression f selection length fselectionlength f selection start fselectionstart string f temp name ftempname string f guessed temp names fguessedtempnames f check result for compile problems fcheckresultforcompileproblems compilation unit change compilationunitchange f change fchange linked proposal model linkedproposalmodel f linked proposal model flinkedproposalmodel nls string key nls string key type type creates extract temp refactoring param unit compilation unit code code invoked scripting param selection start selectionstart start selection param selection length selectionlength length selection extract temp refactoring extracttemprefactoring i compilation unit icompilationunit unit selection start selectionstart selection length selectionlength is true istrue selection start selectionstart is true istrue selection length selectionlength f selection start fselectionstart selection start selectionstart f selection length fselectionlength selection length selectionlength f cu fcu unit f compilation unit node fcompilationunitnode f replace all occurrences freplacealloccurrences f declare final fdeclarefinal nls f temp name ftempname f linked proposal model flinkedproposalmodel f check result for compile problems fcheckresultforcompileproblems extract temp refactoring extracttemprefactoring compilation unit compilationunit ast root astroot selection start selectionstart selection length selectionlength is true istrue selection start selectionstart is true istrue selection length selectionlength is true istrue ast root astroot get type root gettyperoot i compilation unit icompilationunit f selection start fselectionstart selection start selectionstart f selection length fselectionlength selection length selectionlength f cu fcu i compilation unit icompilationunit ast root astroot get type root gettyperoot f compilation unit node fcompilationunitnode ast root astroot f replace all occurrences freplacealloccurrences f declare final fdeclarefinal nls f temp name ftempname f linked proposal model flinkedproposalmodel f check result for compile problems fcheckresultforcompileproblems extract temp refactoring extracttemprefactoring java refactoring arguments javarefactoringarguments arguments refactoring status refactoringstatus status i compilation unit icompilationunit refactoring status refactoringstatus initialize status initializestatus initialize arguments status merge initialize status initializestatus set check result for compile problems setcheckresultforcompileproblems check result for compile problems checkresultforcompileproblems f check result for compile problems fcheckresultforcompileproblems check result for compile problems checkresultforcompileproblems set linked proposal model setlinkedproposalmodel linked proposal model linkedproposalmodel linked proposal model linkedproposalmodel f linked proposal model flinkedproposalmodel linked proposal model linkedproposalmodel add replace expression with temp addreplaceexpressionwithtemp java model exception javamodelexception iast fragment iastfragment fragments to replace fragmentstoreplace retain only replacable matches retainonlyreplacablematches get matching fragments getmatchingfragments todo prune duplicates ast rewrite astrewrite rewrite fcurewrite getastrewrite hash set hashset iast fragment iastfragment hash set hashset fragments to replace fragmentstoreplace length iast fragment iastfragment fragment fragments to replace fragmentstoreplace add fragment simple name simplename temp name tempname fcurewrite getast new simple name newsimplename f temp name ftempname text edit group texteditgroup description fcurewrite create group description creategroupdescription refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring replace fragment replace rewrite temp name tempname description f linked proposal model flinkedproposalmodel f linked proposal model flinkedproposalmodel get position group getpositiongroup key add position addposition rewrite track temp name tempname refactoring status refactoringstatus check expression checkexpression java model exception javamodelexception expression selected expression selectedexpression get selected expression getselectedexpression get associated expression getassociatedexpression selected expression selectedexpression ast node astnode parent selected expression selectedexpression get parent getparent selected expression selectedexpression null literal nullliteral refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring literals selected expression selectedexpression array initializer arrayinitializer refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring array initializer selected expression selectedexpression assignment parent expression parent parenthesized expression parenthesizedexpression refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring assignment selected expression selectedexpression simple name simplename simple name simplename selected expression selectedexpression is declaration isdeclaration refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring names declarations parent qualified name qualifiedname selected expression selectedexpression get location in parent getlocationinparent qualified name qualifiedname property parent field access fieldaccess selected expression selectedexpression get location in parent getlocationinparent field access fieldaccess property refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring select expression selected expression selectedexpression variable declaration expression variabledeclarationexpression parent try statement trystatement refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring resource resources extract constant refactoring extractconstantrefactoring refactoring status refactoringstatus check expression fragment is value checkexpressionfragmentisrvalue java model exception javamodelexception checks check expression is value checkexpressionisrvalue get selected expression getselectedexpression get associated expression getassociatedexpression checks rvalue misc refactoring status refactoringstatus create status createstatus refactoring status refactoringstatus fatal refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring select expression core xt corext get plugin id getpluginid refactoring status codes refactoringstatuscodes expression rvalue checks rvalue refactoring status refactoringstatus create status createstatus refactoring status refactoringstatus fatal refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring core xt corext get plugin id getpluginid refactoring status codes refactoringstatuscodes expression rvalue checks rvalue guessed checks rvalue refactoring status refactoringstatus is true istrue i type binding itypebinding guess binding for reference guessbindingforreference expression expression i type binding itypebinding binding expression resolve type binding resolvetypebinding binding binding ast res olving astresolving guess binding for reference guessbindingforreference expression binding override refactoring status refactoringstatus check final conditions checkfinalconditions i progress monitor iprogressmonitor core exception coreexception begin task begintask refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring checking preconditions fcurewrite compilation unit rewrite compilationunitrewrite f cu fcu f compilation unit node fcompilationunitnode fcurewrite getastrewrite set target source range computer settargetsourcerangecomputer no comment source range computer nocommentsourcerangecomputer do create change docreatechange sub progress monitor subprogressmonitor f change fchange fcurewrite create change createchange refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring change sub progress monitor subprogressmonitor refactoring status refactoringstatus result refactoring status refactoringstatus arrays as list aslist get excluded variable names getexcludedvariablenames f temp name ftempname result add warning addwarning messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring variable basic element labels basicelementlabels get java element name getjavaelementname f temp name ftempname result merge check matching fragments checkmatchingfragments f change fchange set keep preview edits setkeeppreviewedits f check result for compile problems fcheckresultforcompileproblems check new source checknewsource sub progress monitor subprogressmonitor result result extract local descriptor extractlocaldescriptor create refactoring descriptor createrefactoringdescriptor map string string arguments hash map hashmap string project i java project ijavaproject java project javaproject f cu fcu get java project getjavaproject java project javaproject project java project javaproject get element name getelementname string description messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring descriptor description basic element labels basicelementlabels get java element name getjavaelementname f temp name ftempname string expression ast nodes astnodes as string asstring f selected expression fselectedexpression get associated expression getassociatedexpression string header messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring descriptor description string basic element labels basicelementlabels get java element name getjavaelementname f temp name ftempname basic element labels basicelementlabels get java code string getjavacodestring expression jdt refactoring descriptor comment jdtrefactoringdescriptorcomment comment jdt refactoring descriptor comment jdtrefactoringdescriptorcomment project header comment add setting addsetting messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring pattern basic element labels basicelementlabels get java element name getjavaelementname f temp name ftempname body declaration bodydeclaration decl body declaration bodydeclaration ast nodes astnodes get parent getparent f selected expression fselectedexpression get associated expression getassociatedexpression body declaration bodydeclaration decl method declaration methoddeclaration i method binding imethodbinding method method declaration methoddeclaration decl resolve binding resolvebinding string label method binding label provider bindinglabelprovider get binding label getbindinglabel method java element labels javaelementlabels fully qualified basic element labels basicelementlabels get java element name getjavaelementname java element labels javaelementlabels ellipsis string comment add setting addsetting messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring destination pattern label comment add setting addsetting messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring expression pattern basic element labels basicelementlabels get java code string getjavacodestring expression f replace all occurrences freplacealloccurrences comment add setting addsetting refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring replace occurrences f declare final fdeclarefinal comment add setting addsetting refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring declare extract local descriptor extractlocaldescriptor descriptor refactoring signature descriptor factory refactoringsignaturedescriptorfactory create extract local descriptor createextractlocaldescriptor project description comment as string asstring arguments refactoring descriptor refactoringdescriptor arguments java refactoring descriptor util javarefactoringdescriptorutil attribute input java refactoring descriptor util javarefactoringdescriptorutil element to handle elementtohandle project f cu fcu arguments java refactoring descriptor util javarefactoringdescriptorutil attribute f temp name ftempname nls arguments java refactoring descriptor util javarefactoringdescriptorutil attribute selection integer f selection start fselectionstart to string tostring integer f selection length fselectionlength to string tostring arguments attribute replace value of valueof f replace all occurrences freplacealloccurrences to string tostring arguments attribute value of valueof f declare final fdeclarefinal to string tostring descriptor do create change docreatechange i progress monitor iprogressmonitor core exception coreexception begin task begintask refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring checking preconditions create temp declaration createtempdeclaration core exception coreexception exception java plugin javaplugin log exception add replace expression with temp addreplaceexpressionwithtemp check new source checknewsource sub progress monitor subprogressmonitor monitor refactoring status refactoringstatus result core exception coreexception string new cu source newcusource f change fchange get preview content getpreviewcontent null progress monitor nullprogressmonitor compilation unit compilationunit newcunode refactoringastparser ast provider astprovider shared ast level parse new cu source newcusource f cu fcu monitor i problem iproblem new problems newproblems refactoring analyze util refactoringanalyzeutil get introduce d compile problems getintroducedcompileproblems newcunode f compilation unit node fcompilationunitnode new problems newproblems length i problem iproblem problem new problems newproblems problem is error iserror result add entry addentry refactoring status entry refactoringstatusentry problem is error iserror refactoring status refactoringstatus error refactoring status refactoringstatus warning problem get message getmessage java string status context javastringstatuscontext new cu source newcusource source range factory sourcerangefactory create problem override refactoring status refactoringstatus check initial conditions checkinitialconditions i progress monitor iprogressmonitor core exception coreexception nls begin task begintask refactoring status refactoringstatus result checks validate modifies files validatemodifiesfiles resource util resourceutil get files getfiles i compilation unit icompilationunit f cu fcu get validation context getvalidationcontext result has fatal error hasfatalerror result f compilation unit node fcompilationunitnode f compilation unit node fcompilationunitnode refactoringastparser parsewithastprovider f cu fcu sub progress monitor subprogressmonitor worked result merge check selection checkselection sub progress monitor subprogressmonitor result has fatal error hasfatalerror is literal node selected isliteralnodeselected f replace all occurrences freplacealloccurrences result refactoring status refactoringstatus check matching fragments checkmatchingfragments java model exception javamodelexception refactoring status refactoringstatus result refactoring status refactoringstatus iast fragment iastfragment matching fragments matchingfragments get matching fragments getmatchingfragments matching fragments matchingfragments length ast node astnode node matching fragments matchingfragments get associated node getassociatednode is left value isleftvalue node is ref erring to local variable from for isreferringtolocalvariablefromfor expression node string msg refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring assigned result add warning addwarning msg java status context javastatuscontext create f cu fcu node result refactoring status refactoringstatus check selection checkselection i progress monitor iprogressmonitor java model exception javamodelexception nls begin task begintask i expression fragment iexpressionfragment selected expression selectedexpression get selected expression getselectedexpression selected expression selectedexpression string message refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring select expression code refactoring util coderefactoringutil check method syntax errors checkmethodsyntaxerrors f selection start fselectionstart f selection length fselectionlength f compilation unit node fcompilationunitnode message worked is used in explicit constructor call isusedinexplicitconstructorcall refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring explicit constructor worked ast node astnode associated node associatednode selected expression selectedexpression get associated node getassociatednode get enclosing body node getenclosingbodynode ast nodes astnodes get parent getparent associated node associatednode annotation refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring expr method initializer worked associated node associatednode associated node associatednode get parent getparent class instance creation classinstancecreation associated node associatednode get location in parent getlocationinparent class instance creation classinstancecreation type property refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring worked refactoring status refactoringstatus result refactoring status refactoringstatus result merge check expression checkexpression result has fatal error hasfatalerror result worked result merge check expression fragment is value checkexpressionfragmentisrvalue result has fatal error hasfatalerror result worked is used in for initializer or updater isusedinforinitializerorupdater get selected expression getselectedexpression get associated expression getassociatedexpression refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring initializer update r updater worked is ref erring to local variable from for isreferringtolocalvariablefromfor get selected expression getselectedexpression get associated expression getassociatedexpression refactoring status refactoringstatus create fatal error status createfatalerrorstatus refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring ref ers refers variable worked result refactoring status refactoringstatus check temp name checktempname string new name newname refactoring status refactoringstatus status checks check temp name checktempname new name newname f cu fcu arrays as list aslist get excluded variable names getexcludedvariablenames new name newname status add warning addwarning messages format refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring variable basic element labels basicelementlabels get java element name getjavaelementname new name newname status create and insert temp declaration createandinserttempdeclaration core exception coreexception expression initializer get selected expression getselectedexpression create copy target createcopytarget fcurewrite getastrewrite variable declaration statement variabledeclarationstatement vds create temp declaration createtempdeclaration initializer iast fragment iastfragment replacable matches replacablematches retain only replacable matches retainonlyreplacablematches get matching fragments getmatchingfragments f replace all occurrences freplacealloccurrences replacable matches replacablematches length replacable matches replacablematches length replacable matches replacablematches equals get selected expression getselectedexpression get associated expression getassociatedexpression insert at insertat get selected expression getselectedexpression get associated node getassociatednode vds ast node astnode first replace node parents firstreplacenodeparents get parents getparents get first replaced expression getfirstreplacedexpression get associated node getassociatednode ast node astnode common path commonpath find deepest common super node path for replaced nodes finddeepestcommonsupernodepathforreplacednodes is true istrue common path commonpath length first replace node parents firstreplacenodeparents length ast node astnode deepest common parent deepestcommonparent first replace node parents firstreplacenodeparents common path commonpath length deepest common parent deepestcommonparent block insert at insertat first replace node parents firstreplacenodeparents common path commonpath length vds insert at insertat deepest common parent deepestcommonparent vds variable declaration statement variabledeclarationstatement create temp declaration createtempdeclaration expression initializer core exception coreexception ast ast fcurewrite getast variable declaration fragment variabledeclarationfragment vdf ast new variable declaration fragment newvariabledeclarationfragment vdf set name setname ast new simple name newsimplename f temp name ftempname vdf set initializer setinitializer initializer variable declaration statement variabledeclarationstatement vds ast new variable declaration statement newvariabledeclarationstatement vdf f declare final fdeclarefinal vds modifiers add ast new modifier newmodifier modifier keyword modifierkeyword keyword vds set type settype create temp type createtemptype f linked proposal model flinkedproposalmodel ast rewrite astrewrite rewrite fcurewrite getastrewrite linked proposal position group linkedproposalpositiongroup name group namegroup f linked proposal model flinkedproposalmodel get position group getpositiongroup key name group namegroup add position addposition rewrite track vdf get name getname string name suggestions namesuggestions guess temp names guesstempnames name suggestions namesuggestions length name suggestions namesuggestions equals f temp name ftempname name group namegroup add proposal addproposal f temp name ftempname name suggestions namesuggestions length name suggestions namesuggestions length name group namegroup add proposal addproposal name suggestions namesuggestions name suggestions namesuggestions length vds insert at insertat ast node astnode target statement declaration ast rewrite astrewrite rewrite fcurewrite getastrewrite text edit group texteditgroup group description groupdescription fcurewrite create group description creategroupdescription refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring declare local variable ast node astnode parent target get parent getparent structural property descriptor structuralpropertydescriptor location in parent locationinparent target get location in parent getlocationinparent location in parent locationinparent block statements property location in parent locationinparent switch statement switchstatement statements property location in parent locationinparent if statement ifstatement statement property location in parent locationinparent if statement ifstatement statement property location in parent locationinparent for statement forstatement body property location in parent locationinparent enhanced for statement enhancedforstatement body property location in parent locationinparent do statement dostatement body property location in parent locationinparent while statement whilestatement body property create int ermediate intermediate block target body property control statement block replacement rewrite getast new block newblock list rewrite listrewrite replacement rewrite replacementrewrite rewrite get list rewrite getlistrewrite replacement block statements property replacement rewrite replacementrewrite insert first insertfirst declaration replacement rewrite replacementrewrite insert last insertlast rewrite create move target createmovetarget target rewrite replace target replacement group description groupdescription location in parent locationinparent lambda expression lambdaexpression body property lambda expression lambdaexpression parent get body getbody expression block replacement rewrite getast new block newblock list rewrite listrewrite replacement rewrite replacementrewrite rewrite get list rewrite getlistrewrite replacement block statements property replacement rewrite replacementrewrite insert first insertfirst declaration ast node astnode move target movetarget rewrite create move target createmovetarget target ast ast rewrite getast bindings is void type isvoidtype lambda expression lambdaexpression parent resolve method binding resolvemethodbinding get return type getreturntype expression statement expressionstatement expression statement expressionstatement ast new expression statement newexpressionstatement expression move target movetarget move target movetarget expression statement expressionstatement return statement returnstatement return statement returnstatement ast new return statement newreturnstatement return statement returnstatement set expression setexpression expression move target movetarget move target movetarget return statement returnstatement replacement rewrite replacementrewrite insert last insertlast move target movetarget rewrite replace target replacement group description groupdescription target parent parent parent get parent getparent location in parent locationinparent target get location in parent getlocationinparent list rewrite listrewrite list rewrite listrewrite rewrite get list rewrite getlistrewrite parent child list property descriptor childlistpropertydescriptor location in parent locationinparent list rewrite listrewrite insert before insertbefore declaration target group description groupdescription override change create change createchange i progress monitor iprogressmonitor core exception coreexception begin task begintask refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring checking preconditions extract local descriptor extractlocaldescriptor descriptor create refactoring descriptor createrefactoringdescriptor f change fchange set descriptor setdescriptor refactoring change descriptor refactoringchangedescriptor descriptor f change fchange create temp declaration createtempdeclaration core exception coreexception should replace selected expression with temp declaration shouldreplaceselectedexpressionwithtempdeclaration replace selected expression with temp declaration replaceselectedexpressionwithtempdeclaration create and insert temp declaration createandinserttempdeclaration declare final declarefinal f declare final fdeclarefinal ast node astnode find deepest common super node path for replaced nodes finddeepestcommonsupernodepathforreplacednodes java model exception javamodelexception ast node astnode match nodes matchnodes get match nodes getmatchnodes ast node astnode matching nodes parents matchingnodesparents ast node astnode match nodes matchnodes length match nodes matchnodes length matching nodes parents matchingnodesparents get parents getparents match nodes matchnodes list ast node astnode arrays as list aslist get longest array prefix getlongestarrayprefix matching nodes parents matchingnodesparents to array toarray ast node astnode size ast node astnode get enclosing body node getenclosingbodynode java model exception javamodelexception ast node astnode node get selected expression getselectedexpression get associated node getassociatednode expression method lambda initializer body method parameter annotation structural property descriptor structuralpropertydescriptor location node node body declaration bodydeclaration location node get location in parent getlocationinparent node node get parent getparent node lambda expression lambdaexpression location method declaration methoddeclaration body property location initializer body property location lambda expression lambdaexpression body property lambda expression lambdaexpression node resolve method binding resolvemethodbinding ast node astnode node get structural property getstructuralproperty location string get excluded variable names getexcludedvariablenames f excluded variable names fexcludedvariablenames i binding ibinding bindings scope analyzer scopeanalyzer f compilation unit node fcompilationunitnode get declarations in scope getdeclarationsinscope get selected expression getselectedexpression get start position getstartposition scope analyzer scopeanalyzer variables scope analyzer scopeanalyzer check visibility f excluded variable names fexcludedvariablenames string bindings length bindings length f excluded variable names fexcludedvariablenames bindings get name getname java model exception javamodelexception f excluded variable names fexcludedvariablenames string f excluded variable names fexcludedvariablenames i expression fragment iexpressionfragment get first replaced expression getfirstreplacedexpression java model exception javamodelexception f replace all occurrences freplacealloccurrences get selected expression getselectedexpression iast fragment iastfragment nodes to replace nodestoreplace retain only replacable matches retainonlyreplacablematches get matching fragments getmatchingfragments nodes to replace nodestoreplace length get selected expression getselectedexpression comparator iast fragment iastfragment comparator comparator iast fragment iastfragment override compare iast fragment iastfragment iast fragment iastfragment get start position getstartposition get start position getstartposition arrays sort nodes to replace nodestoreplace comparator i expression fragment iexpressionfragment nodes to replace nodestoreplace iast fragment iastfragment get matching fragments getmatchingfragments java model exception javamodelexception f replace all occurrences freplacealloccurrences iast fragment iastfragment all matches allmatches ast fragment factory astfragmentfactory create fragment for full subtree createfragmentforfullsubtree get enclosing body node getenclosingbodynode get sub fragments matching getsubfragmentsmatching get selected expression getselectedexpression all matches allmatches iast fragment iastfragment get selected expression getselectedexpression ast node astnode get match nodes getmatchnodes java model exception javamodelexception iast fragment iastfragment matches retain only replacable matches retainonlyreplacablematches get matching fragments getmatchingfragments ast node astnode result ast node astnode matches length matches length result matches get associated node getassociatednode result override string get name getname refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring i expression fragment iexpressionfragment get selected expression getselectedexpression java model exception javamodelexception f selected expression fselectedexpression f selected expression fselectedexpression iast fragment iastfragment selected fragment selectedfragment ast fragment factory astfragmentfactory create fragment for source range createfragmentforsourcerange source range sourcerange f selection start fselectionstart f selection length fselectionlength f compilation unit node fcompilationunitnode f cu fcu selected fragment selectedfragment i expression fragment iexpressionfragment checks is inside javadoc isinsidejavadoc selected fragment selectedfragment get associated node getassociatednode f selected expression fselectedexpression i expression fragment iexpressionfragment selected fragment selectedfragment selected fragment selectedfragment selected fragment selectedfragment get associated node getassociatednode expression statement expressionstatement expression statement expressionstatement expr statement exprstatement expression statement expressionstatement selected fragment selectedfragment get associated node getassociatednode expression expression expr statement exprstatement get expression getexpression f selected expression fselectedexpression i expression fragment iexpressionfragment ast fragment factory astfragmentfactory create fragment for full subtree createfragmentforfullsubtree expression selected fragment selectedfragment get associated node getassociatednode assignment assignment assignment assignment selected fragment selectedfragment get associated node getassociatednode f selected expression fselectedexpression i expression fragment iexpressionfragment ast fragment factory astfragmentfactory create fragment for full subtree createfragmentforfullsubtree assignment f selected expression fselectedexpression checks is enum case isenumcase f selected expression fselectedexpression get associated expression getassociatedexpression get parent getparent f selected expression fselectedexpression f selected expression fselectedexpression type create temp type createtemptype core exception coreexception expression expression get selected expression getselectedexpression get associated expression getassociatedexpression type resulting type resultingtype i type binding itypebinding type binding typebinding expression resolve type binding resolvetypebinding ast rewrite astrewrite rewrite fcurewrite getastrewrite ast ast rewrite getast expression class instance creation classinstancecreation type binding typebinding type binding typebinding get type arguments gettypearguments length resulting type resultingtype type rewrite create copy target createcopytarget class instance creation classinstancecreation expression get type gettype expression cast expression castexpression resulting type resultingtype type rewrite create copy target createcopytarget cast expression castexpression expression get type gettype type binding typebinding type binding typebinding ast res olving astresolving guess binding for reference guessbindingforreference expression type binding typebinding type binding typebinding bindings normalize for declaration use normalizefordeclarationuse type binding typebinding ast import rewrite importrewrite import rewrite importrewrite fcurewrite get import rewrite getimportrewrite import rewrite context importrewritecontext context context sensitive import rewrite context contextsensitiveimportrewritecontext expression import rewrite importrewrite resulting type resultingtype import rewrite importrewrite add import addimport type binding typebinding ast context resulting type resultingtype nls ast new simple type newsimpletype nls ast new simple name newsimplename object f linked proposal model flinkedproposalmodel linked proposal position group linkedproposalpositiongroup type group typegroup f linked proposal model flinkedproposalmodel get position group getpositiongroup key type type group typegroup add position addposition rewrite track resulting type resultingtype type binding typebinding i type binding itypebinding rel axing types relaxingtypes ast res olving astresolving get narrowing types getnarrowingtypes ast type binding typebinding rel axing types relaxingtypes length type group typegroup add proposal addproposal rel axing types relaxingtypes fcurewrite get cu getcu rel axing types relaxingtypes length resulting type resultingtype string guess temp name guesstempname string proposals guess temp names guesstempnames proposals length f temp name ftempname proposals proposed variable names empty proposal guess exists string guess temp names guesstempnames f guessed temp names fguessedtempnames expression expression get selected expression getselectedexpression get associated expression getassociatedexpression expression i type binding itypebinding binding guess binding for reference guessbindingforreference expression f guessed temp names fguessedtempnames stub utility stubutility get variable name suggestions getvariablenamesuggestions naming conventions namingconventions local f cu fcu get java project getjavaproject binding expression arrays as list aslist get excluded variable names getexcludedvariablenames java model exception javamodelexception f guessed temp names fguessedtempnames f guessed temp names fguessedtempnames string f guessed temp names fguessedtempnames is literal node selected isliteralnodeselected java model exception javamodelexception i expression fragment iexpressionfragment fragment get selected expression getselectedexpression fragment expression expression fragment get associated expression getassociatedexpression expression expression get node type getnodetype ast node astnode literal ast node astnode character literal ast node astnode literal ast node astnode number literal is used in explicit constructor call isusedinexplicitconstructorcall java model exception javamodelexception expression selected expression selectedexpression get selected expression getselectedexpression get associated expression getassociatedexpression ast nodes astnodes get parent getparent selected expression selectedexpression constructor invocation constructorinvocation ast nodes astnodes get parent getparent selected expression selectedexpression super constructor invocation superconstructorinvocation replace all occurrences replacealloccurrences f replace all occurrences freplacealloccurrences replace selected expression with temp declaration replaceselectedexpressionwithtempdeclaration core exception coreexception ast rewrite astrewrite rewrite fcurewrite getastrewrite expression selected expression selected expression selectedexpression get selected expression getselectedexpression get associated expression getassociatedexpression expression initializer expression rewrite create move target createmovetarget selected expression selectedexpression variable declaration statement variabledeclarationstatement temp declaration tempdeclaration create temp declaration createtempdeclaration initializer ast node astnode replacement ast node astnode parent selected expression selectedexpression get parent getparent is parent lambda isparentlambda parent lambda expression lambdaexpression ast ast rewrite getast is parent lambda isparentlambda block block body blockbody ast new block newblock block body blockbody statements add temp declaration tempdeclaration bindings is void type isvoidtype lambda expression lambdaexpression parent resolve method binding resolvemethodbinding get return type getreturntype list variable declaration fragment variabledeclarationfragment fragments temp declaration tempdeclaration fragments simple name simplename var name varname fragments get name getname return statement returnstatement return statement returnstatement ast new return statement newreturnstatement return statement returnstatement set expression setexpression ast new simple name newsimplename var name varname get identifier getidentifier block body blockbody statements add return statement returnstatement replacement block body blockbody ast nodes astnodes is control statement body iscontrolstatementbody parent get location in parent getlocationinparent block block ast new block newblock block statements add temp declaration tempdeclaration replacement block replacement temp declaration tempdeclaration ast node astnode replace e replacee is parent lambda isparentlambda ast nodes astnodes has semicolon hassemicolon expression statement expressionstatement parent f cu fcu selected expression selectedexpression parent rewrite replace replace e replacee replacement fcurewrite create group description creategroupdescription refactoring core messages refactoringcoremessages extract temp refactoring extracttemprefactoring declare local variable set declare final setdeclarefinal declare final declarefinal f declare final fdeclarefinal declare final declarefinal set replace all occurrences setreplacealloccurrences replace all occurrences replacealloccurrences f replace all occurrences freplacealloccurrences replace all occurrences replacealloccurrences set temp name settempname string new name newname f temp name ftempname new name newname should replace selected expression with temp declaration shouldreplaceselectedexpressionwithtempdeclaration java model exception javamodelexception i expression fragment iexpressionfragment selected fragment selectedfragment get selected expression getselectedexpression i expression fragment iexpressionfragment first expression firstexpression get first replaced expression getfirstreplacedexpression first expression firstexpression get start position getstartposition selected fragment selectedfragment get start position getstartposition ast node astnode associated node associatednode selected fragment selectedfragment get associated node getassociatednode associated node associatednode get parent getparent expression statement expressionstatement associated node associatednode get parent getparent lambda expression lambdaexpression selected fragment selectedfragment matches ast fragment factory astfragmentfactory create fragment for full subtree createfragmentforfullsubtree associated node associatednode refactoring status refactoringstatus initialize java refactoring arguments javarefactoringarguments arguments string selection arguments get attribute getattribute java refactoring descriptor util javarefactoringdescriptorutil attribute selection selection offset length string tokenizer stringtokenizer tokenizer string tokenizer stringtokenizer selection tokenizer has more tokens hasmoretokens offset integer value of valueof tokenizer next token nexttoken int value intvalue tokenizer has more tokens hasmoretokens length integer value of valueof tokenizer next token nexttoken int value intvalue offset length f selection start fselectionstart offset f selection length fselectionlength length refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring illegal argument object selection java refactoring descriptor util javarefactoringdescriptorutil attribute selection refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring argument exist java refactoring descriptor util javarefactoringdescriptorutil attribute selection string handle arguments get attribute getattribute java refactoring descriptor util javarefactoringdescriptorutil attribute input handle i java element ijavaelement element java refactoring descriptor util javarefactoringdescriptorutil handle to element handletoelement arguments get project getproject handle element element exists element get element type getelementtype i java element ijavaelement compilation unit java refactoring descriptor util javarefactoringdescriptorutil create input fatal status createinputfatalstatus element get name getname i java refactorings ijavarefactorings extract local variable f cu fcu i compilation unit icompilationunit element refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring argument exist java refactoring descriptor util javarefactoringdescriptorutil attribute input string arguments get attribute getattribute java refactoring descriptor util javarefactoringdescriptorutil attribute nls equals f temp name ftempname refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring argument exist java refactoring descriptor util javarefactoringdescriptorutil attribute string replace arguments get attribute getattribute attribute replace replace f replace all occurrences freplacealloccurrences value of valueof replace boolean value booleanvalue refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring argument exist attribute replace string declare final declarefinal arguments get attribute getattribute attribute declare final declarefinal f declare final fdeclarefinal value of valueof declare final declarefinal boolean value booleanvalue refactoring status refactoringstatus create fatal error status createfatalerrorstatus messages format refactoring core messages refactoringcoremessages initializable refactoring initializablerefactoring argument exist attribute refactoring status refactoringstatus
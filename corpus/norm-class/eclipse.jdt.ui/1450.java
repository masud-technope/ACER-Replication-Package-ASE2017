copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal corext refactoring reorg java util array list arraylist java util iterator java util list java util map org eclipse core runtime org eclipse core runtime core exception coreexception org eclipse core resources i file ifile org eclipse core resources i project iproject org eclipse core resources i resource iresource org eclipse core resources i workspace root iworkspaceroot org eclipse core file buf fers filebuffers i text file buffer itextfilebuffer org eclipse text edits text edit textedit org eclipse ltk core refactoring change org eclipse ltk core refactoring composite change compositechange org eclipse ltk core refactoring null change nullchange org eclipse ltk core refactoring text change textchange org eclipse ltk core refactoring text file change textfilechange org eclipse ltk core refactoring resource delete resource change deleteresourcechange org eclipse jdt core i class file iclassfile org eclipse jdt core i compilation unit icompilationunit org eclipse jdt core i java element ijavaelement org eclipse jdt core i package fragment ipackagefragment org eclipse jdt core i package fragment root ipackagefragmentroot org eclipse jdt core i source manipulation isourcemanipulation org eclipse jdt core java model exception javamodelexception org eclipse jdt core dom compilation unit compilationunit org eclipse jdt core dom rewrite ast rewrite astrewrite org eclipse jdt internal corext refactoring checks org eclipse jdt internal corext refactoring refactoring core messages refactoringcoremessages org eclipse jdt internal corext refactoring classpath change classpathchange org eclipse jdt internal corext refactoring delete package fragment root change deletepackagefragmentrootchange org eclipse jdt internal corext refactoring delete source manipulation change deletesourcemanipulationchange org eclipse jdt internal corext refactoring dynamic validation state change dynamicvalidationstatechange org eclipse jdt internal corext refactoring text change compatibility textchangecompatibility org eclipse jdt internal corext refactoring undo able package delete change undoablepackagedeletechange org eclipse jdt internal corext refactoring structure compilation unit rewrite compilationunitrewrite org eclipse jdt internal corext refactoring util refactoringastparser org eclipse jdt internal corext refactoring util refactoring file buffers refactoringfilebuffers org eclipse jdt internal corext refactoring util text change manager textchangemanager delete change creator deletechangecreator delete change creator deletechangecreator param manager text change manager param resources resources delete param java elements javaelements java elements delete param change name changename change param package deletes packagedeletes list link i resource iresource deleted delete operation link i package fragment ipackagefragment code java elements javaelements code code code iff code java elements javaelements code fragments created change core exception coreexception change create delete change createdeletechange text change manager textchangemanager manager i resource iresource resources i java element ijavaelement java elements javaelements string change name changename list i resource iresource package deletes packagedeletes core exception coreexception problem deleting sub packages subpackages result multiple fragments f java elements fjavaelements folder package deletes packagedeletes handle undo change individual delete empty change add care undo undo able package delete change undoablepackagedeletechange dynamic validation state change dynamicvalidationstatechange result package deletes packagedeletes size result undo able package delete change undoablepackagedeletechange change name changename package deletes packagedeletes result dynamic validation state change dynamicvalidationstatechange change name changename java elements javaelements length i java element ijavaelement element java elements javaelements reorg utils reorgutils is inside compilation unit isinsidecompilationunit element result add create delete change createdeletechange element resources length result add create delete change createdeletechange resources map i compilation unit icompilationunit list i java element ijavaelement grouped reorg utils reorgutils group by compilation unit groupbycompilationunit get elements smaller than cu getelementssmallerthancu java elements javaelements grouped size is not null isnotnull manager iterator i compilation unit icompilationunit iter grouped key set keyset iterator iter has next hasnext i compilation unit icompilationunit iter result add create delete change createdeletechange grouped manager result change create delete change createdeletechange i resource iresource resource is true istrue resource i workspace root iworkspaceroot project deletion handled workbench is true istrue resource i project iproject delete resource change deleteresourcechange resource get full path getfullpath list i java element ijavaelement java elements javaelements change create delete change createdeletechange i compilation unit icompilationunit list i java element ijavaelement java elements javaelements text change manager textchangemanager manager core exception coreexception compilation unit compilationunit cu node cunode refactoringastparser parsewithastprovider compilation unit rewrite compilationunitrewrite rewriter compilation unit rewrite compilationunitrewrite cu node cunode i java element ijavaelement elements java elements javaelements to array toarray i java element ijavaelement java elements javaelements size ast node delete util astnodedeleteutil mark as deleted markasdeleted elements rewriter add text edit from rewrite addtexteditfromrewrite manager rewriter getastrewrite text change textchange add text edit from rewrite addtexteditfromrewrite text change manager textchangemanager manager i compilation unit icompilationunit ast rewrite astrewrite rewrite core exception coreexception i text file buffer itextfilebuffer buffer refactoring file buffers refactoringfilebuffers acquire text edit textedit resulting edits resultingedits rewrite rewriteast buffer get document getdocument get java project getjavaproject get options getoptions text change textchange text change textchange manager text change textchange text file change textfilechange text file change textfilechange tfc text file change textfilechange text change textchange tfc set save mode setsavemode text file change textfilechange save string message refactoring core messages refactoringcoremessages delete change creator deletechangecreator text change compatibility textchangecompatibility add text edit addtextedit text change textchange message resulting edits resultingedits text change textchange refactoring file buffers refactoringfilebuffers release list i java element ijavaelement list i java element ijavaelement get elements smaller than cu getelementssmallerthancu i java element ijavaelement java elements javaelements list i java element ijavaelement result array list arraylist java elements javaelements length i java element ijavaelement element java elements javaelements reorg utils reorgutils is inside compilation unit isinsidecompilationunit element result add element result change create delete change createdeletechange i java element ijavaelement java element javaelement java model exception javamodelexception is true istrue reorg utils reorgutils is inside compilation unit isinsidecompilationunit java element javaelement java element javaelement get element type getelementtype i java element ijavaelement fragment root create package fragment root delete change createpackagefragmentrootdeletechange i package fragment root ipackagefragmentroot java element javaelement i java element ijavaelement fragment create source manipulation delete change createsourcemanipulationdeletechange i package fragment ipackagefragment java element javaelement i java element ijavaelement compilation unit create source manipulation delete change createsourcemanipulationdeletechange i compilation unit icompilationunit java element javaelement i java element ijavaelement file fails precondition missing is true istrue i class file iclassfile java element javaelement get resource getresource i file ifile create delete change createdeletechange i class file iclassfile java element javaelement get resource getresource i java element ijavaelement java model is true istrue handled differently i java element ijavaelement java project is true istrue i java element ijavaelement type i java element ijavaelement field i java element ijavaelement method i java element ijavaelement initializer i java element ijavaelement declaration i java element ijavaelement container i java element ijavaelement declaration is true istrue null change nullchange kinds is true istrue null change nullchange change create source manipulation delete change createsourcemanipulationdeletechange i source manipulation isourcemanipulation element xxx work around workaround bug linked i source manipulation isourcemanipulation delete resource element i compilation unit icompilationunit element i package fragment ipackagefragment i resource iresource resource element i compilation unit icompilationunit resource reorg utils reorgutils get resource getresource i compilation unit icompilationunit element resource i package fragment ipackagefragment element get resource getresource resource resource is linked islinked create delete change createdeletechange resource delete source manipulation change deletesourcemanipulationchange element change create package fragment root delete change createpackagefragmentrootdeletechange i package fragment root ipackagefragmentroot root java model exception javamodelexception i resource iresource resource root get resource getresource resource resource is linked islinked xxx code work around workaround jcore bug jcore handle linked stuff create delete package fragment root change deletepackagefragmentrootchange composite change compositechange composite dynamic validation state change dynamicvalidationstatechange refactoring core messages refactoringcoremessages delete refactoring deleterefactoring delete fragment root classpath change classpathchange change classpath change classpathchange remove entry change removeentrychange root get java project getjavaproject root get raw classpath entry getrawclasspathentry change composite add change checked preconditions is true istrue checks is classpath delete isclasspathdelete root composite add create delete change createdeletechange resource composite is true istrue root is external isexternal todo remove query argument delete package fragment root change deletepackagefragmentrootchange root
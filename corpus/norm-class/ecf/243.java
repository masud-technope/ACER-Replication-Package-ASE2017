rcs file rcsfile revision copyright jive software rights reserved licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org jivesoftware smack javax net ssl trust manager trustmanager java file input stream fileinputstream java input stream inputstream java io exception ioexception java security java security cert certificate exception certificateexception java security cert certificate parsing exception certificateparsingexception java security cert certificate java util java util regex matcher java util regex pattern trust manager checks certificates presented server tls negotiation disable enable checkin gs checkings config uri ng configuring link connection configuration connectionconfiguration truststore file trusted root certificates configure link connection configuration connectionconfiguration author gaston dom biak dombiak server trust manager servertrustmanager trust manager trustmanager pattern cn pattern cnpattern pattern compile connection configuration connectionconfiguration configuration h olds holds domain remote server connect string server key store keystore trust store truststore map key store options keystoreoptions key store keystore stores hash map hashmap key store options keystoreoptions key store keystore server trust manager servertrustmanager string server connection configuration connectionconfiguration configuration configuration configuration server server input stream inputstream stores key store options keystoreoptions options key store options keystoreoptions configuration get truststore type gettruststoretype configuration get truststore path gettruststorepath configuration get truststore password gettruststorepassword stores contains key containskey options trust store truststore stores options trust store truststore key store keystore get instance getinstance options get type gettype file input stream fileinputstream options get path getpath trust store truststore load options get password getpassword to char array tochararray exception trust store truststore print stack trace printstacktrace close io exception ioexception ioe stores options trust store truststore trust store truststore disable root checking configuration set verify root enabled setverifyrootcaenabled certificate get acc epted issue rs getacceptedissuers certificate check client trusted checkclienttrusted certificate arg string arg certificate exception certificateexception check server trusted checkservertrusted certificate certificates string arg certificate exception certificateexception n size nsize certificates length list string peer identities peeridentities get peer identity getpeeridentity certificates configuration is verify chain enabled isverifychainenabled working chain certificate chain verify subject certificate issue r issuer certificate chain principal principal last principallast n size nsize certificate certificate certificates principal principal issuer principalissuer certificate get issuer n getissuerdn principal principal subject principalsubject certificate get subject n getsubjectdn principal last principallast principal issuer principalissuer equals principal last principallast public key publickey public key publickey certificates get public key getpublickey certificates verify public key publickey general security exception generalsecurityexception general security exception generalsecurityexception certificate exception certificateexception signature verification failed peer identities peeridentities certificate exception certificateexception subject issue r issuer verification failed peer identities peeridentities principal last principallast principal subject principalsubject configuration is verify root enabled isverifyrootcaenabled verify certificate chain issued party client trusts trusted trusted trust store truststore get certificate alias getcertificatealias certificates n size nsize trusted n size nsize configuration is self signed certificate enabled isselfsignedcertificateenabled system println acc epting accepting sig ned signed certificate remote server peer identities peeridentities trusted key store exception keystoreexception print stack trace printstacktrace trusted certificate exception certificateexception root certificate trusted peer identities peeridentities configuration is not matching domain check enabled isnotmatchingdomaincheckenabled check certificate wildcard indicating sub dom ains subdomains valid peer identities peeridentities size peer identities peeridentities starts with startswith remove wildcard string peer identity peeridentity peer identities peeridentities replace check requested sub domain subdomain matches cert ified certified domain server ends with endswith peer identity peeridentity certificate exception certificateexception target verification failed peer identities peeridentities peer identities peeridentities server certificate exception certificateexception target verification failed peer identities peeridentities configuration is expired certificates check enabled isexpiredcertificatescheckenabled certificate chain verify certificate valid current time n size nsize certificates check val idity checkvalidity general security exception generalsecurityexception general security exception generalsecurityexception certificate exception certificateexception invalid server returns identity remote server defined certificate identity defined subjectdn certificate defined subject alt name subjectaltname extension type xmpp extension identity defined extension returned stored subjectdn returned param certificate certificate holds identity remote server identity remote server defined certificate list string get peer identity getpeeridentity certificate certificate identity subject alt name subjectaltname extension list string names get subject alternative names getsubjectalternativenames certificate names is empty isempty string certificate get subject n getsubjectdn get name getname matcher matcher cn pattern cnpattern matcher matcher find matcher group create array unique identity names array list arraylist string names add names returns jid representation xmpp entity contained subject alt name subjectaltname extension certificate param certificate certificate presented remote entity jid representation xmpp entity contained subject alt name subjectaltname extension certificate list string get subject alternative names getsubjectalternativenames certificate certificate list string ide ntities identities array list arraylist string collection list alt names altnames certificate get subject alternative names getsubjectalternativenames check certificate includes subject alt name subjectaltname extension alt names altnames collections empty list emptylist type other name othername search cert ified certified server list item alt names altnames integer type integer item type type other name othername encoded asn decode server identity asn input stream inputstream decoder asn input stream inputstream item to array toarray dere n cod able derencodable encoded decoder read object readobject encoded der sequence dersequence encoded get object at getobjectat encoded der tag ged object dertaggedobject encoded get object getobject encoded der tag ged object dertaggedobject encoded get object getobject string identity derutf string encoded get string getstring add decoded server list ide ntities identities ide ntities identities add identity unsupported encoding exception unsupportedencodingexception ignore io exception ioexception ignore exception print stack trace printstacktrace types good xmpp ignore system println subject alt name subjectaltname invalid type certificate certificate parsing exception certificateparsingexception print stack trace printstacktrace ide ntities identities key store options keystoreoptions string type string path string password key store options keystoreoptions string type string path string password type type path path password password string get type gettype type string get path getpath path string get password getpassword password override hash code hashcode prime result result prime result password password hash code hashcode result prime result path path hash code hashcode result prime result type type hash code hashcode result override equals object obj obj obj get class getclass obj get class getclass key store options keystoreoptions key store options keystoreoptions obj password password password equals password path path path equals path type type type equals type
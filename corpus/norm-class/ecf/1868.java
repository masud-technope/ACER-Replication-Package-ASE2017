rcs file rcsfile revision thu mar copyright jive software rights reserved licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org jivesoftware smack org jivesoftware smack filter packet filter packetfilter org jivesoftware smack filter packetidfilter org jivesoftware smack filter packet type filter packettypefilter org jivesoftware smack packet org jivesoftware smack packet packet org jivesoftware smack packet presence org jivesoftware smack packet roster packet rosterpacket org jivesoftware smack util string utils stringutils java util java util concurrent concurrent hash map concurrenthashmap java util concurrent copy on write array list copyonwritearraylist represents user roster collection users per son person receives presence updates roster items cat egorized categorized groups easier management users attempt sub scr ibe subscribe user subscription request modes supported handling requests link subscription mode subscriptionmode accept accept accept subscription requests link subscription mode subscriptionmode reject reject reject subscription requests link subscription mode subscriptionmode manual manual manually process subscription requests author matt tucker connection get roster getroster roster subscription processing mode roster created subscription requests automatically accepted subscription mode subscriptionmode default subscription mode defaultsubscriptionmode subscription mode subscriptionmode accept connection connection map string roster group rostergroup groups map string roster entry rosterentry entries list roster entry rosterentry unfiled entries unfiledentries list roster listener rosterlistener roster listeners rosterlisteners map string map string presence presence map presencemap roster marked initialized single roster packet received processed roster initialized rosterinitialized presence packet listener presencepacketlistener presence packet listener presencepacketlistener subscription mode subscriptionmode subscription mode subscriptionmode get default subscription mode getdefaultsubscriptionmode returns subscription processing mode roster created subscription processing mode dictates action smack subscription requests users subscription mode link subscription mode subscriptionmode accept subscription mode rosters subscription mode subscriptionmode get default subscription mode getdefaultsubscriptionmode default subscription mode defaultsubscriptionmode sets subscription processing mode roster created subscription processing mode dictates action smack subscription requests users subscription mode link subscription mode subscriptionmode accept param subscription mode subscriptionmode subscription mode rosters set default subscription mode setdefaultsubscriptionmode subscription mode subscriptionmode subscription mode subscriptionmode default subscription mode defaultsubscriptionmode subscription mode subscriptionmode creates roster param connection xmpp connection roster connection connection connection connection groups concurrent hash map concurrenthashmap string roster group rostergroup unfiled entries unfiledentries copy on write array list copyonwritearraylist roster entry rosterentry entries concurrent hash map concurrenthashmap string roster entry rosterentry roster listeners rosterlisteners copy on write array list copyonwritearraylist roster listener rosterlistener presence map presencemap concurrent hash map concurrenthashmap string map string presence listen roster pack ets packets packet filter packetfilter roster filter rosterfilter packet type filter packettypefilter roster packet rosterpacket connection add packet listener addpacketlistener roster packet listener rosterpacketlistener roster filter rosterfilter listen presence pack ets packets packet filter packetfilter presence filter presencefilter packet type filter packettypefilter presence presence packet listener presencepacketlistener presence packet listener presencepacketlistener connection add packet listener addpacketlistener presence packet listener presencepacketlistener presence filter presencefilter listen connection events connection listener connectionlistener connection listener connectionlistener abstract connection listener abstractconnectionlistener connection closed connectionclosed presence contacts unavailable set off line presences setofflinepresences connection closed on error connectionclosedonerror exception presence contacts unavailable set off line presences setofflinepresences connected add listener successful login connection is connected isconnected connection add connection creation listener addconnectioncreationlistener connection creation listener connectioncreationlistener connection created connectioncreated connection connection connection equals roster connection roster connection add connection listener addconnectionlistener connection listener connectionlistener connection add connection listener addconnectionlistener connection listener connectionlistener returns subscription processing mode dictates action smack subscription requests users subscription mode link subscription mode subscriptionmode accept manual mode packet listener packetlistener registered list ens listens presence pack ets packets type link org jivesoftware smack packet presence type sub scr ibe subscribe subscription mode subscription mode subscriptionmode get subscription mode getsubscriptionmode subscription mode subscriptionmode sets subscription processing mode dictates action smack subscription requests users subscription mode link subscription mode subscriptionmode accept manual mode packet listener packetlistener registered list ens listens presence pack ets packets type link org jivesoftware smack packet presence type sub scr ibe subscribe param subscription mode subscriptionmode subscription mode set subscription mode setsubscriptionmode subscription mode subscriptionmode subscription mode subscriptionmode subscription mode subscriptionmode subscription mode subscriptionmode reloads entire roster server asynchronous operation method roster reloaded point server resp onds responds reload request illegal state exception illegalstateexception connection logged logged anonymously reload connection is authenticated isauthenticated illegal state exception illegalstateexception logged server connection is anonymous isanonymous illegal state exception illegalstateexception anonymous users roster connection send packet sendpacket roster packet rosterpacket adds listener roster listener fired any time anytime roster pushed server param roster listener rosterlistener roster listener add roster listener addrosterlistener roster listener rosterlistener roster listener rosterlistener roster listeners rosterlisteners roster listener rosterlistener roster listeners rosterlisteners add roster listener rosterlistener removes listener roster listener fired any time anytime roster pushed server param roster listener rosterlistener roster listener remove roster listener removerosterlistener roster listener rosterlistener roster listener rosterlistener roster listeners rosterlisteners remove roster listener rosterlistener creates group note add entry group group log out logout login xmpp stores group param group group illegal state exception illegalstateexception connection logged logged anonymously roster group rostergroup create group creategroup string connection is authenticated isauthenticated illegal state exception illegalstateexception logged server connection is anonymous isanonymous illegal state exception illegalstateexception anonymous users roster groups contains key containskey illegal argument exception illegalargumentexception group alread exists roster group rostergroup group roster group rostergroup connection groups group group creates roster entry presence subscription server asynchronously update roster subscription status param user user johndoe jabber org param nickname user param groups list group names entry belong roster entry won belong group xmpp exception xmppexception xmpp exception occurs illegal state exception illegalstateexception connection logged logged anonymously create entry createentry string user string string groups xmpp exception xmppexception connection is authenticated isauthenticated illegal state exception illegalstateexception logged server connection is anonymous isanonymous illegal state exception illegalstateexception anonymous users roster create send roster entry creation packet roster packet rosterpacket roster packet rosterpacket roster packet rosterpacket roster packet rosterpacket set type settype type roster packet rosterpacket item item roster packet rosterpacket item user groups string group groups group group trim length item add group name addgroupname group roster packet rosterpacket add roster item addrosteritem item wait number seconds reply server packet collector packetcollector collector connection create packet collector createpacketcollector packetidfilter roster packet rosterpacket get packet d getpacketid connection send packet sendpacket roster packet rosterpacket response collector next result nextresult smack configuration smackconfiguration get packet reply timeout getpacketreplytimeout collector cancel response xmpp exception xmppexception response server server rep lied replied error exception response get type gettype type error xmpp exception xmppexception response get error geterror create presence subscription packet send presence presence packet presencepacket presence presence type sub scr ibe subscribe presence packet presencepacket set to setto user connection send packet sendpacket presence packet presencepacket removes roster entry roster roster entry removed unfiled entries roster group belong longer roster note asynchronous call smack wait server send updated subscription status param entry roster entry xmpp exception xmppexception xmpp error occurs illegal state exception illegalstateexception connection logged logged anonymously remove entry removeentry roster entry rosterentry entry xmpp exception xmppexception connection is authenticated isauthenticated illegal state exception illegalstateexception logged server connection is anonymous isanonymous illegal state exception illegalstateexception anonymous users roster actual removal logic takes place roster packet listener process rosterpacketlistenerprocess packet packet entries contains key containskey entry get user getuser roster packet rosterpacket packet roster packet rosterpacket packet set type settype type roster packet rosterpacket item item roster entry rosterentry to roster item torosteritem entry item type remove server delete entry item set item type setitemtype roster packet rosterpacket item type itemtype remove packet add roster item addrosteritem item packet collector packetcollector collector connection create packet collector createpacketcollector packetidfilter packet get packet d getpacketid connection send packet sendpacket packet response collector next result nextresult smack configuration smackconfiguration get packet reply timeout getpacketreplytimeout collector cancel response xmpp exception xmppexception response server server rep lied replied error exception response get type gettype type error xmpp exception xmppexception response get error geterror returns count entries roster number entries roster get entry count getentrycount get entries getentries size returns unmodifiable collection entries roster including entries don belong groups entries roster collection roster entry rosterentry get entries getentries roster entry rosterentry all entries allentries hash set hashset roster entry rosterentry loop roster groups add entries answer roster group rostergroup roster group rostergroup get groups getgroups all entries allentries add all addall roster group rostergroup get entries getentries add roster unfiled entries answer all entries allentries add all addall unfiled entries unfiledentries collections unmodifiable collection unmodifiablecollection all entries allentries returns count unfiled entries roster unfiled entry entry doesn belong groups number unfiled entries roster get unfiled entry count getunfiledentrycount unfiled entries unfiledentries size returns unmodifiable collection unfiled roster entries unfiled entry entry doesn belong groups unfiled roster entries collection roster entry rosterentry get unfiled entries getunfiledentries collections unmodifiable list unmodifiablelist unfiled entries unfiledentries returns roster entry xmpp address user entry roster param user xmpp address user jsmith address valid format domain resource user domain user domain resource roster entry exist roster entry rosterentry get entry getentry string user user entries user to lower case tolowercase returns xmpp address entry roster param user xmpp address user jsmith address valid format domain resource user domain user domain resource xmpp address entry roster string user get entry getentry user returns roster group group doesn exist param group roster group roster group rostergroup get group getgroup string groups returns number groups roster number groups roster get group count getgroupcount groups size returns unmodifiable collections roster groups iterator roster groups collection roster group rostergroup get groups getgroups collections unmodifiable collection unmodifiablecollection groups values returns presence info user user offline presence data sub scr ibed subscribed user presence updates unavailable presence returned user presences resource presence highest priority returned multiple presences priority presence mode returned order link org jivesoftware smack packet presence mode chat free chat link org jivesoftware smack packet presence mode link org jivesoftware smack packet presence mode link org jivesoftware smack packet presence mode extended link org jivesoftware smack packet presence mode dnd disturb note presence received asynchronously logging server presence values users roster unavailable online returned method treated snapshot time accurately reflect user presence ins tant instant ins tant instant track presence time showing visual representation roster link roster listener rosterlistener param user xmpp address valid format domain resource user domain user domain resource resource discarded user current presence unavailable presence user offline presence presence get presence getpresence string user string key get presence map key getpresencemapkey string utils stringutils parse bar e address parsebareaddress user map string presence user presences userpresences presence map presencemap key user presences userpresences presence presence presence presence type unavailable presence set from setfrom user presence find resource highest priority changed resource highest availability presence presence string resource user presences userpresences key set keyset presence user presences userpresences resource is available isavailable chose presence highest priority presence get priority getpriority presence get priority getpriority presence equal priority choose mode get priority getpriority presence get priority getpriority presence mode p mode pmode get mode getmode presence mode p mode pmode p mode pmode presence mode presence mode presence mode presencemode presence get mode getmode presence mode presence mode presencemode presence mode presencemode presence mode p mode pmode compare to compareto presence mode presencemode presence presence presence presence presence type unavailable presence set from setfrom user presence presence returns presence info user resource unavailable presence user offline presence sub scr ibed subscribed user presence updates param user with resource userwithresource fully qualified xmpp including resource user domain resource user current presence unavailable presence user offline presence presence get presence resource getpresenceresource string user with resource userwithresource string key get presence map key getpresencemapkey user with resource userwithresource string resource string utils stringutils parse resource parseresource user with resource userwithresource map string presence user presences userpresences presence map presencemap key user presences userpresences presence presence presence presence type unavailable presence set from setfrom user with resource userwithresource presence presence presence user presences userpresences resource presence presence presence presence type unavailable presence set from setfrom user with resource userwithresource presence presence returns iterator presence objects user current presences unavailable presence user unavailable offline presence sub scr ibed subscribed user presence updates param user xmpp jdoe iterator presence objects user current presences unavailable presence user offline presence iterator presence get presences getpresences string user string key get presence map key getpresencemapkey user map string presence user presences userpresences presence map presencemap key user presences userpresences presence presence presence presence type unavailable presence set from setfrom user arrays as list aslist presence iterator collection presence answer array list arraylist presence presence presence user presences userpresences values presence is available isavailable answer add presence answer is empty isempty answer iterator presence presence presence presence type unavailable presence set from setfrom user arrays as list aslist presence iterator cleans resources roster cleanup roster listeners rosterlisteners clear returns key presence map presencemap fully qualified xmpp roster valid address format domain resource user domain user domain resource roster entry fully qualified xmpp fully qualified xmpp key presence map presencemap bar e bare address note key presence map presencemap fully qualified xmpp user presences userpresences use less useless entry user param user bar e bare fully qualified xmpp jdoe jdoe work key presence map presencemap fully qualified xmpp string get presence map key getpresencemapkey string user user string key user user key string utils stringutils parse bar e address parsebareaddress user key to lower case tolowercase presence contacts offline simulating unavailable presence server disconnect ion disconnection presence offline set off line presences setofflinepresences presence packet unavailable packetunavailable string user presence map presencemap key set keyset map string presence resources presence map presencemap user resources string resource resources key set keyset packet unavailable packetunavailable presence presence type unavailable packet unavailable packetunavailable set from setfrom user resource presence packet listener presencepacketlistener process packet processpacket packet unavailable packetunavailable fires roster changed event roster listeners indicating collections contacts updated deleted roster param added entries addedentries collection address contacts param updated entries updatedentries collection address updated contacts param deleted entries deletedentries collection address deleted contacts fire roster changed event firerosterchangedevent collection string added entries addedentries collection string updated entries updatedentries collection string deleted entries deletedentries roster listener rosterlistener listener roster listeners rosterlisteners added entries addedentries is empty isempty listener entries added entriesadded added entries addedentries updated entries updatedentries is empty isempty listener entries updated entriesupdated updated entries updatedentries deleted entries deletedentries is empty isempty listener entries deleted entriesdeleted deleted entries deletedentries fires roster presence changed event roster listeners param presence presence change fire roster presence event firerosterpresenceevent presence presence roster listener rosterlistener listener roster listeners rosterlisteners listener presence changed presencechanged presence enumeration subscription mode options enum subscription mode subscriptionmode auto matically automatically accept subscription unsubscription requests mode suitable simple client complex client handle subscription requests manually accept auto matically automatically reject subscription requests reject subscription requests manually processed registering listener presence pack ets packets presence requests type presence type sub scr ibe subscribe presence type unsubscribe manual list ens listens presence pack ets packets processes presence packet listener presencepacketlistener packet listener packetlistener process packet processpacket packet packet presence presence presence packet string presence get from getfrom string key get presence map key getpresencemapkey pack ets packets saved resource presence get type gettype presence type map string presence user presences userpresences user presence map presence map presencemap key user presences userpresences concurrent hash map concurrenthashmap string presence presence map presencemap key user presences userpresences user presences userpresences presence map presencemap key offline presence stored map remove online presence user presences userpresences remove add presence resources key user presences userpresences string utils stringutils parse resource parseresource presence user roster fire event roster entry rosterentry entry entries key entry fire roster presence event firerosterpresenceevent presence unavailable packet presence get type gettype presence type unavailable roster presence flood store equals string utils stringutils parse resource parseresource map string presence user presences userpresences user presence map presence map presencemap key user presences userpresences concurrent hash map concurrenthashmap string presence presence map presencemap key user presences userpresences user presences userpresences presence map presencemap key user presences userpresences presence normal offline presence presence map presencemap key map string presence user presences userpresences presence map presencemap key store offline presence include extra user vacation user presences userpresences string utils stringutils parse resource parseresource presence user roster fire event roster entry rosterentry entry entries key entry fire roster presence event firerosterpresenceevent presence presence get type gettype presence type sub scr ibe subscribe subscription mode subscriptionmode subscription mode subscriptionmode accept accept subscription requests presence response presence presence type sub scr ibed subscribed response set to setto presence get from getfrom connection send packet sendpacket response subscription mode subscriptionmode subscription mode subscriptionmode reject reject subscription requests presence response presence presence type unsubscribed response set to setto presence get from getfrom connection send packet sendpacket response manual mode ignore presence get type gettype presence type unsubscribe subscription mode subscriptionmode subscription mode subscriptionmode manual acknowledge accept unsubscription not ification notification server sending not ifications notifications contact unsubscribed presence presence response presence presence type unsubscribed response set to setto presence get from getfrom connection send packet sendpacket response manual mode ignore presence info user presence get type gettype presence type error equals string utils stringutils parse resource parseresource map string presence user presences userpresences presence map presencemap contains key containskey key user presences userpresences concurrent hash map concurrenthashmap string presence presence map presencemap key user presences userpresences user presences userpresences presence map presencemap key presence data invalid ated invalidated error packet user presences userpresences clear presence empty resource key user presences userpresences presence user roster fire event roster entry rosterentry entry entries key entry fire roster presence event firerosterpresenceevent presence list ens listens roster pack ets packets processes roster packet listener rosterpacketlistener packet listener packetlistener process packet processpacket packet packet registry entries deleted updated event fired entry collection string added entries addedentries array list arraylist string collection string updated entries updatedentries array list arraylist string collection string deleted entries deletedentries array list arraylist string roster packet rosterpacket roster packet rosterpacket roster packet rosterpacket packet roster packet rosterpacket item item roster packet rosterpacket get roster items getrosteritems roster entry rosterentry entry roster entry rosterentry item get user getuser item get name getname item get item type getitemtype item get item status getitemstatus roster connection packet type remove remove entry roster packet rosterpacket item type itemtype remove equals item get item type getitemtype remove entry entry list entries contains key containskey item get user getuser entries remove item get user getuser remove entry unfiled entry list unfiled entries unfiledentries entry unfiled entries unfiledentries remove entry removing user roster remove presence string key string utils stringutils parse name parsename item get user getuser string utils stringutils parse server parseserver item get user getuser presence map presencemap remove key not e note entry removed deleted entries deletedentries add item get user getuser entry entry list entries contains key containskey item get user getuser entries item get user getuser entry not e note entry added entries addedentries add item get user getuser entry list update values roster entry rosterentry old entry oldentry entries item get user getuser entry roster packet rosterpacket item old item olditem roster entry rosterentry to roster item torosteritem old entry oldentry check group names changed item old entry oldentry old entry oldentry equals deep equalsdeep entry item get group names getgroupnames equals old item olditem get group names getgroupnames updated entries updatedentries add item get user getuser list unfiled entries item get group names getgroupnames is empty isempty unfiled entries unfiledentries remove entry add list unfiled entries unfiled entries unfiledentries entry unfiled entries unfiledentries add entry find list groups user belongs list string current group names currentgroupnames array list arraylist string roster group rostergroup group get groups getgroups group entry current group names currentgroupnames add group get name getname packet type remove add entry groups roster packet rosterpacket item type itemtype remove equals item get item type getitemtype create list groups user belongs list string new group names newgroupnames array list arraylist string string group name groupname item get group names getgroupnames add group list new group names newgroupnames add group name groupname add entry group roster group rostergroup group get group getgroup group name groupname group group create group creategroup group name groupname groups group name groupname group add entry group add entry local addentrylocal entry sub tra cting subtracting group string new group name newgroupname new group names newgroupnames current group names currentgroupnames remove new group name newgroupname remote entry removals string group name groupname current group names currentgroupnames roster group rostergroup group get group getgroup group name groupname group remove entry local removeentrylocal entry group get entry count getentrycount groups remove group name groupname todo check performance logic rosters large number groups roster group rostergroup group get groups getgroups group get entry count getentrycount groups remove group get name getname mark roster initialized roster roster initialized rosterinitialized roster notify all notifyall fire event roster listeners fire roster changed event firerosterchangedevent added entries addedentries updated entries updatedentries deleted entries deletedentries
rights reserved licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org jivesoftware smackx bytes treams bytestreams socks java data input stream datainputstream java io exception ioexception org jivesoftware smack xmpp exception xmppexception org jivesoftware smack util string utils stringutils collection utility methods s o c s socks messages author henning s tai b staib socks utils returns sha digest parameters href http xmpp org extensions xep html impl socks xep param sessionid socks bytes tream bytestream param initiatorjid jid init iator initiator socks bytes tream bytestream param targetjid jid target socks bytes tream bytestream sha digest parameters string create digest createdigest string sessionid string initiatorjid string targetjid string builder stringbuilder string builder stringbuilder append sessionid append initiatorjid append targetjid string utils stringutils hash to string tostring reads socks message input stream inputstream message socks request message socks response message href http tools ietf org html rfc rfc param data input stream datainputstream read message socks message io exception ioexception net work network error occurred xmpp exception xmppexception socks message unsupported address type receive socks receivesocks message data input stream datainputstream io exception ioexception xmpp exception xmppexception header read fully readfully header header xmpp exception xmppexception unsupported socks address type address length addresslength header response address length addresslength system arraycopy header response header length read fully readfully response header length address length addresslength response
copyright jan rellermeyer rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors jan rellermeyer initial api implementation org eclipse ecf internal provider osgi ethz iks osgi java i o exception ioexception java util org eclipse core runtime org eclipse core runtime i progress monitor iprogressmonitor org eclipse ecf core org eclipse ecf core events org eclipse ecf core identity org eclipse ecf core security i connect context iconnectcontext org eclipse ecf provider osgi identity org eclipse ecf remoteservice org eclipse ecf remoteservice events i remote service registered event iremoteserviceregisteredevent org eclipse ecf remoteservice events i remote service unregistered event iremoteserviceunregisteredevent org eclipse equinox concurrent org osgi framework org osgi framework constants org osgi util tracker service tracker servicetracker org osgi util tracker service tracker customizer servicetrackercustomizer os gi osgi remote service container adapter adapter container author jan rellermeyer eth z uric h zurich os gi remote service container osgiremoteservicecontainer i os gi remote service container adapter iosgiremoteservicecontaineradapter i remote service container adapter iremoteservicecontaineradapter i container icontainer remote service listener remoteservicelistener bundle context bundle context bundlecontext context os gi osgi remote service instance remoteosgiservice remote service remoteservice list subs c ribed subscribed container listeners list container listeners containerlisteners array list arraylist container os gi d osgiid containerid remote peer container connected connected os gi d osgiid connectedid tracks lifecycle remote services service tracker servicetracker remote services tracker remoteservicestracker service reference service registration map remote services regs remoteservicesregs hash map hashmap map remote service listeners maps listener service registration internal os gi osgi remote service listener service map remote service listeners remoteservicelisteners hash map hashmap connect context connect calls i connect context iconnectcontext connect context connectcontext os gi remote service container osgiremoteservicecontainer remoteosgiservice service containerid i d create exception idcreateexception is not null isnotnull service is not null isnotnull containerid context activator get default getdefault get context getcontext remote service remoteservice service containerid stringid containerid create r creater os gi d osgiid stringid containerid get name getname containerid os gi d osgiid containerid os gi d osgiid containerid nls i d create exception idcreateexception incompatible containerid start reg tracker startregtracker start reg tracker startregtracker nls nls nls string filter org eclipse ecf remoteservice constants service container containerid remote services tracker remoteservicestracker service tracker servicetracker context context create filter createfilter filter service tracker customizer servicetrackercustomizer object adding service addingservice service reference servicereference reference reference modified service modifiedservice service reference servicereference reference object service service modified removed service removedservice service reference servicereference reference object service service removed remote services tracker remoteservicestracker open invalid syntax exception invalidsyntaxexception print stack trace printstacktrace add remote service listener method accepts ecf remote service listener registers os gi osgi listener service adapter param listener ecf remote service listener org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter add remote service listener addremoteservicelistener org eclipse ecf remoteservice i remote service listener iremoteservicelistener add remote service listener addremoteservicelistener i remote service listener iremoteservicelistener listener is not null isnotnull listener remote service listener remoteservicelistener remote service listener remoteservicelistener remote service event remoteserviceevent remote service event remoteserviceevent event event get type gettype remote service event remoteserviceevent registered listener handle service event handleserviceevent i remote service registered event iremoteserviceregisteredevent i remote service reference iremoteservicereference reference remote service reference impl remoteservicereferenceimpl create remote service d createremoteserviceid event get remote reference getremotereference event get remote reference getremotereference string get clazzes getclazzes event get remote reference getremotereference get service interfaces getserviceinterfaces get container d getcontainerid get reference getreference get container d getcontainerid i remote service reference iremoteservicereference get reference getreference reference string to string tostring nls nls remote service registered event remoteserviceregisteredevent containerid nls nls get reference getreference get local container d getlocalcontainerid getid remote service event remoteserviceevent unregistering listener handle service event handleserviceevent i remote service unregistered event iremoteserviceunregisteredevent i remote service reference iremoteservicereference reference remote service reference impl remoteservicereferenceimpl create remote service d createremoteserviceid event get remote reference getremotereference event get remote reference getremotereference string get clazzes getclazzes event get remote reference getremotereference get service interfaces getserviceinterfaces get container d getcontainerid containerid i remote service reference iremoteservicereference get reference getreference reference string to string tostring nls nls remote service unregistered event remoteserviceunregisteredevent containerid nls nls get reference getreference get local container d getlocalcontainerid getid register listener service whiteboard pattern service registration serviceregistration reg context register service registerservice remote service listener remoteservicelistener get name getname track listener removed requested remote service listeners remoteservicelisteners listener reg remote service remote service reference param reference remote service reference i remote service iremoteservice object enc apsulating encapsulating service proxy additional methods asynchronous access methods org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter get remote service getremoteservice org eclipse ecf remoteservice i remote service reference iremoteservicereference i remote service iremoteservice get remote service getremoteservice i remote service reference iremoteservicereference reference is not null isnotnull reference reference remote service reference impl remoteservicereferenceimpl remote service reference impl remoteservicereferenceimpl impl remote service reference impl remoteservicereferenceimpl reference object remote service remoteservice get remote service getremoteservice impl get r getr os gi service reference osgiservicereference remote service impl remoteserviceimpl rs impl rsimpl remote service impl remoteserviceimpl impl ref to impl map reftoimplmap list remote service impl list remoteserviceimpllist list ref to impl map reftoimplmap reference remote service impl list remoteserviceimpllist remote service impl list remoteserviceimpllist array list arraylist remote service impl list remoteserviceimpllist add rs impl rsimpl ref to impl map reftoimplmap reference remote service impl list remoteserviceimpllist rs impl rsimpl i remote service reference iremoteservicereference list remote service impl remoteserviceimpl map ref to impl map reftoimplmap hash map hashmap i remote service reference iremoteservicereference get remote service references getremoteservicereferences target id filter idfilter string clazz string filter invalid syntax exception invalidsyntaxexception container connect exception containerconnectexception osgi support id filter idfilter support pub get remote service references getremoteservicereferences target clazz filter remote service references param id filter idfilter filter limits services registered i d s ids param clazz remote service param filter ldap filter string matched service properties matching remote service references invalid syntax exception invalidsyntaxexception org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter get remote service references getremoteservicereferences org eclipse ecf core identity java lang string java lang string i remote service reference iremoteservicereference get remote service references getremoteservicereferences id filter idfilter string clazz string filter invalid syntax exception invalidsyntaxexception osgi support id filter idfilter support pub i remote filter iremotefilter remote filter remotefilter filter create remote filter createremotefilter filter list get remote service references connected getremoteservicereferencesconnected clazz remote filter remotefilter i remote service reference iremoteservicereference to array toarray i remote service reference iremoteservicereference i remote service reference iremoteservicereference get remote service references getremoteservicereferences targetid string clazz string filter invalid syntax exception invalidsyntaxexception container connect exception containerconnectexception clazz i remote filter iremotefilter remote filter remotefilter filter create remote filter createremotefilter filter list array list arraylist get connected d getconnectedid connect targetid connect context connectcontext get remote service references connected getremoteservicereferencesconnected clazz remote filter remotefilter size i remote service reference iremoteservicereference to array toarray i remote service reference iremoteservicereference i remote service reference iremoteservicereference get all remote service references getallremoteservicereferences string clazz string filter invalid syntax exception invalidsyntaxexception list array list arraylist remote service references locally registered services remote services regs remoteservicesregs iterator remote services regs remoteservicesregs key set keyset iterator has next hasnext service reference servicereference service reference servicereference dictionary ref properties refproperties prepare properties prepareproperties clazz add create local remote service reference createlocalremoteservicereference i remote filter iremotefilter create remote filter createremotefilter filter nls nls filter constants obj ectclass objectclass clazz nls nls nls constants obj ectclass objectclass clazz nls nls match ref properties refproperties add create local remote service reference createlocalremoteservicereference i remote filter iremotefilter remote filter remotefilter filter create remote filter createremotefilter filter get connected d getconnectedid remote service reference remoteservicereference rrefs remote service remoteservice get remote service references getremoteservicereferences connectedid geturi clazz remote filter remotefilter rrefs rrefs length add get cached remote service reference getcachedremoteservicereference rrefs i remote service reference iremoteservicereference to array toarray i remote service reference iremoteservicereference i remote service reference iremoteservicereference create local remote service reference createlocalremoteservicereference service reference servicereference local remote service reference impl localremoteservicereferenceimpl create remote service d createremoteserviceid containerid get property getproperty constants service list get remote service references connected getremoteservicereferencesconnected string clazz i remote filter iremotefilter filter list array list arraylist connectedid i remote service reference iremoteservicereference get all remote service references getallremoteservicereferences clazz filter filter to string tostring length add invalid syntax exception invalidsyntaxexception remote service reference remoteservicereference rrefs remote service remoteservice get remote service references getremoteservicereferences connectedid geturi clazz filter rrefs rrefs length add get cached remote service reference getcachedremoteservicereference rrefs map cached remote service references cachedremoteservicereferences hash map hashmap i remote service reference iremoteservicereference get cached remote service reference getcachedremoteservicereference remote service reference remoteservicereference rref i remote service reference iremoteservicereference result cached remote service references cachedremoteservicereferences result i remote service reference iremoteservicereference cached remote service references cachedremoteservicereferences rref result result remote service reference impl remoteservicereferenceimpl create remote service d createremoteserviceid rref rref cached remote service references cachedremoteservicereferences rref result result i remote service d iremoteserviceid create remote service d createremoteserviceid os gi d osgiid cid i remote service d iremoteserviceid i d factory idfactory get default getdefault createid get remote service name space getremoteservicenamespace object cid i remote service d iremoteserviceid create remote service d createremoteserviceid remote service reference remoteservicereference rref uri uri rref geturi nls string fragment string fragmentstring uri get fragment getfragment string uri str uristr uri to string tostring fragment loc fragmentloc uri str uristr index of indexof fragment string fragmentstring fragment loc fragmentloc uri str uristr uri str uristr substring fragment loc fragmentloc create remote service d createremoteserviceid create r creater os gi d osgiid uri str uristr rref get property getproperty constants service os gi d osgiid create r creater os gi d osgiid string uri str uristr os gi container instant iator osgicontainerinstantiator create r creater os gi d osgiid get connect name space getconnectnamespace uri str uristr register service object remote service param clazzes names service interfaces service registered param service service object param properties service properties org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter register remote service registerremoteservice java lang string java lang object java util dictionary i remote service registration iremoteserviceregistration register remote service registerremoteservice string clazzes object service dictionary properties register remote service registerremoteservice clazzes service properties context javadoc org eclipse ecf remoteservice i os gi remote service container adapter iosgiremoteservicecontaineradapter register remote service registerremoteservice java lang string org osgi framework service reference servicereference java util dictionary i remote service registration iremoteserviceregistration register remote service registerremoteservice string clazzes service reference servicereference a service reference aservicereference dictionary properties object service context get service getservice a service reference aservicereference bundle context bundlecontext bundle context bundlecontext a service reference aservicereference get bundle getbundle get bundle context getbundlecontext register remote service registerremoteservice clazzes service properties bundle context bundlecontext i remote service registration iremoteserviceregistration register remote service registerremoteservice string clazzes object service dictionary properties bundle context bundlecontext a context acontext containerid nls illegal state exception illegalstateexception container connected dictionary props properties hashtable clone properties add hint property os gi osgi service intended accessed remotely props remoteosgiservice os gi osgi registration remove rfc hint avoid loops nls props remove osgi remote interfaces nls props remove service exported interfaces ecf remote service properties container props org eclipse ecf remoteservice constants service container containerid object classes string props org eclipse ecf remoteservice constants obj ectclass objectclass clazzes service ranking integer user integer service ranking serviceranking integer props org eclipse ecf remoteservice constants service ranking service ranking serviceranking service ranking serviceranking integer service ranking serviceranking props org eclipse ecf remoteservice constants service ranking service ranking serviceranking service registration serviceregistration reg a context acontext register service registerservice clazzes service props ecf remote service property based local service property reg set properties setproperties prepare properties prepareproperties reg get reference getreference remote services regs remoteservicesregs remote services regs remoteservicesregs reg get reference getreference reg construct i remote service d iremoteserviceid provide registration impl instance remote service registration impl remoteserviceregistrationimpl create remote service d createremoteserviceid containerid reg get reference getreference get property getproperty constants service reg dictionary prepare properties prepareproperties service reference servicereference reference string prop keys propkeys reference get property keys getpropertykeys dictionary new dictionary newdictionary properties prop keys propkeys length object reference get property getproperty prop keys propkeys new dictionary newdictionary prop keys propkeys remote service service os gi osgi service constants service equals prop keys propkeys new dictionary newdictionary org eclipse ecf remoteservice constants service new dictionary newdictionary remove registered remote service listener param listener remote service listener org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter remove remote service listener removeremoteservicelistener org eclipse ecf remoteservice i remote service listener iremoteservicelistener remove remote service listener removeremoteservicelistener i remote service listener iremoteservicelistener listener remote service listeners remoteservicelisteners remove listener org eclipse ecf remoteservice i remote service container adapter iremoteservicecontaineradapter unget remote service ungetremoteservice org eclipse ecf remoteservice i remote service reference iremoteservicereference unget remote service ungetremoteservice i remote service reference iremoteservicereference reference reference remote service reference impl remoteservicereferenceimpl remote service reference impl remoteservicereferenceimpl impl remote service reference impl remoteservicereferenceimpl reference remote service reference remoteservicereference rsr impl get r getr os gi service reference osgiservicereference rsr is active isactive remote service remoteservice unget remote service ungetremoteservice rsr ref to impl map reftoimplmap list remote service impl list remoteserviceimpllist list ref to impl map reftoimplmap remove reference remote service impl list remoteserviceimpllist iterator remote service impl list remoteserviceimpllist iterator has next hasnext remote service impl remoteserviceimpl rs impl rsimpl remote service impl remoteserviceimpl rs impl rsimpl rs impl rsimpl dispose remove returns adapter i remote service container adapter iremoteservicecontaineradapter i container icontainer supported param adapter adapt adapter adaptation supported org eclipse core runtime i adaptable iadaptable get adapter getadapter java lang object get adapter getadapter adapter adapter equals i remote service container adapter iremoteservicecontaineradapter adapter equals i container icontainer container add container listener param listener container listener org eclipse ecf core i container icontainer add listener addlistener org eclipse ecf core i container listener icontainerlistener add listener addlistener i container listener icontainerlistener listener container listeners containerlisteners add listener connect container remote container instance param targetid target connect param connect context connectcontext connection context container connect exception containerconnectexception connecting fails org eclipse ecf core i container icontainer connect org eclipse ecf core identity org eclipse ecf core security i connect context iconnectcontext connect targetid i connect context iconnectcontext container connect exception containerconnectexception targetid nls container connect exception containerconnectexception targetid check namespace string target name space targetnamespace targetid get name space getnamespace get name getname target name space targetnamespace equals get connect name space getconnectnamespace get name getname target name space targetnamespace equals stringid get name getname nls container connect exception containerconnectexception targetid incorrect connect namespace container check connected connectedid connected target connectedid get name getname equals targetid get name getname nls container connect exception containerconnectexception container connected connectedid connect context connectcontext os gi d osgiid target target name space targetnamespace equals stringid get name getname create r creater os gi d osgiid stringid targetid get name getname os gi d osgiid targetid fire listeners firelisteners container conn ecting event containerconnectingevent containerid connectedid remote service reference remoteservicereference do connect doconnect target length check import checkimport connectedid target start reg tracker startregtracker i o exception ioexception ioe container connect exception containerconnectexception ioe i d create exception idcreateexception container connect exception containerconnectexception fire listeners firelisteners container connected event containerconnectedevent containerid connectedid remote service reference remoteservicereference do connect doconnect os gi d osgiid targetid i o exception ioexception remote service remoteservice connect targetid geturi do disconnect dodisconnect os gi d osgiid targetid cached remote service references cachedremoteservicereferences cached remote service references cachedremoteservicereferences clear remote service remoteservice disconnect targetid geturi disconnect remote container org eclipse ecf core i container icontainer disconnect disconnect connectedid fire listeners firelisteners container d is connecting event containerdisconnectingevent containerid connectedid do disconnect dodisconnect connectedid connectedid fire listeners firelisteners container d isconnected event containerdisconnectedevent containerid connectedid dispose container org eclipse ecf core i container icontainer dispose dispose unregister remote services remote services tracker remoteservicestracker service reference servicereference remote services tracker remoteservicestracker get service references getservicereferences length service registration serviceregistration reg service registration serviceregistration remote services regs remoteservicesregs reg reg unregister remote services tracker remoteservicestracker close remote services tracker remoteservicestracker unregister remote listeners service registration serviceregistration lstn service registration serviceregistration remote service listeners remoteservicelisteners values to array toarray service registration serviceregistration remote service listeners remoteservicelisteners size lstn length lstn unregister throwable connectedid disconnect ref to impl map reftoimplmap ref to impl map reftoimplmap clear fire listeners firelisteners container dispose event containerdisposeevent containerid container listeners containerlisteners clear connect namespace connect namespace org eclipse ecf core i container icontainer get connect name space getconnectnamespace name space namespace get connect name space getconnectnamespace os gi name space osginamespace get default getdefault container connected code code container connected org eclipse ecf core i container icontainer get connected d getconnectedid get connected d getconnectedid connectedid remove registered container listener param listener container listener org eclipse ecf core i container icontainer remove listener removelistener org eclipse ecf core i container listener icontainerlistener remove listener removelistener i container listener icontainerlistener listener container listeners containerlisteners remove listener container instance container org eclipse ecf core identity i ide ntifiable iidentifiable getid getid containerid fire listeners param event event fire listeners firelisteners i container event icontainerevent event i container listener icontainerlistener listeners i container listener icontainerlistener container listeners containerlisteners to array toarray i container listener icontainerlistener container listeners containerlisteners size thread listeners length listeners handle event handleevent event start events os gi osgi received remote service listener remoteservicelistener instance ethz iks osgi remote service listener remoteservicelistener remote service event remoteserviceevent ethz iks osgi remote service event remoteserviceevent remote service event remoteserviceevent remote service event remoteserviceevent event event get type gettype remote service event remoteserviceevent registered check import checkimport event get remote reference getremotereference check remote service automatically imported container param remote service reference check check import checkimport remote service reference remoteservicereference object target get property getproperty org eclipse ecf remoteservice constants service registration targets target target equals containerid remote service remoteservice get remote service getremoteservice target targets target targets length targets equals containerid remote service remoteservice get remote service getremoteservice clone dictionary instance avoid modification caller registration method param props dictionary instance clone hashtable clone dictionary props hashtable clone hashtable enumeration props has more elements hasmoreelements object key next element nextelement clone key props key clone i future ifuture async get remote service references asyncgetremoteservicereferences id filter idfilter string clazz string filter i executor iexecutor executor threads executor threadsexecutor executor execute i progress runnable iprogressrunnable object i progress monitor iprogressmonitor monitor exception get remote service references getremoteservicereferences id filter idfilter clazz filter i future ifuture async get remote service references asyncgetremoteservicereferences target string clazz string filter i executor iexecutor executor threads executor threadsexecutor executor execute i progress runnable iprogressrunnable object i progress monitor iprogressmonitor monitor exception get remote service references getremoteservicereferences target clazz filter i future ifuture async get remote service references asyncgetremoteservicereferences target id filter idfilter string clazz string filter i executor iexecutor executor threads executor threadsexecutor executor execute i progress runnable iprogressrunnable object i progress monitor iprogressmonitor monitor exception get remote service references getremoteservicereferences target id filter idfilter clazz filter name space namespace get remote service name space getremoteservicenamespace i d factory idfactory get default getdefault get name space by name getnamespacebyname os gi remote service name space osgiremoteservicenamespace i remote filter iremotefilter create remote filter createremotefilter string filter invalid syntax exception invalidsyntaxexception remote filter impl remotefilterimpl context filter i remote service d iremoteserviceid get remote service d getremoteserviceid container id containerid container relative id containerrelativeid i remote service d iremoteserviceid i d factory idfactory get default getdefault createid get remote service name space getremoteservicenamespace object containerid container relative id containerrelativeid i remote service reference iremoteservicereference get remote service reference getremoteservicereference i remote service d iremoteserviceid service id serviceid service id serviceid cid service id serviceid get container d getcontainerid container isn relevant ignore cid os gi d osgiid connected ignore cid equals get connected d getconnectedid nls nls nls string filter constants service service id serviceid remote service references imagine block remote service reference remoteservicereference remote service remoteservice get remote service references getremoteservicereferences os gi d osgiid cid geturi context create filter createfilter filter remote service reference length get cached remote service reference getcachedremoteservicereference invalid syntax exception invalidsyntaxexception set connect context for authentication setconnectcontextforauthentication i connect context iconnectcontext connect context connectcontext connect context connectcontext connect context connectcontext set remote service call policy setremoteservicecallpolicy i remote service call policy iremoteservicecallpolicy policy xxx os gi osgi implement
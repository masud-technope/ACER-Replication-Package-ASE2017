copyright arthur van hoff rick bla ir blair javax jmdns impl java io exception ioexception java net data gram packet datagrampacket java net inet address inetaddress java util array list arraylist java util collections java util iterator java util list parse incoming dns message components version author arthur van hoff werner ran del shofer randelshofer pierre f ris ch frisch daniel bob bert bobbert dns incoming dnsincoming logger logger logger get logger getlogger dns incoming dnsincoming get name getname hack handle bug bonjour conf ormance test bonjourconformancetest sending target strings don follow domain format domain format srv target implementation not e note vector immutable client dns incoming dnsincoming contents vector undesired migrate collections api java replace vector list vector empty vector data gram packet datagrampacket packet len data flags num questions numquestions num answers numanswers num authorities numauthorities num add itionals numadditionals received time receivedtime list questions list answers parse message data gram datagram packet dns incoming dnsincoming data gram packet datagrampacket packet io exception ioexception packet packet inet address inetaddress source packet get address getaddress data packet get data getdata len packet get length getlength packet get offset getoffset questions collections empty list answers collections empty list received time receivedtime system current time millis currenttimemillis read unsigned short readunsignedshort flags read unsigned short readunsignedshort num questions numquestions read unsigned short readunsignedshort num answers numanswers read unsigned short readunsignedshort num authorities numauthorities read unsigned short readunsignedshort num add itionals numadditionals read unsigned short readunsignedshort parse questions num questions numquestions questions collections synchronized list synchronizedlist array list arraylist num questions numquestions num questions numquestions dns question dnsquestion question dns question dnsquestion read name readname read unsigned short readunsignedshort read unsigned short readunsignedshort questions add question parse answers num answers numanswers num authorities numauthorities num add itionals numadditionals answers collections synchronized list synchronizedlist array list arraylist string domain read name readname type read unsigned short readunsignedshort clazz read unsigned short readunsignedshort ttl read int readint len read unsigned short readunsignedshort len dns record dnsrecord rec type ip v ipv dns constants dnsconstants type ip v ipv fixme pjyf oct tested dns constants dnsconstants type aaaa rec dns record dnsrecord address domain type clazz ttl read bytes readbytes len dns constants dnsconstants type cname dns constants dnsconstants type ptr string service service read name readname io exception ioexception print stack trace printstacktrace rec dns record dnsrecord pointer domain type clazz ttl service dns constants dnsconstants type txt rec dns record dnsrecord text domain type clazz ttl read bytes readbytes len dns constants dnsconstants type srv priority read unsigned short readunsignedshort weight read unsigned short readunsignedshort port read unsigned short readunsignedshort string target domain format srv target target read name readname target read non name string readnonnamestring io exception ioexception print stack trace printstacktrace rec dns record dnsrecord service domain type clazz ttl priority weight port target dns constants dnsconstants type hinfo logger fine r finer dns incoming dnsincoming unknown type type rec rec set record source setrecordsource source add record create answers add rec add just addjust numbers skipped record answers size num answers numanswers num answers numanswers answers size num answers numanswers num authorities numauthorities num authorities numauthorities answers size num answers numanswers num authorities numauthorities num add itionals numadditionals num add itionals numadditionals io exception ioexception check message query is query isquery flags dns constants dnsconstants flags mask dns constants dnsconstants flags query check message truncated is truncated istruncated flags dns constants dnsconstants flags check message response is response isresponse flags dns constants dnsconstants flags mask dns constants dnsconstants flags response io exception ioexception len io exception ioexception parser error offset data xff read unsigned short readunsignedshort io exception ioexception read int readint io exception ioexception read unsigned short readunsignedshort read unsigned short readunsignedshort read bytes readbytes len io exception ioexception bytes len system arraycopy data bytes len bytes readutf string buffer stringbuffer buf len io exception ioexception len xxx xxxx xxxxxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx buf append string read non name string readnonnamestring io exception ioexception string buffer stringbuffer buf string buffer stringbuffer len readutf buf len buf to string tostring string read name readname io exception ioexception string buffer stringbuffer buf string buffer stringbuffer len len len buf append readutf buf len len buf append buf append len io exception ioexception bad domain circular detected start bad offset integer to hex string tohexstring io exception ioexception unsupported dns label type integer to hex string tohexstring len buf to string tostring debug ging debugging string print dump string buffer stringbuffer buf string buffer stringbuffer buf append to string tostring iterator iterator questions iterator iterator has next hasnext buf append ques iterator count iterator iterator answers iterator iterator has next hasnext count count num answers numanswers buf append answ count num answers numanswers num authorities numauthorities buf append buf append add i addi buf append iterator dump len packet get length getlength len math min len buf append buf append buf append buf append buf append buf append integer to hex string tohexstring data buf append integer to hex string tohexstring data buf append buf append buf append buf append data xff buf append buf append limit message size buf append buf to string tostring string to string tostring string buffer stringbuffer buf string buffer stringbuffer buf append is query isquery dns query dns response packet get address getaddress buf append packet get address getaddress get host address gethostaddress buf append buf append packet get port getport buf append len buf append packet get length getlength buf append buf append integer to hex string tohexstring flags buf append flags buf append integer to hex string tohexstring flags flags dns constants dnsconstants flags response buf append flags dns constants dnsconstants flags buf append flags dns constants dnsconstants flags buf append num questions numquestions buf append questions buf append num questions numquestions num answers numanswers buf append answers buf append num answers numanswers num authorities numauthorities buf append author ities authorities buf append num authorities numauthorities num add itionals numadditionals buf append addition als additionals buf append num add itionals numadditionals buf append buf to string tostring appends answers incoming illegal argument exception illegalargumentexception query truncated append dns incoming dnsincoming is query isquery is truncated istruncated is query isquery num questions numquestions collections empty list equals questions questions collections synchronized list synchronizedlist array list arraylist num questions numquestions questions add all addall questions num questions numquestions num questions numquestions collections empty list equals answers answers collections synchronized list synchronizedlist array list arraylist num answers numanswers answers add all addall num answers numanswers answers sub list sublist num answers numanswers num answers numanswers num answers numanswers num authorities numauthorities answers add all addall num answers numanswers num authorities numauthorities answers sub list sublist num answers numanswers num answers numanswers num authorities numauthorities num authorities numauthorities num authorities numauthorities num add itionals numadditionals answers add all addall answers sub list sublist num answers numanswers num authorities numauthorities num answers numanswers num authorities numauthorities num add itionals numadditionals num add itionals numadditionals num add itionals numadditionals illegal argument exception illegalargumentexception elapse since arr ival elapsesincearrival system current time millis currenttimemillis received time receivedtime list get questions getquestions questions list get answers getanswers answers
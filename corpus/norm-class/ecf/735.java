copyright jan rellermeyer systems group dep artment department computer science eth zurich rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors jan rellermeyer initial api implementation mark us markus alexander kuppe enhancements bug fixes ethz iks slp impl java data input stream datainputstream java data output stream dataoutputstream java i o exception ioexception java security private key privatekey java security public key publickey java security signature java util array list arraylist java util list ethz iks slp service location exception servicelocationexception implementation slp authentication block author jan rellermeyer eth zurich authentication block authenticationblock bsd code dsa bsd dsa timestamp timestamp data data signature sig spi string spi create instance authentication block authenticationblock param bsd bsd bsd dsa supported param spi str spistr spi string param time stamp timestamp timestamp param byte data bytedata binary data param signature signature avaliable service location exception servicelocationexception processing errors authentication block authenticationblock bsd string spi str spistr time stamp timestamp byte data bytedata signature service location exception servicelocationexception bsd service location exception servicelocationexception service location exception servicelocationexception implemented bsd dsa supported timestamp time stamp timestamp data byte data bytedata spi spi str spistr signature sign sig signature authentication block authenticationblock sign authentication block authenticationblock service location exception servicelocationexception processing errors sign service location exception servicelocationexception private key privatekey private key privatekey slp core slpcore config get private key getprivatekey spi slp core slpcore platform log debug logdebug sig ning signing spi spi signature signature signature get instance getinstance sha withdsa signature init sign initsign private key privatekey signature update data sig signature sign exception slp core slpcore platform log error logerror get message getmessage fill in stack trace fillinstacktrace service location exception servicelocationexception service location exception servicelocationexception authentication failed sign data spi spi string getspi spi timestamp timestamp get timestamp gettimestamp timestamp verify auth block authblock param ver data verdata data verification suceeds service location exception servicelocationexception errors verify ver data verdata service location exception servicelocationexception public key publickey public key publickey slp core slpcore config get public key getpublickey spi signature signature signature get instance getinstance sha withdsa signature init verify initverify public key publickey signature update ver data verdata success signature verify sig slp core slpcore platform log debug logdebug success verified spi verification failed spi spi success exception slp core slpcore platform log error logerror get message getmessage fill in stack trace fillinstacktrace service location exception servicelocationexception service location exception servicelocationexception authentication failed verify data spi spi cal culates calculates length block length get length getlength bsd block length timestamp spi length spi spi get bytes getbytes length signature sig length bytes bytes i o exception ioexception errors write data output stream dataoutputstream i o exception ioexception bsd write short writeshort bsd dsa write short writeshort get length getlength write int writeint timestamp temp spi get bytes getbytes write short writeshort temp length write temp write sig parse authentication block authenticationblock array param input data input datainput authentication block authenticationblock array service location exception servicelocationexception parse errors i o exception ioexception service location exception servicelocationexception authentication block authenticationblock parse data input stream datainputstream input i o exception ioexception service location exception servicelocationexception list blocks array list arraylist block count blockcount input read byte readbyte block count blockcount authentication block authenticationblock auth block authblock authentication block authenticationblock bsd input read short readshort bsd bsd dsa service location exception servicelocationexception service location exception servicelocationexception authentication failed bsd bsd supported size input read short readshort auth block authblock timestamp input read int readint auth block authblock spi input readutf auth block authblock sig size auth block authblock spi get bytes getbytes length input read fully readfully auth block authblock sig i o exception ioexception ioe service location exception servicelocationexception service location exception servicelocationexception parse error ioe get message getmessage blocks add auth block authblock slp core slpcore config get security enabled getsecurityenabled authentication block authenticationblock authentication block authenticationblock blocks to array toarray authentication block authenticationblock
copyright remain netherlands http remains oftware remainsoftware rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors wim jongman initial api implementation ahmed aadel initial api implementation org eclipse ecf provider zookeeper core internal java file java io exception ioexception java print writer printwriter java util array list arraylist java util arrays java util collections java util list java util java util uuid org eclipse core runtime org eclipse ecf core identity org eclipse ecf provider zookeeper core default discovery config defaultdiscoveryconfig org eclipse ecf provider zookeeper core i discovery config idiscoveryconfig org eclipse ecf provider zookeeper core zoo discovery container zoodiscoverycontainer flavor org eclipse ecf provider zookeeper util geo org eclipse ecf provider zookeeper util logger org osgi framework service exception serviceexception org osgi framework service reference servicereference org osgi service log log service logservice configuration default discovery config defaultdiscoveryconfig file zoo conf file zooconffile file zookeeper data file zookeeperdatafile service reference servicereference reference list string server ips serverips array list arraylist string flavor flavor nls string local host localhost localhost configuration service reference servicereference reference is not null isnotnull reference string legal keys legalkeys get config properties getconfigproperties key set keyset string key reference get property keys getpropertykeys legal keys legalkeys key key starts with startswith default discovery config defaultdiscoveryconfig zoodiscovery prefix get config properties getconfigproperties key reference get property getproperty key configuration target id targetid target id targetid get name getname configuration string props as string propsasstring is not null isnotnull props as string propsasstring nls string props as string propsasstring split string nls string key split key length default config properties defaultconfigproperties key key configuration configure print writer printwriter writer is new zookeeper data isnewzookeeperdata string data dir name datadirname string get config properties getconfigproperties zookeeper data dir datadir data directory randomly pick data dir datadir equals data dir name datadirname data dir name datadirname random dir name randomdirname zookeeper data file zookeeperdatafile file file get config properties getconfigproperties zookeeper temp dir tempdir to string tostring data dir name datadirname is new zookeeper data isnewzookeeperdata zookeeper data file zookeeperdatafile mkdir zookeeper data file zookeeperdatafile delete on exit deleteonexit is new zookeeper data isnewzookeeperdata data directory reused emptying avoid data corruption clean nls zoo conf file zooconffile file zookeeper data file zookeeperdatafile zoo cfg zoo conf file zooconffile create new file createnewfile zoo conf file zooconffile delete on exit deleteonexit get config properties getconfigproperties contains key containskey zoodiscovery flavor centralized set flavor setflavor flavor centralized server ips serverips parse ips parseips server ips serverips size string msg zoo discovery zoodiscovery property zoodiscovery flavor centralized address designating location zoo discovery zoodiscovery instance playing central role logger log log service logservice log error msg service exception serviceexception msg get config properties getconfigproperties contains key containskey zoodiscovery flavor replicated set flavor setflavor flavor replicated server ips serverips parse ips parseips server ips serverips geo get host gethost server ips serverips add geo get host gethost server ips serverips size string msg industrial discovery property i discovery config idiscoveryconfig zoodiscovery flavor replicated address localhost logger log log service logservice log error msg service exception serviceexception msg get config properties getconfigproperties contains key containskey zoodiscovery flavor standalone set flavor setflavor flavor standalone server ips serverips parse ips parseips collections sort server ips serverips is quorum isquorum string myip geo get host gethost my id myid server ips serverips index of indexof myip file my id file myidfile nls file nls get zookeeper data file getzookeeperdatafile nls my id myid my id file myidfile create new file createnewfile my id file myidfile delete on exit deleteonexit writer print writer printwriter my id file myidfile writer print my id myid writer flush writer close writer print writer printwriter zoo conf file zooconffile is quorum isquorum server ips serverips size nls writer println server nls nls server ips serverips nls get server port getserverport get election port getelectionport string get config properties getconfigproperties key set keyset starts with startswith zoodiscovery prefix ignore properties intended zoo keeper zookeeper internal configuration writer println nls get config properties getconfigproperties nls writer flush writer close io exception ioexception logger log log service logservice log error get message getmessage writer writer close string random dir name randomdirname string uuid randomuuid replace all replaceall zdd get election port getelectionport integer parse int parseint string get config properties getconfigproperties zookeeper election port string get conf file getconffile zoo conf file zooconffile to string tostring string get server ips getserverips nls string ips string ipsstring string server ips serverips nls nls ips string ipsstring nls ips string ipsstring substring ips string ipsstring last index of lastindexof get client port getclientport integer parse int parseint string get config properties getconfigproperties zookeeper client port clientport list string get server ips as list getserveripsaslist server ips serverips file get zookeeper data file getzookeeperdatafile zookeeper data file zookeeperdatafile set flavor setflavor flavor flavor flavor flavor flavor get flavor getflavor flavor is quorum isquorum flavor flavor replicated is central ized iscentralized flavor flavor centralized is stand alone isstandalone flavor flavor standalone service reference servicereference get reference getreference reference clean file file zookeeper data file zookeeperdatafile list files listfiles file is directory isdirectory file file list files listfiles delete file delete throwable logger log log service logservice log error get message getmessage list string parse ips parseips list string ips arrays as list aslist string get config properties getconfigproperties nls flavor to string tostring split nls list string unfixed size unfixedsize array list arraylist string string ips local host localhost replace local host localhost geo get host gethost unfixed size unfixedsize add collections sort unfixed size unfixedsize unfixed size unfixedsize string to string tostring string flavor object parse ips parseips get tick time getticktime integer parse int parseint string get config properties getconfigproperties zookeeper ticktime get server port getserverport integer parse int parseint string get config properties getconfigproperties zookeeper server port
copyright jan rellermeyer systems group dep artment department computer science eth z uric h zurich rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors jan rellermeyer initial api implementation mark us markus alexander kuppe enhancements bug fixes ethz iks slp impl java byte array output stream bytearrayoutputstream java data input stream datainputstream java data output stream dataoutputstream java i o exception ioexception java util list ethz iks slp service location exception servicelocationexception authenticated url block slp message slpmessage author jan rellermeyer systems group eth zï¿½rich authenticatedurl lifetime authenticated url lifetime blocks authentication block authenticationblock auth blocks authblocks create authenticated url authenticatedurl auth blocks authblocks authentication block authenticationblock sign serviceurl param spi list spilist list spi s spis service location exception servicelocationexception errors sign list spi list spilist service location exception servicelocationexception auth blocks authblocks authentication block authenticationblock spi list spilist size spi list spilist size timestamp slp utils slputils get timestamp gettimestamp timestamp lifetime string spi string spi list spilist data get auth data getauthdata spi timestamp auth blocks authblocks authentication block authenticationblock authentication block authenticationblock bsd dsa spi timestamp data verifies authentication blocks serviceurl verification succeeds service location exception servicelocationexception errors verify service location exception servicelocationexception auth blocks authblocks length data get auth data getauthdata auth blocks authblocks getspi auth blocks authblocks get timestamp gettimestamp auth blocks authblocks verify data representation authentication data param spi spi string defined rfc param timestamp timestamp defined rfc array service location exception servicelocationexception internal errors get auth data getauthdata string spi timestamp service location exception servicelocationexception byte array output stream bytearrayoutputstream bos byte array output stream bytearrayoutputstream data output stream dataoutputstream dos data output stream dataoutputstream bos temp spi get bytes getbytes dos write short writeshort temp length dos write temp temp to string tostring get bytes getbytes dos write short writeshort temp length dos write temp dos write int writeint timestamp bos to byte array tobytearray i o exception ioexception ioe service location exception servicelocationexception service location exception servicelocationexception internal system error ioe get message getmessage authentication block bytes bytes authentication block i o exception ioexception errors write auth block writeauthblock data output stream dataoutputstream i o exception ioexception write auth blocks authblocks length auth blocks authblocks length auth blocks authblocks write get auth block length getauthblocklength len auth blocks authblocks length len auth blocks authblocks get length getlength len parse blocks param input data input blocks service location exception servicelocationexception wrong i o exception ioexception authentication block authenticationblock parse auth block parseauthblock data input stream datainputstream input service location exception servicelocationexception i o exception ioexception authentication block authenticationblock parse input
copyright comp osent composent rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors comp osent composent initial api implementation must afa mustafa isik conflict resolution operational transformations marcelo may worm mayworm adding sync api dep endence dependence ibm corporation support text editors org eclipse ecf doc share docshare org eclipse ecf internal doc share docshare messages java java util collections java util map org eclipse core file system filesystem efs org eclipse core file system filesystem i file store ifilestore org eclipse core runtime org eclipse core runtime org eclipse ecf core i container icontainer org eclipse ecf core identity org eclipse ecf core identity i d create exception idcreateexception org eclipse ecf core util ecf exception ecfexception org eclipse ecf core util trace org eclipse ecf data share datashare abstract share abstractshare org eclipse ecf data share datashare i channel container adapter ichannelcontaineradapter org eclipse ecf data share datashare events i channel disconnect event ichanneldisconnectevent org eclipse ecf doc share docshare messages org eclipse ecf internal doc share docshare org eclipse ecf presence i presence container adapter ipresencecontaineradapter org eclipse ecf presence roster org eclipse ecf sync org eclipse ecf sync doc document change message documentchangemessage org eclipse ecf sync doc i document synchronization strategy factory idocumentsynchronizationstrategyfactory org eclipse jface dialogs message dialog messagedialog org eclipse jface text org eclipse jface text source org eclipse jface viewers org eclipse osgi util nls org eclipse swt custom styled text styledtext org eclipse swt widgets org eclipse org eclipse editors text editorsui org eclipse texteditor i document provider idocumentprovider org eclipse texteditor i text editor itexteditor represents document sharing session participants doc share docshare abstract share abstractshare selection receiver selectionreceiver nls string selection annotation org eclipse ecf doc share docshare annotations remote selection remoteselection nls string cursor annotation org eclipse ecf doc share docshare annotations remote cursor remotecursor annotation model current document i annotation model iannotationmodel annotation model annotationmodel object lock changing annotation model code code model object annotation model lock annotationmodellock annotation remote selection annotation model annotationmodel annotation current annotation currentannotation selection receiver selectionreceiver i text editor itexteditor editor editor i document provider idocumentprovider document provider documentprovider editor get document provider getdocumentprovider document provider documentprovider annotation model annotationmodel document provider documentprovider get annotation model getannotationmodel editor get editor input geteditorinput annotation model annotationmodel annotation model annotationmodel is ynchronizable isynchronizable annotation model lock annotationmodellock is ynchronizable isynchronizable annotation model annotationmodel get lock object getlockobject annotation model lock annotationmodellock annotation model lock annotationmodellock handle message handlemessage selection message selectionmessage remote msg remotemsg annotation model lock annotationmodellock position new position newposition position remote msg remotemsg get offset getoffset remote msg remotemsg get length getlength annotation new annotation newannotation annotation new position newposition get length getlength selection annotation cursor annotation messages doc share docshare remote selection remoteselection annotation model lock annotationmodellock annotation model annotationmodel initial selection create current annotation currentannotation current annotation currentannotation new annotation newannotation annotation model annotationmodel add annotation addannotation new annotation newannotation new position newposition selection changed skip current annotation currentannotation get type gettype new annotation newannotation get type gettype position old position oldposition annotation model annotationmodel get position getposition current annotation currentannotation old position oldposition new position newposition equals old position oldposition selection changed replace annotation annotation model annotationmodel i annotation model extension iannotationmodelextension annotation old annotations oldannotations annotation current annotation currentannotation current annotation currentannotation new annotation newannotation map new annotations newannotations collections singleton map singletonmap new annotation newannotation new position newposition i annotation model extension iannotationmodelextension annotation model annotationmodel replace annotations replaceannotations old annotations oldannotations new annotations newannotations annotation model annotationmodel remove annotation removeannotation current annotation currentannotation annotation model annotationmodel add annotation addannotation new annotation newannotation new position newposition dispose annotation model lock annotationmodellock annotation model lock annotationmodellock annotation model annotationmodel current annotation currentannotation annotation model annotationmodel remove annotation removeannotation current annotation currentannotation current annotation currentannotation annotation model annotationmodel init iator initiator init iator d initiatorid receiver receiverid ourid text editor i text editor itexteditor editor content received start message user resp onded responded question display editor times string start content startcontent object lock changing connected doc share docshare instance object state lock statelock object strategy main taining maintaining consistency session participants doc uments documents i model synchronization strategy imodelsynchronizationstrategy sync strategy syncstrategy factory returns str ategies strategies i document synchronization strategy factory idocumentsynchronizationstrategyfactory factory handler selection message selectionmessage painting remote selection selection receiver selectionreceiver selection receiver selectionreceiver create document sharing session instance param adapter link i channel container adapter ichannelcontaineradapter create document sharing session ecf exception ecfexception channel created doc share docshare i channel container adapter ichannelcontaineradapter adapter ecf exception ecfexception adapter factory activator get default getdefault get cola synchronization strategy factory getcolasynchronizationstrategyfactory i part listener ipartlistener part listener partlistener i part listener ipartlistener part activated partactivated i workbench part iworkbenchpart part brought to top partbroughttotop i workbench part iworkbenchpart part closed partclosed i workbench part iworkbenchpart i text editor itexteditor text editor texteditor get text editor gettexteditor text editor texteditor equals text editor texteditor get site getsite get part getpart stop share stopshare part deactivated partdeactivated i workbench part iworkbenchpart part opened partopened i workbench part iworkbenchpart i roster manager irostermanager roster manager rostermanager i roster listener irosterlistener roster listener rosterlistener i roster listener irosterlistener handle roster entry add handlerosterentryadd i roster entry irosterentry entry handle roster entry remove handlerosterentryremove i roster entry irosterentry entry handle roster update handlerosterupdate i roster iroster roster i roster item irosteritem changed value changedvalue changed value changedvalue i roster entry irosterentry changedid i roster entry irosterentry changed value changedvalue get user getuser getid oid otherid shell shell state lock statelock oid get our d getourid otherid get other d getotherid i workbench part site iworkbenchpartsite wps get text editor gettexteditor get site getsite shell wps get shell getshell oid changedid equals oid local stop share localstopshare show stop share message showstopsharemessage shell messages doc share docshare shared editor otherid changedid equals otherid local stop share localstopshare show stop share message showstopsharemessage shell messages doc share docshare shared editor remote document listener listener local copy i document idocument listener responsible sending document update messages not ified notified i document listener idocumentlistener document listener documentlistener i document listener idocumentlistener document about to be changed documentabouttobechanged document event documentevent event handling local operation application document changed documentchanged document event documentevent event channel reason handle get channel getchannel activator get default getdefault is listener active islisteneractive is sharing issharing listener active ignore input activator get default getdefault is listener active islisteneractive echo change nls trace trace activator plugin nls bind document changed documentchanged doc share docshare event sync api entry point usage sync api local document changed editor method called code executed code registers document change documentchange local sync strategy syncstrategy instance sync strategy syncstrategy register local change registerlocalchange i model change imodelchange model change messages returned register local change registerlocalchange call ecf data share datashare channel remote participant i model change message imodelchangemessage change messages changemessages sync strategy syncstrategy register local change registerlocalchange document change message documentchangemessage event get offset getoffset event get length getlength event get text gettext change messages changemessages length send message sendmessage get other d getotherid change messages changemessages serialize exception log error logerror messages doc share docshare exception send message i selection changed listener iselectionchangedlistener selection listener selectionlistener i selection changed listener iselectionchangedlistener selection changed selectionchanged selection changed event selectionchangedevent event channel reason handle get channel getchannel activator get default getdefault is listener active islisteneractive listener active ignore input activator get default getdefault is listener active islisteneractive echo change nls trace trace activator plugin nls bind selection changed selectionchanged doc share docshare event event get selection getselection i text selection itextselection i text selection itextselection text selection textselection i text selection itextselection event get selection getselection selection message selectionmessage msg selection message selectionmessage text selection textselection get offset getoffset text selection textselection get length getlength send message sendmessage get other d getotherid msg serialize exception log error logerror messages doc share docshare exception send message start sharing editor contents participants send request start sharing target identified code toid code parameter remote receiver displayed message dialog option start editor sharing param init iator initiator code code param from name fromname receiver code get name getname param toid intended receiver code code param file name filename file file shared suffix type extension code code param editor part editorpart text editor showing contents editor code code start share startshare string from name fromname toid string file name filename i text editor itexteditor editor part editorpart nls trace entering activator plugin doc share debug options docsharedebugoptions methods entering doc share docshare start share startshare object from name fromname toid file name filename editor part editorpart is not null isnotnull string f name fname from name fromname get name getname from name fromname is not null isnotnull toid is not null isnotnull f name fname is not null isnotnull editor part editorpart display get default getdefault sync exec syncexec runnable sync api create synchronization str ategy strategy instance sync strategy syncstrategy create synchronization strategy createsynchronizationstrategy is not null isnotnull sync strategy syncstrategy content local document string content editor part editorpart get document provider getdocumentprovider get document getdocument editor part editorpart get editor input geteditorinput send start message current content send message sendmessage toid start message startmessage f name fname toid content file name filename serialize local sharing start setup doc listener local start share localstartshare get local roster manager getlocalrostermanager toid editor part editorpart exception log error logerror messages doc share docshare error starting editor title show error to user showerrortouser messages doc share docshare error starting editor title nls bind messages doc share docshare error starting editor message get local ized message getlocalizedmessage nls trace exiting activator plugin doc share debug options docsharedebugoptions methods entering doc share docshare start share startshare editor sharing message engaged editor sharing session link is sharing issharing returns code code stop share stopshare nls trace entering activator plugin doc share debug options docsharedebugoptions methods entering get class getclass stop share stopshare is sharing issharing send message send stop message sendstopmessage sync strategy syncstrategy local stop share localstopshare nls trace exiting activator plugin doc share debug options docsharedebugoptions methods exiting get class getclass stop share stopshare javadoc org eclipse ecf data share datashare abstract share abstractshare handle message handlemessage org eclipse ecf core identity handle message handlemessage from container d fromcontainerid data i model change message imodelchangemessage message message deserialize data is not null isnotnull message message document change message documentchangemessage handle update message handleupdatemessage document change message documentchangemessage message message selection message selectionmessage selection receiver selectionreceiver receiver selection receiver selectionreceiver receiver receiver handle message handlemessage selection message selectionmessage message message start message startmessage handle start message handlestartmessage start message startmessage message message stop message stopmessage handle stop message handlestopmessage stop message stopmessage message invalid object exception invalidobjectexception nls bind messages doc share docshare exception invalid message message get class getclass get name getname exception log error logerror messages doc share docshare exception handle message method called link handle message handlemessage method type message received start message remote party link start share startshare string string i text editor itexteditor param message update message updatemessage received i d create exception idcreateexception handle start message handlestartmessage start message startmessage message i d create exception idcreateexception senderid message get sender d getsenderid is not null isnotnull senderid string sender username senderusername message get sender username getsenderusername is not null isnotnull sender username senderusername message get receiver d getreceiverid is not null isnotnull string filename message get file name getfilename is not null isnotnull filename string document content documentcontent message get document content getdocumentcontent is not null isnotnull document content documentcontent sync api create instance synchronization str ategy strategy receiver sync strategy syncstrategy create synchronization strategy createsynchronizationstrategy is not null isnotnull sync strategy syncstrategy synchronize state lock statelock state lock statelock sharing start content is sharing issharing start content startcontent send stop message sendstopmessage senderid start content message document content documentcontent start content startcontent document content documentcontent open text editor display get default getdefault async exec asyncexec runnable user receive doc open receiver dialog openreceiverdialog senderid sender username senderusername filename create doc share editor input docshareeditorinput doc share editor input docshareeditorinput dsei doc share editor input docshareeditorinput get temp file store gettempfilestore sender username senderusername filename start content startcontent sender username senderusername filename open text editor i text editor itexteditor i editor part ieditorpart editor part editorpart platformui get workbench getworkbench get active workbench window getactiveworkbenchwindow get active page getactivepage open editor openeditor dsei get editor id for file name geteditoridforfilename filename text editor offer chance editor part editorpart editor part editorpart i text editor itexteditor i text editor itexteditor editor part editorpart get adapter getadapter i text editor itexteditor i text editor itexteditor editor part editorpart change local local start share localstartshare get local roster manager getlocalrostermanager senderid send message init iator initiator send stop message sendstopmessage local share local stop share localstopshare exception log error logerror messages doc share docshare exception receiving message title show error to user showerrortouser messages doc share docshare exception receiving message title nls bind messages doc share docshare exception receiving message message get local ized message getlocalizedmessage i roster manager irostermanager get local roster manager getlocalrostermanager i container icontainer container i container icontainer adapter get adapter getadapter i container icontainer container i presence container adapter ipresencecontaineradapter presence container adapter presencecontaineradapter i presence container adapter ipresencecontaineradapter container get adapter getadapter i presence container adapter ipresencecontaineradapter presence container adapter presencecontaineradapter presence container adapter presencecontaineradapter get roster manager getrostermanager modify start content modifystartcontent offset length string text string buffer stringbuffer result string buffer stringbuffer start content startcontent substring offset result append text result append start content startcontent substring offset length start content startcontent result to string tostring method called link handle message handlemessage method type message received update message param document change message documentchangemessage update message updatemessage received handle update message handleupdatemessage document change message documentchangemessage document change message documentchangemessage state lock statelock start content startcontent modify start content modifystartcontent document change message documentchangemessage get offset getoffset document change message documentchangemessage get length of replaced text getlengthofreplacedtext document change message documentchangemessage get text gettext replace document display get default getdefault async exec asyncexec runnable trace entering activator plugin doc share debug options docsharedebugoptions methods entering get class getclass handle update message handleupdatemessage document change message documentchangemessage nls i document idocument document get document from editor getdocumentfromeditor document trace trace activator plugin nls nls bind nls handle update message handleupdatemessage calling transform incoming message transformincomingmessage nls doc share docshare sync api document change message received remote channel passed sync strategy syncstrategy transformation returned i model change imodelchange applied local document synchronization str ategy strategy transformed i model change imodelchange model changes modelchanges sync strategy syncstrategy transform remote change transformremotechange document change message documentchangemessage editor ref use refuse input app lying applying set editor to ref use input seteditortorefuseinput model changes modelchanges length apply change model clients method apply change model type model changes modelchanges apply to model applytomodel document exception log error logerror messages doc share docshare exception receiving message title show error to user showerrortouser messages doc share docshare exception receiving message title nls bind messages doc share docshare exception receiving message message get local ized message getlocalizedmessage editor accept input set editor to accept input seteditortoacceptinput trace exiting activator plugin doc share debug options docsharedebugoptions methods exiting get class getclass handle update message handleupdatemessage param message handle stop message handlestopmessage stop message stopmessage message is sharing issharing shell editor get site getsite get shell getshell local stop share localstopshare sync strategy syncstrategy show stop share message showstopsharemessage messages doc share docshare remote user stopped set editor to ref use input seteditortorefuseinput set editor editable seteditoreditable activator get default getdefault set listener active setlisteneractive set editor to accept input seteditortoacceptinput set editor editable seteditoreditable activator get default getdefault set listener active setlisteneractive i text editor itexteditor get editor geteditor editor i editor input ieditorinput get editor input geteditorinput state lock statelock editor editor get editor input geteditorinput open receiver dialog openreceiverdialog fromid string from username fromusername string file name filename message dialog messagedialog open question openquestion messages doc share docshare editor share popup title nls bind messages doc share docshare editor share popup message from username fromusername file name filename handle disconnect event handledisconnectevent i channel disconnect event ichanneldisconnectevent cde we disconnected wedisconnected ourid ourid equals cde get target d gettargetid shell shell is sharing issharing shell editor get site getsite get shell getshell notify user local stop share localstopshare shell we disconnected wedisconnected show stop share message showstopsharemessage shell messages doc share docshare shared editor show stop share message showstopsharemessage shell messages doc share docshare shared editor remote param shell code code param message message content message dialog show stop share message showstopsharemessage shell shell string message display display shell get display getdisplay display async exec asyncexec runnable message dialog messagedialog open information openinformation shell messages doc share docshare shared editor title message i file store ifilestore get temp file store gettempfilestore string from username fromusername string file name filename string content i o exception ioexception core exception coreexception i file store ifilestore file store filestore efs get local file system getlocalfilesystem from local file fromlocalfile file create temp file createtempfile from username fromusername file name filename output stream outputstream outs file store filestore open output stream openoutputstream efs overwrite outs write content get bytes getbytes outs close file store filestore javadoc org eclipse ecf data share datashare abstract share abstractshare dispose dispose local stop share localstopshare dispose log error logerror i status istatus status activator get default getdefault get log getlog log status show error to user showerrortouser string title string message message dialog messagedialog open error openerror title message log error logerror string exception string exceptionstring throwable trace cat ching catching activator plugin doc share debug options docsharedebugoptions exceptions cat ching catching get class getclass exception string exceptionstring activator get default getdefault get log getlog log status i status istatus error activator plugin i status istatus error exception string exceptionstring styled text styledtext get text control gettextcontrol state lock statelock editor styled text styledtext editor get adapter getadapter control set editor editable seteditoreditable editable styled text styledtext text control textcontrol get text control gettextcontrol text control textcontrol text control textcontrol is disposed isdisposed display get default getdefault sync exec syncexec runnable text control textcontrol set editable seteditable editable string get editor id for file name geteditoridforfilename string file name filename i workbench iworkbench platformui get workbench getworkbench i editor registry ieditorregistry get editor registry geteditorregistry i editor descriptor ieditordescriptor desc get default editor getdefaulteditor file name filename desc desc get id getid editorsui text editor i document idocument get document from editor getdocumentfromeditor state lock statelock i text editor itexteditor text editor texteditor get text editor gettexteditor text editor texteditor i document provider idocumentprovider document provider documentprovider text editor texteditor get document provider getdocumentprovider document provider documentprovider document provider documentprovider get document getdocument text editor texteditor get editor input geteditorinput local start share localstartshare i roster manager irostermanager init iator initiator receiver i text editor itexteditor edt state lock statelock local stop share localstopshare roster manager rostermanager roster manager rostermanager roster manager rostermanager add roster listener addrosterlistener roster listener rosterlistener ourid init iator d initiatorid init iator initiator receiverid receiver editor edt editor get site getsite get page getpage add part listener addpartlistener part listener partlistener i document idocument doc get document from editor getdocumentfromeditor doc doc add document listener adddocumentlistener document listener documentlistener editor i selection provider iselectionprovider selection provider selectionprovider editor get selection provider getselectionprovider selection provider selectionprovider i post selection provider ipostselectionprovider i post selection provider ipostselectionprovider selection provider selectionprovider add post selection changed listener addpostselectionchangedlistener selection listener selectionlistener selection receiver selectionreceiver selection receiver selectionreceiver editor local stop share localstopshare selection receiver selectionreceiver old selection receiver oldselectionreceiver state lock statelock roster manager rostermanager roster manager rostermanager remove roster listener removerosterlistener roster listener rosterlistener roster manager rostermanager ourid init iator d initiatorid receiverid start content startcontent i document idocument doc get document from editor getdocumentfromeditor doc doc remove document listener removedocumentlistener document listener documentlistener editor editor get site getsite get page getpage remove part listener removepartlistener part listener partlistener i selection provider iselectionprovider selection provider selectionprovider editor get selection provider getselectionprovider selection provider selectionprovider i post selection provider ipostselectionprovider i post selection provider ipostselectionprovider selection provider selectionprovider remove post selection changed listener removepostselectionchangedlistener selection listener selectionlistener old selection receiver oldselectionreceiver selection receiver selectionreceiver selection receiver selectionreceiver editor old selection receiver oldselectionreceiver old selection receiver oldselectionreceiver dispose send stop message sendstopmessage send stop message sendstopmessage get other d getotherid send stop message sendstopmessage is sharing issharing send message sendmessage stop message stopmessage serialize exception log error logerror messages doc share docshare exception send message string to string tostring nls string buffer stringbuffer buf string buffer stringbuffer doc share docshare nls nls nls buf append ourid append ourid append init iator d initiatorid append init iator d initiatorid append receiverid append receiverid nls nls buf append str ategy strategy append sync strategy syncstrategy append buf to string tostring i model synchronization strategy imodelsynchronizationstrategy create synchronization strategy createsynchronizationstrategy is init iator isinitiator instantiate service is not null isnotnull factory factory create document synchronization strategy createdocumentsynchronizationstrategy get channel getchannel getid is init iator isinitiator get init iator d getinitiatorid init iator d initiatorid get receiver d getreceiverid receiverid get our d getourid ourid i text editor itexteditor get text editor gettexteditor editor is sharing issharing state lock statelock editor get other d getotherid state lock statelock is init iator isinitiator receiverid init iator d initiatorid is init iator isinitiator state lock statelock ourid init iator d initiatorid receiverid ourid equals init iator d initiatorid
rights reserved licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license org jivesoftware smackx bytes treams bytestreams ibb java io exception ioexception java input stream inputstream java output stream outputstream java net socket timeout exception sockettimeoutexception java util concurrent blocking queue blockingqueue java util concurrent linked blocking queue linkedblockingqueue java util concurrent time unit timeunit org jivesoftware smack connection org jivesoftware smack packet listener packetlistener org jivesoftware smack xmpp exception xmppexception org jivesoftware smack filter and filter andfilter org jivesoftware smack filter packet filter packetfilter org jivesoftware smack filter packet type filter packettypefilter org jivesoftware smack packet org jivesoftware smack packet message org jivesoftware smack packet packet org jivesoftware smack packet packet extension packetextension org jivesoftware smack packet xmpp error xmpperror org jivesoftware smack util string utils stringutils org jivesoftware smack util sync packet send syncpacketsend org jivesoftware smackx bytes treams bytestreams bytestream session bytestreamsession org jivesoftware smackx bytes treams bytestreams ibb packet close org jivesoftware smackx bytes treams bytestreams ibb packet data org jivesoftware smackx bytes treams bytestreams ibb packet data packet extension datapacketextension org jivesoftware smackx bytes treams bytestreams ibb packet open in band bytestream session inbandbytestreamsession represents band bytestream session band bytes treams bytestreams bidirectional session encapsulates streams direct ions directions note closing band bytestream session close streams streams closed individually session closed automatically stream closed link set close both streams enabled setclosebothstreamsenabled method streams closed automatically closed author henning s tai b staib in band bytestream session inbandbytestreamsession bytestream session bytestreamsession xmpp connection connection connection band bytestream open request session open byte stream request bytestreamrequest input stream session iqibb input stream iqibbinputstream messageibbinputstream ibb input stream ibbinputstream input stream inputstream output stream session iqibb output stream iqibboutputstream messageibboutputstream ibb output stream ibboutputstream output stream outputstream jid remote peer string remotejid flag close streams closed close both streams enabled closebothstreamsenabled flag session closed is closed isclosed constructor param connection xmpp connection param byte stream request bytestreamrequest band bytestream open request session param remotejid jid remote peer in band bytestream session inbandbytestreamsession connection connection open byte stream request bytestreamrequest string remotejid connection connection byte stream request bytestreamrequest byte stream request bytestreamrequest remotejid remotejid initialize streams dependent stanza type byte stream request bytestreamrequest get stanza getstanza input stream inputstream iqibb input stream iqibbinputstream output stream outputstream iqibb output stream iqibboutputstream message input stream inputstream messageibbinputstream output stream outputstream messageibboutputstream input stream inputstream get input stream getinputstream input stream inputstream output stream outputstream get output stream getoutputstream output stream outputstream get read timeout getreadtimeout input stream inputstream read timeout readtimeout set read timeout setreadtimeout timeout timeout illegal argument exception illegalargumentexception timeout input stream inputstream read timeout readtimeout timeout returns streams closed automatically streams closed code code code code streams closed streams closed code code streams closed independently is close both streams enabled isclosebothstreamsenabled close both streams enabled closebothstreamsenabled sets streams closed automatically streams closed code code param close both streams enabled closebothstreamsenabled code code streams closed streams closed code code streams closed independently set close both streams enabled setclosebothstreamsenabled close both streams enabled closebothstreamsenabled close both streams enabled closebothstreamsenabled close both streams enabled closebothstreamsenabled close io exception ioexception close input stream close by local closebylocal close output stream close by local closebylocal method invoked request close band bytestream received param close request closerequest close request remote peer close by peer closebypeer close close request closerequest close streams flushing stream considered closed remote peers side input stream inputstream close internal closeinternal input stream inputstream cleanup output stream outputstream close internal closeinternal acknowledge close request confirm close confirmclose create result q createresultiq close request closerequest connection send packet sendpacket confirm close confirmclose method invoked streams closed locally error occurred locally session closed io exception ioexception error occurs sending close request close by local closebylocal io exception ioexception is closed isclosed close both streams enabled closebothstreamsenabled input stream inputstream close internal closeinternal output stream outputstream close internal closeinternal input stream inputstream close internal closeinternal close stream send data left output stream outputstream close internal closeinternal input stream inputstream is closed isclosed output stream outputstream is closed isclosed is closed isclosed send close request close close close byte stream request bytestreamrequest get session d getsessionid close set to setto remotejid sync packet send syncpacketsend get reply getreply connection close xmpp exception xmppexception io exception ioexception error closing stream get message getmessage input stream inputstream cleanup remove session manager in band bytestream manager inbandbytestreammanager get byte stream manager getbytestreammanager connection get sessions getsessions remove ibb input stream ibbinputstream base implementation band bytestream input stream subclasses input stream provide packet listener packet filter collect band bytestream data pack ets packets ibb input stream ibbinputstream input stream inputstream data packet listener fill data queue packet listener packetlistener data packet listener datapacketlistener queue received band bytestream data pack ets packets blocking queue blockingqueue data packet extension datapacketextension data queue dataqueue linked blocking queue linkedblockingqueue data packet extension datapacketextension buffer data data packet buffer pointer read buffer buffer pointer bufferpointer data packet sequence range seq flag input stream closed is closed isclosed flag close method invoked close invoked closeinvoked timeout read operations read timeout readtimeout constructor ibb input stream ibbinputstream add data packet listener connection data packet listener datapacketlistener get data packet listener getdatapacketlistener connection add packet listener addpacketlistener data packet listener datapacketlistener get data packet filter getdatapacketfilter returns packet listener processes band bytestream data pack ets packets data packet listener packet listener packetlistener get data packet listener getdatapacketlistener returns packet filter accepts band bytestream data pack ets packets data packet filter packet filter packetfilter get data packet filter getdatapacketfilter read io exception ioexception check closed checkclosed read buffer read fill buffer buffer pointer bufferpointer buffer pointer bufferpointer buffer length data stream closed load buffer loadbuffer increment buffer pointer buffer buffer pointer bufferpointer xff read len io exception ioexception null pointer exception nullpointerexception length len len length len index out of bounds exception indexoutofboundsexception len check closed checkclosed read buffer read fill buffer buffer pointer bufferpointer buffer pointer bufferpointer buffer length data stream closed load buffer loadbuffer bytes wanted bytes available bytesavailable buffer length buffer pointer bufferpointer len bytes available bytesavailable len bytes available bytesavailable system arraycopy buffer buffer pointer bufferpointer len buffer pointer bufferpointer len len read io exception ioexception read length method blocks data packet received stream closed current thread int errupted interrupted code code data received code code io exception ioexception data pack ets packets sequence load buffer loadbuffer io exception ioexception wait data stream closed data packet extension datapacketextension data read timeout readtimeout data is closed isclosed data queue dataqueue is empty isempty data data queue dataqueue poll time unit timeunit milliseconds data data queue dataqueue poll read timeout readtimeout time unit timeunit milliseconds data socket timeout exception sockettimeoutexception interrupted exception interruptedexception thread current thread currentthread int errupt interrupt handle sequence overflow seq seq check data pack ets packets sequence success or successor sequence seq data get seq getseq seq seq pack ets packets order close stream session in band bytestream session inbandbytestreamsession close io exception ioexception pack ets packets sequence seq seq buffer decoded data buffer data get decoded data getdecodeddata buffer pointer bufferpointer checks stream closed io exception ioexception io exception ioexception stream closed data read check closed checkclosed io exception ioexception exception data close method invoked is closed isclosed data queue dataqueue is empty isempty close invoked closeinvoked clear data queue additional data received stream closed data queue dataqueue clear io exception ioexception stream closed mark supported marksupported close io exception ioexception is closed isclosed close invoked closeinvoked in band bytestream session inbandbytestreamsession close by local closebylocal method sets close flag removes data packet listener close internal closeinternal is closed isclosed is closed isclosed invoked session closed cleanup connection remove packet listener removepacketlistener data packet listener datapacketlistener iqibb input stream iqibbinputstream ibb input stream ibbinputstream stanzas encapsulating data pack ets packets iqibb input stream iqibbinputstream ibb input stream ibbinputstream packet listener packetlistener get data packet listener getdatapacketlistener packet listener packetlistener last sequence lastsequence process packet processpacket packet packet data packet extension data packet extension datapacketextension data data packet extension datapacketextension packet get extension getextension data packet extension datapacketextension element in band bytestream manager inbandbytestreammanager name space namespace check sequence xep data get seq getseq last sequence lastsequence unexpected request unexpectedrequest create error response createerrorresponse packet xmpp error xmpperror xmpp error xmpperror condition unexpected request connection send packet sendpacket unexpected request unexpectedrequest check encoded data valid xep data get decoded data getdecodeddata data invalid resp ond respond bad request error bad request badrequest create error response createerrorresponse packet xmpp error xmpperror xmpp error xmpperror condition bad request connection send packet sendpacket bad request badrequest data valid add data queue data queue dataqueue offer data confirm confirm data confirmdata create result q createresultiq packet connection send packet sendpacket confirm data confirmdata sequence last sequence lastsequence data get seq getseq last sequence lastsequence last sequence lastsequence packet filter packetfilter get data packet filter getdatapacketfilter filter stanzas type represented data data packet extension matching session recipient and filter andfilter packet type filter packettypefilter data ibb data packet filter ibbdatapacketfilter messageibbinputstream ibb input stream ibbinputstream message stanzas encapsulating data pack ets packets messageibbinputstream ibb input stream ibbinputstream packet listener packetlistener get data packet listener getdatapacketlistener packet listener packetlistener process packet processpacket packet packet data packet extension data packet extension datapacketextension data data packet extension datapacketextension packet get extension getextension data packet extension datapacketextension element in band bytestream manager inbandbytestreammanager name space namespace check encoded data valid data get decoded data getdecodeddata todo majority xmpp server implementation support xep advanced message processing invalid message answered error ignore packet sub seq uent subsequent pack ets packets inc reased increased sequence input stream close stream session data valid add data queue data queue dataqueue offer data todo confirm packet xmpp servers support xep override packet filter packetfilter get data packet filter getdatapacketfilter filter message stanzas data packet extension matching session recipient and filter andfilter packet type filter packettypefilter message ibb data packet filter ibbdatapacketfilter ibb data packet filter ibbdatapacketfilter filters pack ets packets remote peer session band bytestream data packet extension session matches sessions ibb data packet filter ibbdatapacketfilter packet filter packetfilter accept packet packet sender equals remote peer packet get from getfrom equals ignore case equalsignorecase remotejid stanza data packet extension packet extension packetextension packet extension packetextension packet get extension getextension data packet extension datapacketextension element in band bytestream manager inbandbytestreammanager name space namespace packet extension packetextension packet extension packetextension data packet extension datapacketextension session equals session data packet extension datapacketextension data data packet extension datapacketextension packet extension packetextension data get session d getsessionid equals byte stream request bytestreamrequest get session d getsessionid ibb output stream ibboutputstream base implementation band bytestream output stream subclasses output stream provide method send data xmpp stream ibb output stream ibboutputstream output stream outputstream buffer size sessions block size buffer pointer write buffer buffer pointer bufferpointer data packet sequence range seq flag output stream closed is closed isclosed ibb output stream ibboutputstream buffer byte stream request bytestreamrequest get block size getblocksize writes data packet xmpp stream param data data packet io exception ioexception error occurred sending stream closed writetoxml data packet extension datapacketextension data io exception ioexception write io exception ioexception is closed isclosed io exception ioexception stream closed buffer full flush buffer buffer pointer bufferpointer buffer length flush buffer flushbuffer buffer buffer pointer bufferpointer write len io exception ioexception null pointer exception nullpointerexception length len len length len index out of bounds exception indexoutofboundsexception len is closed isclosed io exception ioexception stream closed data send greater buffer size len buffer length chunk write write out writeout buffer length recursively call method lesser amount write buffer length len buffer length write out writeout len write io exception ioexception write length fills buffer data sends xmpp stream buf fers buffers capacity reached method called ass ured assured amount data send buffer capacity param data param data param len number bytes write io exception ioexception error occurred sending stream closed write out writeout len io exception ioexception is closed isclosed io exception ioexception stream closed block executed data send greater buffer space left len buffer length buffer pointer bufferpointer fill buffer capacity send buffer length buffer pointer bufferpointer system arraycopy buffer buffer pointer bufferpointer buffer pointer bufferpointer flush buffer flushbuffer copy data left buffer system arraycopy buffer buffer pointer bufferpointer len buffer pointer bufferpointer len flush io exception ioexception is closed isclosed io exception ioexception stream closed flush buffer flushbuffer flush buffer flushbuffer io exception ioexception data send buffer pointer bufferpointer create data packet string enc string utils stringutils encode base encodebase buffer buffer pointer bufferpointer data packet extension datapacketextension data data packet extension datapacketextension byte stream request bytestreamrequest get session d getsessionid seq enc write xmpp stream writetoxml data reset buffer pointer buffer pointer bufferpointer increment sequence sequence overflow seq seq seq close io exception ioexception is closed isclosed in band bytestream session inbandbytestreamsession close by local closebylocal sets close flag option ally optionally flushes stream param flush code code flushes stream close internal closeinternal flush is closed isclosed is closed isclosed flush flush buffer flushbuffer io exception ioexception iqibb output stream iqibboutputstream ibb output stream ibboutputstream stanzas encapsulating data pack ets packets iqibb output stream iqibboutputstream ibb output stream ibboutputstream override writetoxml data packet extension datapacketextension data io exception ioexception create stanza data packet data data set to setto remotejid sync packet send syncpacketsend get reply getreply connection xmpp exception xmppexception is closed isclosed in band bytestream session inbandbytestreamsession close io exception ioexception error sending data get message getmessage messageibboutputstream ibb output stream ibboutputstream message stanzas encapsulating data pack ets packets messageibboutputstream ibb output stream ibboutputstream override writetoxml data packet extension datapacketextension data create message stanza data packet message message message remotejid message add extension addextension data connection send packet sendpacket message
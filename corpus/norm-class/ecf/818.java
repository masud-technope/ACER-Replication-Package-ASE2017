header data cvs org eclipse ecf tests bundles org eclipse ecf tests apache httpclient server src org apache commons httpclient test digest auth testdigestauth java slewis exp revision copyright apache software foundation licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license software consists voluntary contributions individuals behalf apache software foundation apache software foundation http apache org org apache commons httpclient java i o exception ioexception java util map org apache commons httpclient fake http method fakehttpmethod org apache commons httpclient header org apache commons httpclient http client httpclient org apache commons httpclient http status httpstatus org apache commons httpclient http version httpversion org apache commons httpclient username password credentials usernamepasswordcredentials org apache commons httpclient protocol protocol org apache commons httpclient server http service httpservice org apache commons httpclient server request line requestline org apache commons httpclient server simple http server simplehttpserver org apache commons httpclient server simple request simplerequest org apache commons httpclient server simple response simpleresponse junit framework test junit framework test case testcase junit framework test suite testsuite test methods digest scheme digestscheme authentication author rodney waldhoff author href mailto jsdever apache org jeff dever author href mailto oleg ural oleg kalnichevski test digest auth testdigestauth test case testcase constructor test digest auth testdigestauth string test name testname test name testname main main string args string test case name testcasename test digest auth testdigestauth get name getname junit text ui textui test runner testrunner main test case name testcasename test case testcase methods test suite test suite testsuite test digest auth testdigestauth test digest authentication with no realm testdigestauthenticationwithnorealm exception string challenge digest auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge fail thrown malformed challenge exception malformedchallengeexception malformed challenge exception malformedchallengeexception test digest authentication with no realm testdigestauthenticationwithnorealm exception string challenge digest auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge fail thrown malformed challenge exception malformedchallengeexception malformed challenge exception malformedchallengeexception test digest authentication with default creds testdigestauthenticationwithdefaultcreds exception string challenge digest realm realm nonce fake http method fakehttpmethod method fake http method fakehttpmethod username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals table uri assert equals assertequals table nonce assert equals assertequals ddf eab table response test digest authentication testdigestauthentication exception string challenge digest realm realm nonce username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password fake http method fakehttpmethod method fake http method fakehttpmethod auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals table uri assert equals assertequals table nonce assert equals assertequals ddf eab table response test digest authentication with query string in digest i testdigestauthenticationwithquerystringindigesturi exception string challenge digest realm realm nonce username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password fake http method fakehttpmethod method fake http method fakehttpmethod method set query string setquerystring param auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals param table uri assert equals assertequals table nonce assert equals assertequals fef bcb table response test digest authentication with multiple real ms testdigestauthenticationwithmultiplerealms exception string challenge digest realm realm nonce abc de abcde string challenge digest realm realm nonce username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials uname password fake http method fakehttpmethod method fake http method fakehttpmethod auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals table uri assert equals assertequals abc de abcde table nonce assert equals assertequals eac table response auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals uname table username assert equals assertequals realm table realm assert equals assertequals table uri assert equals assertequals table nonce assert equals assertequals edd table response test digest authentication sess algorithm test digest authentication d testdigestauthenticationmd sess exception digest sess string realm realm string username username string password password string nonce string challenge digest realm realm nonce nonce opaque some string somestring stale algorithm sess pass expect qop username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password fake http method fakehttpmethod method fake http method fakehttpmethod auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method test quotes assert true asserttrue response index of indexof test quotes assert true asserttrue response index of indexof qop map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals sess table algorithm assert equals assertequals table uri assert equals assertequals nonce table nonce assert equals assertequals integer parse int parseint string table assert true asserttrue table cnonce assert equals assertequals some string somestring table opaque assert equals assertequals table qop todo add check assert true asserttrue table response test digest authentication sess algorithm test digest authentication d testdigestauthenticationmd sess no qop sessnoqop exception digest sess string realm realm string username username string password password string nonce string challenge digest realm realm nonce nonce opaque some string somestring stale algorithm sess username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password fake http method fakehttpmethod method fake http method fakehttpmethod auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge string response authscheme authenticate cred method map table auth challenge parser authchallengeparser extract params extractparams response assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals sess table algorithm assert equals assertequals table uri assert equals assertequals nonce table nonce assert true asserttrue table assert equals assertequals some string somestring table opaque assert true asserttrue table qop todo add check assert true asserttrue table response test digest authentication inv alud invalud qop test digest authentication d testdigestauthenticationmd sess invalid qop sessinvalidqop exception digest sess string realm realm string username username string password password string nonce string challenge digest realm realm nonce nonce opaque some string somestring stale algorithm sess jakarta invalid qop qop jakarta username password credentials usernamepasswordcredentials cred username password credentials usernamepasswordcredentials username password auth scheme authscheme authscheme digest scheme digestscheme authscheme process challenge processchallenge challenge fail malformed challenge exception malformedchallengeexception exception expected invalid qop malformed challenge exception malformedchallengeexception stale non ce service stalenonceservice http service httpservice stale non ce service stalenonceservice process simple request simplerequest request simple response simpleresponse response i o exception ioexception request line requestline request line requestline request get request line getrequestline http version httpversion ver request line requestline get http version gethttpversion header request get first header getfirstheader authorization response set status line setstatusline ver http status httpstatus unauthorized response add header addheader header auth enticate authenticate digest realm realm nonce abc response set body string setbodystring authorization required map table auth challenge parser authchallengeparser extract params extractparams get value getvalue string nonce string table nonce nonce equals abc response set status line setstatusline ver http status httpstatus unauthorized response add header addheader header auth enticate authenticate digest realm realm nonce cba stale response set body string setbodystring authorization required response set status line setstatusline ver http status httpstatus response set body string setbodystring authorization successful test digest authentication with stale non ce testdigestauthenticationwithstalenonce exception configure server arbitrary port simple http server simplehttpserver server simple http server simplehttpserver server set test name settestname get name getname server set http service sethttpservice stale non ce service stalenonceservice configure client http client httpclient client http client httpclient client get host configuration gethostconfiguration set host sethost server get local address getlocaladdress server get local port getlocalport protocol get protocol getprotocol http client get state getstate set credentials setcredentials auth scope authscope username password credentials usernamepasswordcredentials username password fake http method fakehttpmethod http get httpget fake http method fakehttpmethod client execute method executemethod http get httpget http get httpget release connection releaseconnection assert not null assertnotnull http get httpget get status line getstatusline assert equals assertequals http status httpstatus http get httpget get status line getstatusline get status code getstatuscode map table auth challenge parser authchallengeparser extract params extractparams http get httpget get request header getrequestheader authorization get value getvalue assert equals assertequals username table username assert equals assertequals realm table realm assert equals assertequals table uri assert equals assertequals cba table nonce assert equals assertequals eefa table response server destroy
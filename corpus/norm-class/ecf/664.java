copyright comp osent composent rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors comp osent composent initial api implementation org eclipse ecf tests discovery java util arrays java util collection java util collections java util hash set hashset java util properties java util org eclipse ecf core container connect exception containerconnectexception org eclipse ecf core i container icontainer org eclipse ecf core events i container event icontainerevent org eclipse ecf discovery i discovery advertiser idiscoveryadvertiser org eclipse ecf discovery i discovery locator idiscoverylocator org eclipse ecf discovery i service event iserviceevent org eclipse ecf discovery i service info iserviceinfo org eclipse ecf discovery i service listener iservicelistener org eclipse ecf discovery i service type listener iservicetypelistener org eclipse ecf discovery identity i service type d iservicetypeid org eclipse ecf tests discovery listener test service listener testservicelistener org eclipse ecf tests discovery listener test service type listener testservicetypelistener org eclipse ecf tests discovery listener thread test service listener threadtestservicelistener org osgi framework bundle context bundlecontext org osgi framework service registration serviceregistration discovery service test discoveryservicetest discovery test discoverytest ids to expect idstoexpect discovery service test discoveryservicetest string javadoc org eclipse ecf tests discovery abstract discovery test abstractdiscoverytest set up setup set up setup exception set up setup i container icontainer adapter i container icontainer get discovery locator getdiscoverylocator get adapter getadapter i container icontainer hash set hashset add adapter getid ids to expect idstoexpect collections unmodifiable set unmodifiableset discovery locator discoverylocator purge cache purgecache javadoc org eclipse ecf tests discovery abstract discovery test abstractdiscoverytest get discovery locator getdiscoverylocator i discovery locator idiscoverylocator get discovery locator getdiscoverylocator activator get default getdefault get discovery locator getdiscoverylocator container under test containerundertest javadoc org eclipse ecf tests discovery abstract discovery test abstractdiscoverytest get discovery locator getdiscoverylocator i discovery advertiser idiscoveryadvertiser get discovery advertiser getdiscoveryadvertiser activator get default getdefault get discovery advertiser getdiscoveryadvertiser container under test containerundertest test add service listener with refresh testaddservicelistenerwithrefresh i service info iserviceinfo services discovery locator discoverylocator get services getservices assert true asserttrue services register d registerd point services length services to string tostring services length thread test service listener threadtestservicelistener tsl thread test service listener threadtestservicelistener events to expect eventstoexpect discovery locator discoverylocator get name getname get test id gettestid os gi osgi properties props properties props i discovery locator idiscoverylocator container container under test containerundertest bundle context bundlecontext ctxt activator get default getdefault get context getcontext lock listener won discovery event tsl register service registerservice check services registered services discovery locator discoverylocator get services getservices assert true asserttrue events to expect eventstoexpect services register d registerd point services length services to string tostring services length events to expect eventstoexpect register listener os gi osgi service registration serviceregistration registration ctxt register service registerservice i service listener iservicelistener get name getname tsl props register service expect test listener not ified notified tsl wait wait time for provider waittimeforprovider interrupted exception interruptedexception thread current thread currentthread int errupt interrupt fail discovery unrelated thr eading threading issues registration unregister i container event icontainerevent event tsl get event getevent assert not null assertnotnull test listener didn receive discovery event event diff expected ids discovered remain ig remainig events missing ids hash set hashset ids to expect idstoexpect ids remove all removeall get container ids getcontainerids event assert true asserttrue test misses ids size event container ids to expect idstoexpect ids ids ids size assert equals assertequals test listener received unexpected amount discovery events arrays as list aslist event events to expect eventstoexpect event length assert true asserttrue discovery event originated back end backend thread thread tsl get calling thread getcallingthread thread current thread currentthread tsl get calling thread getcallingthread tsl get calling thread getcallingthread i service info iserviceinfo service info serviceinfo i service event iserviceevent event events to expect eventstoexpect get service info getserviceinfo assert true asserttrue i service info iserviceinfo match expected service info serviceinfo service info serviceinfo comparator compare service info serviceinfo service info serviceinfo collection get container ids getcontainerids i container event icontainerevent events collection original ids originalids hash set hashset events length i container event icontainerevent i container event icontainerevent events original ids originalids add i container event icontainerevent get local container d getlocalcontainerid original ids originalids test add service listener service listener gi testaddservicelisteneriservicelistenerosgi container connect exception containerconnectexception i service info iserviceinfo services discovery locator discoverylocator get services getservices assert true asserttrue services register d registerd point services length services to string tostring services length test service listener testservicelistener tsl test service listener testservicelistener events to expect eventstoexpect discovery locator discoverylocator get name getname get test id gettestid properties props properties props i discovery locator idiscoverylocator container container under test containerundertest bundle context bundlecontext ctxt activator get default getdefault get context getcontext service registration serviceregistration registration ctxt register service registerservice i service listener iservicelistener get name getname tsl props add listener register and wait addlistenerregisterandwait tsl service info serviceinfo registration unregister i container event icontainerevent event tsl get event getevent assert not null assertnotnull test listener didn receive discovery event event assert equals assertequals test listener received unexpected amount discovery events arrays as list aslist event events to expect eventstoexpect event length i service info iserviceinfo service info serviceinfo i service event iserviceevent event events to expect eventstoexpect get service info getserviceinfo assert true asserttrue i service info iserviceinfo match expected service info serviceinfo service info serviceinfo comparator compare service info serviceinfo service info serviceinfo test add service listener service type service listener gi testaddservicelisteneriservicetypeidiservicelistenerosgi container connect exception containerconnectexception i service info iserviceinfo services discovery locator discoverylocator get services getservices assert true asserttrue services register d registerd point services length services to string tostring services length test service listener testservicelistener tsl test service listener testservicelistener events to expect eventstoexpect discovery locator discoverylocator get name getname get test id gettestid i service type d iservicetypeid service type d servicetypeid service info serviceinfo get service d getserviceid get service type d getservicetypeid properties props properties props org eclipse ecf discovery services service type d servicetypeid get services getservices props org eclipse ecf discovery scopes service type d servicetypeid get scopes getscopes props org eclipse ecf discovery protocols service type d servicetypeid get protocols getprotocols props org eclipse ecf discovery naming authority namingauthority service type d servicetypeid get naming auth ority getnamingauthority props i discovery locator idiscoverylocator container container under test containerundertest bundle context bundlecontext ctxt activator get default getdefault get context getcontext service registration serviceregistration registration ctxt register service registerservice i service listener iservicelistener get name getname tsl props add listener register and wait addlistenerregisterandwait tsl service info serviceinfo registration unregister i container event icontainerevent event tsl get event getevent assert not null assertnotnull test listener didn receive discovery event assert equals assertequals test listener received unexpected amount discovery events arrays as list aslist event events to expect eventstoexpect event length i service info iserviceinfo service info serviceinfo i service event iserviceevent event events to expect eventstoexpect get service info getserviceinfo assert true asserttrue i service info iserviceinfo match expected service info serviceinfo service info serviceinfo comparator compare service info serviceinfo service info serviceinfo test add service listener service type service listener gi wildcards testaddservicelisteneriservicetypeidiservicelistenerosgiwildcards container connect exception containerconnectexception i service info iserviceinfo services discovery locator discoverylocator get services getservices assert true asserttrue services register d registerd point services length services to string tostring services length test service listener testservicelistener tsl test service listener testservicelistener events to expect eventstoexpect discovery locator discoverylocator get name getname get test id gettestid properties props properties props org eclipse ecf discovery services props org eclipse ecf discovery scopes props org eclipse ecf discovery protocols props org eclipse ecf discovery naming authority namingauthority props i discovery locator idiscoverylocator container container under test containerundertest bundle context bundlecontext ctxt activator get default getdefault get context getcontext service registration serviceregistration registration ctxt register service registerservice i service listener iservicelistener get name getname tsl props add listener register and wait addlistenerregisterandwait tsl service info serviceinfo registration unregister i container event icontainerevent event tsl get event getevent assert not null assertnotnull test listener didn receive discovery event assert equals assertequals test listener received unexpected amount discovery events arrays as list aslist event events to expect eventstoexpect event length i service info iserviceinfo service info serviceinfo i service event iserviceevent event events to expect eventstoexpect get service info getserviceinfo assert true asserttrue i service info iserviceinfo match expected service info serviceinfo service info serviceinfo comparator compare service info serviceinfo service info serviceinfo test add service type listener gi testaddservicetypelistenerosgi container connect exception containerconnectexception i service info iserviceinfo services discovery locator discoverylocator get services getservices assert true asserttrue services register d registerd point services length services to string tostring services length test service type listener testservicetypelistener test type listener testtypelistener test service type listener testservicetypelistener events to expect eventstoexpect properties props properties props i discovery locator idiscoverylocator container container under test containerundertest bundle context bundlecontext ctxt activator get default getdefault get context getcontext service registration serviceregistration registration ctxt register service registerservice i service type listener iservicetypelistener get name getname test type listener testtypelistener props test type listener testtypelistener register service expect test listener not ified notified register service registerservice test type listener testtypelistener wait wait time for provider waittimeforprovider interrupted exception interruptedexception thread current thread currentthread int errupt interrupt fail discovery unrelated thr eading threading issues registration unregister i container event icontainerevent event test type listener testtypelistener get event getevent assert not null assertnotnull test listener didn receive discovery event assert equals assertequals test listener received unexpected amount discovery events arrays as list aslist event events to expect eventstoexpect event length
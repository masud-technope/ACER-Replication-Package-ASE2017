copyright jan rellermeyer systems group dep artment department computer science eth zurich rights reserved redistribution source binary forms modification permitted conditions met redistributions source code retain copyright not ice notice list conditions disclaimer redistributions binary form reproduce copyright not ice notice list conditions disclaimer documentation materials distribution eth zurich names contributors end orse endorse promote products derived software specific prior written permission software copyright holders contributors express implied warranties including limited implied warranties merchantability fitness purpose disclaimed event copyright owner contributors liable dir ect direct indirect incidental special exemplary consequential damages including limited procurement substitute goods services loss data profits business interruption caused theory liability contract strict liability tort including negligence arising software advised possibility damage ethz iks osgi impl java io exception ioexception java util array list arraylist java util arrays java util hash map hashmap java util hash set hashset org objectweb asm annotation visitor annotationvisitor org objectweb asm attribute org objectweb asm class reader classreader org objectweb asm class visitor classvisitor org objectweb asm field visitor fieldvisitor org objectweb asm label org objectweb asm method visitor methodvisitor org objectweb asm opcodes org objectweb asm type ethz iks osgi messages deliver service message deliverservicemessage ethz iks util string utils stringutils code analyzer takes service addition ally additionally registered parts smart proxies determines injection code analysis idea inject types referenced service proxy contained current types injected imported types considered belong required environment moment code analysis cover accessed resources bundle revisions int roduced introduced author jan rellermeyer eth zurich code analyzer codeanalyzer class visitor classvisitor loader service provider bundle class loader classloader loader closure list array list arraylist closure array list arraylist visited types hash set hashset visited hash set hashset injection hash map hashmap injections hash map hashmap map hash map hashmap imports map importsmap export map hash map hashmap exports map exportsmap imports proxy generated code analyis hash set hashset proxy imports proxyimports hash set hashset exports proxy generated code analysis hash set hashset proxy exports proxyexports hash set hashset method analyzer method visitor methodvisitor method visitor methodvisitor method analyzer methodanalyzer string current class currentclass create code analyzer instance param loader loader service bundle param imports imports service bundle param exports exports service bundle code analyzer codeanalyzer class loader classloader loader string imports string exports opcodes asm loader loader imports nls string tokens string utils stringutils string to array stringtoarray imports imports map importsmap hash map hashmap tokens length tokens length pos nls tokens index of indexof nls pos imports map importsmap tokens substring pos tokens substring pos tokens length imports map importsmap tokens imports map importsmap hash map hashmap exports nls string tokens string utils stringutils string to array stringtoarray exports exports map exportsmap hash map hashmap tokens length tokens length pos nls tokens index of indexof nls pos exports map exportsmap tokens substring pos tokens substring pos tokens length exports map exportsmap tokens exports map exportsmap hash map hashmap analyze service param iface service param smart proxy smartproxy smart proxy code code param explicit inject ions explicitinjections injection array code code param presentation presentation code code code deliver service message deliverservicemessage code required build proxy client side message cached initialized concrete req uesting requesting peer calling code init code method class not found exception classnotfoundexception io exception ioexception deliver service message deliverservicemessage analyze string ifaces string smart proxy smartproxy string explicit inject ions explicitinjections string presentation class not found exception classnotfoundexception io exception ioexception closure add all addall arrays as list aslist ifaces smart proxy smartproxy closure add smart proxy smartproxy presentation closure add presentation explicit inject ions explicitinjections closure add all addall arrays as list aslist explicit inject ions explicitinjections closure is empty isempty visit string closure remove ifaces length proxy imports proxyimports add package of packageof ifaces proxy exports proxyexports add package of packageof ifaces remove obvious imports save net work network bandwidth nls proxy imports proxyimports remove org osgi framework nls proxy imports proxyimports remove ethz iks osgi nls proxy imports proxyimports remove ethz iks osgi types nls proxy imports proxyimports remove ethz iks osgi channels string buffer stringbuffer import declaration importdeclaration string buffer stringbuffer string buffer stringbuffer export declaration exportdeclaration string buffer stringbuffer string string proxy imports proxyimports to array toarray string proxy imports proxyimports size length import declaration importdeclaration append object imports map importsmap nls import declaration importdeclaration append nls import declaration importdeclaration append length nls import declaration importdeclaration append nls string string proxy exports proxyexports to array toarray string proxy exports proxyexports size length export declaration exportdeclaration append object exports map exportsmap nls export declaration exportdeclaration append nls export declaration exportdeclaration append length nls export declaration exportdeclaration append nls deliver service message deliverservicemessage message deliver service message deliverservicemessage message set interface names setinterfacenames ifaces message set smart proxy name setsmartproxyname smart proxy smartproxy message set inject ions setinjections hash map hashmap injections clone message set imports setimports import declaration importdeclaration to string tostring message set exports setexports export declaration exportdeclaration to string tostring visited clear injections clear closure clear message visit param class name classname class not found exception classnotfoundexception unknown io exception ioexception classes byte code bytecode accessed visit string class name classname class not found exception classnotfoundexception current class currentclass class name classname replace remove array indicators current class currentclass starts with startswith current class currentclass current class currentclass substring current class currentclass starts with startswith current class currentclass current class currentclass substring nls string class file classfile current class currentclass string pkg package of packageof class name classname imports map importsmap contains key containskey pkg exports map exportsmap contains key containskey pkg proxy exports proxyexports add pkg class reader classreader reader class reader classreader loader get resource as stream getresourceasstream class file classfile injections class file classfile reader exports map exportsmap contains key containskey pkg proxy exports proxyexports add pkg reader accept class reader classreader skip debug class reader classreader skip frames io exception ioexception ioe class not found exception classnotfoundexception class name classname param cls string package of packageof string cls nls cls last index of lastindexof nls cls substring trim visit type param type visit type visittype type get sort getsort type array visited add get class name getclassname get sort getsort type array visit type visittype get element type getelementtype nls equals get class name getclassname string class name classname get class name getclassname string i class name iclassname class name classname replace visited i class name iclassname inject java classes nls class name classname starts with startswith java visited add i class name iclassname string pkg package of packageof class name classname imports map importsmap contains key containskey pkg visited add i class name iclassname proxy imports proxyimports add pkg inject osgi classes nls class name classname starts with startswith org osgi visited add i class name iclassname visited add i class name iclassname closure add class name classname org objectweb asm class visitor classvisitor visit java lang string java lang string java lang string java lang string visit version access string string signature string super name supername string interfaces super name supername visited super name supername visit type visittype type get type gettype super name supername interfaces length visited interfaces visit type visittype type get type gettype interfaces org objectweb asm class visitor classvisitor visit annotation visitannotation java lang string annotation visitor annotationvisitor visit annotation visitannotation string desc visible org objectweb asm class visitor classvisitor visit attribute visitattribute org objectweb asm attribute visit attribute visitattribute attribute attr org objectweb asm class visitor classvisitor visit end visitend visit end visitend org objectweb asm class visitor classvisitor visit field visitfield java lang string java lang string java lang string java lang object field visitor fieldvisitor visit field visitfield access string string desc string signature object visited desc visit type visittype type get type gettype desc org objectweb asm class visitor classvisitor visit inner class visitinnerclass java lang string java lang string java lang string visit inner class visitinnerclass string string outer name outername string inner name innername access equals current class currentclass visited current class currentclass closure add replace org objectweb asm class visitor classvisitor visit method visitmethod java lang string java lang string java lang string java lang string method visitor methodvisitor visit method visitmethod access string string desc string signature string exceptions type method types methodtypes type get argument types getargumenttypes desc method types methodtypes length visited method types methodtypes get class name getclassname replace visit type visittype method types methodtypes type return type returntype type get return type getreturntype desc visited return type returntype get class name getclassname replace visit type visittype return type returntype exceptions exceptions length visited exceptions visit type visittype type get type gettype exceptions access opcodes acc method visitor methodvisitor org objectweb asm class visitor classvisitor visit outer class visitouterclass java lang string java lang string java lang string visit outer class visitouterclass string owner string string desc org objectweb asm class visitor classvisitor visit source visitsource java lang string java lang string visit source visitsource string source string debug method analyzer author jan rellermeyer eth zurich method analyzer methodanalyzer method visitor methodvisitor method analyzer methodanalyzer opcodes asm org objectweb asm method visitor methodvisitor visit annotation visitannotation java lang string annotation visitor annotationvisitor visit annotation visitannotation string desc visible visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit annotation default visitannotationdefault annotation visitor annotationvisitor visit annotation default visitannotationdefault org objectweb asm method visitor methodvisitor visit attribute visitattribute org objectweb asm attribute visit attribute visitattribute attribute attr org objectweb asm method visitor methodvisitor visit code visitcode visit code visitcode org objectweb asm method visitor methodvisitor visit end visitend visit end visitend org objectweb asm method visitor methodvisitor visit field insn visitfieldinsn java lang string java lang string java lang string visit field insn visitfieldinsn opcode string owner string string desc visited owner nls nls visit type visittype type get type gettype owner visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit iinc insn visitiincinsn visit iinc insn visitiincinsn increment org objectweb asm method visitor methodvisitor visit insn visitinsn visit insn visitinsn opcode org objectweb asm method visitor methodvisitor visit int insn visitintinsn visit int insn visitintinsn opcode operand org objectweb asm method visitor methodvisitor visit jump insn visitjumpinsn org objectweb asm label visit jump insn visitjumpinsn opcode label label org objectweb asm method visitor methodvisitor visit label visitlabel org objectweb asm label visit label visitlabel label label org objectweb asm method visitor methodvisitor visit ldc insn visitldcinsn java lang object visit ldc insn visitldcinsn object cst org objectweb asm method visitor methodvisitor visit line number visitlinenumber org objectweb asm label visit line number visitlinenumber label start org objectweb asm method visitor methodvisitor visit local variable visitlocalvariable java lang string java lang string java lang string org objectweb asm label org objectweb asm label visit local variable visitlocalvariable string string desc string signature label start label visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit lookup switch insn visitlookupswitchinsn org objectweb asm label org objectweb asm label visit lookup switch insn visitlookupswitchinsn label dflt label labels org objectweb asm method visitor methodvisitor visit maxs visitmaxs visit maxs visitmaxs max stack maxstack max locals maxlocals org objectweb asm method visitor methodvisitor visit method insn visitmethodinsn java lang string java lang string java lang string visit method insn visitmethodinsn opcode string owner string string desc visited owner nls nls visit type visittype type get type gettype owner org objectweb asm method visitor methodvisitor visit method insn visitmethodinsn java lang string java lang string java lang string visit method insn visitmethodinsn opcode string owner string string desc i tf itf visited owner nls nls visit type visittype type get type gettype owner org objectweb asm method visitor methodvisitor visit multi new array insn visitmultianewarrayinsn java lang string visit multi new array insn visitmultianewarrayinsn string desc dims visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit parameter annotation visitparameterannotation java lang string annotation visitor annotationvisitor visit parameter annotation visitparameterannotation parameter string desc visible visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit table switch insn visittableswitchinsn org objectweb asm label org objectweb asm label visit table switch insn visittableswitchinsn min max label dflt label labels org objectweb asm method visitor methodvisitor visit try catch block visittrycatchblock org objectweb asm label org objectweb asm label org objectweb asm label java lang string visit try catch block visittrycatchblock label start label label handler string type visited type nls nls visit type visittype type get type gettype type org objectweb asm method visitor methodvisitor visit type insn visittypeinsn java lang string visit type insn visittypeinsn opcode string desc visited desc nls nls visit type visittype type get type gettype desc org objectweb asm method visitor methodvisitor visit var insn visitvarinsn visit var insn visitvarinsn opcode org objectweb asm method visitor methodvisitor visit frame visitframe java lang object java lang object visit frame visitframe arg arg object arg arg object arg
copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation jesper steen moller bugs chris west faux bug org eclipse jdt internal debug eval ast engine java util java util hash set hashset java util map java util java util string tokenizer stringtokenizer java util regex matcher java util regex pattern org eclipse core runtime core exception coreexception org eclipse core runtime i progress monitor iprogressmonitor org eclipse core runtime i status istatus org eclipse core runtime status org eclipse debug core debug event debugevent org eclipse debug core debug exception debugexception org eclipse debug core debug plugin debugplugin org eclipse debug core i debug event filter idebugeventfilter org eclipse debug core model i terminate iterminate org eclipse debug core model i thread ithread org eclipse debug core model i variable ivariable org eclipse jdt core i java project ijavaproject org eclipse jdt core signature org eclipse jdt core compiler i problem iproblem org eclipse jdt core dom ast org eclipse jdt core dom ast parser astparser org eclipse jdt core dom compilation unit compilationunit org eclipse jdt debug core i evaluation runnable ievaluationrunnable org eclipse jdt debug core i java array ijavaarray org eclipse jdt debug core i java array type ijavaarraytype org eclipse jdt debug core i java debug target ijavadebugtarget org eclipse jdt debug core i java object ijavaobject org eclipse jdt debug core i java reference type ijavareferencetype org eclipse jdt debug core i java stack frame ijavastackframe org eclipse jdt debug core i java thread ijavathread org eclipse jdt debug core i java type ijavatype org eclipse jdt debug core i java value ijavavalue org eclipse jdt debug core i java variable ijavavariable org eclipse jdt debug eval i ast evaluation engine iastevaluationengine org eclipse jdt debug eval i compiled expression icompiledexpression org eclipse jdt debug eval i evaluation listener ievaluationlistener org eclipse jdt debug eval i evaluation result ievaluationresult org eclipse jdt internal debug core jdi debug options jdidebugoptions org eclipse jdt internal debug core jdi debug plugin jdidebugplugin org eclipse jdt internal debug core model jdi debug target jdidebugtarget org eclipse jdt internal debug core model jdi thread jdithread org eclipse jdt internal debug core model jdi value jdivalue org eclipse jdt internal debug eval evaluation result evaluationresult org eclipse jdt internal debug eval ast instructions instruction sequence instructionsequence sun jdi invocation exception invocationexception sun jdi object reference objectreference ast evaluation engine astevaluationengine i ast evaluation engine iastevaluationengine nls string anonymous prefix val i java project ijavaproject f project fproject i java debug target ijavadebugtarget f debug target fdebugtarget regex find occurrences code snippet pattern f g this pattern fgthispattern pattern compile nls filters variable change events evaluation avoid ref res hing refreshing variables view event filter eventfilter i debug event filter idebugeventfilter javadoc org eclipse debug core i debug event filter idebugeventfilter filter debug events filterdebugevents org eclipse debug core debug event debugevent override debug event debugevent filter debug events filterdebugevents debug event debugevent events events length debug event debugevent event events event get source getsource i java variable ijavavariable event get kind getkind debug event debugevent change i java variable ijavavariable event get source getsource get debug target getdebugtarget equals get debug target getdebugtarget events ast evaluation engine astevaluationengine i java project ijavaproject project i java debug target ijavadebugtarget debug target debugtarget set java project setjavaproject project set debug target setdebugtarget debug target debugtarget set java project setjavaproject i java project ijavaproject project f project fproject project set debug target setdebugtarget i java debug target ijavadebugtarget debug target debugtarget f debug target fdebugtarget debug target debugtarget javadoc org eclipse jdt debug eval i evaluation engine ievaluationengine evaluate java lang string org eclipse jdt debug core i java stack frame ijavastackframe org eclipse jdt debug eval i evaluation listener ievaluationlistener override evaluate string snippet i java stack frame ijavastackframe frame i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception trace caller tracecaller snippet frame get thread getthread i compiled expression icompiledexpression expression get compiled expression getcompiledexpression snippet frame evaluate expression evaluateexpression expression frame listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints javadoc org eclipse jdt debug eval i evaluation engine ievaluationengine evaluate java lang string org eclipse jdt debug core i java object ijavaobject org eclipse jdt debug core i java thread ijavathread org eclipse jdt debug eval i evaluation listener ievaluationlistener override evaluate string snippet i java object ijavaobject this context thiscontext i java thread ijavathread thread i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception trace caller tracecaller snippet thread i compiled expression icompiledexpression expression get compiled expression getcompiledexpression snippet this context thiscontext evaluate expression evaluateexpression expression this context thiscontext thread listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints writes stack dump trace calling thread param snippet expression evaluate param thread thread evaluate trace caller tracecaller string snippet i thread ithread thread jdi debug options jdidebugoptions debug ast eval thread trace string buffer stringbuffer buf string buffer stringbuffer buf append jdi debug options jdidebugoptions format format nls buf append evaluation request trace expression buf append snippet nls buf append t thread tthread string thread get name getname buf append buf append nls buf append nls debug exception debugexception buf append thread to string tostring jdi debug options jdidebugoptions trace buf to string tostring javadoc org eclipse jdt debug eval i ast evaluation engine iastevaluationengine evaluate expression evaluateexpression org eclipse jdt debug eval i compiled expression icompiledexpression org eclipse jdt debug core i java stack frame ijavastackframe org eclipse jdt debug eval i evaluation listener ievaluationlistener override evaluate expression evaluateexpression i compiled expression icompiledexpression expression i java stack frame ijavastackframe frame i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception trace caller tracecaller expression get snippet getsnippet frame get thread getthread runtime context runtimecontext context runtime context runtimecontext get java project getjavaproject frame do evaluation doevaluation expression context i java thread ijavathread frame get thread getthread listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints javadoc org eclipse jdt debug eval i ast evaluation engine iastevaluationengine evaluate expression evaluateexpression org eclipse jdt debug eval i compiled expression icompiledexpression org eclipse jdt debug core i java object ijavaobject org eclipse jdt debug core i java thread ijavathread org eclipse jdt debug eval i evaluation listener ievaluationlistener override evaluate expression evaluateexpression i compiled expression icompiledexpression expression i java object ijavaobject this context thiscontext i java thread ijavathread thread i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception trace caller tracecaller expression get snippet getsnippet thread i runtime context iruntimecontext context this context thiscontext i java array ijavaarray context array runtime context arrayruntimecontext i java array ijavaarray this context thiscontext thread get java project getjavaproject context java object runtime context javaobjectruntimecontext this context thiscontext get java project getjavaproject thread do evaluation doevaluation expression context thread listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints eval uates evaluates expression thread runtime context do evaluation doevaluation i compiled expression icompiledexpression expression i runtime context iruntimecontext context i java thread ijavathread thread i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception expression instruction sequence instructionsequence performing evaluation thread is suspended issuspended jdi thread jdithread thread is invoking method isinvokingmethod thread is per for min g evaluation isperformingevaluation evaluation detail evaluationdetail debug event debugevent evaluation evaluation result evaluationresult result evaluation result evaluationresult expression get snippet getsnippet thread result add error adderror evaluation engine messages evaluationenginemessages ast evaluation engine astevaluationengine perform nested eval uations evaluations listener evaluation complete evaluationcomplete result thread queue runnable queuerunnable eval runnable evalrunnable instruction sequence instructionsequence expression thread context listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints debug exception debugexception status i status istatus error jdi debug plugin jdidebugplugin get unique identifier getuniqueidentifier i status istatus evaluation engine messages evaluationenginemessages ast evaluation engine astevaluationengine ast evaluation engine evaluate expression javadoc org eclipse jdt debug eval i ast evaluation engine iastevaluationengine get compiled expression getcompiledexpression java lang string org eclipse jdt debug core i java stack frame ijavastackframe override i compiled expression icompiledexpression get compiled expression getcompiledexpression string snippet i java stack frame ijavastackframe frame i java project ijavaproject java project javaproject get java project getjavaproject runtime context runtimecontext context runtime context runtimecontext java project javaproject frame evaluation source generator evaluationsourcegenerator mapper compilation unit compilationunit unit i java variable ijavavariable locals var localsvar context get locals getlocals i java object ijavaobject this class thisclass context get this getthis anonymous classes variables i variable ivariable inner class fields innerclassfields this class thisclass inner class fields innerclassfields this class thisclass get variables getvariables inner class fields innerclassfields i variable ivariable num locals var numlocalsvar locals var localsvar length string names hash set hashset string hide problems local variable declare instance local types remove locals duplicate names i java variable ijavavariable locals i java variable ijavavariable num locals var numlocalsvar i java variable ijavavariable locals i java variable ijavavariable num locals var numlocalsvar inner class fields innerclassfields length string local variables with null localvariableswithnull string num locals var numlocalsvar inner class fields innerclassfields length num locals numlocals num locals var numlocalsvar is local type islocaltype locals var localsvar get signature getsignature names locals var localsvar get name getname locals num locals numlocals locals var localsvar names add locals var localsvar get name getname local variables with null localvariableswithnull num locals numlocals locals var localsvar get name getname adding variables scope inner class fields innerclassfields length i variable ivariable inner class fields innerclassfields i java variable ijavavariable get name getname starts with startswith anonymous prefix string get name getname substring anonymous prefix length names locals num locals numlocals i java variable ijavavariable names add local variables with null localvariableswithnull num locals numlocals solve remove string local types names localtypesnames string num locals numlocals num locals numlocals local types names localtypesnames signature to string tostring locals get generic signature getgenericsignature replace copying local variables removing nulls string local variables localvariables arrays clone sub clonesub local variables with null localvariableswithnull names size string local variables localvariables string names size system arraycopy local variables with null localvariableswithnull local variables localvariables local variables localvariables length mapper evaluation source generator evaluationsourcegenerator local types names localtypesnames local variables localvariables snippet compile context declaring type proper visibility locals members comp iling compiling context receiving type access members access priv ates privates members declaring type i java reference type ijavareferencetype receiving type receivingtype frame get reference type getreferencetype disabled bugs frame is static isstatic receiving type receivingtype frame get reference type getreferencetype receiving type receivingtype i java reference type ijavareferencetype frame get this getthis get java type getjavatype unit parse compilation unit parsecompilationunit mapper get source getsource receiving type receivingtype frame get line number getlinenumber java project javaproject frame is static isstatic to char array tochararray mapper get compilation unit name getcompilationunitname java project javaproject core exception coreexception instruction sequence instructionsequence expression instruction sequence instructionsequence snippet expression add error adderror get status getstatus get message getmessage expression create expression from t createexpressionfromast snippet mapper unit compilation unit compilationunit parse compilation unit parsecompilationunit source string unit name unitname i java project ijavaproject project ast parser astparser parser ast parser astparser new parser newparser ast jls parser set source setsource source parser set unit name setunitname unit name unitname parser set project setproject project parser set resolve bindings setresolvebindings map string string options evaluation source generator evaluationsourcegenerator get compiler options getcompileroptions project parser set compiler options setcompileroptions options compilation unit compilationunit parser createast hide problems local variable declare instance local types is local type islocaltype string type name typename nls string tokenizer stringtokenizer str tok strtok string tokenizer stringtokenizer type name typename str tok strtok next token nexttoken str tok strtok has more tokens hasmoretokens str tok strtok next token nexttoken char at charat returns compiled expression evaluation context array receiver i compiled expression icompiledexpression get compiled expression getcompiledexpression string snippet i java array type ijavaarraytype array type arraytype evaluation source generator evaluationsourcegenerator mapper compilation unit compilationunit unit i java project ijavaproject java project javaproject get java project getjavaproject replace occurrences string new snippet newsnippet replace this references replacethisreferences snippet dimension i java type ijavatype component type componenttype array type arraytype get component type getcomponenttype component type componenttype i java array type ijavaarraytype component type componenttype i java array type ijavaarraytype component type componenttype get component type getcomponenttype dimension primitive arrays eval uated evaluated context object arrays base component type treated object arrays eval uated evaluated object nls string rec type name rectypename java lang object string type name typename array type arraytype get name getname component type componenttype i java reference type ijavareferencetype string buffer stringbuffer buf string buffer stringbuffer nls buf append nls java lang object dimension nls buf append type name typename buf to string tostring string local types names localtypesnames string type name typename string local variables localvariables string array runtime context arrayruntimecontext array variable mapper evaluation source generator evaluationsourcegenerator local types names localtypesnames local variables localvariables new snippet newsnippet type name typename index of indexof type type visible rec type name rectypename type name typename substring i java type ijavatype java types javatypes get debug target getdebugtarget get java types getjavatypes rec type name rectypename java types javatypes length i java reference type ijavareferencetype rec type rectype i java reference type ijavareferencetype java types javatypes unit parse compilation unit parsecompilationunit mapper get source getsource rec type rectype get java project getjavaproject to char array tochararray mapper get compilation unit name getcompilationunitname java project javaproject i status istatus status status i status istatus error jdi debug plugin jdidebugplugin get unique identifier getuniqueidentifier jdi debug plugin jdidebugplugin error evaluation engine messages evaluationenginemessages ast evaluation engine astevaluationengine core exception coreexception status core exception coreexception instruction sequence instructionsequence expression instruction sequence instructionsequence snippet expression add error adderror get status getstatus get message getmessage expression create expression from t createexpressionfromast snippet mapper unit javadoc org eclipse jdt debug eval i ast evaluation engine iastevaluationengine get compiled expression getcompiledexpression java lang string org eclipse jdt debug core i java object ijavaobject override i compiled expression icompiledexpression get compiled expression getcompiledexpression string snippet i java object ijavaobject this context thiscontext this context thiscontext i java array ijavaarray get compiled expression getcompiledexpression snippet i java array type ijavaarraytype this context thiscontext get java type getjavatype get compiled expression getcompiledexpression snippet i java reference type ijavareferencetype this context thiscontext get java type getjavatype debug exception debugexception instruction sequence instructionsequence expression instruction sequence instructionsequence snippet expression add error adderror get status getstatus get message getmessage expression javadoc org eclipse jdt debug eval i ast evaluation engine iastevaluationengine get compiled expression getcompiledexpression java lang string org eclipse jdt debug core i java type ijavatype override i compiled expression icompiledexpression get compiled expression getcompiledexpression string snippet i java reference type ijavareferencetype type type i java array type ijavaarraytype get compiled expression getcompiledexpression snippet i java array type ijavaarraytype type i java project ijavaproject java project javaproject get java project getjavaproject evaluation source generator evaluationsourcegenerator mapper compilation unit compilationunit unit mapper evaluation source generator evaluationsourcegenerator string string snippet unit parse compilation unit parsecompilationunit mapper get source getsource type java project javaproject to char array tochararray mapper get compilation unit name getcompilationunitname java project javaproject core exception coreexception instruction sequence instructionsequence expression instruction sequence instructionsequence snippet expression add error adderror get status getstatus get message getmessage expression create expression from t createexpressionfromast snippet mapper unit creates compiled expression snippet mapper compilation unit ast param snippet code snippet compiled param mapper object create expression param unit compilation unit ast generated snippet i compiled expression icompiledexpression create expression from t createexpressionfromast string snippet evaluation source generator evaluationsourcegenerator mapper compilation unit compilationunit unit i problem iproblem problems unit get problems getproblems problems length snippet error snippeterror run method error runmethoderror instruction sequence instructionsequence error sequence errorsequence instruction sequence instructionsequence snippet code snippet start codesnippetstart mapper get snippet start getsnippetstart code snippet end codesnippetend code snippet start codesnippetstart mapper get snippet getsnippet length run method start runmethodstart mapper get run method start getrunmethodstart run method end runmethodend run method start runmethodstart mapper get run method length getrunmethodlength i problem iproblem problem problems error offset erroroffset problem get source start getsourcestart problem id problemid problem getid problem id problemid i problem iproblem is class path correct isclasspathcorrect error sequence errorsequence add error adderror problem get message getmessage snippet error snippeterror problem id problemid i problem iproblem void method returns value voidmethodreturnsvalue problem id problemid i problem iproblem not visible method notvisiblemethod problem id problemid i problem iproblem not visible constructor notvisibleconstructor problem id problemid i problem iproblem not visible field notvisiblefield problem id problemid i problem iproblem not visible type notvisibletype problem is error iserror code snippet start codesnippetstart error offset erroroffset error offset erroroffset code snippet end codesnippetend error sequence errorsequence add error adderror problem get message getmessage snippet error snippeterror run method start runmethodstart error offset erroroffset error offset erroroffset run method end runmethodend run method error runmethoderror snippet error snippeterror run method error runmethoderror run method error runmethoderror error sequence errorsequence add error adderror evaluation engine messages evaluationenginemessages ast evaluation engine astevaluationengine eval uations evaluations expression block for med formed statements error sequence errorsequence ast instruction compiler astinstructioncompiler visitor ast instruction compiler astinstructioncompiler mapper get snippet start getsnippetstart snippet unit accept visitor visitor get instructions getinstructions javadoc org eclipse jdt debug eval i evaluation engine ievaluationengine get java project getjavaproject override i java project ijavaproject get java project getjavaproject f project fproject javadoc org eclipse jdt debug eval i evaluation engine ievaluationengine get debug target getdebugtarget override i java debug target ijavadebugtarget get debug target getdebugtarget f debug target fdebugtarget javadoc org eclipse jdt debug eval i evaluation engine ievaluationengine dispose override dispose eval runnable evalrunnable runnable instruction sequence instructionsequence f expression fexpression i java thread ijavathread f thread fthread f evaluation detail fevaluationdetail f hit breakpoints fhitbreakpoints i runtime context iruntimecontext f context fcontext i evaluation listener ievaluationlistener f listener flistener eval runnable evalrunnable instruction sequence instructionsequence expression i java thread ijavathread thread i runtime context iruntimecontext context i evaluation listener ievaluationlistener listener evaluation detail evaluationdetail hit breakpoints hitbreakpoints f expression fexpression expression f thread fthread thread f context fcontext context f listener flistener listener f evaluation detail fevaluationdetail evaluation detail evaluationdetail f hit breakpoints fhitbreakpoints hit breakpoints hitbreakpoints override jdi debug options jdidebugoptions debug ast eval string buffer stringbuffer buf string buffer stringbuffer buf append jdi debug options jdidebugoptions format format nls buf append nls ast evaluation nls buf append nls t expression texpression buf append f expression fexpression get snippet getsnippet nls buf append nls t thread tthread string f thread fthread get name getname buf append buf append nls buf append debug exception debugexception buf append f thread fthread to string tostring nls buf append nls t detail tdetail f evaluation detail fevaluationdetail debug event debugevent evaluation nls buf append nls evaluation f evaluation detail fevaluationdetail debug event debugevent evaluation implicit buf append evaluation implicit buf append f evaluation detail fevaluationdetail nls buf append nls hit breakpoints buf append f hit breakpoints fhitbreakpoints jdi debug options jdidebugoptions trace buf to string tostring evaluation result evaluationresult result evaluation result evaluationresult ast evaluation engine astevaluationengine f expression fexpression get snippet getsnippet f thread fthread f expression fexpression has errors haserrors string errors f expression fexpression get error messages geterrormessages string error errors result add error adderror error evaluation finished evaluationfinished result jdi debug options jdidebugoptions debug ast eval string buffer stringbuffer buf string buffer stringbuffer nls buf append nls t errors terrors errors length buf append nls buf append buf append errors jdi debug options jdidebugoptions trace buf to string tostring int erpreter interpreter int erpreter interpreter int erpreter interpreter f expression fexpression f context fcontext evaluation runnable evaluationrunnable i evaluation runnable ievaluationrunnable i terminate iterminate core exception coreexception f exception fexception f terminated fterminated override i java thread ijavathread i progress monitor iprogressmonitor event filter eventfilter filter event filter eventfilter debug plugin debugplugin get default getdefault add debug event filter adddebugeventfilter filter int erpreter interpreter execute core exception coreexception exception f exception fexception exception f evaluation detail fevaluationdetail debug event debugevent evaluation exception get status getstatus get exception getexception invocation exception invocationexception invocation exception invocationexception invocation exception invocationexception invocation exception invocationexception exception get status getstatus get exception getexception object reference objectreference ex object exobject invocation exception invocationexception exception i java object ijavaobject model object modelobject i java object ijavaobject jdi value jdivalue create value createvalue jdi debug target jdidebugtarget get debug target getdebugtarget ex object exobject model object modelobject send message sendmessage print stack trace printstacktrace debug exception debugexception debug plugin debugplugin get default getdefault remove debug event filter removedebugeventfilter filter override terminate f terminated fterminated int erpreter interpreter override can terminate canterminate override is terminated isterminated core exception coreexception get exception getexception f exception fexception evaluation runnable evaluationrunnable evaluation runnable evaluationrunnable core exception coreexception exception start system current time millis currenttimemillis f thread fthread run evaluation runevaluation f evaluation detail fevaluationdetail f hit breakpoints fhitbreakpoints debug exception debugexception exception system current time millis currenttimemillis i java value ijavavalue int erpreter interpreter get result getresult exception exception get exception getexception result set terminated setterminated f terminated fterminated exception jdi debug options jdidebugoptions debug ast eval string buffer stringbuffer buf string buffer stringbuffer nls buf append nls t exception texception buf append exception to string tostring jdi debug options jdidebugoptions trace buf to string tostring exception debug exception debugexception result set exception setexception debug exception debugexception exception result set exception setexception debug exception debugexception exception get status getstatus result set value setvalue jdi debug options jdidebugoptions debug ast eval string buffer stringbuffer buf string buffer stringbuffer nls buf append nls t result tresult buf append jdi debug options jdidebugoptions trace buf to string tostring result add error adderror evaluation engine messages evaluationenginemessages ast evaluation engine astevaluationengine unknown error occurred evaluation jdi debug options jdidebugoptions debug ast eval string buffer stringbuffer buf string buffer stringbuffer nls buf append nls t duration tduration buf append start nls buf append nls jdi debug options jdidebugoptions trace buf to string tostring evaluation finished evaluationfinished result evaluation finished evaluationfinished i evaluation result ievaluationresult result notify plug shutdown bug jdi debug plugin jdidebugplugin get default getdefault f listener flistener evaluation complete evaluationcomplete result replaces references array variable param snippet code snippet snippet references replaced string replace this references replacethisreferences string snippet replace occurrences array string buffer stringbuffer updated snippet updatedsnippet string buffer stringbuffer matcher matcher f g this pattern fgthispattern matcher snippet start matcher find matcher start updated snippet updatedsnippet append snippet substring start updated snippet updatedsnippet append array runtime context arrayruntimecontext array variable start start snippet length updated snippet updatedsnippet append snippet substring start snippet length updated snippet updatedsnippet to string tostring
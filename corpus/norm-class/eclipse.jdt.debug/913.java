copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdt internal macbundler java buffered output stream bufferedoutputstream java file java file output stream fileoutputstream java io exception ioexception java util array list arraylist java util iterator java util list java util string tokenizer stringtokenizer javax xml parsers document builder documentbuilder javax xml parsers document builder factory documentbuilderfactory javax xml parsers parser configuration exception parserconfigurationexception javax xml transform output keys outputkeys javax xml transform transformer javax xml transform transformer exception transformerexception javax xml transform transformer factory transformerfactory javax xml transform dom dom source domsource javax xml transform stream stream result streamresult org eclipse core runtime i progress monitor iprogressmonitor org dom document org dom element bundle builder bundlebuilder bundle attributes bundleattributes list process f processes fprocesses array list arraylist process bundle description bundledescription f bundle description fbundledescription create bundle param description param progress monitor io exception ioexception create bundle createbundle bundle description bundledescription i progress monitor iprogressmonitor io exception ioexception f bundle description fbundledescription file tmp dir file destination directory destinationdirectory nls string app dir appname app file app dir file tmp dir app dir app dir exists delete dir deletedir app dir app dir create dir createdir tmp dir app dir nls file contents dir create dir createdir app dir contents create pkg info createpkginfo contents dir nls file macos dir create dir createdir contents dir macos string launcher path launcher launcher path io exception ioexception string launcher copy file copyfile macos dir launcher path nls file resources dir create dir createdir contents dir resources nls file java dir create dir createdir resources dir java create info list createinfoplist contents dir resources dir java dir launcher iterator process iter f processes fprocesses iterator iter has next hasnext process iter wait for waitfor interrupted exception interruptedexception create info list createinfoplist file contents dir file resources dir file java dir string launcher io exception ioexception document builder documentbuilder doc builder docbuilder document builder factory documentbuilderfactory factory document builder factory documentbuilderfactory new instance newinstance factory set valid ating setvalidating doc builder docbuilder factory new document builder newdocumentbuilder parser configuration exception parserconfigurationexception system err println create info list createinfoplist xml builder io exception ioexception xml builder document doc doc builder docbuilder new document newdocument nls element plist doc create element createelement plist doc append child appendchild plist nls nls plist set attribute setattribute version nls element dict doc create element createelement dict plist append child appendchild dict nls pair dict cf bundle executable cfbundleexecutable launcher nls pair dict cf bundle get info string cfbundlegetinfostring get info getinfo nls nls pair dict cf bundle info dictionary version cfbundleinfodictionaryversion string icon name iconname string app name appname f bundle description fbundledescription appname app name appname nls icon name iconname app name appname icns string fname copy file copyfile resources dir f bundle description fbundledescription icon file iconfile icon name iconname fname nls pair dict cf bundle icon file cfbundleiconfile fname nls pair dict cf bundle identifier cfbundleidentifier identifier nls pair dict cf bundle name cfbundlename appname nls nls pair dict cf bundle package type cfbundlepackagetype appl nls pair dict cf bundle short version string cfbundleshortversionstring version nls nls pair dict cf bundle signature cfbundlesignature signature nls nls pair dict cf bundle version cfbundleversion nls element jdi ct jdict doc create element createelement dict nls add dict java jdi ct jdict nls pair jdi ct jdict jvm version jvmversion jvm version jvmversion nls pair jdi ct jdict main class mainclass main class mainclass nls pair jdi ct jdict working directory workingdirectory working dir workingdir f bundle description fbundledescription swt nls add true addtrue jdi ct jdict start on main thread startonmainthread string arguments f bundle description fbundledescription arguments arguments nls element arg array argarray doc create element createelement array nls add jdi ct jdict arguments arg array argarray string tokenizer stringtokenizer string tokenizer stringtokenizer arguments has more tokens hasmoretokens string arg next token nexttoken element type nls doc create element createelement nls string arg array argarray append child appendchild type type append child appendchild doc create text node createtextnode arg nls pair jdi ct jdict vm options vmoptions vmoptions resource info resourceinfo ris f bundle description fbundledescription get resources getresources ris length string buffer stringbuffer string buffer stringbuffer ris length resource info resourceinfo ris string process classpath entry processclasspathentry java dir f path fpath length append append nls add jdi ct jdict class path classpath to string tostring ris f bundle description fbundledescription get resources getresources ris length ris length resource info resourceinfo ris process classpath entry processclasspathentry java dir f path fpath nls file info file contents dir info plist file output stream fileoutputstream fos file output stream fileoutputstream info buffered output stream bufferedoutputstream f output stream foutputstream buffered output stream bufferedoutputstream fos write document stream transformer transformer transformer factory transformerfactory new instance newinstance new transformer newtransformer nls transformer set output property setoutputproperty output keys outputkeys doctype app le apple computer dtd plist nls transformer set output property setoutputproperty output keys outputkeys doctype system http app le apple dtd s dtds property list propertylist dtd nls transformer set output property setoutputproperty output keys outputkeys method xml nls transformer set output property setoutputproperty output keys outputkeys encoding utf nls transformer set output property setoutputproperty output keys outputkeys indent nls nls transformer set output property setoutputproperty http xml apache org xslt indent amount dom source domsource source dom source domsource doc stream result streamresult result stream result streamresult f output stream foutputstream transformer transform source result transformer exception transformerexception system err println create info list createinfoplist transform xml add element dict string key element document document dict get owner document getownerdocument nls element document create element createelement key dict append child appendchild append child appendchild document create text node createtextnode key dict append child appendchild create element parent string document document parent get owner document getownerdocument nls element type document create element createelement string parent append child appendchild type type append child appendchild document create text node createtextnode create true createtrue element parent document document parent get owner document getownerdocument nls element type document create element createelement parent append child appendchild type add element dict string key string document document dict get owner document getownerdocument nls element document create element createelement key dict append child appendchild append child appendchild document create text node createtextnode key create dict add true addtrue element dict string key document document dict get owner document getownerdocument nls element document create element createelement key dict append child appendchild append child appendchild document create text node createtextnode key create true createtrue dict pair element dict string out key outkey string inkey string dflt string inkey f bundle description fbundledescription inkey dflt dflt trim length add dict out key outkey string process classpath entry processclasspathentry file java dir string io exception ioexception file file is directory isdirectory nls nls string archive name archivename jar jar file file java dir archive name archivename zip get absolute path getabsolutepath archive name archivename copy file copyfile java dir nls java root javaroot create pkg info createpkginfo file contents dir io exception ioexception nls file pkg info pkginfo file contents dir pkg info pkginfo file output stream fileoutputstream file output stream fileoutputstream pkg info pkginfo nls nls write appl f bundle description fbundledescription signature get bytes getbytes delete dir deletedir file dir file files dir list files listfiles files files length delete dir deletedir files dir delete file create dir createdir file parent dir string dir remove io exception ioexception file dir file parent dir dir dir exists remove dir delete dir deletedir dir dir mkdir nls io exception ioexception create dir dir dir string copy file copyfile file todir string from path frompath string toname io exception ioexception toname pos from path frompath last index of lastindexof pos toname from path frompath substring pos toname from path frompath file file todir toname nls f processes fprocesses add runtime get runtime getruntime exec string bin from path frompath get absolute path getabsolutepath toname zip string dir string dest io exception ioexception nls nls nls nls f processes fprocesses add runtime get runtime getruntime exec string usr bin jar dest dir
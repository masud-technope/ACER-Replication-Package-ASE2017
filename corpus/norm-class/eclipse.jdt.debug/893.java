copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse jdi internal spy java buffered input stream bufferedinputstream java buffered output stream bufferedoutputstream java data input stream datainputstream java data output stream dataoutputstream java eof exception eofexception java file java file not found exception filenotfoundexception java file output stream fileoutputstream java io exception ioexception java input stream inputstream java output stream outputstream java net inet address inetaddress java net server socket serversocket java net socket java net socket exception socketexception java util hash map hashmap java util map ibm icu text message format messageformat spy jdwp pack ets packets configured debug ger debugger application debug proxy parameters port number debug ger debugger application conn ects connects host proxy waits jdwp connection port number proxy waits jdwp connection file trace written note program tracing jdwp act ivity activity leapfrog debug remote program option proxy started hand port leapfrog connect proxy started leapfrog tcpip spy tcpipspy thread nls handshake bytes handshakebytes jdwp handshake get bytes getbytes f mto debug ger fvmtodebugger data input stream datainputstream f data in fdatain data output stream dataoutputstream f data out fdataout verbose packet stream verbosepacketstream verbose packet stream verbosepacketstream system map integer jdwp conversation jdwpconversation f packets fpackets hash map hashmap integer jdwp conversation jdwpconversation ffieldidsize fmethodidsize fobjectidsize f reference type size freferencetypeidsize fframeidsize f has sizes fhassizes tcpip spy tcpipspy v mto debug ger vmtodebugger input stream inputstream output stream outputstream f mto debug ger fvmtodebugger v mto debug ger vmtodebugger f data in fdatain data input stream datainputstream buffered input stream bufferedinputstream f data out fdataout data output stream dataoutputstream buffered output stream bufferedoutputstream f has sizes fhassizes main string args in port inport string server host serverhost out port outport string output file outputfile in port inport integer parse int parseint args server host serverhost args out port outport integer parse int parseint args args length output file outputfile args exception println usage tcpip spy tcpipspy client port server host server port output file system exit output file outputfile file file file output file outputfile println message format messageformat format writing output object nls file get absolute path getabsolutepath verbose packet stream verbosepacketstream buffered output stream bufferedoutputstream file output stream fileoutputstream file file not found exception filenotfoundexception println message format messageformat format open stdout object file get absolute path getabsolutepath println server socket serversocket server sock serversock server socket serversocket in port inport socket in sock insock server sock serversock accept socket out sock outsock socket inet address inetaddress get by name getbyname server host serverhost out port outport tcpip spy tcpipspy in sock insock get input stream getinputstream out sock outsock get output stream getoutputstream start tcpip spy tcpipspy out sock outsock get input stream getinputstream in sock insock get output stream getoutputstream start exception println override skip handshake handshake length handshakelength handshake length handshakelength handshake bytes handshakebytes length handshake length handshakelength f data in fdatain read f data out fdataout write f data out fdataout flush print packages jdwp packet jdwppacket jdwp packet jdwppacket read f data in fdatain answer debug ger debugger commands f mto debug ger fvmtodebugger get flags getflags jdwp packet jdwppacket flag reply packet store print f mto debug ger fvmtodebugger flush write f data out fdataout f data out fdataout flush eof exception eofexception socket exception socketexception io exception ioexception println message format messageformat format caught exception object to string tostring print stack trace printstacktrace f data in fdatain close f data out fdataout close io exception ioexception flush jdwp command packet jdwpcommandpacket get command getcommand jdwp conversation jdwpconversation conversation f packets fpackets integer conversation conversation get command getcommand store jdwp packet jdwppacket packet packet get id getid jdwp conversation jdwpconversation conversation f packets fpackets integer conversation conversation jdwp conversation jdwpconversation f packets fpackets integer conversation packet get flags getflags jdwp packet jdwppacket flag reply packet conversation set reply setreply jdwp reply packet jdwpreplypacket packet conversation set command setcommand jdwp command packet jdwpcommandpacket packet get command getcommand jdwp packet jdwppacket packet unable to parse data exception unabletoparsedataexception jdwp command packet jdwpcommandpacket command packet jdwp command packet jdwpcommandpacket command jdwp command packet jdwpcommandpacket packet command get command getcommand packet get id getid command unable to parse data exception unabletoparsedataexception packet marked reply command command get command getcommand has sizes hassizes f has sizes fhassizes set has sizes sethassizes f has sizes fhassizes setfieldidsize fieldidsize ffieldidsize fieldidsize getfieldidsize ffieldidsize setmethodidsize methodidsize fmethodidsize methodidsize getmethodidsize fmethodidsize setobjectidsize objectidsize fobjectidsize objectidsize getobjectidsize fobjectidsize set reference type size setreferencetypeidsize referencetypeidsize f reference type size freferencetypeidsize referencetypeidsize get reference type size getreferencetypeidsize f reference type size freferencetypeidsize setframeidsize frameidsize fframeidsize frameidsize getframeidsize fframeidsize